!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.r(t);var h=function(e){function t(e,n,i){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);(o=s(this,r(t).call(this,game,e,n,i))).animations.add("run_anim"+i);return o.anchor.set(.5),o.animations.play("run_anim"+i,32,!0),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"tweenPosX",value:function(e,t){game.add.tween(this).to({x:e},t,"Linear",!0).start()}}])&&a(n.prototype,i),o&&a(n,o),t}();function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var y=function(e){function t(e,n){var i,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=f(t).call(this,game,e,n,"loadStar");(i=!a||"object"!==c(a)&&"function"!=typeof a?g(o):a).animations.add("run_anim");i.anchor.set(.5),i.kill();var s=.5+3*Math.random();return i.timeTween=game.time.events.add(Phaser.Timer.SECOND*s,function(){i.revive(),i.animations.play("run_anim",22,!0)},g(g(i))),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"destroy",value:function(){game.time.events.remove(this.timeTween),d(f(t.prototype),"destroy",this).call(this)}}])&&u(n.prototype,i),o&&u(n,o),t}();function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e,t,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=w(this,S(t).call(this,game,game.rnd.between(100,game.width-100),game.height+100,"loadingNewSprites",e))).arrBubble=["Circle","Circle_White"],i.anchor.set(.5),i.scale.set(.1*game.rnd.between(5,10)),i.index=n,i.addBezier(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addBezier",value:function(){var e=this,t=[{x:this.position.x,y:this.position.y},{x:game.rnd.between(100,game.width-100),y:game.height-1136+900},{x:game.rnd.between(100,game.width-100),y:game.height-1136+700},{x:game.rnd.between(100,game.width-100),y:game.height-1136+550}];this.timeTweenBezier=game.time.events.add(Phaser.Timer.SECOND*(.45*this.index),function(){e.timeTweenAlpha=game.time.events.add(1.9*Phaser.Timer.SECOND,function(){game.add.tween(e).to({alpha:.1},1e3,"Linear",!1).start()});var n=game.add.tween(e).to({x:[t[0].x,t[1].x,t[2].x,t[3].x],y:[t[0].y,t[1].y,t[2].y,t[3].y]},3e3,Phaser.Easing.Linear.In,!1,0,0).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});n.start(),n.onComplete.add(function(){e.position.x=game.rnd.between(100,game.width-100),e.position.y=game.height+100,e.alpha=1,e.scale.set(.1*game.rnd.between(5,10)),e.loadTexture("loadingNewSprites",e.arrBubble[Math.floor(Math.random()*e.arrBubble.length)]),e.addBezier()})})}},{key:"destroy",value:function(){game.time.events.remove(this.timeTweenBezier),game.time.events.remove(this.timeTweenAlpha),b(S(t.prototype),"destroy",this).call(this)}}])&&v(n.prototype,i),o&&v(n,o),t}();function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=P(this,O(t).call(this,game,e,n,"loadingNewSprites",i))).addAnim(o),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addAnim",value:function(e){game.add.tween(this).to({y:this.position.y+e},300,"Linear",!0,0,-1).yoyo(!0,0)}}])&&k(n.prototype,i),o&&k(n,o),t}();function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function A(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=A(this,L(t).call(this,game,e,n,"loadingNewSprites",i))).anchor.set(.5,1),a.angle=o,a.addShake(o),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addShake",value:function(e){game.add.tween(this).to({angle:-e},400,"Linear",!0,0,-1).yoyo(!0,0)}}])&&I(n.prototype,i),o&&I(n,o),t}();function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function B(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var F=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=B(this,j(t).call(this,game))).positionBootConfig=JSON.parse(game.cache.getText("positionBootConfig")),e.STANDARD_HEIGHT=1136,e.yep=n,e.afterInit(),e}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,Phaser.Group),n=t,(o=[{key:"afterInit",value:function(){this.addStage(),this.addRedGirl(),this.addBlackGirl(),this.addWhiteGirl(),this.addStar(),this.addBezierBubble(),this.addBg(),this.addHead(),this.addArm()}},{key:"addStage",value:function(){this.stage=new Phaser.Sprite(game,this.positionBootConfig.loadingScreen.stage.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.stage.y,this.positionBootConfig.loadingScreen.stage.nameAtlas,this.positionBootConfig.loadingScreen.stage.nameSprite),this.stage.anchor.set(.5,1),this.addChild(this.stage)}},{key:"addBg",value:function(){this.bg=new Phaser.Sprite(game,this.positionBootConfig.loadingScreen.bg.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.bg.y,this.positionBootConfig.loadingScreen.bg.nameAtlas,this.positionBootConfig.loadingScreen.bg.nameSprite),this.bg.anchor.set(.5,1),this.addChild(this.bg)}},{key:"addWhiteGirl",value:function(){this.whiteGirl=new h(this.positionBootConfig.loadingScreen.whiteGirl.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.whiteGirl.y,this.positionBootConfig.loadingScreen.whiteGirl.nameSprite),this.addChild(this.whiteGirl)}},{key:"addRedGirl",value:function(){0==this.yep?(this.redGirl=new h(game.width+300,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.redGirl.y,this.positionBootConfig.loadingScreen.redGirl.nameSprite),this.redGirl.tweenPosX(this.positionBootConfig.loadingScreen.redGirl.x,800),this.addChild(this.redGirl)):(this.redGirl=new h(this.positionBootConfig.loadingScreen.redGirl.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.redGirl.y,this.positionBootConfig.loadingScreen.redGirl.nameSprite),this.redGirl.tweenPosX(this.positionBootConfig.loadingScreen.redGirl.x,800),this.addChild(this.redGirl))}},{key:"addBlackGirl",value:function(){0==this.yep?(this.blackGirl=new h(-300,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.blackGirl.y,this.positionBootConfig.loadingScreen.blackGirl.nameSprite),this.blackGirl.tweenPosX(this.positionBootConfig.loadingScreen.blackGirl.x,700),this.addChild(this.blackGirl)):(this.blackGirl=new h(this.positionBootConfig.loadingScreen.blackGirl.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.blackGirl.y,this.positionBootConfig.loadingScreen.blackGirl.nameSprite),this.blackGirl.tweenPosX(this.positionBootConfig.loadingScreen.blackGirl.x,700),this.addChild(this.blackGirl))}},{key:"addStar",value:function(){for(i=0;i<this.positionBootConfig.loadingScreen.stars.length;i++){var e=new y(this.positionBootConfig.loadingScreen.stars[i].x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.stars[i].y);this.addChild(e)}}},{key:"addBezierBubble",value:function(){for(var e=["Circle","Circle_White"],t=0;t<4;t++){var n=e[Math.floor(Math.random()*e.length)],i=new E(n,t);this.addChild(i)}}},{key:"addArm",value:function(){this.arm1=new x(0,game.height-1136+850,"Arm_01",-10),this.addChild(this.arm1),this.arm2=new x(80,game.height-1136+940,"Arm_02",10),this.addChild(this.arm2),this.arm3=new x(220,game.height-1136+1e3,"Arm_03",-10),this.addChild(this.arm3),this.arm4=new x(280,game.height-1136+1035,"Arm_04",10),this.addChild(this.arm4),this.arm5=new x(445,game.height-1136+975,"Arm_05",-10),this.addChild(this.arm5),this.arm6=new x(475,game.height-1136+880,"Arm_06",10),this.addChild(this.arm6),this.arm7=new x(540,game.height-1136+900,"Arm_07",-10),this.addChild(this.arm7)}},{key:"addHead",value:function(){this.head1=new D(-20,game.height-1136+1080,"Head_01",0),this.addChild(this.head1),this.head2=new D(170,game.height-1136+1150,"Head_02",5),this.addChild(this.head2),this.head3=new D(380,game.height-1136+1135,"Head_03",-5),this.addChild(this.head3),this.head4=new D(580,game.height-1136+1120,"Head_04",3),this.addChild(this.head4),this.head5=new D(660,game.height-1136+1080,"Head_05",6),this.addChild(this.head5)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&N(n.prototype,o),a&&N(n,a),t}();function Z(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var H=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=t}var t,n,i;return t=e,(n=[{key:"preload",value:function(){game.load.atlas("loadingSprites","./img/atlas/loadingScreen.png"+"?v=".concat(window.VersionClient),"img/atlas/loadingScreen.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("loadingNewSprites","img/atlas/loadingNewScreen.png"+"?v=".concat(window.VersionClient),"img/atlas/loadingNewScreen.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.image("bg_create_room","img/background/BG.png"+"?v=".concat(window.VersionClient)),game.load.text("positionBootConfig","./img/config/positionBootConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionLoadConfig","./img/config/positionLoadConfig.json"+"?v=".concat(window.VersionClient)),game.load.spritesheet("loadingPlay","img/animations/Loading/sprites.png"+"?v=".concat(window.VersionClient),134,137,32),game.load.text("positionPlayConfig","img/config/positionPlayConfig.json"+"?v=".concat(window.VersionClient)),game.load.spritesheet("loadBlackGirl","img/animations/NewLoading/BlackGirl.png"+"?v=".concat(window.VersionClient),193,330,18),game.load.spritesheet("loadWhiteGirl","img/animations/NewLoading/WhiteGirl.png"+"?v=".concat(window.VersionClient),125,380,14),game.load.spritesheet("loadRedGirl","img/animations/NewLoading/RedGirl.png"+"?v=".concat(window.VersionClient),160,330,22),game.load.spritesheet("loadStar","img/animations/NewLoading/Star.png"+"?v=".concat(window.VersionClient),29,30,11),game.load.image("screen-dim","img/assetss/Practice/reward/screen-dim.png"+"?v=".concat(window.VersionClient)),game.load.image("screen-dim1","img/assetss/Practice/reward/screen-dim1.png"+"?v=".concat(window.VersionClient)),game.load.image("screen-dim2","img/assetss/Practice/reward/screen-dim2.png"+"?v=".concat(window.VersionClient)),game.load.spritesheet("firework","img/atlas/firework.png"+"?v=".concat(window.VersionClient),400,212,40),game.load.spritesheet("fireworktet","img/atlas/fireworktet.png"+"?v=".concat(window.VersionClient),435,231,32)}},{key:"createSprites",value:function(){this.positionBootConfig=this.getpositionBootConfig(),this.addBackgroundSprite(),this.addLogoSprite(),this.addDance(),this.addTermText()}},{key:"getpositionBootConfig",value:function(){return JSON.parse(this.state.cache.getText("positionBootConfig"))}},{key:"addDance",value:function(){var e=new F;this.state.add.existing(e)}},{key:"addBackgroundSprite",value:function(){game.stage.background=game.add.sprite(this.positionBootConfig.bg_load.x*window.GameConfig.RESIZE,this.positionBootConfig.bg_load.y*window.GameConfig.RESIZE,"bg_create_room")}},{key:"addLogoSprite",value:function(){var e=game.add.sprite(this.positionBootConfig.logo.x*window.GameConfig.RESIZE,this.positionBootConfig.logo.y*window.GameConfig.RESIZE,"".concat(this.positionBootConfig.logo.nameAtlas),"".concat(this.positionBootConfig.logo.nameSprite));return e.anchor.set(.5),e}},{key:"addTermText",value:function(){var e=game.add.text(this.positionBootConfig.txt_term.x*window.GameConfig.RESIZE,(game.height-26)*window.GameConfig.RESIZE,this.positionBootConfig.txt_term.text,this.positionBootConfig.txt_term.configs);return e.anchor.set(.5),e.addColor("#ffa33a",37),e}}])&&Z(t.prototype,n),i&&Z(t,i),e}();function Q(){window.MQ.achievementPractice=[{answer:2,reward:10},{answer:5,reward:15},{answer:8,reward:20},{answer:12,reward:30},{answer:18,reward:50},{answer:25,reward:100},{answer:33,reward:150},{answer:45,reward:200},{answer:56,reward:500}],window.MQ.posCirclePractice=[{num:2,x:147,y:300},{num:5,x:320,y:300},{num:8,x:493,y:300},{num:12,x:493,y:419},{num:18,x:320,y:419},{num:25,x:147,y:419},{num:33,x:147,y:536},{num:45,x:320,y:536},{num:56,x:493,y:536}],window.MQ.posDotPractice=[{num:1,x:-15,y:-15},{num:2,x:-15,y:-15},{num:3,x:204,y:299.5},{num:4,x:262,y:299.5},{num:5,x:-15,y:-15},{num:6,x:378,y:299.5},{num:7,x:436,y:299.5},{num:8,x:-15,y:-15},{num:9,x:493,y:330},{num:10,x:493,y:360},{num:11,x:493,y:390},{num:12,x:-15,y:-15},{num:13,x:464,y:419},{num:14,x:435,y:419},{num:15,x:406,y:419},{num:16,x:377,y:419},{num:17,x:348,y:419},{num:18,x:-15,y:-15},{num:19,x:295,y:419},{num:20,x:270,y:419},{num:21,x:245,y:419},{num:22,x:220,y:419},{num:23,x:195,y:419},{num:24,x:170,y:419},{num:25,x:-15,y:-15},{num:26,x:146,y:434},{num:27,x:146,y:449},{num:28,x:146,y:461},{num:29,x:146,y:473},{num:30,x:146,y:485},{num:31,x:146,y:497},{num:32,x:146,y:509},{num:33,x:-15,y:-15},{num:34,x:173,y:535},{num:35,x:185,y:535},{num:36,x:197,y:535},{num:37,x:209,y:535},{num:38,x:221,y:535},{num:39,x:233,y:535},{num:40,x:245,y:535},{num:41,x:257,y:535},{num:42,x:269,y:535},{num:43,x:281,y:535},{num:44,x:293,y:535},{num:45,x:-15,y:-15},{num:46,x:350,y:535},{num:47,x:362,y:535},{num:48,x:374,y:535},{num:49,x:386,y:535},{num:50,x:398,y:535},{num:51,x:410,y:535},{num:52,x:424,y:535},{num:53,x:436,y:535},{num:54,x:448,y:535},{num:55,x:460,y:535},{num:56,x:-15,y:-15}],window.MQ.posAchievementPractice=[{diamondPosX:145,diamondPosY:261,answerPosX:145,answerPosY:335},{diamondPosX:320,diamondPosY:261,answerPosX:320,answerPosY:335},{diamondPosX:492,diamondPosY:261,answerPosX:477,answerPosY:335},{diamondPosX:456,diamondPosY:379,answerPosX:492,answerPosY:455},{diamondPosX:320,diamondPosY:379,answerPosX:320,answerPosY:455},{diamondPosX:146,diamondPosY:379,answerPosX:175,answerPosY:455},{diamondPosX:204,diamondPosY:500,answerPosX:145,answerPosY:572},{diamondPosX:320,diamondPosY:500,answerPosX:320,answerPosY:572},{diamondPosX:492,diamondPosY:500,answerPosX:492,answerPosY:572}]}function V(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var W=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dataBetCreateRoom=null,this.idbetCreateRoom=null,this._dataPlaylistCreateRoom=null,this.idPlaylistCreateRoom=null,this._dataGenresQuickPlay=null,this.idGenresQuickPlay=null,this._dataListRoomEventMode=null,this.idListRoomEventMode=null,this._dataRankingEventmode=null,this.idRankingEventMode=null,this._dataRankingDiamond=null,this.idRankingDiamond=null,this._dataRankingLevel=null,this.idRankingLevel=null,this._dataRankingOnlineMode=null,this.idRankingOnlineMode=null,this._dataRankingTurnBase=null,this.idRankingTurnBase=null}var t,n,i;return t=e,(n=[{key:"removeIdBetCreateRoom",value:function(){null!==this.idbetCreateRoom&&(game.time.events.remove(this.idbetCreateRoom),this.idbetCreateRoom=null)}},{key:"callResetDataBetCreateRoom",value:function(){this.removeIdBetCreateRoom(),this.idbetCreateRoom=game.time.events.add(30*Phaser.Timer.SECOND,this.resetDataBetCreateRoom,this)}},{key:"resetDataBetCreateRoom",value:function(){this._dataBetCreateRoom=null}},{key:"removeIdPlaylistCreateRoom",value:function(){null!==this.idPlaylistCreateRoom&&(game.time.events.remove(this.idPlaylistCreateRoom),this.idPlaylistCreateRoom=null)}},{key:"callResetDataPlaylistCreateRoom",value:function(){this.removeIdPlaylistCreateRoom(),this.idPlaylistCreateRoom=game.time.events.add(30*Phaser.Timer.SECOND,this.resetDataPlaylistCreateRoom,this)}},{key:"resetDataPlaylistCreateRoom",value:function(){this._dataPlaylistCreateRoom=null}},{key:"removeIdGenresQuickPlay",value:function(){null!==this.idGenresQuickPlay&&(game.time.events.remove(this.idGenresQuickPlay),this.idGenresQuickPlay=null)}},{key:"callResetDataGenresQuickPlay",value:function(){this.removeIdGenresQuickPlay(),this.idGenresQuickPlay=game.time.events.add(30*Phaser.Timer.SECOND,this.resetDataGenresQuickPlay,this)}},{key:"resetDataGenresQuickPlay",value:function(){this._dataGenresQuickPlay=null}},{key:"removeIdListRoomEventMode",value:function(){null!==this.idListRoomEventMode&&(game.time.events.remove(this.idListRoomEventMode),this.idListRoomEventMode=null)}},{key:"callResetListRoomEventMode",value:function(){this.removeIdListRoomEventMode(),this.idListRoomEventMode=game.time.events.add(30*Phaser.Timer.SECOND,this.resetDataListRoomEventMode,this)}},{key:"resetDataListRoomEventMode",value:function(){this._dataListRoomEventMode=null}},{key:"removeIdRankingEventmode",value:function(){null!==this.idRankingEventMode&&(game.time.events.remove(this.idRankingEventMode),this.idRankingEventMode=null)}},{key:"callResetRankingEventmode",value:function(){this.removeIdRankingEventmode(),this.idRankingEventMode=game.time.events.add(5*Phaser.Timer.SECOND,this.resetDataRankingEventmode,this)}},{key:"resetDataRankingEventmode",value:function(){this._dataRankingEventmode=null}},{key:"removeIdRankingDiamond",value:function(){null!==this.idRankingDiamond&&(game.time.events.remove(this.idRankingDiamond),this.idRankingDiamond=null)}},{key:"callResetRankingDiamond",value:function(){this.removeIdRankingDiamond(),this.idRankingDiamond=game.time.events.add(60*Phaser.Timer.SECOND,this.resetDataRankingDiamond,this)}},{key:"resetDataRankingDiamond",value:function(){this._dataRankingDiamond=null}},{key:"removeIdRankingLevel",value:function(){null!==this.idRankingLevel&&(game.time.events.remove(this.idRankingLevel),this.idRankingLevel=null)}},{key:"callResetRankingLevel",value:function(){this.removeIdRankingLevel(),this.idRankingLevel=game.time.events.add(60*Phaser.Timer.SECOND,this.resetDataRankingLevel,this)}},{key:"resetDataRankingLevel",value:function(){this._dataRankingLevel=null}},{key:"removeIdRankingOnlineMode",value:function(){null!==this.idRankingOnlineMode&&(game.time.events.remove(this.idRankingOnlineMode),this.idRankingOnlineMode=null)}},{key:"callResetRankingOnlineMode",value:function(){this.removeIdRankingOnlineMode(),this.idRankingOnlineMode=game.time.events.add(60*Phaser.Timer.SECOND,this.resetDataRankingOnlineMode,this)}},{key:"resetDataRankingOnlineMode",value:function(){this._dataRankingOnlineMode=null}},{key:"removeIdRankingTurnBase",value:function(){null!==this.idRankingTurnBase&&(game.time.events.remove(this.idRankingTurnBase),this.idRankingTurnBase=null)}},{key:"callResetRankingTurnBase",value:function(){this.removeIdRankingTurnBase(),this.idRankingTurnBase=game.time.events.add(60*Phaser.Timer.SECOND,this.resetDataRankingTurnBase,this)}},{key:"resetDataRankingTurnBase",value:function(){this._dataRankingTurnBase=null}},{key:"resetDataServer",value:function(){this.removeIdBetCreateRoom(),this._dataBetCreateRoom=null,this.removeIdPlaylistCreateRoom(),this._dataPlaylistCreateRoom=null,this.removeIdGenresQuickPlay(),this._dataGenresQuickPlay=null,this.removeIdListRoomEventMode(),this._dataListRoomEventMode=null,this.removeIdRankingEventmode(),this._dataRankingEventmode=null,this.removeIdRankingDiamond(),this._dataRankingDiamond=null,this.removeIdRankingLevel(),this._dataRankingLevel=null,this.removeIdRankingOnlineMode(),this._dataRankingOnlineMode=null,this.removeIdRankingTurnBase(),this._dataRankingTurnBase=null}},{key:"dataBetCreateRoom",get:function(){return this._dataBetCreateRoom},set:function(e){this._dataBetCreateRoom=e}},{key:"dataPlaylistCreateRoom",get:function(){return this._dataPlaylistCreateRoom},set:function(e){this._dataPlaylistCreateRoom=e,this.callResetDataPlaylistCreateRoom()}},{key:"dataGenresQuickPlay",get:function(){return this._dataGenresQuickPlay},set:function(e){this._dataGenresQuickPlay=e}},{key:"dataListRoomEventMode",get:function(){return this._dataListRoomEventMode},set:function(e){this._dataListRoomEventMode=e,this.callResetListRoomEventMode()}},{key:"dataRankingEventmode",get:function(){return this._dataRankingEventmode},set:function(e){this._dataRankingEventmode=e,this.callResetRankingEventmode()}},{key:"dataRankingDiamond",get:function(){return this._dataRankingDiamond},set:function(e){this._dataRankingDiamond=e,this.callResetRankingDiamond()}},{key:"dataRankingLevel",get:function(){return this._dataRankingLevel},set:function(e){this._dataRankingLevel=e,this.callResetRankingLevel()}},{key:"dataRankingOnlineMode",get:function(){return this._dataRankingOnlineMode},set:function(e){this._dataRankingOnlineMode=e,this.callResetRankingOnlineMode()}},{key:"dataRankingTurnBase",get:function(){return this._dataRankingTurnBase},set:function(e){this._dataRankingTurnBase=e,this.callResetRankingTurnBase()}}])&&V(t.prototype,n),i&&V(t,i),e}();function q(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function K(e,t,n){return t&&q(e.prototype,t),n&&q(e,n),e}var z=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.positionCreateRoomData=null,this.positionDefaultResourceData=null,this.positionPopupData=null,this.positionEventModeData=null,this.positionRankingData=null,this.positionShopData=null,this.positionUserProfileData=null,this.positionDetailPlaylistData=null,this.silentchatData=null,this.udid="",this.referrer="",this.dataShop=null,this.dataPackage=null,this.ktUpdate=!1,this.isShowLoading=!1,this.MODEPLAY={OnlineMode:"OnlineMode",OnlineModeRoom:"OnlineModeRoom"},this.platform="",this.response=null,this.ktPlayAgainOnlineMode=!1,this.state="",this.modeplay="OnlineMode",this.dataPlayOnlineMode={id:0,genre_id:0,bet_id:0,bet_place:0},this.scale=1,this.dataJoinRoom=null,this.dataGennes={},this.typeMenuGenes="Local",this.playScript={playing_guide:"",play_script_questions:[]},this.botChallenge={value:0,gameLogId:0,requestId:0,opponentEntity:{},mode:"isChallengeGame",can_be_poked:0,weeklyResult:{userWon:0,opponentWon:0}},this.SIZE_AVA_UPLOAD=2097152,this.STANDARD_HEIGHT=1136,this.LOGED_IN=!1,this.LOG_IN_BY_FB=!1,this.userDescription="",this.isGetUserProfileSearch=!1,this.android_storage_link="market://details?id=com.wazzat.musicgame",this.ios_storage_link="itms-apps://itunes.apple.com/app/1440442421",this.idxHighest=-1,this.isScrollChange=!1,this.tokenYanAccount="",this.menuLoadResponses=null,this.menuOpponentsResponse=null,this.init_quests_count=0,this.new_friend_request_count=0,this.started_event_count=0,this.hoursReward=null,this.isRefreshMenu={checking:!1,updated:0},this.userOneSingal="",this.tokenOneSignal="",this.menuDragging=!1,this.dataServer=new W,this.isChallengeGameFindOpponents={checking:!1,updated:0},this.friendLists=[],this.suggestion_users=[],this.random_user=null,this.isMainQuestLoad={checking:!1,updated:0},this.mainQuestLists=[],this.mainQuestLogLists=[],this.mainNextQuest=null,this.isSoloModePlaylistRequest={checking:!1,updated:0},this.soloModePlaylists=[],this.isDailyQuestLoad={checking:!1,updated:0},this.dailyQuestLists=[],this.isAchievementLoad={checking:!1,updated:0},this.achievements=[],this.messageTurnbases=["Làm ván đi em eeii!","Chơi với em đi hihi","Khó quắc à, anh chơi đi!","Goddd damn it!"],this.checkLoadMail=0,this.checkLoadMessage=0,this.mailData=null,this.messageData=null,this.dataMessagesLocal=null,this.systemMessagesLocal=null}return K(e,null,[{key:"instance",value:function(){return this.mainData||(this.mainData=new e),this.mainData}},{key:"VERSION_AND",get:function(){return"0.0.10"}},{key:"VERSION_IOS",get:function(){return"0.0.5"}}]),K(e,[{key:"positionCreateRoom",get:function(){return null===this.positionCreateRoomData&&(this.positionCreateRoomData=JSON.parse(game.cache.getText("positionCreateRoom"))),this.positionCreateRoomData}},{key:"positionDefaultSource",get:function(){return null===this.positionDefaultResourceData&&(this.positionDefaultResourceData=JSON.parse(game.cache.getText("positionDefaultSource"))),this.positionDefaultResourceData}},{key:"positionPopup",get:function(){return null===this.positionPopupData&&(this.positionPopupData=JSON.parse(game.cache.getText("positionPopup"))),this.positionPopupData}},{key:"positionEventMode",get:function(){return null===this.positionEventModeData&&(this.positionEventModeData=JSON.parse(game.cache.getText("positionEventMode"))),this.positionEventModeData}},{key:"positionRanking",get:function(){return null===this.positionRankingData&&(this.positionRankingData=JSON.parse(game.cache.getText("positionRanking"))),this.positionRankingData}},{key:"positionShop",get:function(){return null===this.positionShopData&&(this.positionShopData=JSON.parse(game.cache.getText("positionShop"))),this.positionShopData}},{key:"positionUserProfile",get:function(){return null===this.positionUserProfileData&&(this.positionUserProfileData=JSON.parse(game.cache.getText("positionUserProfile"))),this.positionUserProfileData}},{key:"positionDetailPlaylist",get:function(){return null===this.positionDetailPlaylistData&&(this.positionDetailPlaylistData=JSON.parse(game.cache.getText("positionDetailPlaylist"))),this.positionDetailPlaylistData}},{key:"silentchat",get:function(){if(null===this.silentchatData){this.silentchatData=game.cache.getText("silentchat").split(",");for(var e=0;e<this.silentchatData.length;e++)this.silentchatData[e]=this.silentchatData[e].trim();this.silentchatData.sort(function(e,t){return t.length-e.length})}return this.silentchatData}},{key:"language",get:function(){return null==this._language&&(this._language=JSON.parse(game.cache.getText("languageGame"))),this._language}}]),e}();function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function X(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ne=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=X(this,ee(t).call(this)),console.log("Boot----------------"),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,Phaser.State),n=t,(i=[{key:"init",value:function(){game.stage.backgroundColor="#1e0e46";var e=0;e="web"===z.instance().platform?window.innerWidth/window.innerHeight:screen.width/screen.height;var t=window.GameConfig.GAME_WIDTH/window.GameConfig.GAME_HEIGHT;if(e>t);else if(e<t){var n=Math.ceil(window.GameConfig.GAME_WIDTH/e);game.scale.setGameSize(window.GameConfig.GAME_WIDTH,n),window.distanceHeight=n-window.GameConfig.GAME_HEIGHT,window.GameConfig.GAME_HEIGHT=n}game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,game.scale.pageAlignHorizontally=!0,game.time.advancedTiming=!0,game.stage.disableVisibilityChange=!0,game.sound.context.resume(),this.bootModule=new H(this)}},{key:"preload",value:function(){this.bootModule.preload()}},{key:"create",value:function(){Q(),game.state.start("Load",!0,!1,{}),$("#dangtai").remove(),$("#lds-heart").remove()}},{key:"update",value:function(){}},{key:"render",value:function(){}}])&&J(n.prototype,i),o&&J(n,o),t}();function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ae(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var le=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ae(this,se(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addAnim(),this.addTextLoading()}},{key:"addTextLoading",value:function(){this.txtLoading=new Phaser.Text(game,this.positionPlayConfig.txtLoading.x*window.GameConfig.RESIZE,this.positionPlayConfig.txtLoading.y*window.GameConfig.RESIZE,this.positionPlayConfig.txtLoading.text,this.positionPlayConfig.txtLoading.configs),this.txtLoading.anchor.set(.5),this.addChild(this.txtLoading)}},{key:"addAnim",value:function(){this.animLoad=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,460*window.GameConfig.RESIZE,"loadingPlay");this.animLoad.animations.add("run_anim_load");this.animLoad.anchor.set(.5),this.animLoad.animations.play("run_anim_load",32,!0),this.addChild(this.animLoad)}},{key:"moveTxtLoading",value:function(){this.txtLoading.y=(this.positionPlayConfig.txtLoading.y+500)*window.GameConfig.RESIZE}},{key:"deleteTxtLoading",value:function(){this.txtLoading.destroy()}}])&&oe(n.prototype,i),o&&oe(n,o),t}();function he(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sound=null,this.playId=null,this.currentLoad=null,this.dic={},this.arrSrc=[],this.idxLoad=0,this.isLoading=!1,this.arrsSoundFx=[e.buttonclick,e.dailyreward,e.clickbuttonplayeventmode,e.getrewardsolomode,e.joineventmode,e.losesolomode,e.popupeventmodeend,e.popupfinishachievement,e.popupfinishquest,e.popupinviteroom,e.popuplevelup,e.showranking,e.takereward,e.winturnbase,e.winturnbasepartymode,e.loseturnbasepartymode,e.gameovereventmode,e.streakanswer]}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllSound||(this.controllSound=new e),this.controllSound}},{key:"buttonclick",get:function(){return"img/sound/soundfx/buttonclick.mp3"}},{key:"dailyreward",get:function(){return"img/sound/soundfx/dailyreward.mp3"}},{key:"clickbuttonplayeventmode",get:function(){return"img/sound/soundfx/clickbuttonplayeventmode.mp3"}},{key:"getrewardsolomode",get:function(){return"img/sound/soundfx/getrewardsolomode.mp3"}},{key:"joineventmode",get:function(){return"img/sound/soundfx/joineventmode.mp3"}},{key:"losesolomode",get:function(){return"img/sound/soundfx/losesolomode.mp3"}},{key:"popupeventmodeend",get:function(){return"img/sound/soundfx/popupeventmodeend.mp3"}},{key:"loseturnbase",get:function(){return"img/sound/soundfx/loseturnbasepartymode.mp3"}},{key:"popupfinishachievement",get:function(){return"img/sound/soundfx/popupfinishachievement.mp3"}},{key:"popupfinishquest",get:function(){return"img/sound/soundfx/popupfinishquest.mp3"}},{key:"popupinviteroom",get:function(){return"img/sound/soundfx/popupinviteroom.mp3"}},{key:"popuplevelup",get:function(){return"img/sound/soundfx/popuplevelup.mp3"}},{key:"showranking",get:function(){return"img/sound/soundfx/showranking.mp3"}},{key:"takereward",get:function(){return"img/sound/soundfx/takereward.mp3"}},{key:"winturnbase",get:function(){return"img/sound/soundfx/winturnbase.mp3"}},{key:"winturnbasepartymode",get:function(){return"img/sound/soundfx/winturnbasepartymode.mp3"}},{key:"loseturnbasepartymode",get:function(){return"img/sound/soundfx/loseturnbasepartymode.mp3"}},{key:"gameovereventmode",get:function(){return"img/sound/soundfx/gameovereventmode.mp3"}},{key:"streakanswer",get:function(){return"img/sound/soundfx/streakanswer.mp3"}}],(n=[{key:"loadSoundArray",value:function(e){!1===this.isLoading&&(this.arrSrc=e,this.isLoading=!0,this.idxLoad=0,this.loadItemInArray(this.arrSrc[this.idxLoad]))}},{key:"loadItemInArray",value:function(e){var t=this;this.dic[e]?this.checkLoadContinuteArray():(this.dic[e]=new Howl({src:[e]}),this.dic[e].on("load",function(){t.checkLoadContinuteArray()}),this.dic[e].on("loaderror",function(){t.checkLoadContinuteArray()}))}},{key:"checkLoadContinuteArray",value:function(){this.idxLoad++,this.idxLoad<this.arrSrc.length?this.loadItemInArray(this.arrSrc[this.idxLoad]):this.isLoading=!1,this.removeSound()}},{key:"beginLoad",value:function(){LogConsole.log("beginLoad sound -------------------"),this.loadSoundArray(this.arrsSoundFx)}},{key:"playSound",value:function(e){!1===game.paused&&1==window.GameConfig.SOUND_FX&&(this.removeSound(),"ctx"in Howler&&null!==Howler.ctx&&("suspended"!==Howler.ctx.state&&"interrupted"!==Howler.ctx.state||Howler.ctx.resume()),this.src=e,this.dic[e]?(this.sound=this.dic[e],this.playId=this.sound.play()):(this.sound=new Howl({src:[e]}),this.sound.on("end",function(){}),this.playId=this.sound.play()),this.sound.volume(1))}},{key:"removeSound",value:function(){null!==this.sound&&null!==this.playId&&(this.sound.stop(this.playId),this.sound=null)}}])&&he(t.prototype,n),i&&he(t,i),e}();function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fe(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ye=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=fe(this,pe(t).call(this,game))).positionBootConfig=JSON.parse(game.cache.getText("positionBootConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addFireWork(),this.addFlower1(),this.addFlower2()}},{key:"addFireWork",value:function(){this.fireWork=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,180*window.GameConfig.RESIZE,"firework"),this.fireWork.anchor.set(.5),this.fireWork.scale.set(1.3),this.addChild(this.fireWork);this.fireWork.animations.add("run_firework");this.fireWork.animations.play("run_firework",30,!0)}},{key:"addFlower1",value:function(){this.flower1=new Phaser.Sprite(game,this.positionBootConfig.tet_theme.flower1.x,this.positionBootConfig.tet_theme.flower1.y,this.positionBootConfig.tet_theme.flower1.nameAtlas,this.positionBootConfig.tet_theme.flower1.nameSprite),this.flower1.angle=4,this.addChild(this.flower1),game.add.tween(this.flower1).to({angle:0},1500,Phaser.Easing.Linear.None,!0,0,-1).yoyo(!0,0)}},{key:"addFlower2",value:function(){this.flower2=new Phaser.Sprite(game,this.positionBootConfig.tet_theme.flower2.x,this.positionBootConfig.tet_theme.flower2.y,this.positionBootConfig.tet_theme.flower2.nameAtlas,this.positionBootConfig.tet_theme.flower2.nameSprite),this.flower2.angle=5,this.addChild(this.flower2),game.add.tween(this.flower2).to({angle:0},2e3,Phaser.Easing.Linear.None,!0,0,-1).yoyo(!0,0)}}])&&de(n.prototype,i),o&&de(n,o),t}();function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function we(e,t){return!t||"object"!==me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _e=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=we(this,be(t).call(this,e))).isLoadAfterComplete=!1,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Se(e,t)}(t,H),n=t,(i=[{key:"preloadForLoad",value:function(){ce.instance().beginLoad(),game.load.text("positionDefaultSource","img/config/positionDefaultSource.json"+"?v=".concat(window.VersionClient)),game.load.text("positionIsNewUserConfig","img/config/positionIsNewUserConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionPopup","img/config/positionPopup.json"+"?v=".concat(window.VersionClient)),game.load.text("playScript","img/config/playScript.json"+"?v=".concat(window.VersionClient)),this.loadXML(),game.load.text("positionMenuConfig","img/config/positionMenuConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("dailyRewardConfig","img/config/dailyRewardConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("languageGame","img/config/languageGame.json"+"?v=".concat(window.VersionClient)),game.load.text("positionSetting","img/config/positionSetting.json"+"?v=".concat(window.VersionClient)),game.load.text("songDetailScreenConfig","img/config/songDetailScreenConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionDisconnectConfig","img/config/positionDisconnectConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionIsNewUserConfig","img/config/positionIsNewUserConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionChatScreenConfig","img/config/positionChatScreenConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionFriendRequestConfig","img/config/positionFriendRequestConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("silentchat","img/config/silentchat.txt"+"?v=".concat(window.VersionClient)),game.load.text("positionUserProfile","img/config/positionUserProfile.json"+"?v=".concat(window.VersionClient)),game.load.text("positionQAndAConfig","img/config/questAndAchieveConfig.json"+"?v=".concat(window.VersionClient)),game.load.spritesheet("disconnect","img/assetss/Animation/Disconnect/sprites.png"+"?v=".concat(window.VersionClient),210,200.5,9),game.load.spritesheet("btnRankAnim","img/assetss/Animation/Fireworks_Squence/buttonRankAnim.png"+"?v=".concat(window.VersionClient),64,62,26),game.load.spritesheet("CircleScale","img/animations/CircleScale/sprites.png"+"?v=".concat(window.VersionClient),215.25,215.25,30),game.load.spritesheet("ButtonEvent","img/animations/EventBtn/sprites.png"+"?v=".concat(window.VersionClient),89,89,10),game.load.spritesheet("ButtonGift","img/animations/GiftBtn/sprites.png"+"?v=".concat(window.VersionClient),89,89,12),game.load.spritesheet("ButtonQuest","img/animations/QuestBtn/sprites.png"+"?v=".concat(window.VersionClient),89,89,12),game.load.spritesheet("ButtonRank","img/animations/RankBtn/sprites.png"+"?v=".concat(window.VersionClient),89,89,18),game.load.spritesheet("FindGameButton","img/animations/FindGameBtn/sprites.png"+"?v=".concat(window.VersionClient),177,115,18),game.load.spritesheet("PracticeButton","img/animations/PracticeBtn/sprites.png"+"?v=".concat(window.VersionClient),177,115,14),game.load.spritesheet("PartyButton","img/animations/PartyBtn/sprites.png"+"?v=".concat(window.VersionClient),177,115,18),game.load.spritesheet("56Questions","img/assetss/Animation/56Questions/sprites.png"+"?v=".concat(window.VersionClient),125,125,30),game.load.spritesheet("ButtonShop","img/animations/ShopBtn/shopBtn.png"+"?v=".concat(window.VersionClient),90,90,12),game.load.image("bg-playlist","img/background/bg-playlist.png"+"?v=".concat(window.VersionClient)),game.load.image("bg_scrollMenu","img/assetss/playlist/bg_scrollMenu.png"+"?v=".concat(window.VersionClient)),game.load.image("BG_Opacity","img/background/BG_Opacity.png"+"?v=".concat(window.VersionClient)),game.load.image("BG_Opacity_100","img/background/BG_Opacity_100.png"+"?v=".concat(window.VersionClient)),game.load.onFileComplete.add(this.fileComplete,this)}},{key:"fileComplete",value:function(e,t,n,i,o){var a=e;this.loadingTxt.setText("Đang tải... ".concat(a," %")),100==e&&(game.load.onFileComplete.removeAll(),game.load.onLoadComplete.add(this.onLoadAfterComplete),game.load.start())}},{key:"onLoadAfterComplete",value:function(){LogConsole.log("on load complete")}},{key:"loadXML",value:function(){game.load.atlas("defaultSource","img/atlas/defaultSource.png"+"?v=".concat(window.VersionClient),"img/atlas/defaultSource.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("popup","img/atlas/popup.png"+"?v=".concat(window.VersionClient),"img/atlas/popup.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.spritesheet("trueanswer","img/atlas/TrueAnswer.png"+"?v=".concat(window.VersionClient),180,180,19),game.load.spritesheet("failanswer","img/atlas/FailAnswer.png"+"?v=".concat(window.VersionClient),180,180,19),game.load.atlas("limitTurn","img/atlas/limitTurn.png"+"?v=".concat(window.VersionClient),"img/atlas/limitTurn.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("playlistSprites","img/atlas/choosePlaylist.png"+"?v=".concat(window.VersionClient),"img/atlas/choosePlaylist.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("otherSprites","img/atlas/OtherSprites.png"+"?v=".concat(window.VersionClient),"img/atlas/OtherSprites.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.spritesheet("actionphaseanswer1","img/atlas/ActionPhaseAnswer1.png"+"?v=".concat(window.VersionClient),350,350,24),game.load.spritesheet("actionphaseanswer2","img/atlas/ActionPhaseAnswer2.png"+"?v=".concat(window.VersionClient),336,317,24),game.load.spritesheet("actionphaseanswer3","img/atlas/ActionPhaseAnswer3.png"+"?v=".concat(window.VersionClient),382,320,23),game.load.atlas("dailyRewardSprites","img/atlas/dailyReward.png"+"?v=".concat(window.VersionClient),"img/atlas/dailyReward.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("mainMenuSprites","img/atlas/mainMenu.png"+"?v=".concat(window.VersionClient),"img/atlas/mainMenu.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("songDetailSprites","img/atlas/songDetail.png"+"?v=".concat(window.VersionClient),"img/atlas/songDetail.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.spritesheet("EffectAchiment","img/atlas/EffectAchiment.png"+"?v=".concat(window.VersionClient),112*z.instance().scale,114*z.instance().scale,20),game.load.spritesheet("SoloModeStar","img/animations/SoloModeStar/SoloModeStar.png"+"?v=".concat(window.VersionClient),125*z.instance().scale,125*z.instance().scale,26),game.load.atlas("questAndAchieveSprites","img/atlas/questAchievement.png"+"?v=".concat(window.VersionClient),"img/atlas/questAchievement.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("IconChatOnlineMode","img/atlas/IconChatGame.png"+"?v=".concat(window.VersionClient),"img/atlas/IconChatGame.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("disconnectSprites","img/atlas/disconnect.png"+"?v=".concat(window.VersionClient),"img/atlas/disconnect.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("isNewUserSprites","img/atlas/newUser.png"+"?v=".concat(window.VersionClient),"img/atlas/newUser.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("practicePopupSprites","img/assetss/Practice/Ingame/sprites.png"+"?v=".concat(window.VersionClient),"img/assetss/Practice/Ingame/sprites.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("mailSprites","img/atlas/mail.png"+"?v=".concat(window.VersionClient),"img/atlas/mail.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("friendRequestSprites","img/atlas/friendRequest.png"+"?v=".concat(window.VersionClient),"img/atlas/friendRequest.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("settingSprites","img/atlas/setting.png"+"?v=".concat(window.VersionClient),"img/atlas/setting.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.audio("beep_audio","img/assetss/sound/PipCountDown.mp3"+"?v=".concat(window.VersionClient)),game.load.image("ava_bot","img/ava_bot.jpg")}},{key:"createSpritesForLoadState",value:function(){this.positionBootConfig=this.getpositionBootConfig(),this.addBackgroundSprite(),this.addLogoSprite(),this.addAnimLoading(),this.addLoadingProgressTxt(),this.addTermText(),this.addDance()}},{key:"addLoadingProgressTxt",value:function(){this.loadingTxt=game.add.text(this.positionBootConfig.txt_loading.x*window.GameConfig.RESIZE,this.positionBootConfig.txt_loading.y*window.GameConfig.RESIZE,this.positionBootConfig.txt_loading.text,this.positionBootConfig.txt_loading.configs),this.loadingTxt.anchor.set(.5)}},{key:"addAnimLoading",value:function(){var e=new le;this.state.add.existing(e),e.deleteTxtLoading()}},{key:"addThemeTET",value:function(){var e=new ye;this.state.add.existing(e)}}])&&ve(n.prototype,i),o&&ve(n,o),t}();function Ee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"LOGIN",get:function(){return"screen_login"}},{key:"MAIN_MENU",get:function(){return"screen_main_menu"}},{key:"QUEST_ACHIEVEMENT",get:function(){return"screen_quest_achievement"}},{key:"EVENT_MODE",get:function(){return"screen_event_mode"}},{key:"QUICK_PLAY",get:function(){return"screen_quick_play"}},{key:"RANKING_ALL",get:function(){return"screen_ranking_all"}},{key:"SOLO_MODE",get:function(){return"screen_solo_mode"}},{key:"ONLINE_MODE",get:function(){return"screen_online_mode"}},{key:"MAIL",get:function(){return"screen_mail"}},{key:"ADD_FRIEND",get:function(){return"screen_add_friend"}},{key:"NEW_USER",get:function(){return"screen_new_user"}},{key:"TURN_BASE",get:function(){return"screen_turn_base"}},{key:"POPUP_ILLEGAL_TURN",get:function(){return"screen_popup_illegal_turn"}},{key:"DAILY_REWARD",get:function(){return"screen_daily_reward"}},{key:"SOLOMODE_TIMEOUT",get:function(){return"popup_solomode_timeout"}},{key:"SOLOMODE_LOSE_POPUP",get:function(){return"popup_solomode_lose"}},{key:"SOLOMODE_REWARD",get:function(){return"popup_solomode_reward"}},{key:"SOLOMODE_NOT_REWARD",get:function(){return"popup_solomode_not_reward"}},{key:"SOLOMODE_DONE",get:function(){return"popup_solomode_done"}},{key:"ANIM_CLAIM_REWARD",get:function(){return"anim_claim_reward"}},{key:"QUEST_CLAIM_POPUP",get:function(){return"popup_claim_quest"}},{key:"ACHIEVEMENT_CLAIM_POPUP",get:function(){return"popup_claim_achievement"}},{key:"CHAT_SCREEN",get:function(){return"chat_screen"}},{key:"SETTING_GAME",get:function(){return"screen_setting"}}],(n=null)&&Ee(t.prototype,n),i&&Ee(t,i),e}();function ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"LEVEL_UP_NOTIFICATION",get:function(){return"LEVEL_UP_NOTIFICATION"}},{key:"CHAT_ONLINE_MODE",get:function(){return"CHAT_ONLINE_MODE"}},{key:"CHAT_EVENT_MODE",get:function(){return"CHAT_EVENT_MODE"}},{key:"FB_USER_INVITE_FRIEND_REQUEST",get:function(){return"FB_USER_INVITE_FRIEND_REQUEST"}},{key:"FB_USER_INVITE_FRIEND_RESPONSE",get:function(){return"FB_USER_INVITE_FRIEND_RESPONSE"}},{key:"FB_USER_SHARED_RESULT_REQUEST",get:function(){return"FB_USER_SHARED_RESULT_REQUEST"}},{key:"FB_USER_SHARED_RESULT_RESPONSE",get:function(){return"FB_USER_SHARED_RESULT_RESPONSE"}},{key:"BROADCASH_NOTIFICATION",get:function(){return"BROADCASH_NOTIFICATION"}},{key:"INIT_CLIENT_GAME_DATA_REQUEST",get:function(){return"INIT_CLIENT_GAME_DATA_REQUEST"}},{key:"INIT_CLIENT_GAME_DATA_RESPONSE",get:function(){return"INIT_CLIENT_GAME_DATA_RESPONSE"}},{key:"TURNBASE_RELOAD_RANDOM_OPPONENT_REQUEST",get:function(){return"TURNBASE_RELOAD_RANDOM_OPPONENT_REQUEST"}},{key:"TURNBASE_RELOAD_RANDOM_OPPONENT_RESPONSE",get:function(){return"TURNBASE_RELOAD_RANDOM_OPPONENT_RESPONSE"}},{key:"INIT_ONLINE_MODE_BET_REQUEST",get:function(){return"INIT_ONLINE_MODE_BET_REQUEST"}},{key:"INIT_ONLINE_MODE_BET_RESPONSE",get:function(){return"INIT_ONLINE_MODE_BET_RESPONSE"}},{key:"INIT_ONLINE_MODE_ROOM_BET_REQUEST",get:function(){return"INIT_ONLINE_MODE_ROOM_BET_REQUEST"}},{key:"INIT_ONLINE_MODE_ROOM_BET_RESPONSE",get:function(){return"INIT_ONLINE_MODE_ROOM_BET_RESPONSE"}},{key:"INIT_EVENT_LIST_REQUEST",get:function(){return"INIT_EVENT_LIST_REQUEST"}},{key:"INIT_EVENT_LIST_RESPONSE",get:function(){return"INIT_EVENT_LIST_RESPONSE"}},{key:"INIT_SUGGESTION_OPPONENT_REQUEST",get:function(){return"INIT_SUGGESTION_OPPONENT_REQUEST"}},{key:"INIT_SUGGESTION_OPPONENT_RESPONSE",get:function(){return"INIT_SUGGESTION_OPPONENT_RESPONSE"}},{key:"INIT_PLAYLIST_LEVEL_SETTING_REQUEST",get:function(){return"INIT_PLAYLIST_LEVEL_SETTING_REQUEST"}},{key:"INIT_PLAYLIST_LEVEL_SETTING_RESPONSE",get:function(){return"INIT_PLAYLIST_LEVEL_SETTING_RESPONSE"}},{key:"INIT_MAIN_QUEST_DATA_REQUEST",get:function(){return"INIT_MAIN_QUEST_DATA_REQUEST"}},{key:"INIT_MAIN_QUEST_DATA_RESPONSE",get:function(){return"INIT_MAIN_QUEST_DATA_RESPONSE"}},{key:"INIT_SHOP_PLAYLIST_REQUEST",get:function(){return"INIT_SHOP_PLAYLIST_REQUEST"}},{key:"INIT_SHOP_PLAYLIST_RESPONSE",get:function(){return"INIT_SHOP_PLAYLIST_RESPONSE"}},{key:"INIT_USER_PLAYLIST_MAPPING_REQUEST",get:function(){return"INIT_USER_PLAYLIST_MAPPING_REQUEST"}},{key:"INIT_USER_PLAYLIST_MAPPING_RESPONSE",get:function(){return"INIT_USER_PLAYLIST_MAPPING_RESPONSE"}},{key:"EVENT_UPDATE",get:function(){return"EVENT_UPDATE"}},{key:"ONE_SIGNAL_UPDATE_REQUEST",get:function(){return"ONE_SIGNAL_UPDATE_REQUEST"}}],(n=null)&&ke(t.prototype,n),i&&ke(t,i),e}();function Oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){LogConsole.log("SendFbUserInvite : ");for(var n=new SFS2X.SFSArray,i=0;i<t.length;i++)LogConsole.log(t[i]),n.addUtfString(t[i]);var o=new SFS2X.SFSObject;return o.putUtfString("invite_id",e),o.putSFSArray("fb_ids",n),o}}],(n=null)&&Oe(t.prototype,n),i&&Oe(t,i),e}();function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ie=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event={loginComplete:new Phaser.Signal,loginError:new Phaser.Signal,logoutDone:new Phaser.Signal,logoutErr:new Phaser.Signal,loginStatusUnknown:new Phaser.Signal}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.fbMobile||(this.fbMobile=new e),this.fbMobile}}],(n=[{key:"init",value:function(){facebookConnectPlugin.getLoginStatus(this.getLoginStatusSuccess.bind(this),this.getLoginStatusFail.bind(this))}},{key:"getLoginStatusSuccess",value:function(e){console.log("getLoginStatus succeed, statua written in log"),console.log(e),"connected"===e.status?(z.instance().LOG_IN_BY_FB=!0,this.onLoginSuccess(e)):"unknown"===e.status&&this.event.loginStatusUnknown.dispatch()}},{key:"login",value:function(){facebookConnectPlugin.login(["public_profile","email","user_gender","user_friends"],this.onLoginSuccess.bind(this),this.onLoginError.bind(this))}},{key:"logout",value:function(e){facebookConnectPlugin.logout(function(t){z.instance().LOG_IN_BY_FB=!1;var n="";"OK"==t&&(n="unknown"),e({status:n})},function(t){console.log("logout fail!"),console.log(t),e(t)})}},{key:"getLoginStatusFail",value:function(e){console.log("getLoginStatus fail, error written in log"),console.log(e)}},{key:"onLoginSuccess",value:function(e){console.log("login succeed, userData written in log"),console.log(e),this.event.loginComplete.dispatch(e.authResponse)}},{key:"onLoginError",value:function(e){console.log("login fail, error written in log"),console.log(e),this.event.loginError.dispatch()}},{key:"logEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;facebookConnectPlugin.logEvent(z.instance().platform+"_"+e,{},t,this.onLogEventSuccess.bind(this),this.onLogEventError.bind(this))}},{key:"onLogEventSuccess",value:function(e){console.log("onLogEventSuccess"),console.log(e)}},{key:"onLogEventError",value:function(e){console.log("onLogEventError"),console.log(e)}},{key:"share",value:function(){var e=game.canvas.toDataURL("image/png");console.log("data image------------"),console.log(e);var t={message:"Wazzat so tài âm nhạc",subject:"Wazzat",files:[e]};window.plugins.socialsharing.shareWithOptions(t,function(e){console.log("share ok"),console.log(e),mZ.instance().sendData(Pe.FB_USER_SHARED_RESULT_REQUEST,null)},function(e){console.log("share fail"),console.log(e)})}},{key:"dataURItoBlob",value:function(e){for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),i=new Uint8Array(n),o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return new Blob([n],{type:"image/png"})}},{key:"shareSuccess",value:function(e){console.log("showDialog success, data written in log"),console.log(e),mZ.instance().sendData(Pe.FB_USER_SHARED_RESULT_REQUEST,null)}},{key:"shareError",value:function(e){console.log("showDialog fail, error written in log"),console.log(e)}},{key:"invite",value:function(){console.log("invite");facebookConnectPlugin.showDialog({method:"apprequests",message:"So Tài Âm Nhạc",data:{},title:"So Tài Âm Nhạc",actionType:"askfor",filters:"app_non_users"},this.inviteSuccess.bind(this),this.inviteError.bind(this))}},{key:"inviteSuccess",value:function(e){console.log("inviteSuccess success, data written in log"),console.log(e),"object"===xe(e)&&e.hasOwnProperty("requestId")&&mZ.instance().sendData(Pe.FB_USER_INVITE_FRIEND_REQUEST,Re.begin(e.requestId,e.recipientsIds))}},{key:"inviteError",value:function(e){console.log("inviteError fail, error written in log"),console.log(e)}}])&&Te(t.prototype,n),i&&Te(t,i),e}();function Ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.fbChecking||(this.fbChecking=new e),this.fbChecking}},{key:"Login_buttons",get:function(){return"Button_Login"}},{key:"Choose_genre_Buttons",get:function(){return"Button_Choose_genre"}},{key:"Find_Game_turnbase_mode_button",get:function(){return"Button_turnbase_mode"}},{key:"Find_Game_turbase_random_opponent_button",get:function(){return"Button_turbase_random_opponent"}},{key:"Find_Game_Suggestion_Opponent_profile_button",get:function(){return"Button_Suggestion_Opponent_profile"}},{key:"Party_online_mode_button",get:function(){return"Button_Party_online_mode"}},{key:"Party_online_mode_quickplay_button",get:function(){return"Button_quickplay"}},{key:"Party_online_mode_Creatroom_button",get:function(){return"Button_Creatroom"}},{key:"Solo_mode_button",get:function(){return"Button_Solo_mode"}},{key:"Solo_mode_quiz_play_button",get:function(){return"Button_Solo_mode_quiz_play"}},{key:"Solo_mode_ranking_button",get:function(){return"Button_Solo_mode_ranking"}},{key:"Event_mode_button",get:function(){return"Button_Event_mode"}},{key:"Event_mode_join_room_button",get:function(){return"Button_Event_mode_join_room"}},{key:"Event_mode_play_button",get:function(){return"Button_Event_mode_play"}},{key:"Ranking_level_button",get:function(){return"Button_Ranking_level"}},{key:"Ranking_diamond_button",get:function(){return"Button_Ranking_diamond"}},{key:"Ranking_turnbase_button",get:function(){return"Button_Ranking_turnbase"}},{key:"Ranking_online_button",get:function(){return"Button_Ranking_online"}},{key:"Quest_main_button",get:function(){return"Button_Quest_main"}},{key:"Quest_Achievement_button",get:function(){return"Button_Quest_Achievement"}},{key:"Quest_Daily_button",get:function(){return"Button_Quest_Daily"}},{key:"Mail_button",get:function(){return"Button_Mail"}},{key:"Shop_playlist_button",get:function(){return"Button_Shop_playlist"}},{key:"Shop_resource_button",get:function(){return"Button_Shop_resource"}},{key:"Shop_items_support_butotn",get:function(){return"Button_Shop_items_support_butotn"}},{key:"Shop_Vip_button",get:function(){return"Button_Shop_Vip"}},{key:"Friend_add_button",get:function(){return"Button_Friend_add"}},{key:"Loading",get:function(){return"Sreen_Loading"}},{key:"LoginScreen",get:function(){return"Sreen_LoginScreen"}},{key:"Mainmenu",get:function(){return"Sreen_Mainmenu"}},{key:"Choose_genre",get:function(){return"Sreen_Choose_genre"}},{key:"Main_menu",get:function(){return"Sreen_Main_menu"}},{key:"Daily_reward",get:function(){return"Sreen_Daily_reward"}},{key:"Find_Game_turnbase_mode",get:function(){return"Sreen_Find_Game_turnbase_mode"}},{key:"Find_Game_turbase_random_opponent",get:function(){return"Sreen_turbase_random_opponent"}},{key:"Find_Game_Suggestion_Opponent_profile",get:function(){return"Sreen_Suggestion_Opponent_profile"}},{key:"Party_online_mode",get:function(){return"Sreen_Party_online_mode"}},{key:"Party_online_mode_quickplay",get:function(){return"Sreen_Party_online_mode_quickplay"}},{key:"Party_online_mode_Creatroom",get:function(){return"Sreen_Party_online_mode_Creatroom"}},{key:"Solo_mode",get:function(){return"Sreen_Solo_mode"}},{key:"Solo_mode_quiz_play",get:function(){return"Sreen_Solo_mode_quiz_play"}},{key:"Solo_mode_ranking",get:function(){return"Sreen_Solo_mode_ranking"}},{key:"Event_mode",get:function(){return"Sreen_Event_mode"}},{key:"Event_mode_join_room",get:function(){return"Sreen_Event_mode_join_room"}},{key:"Event_mode_play",get:function(){return"Sreen_Event_mode_play"}},{key:"Ranking_level",get:function(){return"Sreen_Ranking_level"}},{key:"Ranking_diamond",get:function(){return"Sreen_Ranking_diamond"}},{key:"Ranking_turnbase",get:function(){return"Sreen_Ranking_turnbase"}},{key:"Ranking_online",get:function(){return"Sreen_Ranking_online"}},{key:"Quest_main",get:function(){return"Sreen_Quest_main"}},{key:"Quest_Achievement",get:function(){return"Sreen_Quest_Achievement"}},{key:"Quest_Daily",get:function(){return"Sreen_Quest_Daily"}},{key:"Mail",get:function(){return"Sreen_Mail"}},{key:"Shop_playlist",get:function(){return"Sreen_Shop_playlist"}},{key:"Shop_resource",get:function(){return"Sreen_Shop_resource"}},{key:"Shop_items_support",get:function(){return"Sreen_Shop_items_support"}},{key:"Shop_Vip",get:function(){return"Sreen_Shop_Vip"}},{key:"Friend_add",get:function(){return"Sreen_Friend_add"}},{key:"Popup_Quest",get:function(){return"Sreen_Popup_Quest"}},{key:"Popup_Achievement",get:function(){return"Sreen_Popup_Achievement"}},{key:"Popup_invite_online_room",get:function(){return"Sreen_Popup_invite_online_room"}},{key:"Screen_Play_Script",get:function(){return"screen_play_script"}},{key:"Screen_Play_Script_Skip",get:function(){return"screen_play_script_skip"}},{key:"total_time",get:function(){return"total_time"}},{key:"play_time",get:function(){return"play_time"}},{key:"pro_bad_imp",get:function(){return"pro_bad_imp"}},{key:"pro_bad_click",get:function(){return"pro_bad_click"}},{key:"pro_fad_imp",get:function(){return"pro_fad_imp"}},{key:"pro_fad_click",get:function(){return"pro_fad_click"}},{key:"pro_rad_imp",get:function(){return"pro_rad_imp"}},{key:"pro_quiz_start_createroom",get:function(){return"pro_quiz_start_createroom"}},{key:"pro_quiz_end_createroom",get:function(){return"pro_quiz_end_createroom"}},{key:"pro_quiz_start_quickplay",get:function(){return"pro_quiz_start_quickplay"}},{key:"pro_quiz_end_quickplay",get:function(){return"pro_quiz_end_quickplay"}},{key:"pro_quiz_start_turnbase",get:function(){return"pro_quiz_start_turnbase"}},{key:"pro_quiz_end_turnbase",get:function(){return"pro_quiz_end_turnbase"}},{key:"pro_quiz_start_solomode",get:function(){return"pro_quiz_start_solomode"}},{key:"pro_quiz_end_solomode",get:function(){return"pro_quiz_end_solomode"}},{key:"pro_quiz_start_eventmode",get:function(){return"pro_quiz_start_eventmode"}},{key:"pro_quiz_end_eventmode",get:function(){return"pro_quiz_end_eventmode"}},{key:"InterstitialTurnBase",get:function(){return"InterstitialTurnBase"}},{key:"InterstitialQuickPlay",get:function(){return"InterstitialQuickPlay"}},{key:"InterstitialCreateRoom",get:function(){return"InterstitialCreateRoom"}},{key:"InterstitialSoloModeWin",get:function(){return"InterstitialSoloModeWin"}},{key:"InterstitialSoloModeGameOver",get:function(){return"InterstitialSoloModeGameOver"}},{key:"InterstitialQuest",get:function(){return"InterstitialQuest"}},{key:"InterstitialAchievement",get:function(){return"InterstitialAchievement"}},{key:"InterstitialDoneSoloMode",get:function(){return"InterstitialDoneSoloMode"}},{key:"InterstitialEventMode",get:function(){return"InterstitialEventMode"}},{key:"RewardVideoInappDiamond",get:function(){return"RewardVideoInappDiamond"}},{key:"RewardVideoInappTicket",get:function(){return"RewardVideoInappTicket"}},{key:"RewardVideoInappHeart",get:function(){return"RewardVideoInappHeart"}},{key:"RewardVideoInappSupportItem",get:function(){return"RewardVideoInappSupportItem"}},{key:"RewardVideoX2DailyReward",get:function(){return"RewardVideoX2DailyReward"}},{key:"RewardVideoGetHeartInSoloMode",get:function(){return"RewardVideoGetHeartInSoloMode"}},{key:"RewardVideoX2DiamondButtonSoloMode",get:function(){return"RewardVideoX2DiamondButtonSoloMode"}},{key:"RewardVideoLuckyWheel",get:function(){return"RewardVideoLuckyWheel"}},{key:"BannerQuest",get:function(){return"BannerQuest"}},{key:"BannerEventRoom",get:function(){return"BannerEventRoom"}},{key:"BannerUserProfile",get:function(){return"BannerUserProfile"}},{key:"BannerViewAllFriend",get:function(){return"BannerViewAllFriend"}},{key:"BannerInfoSong",get:function(){return"BannerInfoSong"}},{key:"BannerPartyMode",get:function(){return"BannerPartyMode"}},{key:"BannerQuickPlayModeRoom",get:function(){return"BannerQuickPlayModeRoom"}},{key:"BannerChooseBettingQuickPlay",get:function(){return"BannerChooseBettingQuickPlay"}},{key:"BannerWaitingRoomQuickPlayScreen",get:function(){return"BannerWaitingRoomQuickPlayScreen"}},{key:"BannerChoosePlayListQuickPlay",get:function(){return"BannerChoosePlayListQuickPlay"}},{key:"BannerChooseBettingCreateRoom",get:function(){return"BannerChooseBettingCreateRoom"}},{key:"BannerInviteOtherFriend",get:function(){return"BannerInviteOtherFriend"}},{key:"SuggetRatingShow",get:function(){return"SuggetRatingShow"}},{key:"SuggetRatingVoteSau",get:function(){return"SuggetRatingVoteSau"}},{key:"SuggetRatingVoteNgay",get:function(){return"SuggetRatingVoteNgay"}},{key:"SuggetRatingClose",get:function(){return"SuggetRatingClose"}}],(n=[{key:"logEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;!0===window.isTest&&(window.cordova&&"undefined"!=typeof device?Ie.instance().logEvent(e,t):FB.AppEvents.logEvent(z.instance().platform+"_"+e,t))}}])&&Ae(t.prototype,n),i&&Ae(t,i),e}();function Ge(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var De=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.callMessageFromChatScreen=!0,this.event={updateGemPlayer:new Phaser.Signal,tweenAllClaimDailyQuestDone:new Phaser.Signal,onConnectServer:new Phaser.Signal,chooseExitBadConnection:new Phaser.Signal,bad_connection:new Phaser.Signal,updateDescription:new Phaser.Signal,clickOKDialog:new Phaser.Signal,searchFriendBackUserProfile:new Phaser.Signal,backButton:new Phaser.Signal,chooseNoPopupConfirm:new Phaser.Signal,turnBaseUpdate:new Phaser.Signal,backChat:new Phaser.Signal,backSystemChat:new Phaser.Signal,backLastWeek:new Phaser.Signal,newMessage:new Phaser.Signal,loadMessagesDone:new Phaser.Signal,loadSystemMessagesDone:new Phaser.Signal}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.eventgame||(this.eventgame=new e),this.eventgame}}],(n=null)&&Ge(t.prototype,n),i&&Ge(t,i),e}();function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Be(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ue(e,t){return(Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fe=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Be(this,je(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ue(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addAnim(),this.addTextLoading()}},{key:"addTextLoading",value:function(){this.txtLoading=new Phaser.Text(game,this.positionPlayConfig.txtLoading.x*window.GameConfig.RESIZE,this.positionPlayConfig.txtLoading.y*window.GameConfig.RESIZE,this.positionPlayConfig.txtLoading.text,this.positionPlayConfig.txtLoading.configs),this.txtLoading.anchor.set(.5),this.addChild(this.txtLoading)}},{key:"addAnim",value:function(){this.animLoad=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,600*window.GameConfig.RESIZE,"loadingPlay");this.animLoad.animations.add("run_anim_load");this.animLoad.anchor.set(.5),this.animLoad.animations.play("run_anim_load",32,!0),this.addChild(this.animLoad)}},{key:"moveTxtLoading",value:function(){this.txtLoading.y=-200*window.GameConfig.RESIZE}}])&&Ne(n.prototype,i),o&&Ne(n,o),t}();function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qe(e,t){return!t||"object"!==Ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qe=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Qe(this,Ve(t).call(this,game))).idShowResult=null,e.bg=null,e.loading=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&We(e,t)}(t,Phaser.Group),n=t,o=[{key:"instance",value:function(){return this.controllLoading||(this.controllLoading=new t),this.controllLoading}}],(i=[{key:"showLoading",value:function(){this.removeAllItem(),this.bg=new Phaser.Button(game,0,0,"screen-dim2"),game.add.existing(this.bg),this.loading=new Fe,game.add.existing(this.loading),z.instance().isShowLoading=!0,this.removeShowResult(),this.idShowResult=game.time.events.add(90*Phaser.Timer.SECOND,this.hideLoading,this)}},{key:"removeShowResult",value:function(){null!==this.idShowResult&&(game.time.events.remove(this.idShowResult),this.idShowResult=null)}},{key:"hideLoading",value:function(){z.instance().isShowLoading=!1,this.removeShowResult(),this.removeAllItem()}},{key:"removeAllItem",value:function(){for(null!==this.bg&&this.bg.destroy(),null!==this.loading&&this.loading.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&He(n.prototype,i),o&&He(n,o),t}();function Ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ze=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"getNamePlatform",value:function(){return"and"===z.instance().platform?e.ANDROID:"ios"===z.instance().platform?e.IOS:e.WEB}},{key:"ANDROID",get:function(){return"ANDROID"}},{key:"IOS",get:function(){return"IOS"}},{key:"WEB",get:function(){return"WEB"}},{key:"UNKNOWN",get:function(){return"UNKNOWN"}}],(n=null)&&Ke(t.prototype,n),i&&Ke(t,i),e}();function Ye(e){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xe(e,t){return!t||"object"!==Ye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $e(e){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Xe(this,$e(t).call(this,game,0,0,"screen-dim"))).input.useHandCursor=!1,e.positionDisconnectConfig=JSON.parse(game.cache.getText("positionDisconnectConfig")),e.popup,e.signalInput=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addPopup(this.positionDisconnectConfig.popup)}},{key:"addPopup",value:function(e){this.popup=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.y)*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.animDisc,this.btn,this.txtDisconnect,this.addChild(this.popup),this.addAnim(),this.addBtn(this.positionDisconnectConfig.btn),this.addTxtDisconnect(this.positionDisconnectConfig.txtDis)}},{key:"addAnim",value:function(){this.animDisc=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,60*window.GameConfig.RESIZE,"disconnect"),this.animDisc.anchor.set(.5,0);this.animDisc.animations.add("run_anim_dis");this.animDisc.animations.play("run_anim_dis",20,!0),this.popup.addChild(this.animDisc)}},{key:"addBtn",value:function(e){this.btn=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btn.inputEnabled=!0,this.btn.events.onInputUp.addOnce(this.onClickRetry,this),this.popup.addChild(this.btn),this.txtBtn,this.addTxtBtn(this.positionDisconnectConfig.txtBtn)}},{key:"onClickRetry",value:function(){this.btn.inputEnabled=!1,LogConsole.log("Retry"),this.onConnectServer()}},{key:"onConnectServer",value:function(){WF.instance().changeScreen(Ce.LOGIN),this.destroy()}},{key:"addTxtDisconnect",value:function(e){this.txtDisconnect=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtDisconnect.anchor.set(.5,0),this.popup.addChild(this.txtDisconnect)}},{key:"addTxtBtn",value:function(e){this.txtBtn=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtBtn.anchor.set(.5,0),this.btn.addChild(this.txtBtn)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Je(n.prototype,i),o&&Je(n,o),t}();function nt(e){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ot(e,t){return!t||"object"!==nt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=ot(this,at(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,e.nameAtlas,e.nameSprite)),e.hasOwnProperty("tint")&&(n.tint=e.tint),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"setSize",value:function(e,t){this.width=e,this.height=t}}])&&it(n.prototype,i),o&&it(n,o),t}();function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ct(e,t){return!t||"object"!==lt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ut(e,t,n){return(ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dt(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pt=function(e){function t(e,n,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ct(this,dt(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,e.nameAtlas,n,i,null,e.nameSprite))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(t,Phaser.Button),n=t,(i=[{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),ut(dt(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}}])&&ht(n.prototype,i),o&&ht(n,o),t}();function gt(e){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mt(e,t){return!t||"object"!==gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wt(e,t){return(wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bt={font:"Gilroy",fontSize:40*z.instance().scale,fill:"white",align:"center",boundsAlignH:"center",boundsAlignV:"middle"},St=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=mt(this,vt(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,n,Object.assign({},bt,e.style)))).changeStyle(e.style),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(t,Phaser.Text),n=t,(i=[{key:"setButton",value:function(e,t){this.onInputUp=new Phaser.Signal,this.onInputUp.add(e,t),this.inputEnabled=!0,this.events.onInputOver.add(this.over,this),this.events.onInputOut.add(this.out,this),this.events.onInputDown.add(this.down,this),this.events.onInputUp.add(this.up,this)}},{key:"over",value:function(e){LogConsole.log("over text button")}},{key:"out",value:function(e){LogConsole.log("out text button")}},{key:"down",value:function(e){LogConsole.log("down text button")}},{key:"up",value:function(e){LogConsole.log("up text button"),ce.instance().playSound(ce.buttonclick),this.onInputUp.dispatch(e)}},{key:"changeStyle",value:function(e){var t={};for(var n in e)"maxLines"===n||(Number.isFinite(e[n])?t[n]=e[n]*z.instance().scale:t[n]=e[n]);t=Object.assign({},this.style,t),this.setStyle(t)}}])&&yt(n.prototype,i),o&&yt(n,o),t}();function _t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Et=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"BECHALLENGED_GAME_PLAY_HISTORY_RESPONSE",get:function(){return"BECHALLENGED_GAME_PLAY_HISTORY_RESPONSE"}},{key:"MAIN_MENU_LOAD_RESPONSE",get:function(){return"MAIN_MENU_LOAD_RESPONSE"}},{key:"CHALLENGE_GAME_QUESTIONS_RESPONSE",get:function(){return"CHALLENGE_GAME_QUESTIONS_RESPONSE"}},{key:"CHALLENGE_GAME_FIND_OPPONENTS_RESPONSE",get:function(){return"CHALLENGE_GAME_FIND_OPPONENTS_RESPONSE"}},{key:"CHALLENGE_GAME_GET_PLAYLISTS_RESPONSE",get:function(){return"CHALLENGE_GAME_GET_PLAYLISTS_RESPONSE"}},{key:"BECHALLENGED_GAME_OPPONENT_GAME_LOG_RESPONSE",get:function(){return"BECHALLENGED_GAME_OPPONENT_GAME_LOG_RESPONSE"}},{key:"NEW_USER_SELECTED_GENRES_RESPONSE",get:function(){return"NEW_USER_SELECTED_GENRES_RESPONSE"}},{key:"NEW_USER_GENRES_LIST_RESPONSE",get:function(){return"NEW_USER_GENRES_LIST_RESPONSE"}},{key:"SOLO_MODE_PLAYLISTS_RESPONSE",get:function(){return"SOLO_MODE_PLAYLISTS_RESPONSE"}},{key:"SOLO_MODE_PLAYLIST_SELECTED_RESPONSE",get:function(){return"SOLO_MODE_PLAYLIST_SELECTED_RESPONSE"}},{key:"CHALLENGE_GAME_FINISH_RESPONSE",get:function(){return"CHALLENGE_GAME_FINISH_RESPONSE"}},{key:"BECHALLENGED_GAME_FINISH_RESPONSE",get:function(){return"BECHALLENGED_GAME_FINISH_RESPONSE"}},{key:"SOLO_MODE_FINISH_RESPONSE",get:function(){return"SOLO_MODE_FINISH_RESPONSE"}},{key:"SOLO_MODE_GOT_REWARD_RESPONSE",get:function(){return"SOLO_MODE_GOT_REWARD_RESPONSE"}},{key:"SOLO_MODE_TOP10_THIS_WEEK_RESPONSE",get:function(){return"SOLO_MODE_TOP10_THIS_WEEK_RESPONSE"}},{key:"SOLO_MODE_TOP10_LAST_WEEK_RESPONSE",get:function(){return"SOLO_MODE_TOP10_LAST_WEEK_RESPONSE"}},{key:"SHOP_BUY_PLAYLIST_RESPONSE",get:function(){return"SHOP_BUY_PLAYLIST_RESPONSE"}},{key:"QUEST_LOAD_RESPONSE",get:function(){return"QUEST_LOAD_RESPONSE"}},{key:"QUEST_CLAIM_REWARD_RESPONSE",get:function(){return"QUEST_CLAIM_REWARD_RESPONSE"}},{key:"QUEST_ACHIEVED_NOTIFICATION",get:function(){return"QUEST_ACHIEVED_NOTIFICATION"}},{key:"ACHIEVEMENT_LOAD_RESPONSE",get:function(){return"ACHIEVEMENT_LOAD_RESPONSE"}},{key:"USER_PROFILE_LOAD_RESPONSE",get:function(){return"USER_PROFILE_LOAD_RESPONSE"}},{key:"LEVEL_UP_NOTIFICATION",get:function(){return"LEVEL_UP_NOTIFICATION"}},{key:"CHAT_ONLINE_MODE",get:function(){return"CHAT_ONLINE_MODE"}},{key:"ACHIEVEMENT_ACHIEVED_NOTIFICATION",get:function(){return"ACHIEVEMENT_ACHIEVED_NOTIFICATION"}},{key:"ACHIEVEMENT_CLAIM_REWARD_RESPONSE",get:function(){return"ACHIEVEMENT_CLAIM_REWARD_RESPONSE"}},{key:"FRIEND_REQUEST_LOAD_RESPONSE",get:function(){return"FRIEND_REQUEST_LOAD_RESPONSE"}},{key:"FRIEND_REQUEST_LOAD_REQUEST",get:function(){return"FRIEND_REQUEST_LOAD_REQUEST"}},{key:"USER_PROFILE_LOAD_REQUEST",get:function(){return"USER_PROFILE_LOAD_REQUEST"}},{key:"MAIN_MENU_LOAD_REQUEST",get:function(){return"MAIN_MENU_LOAD_REQUEST"}},{key:"QUEST_CLAIM_REWARD_REQUEST",get:function(){return"QUEST_CLAIM_REWARD_REQUEST"}},{key:"NEW_USER_SELECTED_GENRES_REQUEST",get:function(){return"NEW_USER_SELECTED_GENRES_REQUEST"}},{key:"NEW_USER_GENRES_LIST_REQUEST",get:function(){return"NEW_USER_GENRES_LIST_REQUEST"}},{key:"SOLO_MODE_PLAYLISTS_REQUEST",get:function(){return"SOLO_MODE_PLAYLISTS_REQUEST"}},{key:"BECHALLENGED_GAME_PLAY_HISTORY_REQUEST",get:function(){return"BECHALLENGED_GAME_PLAY_HISTORY_REQUEST"}},{key:"BECHALLENGED_GAME_OPPONENT_GAME_LOG_REQUEST",get:function(){return"BECHALLENGED_GAME_OPPONENT_GAME_LOG_REQUEST"}},{key:"SOLO_MODE_PLAYLIST_SELECTED_REQUEST",get:function(){return"SOLO_MODE_PLAYLIST_SELECTED_REQUEST"}},{key:"CHALLENGE_GAME_GET_PLAYLISTS_REQUEST",get:function(){return"CHALLENGE_GAME_GET_PLAYLISTS_REQUEST"}},{key:"CHALLENGE_GAME_FIND_OPPONENTS_REQUEST",get:function(){return"CHALLENGE_GAME_FIND_OPPONENTS_REQUEST"}},{key:"CHALLENGE_GAME_FINISH_REQUEST",get:function(){return"CHALLENGE_GAME_FINISH_REQUEST"}},{key:"BECHALLENGED_GAME_FINISH_REQUEST",get:function(){return"BECHALLENGED_GAME_FINISH_REQUEST"}},{key:"CHALLENGE_GAME_QUESTIONS_REQUEST",get:function(){return"CHALLENGE_GAME_QUESTIONS_REQUEST"}},{key:"SOLO_MODE_FINISH_REQUEST",get:function(){return"SOLO_MODE_FINISH_REQUEST"}},{key:"SOLO_MODE_GOT_REWARD_REQUEST",get:function(){return"SOLO_MODE_GOT_REWARD_REQUEST"}},{key:"SOLO_MODE_TOP10_THIS_WEEK_REQUEST",get:function(){return"SOLO_MODE_TOP10_THIS_WEEK_REQUEST"}},{key:"SOLO_MODE_TOP10_LAST_WEEK_REQUEST",get:function(){return"SOLO_MODE_TOP10_LAST_WEEK_REQUEST"}},{key:"SHOP_BUY_PLAYLIST_REQUEST",get:function(){return"SHOP_BUY_PLAYLIST_REQUEST"}},{key:"QUEST_LOAD_REQUEST",get:function(){return"QUEST_LOAD_REQUEST"}},{key:"ACHIEVEMENT_LOAD_REQUEST",get:function(){return"ACHIEVEMENT_LOAD_REQUEST"}},{key:"ACHIEVEMENT_CLAIM_REWARD_REQUEST",get:function(){return"ACHIEVEMENT_CLAIM_REWARD_REQUEST"}},{key:"USER_FRIEND_REQUEST",get:function(){return"USER_FRIEND_REQUEST"}},{key:"USER_FRIEND_RESPONSE",get:function(){return"USER_FRIEND_RESPONSE"}},{key:"FB_USER_SHARED_RESULT_REQUEST",get:function(){return"FB_USER_SHARED_RESULT_REQUEST"}},{key:"FB_USER_SHARED_RESULT_RESPONSE",get:function(){return"FB_USER_SHARED_RESULT_RESPONSE"}},{key:"USER_SHORT_PROFILE_LOAD_REQUEST",get:function(){return"USER_SHORT_PROFILE_LOAD_REQUEST"}},{key:"USER_SHORT_PROFILE_LOAD_RESPONSE",get:function(){return"USER_SHORT_PROFILE_LOAD_RESPONSE"}},{key:"SUPPORT_REQUEST",get:function(){return"SUPPORT_REQUEST"}},{key:"SUPPORT_RESPONSE",get:function(){return"SUPPORT_RESPONSE"}},{key:"DAILY_REWARD_NOTIFICATION",get:function(){return"DAILY_REWARD_NOTIFICATION"}},{key:"DAILY_REWARD_CLAIM_REQUEST",get:function(){return"DAILY_REWARD_CLAIM_REQUEST"}},{key:"DAILY_REWARD_CLAIM_RESPONSE",get:function(){return"DAILY_REWARD_CLAIM_RESPONSE"}},{key:"DAILY_QUEST_NOTIFICATION",get:function(){return"DAILY_QUEST_NOTIFICATION"}},{key:"DAILY_QUEST_LOAD_REQUEST",get:function(){return"DAILY_QUEST_LOAD_REQUEST"}},{key:"DAILY_QUEST_LOAD_RESPONSE",get:function(){return"DAILY_QUEST_LOAD_RESPONSE"}},{key:"HOURS_REWARD_CLAIM_REQUEST",get:function(){return"HOURS_REWARD_CLAIM_REQUEST"}},{key:"HOURS_REWARD_CLAIM_RESPONSE",get:function(){return"HOURS_REWARD_CLAIM_RESPONSE"}},{key:"POKE_USER_REQUEST",get:function(){return"POKE_USER_REQUEST"}},{key:"PLAY_SCRIPT_DONE_TURNBASE_REQUEST",get:function(){return"PLAY_SCRIPT_DONE_TURNBASE_REQUEST"}},{key:"PLAY_SCRIPT_DONE_TURNBASE_RESPONSE",get:function(){return"PLAY_SCRIPT_DONE_TURNBASE_RESPONSE"}},{key:"PLAY_SCRIPT_DONE_GET_QUEST_REQUEST",get:function(){return"PLAY_SCRIPT_DONE_GET_QUEST_REQUEST"}},{key:"PLAY_SCRIPT_DONE_GET_QUEST_RESPONSE",get:function(){return"PLAY_SCRIPT_DONE_GET_QUEST_RESPONSE"}},{key:"POKE_USER_RESPONSE",get:function(){return"POKE_USER_RESPONSE"}},{key:"PLAY_SCRIPT_DONE_ALL_REQUEST",get:function(){return"PLAY_SCRIPT_DONE_ALL_REQUEST"}},{key:"PLAY_SCRIPT_DONE_ALL_RESPONSE",get:function(){return"PLAY_SCRIPT_DONE_ALL_RESPONSE"}},{key:"SEARCH_USER_BY_ID_REQUEST",get:function(){return"SEARCH_USER_BY_ID_REQUEST"}},{key:"SEARCH_USER_BY_NAME_REQUEST",get:function(){return"SEARCH_USER_BY_NAME_REQUEST"}},{key:"SEARCH_USER_BY_ID_RESPONSE",get:function(){return"SEARCH_USER_BY_ID_RESPONSE"}},{key:"SEARCH_USER_BY_NAME_RESPONSE",get:function(){return"SEARCH_USER_BY_NAME_RESPONSE"}},{key:"GIFT_CODE_CLAIM_REQUEST",get:function(){return"GIFT_CODE_CLAIM_REQUEST"}},{key:"GIFT_CODE_CLAIM_RESPONSE",get:function(){return"GIFT_CODE_CLAIM_RESPONSE"}},{key:"TURNBASE_DELETE_GAME_REQUEST",get:function(){return"TURNBASE_DELETE_GAME_REQUEST"}},{key:"TURNBASE_DELETE_GAME_RESPONSE",get:function(){return"TURNBASE_DELETE_GAME_RESPONSE"}},{key:"ONLINE_ROOM_INVITATION",get:function(){return"ONLINE_ROOM_INVITATION"}},{key:"BROADCASH_NOTIFICATION",get:function(){return"BROADCASH_NOTIFICATION"}},{key:"USER_NOTIFICATION",get:function(){return"USER_NOTIFICATION"}},{key:"ONLINE_MODE_ROOM_FRIEND_LIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_FRIEND_LIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_FRIEND_LIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_FRIEND_LIST_RESPONSE"}},{key:"TURNBASE_CHALLENGE_REQUEST_UPDATE",get:function(){return"TURNBASE_CHALLENGE_REQUEST_UPDATE"}},{key:"MAIN_MENU_CHECK_UPDATE_REQUEST",get:function(){return"MAIN_MENU_CHECK_UPDATE_REQUEST"}},{key:"MAIN_MENU_CHECK_UPDATE_RESPONSE",get:function(){return"MAIN_MENU_CHECK_UPDATE_RESPONSE"}},{key:"INIT_SUGGESTION_OPPONENT_REQUEST",get:function(){return"INIT_SUGGESTION_OPPONENT_REQUEST"}},{key:"INIT_SUGGESTION_OPPONENT_RESPONSE",get:function(){return"INIT_SUGGESTION_OPPONENT_RESPONSE"}},{key:"TURNBASE_FIND_OPPONENT_REQUEST",get:function(){return"TURNBASE_FIND_OPPONENT_REQUEST"}},{key:"TURNBASE_FIND_OPPONENT_RESPONSE",get:function(){return"TURNBASE_FIND_OPPONENT_RESPONSE"}},{key:"INIT_CLIENT_GAME_DATA_REQUEST",get:function(){return"INIT_CLIENT_GAME_DATA_REQUEST"}},{key:"INIT_CLIENT_GAME_DATA_RESPONSE",get:function(){return"INIT_CLIENT_GAME_DATA_RESPONSE"}},{key:"QUEST_CHECK_ACHIEVED_REQUEST",get:function(){return"QUEST_CHECK_ACHIEVED_REQUEST"}},{key:"QUEST_CHECK_ACHIEVED_RESPONSE",get:function(){return"QUEST_CHECK_ACHIEVED_RESPONSE"}},{key:"QUEST_LOG_UPDATE",get:function(){return"QUEST_LOG_UPDATE"}},{key:"USER_FRIEND_LIST_LOAD_REQUEST",get:function(){return"USER_FRIEND_LIST_LOAD_REQUEST"}},{key:"USER_FRIEND_LIST_LOAD_RESPONSE",get:function(){return"USER_FRIEND_LIST_LOAD_RESPONSE"}},{key:"SOLO_MODE_QUESTION_REQUEST",get:function(){return"SOLO_MODE_QUESTION_REQUEST"}},{key:"SOLO_MODE_QUESTION_RESPONSE",get:function(){return"SOLO_MODE_QUESTION_RESPONSE"}},{key:"SOLO_MODE_NEXT_QUESTION_REQUEST",get:function(){return"SOLO_MODE_NEXT_QUESTION_REQUEST"}},{key:"SOLO_MODE_NEXT_QUESTION_RESPONSE",get:function(){return"SOLO_MODE_NEXT_QUESTION_RESPONSE"}},{key:"CHALLENGE_GAME_HISTORY_REQUEST",get:function(){return"CHALLENGE_GAME_HISTORY_REQUEST"}},{key:"CHALLENGE_GAME_HISTORY_RESPONSE",get:function(){return"CHALLENGE_GAME_HISTORY_RESPONSE"}},{key:"CHALLENGE_GAME_UPDATE_MESSAGE_REQUEST",get:function(){return"CHALLENGE_GAME_UPDATE_MESSAGE_REQUEST"}},{key:"CHALLENGE_GAME_UPDATE_MESSAGE_RESPONSE",get:function(){return"CHALLENGE_GAME_UPDATE_MESSAGE_RESPONSE"}},{key:"TURNBASE_LAST_WEEK_RESULT_REQUEST",get:function(){return"TURNBASE_LAST_WEEK_RESULT_REQUEST"}},{key:"TURNBASE_LAST_WEEK_RESULT_RESPONSE",get:function(){return"TURNBASE_LAST_WEEK_RESULT_RESPONSE"}},{key:"USER_MESSAGE_LOAD_REQUEST",get:function(){return"USER_MESSAGE_LOAD_REQUEST"}},{key:"USER_MESSAGE_SEND_REQUEST",get:function(){return"USER_MESSAGE_SEND_REQUEST"}},{key:"USER_MESSAGE_MARK_AS_READ_REQUEST",get:function(){return"USER_MESSAGE_MARK_AS_READ_REQUEST"}},{key:"USER_MESSAGE_LOAD_RESPONSE",get:function(){return"USER_MESSAGE_LOAD_RESPONSE"}},{key:"USER_MESSAGE_SEND_RESPONSE",get:function(){return"USER_MESSAGE_SEND_RESPONSE"}},{key:"USER_MESSAGE_MARK_AS_READ_RESPONSE",get:function(){return"USER_MESSAGE_MARK_AS_READ_RESPONSE"}},{key:"USER_MESSAGE_RECEIVE",get:function(){return"USER_MESSAGE_RECEIVE"}},{key:"SYSTEM_MESSAGE_LOAD_REQUEST",get:function(){return"SYSTEM_MESSAGE_LOAD_REQUEST"}},{key:"SYSTEM_MESSAGE_LOAD_RESPONSE",get:function(){return"SYSTEM_MESSAGE_LOAD_RESPONSE"}},{key:"SYSTEM_MESSAGE_MARK_AS_READ_REQUEST",get:function(){return"SYSTEM_MESSAGE_MARK_AS_READ_REQUEST"}},{key:"SYSTEM_MESSAGE_MARK_AS_READ_RESPONSE",get:function(){return"SYSTEM_MESSAGE_MARK_AS_READ_RESPONSE"}}],(n=null)&&_t(t.prototype,n),i&&_t(t,i),e}();function Ct(e){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pt(e,t){return!t||"object"!==Ct(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ot(e){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rt(e,t){return(Rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Pt(this,Ot(t).call(this,game,0,0,"otherSprites","tab-friend"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.signalClaim=new Phaser.Signal,e.type=n,e.event={claimReward:new Phaser.Signal,claimPlayScript:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rt(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward,this.btnClaim}},{key:"onStep6Claim",value:function(){this.event.claimReward.dispatch(this.quest,this.quest_log_id)}},{key:"addRequireAndReward",value:function(e,t){var n;this.quest=e,this.quest_log_id=t,en.instance().event.step6.add(this.onStep6Claim,this),this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.requireInit.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.requireInit.y*window.GameConfig.RESIZE,e.quest,this.positionQAndAConfig.scroll.requireInit.configs),this.required.anchor.set(0,.5),this.addChild(this.required),this.reward=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardInit.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardInit.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardInit.nameAtlas,this.positionQAndAConfig.scroll.btnRewardInit.nameSprite),"DIAMOND"==e.reward_type?n="Gem":"TICKET"==e.reward_type?n="Ticket":"SUPPORT_ITEM"==e.reward_type&&(n="Mic");var i=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardInit.diamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardInit.diamond.y*window.GameConfig.RESIZE,"questAndAchieveSprites",n);this.reward.addChild(i);var o=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnRewardInit.txtDiamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardInit.txtDiamond.y*window.GameConfig.RESIZE,e.reward,this.positionQAndAConfig.scroll.btnRewardInit.txtDiamond.configs);this.reward.addChild(o),this.addChild(this.reward),this.reward.inputEnabled=!0,this.btnClaim=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnClaimReward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnClaimReward.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnClaimReward.nameAtlas,this.positionQAndAConfig.scroll.btnClaimReward.nameSprite),this.btnClaim.inputEnabled=!0,this.btnClaim.idQuest=t;var a=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnClaimReward.txt.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnClaimReward.txt.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnClaimReward.txt.text,this.positionQAndAConfig.scroll.btnClaimReward.txt.configs);this.btnClaim.addChild(a),this.addChild(this.btnClaim),this.btnClaim.events.onInputUp.add(this.onClaim,this);var s=new rt(this.positionQAndAConfig.line_under);this.addChild(s)}},{key:"onClaim",value:function(){ce.instance().playSound(ce.buttonclick),this.btnClaim.inputEnabled=!1,0==this.type?this.event.claimReward.dispatch(this.quest,this.btnClaim.idQuest):this.event.claimPlayScript.dispatch()}},{key:"onReceiveReward",value:function(){en.instance().event.step6.remove(this.onStep6Claim,this),this.reward.destroy(),this.loadTexture("otherSprites","tab-friend");var e=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.doneIcon.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.doneIcon.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.doneIcon.nameAtlas,this.positionQAndAConfig.scroll.doneIcon.nameSprite);e.anchor.set(1,0),this.addChild(e)}}])&&kt(n.prototype,i),o&&kt(n,o),t}();function Tt(e){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function At(e,t){return!t||"object"!==Tt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lt(e,t,n){return(Lt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gt(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Gt(e){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dt(e,t){return(Dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=At(this,Gt(t).call(this,game,null))).mainData=z.instance(),e.afterCreate(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterCreate",value:function(){}},{key:"checkShowInvite",value:function(e){}},{key:"formatName",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.length>t){var i=e.substring(0,t);return!1===n?i:i.trim()+"..."}return e}},{key:"swap",value:function(e,t,n){var i=e[n];e[n]=e[t],e[t]=i}},{key:"financial",value:function(e){return Number.parseFloat(e).toFixed(1)}},{key:"compare",value:function(e,t){return e.score<t.score?1:e.score>t.score?-1:0}},{key:"compareOwner",value:function(e,t){return e.is_owner<t.is_owner?1:e.is_owner>t.is_owner?-1:0}},{key:"compareUserPlaylistMappingUpdate",value:function(e,t){if(e.hasOwnProperty("user")&&t.hasOwnProperty("user"))return e.user.updated<t.user.updated?1:e.user.updated>t.user.updated?-1:0}},{key:"sortAZ",value:function(e,t){var n=e.name.toUpperCase(),i=t.name.toUpperCase();return n<i?-1:n>i?1:0}},{key:"sortNewPlayList",value:function(e,t){var n=e.created,i=t.created;return n<i?1:n>i?-1:0}},{key:"sortPhoBien",value:function(e,t){var n=e.purchased_count,i=t.purchased_count;return n<i?1:n>i?-1:0}},{key:"getTime",value:function(){return(new Date).getTime()}},{key:"xoa_dau",value:function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a")).replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e")).replace(/ì|í|ị|ỉ|ĩ/g,"i")).replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o")).replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u")).replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y")).replace(/đ/g,"d")).replace(/À|Á|Ạ|Ả|Ã|Â|Ầ|Ấ|Ậ|Ẩ|Ẫ|Ă|Ằ|Ắ|Ặ|Ẳ|Ẵ/g,"A")).replace(/È|É|Ẹ|Ẻ|Ẽ|Ê|Ề|Ế|Ệ|Ể|Ễ/g,"E")).replace(/Ì|Í|Ị|Ỉ|Ĩ/g,"I")).replace(/Ò|Ó|Ọ|Ỏ|Õ|Ô|Ồ|Ố|Ộ|Ổ|Ỗ|Ơ|Ờ|Ớ|Ợ|Ở|Ỡ/g,"O")).replace(/Ù|Ú|Ụ|Ủ|Ũ|Ư|Ừ|Ứ|Ự|Ử|Ữ/g,"U")).replace(/Ỳ|Ý|Ỵ|Ỷ|Ỹ/g,"Y")).replace(/Đ/g,"D")}},{key:"tweenItemPopup",value:function(e,t){game.add.tween(e).to({y:t},400,Phaser.Easing.Exponential.In,!0)}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){}},{key:"destroy",value:function(){this.removeAll(!0),this.removeEvent(),this.removeAllItem(),Lt(Gt(t.prototype),"destroy",this).call(this)}},{key:"removeAllItem",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&It(n.prototype,i),o&&It(n,o),t}();function Nt(e){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jt(e,t){return!t||"object"!==Nt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ft(e,t){return(Ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=jt(this,Ut(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,null)),game.cache.addNinePatch(e.name,e.nameAtlas,e.nameSprite,e.left*z.instance().scale,e.right*z.instance().scale,e.top*z.instance().scale,e.bot*z.instance().scale),n.bg=new Phaser.NinePatchImage(game,0,0,e.name),n.bg.targetWidth=e.width*z.instance().scale,n.bg.targetHeight=e.height*z.instance().scale,n.bg.UpdateImageSizes(),n.addChild(n.bg),n.addChild(n.bg),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ft(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"tint",set:function(e){if(this.bg)for(var t=0;t<this.bg.children.length;t++)this.bg.children[t].tint=e}},{key:"alpha",set:function(e){if(this.bg)for(var t=0;t<this.bg.children.length;t++)this.bg.children[t].alpha=e}},{key:"width",get:function(){return this.bg.targetWidth},set:function(e){this.bg.targetWidth=e,this.bg.UpdateImageSizes()}},{key:"height",get:function(){return this.bg.targetHeight},set:function(e){this.bg.targetHeight=e,this.bg.UpdateImageSizes()}}])&&Bt(n.prototype,i),o&&Bt(n,o),t}();function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Vt(e,t){return!t||"object"!==Ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qt(e,t){return(qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Kt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Vt(this,Wt(t).call(this,game,null))).positionRanking=n.mainData.positionPopup,n.bg=new Zt(n.positionRanking.ranking_bg_help),n.addChild(n.bg),n.txtContent=new St(n.positionRanking.ranking_text_help,e),n.txtContent.x=35*z.instance().scale,n.addChild(n.txtContent),n.bg.width=n.txtContent.x+n.txtContent.width+24*z.instance().scale,n.bg.height=n.txtContent.y+n.txtContent.height+25*z.instance().scale,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qt(e,t)}(t,Mt),n=t,(i=[{key:"setWidthHeight",value:function(){this.bg.width=this.txtContent.x+this.txtContent.width+24*z.instance().scale,this.bg.height=this.txtContent.y+this.txtContent.height+25*z.instance().scale}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&Qt(n.prototype,i),o&&Qt(n,o),t}();function zt(e){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jt(e,t){return!t||"object"!==zt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xt(e){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $t(e,t){return($t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var en=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Jt(this,Xt(t).call(this,game))).playScript=JSON.parse(game.cache.getText("playScript")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.type=n,e.event={step1:new Phaser.Signal,step2:new Phaser.Signal,step3:new Phaser.Signal,step4:new Phaser.Signal,step5:new Phaser.Signal,step6:new Phaser.Signal,step7:new Phaser.Signal,step8:new Phaser.Signal},e.stepVal=0,e.indexOfAnswer=5,e.bg,e.button,e.hand,e.arrTutorial=["Bạn hãy lắng nghe và chọn đáp án đúng!","Wow! Trả lời đúng càng nhanh, điểm càng cao!","Hãy lắng nghe và khám phá ngay những giai điệu gây nghiện nào!","Mic là vật phẩm trợ giúp 50:50 cực kỳ đắc lực cho bạn","Oh Yeah! Chúc mừng bạn. Nhận thưởng và chơi ngay thôi nào.","Hệ thống nhiệm vụ Wazzat vô cùng hấp dẫn. Thực hiện ngay nhận quà liền tay!","Bạn có 1 lời mời thách đấu từ người chơi khác. Chơi ngay nào!","Tuyệt vời! Bây giờ là lúc bạn thể hiện trình độ âm nhạc của mình!"],e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$t(e,t)}(t,Phaser.Group),n=t,o=[{key:"instance",value:function(){return this.playScriptScreen||(this.playScriptScreen=new t),this.playScriptScreen}},{key:"STEP1",get:function(){return"step1"}},{key:"STEP2",get:function(){return"step2"}},{key:"STEP3",get:function(){return"step3"}},{key:"STEP4",get:function(){return"step8"}},{key:"STEP5",get:function(){return"step5"}},{key:"STEP6",get:function(){return"step6"}},{key:"STEP7",get:function(){return"step7"}},{key:"STEP8",get:function(){return"step4"}},{key:"STEP9",get:function(){return"step9"}},{key:"INIT",get:function(){return"INIT"}},{key:"DONE_TURNBASE",get:function(){return"DONE_TURNBASE"}},{key:"DONE_GET_QUEST",get:function(){return"DONE_GET_QUEST"}},{key:"DONE_ALL",get:function(){return"DONE_ALL"}}],(i=[{key:"afterInit",value:function(){this.bg=new Phaser.Button(game,0,0,"BG_Opacity"),this.addChild(this.bg),this.addButtonSkip(),this.addEventExtension()}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.PLAY_SCRIPT_DONE_GET_QUEST_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.destroy()}},{key:"addButtonSkip",value:function(){this.btnSkip=new pt(this.playScript.play_script_btn_skip,this.onSkipPS,this),this.btnSkip.y=game.height-z.instance().STANDARD_HEIGHT+this.playScript.play_script_btn_skip.y,this.btnSkip.anchor.set(.5);var e=new St(this.playScript.play_script_btn_skip.text,this.playScript.play_script_btn_skip.text.text);e.anchor.set(.5),this.btnSkip.addChild(e),this.btnSkip.kill(),this.addChild(this.btnSkip)}},{key:"onSkipPS",value:function(){Le.instance().logEvent(Le.Screen_Play_Script_Skip+"_"+this.stepVal),ce.instance().playSound(ce.buttonclick),mZ.instance().sendData(Et.PLAY_SCRIPT_DONE_ALL_REQUEST,null)}},{key:"addHand",value:function(e,t){this.hand=new Phaser.Sprite(game,e,t,this.playScript.play_script_hand.nameAtlas,this.playScript.play_script_hand.nameSprite),game.add.tween(this.hand).to({y:"+30"},200,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(this.hand)}},{key:"addHelperStep1",value:function(){var e=new Kt(this.arrTutorial[0]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=60,this.addChild(e),this.btnSkip.revive()}},{key:"addStep1ChooseAnswerQuest1",value:function(e,n){Le.instance().logEvent(Le.Screen_Play_Script+"_step1"),this.indexOfAnswer=5;var i=e.correctAnswer;this.indexOfAnswer=i-1;var o=e.answers[i-1];this.stepVal=t.STEP1,this.bg.loadTexture("BG_Opacity"),this.countQuiz=n;var a=new pt({x:0,y:0,nameAtlas:"playSprites",nameSprite:"Tab_Dapan_01"},this.onClickTab,this);a.anchor.set(.5),a.position.x=320,a.position.y=1==i?game.height-576:2==i?game.height-576+122:3==i?game.height-576+244:game.height-576+366;var s=new St({x:0,y:0,text:"",style:{font:"GilroyMedium",fill:"black",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:400}},o);s.anchor.set(.5),a.addChild(s),game.add.tween(a.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(a),this.addHand(a.x+150,a.y)}},{key:"addHelperStep2",value:function(){var e=new Kt(this.arrTutorial[1]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=90,this.addChild(e),this.btnSkip.revive()}},{key:"addStep2ChooseAnswerQuest2",value:function(e,n){Le.instance().logEvent(Le.Screen_Play_Script+"_step2"),this.indexOfAnswer=5;var i=e.correctAnswer;this.indexOfAnswer=i-1;var o=e.answers[i-1];this.stepVal=t.STEP2,this.bg.loadTexture("BG_Opacity"),this.countQuiz=n;var a=new pt({x:0,y:0,nameAtlas:"playSprites",nameSprite:"Tab_Dapan_01"},this.onClickTab,this);a.anchor.set(.5),a.position.x=320,a.position.y=1==i?game.height-576:2==i?game.height-576+122:3==i?game.height-576+244:game.height-576+366;var s=new St({x:0,y:0,text:"",style:{font:"GilroyMedium",fill:"black",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:400}},o);s.anchor.set(.5),a.addChild(s),game.add.tween(a.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(a),this.addHand(a.x+150,a.y)}},{key:"addHelperStep3",value:function(){var e=new Kt(this.arrTutorial[2]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=90,this.addChild(e),this.btnSkip.revive()}},{key:"addStep3ChooseAnswerQuest3",value:function(e,n){Le.instance().logEvent(Le.Screen_Play_Script+"_step3"),this.indexOfAnswer=5;var i=e.correctAnswer;this.indexOfAnswer=i-1;var o=e.answers[i-1];this.stepVal=t.STEP3,this.bg.loadTexture("BG_Opacity"),this.countQuiz=n;var a=new pt({x:0,y:0,nameAtlas:"playSprites",nameSprite:"Tab_Dapan_01"},this.onClickTab,this);a.anchor.set(.5),a.position.x=320,a.position.y=1==i?game.height-576:2==i?game.height-576+122:3==i?game.height-576+244:game.height-576+366;var s=new St({x:0,y:0,text:"",style:{font:"GilroyMedium",fill:"black",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:400}},o);s.anchor.set(.5),a.addChild(s),game.add.tween(a.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(a),this.addHand(a.x+150,a.y)}},{key:"addHelperStep4",value:function(){var e=new Kt(this.arrTutorial[3]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=650,this.addChild(e)}},{key:"addStep4UseSupportItem",value:function(){Le.instance().logEvent(Le.Screen_Play_Script+"_step8"),this.stepVal=t.STEP4,this.bg.loadTexture("BG_Opacity_100"),this.btn_remove_answer=new Phaser.Button(game,this.positionPlayConfig.btn_remove_answer.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.btn_remove_answer.y)*window.GameConfig.RESIZE,this.positionPlayConfig.btn_remove_answer.nameAtlas,function(){},this,null,this.positionPlayConfig.btn_remove_answer.nameSprite),this.btn_remove_answer.anchor.set(.5);var e=new Phaser.Text(game,this.positionPlayConfig.txt_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.text,this.positionPlayConfig.txt_remove_answer.configs);e.anchor.set(.5);var n=new St(this.positionPlayConfig.txt_dis_one,this.positionPlayConfig.txt_dis_one.text);n.anchor.set(.5),this.btn_remove_answer.addChild(n);var i=new Phaser.Sprite(game,this.positionPlayConfig.diamond_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.nameAtlas,this.positionPlayConfig.diamond_remove_answer.nameSprite);i.anchor.set(1,.5);var o=new rt(this.positionPlayConfig.mic_so_luong);o.anchor.set(.5),this.countMic=mZ.instance().socket.mySelf.getVariable("support_item").value,this.numberOfSptItem=new St(this.positionPlayConfig.number_mic_so_luong,mZ.instance().socket.mySelf.getVariable("support_item").value),this.numberOfSptItem.anchor.set(.5),o.addChild(this.numberOfSptItem),this.btn_remove_answer.addChild(o),this.btn_remove_answer.addChild(i),this.btn_remove_answer.addChild(e),this.btn_remove_answer.events.onInputUp.add(this.inputBtnRemoveAnswer,this),this.addChild(this.btn_remove_answer),game.add.tween(this.btn_remove_answer.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addBtnYellow()}},{key:"inputBtnRemoveAnswer",value:function(){ce.instance().playSound(ce.buttonclick),this.event.step4.dispatch(),this.destroy()}},{key:"addStep5ReceiveFirstReward",value:function(){var e=this;Le.instance().logEvent(Le.Screen_Play_Script+"_step4"),this.btnSkip.revive(),this.stepVal=t.STEP5,this.bg.loadTexture("BG_Opacity");var n=new Kt(this.arrTutorial[4]);n.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),n.setWidthHeight(),n.position.x=(game.width-n.width)/2,n.position.y=90,this.addChild(n),this.btnClaim=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,(game.height-481)*window.GameConfig.RESIZE,"questAndAchieveSprites","Button_Nhan_popup"),this.btnClaim.anchor.set(.5,0);var i=new Phaser.Text(game,0,24*window.GameConfig.RESIZE,"NHẬN",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:30});i.anchor.set(.5,0),this.btnClaim.addChild(i),this.btnClaim.inputEnabled=!0,this.btnClaim.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),e.onClickTab()},this),this.addChild(this.btnClaim),this.addHand(this.btnClaim.x+50,this.btnClaim.y+40)}},{key:"claimReward",value:function(){}},{key:"addStep6BtnReceiveInQAndA",value:function(){Le.instance().logEvent(Le.Screen_Play_Script+"_step5"),this.btnSkip.revive(),this.stepVal=t.STEP6}},{key:"onClaim",value:function(){this.quest.destroy(),this.hand.destroy(),t.instance().event.step6.dispatch()}},{key:"addStep7CloseQAndA",value:function(){Le.instance().logEvent(Le.Screen_Play_Script+"_step6"),this.btnSkip.revive(),this.stepVal=t.STEP7,this.bg.loadTexture("BG_Opacity"),this.btnBack=new Phaser.Sprite(game,this.playScript.btn_back.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.playScript.btn_back.y)*window.GameConfig.RESIZE,this.playScript.btn_back.nameAtlas,this.playScript.btn_back.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.addChild(this.btnBack),this.addHand(this.btnBack.x-25,this.btnBack.y)}},{key:"onBack",value:function(){this.onClickTab()}},{key:"addStep8AcceptChallenge",value:function(){Le.instance().logEvent(Le.Screen_Play_Script+"_step7"),this.btnSkip.revive(),this.stepVal=t.STEP8,this.bg.loadTexture("BG_Opacity");var e=new Kt(this.arrTutorial[6]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=90,this.addChild(e),this.btnAccept=new Phaser.Button(game,this.playScript.btn_accept.x*window.GameConfig.RESIZE,this.playScript.btn_accept.y*window.GameConfig.RESIZE,"otherSprites",this.onAccept,this,null,"btnFirstGame"),this.btnAccept.anchor.set(.5),this.addChild(this.btnAccept),game.add.tween(this.btnAccept.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addHand(this.btnAccept.x,this.btnAccept.y)}},{key:"addBtnYellow",value:function(){var e=new Phaser.Sprite(game,this.playScript.btn_yellow.x,this.playScript.btn_yellow.y,this.playScript.btn_yellow.nameAtlas,this.playScript.btn_yellow.nameSprite);e.anchor.set(.5),game.add.tween(e).to({y:"+30"},500,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(e)}},{key:"onAccept",value:function(){this.onClickTab()}},{key:"addStep9GoodLuck",value:function(){var e=this;Le.instance().logEvent(Le.Screen_Play_Script+"_step9"),this.stepVal=t.STEP9,this.bg.destroy();var n=new Kt(this.arrTutorial[7]);n.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),n.setWidthHeight(),n.position.x=(game.width-n.width)/2,n.position.y=90,this.addChild(n),this.tweenDestroy9=game.time.events.add(3*Phaser.Timer.SECOND,function(){var t=game.add.tween(n).to({y:-500},2e3,Phaser.Easing.Back.InOut,!0);t.start(),t.onComplete.add(function(){e.destroy()},e)})}},{key:"onClickTab",value:function(){this.stepVal==t.STEP1&&this.event.step1.dispatch(this.indexOfAnswer),this.stepVal==t.STEP2&&this.event.step2.dispatch(this.indexOfAnswer),this.stepVal==t.STEP3&&this.event.step3.dispatch(this.indexOfAnswer),this.stepVal==t.STEP4&&this.event.step4.dispatch(),this.stepVal==t.STEP5&&(this.event.step5.dispatch(),t.instance().event.step5.dispatch()),this.stepVal==t.STEP6&&t.instance().event.step6.dispatch(),this.stepVal==t.STEP7&&(this.event.step7.dispatch(),t.instance().event.step7.dispatch()),this.stepVal==t.STEP8&&(this.event.step8.dispatch(),t.instance().event.step8.dispatch()),this.destroy()}},{key:"changeBg",value:function(){this.bg.loadTexture("BG_Opacity_100")}},{key:"removeAllTut",value:function(){this.bg.destroy(),this.btnSkip.destroy()}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.tweenDestroy9);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Yt(n.prototype,i),o&&Yt(n,o),t}();function tn(e){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function on(e,t){return!t||"object"!==tn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function an(e,t,n){return(an="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sn(e){return(sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ln=function(e){function t(e,n,i,o){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=on(this,sn(t).call(this,e,i,o))).objConfig=e,a.icon=null,e.icon&&(a.icon=new rt(e.icon),e.icon.width&&(a.icon.width=e.icon.width*z.instance().scale),e.icon.height&&(a.icon.height=e.icon.height*z.instance().scale),a.addChild(a.icon)),a.lbBtn=new St(e.configText,n);var s=0,r=0,l=0,h=0,c=0,u=0;return e.configText.hasOwnProperty("paddingLeft")&&(l=e.configText.paddingLeft*z.instance().scale),e.configText.hasOwnProperty("paddingRight")&&(h=e.configText.paddingRight*z.instance().scale),e.configText.hasOwnProperty("paddingTop")&&(c=e.configText.paddingTop*z.instance().scale),e.configText.hasOwnProperty("paddingBot")&&(u=e.configText.paddingBot*z.instance().scale),null==a.icon?(s=a.objConfig.configText.width?a.objConfig.configText.width*z.instance().scale-h-l:a.width-h-l,r=a.objConfig.configText.height?a.objConfig.configText.height*z.instance().scale-c-u:a.height-c-u,a.lbBtn.setTextBounds(0,0,s,r),a.lbBtn.x=h>0?a.width-h-s:l>0?l:(a.width-s)/2,a.lbBtn.y=c>0?c:u>0?a.height-u:(a.height-r)/2):(s=a.objConfig.configText.width?a.objConfig.configText.width*z.instance().scale-h-l:"right"==a.objConfig.icon.align?a.width-a.icon.x-6*z.instance().scale-h-l:a.width-a.icon.x-a.icon.width-6*z.instance().scale-h-l,r=a.objConfig.configText.height?a.objConfig.configText.height*z.instance().scale-c-u:a.height-c-u,e.hasOwnProperty("alignAll")?a.setKCTextCenter():(a.lbBtn.setTextBounds(0,0,s,r),"right"==a.objConfig.icon.align?a.lbBtn.x=h>0?a.width-h:l>0?l:a.icon.x-s-6*z.instance().scale:a.lbBtn.x=h>0?a.width-h:l>0?l:a.icon.x+a.icon.width+6*z.instance().scale,a.lbBtn.y=c>0?c:u>0?a.height-u:(a.height-r)/2)),a.addChild(a.lbBtn),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rn(e,t)}(t,pt),n=t,(i=[{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),an(sn(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"setKCTextCenter",value:function(){var e=0,t=0;this.objConfig.configText.hasOwnProperty("paddingTop")&&(e=this.objConfig.configText.paddingTop),this.objConfig.configText.hasOwnProperty("paddingBot")&&(t=this.objConfig.configText.paddingBot);var n=6*z.instance().scale;this.objConfig.hasOwnProperty("kc")&&(n=this.objConfig.hasOwnProperty("kc")),"right"==this.objConfig.icon.align?(this.lbBtn.x=(this.width-(this.lbBtn.width+n+this.icon.width))/2,this.icon.x=this.lbBtn.x+this.lbBtn.width+n):(this.icon.x=(this.width-(this.lbBtn.width+n+this.icon.width))/2,this.lbBtn.x=this.icon.x+this.icon.width+n),this.lbBtn.y=e>0?e:t>0?this.height-t:(this.height-this.lbBtn.height)/2}},{key:"setText",value:function(e){this.lbBtn.text=e,this.objConfig.hasOwnProperty("alignAll")&&this.setKCTextCenter()}}])&&nn(n.prototype,i),o&&nn(n,o),t}();function hn(e){return(hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function un(e,t,n){return(un="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dn(e){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gn=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=dn(t).call(this,game,null))||"object"!==hn(i)&&"function"!=typeof i?pn(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.topBg=new rt(e.positionPopup.popup_confirm_top_bg),e.addChild(e.topBg),e.bgText=new Zt(e.positionPopup.popup_confirm_bg_text),e.addChild(e.bgText),e.btnOk=new ln(e.positionPopup.popup_confirm_button_ok_full,"ĐỒNG Ý",e.chooseOK,pn(pn(e))),e.addChild(e.btnOk),e.txtContent=new St(e.positionPopup.popup_confirm_text_content,o),e.txtContent.setTextBounds(0,0,545*e.mainData.scale,278*e.mainData.scale),e.addChild(e.txtContent),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(t,Mt),n=t,(i=[{key:"setHeight",value:function(e){this.bgText.height=e,this.txtContent.setTextBounds(0,0,545*this.mainData.scale,this.bgText.height-168*this.mainData.scale),this.btnOk.y=this.bgText.targetHeight-103*this.mainData.scale}},{key:"chooseOK",value:function(){LogConsole.log("chooseOK"),this.event.OK.dispatch()}},{key:"setTextButton",value:function(e){this.btnOk.setText(e)}},{key:"setContent",value:function(e){this.txtContent.setText(e)}},{key:"destroy",value:function(){this.topBg.destroy(),this.bgText.destroy(),this.txtContent.destroy(),this.btnOk.destroy(),un(dn(t.prototype),"destroy",this).call(this)}}])&&cn(n.prototype,i),o&&cn(n,o),t}();function yn(e){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vn(e){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Sn=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=vn(t).call(this,game,null))||"object"!==yn(i)&&"function"!=typeof i?bn(n):i).url=a,e.event={OK:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.popup=new gn(o),e.popup.x=35*z.instance().scale,e.popup.y=325*z.instance().scale,e.addChild(e.popup),e.popup.event.OK.add(e.chooseOk,bn(bn(e))),e.popup.y=game.height+237*z.instance().scale,e.tweenItemPopup(e.popup,game.height-900*z.instance().scale),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wn(e,t)}(t,Mt),n=t,(i=[{key:"setContentButton",value:function(e){this.popup.setTextButton(e)}},{key:"setContent",value:function(e){this.popup.setContent(e)}},{key:"chooseOk",value:function(){""!==this.url&&("maintaince"==this.url?WF.instance().changeScreen(Ce.LOGIN):"onSearchFriend"==this.url||window.open(this.url)),De.instance().event.clickOKDialog.dispatch(this.url),this.event.OK.dispatch()}}])&&mn(n.prototype,i),o&&mn(n,o),t}();function _n(e){return(_n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function En(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cn(e,t){return!t||"object"!==_n(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kn(e,t,n){return(kn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pn(e){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function On(e,t){return(On=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Cn(this,Pn(t).call(this,game,0,0,"screen-dim2"))).avaUrl=n,e.event={back:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&On(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.bgBtn,this.avatar,this.addBgBtn(),this.addAva(),this.loadAva()}},{key:"addBgBtn",value:function(){this.bgBtn=new Phaser.Button(game,0,0,"screen-dim2"),this.bgBtn.width=game.width,this.bgBtn.height=game.height,this.bgBtn.events.onInputUp.add(this.onClickBg,this),this.addChild(this.bgBtn)}},{key:"onClickBg",value:function(){this.event.back.dispatch(),this.destroy()}},{key:"addAva",value:function(){this.avatar=new Phaser.Button(game,320,400,"otherSprites",function(){},this,null,"ava-default"),this.avatar.anchor.set(.5),this.addChild(this.avatar)}},{key:"loadAva",value:function(){if(null!==this.avaUrl)if(this.key=this.avaUrl,game.cache.checkImageKey(this.key))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadComplete.add(this.onLoad,this),e.image(this.key,this.key),e.start()}}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onClickBg,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onClickBg,this)}},{key:"onLoad",value:function(){game.cache.checkImageKey(this.key)&&void 0!==this&&(this.avatar.loadTexture(this.key),this.avatar.width=300,this.avatar.height=300)}},{key:"destroy",value:function(){this.removeEventExtension(),kn(Pn(t.prototype),"destroy",this).call(this)}}])&&En(n.prototype,i),o&&En(n,o),t}();function xn(e){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function In(e,t){return!t||"object"!==xn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function An(e){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ln(e,t){return(Ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gn=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=In(this,An(t).call(this,game))).disconnect=null,e.playScript=null,e.dialog=null,e.bigAva=null,e.plsWait=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ln(e,t)}(t,Phaser.Group),n=t,o=[{key:"instance",value:function(){return this.controllDialog||(this.controllDialog=new t),this.controllDialog}}],(i=[{key:"addPopupDisconnect",value:function(){this.removePopupDisconnect(),this.disconnect=new tt,this.addChild(this.disconnect)}},{key:"removePopupDisconnect",value:function(){null!==this.disconnect&&(this.removeChild(this.disconnect),this.disconnect.destroy(),this.disconnect=null)}},{key:"addPlayScript",value:function(){this.removePlayScript(),this.playScript=new en,this.addChild(this.playScript)}},{key:"removePlayScript",value:function(){null!==this.playScript&&(this.removeChild(this.playScript),this.playScript.destroy(),this.playScript=null)}},{key:"addDialog",value:function(e){this.removeDialog(),this.dialog=new Sn(e),this.dialog.event.OK.add(this.removeDialog,this),this.addChild(this.dialog)}},{key:"removeDialog",value:function(){null!==this.dialog&&(this.removeChild(this.dialog),this.dialog.destroy(),this.dialog=null)}},{key:"addBigAva",value:function(e){this.removeBigAva(),this.bigAva=new Rn(e),this.addChild(this.bigAva)}},{key:"removeBigAva",value:function(){null!==this.bigAva&&(this.removeChild(this.bigAva),this.bigAva.destroy(),this.bigAva=null)}},{key:"addPlsWait",value:function(){this.removePlsWait(),this.plsWait=new Phaser.Text(game,game.width/2,game.height/2,"Bạn vui lòng chờ một chút\nđể làm mới lại lần tiếp theo  ...",{font:"GilroyMedium",fill:"#ffffff",fontSize:19,align:"center"}),this.plsWait.anchor.set(.5),game.add.tween(this.plsWait).to({alpha:0},1500,"Linear",!0).start(),this.addChild(this.plsWait)}},{key:"removePlsWait",value:function(){null!==this.plsWait&&(this.removeChild(this.plsWait),this.plsWait.destroy(),this.plsWait=null)}},{key:"removeAllItem",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&Tn(n.prototype,i),o&&Tn(n,o),t}();function Dn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Mn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"weekly_result",get:function(){return"weekly_result"}},{key:"user_won",get:function(){return"user_won"}},{key:"opponent_won",get:function(){return"opponent_won"}},{key:"status",get:function(){return"status"}},{key:"turn_count",get:function(){return"turn_count"}},{key:"is_online",get:function(){return"is_online"}},{key:"can_be_poked",get:function(){return"can_be_poked"}},{key:"poked",get:function(){return"poked"}},{key:"poked_at",get:function(){return"poked_at"}},{key:"updated",get:function(){return"updated"}},{key:"challenge_request_id",get:function(){return"challenge_request_id"}},{key:"challenge_msg",get:function(){return"challenge_msg"}}],(n=null)&&Dn(t.prototype,n),i&&Dn(t,i),e}();function Nn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Bn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"switchButton",value:function(e,t,n,i){for(var o=0;o<t.length;o++)t[o].kill();for(var a=0;a<e.length;a++)e[a].revive();n.kill(),i.revive()}},{key:"show",value:function(e){game.add.tween(e).to({x:0},100,"Linear",!0)}},{key:"hide",value:function(e){game.add.tween(e).to({x:game.width},100,"Linear",!0)}},{key:"handleArrsGames",value:function(e,t,n){if(e.size()>0)for(var i=0;i<e.size();i++){var o=e.getSFSObject(i),a=o.getSFSObject("opponent_entity"),s=a.getUtfString("user_name"),r=a.getUtfString("avatar"),l=a.getInt("experience_score"),h=a.getInt("id"),c=o.getInt("turn_count"),u=o.getSFSObject("weekly_result"),d=u.getInt("user_won"),f=u.getInt("opponent_won"),p=o.getLong("user_play_log"),g=o.getLong("id");t.push({opponentEntity:{userName:s,avatar:r,experienceScore:l,id:h},turnCount:c,weeklyResult:{userWon:d,opponentWon:f},id:g,userGameLog:p,mode:n})}}},{key:"handleArrMainMenuLoad",value:function(t,n,i){if(t.size()>0)for(var o=0;o<t.size();o++){var a=t.getSFSObject(o),s=a.getInt(Mn.user_id),r=a.getUtfString(Mn.user_name),l=a.getUtfString(Mn.avatar),h=a.getSFSObject(Mn.weekly_result),c=h.getInt(Mn.user_won),u=h.getInt(Mn.opponent_won),d=a.getUtfString(Mn.status),f=a.getLong(Mn.updated),p=e.formatChallengeGameUpdated(f),g=a.getUtfString(Mn.challenge_msg),y=null,m=0,v=0;"THEIR_TURN"==d?a.containsKey(Mn.can_be_poked)&&(y=a.getInt(Mn.can_be_poked)):"YOUR_TURN"==d&&a.containsKey(Mn.poked)&&(m=a.getInt(Mn.poked),v=a.getLong(Mn.poked_at));var w=a.getInt(Mn.turn_count),b=a.getBool(Mn.is_online),S=a.getLong(Mn.challenge_request_id);n.push({opponentEntity:{id:s,userName:r,avatar:l,is_online:b},weeklyResult:{userWon:c,opponentWon:u},turnCount:w,status:d,can_be_poked:y,poked:m,poked_at:v,updated:p,base_updated:f,challenge_request_id:S,challenge_msg:g})}i()}},{key:"handleCheckUpdateMainMenu",value:function(e,t){var n=e.getInt("init_quests_count"),i=e.getLong("new_friend_request_count"),o=e.getLong("started_event_count"),a={playing_guide:"",play_script_questions:[]};if(e.containsKey("play_script")){var s=e.getSFSObject("play_script");s.containsKey("playing_guide")&&(a.playing_guide=s.getUtfString("playing_guide"))}if(a.playing_guide==en.DONE_GET_QUEST&&(z.instance().botChallenge={value:0,gameLogId:z.instance().menuLoadResponses.challengeGames[0].userGameLog,requestId:z.instance().menuLoadResponses.challengeGames[0].id,opponentEntity:z.instance().menuLoadResponses.challengeGames[0].opponentEntity,mode:"isChallengeGame",can_be_poked:z.instance().menuLoadResponses.challengeGames[0].can_be_poked,weeklyResult:{userWon:0,opponentWon:0}}),e.containsKey("hours_reward")){var r=e.getSFSObject("hours_reward");r.getInt("hours_reward_id"),r.getInt("user_id"),r.getLong("created"),r.getUtfString("state"),r.getLong("updated")}t(n,i,o,{},a)}},{key:"getGender",value:function(e){return"UNKNOWN"==e.gender?"MALE":"FEMALE"}},{key:"getTwoOfFourAnswer",value:function(e,t,n,i,o){LogConsole.log(o);var a=[],s=[];1==o.correctAnswer?(a.push(e),s.push(t),s.push(n),s.push(i)):2==o.correctAnswer?(a.push(t),s.push(e),s.push(n),s.push(i)):3==o.correctAnswer?(a.push(n),s.push(t),s.push(e),s.push(i)):(a.push(i),s.push(t),s.push(n),s.push(e)),s.splice(Math.floor(Math.random()*s.length),1);for(var r=0;r<s.length;r++)s[r].hide()}},{key:"formatName",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.length>t){var i=e.substring(0,t);return!1===n?i:i.trim()+"..."}return e}},{key:"formatChallengeGameUpdated",value:function(e){var t="",n=Date.now()-e;n=parseInt(n/1e3);var i=parseInt((n/2592e3).toFixed(0));if(i>0)t="".concat(i," tháng trước");else{var o=parseInt(n/604800);if(o>0)t="".concat(o," tuần trước");else{var a=parseInt(n/86400);if(a>0)t="".concat(a," ngày trước");else{var s=parseInt(n/3600);if(s>0)t="".concat(s," giờ trước");else{var r=parseInt(n/60);t=r>0?"".concat(r," phút trước"):"vài giây trước"}}}}return t}},{key:"handleRankingList",value:function(e,t,n,i){if(e.containsKey("solo_mode_top10_last_week"))var o=e.getSFSArray("solo_mode_top10_last_week");else o=e.getSFSArray("solo_mode_top10_this_week");for(var a=0;a<o.size();a++){var s=o.getSFSObject(a),r=s.getInt("user_id"),l=s.getInt("number_of_correct"),h=s.getInt("playlist_id"),c=s.getUtfString("avatar"),u={rank:a+1,user_id:r,playlist_id:h,number_of_correct:l,user_name:s.getUtfString("user_name"),avatar:c};t.push(u)}if(e.containsKey("position")){var d=e.getSFSObject("position");if("[ Empty SFSObject ]"!==d.getDump()){var f=d.getLong("pos"),p=d.getInt("user_id"),g=d.getInt("playlist_id"),y=d.getInt("number_of_correct");n.rank=f,n.user_id=p,n.playlist_id=g,n.number_of_correct=y}}i()}},{key:"handleTime",value:function(e,t){var n=e.getLong("expired_timestamp"),i=Date.now();t(parseInt((n-i)/1e3))}},{key:"setQuestLogs",value:function(e,t){null!==e&&t.push(e)}},{key:"changeQuestLogsOnClaim",value:function(e,t){console.log(t);for(var n=0;n<t.length;n++)t[n].id==e&&(t[n].state="REWARDED")}},{key:"getGame",value:function(e){var t=window.linkResource;$.ajax({type:"GET",url:t,success:function(t){e(t)},error:function(t,n,i){e({status:"ERROR"})}})}},{key:"filterResponseGames",value:function(){z.instance().menuLoadResponses.waitingGames=z.instance().menuOpponentsResponse.filter(function(e){return"THEIR_TURN"==e.status}),z.instance().menuLoadResponses.doneGames=z.instance().menuOpponentsResponse.filter(function(e){return"NO_GAME"==e.status}),z.instance().menuLoadResponses.challengeGames=z.instance().menuOpponentsResponse.filter(function(e){return"YOUR_TURN"==e.status}),z.instance().menuLoadResponses.waitingGames=z.instance().menuLoadResponses.waitingGames.sort(function(e,t){return t.can_be_poked-e.can_be_poked}),z.instance().menuLoadResponses.challengeGames=z.instance().menuLoadResponses.challengeGames.sort(function(e,t){return t.poked-e.poked}),z.instance().menuLoadResponses.challengeGames=z.instance().menuLoadResponses.challengeGames.sort(function(e,t){return t.poked_at-e.poked_at})}},{key:"isEmpty",value:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}}],(n=null)&&Nn(t.prototype,n),i&&Nn(t,i),e}();function jn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Un=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.playingLogic||(this.playingLogic=new e),this.playingLogic}}],(n=[{key:"randomNumber",value:function(e,t){return Math.floor(Math.random()*(t+1)+e)}},{key:"convertVersionToInt",value:function(e){for(var t=e.split("."),n=0,i=0;i<t.length;i++)n+=0==i?100*parseInt(t[i]):1==i?10*parseInt(t[i]):parseInt(t[i]);return console.log("HGHGHGHG"),console.log(n),n}},{key:"genUrlSound",value:function(e){var t=mZ.instance().dataMySeft.lag_value;LogConsole.log("ping------------- : "+t);var n=320;return n=t>2048?320:t>1024?192:t>512?128:64,e=(e=e.replace("QUANTITY",n)).replace("quantity",n),LogConsole.log("url------------- : "+e),e}},{key:"format",value:function(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}},{key:"shortenLargeNumber",value:function(e,t){for(var n,i=["k","M","G","T","P","E","Z","Y"],o=i.length-1;o>=0;o--)if(e<=-(n=Math.pow(1e3,o+1))||e>=n)return+(e/n).toFixed(t)+i[o];return e}},{key:"getChangeHeight",value:function(){console.log("innerHeight "+window.innerHeight),console.log("documentElement  "+document.documentElement.clientHeight),console.log("body  "+document.body.clientHeight),console.log("screen  "+screen.height),console.log("game.height "+game.height),console.log("game.scale.scaleFactorInversed.y : "+game.scale.scaleFactorInversed.y);var e=screen.height-window.innerHeight;return e>0&&(e=(e+15)/(1-game.scale.scaleFactorInversed.y)),e}}])&&jn(t.prototype,n),i&&jn(t,i),e}();function Fn(e){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hn(e,t){return!t||"object"!==Fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qn(e,t,n){return(Qn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Vn(e){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wn(e,t){return(Wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Hn(this,Vn(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.score=e,n.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.signalBtn=new Phaser.Signal,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wn(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.screenDim,this.tabGem,this.tabHeart,this.popup,this.addScreenDim(),this.addGemAndHeart(),this.addEventExtension()}},{key:"addEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this)}},{key:"onUpdateUserVars",value:function(){mZ.instance().dataMySeft.heart!==parseInt(this.txtHeart.text)&&(this.txtHeart.text=mZ.instance().dataMySeft.heart)}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabGem.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-n)/2+t.width+5*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(t)}},{key:"addHeartDetail",value:function(){var e;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),this.txtHeart=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txt.configs);var t=e.width+this.txtHeart.width;this.txtHeart.x=(this.tabHeart.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-t)/2+this.txtHeart.width+10*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(this.txtHeart)}},{key:"addPopup",value:function(){this.btnRank,this.btnHome,this.btnReplay,this.animTimeout,this.txtLose;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.box_lose_practice.x*window.GameConfig.RESIZE,1136*window.GameConfig.RESIZE,null),this.popup.addChild(e);var t=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.box_lose_practice.nameAtlas,this.positionPracticePopupConfig.box_lose_practice.nameSprite);this.popup.addChild(t),this.addBtnRank(),this.addBtnHome(),this.addBtnReplay(),this.addTxtLose(),this.addAnimTimeOut(),this.addChild(this.popup)}},{key:"addBtnRank",value:function(){this.btnRank=new Phaser.Button(game,this.positionPracticePopupConfig.btn_rank_practice_lose.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_rank_practice_lose.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_rank_practice_lose.nameAtlas,this.onClickRank,this,null,this.positionPracticePopupConfig.btn_rank_practice_lose.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_rank);this.btnRank.addChild(e);var t=new St(this.positionPracticePopupConfig.txt_icon_rank,this.positionPracticePopupConfig.txt_icon_rank.text);this.btnRank.addChild(t);var n=new Phaser.Sprite(game,80*window.GameConfig.RESIZE,11*window.GameConfig.RESIZE,"btnRankAnim");this.btnRank.addChild(n);n.animations.add("run_rank");n.animations.play("run_rank",26,!0),this.popup.addChild(this.btnRank)}},{key:"onClickRank",value:function(){ce.instance().playSound(ce.buttonclick),this.signalBtn.dispatch({type:"RANK"}),Le.instance().logEvent(Le.Solo_mode_ranking_button)}},{key:"addBtnHome",value:function(){this.btnHome=new Phaser.Button(game,this.positionPracticePopupConfig.btn_home_practice_lose.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice_lose.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice_lose.nameAtlas,this.onClickHome,this,null,this.positionPracticePopupConfig.btn_home_practice_lose.nameSprite),this.popup.addChild(this.btnHome)}},{key:"onClickHome",value:function(){ce.instance().playSound(ce.buttonclick),this.signalBtn.dispatch({type:"HOME"})}},{key:"addBtnReplay",value:function(){this.btnReplay=new Phaser.Button(game,this.positionPracticePopupConfig.btn_replay_practice.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_replay_practice.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_replay_practice.nameAtlas,this.onClickReplay,this,null,this.positionPracticePopupConfig.btn_replay_practice.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_heart);this.btnReplay.addChild(e);var t=new St(this.positionPracticePopupConfig.txt_icon_heart,this.positionPracticePopupConfig.txt_icon_heart.text);t.addColor("#ffd3b5",9),this.btnReplay.addChild(t),this.popup.addChild(this.btnReplay)}},{key:"onClickReplay",value:function(){this.signalBtn.dispatch({type:"REPLAY"})}},{key:"addTxtLose",value:function(){this.txtLose=new Phaser.Text(game,this.positionPracticePopupConfig.txt_lose_timeout.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_lose_timeout.y*window.GameConfig.RESIZE,"".concat(this.positionPracticePopupConfig.txt_lose_timeout.text," : ").concat(this.score),this.positionPracticePopupConfig.txt_lose_timeout.configs),this.txtLose.anchor.set(.5,0),this.popup.addChild(this.txtLose)}},{key:"addAnimTimeOut",value:function(){this.animTimeout=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,73*window.GameConfig.RESIZE,"timeout_practice"),this.animTimeout.anchor.set(.5,0);this.animTimeout.animations.add("run_load_timeout");this.animTimeout.animations.play("run_load_timeout",24,!0),this.popup.addChild(this.animTimeout)}},{key:"makeTweenPopup",value:function(){ce.instance().playSound(ce.losesolomode),game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.positionPracticePopupConfig.box_lose_practice.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Bounce.Out,!1).start()}},{key:"addEventBtn",value:function(e,t){this.signalBtn.add(e,t)}},{key:"removeEventBtn",value:function(e,t){this.signalBtn.remove(e,t)}},{key:"destroy",value:function(){this.removeEventExtension(),Qn(Vn(t.prototype),"destroy",this).call(this)}}])&&Zn(n.prototype,i),o&&Zn(n,o),t}();function Kn(e){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yn(e,t){return!t||"object"!==Kn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jn(e,t,n){return(Jn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Xn(e){return(Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $n(e,t){return($n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ei=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Yn(this,Xn(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.score=e,n.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.signalBtn=new Phaser.Signal,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$n(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.screenDim,this.tabGem,this.tabHeart,this.addScreenDim(),this.addGemAndHeart(),this.addEventExtension()}},{key:"addEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this)}},{key:"onUpdateUserVars",value:function(){mZ.instance().dataMySeft.heart!==parseInt(this.txtHeart.text)&&(this.txtHeart.text=mZ.instance().dataMySeft.heart)}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabGem.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-n)/2+t.width+10*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(t)}},{key:"addHeartDetail",value:function(){var e;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),this.txtHeart=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txt.configs);var t=e.width+this.txtHeart.width;this.txtHeart.x=(this.tabHeart.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-t)/2+this.txtHeart.width+10*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(this.txtHeart)}},{key:"addPopup",value:function(){this.btnRank,this.btnHome,this.btnReplay,this.animLose,this.txtLose;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.box_lose_practice.x*window.GameConfig.RESIZE,1136*window.GameConfig.RESIZE,null),this.popup.addChild(e);var t=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.box_lose_practice.nameAtlas,this.positionPracticePopupConfig.box_lose_practice.nameSprite);this.popup.addChild(t),this.addBtnRank(),this.addBtnHome(),this.addBtnReplay(),this.addTxtLose(),this.addAnimLose(),this.addChild(this.popup)}},{key:"addBtnRank",value:function(){this.btnRank=new Phaser.Button(game,this.positionPracticePopupConfig.btn_rank_practice_lose.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_rank_practice_lose.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_rank_practice_lose.nameAtlas,this.onClickRank,this,null,this.positionPracticePopupConfig.btn_rank_practice_lose.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_rank);this.btnRank.addChild(e);var t=new St(this.positionPracticePopupConfig.txt_icon_rank,this.positionPracticePopupConfig.txt_icon_rank.text);this.btnRank.addChild(t);var n=new Phaser.Sprite(game,80*window.GameConfig.RESIZE,11*window.GameConfig.RESIZE,"btnRankAnim");this.btnRank.addChild(n);n.animations.add("run_rank");n.animations.play("run_rank",26,!0),this.popup.addChild(this.btnRank)}},{key:"onClickRank",value:function(){ce.instance().playSound(ce.buttonclick),this.signalBtn.dispatch({type:"RANK"}),Le.instance().logEvent(Le.Solo_mode_ranking_button)}},{key:"addBtnHome",value:function(){this.btnHome=new Phaser.Button(game,this.positionPracticePopupConfig.btn_home_practice_lose.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice_lose.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice_lose.nameAtlas,this.onClickHome,this,null,this.positionPracticePopupConfig.btn_home_practice_lose.nameSprite),this.popup.addChild(this.btnHome)}},{key:"onClickHome",value:function(){ce.instance().playSound(ce.buttonclick),this.signalBtn.dispatch({type:"HOME"})}},{key:"addBtnReplay",value:function(){this.btnReplay=new Phaser.Button(game,this.positionPracticePopupConfig.btn_replay_practice.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_replay_practice.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_replay_practice.nameAtlas,this.onClickReplay,this,null,this.positionPracticePopupConfig.btn_replay_practice.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_heart);this.btnReplay.addChild(e);var t=new St(this.positionPracticePopupConfig.txt_icon_heart,this.positionPracticePopupConfig.txt_icon_heart.text);t.addColor("#ffd3b5",9),this.btnReplay.addChild(t),this.popup.addChild(this.btnReplay)}},{key:"onClickReplay",value:function(){this.signalBtn.dispatch({type:"REPLAY"})}},{key:"addTxtLose",value:function(){this.txtLose=new Phaser.Text(game,this.positionPracticePopupConfig.txt_lose_timeout.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_lose_timeout.y*window.GameConfig.RESIZE,"".concat(this.positionPracticePopupConfig.txt_lose_timeout.text," : ").concat(this.score),this.positionPracticePopupConfig.txt_lose_timeout.configs),this.txtLose.anchor.set(.5,0),this.popup.addChild(this.txtLose)}},{key:"addAnimLose",value:function(){this.animLose=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,73*window.GameConfig.RESIZE,"wrong_practice"),this.animLose.anchor.set(.5,0);this.animLose.animations.add("run_load_wrong");this.popup.addChild(this.animLose)}},{key:"makeTweenPopup",value:function(){var e=this;ce.instance().playSound(ce.losesolomode);var t=game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.positionPracticePopupConfig.box_lose_practice.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Bounce.Out,!1);t.start(),t.onComplete.add(function(){e.animLose.animations.play("run_load_wrong",15,!1)},this)}},{key:"addEventBtn",value:function(e,t){this.signalBtn.add(e,t)}},{key:"removeEventBtn",value:function(e,t){this.signalBtn.remove(e,t)}},{key:"destroy",value:function(){this.removeEventExtension(),Jn(Xn(t.prototype),"destroy",this).call(this)}}])&&zn(n.prototype,i),o&&zn(n,o),t}();function ti(e){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ni(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ii(e,t){return!t||"object"!==ti(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oi(e){return(oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ai(e,t){return(ai=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var si=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ii(this,oi(t).call(this,game))).event={tweenIconPls:new Phaser.Signal,tweenDoneAll:new Phaser.Signal},i.reward=n,i.type=e,i.finishPoint=o,i.definedPosition(),i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ai(e,t)}(t,Phaser.Group),n=t,(i=[{key:"definedPosition",value:function(){this.pointsArrayGem1=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:145*window.GameConfig.RESIZE,y:255*window.GameConfig.RESIZE},{x:459*window.GameConfig.RESIZE,y:118*window.GameConfig.RESIZE},{x:380*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayGem2=[{x:520*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:520*window.GameConfig.RESIZE,y:290*window.GameConfig.RESIZE},{x:459*window.GameConfig.RESIZE,y:118*window.GameConfig.RESIZE},{x:380*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayGem3=[{x:560*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:181*window.GameConfig.RESIZE,y:538*window.GameConfig.RESIZE},{x:384*window.GameConfig.RESIZE,y:208*window.GameConfig.RESIZE},{x:380*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayGem4=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:805*window.GameConfig.RESIZE,y:471*window.GameConfig.RESIZE},{x:339*window.GameConfig.RESIZE,y:302*window.GameConfig.RESIZE},{x:380*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.arrParentGems=[this.pointsArrayGem1,this.pointsArrayGem2,this.pointsArrayGem3,this.pointsArrayGem4],this.pointsArrayMic1=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:396*window.GameConfig.RESIZE,y:313*window.GameConfig.RESIZE},{x:492*window.GameConfig.RESIZE,y:198*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayMic2=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:307*window.GameConfig.RESIZE,y:349*window.GameConfig.RESIZE},{x:258*window.GameConfig.RESIZE,y:243*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayMic3=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:307*window.GameConfig.RESIZE,y:349*window.GameConfig.RESIZE},{x:288*window.GameConfig.RESIZE,y:156*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayMic4=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:136*window.GameConfig.RESIZE,y:417*window.GameConfig.RESIZE},{x:246*window.GameConfig.RESIZE,y:243*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.arrParentMics=[this.pointsArrayMic1,this.pointsArrayMic2,this.pointsArrayMic3,this.pointsArrayMic4],this.pointsArrayTicket1=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:433*window.GameConfig.RESIZE,y:274*window.GameConfig.RESIZE},{x:287*window.GameConfig.RESIZE,y:123*window.GameConfig.RESIZE},{x:556*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayTicket2=[{x:315*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:580*window.GameConfig.RESIZE,y:324*window.GameConfig.RESIZE},{x:548*window.GameConfig.RESIZE,y:210*window.GameConfig.RESIZE},{x:556*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayTicket3=[{x:325*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:441*window.GameConfig.RESIZE,y:197*window.GameConfig.RESIZE},{x:548*window.GameConfig.RESIZE,y:209*window.GameConfig.RESIZE},{x:556*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayTicket4=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:223*window.GameConfig.RESIZE,y:331*window.GameConfig.RESIZE},{x:491*window.GameConfig.RESIZE,y:234*window.GameConfig.RESIZE},{x:556*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.arrParentTickets=[this.pointsArrayTicket1,this.pointsArrayTicket2,this.pointsArrayTicket3,this.pointsArrayTicket4],this.pointsArrayHeart1=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:396*window.GameConfig.RESIZE,y:313*window.GameConfig.RESIZE},{x:492*window.GameConfig.RESIZE,y:198*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayHeart2=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:307*window.GameConfig.RESIZE,y:349*window.GameConfig.RESIZE},{x:258*window.GameConfig.RESIZE,y:243*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayHeart3=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:307*window.GameConfig.RESIZE,y:349*window.GameConfig.RESIZE},{x:288*window.GameConfig.RESIZE,y:156*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayHeart4=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:136*window.GameConfig.RESIZE,y:417*window.GameConfig.RESIZE},{x:246*window.GameConfig.RESIZE,y:243*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.arrParentHearts=[this.pointsArrayHeart1,this.pointsArrayHeart2,this.pointsArrayHeart3,this.pointsArrayHeart4],null!==this.finishPoint&&("DIAMOND"==this.type?(this.pointsArrayGem1[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayGem2[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayGem3[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayGem4[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE}):"TICKET"==this.type?(this.pointsArrayTicket1[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayTicket2[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayTicket3[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayTicket4[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE}):"SUPPORT_ITEM"==this.type?(this.pointsArrayMic1[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayMic2[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayMic3[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayMic4[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE}):"HEART"==this.type&&(this.pointsArrayHeart1[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayHeart2[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayHeart3[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayHeart4[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE}))}},{key:"afterInit",value:function(){0!==this.reward&&this.addIcon()}},{key:"addIcon",value:function(){var e=this;ce.instance().playSound(ce.takereward);var t="";"DIAMOND"==this.type?t="Gem_Big":"TICKET"==this.type?t="Ticket_Big":"SUPPORT_ITEM"==this.type?t="Mic_Big":"HEART"==this.type&&(t="Heart_Big"),this.icon_big=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,474*window.GameConfig.RESIZE,"otherSprites",t),this.icon_big.anchor.set(.5),this.icon_big.scale.set(.3),this.txtReward=new Phaser.Text(game,320*window.GameConfig.RESIZE,600*window.GameConfig.RESIZE,"+".concat(this.reward),{font:"GilroyBold",fill:"#3aff78",align:"center",fontSize:40}),this.txtReward.anchor.set(.5),this.txtReward.alpha=.5,this.txtReward.scale.set(.5);var n=game.add.tween(this.txtReward.scale).to({x:1,y:1},700,Phaser.Easing.Linear.In,!1);n.start(),n.onUpdateCallback(function(){e.txtReward.alpha+=.05},this),n.onComplete.add(function(){e.txtReward.destroy()},this),game.add.tween(this.icon_big.scale).to({x:1,y:1},300,Phaser.Easing.Linear.In,!1).start();var i=game.add.tween(this.icon_big).to({alpha:1},1e3,Phaser.Easing.Linear.In,!1);i.start();var o=.1;i.onUpdateCallback(function(){e.icon_big.rotation+=o,e.icon_big.rotation>.2?o=-.07:e.icon_big.rotation<-.2&&(o=.07)},this),i.onComplete.add(function(){e.icon_big.rotation=0;var t=game.add.tween(e.icon_big.scale).to({x:.5,y:.5},300,Phaser.Easing.Linear.In,!1);t.start(),t.onComplete.add(function(){e.icon_big.destroy()},e);var n={resoure:parseInt(e.txtReward.text)},i=game.add.tween(n).to({resoure:0},500,"Linear",!1);i.start(),e.txtReward.destroy(),i.onUpdateCallback(function(){},e),i.onComplete.add(function(){e.event.tweenIconPls.dispatch()},e),e.addIconMoveCurve()},this),this.addStarNim(),this.addChild(this.icon_big),this.addChild(this.txtReward)}},{key:"addStarNim",value:function(){var e=new Phaser.Sprite(game,0,0,"SoloModeStar");e.anchor.set(.5),e.scale.set(1.5);e.animations.add("run_star");e.animations.play("run_star",30,!0),this.icon_big.addChild(e)}},{key:"addIconMoveCurve",value:function(){var e=this,t="",n=[];"DIAMOND"==this.type?(t="Gem_Big",n=this.arrParentGems):"TICKET"==this.type?(t="Ticket_Big",n=this.arrParentTickets):"SUPPORT_ITEM"==this.type?(t="Mic_Big",n=this.arrParentMics):"HEART"==this.type&&(t="Heart_Big",n=this.arrParentHearts);for(var i=function(i){var o=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,474*window.GameConfig.RESIZE,"otherSprites",t);o.scale.set(1),o.anchor.set(.5),e.addChild(o),setTimeout(function(){game.add.tween(o.scale).to({x:.2,y:.2},150,Phaser.Easing.Linear.In,!1).start();var e=game.add.tween(o).to({x:[n[i][0].x,n[i][1].x,n[i][2].x,n[i][3].x],y:[n[i][0].y,n[i][1].y,n[i][2].y,n[i][3].y]},750,Phaser.Easing.Linear.In,!1,0,0).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});e.start(),e.onComplete.add(function(){o.destroy()})},100*i),setTimeout(function(){e.event.tweenDoneAll.dispatch(),De.instance().event.tweenAllClaimDailyQuestDone.dispatch()},300*e.arrParentGems.length)},o=0;o<this.arrParentGems.length;o++)i(o)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&ni(n.prototype,i),o&&ni(n,o),t}();function ri(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var li=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.countPlayTurnBase=0,this.countPlayQuickPlay=0,this.countPlayCreateRoom=0,this.countGameOverSoloMode=0,this.countWinAndTakeRewardSoloMode=0,this.countTakeReward=0,this.countTakeAchievementReward=0,this.countEventMode=0,this.strEvent="",this.ktLoadAds=!1,this.ktHideBanner=!1,this.event={rewardedVideoAvailabilityChanged:new Phaser.Signal,rewardedVideoRewardReceived:new Phaser.Signal,rewardedVideoStarted:new Phaser.Signal,rewardedVideoEnded:new Phaser.Signal,rewardedVideoOpened:new Phaser.Signal,rewardedVideoClosed:new Phaser.Signal,rewardedVideoFailed:new Phaser.Signal,interstitialLoaded:new Phaser.Signal,interstitialShown:new Phaser.Signal,interstitialShowFailed:new Phaser.Signal,interstitialClicked:new Phaser.Signal,interstitialClosed:new Phaser.Signal,interstitialWillOpen:new Phaser.Signal,interstitialFailedToLoad:new Phaser.Signal,bannerDidLoad:new Phaser.Signal,bannerFailedToLoad:new Phaser.Signal,bannerDidClick:new Phaser.Signal,bannerWillPresentScreen:new Phaser.Signal,bannerDidDismissScreen:new Phaser.Signal,bannerWillLeaveApplication:new Phaser.Signal},this.existAds=!1,"undefined"!=typeof IronSourceAds&&(this.existAds=!0),!0===this.existAds&&("android"==device.platform||"Android"==device.platform?IronSourceAds.init({appKey:"85c3adc5"}):IronSourceAds.init({appKey:"7fb0fc95"}),IronSourceAds.validateIntegration()),window.addEventListener("rewardedVideoAvailabilityChanged",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoAvailabilityChanged"),console.log(e),t.event.rewardedVideoAvailabilityChanged.dispatch(),""!==t.strEvent){var n=t.strEvent+"AvailabilityChanged";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoRewardReceived",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoRewardReceived"),console.log(e),t.event.rewardedVideoRewardReceived.dispatch(e),""!==t.strEvent){var n=t.strEvent+"RewardReceived";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoStarted",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoStarted"),t.event.rewardedVideoStarted.dispatch(),""!==t.strEvent){var n=t.strEvent+"Started";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoEnded",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoEnded"),t.event.rewardedVideoEnded.dispatch(),""!==t.strEvent){var n=t.strEvent+"Ended";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoOpened",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoOpened"),t.event.rewardedVideoOpened.dispatch(),""!==t.strEvent){var n=t.strEvent+"Opened";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoClosed",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoClosed"),t.event.rewardedVideoClosed.dispatch(),""!==t.strEvent){var n=t.strEvent+"Closed";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoFailed",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoFailed"),console.log(e),t.event.rewardedVideoFailed.dispatch(),""!==t.strEvent){var n=t.strEvent+"Failed";Le.instance().logEvent(n)}}),window.addEventListener("interstitialLoaded",function(e){if(console.log("interstitialLoaded"),t.ktLoadAds=!0,t.event.interstitialLoaded.dispatch(),""!==t.strEvent){var n=t.strEvent+"Loaded";Le.instance().logEvent(n)}}),window.addEventListener("interstitialShow",function(e){if(console.log("interstitialShow"),console.log(e),t.event.interstitialShow.dispatch(),qe.instance().hideLoading(),""!==t.strEvent){var n=t.strEvent+"Show";Le.instance().logEvent(n)}}),window.addEventListener("interstitialShowFailed",function(e){if(console.log("interstitialShowFailed"),console.log(e),qe.instance().hideLoading(),t.event.interstitialShowFailed.dispatch(),""!==t.strEvent){var n=t.strEvent+"Failed";Le.instance().logEvent(n)}t.ktLoadAds=!1,t.loadInterstitial()}),window.addEventListener("interstitialClicked",function(e){if(console.log("interstitialClicked"),t.event.interstitialClicked.dispatch(),qe.instance().hideLoading(),""!==t.strEvent){var n=t.strEvent+"Clicked";Le.instance().logEvent(n)}}),window.addEventListener("interstitialClosed",function(e){if(console.log("interstitialClosed"),t.event.interstitialClosed.dispatch(),qe.instance().hideLoading(),""!==t.strEvent){var n=t.strEvent+"Closed";Le.instance().logEvent(n)}t.ktLoadAds=!1,t.loadInterstitial()}),window.addEventListener("interstitialWillOpen",function(e){if(console.log("interstitialWillOpen"),qe.instance().hideLoading(),t.event.interstitialWillOpen.dispatch(),""!==t.strEvent){var n=t.strEvent+"WillOpen";Le.instance().logEvent(n)}}),window.addEventListener("interstitialFailedToLoad",function(e){if(console.log("interstitialFailedToLoad"),qe.instance().hideLoading(),""!==t.strEvent){var n=t.strEvent+"FailedToLoad";Le.instance().logEvent(n)}t.ktLoadAds=!1,t.loadInterstitial()}),window.addEventListener("bannerDidLoad",function(e){if(console.log("bannerDidLoad"),console.log(e),!1===t.ktHideBanner&&IronSourceAds.showBanner({position:"bottom",size:"standard",overlap:!0,offsetTopBar:!1,onSuccess:function(e){console.log("available : "+e),console.log("showBanner onSuccess")},onFailure:function(e){console.log("showBanner onFailure"),console.log(e)}}),t.event.bannerDidLoad.dispatch(),""!==t.strEvent){var n=t.strEvent+"DidLoad";Le.instance().logEvent(n)}}),window.addEventListener("bannerFailedToLoad",function(e){if(console.log("bannerFailedToLoad"),console.log(e),t.event.bannerFailedToLoad.dispatch(),""!==t.strEvent){var n=t.strEvent+"FailedToLoad";Le.instance().logEvent(n)}}),window.addEventListener("bannerDidClick",function(e){if(console.log("bannerDidClick"),t.event.bannerDidClick.dispatch(),""!==t.strEvent){var n=t.strEvent+"DidClick";Le.instance().logEvent(n)}}),window.addEventListener("bannerWillPresentScreen",function(e){if(console.log("bannerWillPresentScreen"),t.event.bannerWillPresentScreen.dispatch(),""!==t.strEvent){var n=t.strEvent+"WillPresentScreen";Le.instance().logEvent(n)}}),window.addEventListener("bannerDidDismissScreen",function(e){if(console.log("bannerDidDismissScreen"),t.event.bannerDidDismissScreen.dispatch(),""!==t.strEvent){var n=t.strEvent+"DidDismissScreen";Le.instance().logEvent(n)}}),window.addEventListener("bannerWillLeaveApplication",function(e){if(console.log("bannerWillLeaveApplication"),t.event.bannerWillLeaveApplication.dispatch(),""!==t.strEvent){var n=t.strEvent+"WillLeaveApplication";Le.instance().logEvent(n)}}),!0===this.existAds&&this.loadInterstitial()}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.ironsource||(this.ironsource=new e),this.ironsource}}],(n=[{key:"playTurnBase",value:function(){console.log("playTurnBase"),this.countPlayTurnBase++,console.log(this.countPlayTurnBase)}},{key:"showInterstitialTurnBase",value:function(){return console.log("showInterstitialTurnBase"),this.countPlayTurnBase>2&&(this.countPlayTurnBase=0,this.strEvent=Le.InterstitialTurnBase,this.showInterstitial(),!0)}},{key:"playQuickPlay",value:function(){this.countPlayQuickPlay++}},{key:"showInterstitialQuickPlay",value:function(){return this.countPlayQuickPlay>0&&(this.countPlayQuickPlay=0,this.strEvent=Le.InterstitialQuickPlay,this.showInterstitial(),!0)}},{key:"playCreateRoom",value:function(){this.countPlayCreateRoom++}},{key:"showInterstitialCreateRoom",value:function(){return this.countPlayCreateRoom>0&&(this.countPlayCreateRoom=0,this.strEvent=Le.InterstitialCreateRoom,this.showInterstitial(),!0)}},{key:"playEventMode",value:function(){this.countEventMode++}},{key:"showInterstitialEventMode",value:function(){return this.countEventMode>0&&(this.countEventMode=0,this.strEvent=Le.InterstitialEventMode,this.showInterstitial(),!0)}},{key:"gameoverSoloMode",value:function(){this.countGameOverSoloMode++}},{key:"showInterstitialGameOverSoloMode",value:function(){return this.countGameOverSoloMode>5&&(this.countGameOverSoloMode=0,this.strEvent=Le.InterstitialSoloModeGameOver,this.showInterstitial(),!0)}},{key:"showInterstitialDoneSoloMode",value:function(){this.strEvent=Le.InterstitialDoneSoloMode,this.showInterstitial()}},{key:"winAndTakeRewarkSoloMode",value:function(){this.countWinAndTakeRewardSoloMode++}},{key:"showInterstitialWinTakeRewarkSoloMode",value:function(){return this.countWinAndTakeRewardSoloMode>0&&(this.countWinAndTakeRewardSoloMode=0,this.strEvent=Le.InterstitialSoloModeWin,this.showInterstitial(),!0)}},{key:"questTakeReward",value:function(){this.countTakeReward++}},{key:"showInterstitialQuestTakereward",value:function(){return!1}},{key:"achievementTakeReward",value:function(){this.countTakeAchievementReward++}},{key:"showInterstitialachievementTakeReward",value:function(){return this.countTakeAchievementReward>0&&(this.countTakeAchievementReward=0,this.showInterstitial(),this.strEvent=Le.InterstitialAchievement,!0)}},{key:"showRewardVideoInappPurchase",value:function(e){var t="DefaultRewardedVideo";"HEART"===e?(t="IAP_Heart",this.strEvent=Le.RewardVideoInappHeart):"SUPPORT_ITEM"===e?this.strEvent=Le.RewardVideoInappSupportItem:"DIAMOND"===e?(t="IAP_Diamonds",this.strEvent=Le.RewardVideoInappDiamond):"TICKET"===e&&(t="IAP_Ticket",this.strEvent=Le.RewardVideoInappTicket),this.showRewardVideoAd(t)}},{key:"showRewardVideoX2Daily",value:function(){this.strEvent=Le.RewardVideoX2DailyReward,this.showRewardVideoAd("x2_daily_reward")}},{key:"showRewardVideoTakeHeartSoloMode",value:function(){this.strEvent=Le.RewardVideoGetHeartInSoloMode,this.showRewardVideoAd()}},{key:"showRewardVideoX2DiamondSoloMode",value:function(){this.strEvent=Le.RewardVideoX2DiamondButtonSoloMode,this.showRewardVideoAd("x2_solo_mode_reward")}},{key:"showRewardVideoLuckyWheel",value:function(){this.strEvent=Le.RewardVideoLuckyWheel,this.showRewardVideoAd()}},{key:"showBanerQuestScreen",value:function(){}},{key:"showBanerEventRoomScreen",value:function(){}},{key:"showBanerUserProfileScreen",value:function(){}},{key:"showBanerViewAllFriendScreen",value:function(){}},{key:"showBanerInfoSongScreen",value:function(){}},{key:"showBanerPartyModeScreen",value:function(){this.strEvent=Le.BannerPartyMode,this.showBanner()}},{key:"showBanerQuickPlayModeRoomScreen",value:function(){this.strEvent=Le.BannerQuickPlayModeRoom,this.showBanner()}},{key:"showBanerChooseBettingQuickPlayScreen",value:function(){this.strEvent=Le.BannerChooseBettingQuickPlay,this.showBanner()}},{key:"showBanerWaitingRoomQuickPlayScreen",value:function(){this.strEvent=Le.BannerWaitingRoomQuickPlayScreen,this.showBanner()}},{key:"showBanerChoosePlaylistquickPlayScreen",value:function(){}},{key:"showBanerChooseBettingCreateRoomScreen",value:function(){this.strEvent=Le.BannerChooseBettingCreateRoom,this.showBanner()}},{key:"showBanerChoosePlaylistCreateRoomScreen",value:function(){}},{key:"showBanerInviteOtherUserWaitingScreen",value:function(){}},{key:"loadRewardVideoAd",value:function(){!0===this.existAds&&IronSourceAds.hasRewardedVideo({onSuccess:function(e){console.log("onSuccess : "+e)},onFailure:function(e){console.log("onFailure"),console.log(e)}})}},{key:"showRewardVideoAd",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!0===this.existAds&&(qe.instance().showLoading(),console.log("showRewardVideoAd : "),IronSourceAds.hasRewardedVideo({onSuccess:function(e){console.log("onSuccess : "+e),!0===e?IronSourceAds.showRewardedVideo({onSuccess:function(){console.log("showRewardVideoAd onSuccess")},onFailure:function(e){console.log("showRewardVideoAd onFailure")}}):qe.instance().hideLoading()},onFailure:function(e){console.log("onFailure---"),console.log(e),qe.instance().hideLoading()}}))}},{key:"loadInterstitial",value:function(){var e=this;console.log("loadInterstitial-------------"),!0===this.existAds&&IronSourceAds.hasInterstitial({onSuccess:function(e){console.log("available : "+e),!1===e&&IronSourceAds.loadInterstitial()},onFailure:function(t){e.loadInterstitial()}})}},{key:"showInterstitial",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!0===this.existAds&&(!0===this.ktLoadAds?(qe.instance().showLoading(),IronSourceAds.showInterstitial({onSuccess:function(){console.log("showInterstitial onSuccess")},onFailure:function(e){console.log("showInterstitial onFailure")}})):this.event.interstitialFailedToLoad.dispatch())}},{key:"showBanner",value:function(){!0===this.existAds&&console.log("showBanner")}},{key:"hideBanner",value:function(){this.existAds}}])&&ri(t.prototype,n),i&&ri(t,i),e}();function hi(e){return(hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ci(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ui=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event={share:new Phaser.Signal}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.fbAction||(this.fbAction=new e),this.fbAction}}],(n=[{key:"share",value:function(){if(LogConsole.log("share------------------------------"),window.cordova&&"undefined"!=typeof device)Ie.instance().share();else{FB.ui({method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:{"og:url":"https://wazzat.vn/home/","og:title":"So Tài Âm Nhạc","og:description":"So Tài Âm Nhạc","og:image":"https://cdn.gamezoka.com/storage/assets/icon.png"}})},function(e){e.hasOwnProperty("error_code")||mZ.instance().sendData(Pe.FB_USER_SHARED_RESULT_REQUEST,null)})}}},{key:"inviteFriend",value:function(){window.cordova&&"undefined"!=typeof device?Ie.instance().invite():FB.ui({method:"apprequests",message:"Come and play MusicQuiz with me!"},function(e){"object"===hi(e)&&mZ.instance().sendData(Pe.FB_USER_INVITE_FRIEND_REQUEST,Re.begin(e.request,e.to))})}},{key:"logout",value:function(e){window.cordova&&"undefined"!=typeof device?Ie.instance().logout(function(t){e(t)}):FB.logout(function(t){e(t)})}}])&&ci(t.prototype,n),i&&ci(t,i),e}();function di(e){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pi(e,t){return!t||"object"!==di(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gi(e){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yi(e,t){return(yi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mi=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=pi(this,gi(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),o.rewardType=i,o.score=e,o.reward=n,o.isWatchRewardVideo=!1,o.isWatchRewardVideoDone=!1,o.signalNextQuestion=new Phaser.Signal,o.signalStop=new Phaser.Signal,o.signalClaim=new Phaser.Signal,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yi(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.timer=null,this.screenDim,this.tabGem,this.tabHeart,this.addScreenDim(),this.headerResource,this.addHeaderResource()}},{key:"addHeaderResource",value:function(){this.headerResource=new Phaser.Group(game,0,0),this.addChild(this.headerResource),this.txtGem,this.txtTicket,this.txtMic,this.tabGemHeader,this.tabTicketHeader,this.tabMicHeader,this.addTabGemHeader(this.positionPracticePopupConfig.header),this.addTabTicketHeader(this.positionPracticePopupConfig.header),this.addTabMicHeader(this.positionPracticePopupConfig.header)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.positionPracticePopupConfig.header.gem);this.txtGem=this.addTxtGem(this.positionPracticePopupConfig.header.txtResource);var n=t.width+this.txtGem.width;this.txtGem.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtGem.width+10*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(this.txtGem),this.headerResource.addChild(this.tabGemHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addTabTicketHeader",value:function(e){this.tabTicketHeader=new Phaser.Sprite(game,e.tabTicket.x*window.GameConfig.RESIZE,e.tabTicket.y*window.GameConfig.RESIZE,e.tabTicket.nameAtlas,e.tabTicket.nameSprite);var t=this.addTicket(this.positionPracticePopupConfig.header.ticket);this.txtTicket=this.addTxtTicket(this.positionPracticePopupConfig.header.txtResource);var n=t.width+this.txtTicket.width;this.txtTicket.x=(this.tabTicketHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabTicketHeader.width-n)/2+this.txtTicket.width+10*window.GameConfig.RESIZE,this.tabTicketHeader.addChild(t),this.tabTicketHeader.addChild(this.txtTicket),this.headerResource.addChild(this.tabTicketHeader)}},{key:"addTicket",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtTicket",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("ticket").value,e.configs)}},{key:"addTabMicHeader",value:function(e){this.tabMicHeader=new Phaser.Sprite(game,e.tabMic.x*window.GameConfig.RESIZE,e.tabMic.y*window.GameConfig.RESIZE,e.tabMic.nameAtlas,e.tabMic.nameSprite);var t=this.addMic(this.positionPracticePopupConfig.header.micro);this.txtMic=this.addTxtMic(this.positionPracticePopupConfig.header.txtResource);var n=t.width+this.txtMic.width;this.txtMic.x=(this.tabMicHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabMicHeader.width-n)/2+this.txtMic.width+10*window.GameConfig.RESIZE,this.tabMicHeader.addChild(t),this.tabMicHeader.addChild(this.txtMic),this.headerResource.addChild(this.tabMicHeader)}},{key:"addMic",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtMic",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("support_item").value,e.configs)}},{key:"interstitialClosed",value:function(){this.tweenDestroy()}},{key:"interstitialShowFailed",value:function(){this.tweenDestroy()}},{key:"rewardedVideoEnded",value:function(){}},{key:"rewardedVideoClosed",value:function(){}},{key:"rewardedVideoRewardReceived",value:function(){this.isWatchRewardVideoDone=!0,this.signalClaim.dispatch(1)}},{key:"interstitialFailedToLoad",value:function(){this.tweenDestroy()}},{key:"rewardedVideoFailed",value:function(){this.btnWatching.inputEnabled=!0,this.btnContinue.inputEnabled=!0}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addPopup",value:function(){this.congraTxt,this.txtDetailReward,this.btnContinue,this.timeCountDown,this.txtTimeout,this.iconCircle;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.lineRewardPopup.x*window.GameConfig.RESIZE,1140*window.GameConfig.RESIZE,null),this.popup.addChild(e);var t=new Zt({x:0,y:0,nameAtlas:"defaultSource",nameSprite:"bg_nhaptext",left:30,right:30,top:30,bot:30,width:570,height:490,name:"choose_game_bg_input_text"});this.popup.addChild(t);var n=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,this.positionPracticePopupConfig.rewardPopup.nameSprite);this.popup.addChild(n),this.addChild(this.popup),this.addCongraTxt(),this.addTxtDetailReward(),this.addBtnContinue(),this.addIconCircle(),this.addBtnWatch(),this.addBtnShare(),this.checkDevice()}},{key:"checkDevice",value:function(){window.cordova&&"undefined"!=typeof device||(this.btnWatching.inputEnabled=!1)}},{key:"makeTweenPopup",value:function(){var e=this;ce.instance().playSound(ce.getrewardsolomode);var t=game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.positionPracticePopupConfig.lineRewardPopup.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);t.start(),t.onComplete.add(function(){},this),this.timeAnimGem=game.time.events.add(.5*Phaser.Timer.SECOND,function(){e.addAnimGem()},this)}},{key:"addCongraTxt",value:function(){this.congraTxt=new Phaser.Text(game,this.positionPracticePopupConfig.congrat_txt_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_reward.text,this.positionPracticePopupConfig.congrat_txt_reward.configs),this.congraTxt.anchor.set(.5,0),this.popup.addChild(this.congraTxt)}},{key:"addTxtDetailReward",value:function(){this.txtDetailReward=new Phaser.Text(game,this.positionPracticePopupConfig.txt_detail_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_detail_reward.y*window.GameConfig.RESIZE,"".concat(this.positionPracticePopupConfig.txt_detail_reward.text1," ").concat(this.score," ").concat(this.positionPracticePopupConfig.txt_detail_reward.text2),this.positionPracticePopupConfig.txt_detail_reward.configs),this.txtDetailReward.anchor.set(.5,0),this.txtDetailReward.addColor("#ffa33a",19),this.txtDetailReward.addColor("#333333",22),this.popup.addChild(this.txtDetailReward)}},{key:"addBtnContinue",value:function(){this.btnContinue=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_continue_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue_reward.nameAtlas,this.positionPracticePopupConfig.btn_continue_reward.nameSprite),this.btnContinue.anchor.set(.5,0);var e=new Phaser.Text(game,this.positionPracticePopupConfig.txt_btn_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.text,this.positionPracticePopupConfig.txt_btn_continue.configs);e.anchor.set(.5,0),this.btnContinue.inputEnabled=!0,this.btnContinue.events.onInputUp.add(this.onClickContinue,this),this.btnContinue.addChild(e),this.popup.addChild(this.btnContinue)}},{key:"addBtnShare",value:function(){this.btnShare=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_fb_share.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_fb_share.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_fb_share.nameAtlas,this.positionPracticePopupConfig.btn_fb_share.nameSprite),this.btnShare.anchor.set(.5,0),this.btnShare.inputEnabled=!0,this.btnShare.events.onInputUp.add(this.onClickShare,this),this.popup.addChild(this.btnShare)}},{key:"onClickShare",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"onShared",value:function(){}},{key:"addIconCircle",value:function(){this.iconCircle=new Phaser.Sprite(game,this.positionPracticePopupConfig.icon_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.icon_gem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.icon_gem.nameAtlas,this.positionPracticePopupConfig.icon_gem.nameSprite),this.iconCircle.anchor.set(.5);var e=new Phaser.Text(game,this.positionPracticePopupConfig.reward_icon_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.reward_icon_gem.y*window.GameConfig.RESIZE,"+".concat(this.reward),this.positionPracticePopupConfig.reward_icon_gem.configs);e.anchor.set(.5,0),game.time.events.loop(10,this.animationUpdateCircle,this),this.popup.addChild(this.iconCircle),this.popup.addChild(e)}},{key:"animationUpdateCircle",value:function(){this.iconCircle.angle+=3}},{key:"addAnimGem",value:function(){"DIAMOND"==this.rewardType?(this.sSGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.anim_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.nameSprite),this.sSGem.anchor.set(.5),this.animGem=this.sSGem.animations.add("animGemReward"),this.animGem.enableUpdate=!0,this.animGem.onUpdate.add(this.onUpdateGemReward,this),this.animGem.play(35,!1,!1),this.popup.addChild(this.sSGem)):"TICKET"==this.rewardType?(this.sSGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.anim_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.y*window.GameConfig.RESIZE,"rewardTicketSoloMode"),this.sSGem.anchor.set(.5),this.animGem=this.sSGem.animations.add("animTicketReward"),this.animGem.enableUpdate=!0,this.animGem.onUpdate.add(this.onUpdateGemReward,this),this.animGem.play(35,!1,!1),this.popup.addChild(this.sSGem)):"SUPPORT_ITEM"==this.rewardType&&(this.sSGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.anim_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.y*window.GameConfig.RESIZE,"rewardSptSoloMode"),this.sSGem.anchor.set(.5),this.animGem=this.sSGem.animations.add("animSptReward"),this.animGem.enableUpdate=!0,this.animGem.onUpdate.add(this.onUpdateGemReward,this),this.animGem.play(35,!1,!1),this.popup.addChild(this.sSGem))}},{key:"onUpdateGemReward",value:function(e,t){53===t.index&&(e.frame=37)}},{key:"onClickContinue",value:function(){this.isWatchRewardVideo=!1,this.btnWatching.inputEnabled=!1,this.btnContinue.inputEnabled=!1,this.signalStop.dispatch(),this.signalClaim.dispatch(0)}},{key:"makeAnimWhenClaimed",value:function(){var e=this.reward;1==this.isWatchRewardVideo&&(e*=2);var t={x:0,y:0};"DIAMOND"==this.rewardType?(t.x=351,t.y=55):"TICKET"==this.rewardType?(t.x=529,t.y=55):(t.x=164,t.y=55);var n=new si(this.rewardType,e,t);if(this.addChild(n),"DIAMOND"==this.rewardType){var i=game.add.tween(this.txtGem).to({text:mZ.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);this.tweenTxtRsr(i,this.txtGem)}else if("TICKET"==this.rewardType){var o=game.add.tween(this.txtTicket).to({text:mZ.instance().socket.mySelf.getVariable("ticket").value},300,"Linear",!1);this.tweenTxtRsr(o,this.txtTicket)}else{var a=game.add.tween(this.txtMic).to({text:mZ.instance().socket.mySelf.getVariable("support_item").value},300,"Linear",!1);this.tweenTxtRsr(a,this.txtMic)}}},{key:"tweenTxtRsr",value:function(e,t){var n=this;this.timeStartTween=game.time.events.add(2*Phaser.Timer.SECOND,function(){e.start()},this),e.onUpdateCallback(function(){t.text=parseInt(t.text)},this),e.onComplete.add(function(){window.cordova&&"undefined"!=typeof device?(n.isWatchRewardVideo,n.tweenDestroy()):n.tweenDestroy()},this)}},{key:"tweenDestroy",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-1200*window.GameConfig.RESIZE},200,"Linear",!1);this.timeTweenDestroy=game.time.events.add(1*Phaser.Timer.SECOND,function(){t.start()},this),t.onComplete.add(function(){e.signalNextQuestion.dispatch(),e.destroy()},this)}},{key:"addBtnWatch",value:function(){this.btnWatching=new pt(this.positionPracticePopupConfig.btn_watch_video_reward,this.onClickWatching,this),this.btnWatching.anchor.set(.5,0);var e=new rt(this.positionPracticePopupConfig.btn_watch_video_reward.camera);this.btnWatching.addChild(e);var t=new St(this.positionPracticePopupConfig.btn_watch_video_reward.txt1,this.positionPracticePopupConfig.btn_watch_video_reward.txt1.text),n=new St(this.positionPracticePopupConfig.btn_watch_video_reward.txt2,this.positionPracticePopupConfig.btn_watch_video_reward.txt2.text);this.btnWatching.addChild(t),this.btnWatching.addChild(n),this.popup.addChild(this.btnWatching)}},{key:"onClickWatching",value:function(){this.isWatchRewardVideo=!0,this.btnWatching.inputEnabled=!1,this.btnContinue.inputEnabled=!1,this.signalStop.dispatch(),li.instance().showRewardVideoX2DiamondSoloMode()}},{key:"addTimeCountDown",value:function(e){this.timeCountDownThisWeekPractice=e,this.timeCounter=new Phaser.Text(game,this.positionRankingConfig.txt_timeCounter.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.text,this.positionRankingConfig.txt_timeCounter.configs),this.timer=game.time.create(!1),this.timer.loop(1e3,this.handleTimer,this),this.timer.start(),this.addChild(this.timeCounter)}},{key:"handleTimer",value:function(){this.timeCountDown>0&&(this.timeCountDown--,this.txtTimeout.setText("( ".concat(this.timeCountDown," )"))),0==this.timeCountDown&&(this.signalNextQuestion.dispatch(),this.destroy())}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialClosed.add(this.interstitialClosed,this),li.instance().event.rewardedVideoEnded.add(this.rewardedVideoEnded,this),li.instance().event.rewardedVideoClosed.add(this.rewardedVideoClosed,this),li.instance().event.interstitialFailedToLoad.add(this.interstitialFailedToLoad,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this),li.instance().event.interstitialShowFailed.add(this.interstitialShowFailed,this),ui.instance().event.share.add(this.onShared,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialClosed.remove(this.interstitialClosed,this),li.instance().event.rewardedVideoEnded.remove(this.rewardedVideoEnded,this),li.instance().event.rewardedVideoClosed.remove(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialFailedToLoad.remove(this.interstitialFailedToLoad,this),li.instance().event.interstitialShowFailed.remove(this.interstitialShowFailed,this),li.instance().event.rewardedVideoFailed.remove(this.rewardedVideoFailed,this),ui.instance().event.share.remove(this.onShared,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SOLO_MODE_GOT_REWARD_RESPONSE&&(LogConsole.log(e.params.getDump()),"OK"==e.params.getUtfString("status")&&this.makeAnimWhenClaimed())}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timeAnimGem),game.time.events.remove(this.timeStartTween),game.time.events.remove(this.timeTweenDestroy),null!==this.timer&&(this.timer.stop(),this.timer.destroy(),this.timer=null);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&fi(n.prototype,i),o&&fi(n,o),t}();function vi(e){return(vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bi(e,t){return!t||"object"!==vi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Si(e){return(Si=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _i(e,t){return(_i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ei=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=bi(this,Si(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),n.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.score=e,n.signalNextQuestion=new Phaser.Signal,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_i(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.timer=null,this.screenDim,this.tabGem,this.tabHeart,this.addScreenDim(),this.addGemAndHeart()}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabGem.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-n)/2+t.width+10*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(t)}},{key:"addHeartDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabHeart.width-n)/2-5,e.x=(this.tabHeart.width-n)/2+t.width+10,this.tabHeart.addChild(e),this.tabHeart.addChild(t)}},{key:"addPopup",value:function(){this.congraTxt,this.txtDetailReward,this.btnContinue,this.timeCountDown,this.txtTimeout;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.lineRewardPopup.x*window.GameConfig.RESIZE,1140*window.GameConfig.RESIZE,null),this.popup.addChild(e);var t=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,this.positionPracticePopupConfig.rewardPopup.nameSprite);this.popup.addChild(t),this.addChild(this.popup),this.addCongraTxt(),this.addTxtDetailReward(),this.addBtnContinue()}},{key:"makeTweenPopup",value:function(){game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.positionPracticePopupConfig.lineRewardPopup.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start()}},{key:"addCongraTxt",value:function(){this.congraTxt=new Phaser.Text(game,this.positionPracticePopupConfig.congrat_txt_not_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_not_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_not_reward.text,this.positionPracticePopupConfig.congrat_txt_not_reward.configs),this.congraTxt.anchor.set(.5,0),this.popup.addChild(this.congraTxt)}},{key:"addTxtDetailReward",value:function(){this.txtDetailReward=new Phaser.Text(game,this.positionPracticePopupConfig.txt_detail_not_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_detail_not_reward.y*window.GameConfig.RESIZE,"".concat(this.positionPracticePopupConfig.txt_detail_not_reward.text1," ").concat(this.score," ").concat(this.positionPracticePopupConfig.txt_detail_not_reward.text2),this.positionPracticePopupConfig.txt_detail_not_reward.configs),this.txtDetailReward.anchor.set(.5,0),this.txtDetailReward.addColor("#ffa33a",19),this.txtDetailReward.addColor("#333333",22),this.popup.addChild(this.txtDetailReward)}},{key:"addBtnContinue",value:function(){this.btnContinue=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue.nameAtlas,this.positionPracticePopupConfig.btn_continue.nameSprite),this.btnContinue.anchor.set(.5,0);var e=new Phaser.Text(game,this.positionPracticePopupConfig.txt_btn_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.text,this.positionPracticePopupConfig.txt_btn_continue.configs);e.anchor.set(.5,0),this.btnContinue.inputEnabled=!0,this.btnContinue.events.onInputUp.add(this.onClickContinue,this),this.btnContinue.addChild(e),this.timeCountDown=9,this.txtTimeout=new Phaser.Text(game,this.positionPracticePopupConfig.txt_timeout_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_timeout_continue.y*window.GameConfig.RESIZE,"( ".concat(this.timeCountDown," )"),this.positionPracticePopupConfig.txt_timeout_continue.configs),this.btnContinue.addChild(this.txtTimeout),this.timer=game.time.create(!1),this.timer.loop(1e3,this.handleTimer,this),this.timer.start(),this.popup.addChild(this.btnContinue)}},{key:"onClickContinue",value:function(){var e=this;ce.instance().playSound(ce.buttonclick);var t=game.add.tween(this.popup).to({y:-1200*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.signalNextQuestion.dispatch(),e.destroy()},this)}},{key:"addTimeCountDown",value:function(e){this.timeCountDownThisWeekPractice=e,this.timeCounter=new Phaser.Text(game,this.positionRankingConfig.txt_timeCounter.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.text,this.positionRankingConfig.txt_timeCounter.configs),this.timer=game.time.create(!1),this.timer.loop(1e3,this.handleTimer,this),this.timer.start(),this.addChild(this.timeCounter)}},{key:"handleTimer",value:function(){this.timeCountDown>0&&(this.timeCountDown--,this.txtTimeout.setText("( ".concat(this.timeCountDown," )"))),0==this.timeCountDown&&(this.signalNextQuestion.dispatch(),this.destroy())}},{key:"destroy",value:function(){for(null!==this.timer&&(this.timer.stop(),this.timer.destroy(),this.timer=null);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&wi(n.prototype,i),o&&wi(n,o),t}();function Ci(e){return(Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ki(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pi(e,t){return!t||"object"!==Ci(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oi(e){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ri(e,t){return(Ri=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xi=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Pi(this,Oi(t).call(this,game))).event={tweenGemPls:new Phaser.Signal},n.reward=e,n.definedPosition(),n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ri(e,t)}(t,Phaser.Group),n=t,(i=[{key:"definedPosition",value:function(){this.pointsArrayGem1=[{x:320*window.GameConfig.RESIZE,y:361*window.GameConfig.RESIZE},{x:379*window.GameConfig.RESIZE,y:240*window.GameConfig.RESIZE},{x:619*window.GameConfig.RESIZE,y:192*window.GameConfig.RESIZE},{x:443*window.GameConfig.RESIZE,y:101*window.GameConfig.RESIZE}],this.pointsArrayGem2=[{x:520*window.GameConfig.RESIZE,y:361*window.GameConfig.RESIZE},{x:480*window.GameConfig.RESIZE,y:432*window.GameConfig.RESIZE},{x:321*window.GameConfig.RESIZE,y:352*window.GameConfig.RESIZE},{x:443*window.GameConfig.RESIZE,y:101*window.GameConfig.RESIZE}],this.pointsArrayGem3=[{x:560*window.GameConfig.RESIZE,y:361*window.GameConfig.RESIZE},{x:818*window.GameConfig.RESIZE,y:343*window.GameConfig.RESIZE},{x:321*window.GameConfig.RESIZE,y:352*window.GameConfig.RESIZE},{x:443*window.GameConfig.RESIZE,y:101*window.GameConfig.RESIZE}],this.pointsArrayGem4=[{x:320*window.GameConfig.RESIZE,y:361*window.GameConfig.RESIZE},{x:377*window.GameConfig.RESIZE,y:558*window.GameConfig.RESIZE},{x:83*window.GameConfig.RESIZE,y:395*window.GameConfig.RESIZE},{x:443*window.GameConfig.RESIZE,y:101*window.GameConfig.RESIZE}],this.arrParentGems=[this.pointsArrayGem1,this.pointsArrayGem2,this.pointsArrayGem3,this.pointsArrayGem4]}},{key:"afterInit",value:function(){0!==this.reward&&this.addIconGem()}},{key:"addIconGem",value:function(){var e=this;ce.instance().playSound(ce.takereward),this.gem_big=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,375*window.GameConfig.RESIZE,"otherSprites","Gem_Big"),this.gem_big.anchor.set(.5),this.gem_big.scale.set(.3),this.txtReward=new Phaser.Text(game,320*window.GameConfig.RESIZE,210*window.GameConfig.RESIZE,"+".concat(this.reward),{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:30}),this.txtReward.anchor.set(.5),this.addChild(this.txtReward),game.add.tween(this.gem_big.scale).to({x:1,y:1},300,Phaser.Easing.Linear.In,!1).start();var t=game.add.tween(this.gem_big).to({alpha:1},1e3,Phaser.Easing.Linear.In,!1);t.start();var n=.1;t.onUpdateCallback(function(){e.gem_big.rotation+=n,e.gem_big.rotation>.2?n=-.07:e.gem_big.rotation<-.2&&(n=.07)},this),t.onComplete.add(function(){e.gem_big.rotation=0;var t=game.add.tween(e.gem_big.scale).to({x:.5,y:.5},300,Phaser.Easing.Linear.In,!1);t.start(),t.onComplete.add(function(){e.gem_big.destroy()},e);var n={diamond:parseInt(e.txtReward.text)},i=game.add.tween(n).to({diamond:0},600,"Linear",!1);i.start(),i.onUpdateCallback(function(){e.txtReward.text="+"+parseInt(n.diamond)},e),i.onComplete.add(function(){e.event.tweenGemPls.dispatch(),e.txtReward.destroy()},e),e.addGemMoveCurve()},this),this.addStarNim(),this.addChild(this.gem_big)}},{key:"addStarNim",value:function(){var e=new Phaser.Sprite(game,0,0,"SoloModeStar");e.anchor.set(.5),e.scale.set(1.5);e.animations.add("run_star");e.animations.play("run_star",30,!0),this.gem_big.addChild(e)}},{key:"addGemMoveCurve",value:function(){for(var e=this,t=function(t){var n=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,361*window.GameConfig.RESIZE,"practicePopupSprites","GEM");n.scale.set(2),n.anchor.set(.5),e.addChild(n),setTimeout(function(){game.add.tween(n.scale).to({x:1,y:1},800,Phaser.Easing.Linear.In,!1).start();var i=game.add.tween(n).to({x:[320*window.GameConfig.RESIZE,e.arrParentGems[t][1].x,e.arrParentGems[t][2].x,235*window.GameConfig.RESIZE],y:[361*window.GameConfig.RESIZE,e.arrParentGems[t][1].y,e.arrParentGems[t][2].y,65*window.GameConfig.RESIZE]},800,Phaser.Easing.Linear.In,!1,0,0).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});i.start(),i.onComplete.add(function(){n.destroy()})},100*t)},n=0;n<this.arrParentGems.length;n++)t(n)}}])&&ki(n.prototype,i),o&&ki(n,o),t}();function Ti(e){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ii(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ai(e,t){return!t||"object"!==Ti(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Li(e){return(Li=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gi(e,t){return(Gi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Di=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Ai(this,Li(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),o.score=e,o.reward=n,o.playlist=i,o.isWatchRewardVideo=!1,o.isWatchRewardVideoDone=!1,o.event={goHome:new Phaser.Signal,getRank:new Phaser.Signal,claim:new Phaser.Signal,stopSong:new Phaser.Signal},o.targetTween=o.positionPracticePopupConfig.lineRewardPopup.y,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gi(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.timer=null,this.screenDim,this.tabGem,this.tabHeart,this.addScreenDim(),this.addGemAndHeart(),this.addEventExtension()}},{key:"interstitialClosed",value:function(){this.tweenDestroy()}},{key:"interstitialShowFailed",value:function(){this.tweenDestroy()}},{key:"rewardedVideoEnded",value:function(){}},{key:"rewardedVideoClosed",value:function(){}},{key:"rewardedVideoRewardReceived",value:function(){this.isWatchRewardVideoDone=!0,this.event.claim.dispatch(1)}},{key:"interstitialFailedToLoad",value:function(){this.tweenDestroy()}},{key:"rewardedVideoFailed",value:function(){this.btnClaimNotWatch.inputEnabled=!0,this.btnWatching.inputEnabled=!0}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e;this.txtGemReceived,e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),this.txtGemReceived=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txt.configs);var t=e.width+this.txtGemReceived.width;this.txtGemReceived.x=(this.tabGem.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-t)/2+this.txtGemReceived.width+10*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(this.txtGemReceived)}},{key:"addHeartDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabHeart.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-n)/2+t.width+10*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(t)}},{key:"addPopup",value:function(){this.congraTxt,this.txtDetailReward,this.btnClaimNotWatch,this.timeCountDown,this.txtTimeout,this.iconGem;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);if(this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.lineRewardPopup.x*window.GameConfig.RESIZE,1140*window.GameConfig.RESIZE,null),this.popup.addChild(e),0==this.reward){var t=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,this.positionPracticePopupConfig.rewardPopup.nameSprite);this.popup.addChild(t)}else{var n=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,"Box");n.scale.set(1,567/593);var i=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,this.positionPracticePopupConfig.rewardPopup.nameSprite);this.popup.addChild(n),this.popup.addChild(i)}this.addChild(this.popup),this.addCongraTxt(),this.addTxtDetailReward(),this.addIconCircle(),this.addBtnShare(),this.addBtnHome(),this.addBtnRank(),this.addFireWork(),0!==this.reward?(this.addBtnClaim(),this.addBtnWatch(),this.moveChildOfPopup(),this.checkDevice()):(li.instance().showInterstitialDoneSoloMode(),this.changePosChild())}},{key:"addBtnShare",value:function(){this.btnShare=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_fb_share.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_fb_share.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_fb_share.nameAtlas,this.positionPracticePopupConfig.btn_fb_share.nameSprite),this.btnShare.anchor.set(.5,0),this.btnShare.inputEnabled=!0,this.btnShare.events.onInputUp.add(this.onClickShare,this),this.popup.addChild(this.btnShare)}},{key:"onClickShare",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"onShared",value:function(){}},{key:"checkDevice",value:function(){window.cordova&&"undefined"!=typeof device||(this.btnWatching.inputEnabled=!1)}},{key:"moveChildOfPopup",value:function(){this.targetTween-=70,this.congraTxt.y+=70,this.txtDetailReward.y+=70,this.btnShare.y+=70,this.btnRank.y+=70}},{key:"changePosChild",value:function(){this.btnRank.revive(),this.btnShare.kill(),this.btnHome.revive()}},{key:"makeTweenPopup",value:function(){var e=this;ce.instance().playSound(ce.getrewardsolomode);var t=game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.targetTween)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);t.start(),t.onComplete.add(function(){0!==e.reward&&e.addAnimGem()},this)}},{key:"addGemFly",value:function(){this.gemIcon=new xi(this.reward),this.gemIcon.event.tweenGemPls.add(this.tweenGemPls,this),this.addChild(this.gemIcon)}},{key:"addAnimGem",value:function(){this.sSGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.anim_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.nameSprite),this.sSGem.anchor.set(.5),this.animGem=this.sSGem.animations.add("animGemReward"),this.animGem.enableUpdate=!0,this.animGem.onUpdate.add(this.onUpdateGemReward,this),this.animGem.play(35,!1,!1),this.popup.addChild(this.sSGem)}},{key:"onUpdateGemReward",value:function(e,t){58===t.index&&(e.frame=42)}},{key:"tweenGemPls",value:function(){var e=this,t=game.add.tween(this.txtGemReceived).to({text:mZ.instance().dataMySeft.diamond},1e3,"Linear",!1);t.start(),t.onUpdateCallback(function(){e.txtGemReceived.text=parseInt(e.txtGemReceived.text)},this),t.onComplete.add(function(){e.event.goHome.dispatch()})}},{key:"addCongraTxt",value:function(){this.congraTxt=new Phaser.Text(game,this.positionPracticePopupConfig.congrat_txt_reward.x*window.GameConfig.RESIZE,70*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_reward.text,this.positionPracticePopupConfig.congrat_txt_reward.configs),this.congraTxt.anchor.set(.5,0),this.popup.addChild(this.congraTxt)}},{key:"addTxtDetailReward",value:function(){this.txtDetailReward=new Phaser.Text(game,this.positionPracticePopupConfig.txt_detail_reward.x*window.GameConfig.RESIZE,135*window.GameConfig.RESIZE,"Bạn đã hoàn thành phần thử thách của playlist ".concat(this.playlist.name),{font:"GilroyMedium",fill:"#333333",align:"center",wordWrap:!0,wordWrapWidth:450,fontSize:24}),this.txtDetailReward.anchor.set(.5,0),this.txtDetailReward.addColor("#ffa33a",45),this.popup.addChild(this.txtDetailReward)}},{key:"addIconCircle",value:function(){if(0!==this.reward){this.iconCircle=new Phaser.Sprite(game,this.positionPracticePopupConfig.icon_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.icon_gem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.icon_gem.nameAtlas,this.positionPracticePopupConfig.icon_gem.nameSprite),this.iconCircle.anchor.set(.5);var e=new Phaser.Text(game,this.positionPracticePopupConfig.reward_icon_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.reward_icon_gem.y*window.GameConfig.RESIZE,"+".concat(this.reward),this.positionPracticePopupConfig.reward_icon_gem.configs);e.anchor.set(.5,0),game.time.events.loop(10,this.animationUpdateCircle,this),this.popup.addChild(this.iconCircle),this.popup.addChild(e)}}},{key:"animationUpdateCircle",value:function(){this.iconCircle.angle+=3}},{key:"addBtnHome",value:function(){this.btnHome=new Phaser.Button(game,33*window.GameConfig.RESIZE,265*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice56.nameAtlas,this.onClickHome,this,null,this.positionPracticePopupConfig.btn_home_practice56.nameSprite),0!==this.reward&&(this.btnHome.inputEnabled=!1,this.btnHome.alpha=.5),this.popup.addChild(this.btnHome),this.btnHome.kill()}},{key:"onClickHome",value:function(){ce.instance().playSound(ce.buttonclick),this.event.goHome.dispatch(),this.destroy()}},{key:"addBtnRank",value:function(){this.btnFoundametal=new Phaser.Sprite(game,149*window.GameConfig.RESIZE,265*window.GameConfig.RESIZE,null),this.btnRank=new Phaser.Button(game,0,0,this.positionPracticePopupConfig.btn_rank_practice56.nameAtlas,this.onClickRank,this,null,this.positionPracticePopupConfig.btn_rank_practice56.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_rank);this.btnRank.addChild(e);var t=new St(this.positionPracticePopupConfig.txt_icon_rank,this.positionPracticePopupConfig.txt_icon_rank.text);this.btnRank.addChild(t);var n=new Phaser.Sprite(game,80*window.GameConfig.RESIZE,11*window.GameConfig.RESIZE,"btnRankAnim");this.btnRank.addChild(n);n.animations.add("run_rank");n.animations.play("run_rank",26,!0),this.btnFoundametal.addChild(this.btnRank),this.popup.addChild(this.btnFoundametal),this.btnRank.kill()}},{key:"onClickRank",value:function(){ce.instance().playSound(ce.buttonclick),this.event.getRank.dispatch()}},{key:"addBtnClaim",value:function(){this.btnClaimNotWatch=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_continue_reward56.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue_reward56.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue_reward56.nameAtlas,this.positionPracticePopupConfig.btn_continue_reward56.nameSprite),this.btnClaimNotWatch.anchor.set(.5,0);var e=new Phaser.Text(game,this.positionPracticePopupConfig.txt_btn_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.y*window.GameConfig.RESIZE,"NHẬN",this.positionPracticePopupConfig.txt_btn_continue.configs);e.anchor.set(.5,0),this.btnClaimNotWatch.inputEnabled=!0,this.btnClaimNotWatch.events.onInputUp.add(this.onClickClaim,this),this.btnClaimNotWatch.addChild(e),this.popup.addChild(this.btnClaimNotWatch)}},{key:"onClickClaim",value:function(){this.isWatchRewardVideo=!1,this.btnClaimNotWatch.inputEnabled=!1,this.btnWatching.inputEnabled=!1,this.event.stopSong.dispatch(),this.event.claim.dispatch(0)}},{key:"addBtnWatch",value:function(){this.btnWatching=new pt(this.positionPracticePopupConfig.btn_watch_video_reward56,this.onClickWatching,this),this.btnWatching.anchor.set(.5,0);var e=new rt(this.positionPracticePopupConfig.btn_watch_video_reward56.camera);this.btnWatching.addChild(e);var t=new St(this.positionPracticePopupConfig.btn_watch_video_reward56.txt1,this.positionPracticePopupConfig.btn_watch_video_reward56.txt1.text),n=new St(this.positionPracticePopupConfig.btn_watch_video_reward56.txt2,this.positionPracticePopupConfig.btn_watch_video_reward56.txt2.text);this.btnWatching.addChild(t),this.btnWatching.addChild(n),this.popup.addChild(this.btnWatching)}},{key:"onClickWatching",value:function(){this.isWatchRewardVideo=!0,this.btnClaimNotWatch.inputEnabled=!1,this.btnWatching.inputEnabled=!1,this.event.stopSong.dispatch(),li.instance().showRewardVideoX2DiamondSoloMode()}},{key:"addFireWork",value:function(){var e=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,350*window.GameConfig.RESIZE,"firework");e.anchor.set(.5),e.scale.set(1),this.addChild(e);e.animations.add("run_win");e.animations.play("run_win",40,!0)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SOLO_MODE_GOT_REWARD_RESPONSE&&(LogConsole.log(e.params.getDump()),"OK"==e.params.getUtfString("status")&&(this.addGemFly(),this.btnClaimNotWatch.alpha=.5,this.btnWatching.alpha=.5,this.btnHome.inputEnabled=!0,this.btnHome.alpha=1))}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialClosed.add(this.interstitialClosed,this),li.instance().event.rewardedVideoEnded.add(this.rewardedVideoEnded,this),li.instance().event.rewardedVideoClosed.add(this.rewardedVideoClosed,this),li.instance().event.interstitialFailedToLoad.add(this.interstitialFailedToLoad,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this),li.instance().event.interstitialShowFailed.add(this.interstitialShowFailed,this),ui.instance().event.share.add(this.onShared,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialClosed.remove(this.interstitialClosed,this),li.instance().event.rewardedVideoEnded.remove(this.rewardedVideoEnded,this),li.instance().event.rewardedVideoClosed.remove(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialFailedToLoad.remove(this.interstitialFailedToLoad,this),li.instance().event.interstitialShowFailed.remove(this.interstitialShowFailed,this),ui.instance().event.share.remove(this.onShared,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),null!==this.timer&&(this.timer.stop(),this.timer.destroy(),this.timer=null);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Ii(n.prototype,i),o&&Ii(n,o),t}();function Mi(e){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ni(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bi(e){return(Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ji(e,t){return(ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ui(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Fi=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Bi(t).call(this,game,null))||"object"!==Mi(i)&&"function"!=typeof i?Ui(n):i).event={close:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.topBg=new rt(e.positionPopup.popup_confirm_top_bg),e.addChild(e.topBg),e.bgText=new Zt(e.positionPopup.popup_confirm_bg_text),e.addChild(e.bgText),e.txtContent=new St(e.positionPopup.popup_confirm_text_content,o),e.txtContent.setTextBounds(0,0,920*z.instance().scale,e.bgText.height),e.addChild(e.txtContent),e.btnClose=new pt(e.positionPopup.popup_close_btn_exit,e.chooseClose,Ui(Ui(e))),e.btnClose.x=e.topBg.width-e.btnClose.width/2,e.btnClose.y=-e.btnClose.height/3,e.addChild(e.btnClose),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ji(e,t)}(t,Mt),n=t,(i=[{key:"setHeight",value:function(e){this.bgText.height=e,this.txtContent.setTextBounds(0,0,920*z.instance().scale,this.bgText.height-30*z.instance().scale)}},{key:"chooseClose",value:function(){LogConsole.log("chooseClose"),this.event.close.dispatch()}}])&&Ni(n.prototype,i),o&&Ni(n,o),t}();function Zi(e){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qi(e,t){return!t||"object"!==Zi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vi(e){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wi(e,t){return(Wi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qi=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Qi(this,Vi(t).call(this,game))).quest=e,n.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),n.eventInput={claim:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wi(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.screenDim,this.popup,this.addScreenDim(),this.addPopup(),this.addEventExtension(),Le.instance().logEvent(Le.Popup_Quest)}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addPopup",value:function(){this.txtPopup,this.rewardClaimed,this.txtQuestReward,this.btnClaim,this.popup=new Fi,this.popup.x=35*window.GameConfig.RESIZE,this.popup.y=1136*window.GameConfig.RESIZE,this.popup.setHeight(400*window.GameConfig.RESIZE),this.popup.event.close.add(this.onClose,this),this.addTxtPopup(),this.addRewardClaimed(),this.addTxtQuestReward(),this.addBtnClaim(),this.addChild(this.popup)}},{key:"addTxtPopup",value:function(){this.txtPopup=new Phaser.Text(game,this.positionQAndAConfig.txtPopupClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.txtPopupClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.txtPopupClaim.text,this.positionQAndAConfig.txtPopupClaim.configs),this.txtPopup.anchor.set(.5,0),this.popup.addChild(this.txtPopup)}},{key:"addRewardClaimed",value:function(){if(this.rewardClaimed=new Phaser.Text(game,this.positionQAndAConfig.rewardClaimed.x*window.GameConfig.RESIZE,this.positionQAndAConfig.rewardClaimed.y*window.GameConfig.RESIZE,this.quest.reward,this.positionQAndAConfig.rewardClaimed.configs),"DIAMOND"==this.quest.reward_type)(e=new Phaser.Sprite(game,this.positionQAndAConfig.gemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.gemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.gemClaim.nameAtlas,this.positionQAndAConfig.gemClaim.nameSprite)).scale.set(1.2);else if("TICKET"==this.quest.reward_type){(e=new Phaser.Sprite(game,this.positionQAndAConfig.ticketClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.ticketClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.ticketClaim.nameAtlas,this.positionQAndAConfig.ticketClaim.nameSprite)).scale.set(1.2)}else{var e;(e=new Phaser.Sprite(game,this.positionQAndAConfig.sptItemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.sptItemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.sptItemClaim.nameAtlas,this.positionQAndAConfig.sptItemClaim.nameSprite)).scale.set(1.2)}var t=this.rewardClaimed.width+e.width;this.rewardClaimed.x=(570*window.GameConfig.RESIZE-t)/2-5*window.GameConfig.RESIZE,e.x=(570*window.GameConfig.RESIZE-t)/2+this.rewardClaimed.width+5*window.GameConfig.RESIZE,this.popup.addChild(this.rewardClaimed),this.popup.addChild(e)}},{key:"addTxtQuestReward",value:function(){this.txtQuestReward=new Phaser.Text(game,this.positionQAndAConfig.questReward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.questReward.y*window.GameConfig.RESIZE,this.quest.quest,this.positionQAndAConfig.questReward.configs),this.txtQuestReward.anchor.set(.5,0),this.popup.addChild(this.txtQuestReward)}},{key:"addBtnClaim",value:function(){var e=this;this.btnClaim=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,295*window.GameConfig.RESIZE,"questAndAchieveSprites","Button_Nhan_popup"),this.btnClaim.anchor.set(.5,0);var t=new Phaser.Text(game,0,27*window.GameConfig.RESIZE,"NHẬN",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:30});t.anchor.set(.5,0),this.btnClaim.addChild(t),this.btnClaim.inputEnabled=!0,this.btnClaim.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick);var t=game.add.tween(e.popup).to({y:-249*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.eventInput.claim.dispatch(),e.destroy()},e)},this),this.popup.addChild(this.btnClaim)}},{key:"makeTweenPopup",value:function(){var e=this;ce.instance().playSound(ce.popupfinishquest);var t=game.add.tween(this.popup).to({y:(game.height-776)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);t.start(),t.onComplete.add(function(){if(z.instance().playScript.playing_guide==en.DONE_TURNBASE){var t=new en;t.afterInit(),e.addChild(t),t.event.step5.add(e.step5ReceiveFristReward,e),t.addStep5ReceiveFirstReward()}},this)}},{key:"step5ReceiveFristReward",value:function(){this.eventInput.claim.dispatch(),this.destroy()}},{key:"onClose",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-420*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.destroy()},this),this.popup.event.close.remove(this.onClose,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.PLAY_SCRIPT_DONE_ALL_RESPONSE&&"OK"==e.params.getUtfString("status")&&(z.instance().playScript.playing_guide=en.DONE_ALL,this.destroy())}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Hi(n.prototype,i),o&&Hi(n,o),t}();function Ki(e){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yi(e,t){return!t||"object"!==Ki(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ji(e){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xi(e,t){return(Xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $i=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Yi(this,Ji(t).call(this,game,null))).positionPopup=e.mainData.positionPopup,e.topBg=new rt(e.positionPopup.popup_confirm_top_bg),e.addChild(e.topBg),e.bgText=new Zt(e.positionPopup.popup_confirm_bg_text),e.addChild(e.bgText),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xi(e,t)}(t,Mt),n=t,(i=[{key:"setHeight",value:function(e){this.bgText.height=e}},{key:"setWidth",value:function(e){this.bgText.width=e,this.topBg.width=e}},{key:"width",get:function(){return this.topBg.width}}])&&zi(n.prototype,i),o&&zi(n,o),t}();function eo(e){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function to(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function no(e,t){return!t||"object"!==eo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function io(e){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oo(e,t){return(oo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ao=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=no(this,io(t).call(this,game))).x=e,a.y=n,a.level=i,a.scaleSet=o,a.addLevel(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oo(e,t)}(t,Phaser.Group),n=t,(i=[{key:"addLevel",value:function(){if(1==this.level){var e=new Phaser.Sprite(game,0*this.scaleSet,0*this.scaleSet,"questAndAchieveSprites","Stars");e.anchor.set(.5),e.scale.set(this.scaleSet),this.addChild(e)}else if(2==this.level){var t=new Phaser.Sprite(game,-16*this.scaleSet,0,"questAndAchieveSprites","Stars");t.anchor.set(.5),t.scale.set(.8*this.scaleSet),this.addChild(t);var n=new Phaser.Sprite(game,16*this.scaleSet,0,"questAndAchieveSprites","Stars");n.anchor.set(.5),n.scale.set(.8*this.scaleSet),this.addChild(n)}else if(3==this.level){var i=new Phaser.Sprite(game,-40*this.scaleSet,10*this.scaleSet,"questAndAchieveSprites","Stars");i.anchor.set(.5),i.scale.set(.8*this.scaleSet),this.addChild(i);var o=new Phaser.Sprite(game,40*this.scaleSet,10*this.scaleSet,"questAndAchieveSprites","Stars");o.anchor.set(.5),o.scale.set(.8*this.scaleSet),this.addChild(o);var a=new Phaser.Sprite(game,0,0,"questAndAchieveSprites","Stars");a.anchor.set(.5),a.scale.set(this.scaleSet),this.addChild(a)}else if(4==this.level){var s=new Phaser.Sprite(game,-16*this.scaleSet,0,"questAndAchieveSprites","Stars");s.anchor.set(.5),s.scale.set(.8*this.scaleSet),this.addChild(s);var r=new Phaser.Sprite(game,16*this.scaleSet,0,"questAndAchieveSprites","Stars");r.anchor.set(.5),r.scale.set(.8*this.scaleSet),this.addChild(r);var l=new Phaser.Sprite(game,-40*this.scaleSet,10*this.scaleSet,"questAndAchieveSprites","Stars");l.anchor.set(.5),l.scale.set(.6*this.scaleSet),this.addChild(l);var h=new Phaser.Sprite(game,40*this.scaleSet,10*this.scaleSet,"questAndAchieveSprites","Stars");h.anchor.set(.5),h.scale.set(.6*this.scaleSet),this.addChild(h)}else{var c=new Phaser.Sprite(game,0,0,"questAndAchieveSprites","Stars");c.anchor.set(.5),c.scale.set(this.scaleSet),this.addChild(c);var u=new Phaser.Sprite(game,32*this.scaleSet,10*this.scaleSet,"questAndAchieveSprites","Stars");u.anchor.set(.5),u.scale.set(.8*this.scaleSet),this.addChild(u);var d=new Phaser.Sprite(game,-32*this.scaleSet,10*this.scaleSet,"questAndAchieveSprites","Stars");d.anchor.set(.5),d.scale.set(.8*this.scaleSet),this.addChild(d);var f=new Phaser.Sprite(game,-60*this.scaleSet,30*this.scaleSet,"questAndAchieveSprites","Stars");f.anchor.set(.5),f.scale.set(.6*this.scaleSet),this.addChild(f);var p=new Phaser.Sprite(game,60*this.scaleSet,30*this.scaleSet,"questAndAchieveSprites","Stars");p.anchor.set(.5),p.scale.set(.6*this.scaleSet),this.addChild(p)}}}])&&to(n.prototype,i),o&&to(n,o),t}();function so(e){return(so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ro(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lo(e,t){return!t||"object"!==so(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ho(e){return(ho=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function co(e,t){return(co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var uo=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=lo(this,ho(t).call(this,game))).achievement=e,n.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),n.eventInput={claim:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&co(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this;this.screenDim,this.popup,this.addScreenDim(),this.addPopup(),this.timeoutPopup=setTimeout(function(){e.makeTweenPopup()},1e3)}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addPopup",value:function(){this.txtPopup,this.rewardClaimed,this.txtQuestReward,this.btnClaim,this.medal,this.congraTxt,this.popup=new $i,this.popup.x=35*window.GameConfig.RESIZE,this.popup.y=1500*window.GameConfig.RESIZE,this.popup.setHeight(486*window.GameConfig.RESIZE),this.addChild(this.popup),this.addTxtPopup(),this.addCongraTxt(),this.addRewardClaimed(),this.addAchievementTitle(),this.addBtnClaim(),this.addMedal(),this.addFireWork(),this.loadMedal(this.achievement.medal),this.addStars(),Le.instance().logEvent(Le.Popup_Achievement)}},{key:"addStars",value:function(){this.stars=new ao(285,-125,this.achievement.new_level,1),this.popup.addChild(this.stars)}},{key:"addTxtPopup",value:function(){this.txtPopup=new Phaser.Text(game,this.positionQAndAConfig.achievement.txtPopupClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.txtPopupClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.txtPopupClaim.text,this.positionQAndAConfig.achievement.txtPopupClaim.configs),this.txtPopup.anchor.set(.5,0);var e=new St(this.positionQAndAConfig.achievement.txt_phan_thuonng,this.positionQAndAConfig.achievement.txt_phan_thuonng.text);e.anchor.set(.5,0),this.popup.addChild(e),this.popup.addChild(this.txtPopup)}},{key:"addCongraTxt",value:function(){this.congraTxt=new Phaser.Text(game,this.positionQAndAConfig.achievement.congrat_txt_reward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.congrat_txt_reward.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.congrat_txt_reward.text,this.positionQAndAConfig.achievement.congrat_txt_reward.configs),this.congraTxt.anchor.set(.5,0),this.popup.addChild(this.congraTxt)}},{key:"addRewardClaimed",value:function(){if(this.rewardClaimed=new Phaser.Text(game,this.positionQAndAConfig.achievement.rewardClaimed.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.rewardClaimed.y*window.GameConfig.RESIZE,this.achievement.reward,this.positionQAndAConfig.achievement.rewardClaimed.configs),"DIAMOND"==this.achievement.reward_type)(e=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.gemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.gemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.gemClaim.nameAtlas,this.positionQAndAConfig.achievement.gemClaim.nameSprite)).scale.set(1.2);else if("TICKET"==this.achievement.reward_type){(e=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.ticketClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.ticketClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.ticketClaim.nameAtlas,this.positionQAndAConfig.achievement.ticketClaim.nameSprite)).scale.set(1.2)}else{var e;(e=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.sptItemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.sptItemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.sptItemClaim.nameAtlas,this.positionQAndAConfig.achievement.sptItemClaim.nameSprite)).scale.set(1.2)}var t=this.rewardClaimed.width+e.width;this.rewardClaimed.x=(570*window.GameConfig.RESIZE-t)/2-5*window.GameConfig.RESIZE,e.x=(570*window.GameConfig.RESIZE-t)/2+this.rewardClaimed.width+5*window.GameConfig.RESIZE,this.popup.addChild(this.rewardClaimed),this.popup.addChild(e)}},{key:"addAchievementTitle",value:function(){this.txtQuestReward=new Phaser.Text(game,this.positionQAndAConfig.achievement.achievement_title.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.achievement_title.y*window.GameConfig.RESIZE,"".concat(this.achievement.title," ").concat(this.achievement.new_level),this.positionQAndAConfig.achievement.achievement_title.configs),this.txtQuestReward.anchor.set(.5,0),this.popup.addChild(this.txtQuestReward)}},{key:"addBtnClaim",value:function(){var e=this;this.btnClaim=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,385*window.GameConfig.RESIZE,"practicePopupSprites","Button_Tiep_Tuc"),this.btnClaim.anchor.set(.5,0);var t=new Phaser.Text(game,0,21*window.GameConfig.RESIZE,"NHẬN",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:31});t.anchor.set(.5,0),this.btnClaim.addChild(t),this.btnClaim.inputEnabled=!0,this.btnClaim.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick);var t=game.add.tween(e.popup).to({y:-420*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.eventInput.claim.dispatch(),e.destroy()},e)},this),this.popup.addChild(this.btnClaim)}},{key:"addMedal",value:function(){this.medal=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.medal_popup.x,this.positionQAndAConfig.achievement.medal_popup.y,this.positionQAndAConfig.achievement.medal_popup.nameAtlas,this.positionQAndAConfig.achievement.medal_popup.nameSprite),this.medal.anchor.set(.5),this.medal.scale.set(.6),this.popup.addChild(this.medal)}},{key:"loadMedal",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"onLoad",value:function(){try{game.cache.checkImageKey(this.key)&&this&&this.medal.loadTexture("".concat(this.key))}catch(e){}}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"addFireWork",value:function(){var e=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,355*window.GameConfig.RESIZE,"firework");e.anchor.set(.5),this.addChild(e);e.animations.add("run_win");e.animations.play("run_win",40,!0)}},{key:"makeTweenPopup",value:function(){ce.instance().playSound(ce.popupfinishachievement),game.add.tween(this.popup).to({y:(game.height-781)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start()}},{key:"onClose",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-420*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.destroy()},this),this.popup.event.close.remove(this.onClose,this)}}])&&ro(n.prototype,i),o&&ro(n,o),t}();function fo(e){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function po(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function go(e,t){return!t||"object"!==fo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yo(e){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mo(e,t){return(mo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vo=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),go(this,yo(t).call(this,game,e,n,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mo(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"add",value:function(e){this.addChild(e)}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&po(n.prototype,i),o&&po(n,o),t}();function wo(e){return(wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function So(e,t){return!t||"object"!==wo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _o(e){return(_o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eo(e,t){return(Eo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Co=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=So(this,_o(t).call(this,game,e,n,null))).dailyRewardConfig=JSON.parse(game.cache.getText("dailyRewardConfig")),a.configs=i,a.state=o,a.afterInit(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eo(e,t)}(t,Phaser.Sprite),n=t,o=[{key:"DIAMOND",get:function(){return"DIAMOND"}},{key:"SUPPORT_ITEM",get:function(){return"SUPPORT_ITEM"}},{key:"TICKET",get:function(){return"TICKET"}},{key:"INIT",get:function(){return"INIT"}},{key:"NOT_INIT",get:function(){return"NOT_INIT"}},{key:"REWARDED",get:function(){return"REWARDED"}}],(i=[{key:"afterInit",value:function(){this.box,this.resourceSprite,this.rewardTxt,this.day,LogConsole.log(this.configs),this.addBox(),this.addResourceSprite(),this.addRewardTxt(),this.addDay()}},{key:"addBox",value:function(){LogConsole.log("addBox"),this.state==t.INIT?(this.box=new rt(this.dailyRewardConfig.daily_reward.box_init),this.addChild(this.box)):(this.box=new rt(this.dailyRewardConfig.daily_reward.box),this.addChild(this.box))}},{key:"addResourceSprite",value:function(){var e=this;if(LogConsole.log("addResourceSprite"),this.configs.reward_type==t.DIAMOND?(this.resourceSprite=new rt(this.dailyRewardConfig.daily_reward.resource.diamond),this.resourceSprite.anchor.set(.5),this.addChild(this.resourceSprite)):this.configs.reward_type==t.SUPPORT_ITEM?(this.resourceSprite=new rt(this.dailyRewardConfig.daily_reward.resource.spt_item),this.resourceSprite.anchor.set(.5),this.addChild(this.resourceSprite)):(this.resourceSprite=new rt(this.dailyRewardConfig.daily_reward.resource.ticket),this.resourceSprite.anchor.set(.5),this.addChild(this.resourceSprite)),this.state==t.INIT){this.tweenParent=game.add.tween(this.resourceSprite).to({alpha:1},1e3,Phaser.Easing.Linear.In,!0),this.tweenParent.loop();var n=.1;this.tweenParent.onUpdateCallback(function(){e.resourceSprite.rotation+=n,e.resourceSprite.rotation>.2?n=-.07:e.resourceSprite.rotation<-.2&&(n=.07)},this)}}},{key:"addRewardTxt",value:function(){LogConsole.log("addRewardTxt"),this.state==t.REWARDED?(this.rewardTxt=new rt(this.dailyRewardConfig.daily_reward.icon_rewarded),this.rewardTxt.anchor.set(.5),this.addChild(this.rewardTxt)):(this.rewardTxt=new Phaser.Text(game,this.dailyRewardConfig.daily_reward.txt_reward.x*window.GameConfig.RESIZE,this.dailyRewardConfig.daily_reward.txt_reward.y*window.GameConfig.RESIZE,this.configs.reward,this.dailyRewardConfig.daily_reward.txt_reward.style),this.rewardTxt.anchor.set(.5,0),this.addChild(this.rewardTxt))}},{key:"addDay",value:function(){LogConsole.log("addDay"),this.day=new Phaser.Text(game,this.dailyRewardConfig.daily_reward.txt_day.x*window.GameConfig.RESIZE,this.dailyRewardConfig.daily_reward.txt_day.y*window.GameConfig.RESIZE,"".concat(this.dailyRewardConfig.daily_reward.txt_day.text).concat(this.configs.day),this.dailyRewardConfig.daily_reward.txt_day.style),this.day.anchor.set(.5,0),this.addChild(this.day)}},{key:"changeRewarded",value:function(){this.tweenParent.stop(),this.resourceSprite.rotation=0,this.rewardTxt.destroy(),this.rewardTxt=null,this.rewardTxt=new rt(this.dailyRewardConfig.daily_reward.icon_rewarded),this.rewardTxt.anchor.set(.5),this.addChild(this.rewardTxt)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&bo(n.prototype,i),o&&bo(n,o),t}(),ko={AUTO_DETECT_THRESHOLD:8};function Po(e,t){return e["nominal".concat((n=t,n.charAt(0).toUpperCase()+n.slice(1)))]||e[t];var n}function Oo(e,t,n){if("onInputUp"!=n||!function(e){var t=Math.abs(e.positionDown.x-e.positionUp.x),n=Math.abs(e.positionDown.y-e.positionUp.y);return e.timeUp,e.timeDown,t>ko.AUTO_DETECT_THRESHOLD||n>ko.AUTO_DETECT_THRESHOLD}(e)){var i=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return!1;for(var o=0;o<t.length;o++){var a=t[o];if(a){if(n.call(i,a))return a;var s=e(a.children,n,i);if(s)return s}}return!1}(t,function(t){var n=t.worldPosition,i=t.anchor,o=t.pivot,a=t.width,s=t.height,r=t.scale,l=n.x-(i?i.x*a:0)-o.x*r.x,h=n.y-(i?i.y*s:0)-o.y*r.y;return t.inputEnabled&&new Phaser.Rectangle(l,h,t.width,t.height).contains(e.x,e.y)});return i&&i.events&&i.events[n]&&i.events[n].dispatch&&i.events[n].dispatch(i,e,!0),i}}function Ro(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var xo={direction:"y",autocull:!0,padding:10},To=function(){function e(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.parent=n,this.bounds=i,this.idx=0,this.o=this.options=Object.assign({},xo,o),this.items=[],"y"==this.o.direction?this.p={xy:"y",wh:"height"}:this.p={xy:"x",wh:"width"},this.grp=this.game.add.group(n),this.grp.position.set(i.x,i.y),this.events={onAdded:new Phaser.Signal,changeIndex:new Phaser.Signal},this.position=0,this.grp.mask=this._addMask(i)}var t,n,i;return t=e,(n=[{key:"add",value:function(e){this.items.push(e);var t=0;if(this.grp.children.length>0){var n=this.grp.getChildAt(this.grp.children.length-1);t=n[this.p.xy]+Po(n,this.p.wh)+this.o.padding}return e[this.p.xy]=t,this.grp.addChild(e),this.length=t+Po(e,this.p.wh),this.events.onAdded.dispatch(this.length-this.bounds[this.p.wh]),e}},{key:"addMultiple",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(this.add,this)}},{key:"remove",value:function(e){LogConsole.log("remove child-listview"),this.grp.removeChild(e);var t=this.items.indexOf(e);if(-1!=t)return this.items.splice(t,1),e}},{key:"destroy",value:function(){LogConsole.log("destroy-listview"),null!=this.events&&(this.events.onAdded.dispose(),this.events=null),null!==this.grp&&(this.grp.destroy(),this.grp=null),this.game=null,this.parent=null,this.items=null}},{key:"removeAll",value:function(){if(null!==this.grp){for(;this.grp.children.length>0;){var e=this.grp.children[0];this.remove(e),e.destroy(),e=null}this.grp.removeAll()}this.items=[]}},{key:"cull",value:function(){for(var e=[],t=0;t<this.items.length;t++){var n=this.items[t];n[this.p.xy]+Po(n,this.p.wh)+this.grp[this.p.xy]<this.bounds[this.p.xy]?n.visible=!1:n[this.p.xy]+this.grp[this.p.xy]>this.bounds[this.p.xy]+this.bounds[this.p.wh]?n.visible=!1:(n.visible=!0,this.idx=t,this.events.changeIndex.dispatch(),e.push(n))}this.scroller.registerClickables(e)}},{key:"getIdx",value:function(){return this.idx}},{key:"getPositionByItemIndex",value:function(e){return-this.items[e][this.p.xy]}},{key:"setPosition",value:function(e){this.moveToPosition(e)}},{key:"moveToPosition",value:function(e){this.scroller.setTo(e)}},{key:"moveToItem",value:function(e){this.scroller.setTo(this.getPositionByItemIndex(e))}},{key:"tweenToPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.scroller.tweenTo(t,e)}},{key:"tweenToItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.scroller.tweenTo(t,this.getPositionByItemIndex(e))}},{key:"_setPosition",value:function(e){this.position=e,this.grp[this.p.xy]=this.bounds[this.p.xy]+e,this.o.autocull&&this.cull()}},{key:"_addMask",value:function(e){var t=this.game.add.graphics(0,0,this.parent);return t.beginFill(16711680).drawRect(e.x,e.y,e.width,e.height),t.alpha=0,t}}])&&Ro(t.prototype,n),i&&Ro(t,i),e}(),Io={nearestMultiple:function(e,t){return Math.round(e/t)*t},scaleBetween:function(e,t,n){return e+(t-e)*n},percentageBetween2:function(e,t,n){return(e-t)/(n-t)}};function Ao(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Go=new Phaser.Point,Do={from:0,to:200,direction:"y",momentum:!1,snapping:!1,bouncing:!1,deceleration:.5,overflow:20,snapStep:10,emitMoving:!1,duration:2,speedLimit:3,flickTimeThreshold:100,offsetThreshold:30,acceleration:.5,accelerationT:250,maxAcceleration:4,time:{},multiplier:1,swipeEnabled:!1,swipeThreshold:5,swipeTimeThreshold:250,minDuration:.5,addListeners:!0},Mo=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.clickObject=n,this.maskLimits=i,this.o=this.options=Object.assign({},Do,o),this._updateMinMax(),this.dispatchValues={step:0,total:0,percent:0},this.addListeners(),this.clickables=[],this.isDown=!1,this.isScrolling=!1,this.scrollObject={},this.init(),this.tweenScroll=this.game.add.tween(this.scrollObject).to({},0,Phaser.Easing.Quartic.Out),this.tweenScroll.onUpdateCallback(this.handleUpdate,this),this.tweenScroll.onComplete.add(this.handleComplete,this)}var t,n,i;return t=e,(n=[{key:"destroy",value:function(){LogConsole.log("destroy"),this.tweenScroll.stop(),this.removeListeners(),this.clickObject.destroy(),this.clickables=null,this.options=this.o=null,this.maskLimits=null,this.enabled=!1,this.game=null,this.dispatchValues=null,this.isDown=null,this.target=null,this.destroyed=!0}},{key:"addListeners",value:function(){this.events={onUpdate:new Phaser.Signal,onInputUp:new Phaser.Signal,onInputDown:new Phaser.Signal,onInputMove:new Phaser.Signal,onComplete:new Phaser.Signal,onSwipe:new Phaser.Signal},this.o.addListeners&&(this.clickObject.inputEnabled=!0,this.clickObject.events.onInputDown.add(this.handleDown,this),this.clickObject.events.onInputUp.add(this.handleUp,this))}},{key:"removeListeners",value:function(){for(var e in this.o.addListeners&&(this.clickObject.events.onInputDown.remove(this.handleDown,this),this.clickObject.events.onInputUp.remove(this.handleUp,this)),this.events)this.events.hasOwnProperty(e)&&this.events[e].dispose()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1}},{key:"init",value:function(){this.scrollObject[this.o.direction]=this.o.from,this.maxOffset=this.maskLimits[this.o.direction]*this.o.speedLimit,this.enable()}},{key:"reset",value:function(){this.tweenScroll.pause(),this.o.multiplier=1,this.init()}},{key:"setFromTo",value:function(e,t){this.o.from=e,this.o.to=t,this._updateMinMax()}},{key:"isTweening",value:function(){return this.tweenScroll.isRunning}},{key:"registerClickables",value:function(e){this.clickables=e}},{key:"handleDown",value:function(e,t){this.enabled&&(this.isDown=!0,this.target=this.requested=this.scrollObject[this.o.direction],this.o.time.down=t.timeDown,this.o.addListeners&&this.game.input.addMoveCallback(this.handleMove,this),this.isTweening()&&this.o.time.down-this.o.time.up<this.o.accelerationT?this.o.multiplier+=this.o.acceleration:this.o.multiplier=1,this.tweenScroll.stop(),this.tweenScroll.pendingDelete=!1,Oo(t,this.clickables,"onInputDown"),this.events.onInputDown.dispatch(e,t))}},{key:"handleMove",value:function(e,t,n){this.enabled&&(this.isScrolling=!0,Go.set(t,n),this.diff=this.old-Go[this.o.direction],this.diff=this._requestDiff(this.diff,this.target,this.min,this.max,this.o.overflow),this.target-=this.diff,this.old=Go[this.o.direction],this.o.time.move=this.game.time.time,this.acc=Math.min(Math.abs(this.diff/30),this.o.maxAcceleration),this.scrollObject[this.o.direction]=this.target,this.handleUpdate(),this.o.emitMoving&&this.events.onInputMove.dispatch(e,t,n))}},{key:"handleUp",value:function(e,t){this.isDown=!1,this.o.addListeners&&this.game.input.deleteMoveCallback(this.handleMove,this),this.o.time.up=t.timeUp,this.o.time.up-this.o.time.down>this.o.accelerationT&&(this.o.multiplier=1);var n={duration:.5,target:this.target};this.o.bouncing||(n.duration=.01),!this.o.infinite&&this.scrollObject[this.o.direction]>this.max?(this.target=this.max,this.tweenTo(n.duration,this.target)):!this.o.infinite&&this.scrollObject[this.o.direction]<this.min?(this.target=this.min,this.tweenTo(n.duration,this.target)):(this._addMomentum(n),this._addSwiping(n,t),this._addSnapping(n),this._addLimits(n),this._calculateDuration(n),this.tweenTo(n.duration,n.target)),Oo(t,this.clickables,"onInputUp"),this.events.onInputUp.dispatch(e,t,Oo)}},{key:"_addMomentum",value:function(e){if(!this.o.momentum)return e.target;var t=Math.pow(this.acc,2)*this.maskLimits[this.o.direction];return t=Math.min(this.maxOffset,t),t=this.diff>0?-this.o.multiplier*t:this.o.multiplier*t,this.o.time.up-this.o.time.move<this.o.flickTimeThreshold&&0!==t&&Math.abs(t)>this.o.offsetThreshold&&(e.target+=t),e}},{key:"_addSwiping",value:function(e,t){var n=Math.abs(this.down-this.current);if(this.o.swipeEnabled&&this.o.time.up-this.o.time.down<this.o.swipeTimeThreshold&&n>this.o.swipeThreshold){var i=t[this.o.direction]<this.down?"forward":"backward";"forward"==i?e.target-=this.o.snapStep/2:e.target+=this.o.snapStep/2,this.events.onSwipe.dispatch(i)}return e}},{key:"_addSnapping",value:function(e){return this.o.snapping?(e.target=Io.nearestMultiple(e.target,this.o.snapStep),e):e}},{key:"_addLimits",value:function(e){return this.o.infinite?e:(e.target=Math.max(e.target,this.min),e.target=Math.min(e.target,this.max),e)}},{key:"_calculateDuration",value:function(e){var t=Math.abs(e.target-this.scrollObject[this.o.direction]);return e.duration=this.o.duration*t/this.maxOffset,e.duration=Math.max(this.o.minDuration,e.duration),e}},{key:"_requestDiff",value:function(e,t,n,i,o){if(this.o.infinite)return e;return t>i?e*=(i+o-t)/o:t<n&&(e*=-(n-o-t)/o),e}},{key:"tweenToSnap",value:function(e,t){var n=this.o.from-this.o.snapStep*t;this.tweenTo(e,n)}},{key:"tweenTo",value:function(e,t){if(0===e)return this.setTo(t);Ao({},this.o.direction,t);t>this.max&&(t=this.max),t<this.min&&(t=this.min),this.tweenScroll.stop(),this.game.tweens.remove(this.tweenScroll),this.tweenScroll=this.game.add.tween(this.scrollObject).to(Ao({},this.o.direction,t),1e3*e,Phaser.Easing.Quartic.Out),this.tweenScroll.onUpdateCallback(this.handleUpdate,this),this.tweenScroll.onComplete.add(this.handleComplete,this),this.tweenScroll.start()}},{key:"cancel",value:function(){this.isDown=!1}},{key:"setTo",value:function(e){e>this.max&&(e=this.max),e<this.min&&(e=this.min),this.scrollObject[this.o.direction]=e,this.tweenScroll.stop(),this.handleUpdate(),this.handleComplete()}},{key:"handleUpdate",value:function(){if(this.enabled){this.o.infinite?this.dispatchValues.total=Phaser.Math.wrap(this.scrollObject[this.o.direction],this.min,this.max):this.dispatchValues.total=this.scrollObject[this.o.direction];var e=this.dispatchValues.total-this.previousTotal;e<-this.length/2?e+=this.length:e>this.length/2&&(e-=this.length),this.dispatchValues.step=e,this.dispatchValues.percent=Io.percentageBetween2(this.dispatchValues.total,this.o.from,this.o.to),this.events.onUpdate.dispatch(this.dispatchValues),this.previousTotal=this.dispatchValues.total}}},{key:"handleComplete",value:function(){LogConsole.log("handleComplete"),this.enabled&&(this.isScrolling=!1,this.o.multiplier=1,this.events.onComplete.dispatch())}},{key:"_updateMinMax",value:function(){this.min=Math.min(this.o.from,this.o.to),this.max=Math.max(this.o.from,this.o.to),this.length=Math.abs(this.max-this.min),this.previousTotal=this.o.from}}])&&Lo(t.prototype,n),i&&Lo(t,i),e}();function No(e){return(No="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jo(e,t){return!t||"object"!==No(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uo(e,t,n){return(Uo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fo(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Fo(e){return(Fo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zo(e,t){return(Zo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ho=function(e){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jo(this,Fo(t).call(this,e,n,{x:n.width,y:n.height},i))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zo(e,t)}(t,Mo),n=t,(i=[{key:"handleDown",value:function(e,n){this.old=this.down=n[this.o.direction],Uo(Fo(t.prototype),"handleDown",this).call(this,e,n)}},{key:"handleUp",value:function(e,n){this.current=n[this.o.direction],Uo(Fo(t.prototype),"handleUp",this).call(this,e,n)}}])&&Bo(n.prototype,i),o&&Bo(n,o),t}();function Qo(e){return(Qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wo(e,t){return!t||"object"!==Qo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qo(e,t,n){return(qo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ko(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ko(e){return(Ko=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zo(e,t){return(zo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yo={direction:"y",autocull:!0,momentum:!0,bouncing:!0,snapping:!1,overflow:100,padding:10,searchForClicks:!1},Jo=function(e){function t(e,n,i){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Wo(this,Ko(t).call(this,e,n,function(e){return e.x=e.x?e.x:0,e.y=e.y?e.y:0,e.width<=0?console.warn("PhaserListView: bounds.width <= 0"):e.height<=0&&console.warn("PhaserListView: bounds.height <= 0"),e}(i),Object.assign({},Yo,a)))).scroller=new Ho(o.game,o._addMask(i),Object.assign({from:0,to:0},o.options)),o.scroller.events.onUpdate.add(function(e){o._setPosition(e.total)}),o.events.onAdded.add(function(e){var t=Math.min(-e,0);o.scroller.setFromTo(0,t),o.options.searchForClicks&&o.scroller.registerClickables(o.items)}),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zo(e,t)}(t,To),n=t,(i=[{key:"destroy",value:function(){null!==this.scroller&&(this.scroller.destroy(),this.scroller=null),qo(Ko(t.prototype),"destroy",this).call(this)}},{key:"reset",value:function(){this._setPosition(0),this.scroller.reset()}}])&&Vo(n.prototype,i),o&&Vo(n,o),t}();function Xo(e){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ea(e,t){return!t||"object"!==Xo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ta(e){return(ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function na(e,t){return(na=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ia=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ea(this,ta(t).call(this,game,0,1140*window.GameConfig.RESIZE,null))).dailyRewardConfig=JSON.parse(game.cache.getText("dailyRewardConfig")),i.dailyRewardSettings=e,i.dailyRewardLog=n,i.popup,i.event={claimDailyReward:new Phaser.Signal},i.addPopup(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&na(e,t)}(t,Phaser.Sprite),n=t,o=[{key:"INIT",get:function(){return"INIT"}},{key:"NOT_INIT",get:function(){return"NOT_INIT"}},{key:"REWARDED",get:function(){return"REWARDED"}}],(i=[{key:"addPopup",value:function(){this.addEventExtension(),this.popup=new rt(this.dailyRewardConfig.popup),this.popup.x=18*window.GameConfig.RESIZE,this.popup.y=233*window.GameConfig.RESIZE,this.addChild(this.popup),this.addDecoPopup(),this.addListReward()}},{key:"addDecoPopup",value:function(){this.boxGift,this.ribbon,this.btnClaim,this.txtHeader,this.initRewardIndex=-1,this.rewardObj,this.addBoxGift(),this.addBtnClaim(),this.addBtnWatch(),this.addTxtHeader()}},{key:"addBoxGift",value:function(){this.boxGift=new rt(this.dailyRewardConfig.decorate.box_gift),this.boxGift.anchor.set(.5),this.popup.addChild(this.boxGift)}},{key:"addRibbon",value:function(){this.ribbon=new rt(this.dailyRewardConfig.decorate.ribbon),this.popup.addChild(this.ribbon)}},{key:"addBtnClaim",value:function(){this.btnClaim=new pt(this.dailyRewardConfig.decorate.btn_claim,this.onClickClaim,this),this.btnClaim.anchor.set(.5);var e=new St(this.dailyRewardConfig.decorate.txt_btn,this.dailyRewardConfig.decorate.txt_btn.text);e.anchor.set(.5),this.btnClaim.addChild(e),this.popup.addChild(this.btnClaim)}},{key:"onClickClaim",value:function(){this.event.claimDailyReward.dispatch(this.rewardObj,0)}},{key:"changeItemChildInit",value:function(){this.btnClaim.kill(),this.btnWatch.kill(),this.groupPlaylists.children[this.initRewardIndex-1].changeRewarded()}},{key:"addBtnWatch",value:function(){this.btnWatch=new pt(this.dailyRewardConfig.decorate.btn_watch_video_reward,this.onClickWatch,this),this.btnWatch.anchor.set(.5);var e=new rt(this.dailyRewardConfig.decorate.btn_watch_video_reward.camera);this.btnWatch.addChild(e);var t=new St(this.dailyRewardConfig.decorate.btn_watch_video_reward.txt1,this.dailyRewardConfig.decorate.btn_watch_video_reward.txt1.text),n=new St(this.dailyRewardConfig.decorate.btn_watch_video_reward.txt2,this.dailyRewardConfig.decorate.btn_watch_video_reward.txt2.text);this.btnWatch.addChild(t),this.btnWatch.addChild(n),this.popup.addChild(this.btnWatch)}},{key:"onClickWatch",value:function(){li.instance().showRewardVideoX2Daily()}},{key:"addTxtHeader",value:function(){this.txtHeader=new St(this.dailyRewardConfig.decorate.txt_header,this.dailyRewardConfig.decorate.txt_header.text),this.txtHeader.anchor.set(.5),this.popup.addChild(this.txtHeader)}},{key:"addListReward",value:function(){var e=0,n=35*window.GameConfig.RESIZE;this.groupPlaylists=new vo(0,0*window.GameConfig.RESIZE);var i=new Phaser.Group(game,this);i.x=0,i.y=148*window.GameConfig.RESIZE,this.popup.addChild(i);var o=new Phaser.Rectangle(17*window.GameConfig.RESIZE,0,570*window.GameConfig.RESIZE,551*window.GameConfig.RESIZE);this.listView=new Jo(game,i,o,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),LogConsole.log(this.dailyRewardSettings);for(var a=1;a<this.dailyRewardSettings.length+1;a++){if(this.dailyRewardSettings[a-1].day<this.dailyRewardLog.day){var s=new Co(e,n,this.dailyRewardSettings[a-1],t.REWARDED);this.groupPlaylists.add(s)}else if(this.dailyRewardSettings[a-1].day==this.dailyRewardLog.day){var r=new Co(e,n,this.dailyRewardSettings[a-1],this.dailyRewardLog.state);this.rewardObj=this.dailyRewardSettings[a-1],this.initRewardIndex=a,this.groupPlaylists.add(r)}else{var l=new Co(e,n,this.dailyRewardSettings[a-1],t.NOT_INIT);this.groupPlaylists.add(l)}a%5==0&&a>0?(e=0,n+=window.GameConfig.CONFIGS_DAILY_REWARD.y*window.GameConfig.RESIZE,this.groupPlaylists.height+=window.GameConfig.CONFIGS_DAILY_REWARD.y*window.GameConfig.RESIZE):e+=window.GameConfig.CONFIGS_DAILY_REWARD.x*window.GameConfig.RESIZE}this.listView.add(this.groupPlaylists)}},{key:"addEventExtension",value:function(){li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this)}},{key:"removeEventExtension",value:function(){li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.remove(this.rewardedVideoFailed,this)}},{key:"rewardedVideoRewardReceived",value:function(){this.event.claimDailyReward.dispatch(this.rewardObj,1)}},{key:"rewardedVideoFailed",value:function(){Gn.instance().addDialog("No ads to show"),this.btnClaim.inputEnabled=!0,this.btnWatch.inputEnabled=!0}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&$o(n.prototype,i),o&&$o(n,o),t}();function oa(e){return(oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sa(e,t){return!t||"object"!==oa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ra(e){return(ra=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function la(e,t){return(la=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ha=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=sa(this,ra(t).call(this,game))).dailyRewardConfig=JSON.parse(game.cache.getText("dailyRewardConfig")),i.dailyRewardSettings=e,i.dailyRewardLog=n,i.event={claimDone:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&la(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.bg,this.headerResource,this.popup,this.addBg(),this.addHeaderResource(),this.addPopup(),Le.instance().logEvent(Le.Daily_reward)}},{key:"addBg",value:function(){this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg)}},{key:"addHeaderResource",value:function(){this.headerResource=new Phaser.Group(game),this.addChild(this.headerResource),this.txtGem,this.txtTicket,this.txtMic,this.tabGemHeader,this.tabTicketHeader,this.tabMicHeader,this.addTabGemHeader(this.dailyRewardConfig.header),this.addTabTicketHeader(this.dailyRewardConfig.header),this.addTabMicHeader(this.dailyRewardConfig.header)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.dailyRewardConfig.header.gem);this.txtGem=this.addTxtGem(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtGem.width;this.txtGem.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtGem.width+5*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(this.txtGem),this.headerResource.addChild(this.tabGemHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addTabTicketHeader",value:function(e){this.tabTicketHeader=new Phaser.Sprite(game,e.tabTicket.x*window.GameConfig.RESIZE,e.tabTicket.y*window.GameConfig.RESIZE,e.tabTicket.nameAtlas,e.tabTicket.nameSprite);var t=this.addTicket(this.dailyRewardConfig.header.ticket);this.txtTicket=this.addTxtTicket(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtTicket.width;this.txtTicket.x=(this.tabTicketHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabTicketHeader.width-n)/2+this.txtTicket.width+5*window.GameConfig.RESIZE,this.tabTicketHeader.addChild(t),this.tabTicketHeader.addChild(this.txtTicket),this.headerResource.addChild(this.tabTicketHeader)}},{key:"addTicket",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtTicket",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("ticket").value,e.configs)}},{key:"addTabMicHeader",value:function(e){this.tabMicHeader=new Phaser.Sprite(game,e.tabMic.x*window.GameConfig.RESIZE,e.tabMic.y*window.GameConfig.RESIZE,e.tabMic.nameAtlas,e.tabMic.nameSprite);var t=this.addMic(this.dailyRewardConfig.header.micro);this.txtMic=this.addTxtMic(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtMic.width;this.txtMic.x=(this.tabMicHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabMicHeader.width-n)/2+this.txtMic.width+10*window.GameConfig.RESIZE,this.tabMicHeader.addChild(t),this.tabMicHeader.addChild(this.txtMic),this.headerResource.addChild(this.tabMicHeader)}},{key:"addMic",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtMic",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("support_item").value,e.configs)}},{key:"addPopup",value:function(){this.popup=new ia(this.dailyRewardSettings,this.dailyRewardLog),this.popup.event.claimDailyReward.add(this.onClaimDaily,this),this.addChild(this.popup),game.add.tween(this.popup).to({y:game.height-z.instance().STANDARD_HEIGHT},1800,Phaser.Easing.Elastic.Out,!1).start(),ce.instance().playSound(ce.dailyreward)}},{key:"onClaimDaily",value:function(e,t){this.rewardObj=e,this.is_watched_ads=t,this.sendClaim()}},{key:"sendClaim",value:function(){var e=new SFS2X.SFSObject;e.putInt("is_watched_ads",this.is_watched_ads),mZ.instance().sendData(Et.DAILY_REWARD_CLAIM_REQUEST,e)}},{key:"onClaimDailyDone",value:function(){var e=this;this.popup.changeItemChildInit();var t={x:0,y:0};"DIAMOND"==this.rewardObj.reward_type?(t.x=351,t.y=54):"TICKET"==this.rewardObj.reward_type?(t.x=529,t.y=54):(t.x=164,t.y=54);var n=this.rewardObj.reward;1==this.is_watched_ads&&(n*=2),iC.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:this.rewardObj.reward_type,reward:n,finishPoint:t}),this.timeTweenUpdateRs=game.time.events.add(2*Phaser.Timer.SECOND,function(){e.updateVariableResource(e.rewardObj),e.timeTweenDispatchClaim=game.time.events.add(1.5*Phaser.Timer.SECOND,function(){e.event.claimDone.dispatch(),e.destroy()},e)},this)}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.DAILY_REWARD_CLAIM_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.onClaimDailyDone()}},{key:"updateVariableResource",value:function(e){var t=this;if("DIAMOND"==e.reward_type){this.txtGem.setText(mZ.instance().socket.mySelf.getVariable("diamond").value-e.reward);var n=game.add.tween(this.txtGem).to({text:mZ.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.txtGem.text=parseInt(t.txtGem.text)},this)}else if("TICKET"==e.reward_type){this.txtTicket.setText(mZ.instance().socket.mySelf.getVariable("ticket").value-e.reward);var i=game.add.tween(this.txtTicket).to({text:mZ.instance().socket.mySelf.getVariable("ticket").value},300,"Linear",!1);i.start(),i.onUpdateCallback(function(){t.txtTicket.text=parseInt(t.txtTicket.text)},this)}else if("SUPPORT_ITEM"==e.reward_type){this.txtMic.setText(mZ.instance().socket.mySelf.getVariable("support_item").value-e.reward);var o=game.add.tween(this.txtMic).to({text:mZ.instance().socket.mySelf.getVariable("support_item").value},300,"Linear",!1);o.start(),o.onUpdateCallback(function(){t.txtMic.text=parseInt(t.txtMic.text)},this)}}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.popup.event.claimDailyReward.remove(this.onClaimDaily,this),game.time.events.remove(this.timeTweenDispatchClaim),game.time.events.remove(this.timeTweenDispatchClaim);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&aa(n.prototype,i),o&&aa(n,o),t}();function ca(e){return(ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ua(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function da(e,t){return!t||"object"!==ca(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fa(e,t,n){return(fa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pa(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pa(e){return(pa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ga(e,t){return(ga=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ya=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=da(this,pa(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,null,i,o))).objConfig=e,game.cache.addNinePatch(e.name,e.nameAtlas,e.nameSprite,e.left*z.instance().scale,e.right*z.instance().scale,e.top*z.instance().scale,e.bot*z.instance().scale),a.bg=new Phaser.NinePatchImage(game,0,0,e.name),a.bg.targetWidth=e.width*z.instance().scale,a.bg.targetHeight=e.height*z.instance().scale,a.bg.UpdateImageSizes(),a.addChild(a.bg),a.addChild(a.bg),a.icon=null,e.icon&&(a.icon=new rt(e.icon),e.icon.width&&(a.icon.width=e.icon.width*z.instance().scale),e.icon.height&&(a.icon.height=e.icon.height*z.instance().scale),a.addChild(a.icon)),a.lbBtn=new St(e.configText,n),a.reSize(),a.addChild(a.lbBtn),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ga(e,t)}(t,Phaser.Button),n=t,(i=[{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),fa(pa(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"reSize",value:function(){var e=0,t=0,n=0,i=0,o=0,a=0;this.objConfig.configText.hasOwnProperty("paddingLeft")&&(n=this.objConfig.configText.paddingLeft*z.instance().scale),this.objConfig.configText.hasOwnProperty("paddingRight")&&(i=this.objConfig.configText.paddingRight*z.instance().scale),this.objConfig.configText.hasOwnProperty("paddingTop")&&(o=this.objConfig.configText.paddingTop*z.instance().scale),this.objConfig.configText.hasOwnProperty("paddingBot")&&(a=this.objConfig.configText.paddingBot*z.instance().scale),null==this.icon?(e=this.objConfig.configText.width?this.objConfig.configText.width*z.instance().scale-i-n:this.width-i-n,t=this.objConfig.configText.height?this.objConfig.configText.height*z.instance().scale-o-a:this.height-o-a,this.lbBtn.setTextBounds(0,0,e,t),this.lbBtn.x=i>0?this.width-i-e:n>0?n:(this.width-e)/2,this.lbBtn.y=o>0?o:a>0?this.height-a:(this.height-t)/2):(e=this.objConfig.configText.width?this.objConfig.configText.width*z.instance().scale-i-n:"right"==this.objConfig.icon.align?this.width-this.icon.x-6*z.instance().scale-i-n:this.width-this.icon.x-this.icon.width-6*z.instance().scale-i-n,t=this.objConfig.configText.height?this.objConfig.configText.height*z.instance().scale-o-a:this.height-o-a,this.objConfig.hasOwnProperty("alignAll")?this.setKCTextCenter():(this.lbBtn.setTextBounds(0,0,e,t),"right"==this.objConfig.icon.align?this.lbBtn.x=i>0?this.width-i-e:n>0?n:this.icon.x-e-6*z.instance().scale:this.lbBtn.x=i>0?this.width-i-e:n>0?n:this.icon.x+this.icon.width+6*z.instance().scale,this.lbBtn.y=o>0?o:a>0?this.height-a:(this.height-t)/2))}},{key:"setKCTextCenter",value:function(){var e=0,t=0;this.objConfig.configText.hasOwnProperty("paddingTop")&&(e=this.objConfig.configText.paddingTop*z.instance().scale),this.objConfig.configText.hasOwnProperty("paddingBot")&&(t=this.objConfig.configText.paddingBot*z.instance().scale);var n=6*z.instance().scale;this.objConfig.hasOwnProperty("kc")&&(n=this.objConfig.hasOwnProperty("kc")*z.instance().scale),"right"==this.objConfig.icon.align?(this.lbBtn.x=(this.width-(this.lbBtn.width+n+this.icon.width))/2,this.icon.x=this.lbBtn.x+this.lbBtn.width+n):(this.icon.x=(this.width-(this.lbBtn.width+n+this.icon.width))/2,this.lbBtn.x=this.icon.x+this.icon.width+n),this.lbBtn.y=e>0?e:t>0?this.height-t:(this.height-this.lbBtn.height)/2}},{key:"text",set:function(e){this.lbBtn.text=e,this.reSize()}},{key:"width",get:function(){return this.bg.targetWidth},set:function(e){this.bg.targetWidth=e,this.bg.UpdateImageSizes()}},{key:"height",get:function(){return this.bg.targetHeight},set:function(e){this.bg.targetHeight=e,this.bg.UpdateImageSizes()}}])&&ua(n.prototype,i),o&&ua(n,o),t}();var ma=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userName="",this.diamond=0,this.userId=0,this.avatar="",this.isOnline=!1};function va(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var wa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"avatar",get:function(){return"avatar"}},{key:"diamond",get:function(){return"diamond"}},{key:"is_online",get:function(){return"is_online"}},{key:"userId",get:function(){return"userId"}},{key:"userName",get:function(){return"userName"}},{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"room_master",get:function(){return"room_master"}},{key:"gender",get:function(){return"gender"}},{key:"experience_score",get:function(){return"experience_score"}},{key:"heart",get:function(){return"heart"}},{key:"ticket",get:function(){return"ticket"}},{key:"weekly_high_score",get:function(){return"weekly_high_score"}},{key:"all_time_high_score",get:function(){return"all_time_high_score"}},{key:"level",get:function(){return"level"}},{key:"online_mode_genre",get:function(){return"online_mode_genre"}},{key:"online_mode_room_ready",get:function(){return"online_mode_room_ready"}},{key:"online_mode_loaded",get:function(){return"online_mode_loaded"}},{key:"is_playing_game",get:function(){return"is_playing_game"}},{key:"status",get:function(){return"status"}},{key:"playlists",get:function(){return"playlists"}},{key:"bets",get:function(){return"bets"}},{key:"id",get:function(){return"id"}},{key:"bet_place",get:function(){return"bet_place"}},{key:"percent_of_fee",get:function(){return"percent_of_fee"}},{key:"suggestion_playlist",get:function(){return"suggestion_playlist"}},{key:"score",get:function(){return"score"}},{key:"is_correct_answer",get:function(){return"is_correct_answer"}},{key:"diamond_change",get:function(){return"diamond_change"}},{key:"exp_score",get:function(){return"exp_score"}},{key:"players",get:function(){return"players"}},{key:"users",get:function(){return"users"}},{key:"streak",get:function(){return"streak"}},{key:"friends",get:function(){return"friends"}}],(n=null)&&va(t.prototype,n),i&&va(t,i),e}();function ba(e){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _a(e,t){return!t||"object"!==ba(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ea(e){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ca(e,t){return(Ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ka=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=_a(this,Ea(t).call(this,game))).index=n,i.afterCreate(e),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ca(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterCreate",value:function(e){this._width=e,this._height=272*window.GameConfig.RESIZE,this.key="",this.ava=new Phaser.Sprite(game,0,0,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.signalInput=new Phaser.Signal,this.maskAva=new Phaser.Graphics(game,0,0),this.addChild(this.ava)}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.onClickSprite,this)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch(this.value),LogConsole.log("hehehe")}},{key:"addNameAva",value:function(e,t){this.txtName=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,t,e.configs),this.txtName.anchor.set(.5,0),this.addChild(this.txtName)}},{key:"addMaskAva",value:function(e){this.maskAva.beginFill(),this.maskAva.drawCircle(this.ava.x,this.ava.y,e),this.maskAva.endFill(),this.ava.mask=this.maskAva,this.addChild(this.maskAva)}},{key:"setValue",value:function(e){this.value=e}},{key:"setScale",value:function(e){this.ava.width=108,this.ava.height=108}},{key:"beginLoad",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.key)&&e&&(""!==e.key?(e.ava.loadTexture("".concat(e.key)),e.ava.width=108,e.ava.height=108):e.ava.loadTexture("songDetailSprites","ava-default"))}catch(e){}},150*this.index)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&Sa(n.prototype,i),o&&Sa(n,o),t}();function Pa(e){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ra(e,t){return!t||"object"!==Pa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xa(e){return(xa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ta(e,t){return(Ta=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ia=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ra(this,xa(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),e.event={challengeGame:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ta(e,t)}(t,Phaser.Group),n=t,(i=[{key:"addGroupSuggestionFriend",value:function(){null!=this.group&&null!=this.group||(this.group=new Phaser.Group(game),this.addChild(this.group))}},{key:"addSuggestionFriend",value:function(e,t){var n=this;this.addTabScreenSuggestionFriend(),e&&this.shuffleFriendList(e,function(e){for(var i=0;i<e.length;i++)n.createSuggestionFriend(i,e[i]);t()})}},{key:"addTabScreenSuggestionFriend",value:function(){this.tabHeaderSuggestFriend,this.addTabHeaderSuggestFriend()}},{key:"addTabHeaderSuggestFriend",value:function(){this.tabHeaderSuggestFriend=new Phaser.Sprite(game,this.findOpponentConfig.tab_header.x*window.GameConfig.RESIZE,this.findOpponentConfig.tab_header.y*window.GameConfig.RESIZE,this.findOpponentConfig.tab_header.nameAtlas,this.findOpponentConfig.tab_header.nameSprite),this.group.add(this.tabHeaderSuggestFriend),this.addTxtAndLineGradient(this.findOpponentConfig.txt_famous_user,this.findOpponentConfig.line_famous_user),this.addBgSuggestFriend()}},{key:"addTxtAndLineGradient",value:function(e,t){var n=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs);n.anchor.set(.5);var i=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);this.tabHeaderSuggestFriend.addChild(n),this.tabHeaderSuggestFriend.addChild(i)}},{key:"addBgSuggestFriend",value:function(){var e=new Phaser.Sprite(game,this.findOpponentConfig.bg_suggest_friend.x*window.GameConfig.RESIZE,this.findOpponentConfig.bg_suggest_friend.y*window.GameConfig.RESIZE,this.findOpponentConfig.bg_suggest_friend.nameAtlas,this.findOpponentConfig.bg_suggest_friend.nameSprite);this.tabHeaderSuggestFriend.addChild(e)}},{key:"createSuggestionFriend",value:function(e,t){var n=new ka(0,e);n.x=(140+181*e)*window.GameConfig.RESIZE,n.y=298*window.GameConfig.RESIZE,n.beginLoad(t.avatar),n.width=164*window.GameConfig.RESIZE,n.addMaskAva(108),n.setScale(window.GameConfig.SCALE_AVA_FAMOUS_USER*window.GameConfig.RESIZE),n.addNameAva(this.findOpponentConfig.txt_suggest_friend,t.user_name),n.setValue(t),n.addInput(this.onInputSuggestionFriend,this),this.addFrameAva(e),this.group.add(n),this.addDotOnline(t,e)}},{key:"addFrameAva",value:function(e){this.frameAva=new Phaser.Sprite(game,(140+181*e)*window.GameConfig.RESIZE,298*window.GameConfig.RESIZE,"playSprites","Khung_Ava_Thuong"),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.4),this.group.add(this.frameAva)}},{key:"addDotOnline",value:function(e,t){var n=170+181*t;1==e.isOnline?(this.dotOnline=new rt({x:n,y:325,nameAtlas:"findOpponentSprites",nameSprite:"Online"}),this.group.add(this.dotOnline)):(this.dotOnline=new rt({x:n,y:325,nameAtlas:"findOpponentSprites",nameSprite:"Offline"}),this.group.add(this.dotOnline))}},{key:"shuffleFriendList",value:function(e,t){t(e.sort(function(){return Math.random()-.5}))}},{key:"removeGroup",value:function(){this.group.destroy(),this.group=null}},{key:"onInputSuggestionFriend",value:function(e){Le.instance().logEvent(Le.Find_Game_Suggestion_Opponent_profile),Le.instance().logEvent(Le.Find_Game_Suggestion_Opponent_profile_button),iC.instance().addUserProfile(e.id)}}])&&Oa(n.prototype,i),o&&Oa(n,o),t}();function Aa(e){return(Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function La(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ga(e){return(Ga=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Da(e,t){return(Da=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ma(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Na=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=Ga(t).call(this,game,e.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.y)*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite))||"object"!==Aa(a)&&"function"!=typeof a?Ma(o):a).anchor.set(.5),i.configs=n,i.signalInput=new Phaser.Signal,i.inputEnabled=!0,i.events.onInputUp.add(i.onClickBtn,Ma(Ma(i))),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Da(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"update",value:function(){}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t),this.inputEnabled=!0,this.events.onInputUp.add(this.onClickBtn,this)}},{key:"onClickBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch(this.configs)}},{key:"addTextInCenter",value:function(e){var t=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs);t.anchor.set(.5),this.addChild(t)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}}])&&La(n.prototype,i),o&&La(n,o),t}();function Ba(e){return(Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ja(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ua(e,t){return!t||"object"!==Ba(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fa(e){return(Fa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Za(e,t){return(Za=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ha=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ua(this,Fa(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),e.event={challengeGame:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Za(e,t)}(t,Phaser.Group),n=t,(i=[{key:"initGroup",value:function(){null!=this.group&&null!=this.group||(this.group=game.add.group(),this.addChild(this.group))}},{key:"addButtonRandomUser",value:function(e){if(null==e.id||null==e.id);else{Le.instance().logEvent(Le.Find_Game_turbase_random_opponent);var t=new Na(this.findOpponentConfig.Button_Random,e);t.addTextInCenter(this.findOpponentConfig.txt_random_user),t.addInput(this.onClickBtn,this),this.group.addChild(t)}}},{key:"addBtnInviteFriendFB",value:function(){var e=new Phaser.Sprite(game,this.findOpponentConfig.Button_FB.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.findOpponentConfig.Button_FB.y)*window.GameConfig.RESIZE,this.findOpponentConfig.Button_FB.nameAtlas,this.findOpponentConfig.Button_FB.nameSprite);e.anchor.set(0,.5),e.inputEnabled=!0,e.events.onInputUp.add(this.inviteFriendFB,this);var t=new Phaser.Sprite(game,this.findOpponentConfig.Icon_Button_FB.x*window.GameConfig.RESIZE,this.findOpponentConfig.Icon_Button_FB.y*window.GameConfig.RESIZE,this.findOpponentConfig.Icon_Button_FB.nameAtlas,this.findOpponentConfig.Icon_Button_FB.nameSprite);t.anchor.set(0,.5),e.addChild(t);var n=new Phaser.Text(game,this.findOpponentConfig.txt_Button_FB.x*window.GameConfig.RESIZE,this.findOpponentConfig.txt_Button_FB.y*window.GameConfig.RESIZE,this.findOpponentConfig.txt_Button_FB.text,this.findOpponentConfig.txt_Button_FB.configs);n.anchor.set(0,.5),e.addChild(n),this.group.add(e)}},{key:"inviteFriendFB",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().inviteFriend()}},{key:"onClickBtn",value:function(e){Le.instance().logEvent(Le.Find_Game_turbase_random_opponent_button),LogConsole.log(e),this.event.challengeGame.dispatch(e)}},{key:"removeGroup",value:function(){this.group.destroy(),this.group=null}}])&&ja(n.prototype,i),o&&ja(n,o),t}();function Qa(e){return(Qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Va(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wa(e,t,n){return(Wa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qa(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function qa(e){return(qa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ka(e,t){return(Ka=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function za(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ya=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=qa(t).call(this,game,null))||"object"!==Qa(i)&&"function"!=typeof i?za(n):i).event={back:new Phaser.Signal},e.positionUserProfile=JSON.parse(game.cache.getText("positionUserProfile")),e.bg=new rt(e.positionUserProfile.header_bg),e.bg.visible=!1,e.addChild(e.bg),e.bgVip=new rt(e.positionUserProfile.header_bg_vip),e.bgVip.visible=!1,e.addChild(e.bgVip),e.txtHeader=new St(e.positionUserProfile.header_txt_content,""),e.txtHeader.setTextBounds(0,0,e.bg.width,e.bg.height),e.addChild(e.txtHeader),e.btnBack=new pt(e.positionUserProfile.header_button_back,e.chooseBack,za(za(e))),e.addChild(e.btnBack),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ka(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch(),1==z.instance().isGetUserProfileSearch&&(De.instance().event.searchFriendBackUserProfile.dispatch(),z.instance().isGetUserProfileSearch=!1)}},{key:"setBg",value:function(e){!0===e?(this.bgVip.visible=!0,this.bg.visible=!1):(this.bgVip.visible=!1,this.bg.visible=!0)}},{key:"setTitle",value:function(e){this.txtHeader.text=e}},{key:"destroy",value:function(){Wa(qa(t.prototype),"destroy",this).call(this)}}])&&Va(n.prototype,i),o&&Va(n,o),t}();function Ja(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Xa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"NO_GAME",get:function(){return"NO_GAME"}},{key:"THEIR_TURN",get:function(){return"THEIR_TURN"}},{key:"YOUR_TURN",get:function(){return"YOUR_TURN"}},{key:"ARCHIVED",get:function(){return"ARCHIVED"}},{key:"NO_FRIEND",get:function(){return"NO_FRIEND"}},{key:"PENDING_YOU",get:function(){return"PENDING_YOU"}},{key:"PENDING_THEM",get:function(){return"PENDING_THEM"}},{key:"FRIEND",get:function(){return"FRIEND"}}],(n=null)&&Ja(t.prototype,n),i&&Ja(t,i),e}();function $a(e){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function es(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ts(e,t){return!t||"object"!==$a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ns(e){return(ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function is(e,t){return(is=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var os=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ts(this,ns(t).call(this,game))).findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),i.index=n,i.afterCreate(e),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&is(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterCreate",value:function(e){this.signalInputAva=new Phaser.Signal,this._height=106*window.GameConfig.RESIZE,this.key="",this.ava=new Phaser.Sprite(game,40*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.clickAva,this),this.signalInput=new Phaser.Signal,this.addChild(this.ava),this.addFrameAva(),this.addLineUnder()}},{key:"clickAva",value:function(){this.signalInputAva.dispatch()}},{key:"addBtnPlay",value:function(e){if(this.value.status==Xa.NO_GAME){this.btnPlay=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnPlay.inputEnabled=!0,this.btnPlay.anchor.set(.5),this.btnPlay.events.onInputUp.add(this.onClickSprite,this);var t=new Phaser.Text(game,this.findOpponentConfig.txt_btn_play_findGame.x*window.GameConfig.RESIZE,this.findOpponentConfig.txt_btn_play_findGame.y*window.GameConfig.RESIZE,this.findOpponentConfig.txt_btn_play_findGame.text,this.findOpponentConfig.txt_btn_play_findGame.configs);t.anchor.set(.5),this.btnPlay.addChild(t),this.addChild(this.btnPlay)}else if(this.value.status==Xa.YOUR_TURN){var n=new Phaser.Text(game,570*window.GameConfig.RESIZE,58*window.GameConfig.RESIZE,"Lượt của bạn",{font:"Gilroy",fill:"#93909d",fontSize:21});n.anchor.set(1,.5),this.addChild(n)}else if(this.value.status==Xa.THEIR_TURN){var i=new Phaser.Text(game,570*window.GameConfig.RESIZE,58*window.GameConfig.RESIZE,"Lượt tiếp",{font:"Gilroy",fill:"#93909d",fontSize:21});i.anchor.set(1,.5),this.addChild(i)}}},{key:"addFrameAva",value:function(){this.frameAva=new Phaser.Sprite(game,40*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"playSprites","Khung_Ava_Thuong"),this.frameAva.anchor.set(.5),this.frameAva.scale.set(.9),this.addChild(this.frameAva)}},{key:"addLineUnder",value:function(){var e=new Phaser.Sprite(game,this.findOpponentConfig.line_friend_list.x*window.GameConfig.RESIZE,this.findOpponentConfig.line_friend_list.y*window.GameConfig.RESIZE,this.findOpponentConfig.line_friend_list.nameAtlas,this.findOpponentConfig.line_friend_list.nameSprite);this.addChild(e)}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch(this.value)}},{key:"addNameAva",value:function(e,t){this.txtName=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,t,e.configs),this.addChild(this.txtName)}},{key:"addMaskAva",value:function(e){this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(),this.maskAva.drawCircle(this.ava.x,this.ava.y,e),this.maskAva.endFill(),this.maskAva.anchor.set(.5),this.ava.mask=this.maskAva,this.addChild(this.maskAva)}},{key:"setStateFriend",value:function(){1==this.value.isOnline?this.setStateOnline():this.setStateOffline()}},{key:"setStateOnline",value:function(){var e=new Phaser.Sprite(game,50*window.GameConfig.RESIZE,71*window.GameConfig.RESIZE,"findOpponentSprites","Online");this.addChild(e)}},{key:"setStateOffline",value:function(){var e=new Phaser.Sprite(game,50*window.GameConfig.RESIZE,71*window.GameConfig.RESIZE,"findOpponentSprites","Offline");this.addChild(e)}},{key:"setValue",value:function(e){this.value=e,this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick)},this)}},{key:"setScale",value:function(e){this.ava.width=70,this.ava.height=70}},{key:"beginLoad",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.key)&&e&&(""!==e.key?e.ava.loadTexture("".concat(e.key)):e.ava.loadTexture("songDetailSprites","ava-default"),e.ava.width=70,e.ava.height=70)}catch(e){}},100*this.index)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&es(n.prototype,i),o&&es(n,o),t}();function as(e){return(as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ss(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rs(e){return(rs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ls(e,t){return(ls=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hs(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var cs=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=rs(t).call(this,game))||"object"!==as(i)&&"function"!=typeof i?hs(n):i).positionUserProfile=JSON.parse(game.cache.getText("positionUserProfile")),e.positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),e.event={back:new Phaser.Signal,challengeGame:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),e.header=new Ya,e.header.event.back.add(e.chooseBack,hs(hs(e))),e.header.setBg(!1),e.header.setTitle("Bạn bè"),e.addChild(e.header),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ls(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){if(De.instance().event.backButton.add(this.chooseBack,this),null==this.group||null==this.group){this.group=new Phaser.Group(game);var e=new Phaser.Rectangle(35*window.GameConfig.RESIZE,125*window.GameConfig.RESIZE,game.width-35,980*window.GameConfig.RESIZE);this.listView=new Jo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addChild(this.group)}this.addListFriend(this.friendsList)}},{key:"addListFriend",value:function(e){for(var t=0;t<e.length;t++)this.createTabFriennd(t,e[t])}},{key:"setData",value:function(e){this.friendsList=e,this.afterInit()}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"createTabFriennd",value:function(e,t){var n=new os(0);n.beginLoad(t.avatar),n.setValue(t),n.setScale(window.GameConfig.SCALE_AVA_FRIEND*window.GameConfig.RESIZE),n.addMaskAva(70),n.addNameAva(this.findOpponentConfig.txt_friend_list,t.userName),n.setStateFriend(),n.addInput(this.onInputFriend,this),n.addBtnPlay(this.findOpponentConfig.btn_play_findGame),this.listView.add(n)}},{key:"onInputFriend",value:function(e){this.event.challengeGame.dispatch(e)}},{key:"destroy",value:function(){for(De.instance().event.backButton.remove(this.chooseBack,this),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&ss(n.prototype,i),o&&ss(n,o),t}();function us(e){return(us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ds(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fs(e,t){return!t||"object"!==us(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ps(e){return(ps=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gs(e,t){return(gs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ys=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=fs(this,ps(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),e.event={onBack:new Phaser.Signal,challengeGame:new Phaser.Signal,onSearch:new Phaser.Signal},e.onClickShowAll=!1,e.showAllFriend=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gs(e,t)}(t,Phaser.Group),n=t,(i=[{key:"addHeader",value:function(e,t){this.friends=t,this.addTxtAndLineGradient(this.findOpponentConfig.txt_friend,this.findOpponentConfig.line_friend,e);var n=new Phaser.Sprite(game,this.positionMainConfig.tab_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.tab_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.tab_chonplaylist.nameAtlas,this.positionMainConfig.tab_chonplaylist.nameSprite);n.anchor.set(.5,0);var i=new Phaser.Text(game,this.findOpponentConfig.txt_findGame.x*window.GameConfig.RESIZE,this.findOpponentConfig.txt_findGame.y*window.GameConfig.RESIZE,this.findOpponentConfig.txt_findGame.text,this.findOpponentConfig.txt_findGame.configs);i.anchor.set(.5),n.addChild(i),this.addEventExtension(),this.addChild(n),this.addSearchButton(n),this.addArrowBackMenu(n)}},{key:"addSearchButton",value:function(e){var t=new Phaser.Button(game,this.findOpponentConfig.Search_Icon.x*window.GameConfig.RESIZE,this.findOpponentConfig.Search_Icon.y*window.GameConfig.RESIZE,this.findOpponentConfig.Search_Icon.nameAtlas,this.onClickSearchBtn,this,null,this.findOpponentConfig.Search_Icon.nameSprite);t.anchor.set(1,.5),e.addChild(t)}},{key:"onClickSearchBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.onSearch.dispatch()}},{key:"addArrowBackMenu",value:function(e){var t=new Phaser.Button(game,this.positionMainConfig.arrow_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.arrow_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.arrow_chonplaylist.nameAtlas,function(){},this,null,this.positionMainConfig.arrow_chonplaylist.nameSprite);t.anchor.set(.5),e.addChild(t),t.events.onInputUp.add(this.onBack,this)}},{key:"onBack",value:function(){0==this.onClickShowAll&&(ce.instance().playSound(ce.buttonclick),this.event.onBack.dispatch())}},{key:"addShowAllText",value:function(e,t){var n=this,i=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs);i.anchor.set(1,0),i.inputEnabled=!0,i.events.onInputUp.add(function(){n.onClickShowAll=!0,ce.instance().playSound(ce.buttonclick),n.addShowAllFriend()}),this.addChild(i);var o=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);this.addChild(o)}},{key:"addShowAllFriend",value:function(){var e=this;this.removeShowAllFriend(),this.showAllFriend=new cs,this.showAllFriend.setData(this.friends),this.showAllFriend.event.challengeGame.add(function(t){e.onClickShowAll=!1,e.event.challengeGame.dispatch(t),e.showAllFriend.destroy()},this),this.showAllFriend.event.back.add(function(){e.onClickShowAll=!1,e.showAllFriend.destroy()}),iC.instance().addChild(this.showAllFriend)}},{key:"removeShowAllFriend",value:function(){null!==this.showAllFriend&&(iC.instance().removeChild(this.showAllFriend),this.showAllFriend.destroy(),this.showAllFriend=null)}},{key:"addTxtAndLineGradient",value:function(e,t,n){var i=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,"".concat(e.text," ( ").concat(n," )"),e.configs),o=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);this.addChild(i),this.addChild(o),this.addShowAllText(this.findOpponentConfig.txt_show_all,this.findOpponentConfig.line_under_showall)}},{key:"addBtnInviteFriend",value:function(){this.btn_invite=new Phaser.Button(game,this.positionMainConfig.btn_invite.x*window.GameConfig.RESIZE,this.positionMainConfig.btn_invite.y*window.GameConfig.RESIZE,this.positionMainConfig.btn_invite.nameAtlas,this.onClickBtnInvite,this,null,this.positionMainConfig.btn_invite.nameSprite),this.btn_invite.anchor.set(1,.5),this.addChild(this.btn_invite)}},{key:"onClickBtnInvite",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().inviteFriend()}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&ds(n.prototype,i),o&&ds(n,o),t}();function ms(e){return(ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ws(e,t){return!t||"object"!==ms(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bs(e){return(bs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ss(e,t){return(Ss=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _s=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ws(this,bs(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),i.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),i.event={challengeGame:new Phaser.Signal},i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ss(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){if(null==this.group||null==this.group){this.group=game.add.group();var e=new Phaser.Rectangle(35*window.GameConfig.RESIZE,534*window.GameConfig.RESIZE,game.width-35*window.GameConfig.RESIZE,(game.height-646)*window.GameConfig.RESIZE);this.listView=new Jo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addChild(this.group)}}},{key:"addListFriend",value:function(e){for(var t=0;t<e.length;t++)this.createTabFriennd(t,e[t])}},{key:"removeGroup",value:function(){this.group.destroy(),this.group=null}},{key:"createTabFriennd",value:function(e,t){var n=new os(0,e);n.beginLoad(t.avatar),n.setValue(t),n.setScale(window.GameConfig.SCALE_AVA_FRIEND*window.GameConfig.RESIZE),n.addMaskAva(70),n.addNameAva(this.findOpponentConfig.txt_friend_list,t.userName),n.setStateFriend(),n.addInput(this.onInputFriend,this),n.addBtnPlay(this.findOpponentConfig.btn_play_findGame),n.signalInputAva.add(function(){iC.instance().addUserProfile(t.id)},this),this.listView.add(n)}},{key:"onInputFriend",value:function(e){this.event.challengeGame.dispatch(e)}}])&&vs(n.prototype,i),o&&vs(n,o),t}();function Es(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Cs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"user_founds",get:function(){return"user_founds"}},{key:"friend_status",get:function(){return"friend_status"}},{key:"user_name",get:function(){return"user_name"}},{key:"is_online",get:function(){return"is_online"}},{key:"id",get:function(){return"id"}},{key:"avatar",get:function(){return"avatar"}}],(n=null)&&Es(t.prototype,n),i&&Es(t,i),e}();function ks(e){return(ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ps(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Os(e,t){return!t||"object"!==ks(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rs(e){return(Rs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xs(e,t){return(xs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ts=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Os(this,Rs(t).call(this,game))).findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),i.index=n,i.configsValue=e,i.signalInputAva=new Phaser.Signal,i.signalInput=new Phaser.Signal,i.afterCreate(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xs(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterCreate",value:function(){this.key="",this.ava=new Phaser.Sprite(game,75*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.clickAva,this),this.setScale(window.GameConfig.SCALE_AVA_FRIEND*window.GameConfig.RESIZE),this.addMaskAva(200),this.addChild(this.ava),this.addFrameAva(),this.addNameAva(this.findOpponentConfig.txt_friend_list,this.configsValue.user_name),this.setStateFriend(),this.addBtnPlay(this.findOpponentConfig.btn_play_findGame),this.addLineUnder(),this.beginLoad(this.configsValue.avatar)}},{key:"clickAva",value:function(){this.signalInputAva.dispatch(this.configsValue.id)}},{key:"addBtnPlay",value:function(e){if(this.configsValue.friend_status==Xa.PENDING_YOU){this.btnInput=new Phaser.Sprite(game,(e.x+45)*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnInput.inputEnabled=!0,this.btnInput.anchor.set(.5),this.btnInput.events.onInputUp.add(this.onClickSprite,this);var t=new Phaser.Text(game,this.findOpponentConfig.txt_btn_play_findGame.x*window.GameConfig.RESIZE,(this.findOpponentConfig.txt_btn_play_findGame.y+2)*window.GameConfig.RESIZE,"ĐỒNG Ý",{font:"GilroyBold",fill:"#ffffff",fontSize:18});t.anchor.set(.5),this.btnInput.addChild(t),this.addChild(this.btnInput)}else if(this.configsValue.friend_status==Xa.FRIEND){var n=new Phaser.Text(game,605*window.GameConfig.RESIZE,58*window.GameConfig.RESIZE,"Đã kết bạn",{font:"Gilroy",fill:"#93909d",fontSize:21});n.anchor.set(1,.5),this.addChild(n)}else if(this.configsValue.friend_status==Xa.PENDING_THEM){var i=new Phaser.Text(game,605*window.GameConfig.RESIZE,58*window.GameConfig.RESIZE,"Đã gửi lời mời kết bạn",{font:"Gilroy",fill:"#93909d",fontSize:21});i.anchor.set(1,.5),this.addChild(i)}else if(this.configsValue.friend_status==Xa.NO_FRIEND){this.btnInput=new Phaser.Sprite(game,(e.x+45)*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnInput.inputEnabled=!0,this.btnInput.anchor.set(.5),this.btnInput.events.onInputUp.add(this.onClickSprite,this);var o=new Phaser.Text(game,this.findOpponentConfig.txt_btn_play_findGame.x*window.GameConfig.RESIZE,(this.findOpponentConfig.txt_btn_play_findGame.y+2)*window.GameConfig.RESIZE,"KẾT BẠN",{font:"GilroyBold",fill:"#ffffff",fontSize:18});o.anchor.set(.5),this.btnInput.addChild(o),this.addChild(this.btnInput)}}},{key:"addFrameAva",value:function(){this.frameAva=new Phaser.Sprite(game,75*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"playSprites","Khung_Ava_Thuong"),this.frameAva.anchor.set(.5),this.frameAva.scale.set(.9),this.addChild(this.frameAva)}},{key:"addLineUnder",value:function(){var e=new Phaser.Sprite(game,(this.findOpponentConfig.line_friend_list.x+35)*window.GameConfig.RESIZE,this.findOpponentConfig.line_friend_list.y*window.GameConfig.RESIZE,this.findOpponentConfig.line_friend_list.nameAtlas,this.findOpponentConfig.line_friend_list.nameSprite);this.addChild(e)}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch(this.configsValue.friend_status,this.configsValue.id)}},{key:"addNameAva",value:function(e,t){this.txtName=new Phaser.Text(game,(e.x+35)*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,t,e.configs),this.addChild(this.txtName)}},{key:"addMaskAva",value:function(e){this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(),this.maskAva.drawCircle(0,0,e),this.maskAva.endFill(),this.maskAva.anchor.set(.5),this.ava.mask=this.maskAva,this.ava.addChild(this.maskAva)}},{key:"setStateFriend",value:function(){1==this.configsValue.is_online?this.setStateOnline():this.setStateOffline()}},{key:"setStateOnline",value:function(){var e=new Phaser.Sprite(game,85*window.GameConfig.RESIZE,71*window.GameConfig.RESIZE,"findOpponentSprites","Online");this.addChild(e)}},{key:"setStateOffline",value:function(){var e=new Phaser.Sprite(game,85*window.GameConfig.RESIZE,71*window.GameConfig.RESIZE,"findOpponentSprites","Offline");this.addChild(e)}},{key:"setValue",value:function(e){this.value=e,this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick)},this)}},{key:"setScale",value:function(e){this.ava.scale.set(e)}},{key:"beginLoad",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.key)&&e&&(""!==e.key?e.ava.loadTexture("".concat(e.key)):e.ava.loadTexture("songDetailSprites","ava-default"))}catch(e){}},100*this.index)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return 106}}])&&Ps(n.prototype,i),o&&Ps(n,o),t}();function Is(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var As=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"USER_PROFILE_LOAD_REQUEST",get:function(){return"USER_PROFILE_LOAD_REQUEST"}},{key:"USER_PROFILE_LOAD_RESPONSE",get:function(){return"USER_PROFILE_LOAD_RESPONSE"}},{key:"USER_FRIEND_REQUEST",get:function(){return"USER_FRIEND_REQUEST"}},{key:"USER_FRIEND_RESPONSE",get:function(){return"USER_FRIEND_RESPONSE"}},{key:"USER_DETAIL_LOAD_REQUEST",get:function(){return"USER_DETAIL_LOAD_REQUEST"}},{key:"USER_DETAIL_LOAD_RESPONSE",get:function(){return"USER_DETAIL_LOAD_RESPONSE"}},{key:"USER_DETAIL_PLAYLIST_LOAD_REQUEST",get:function(){return"USER_DETAIL_PLAYLIST_LOAD_REQUEST"}},{key:"USER_DETAIL_PLAYLIST_LOAD_RESPONSE",get:function(){return"USER_DETAIL_PLAYLIST_LOAD_RESPONSE"}},{key:"USER_DETAIL_ACHIEVEMENT_LOAD_REQUEST",get:function(){return"USER_DETAIL_ACHIEVEMENT_LOAD_REQUEST"}},{key:"USER_DETAIL_ACHIEVEMENT_LOAD_RESPONSE",get:function(){return"USER_DETAIL_ACHIEVEMENT_LOAD_RESPONSE"}},{key:"USER_DETAIL_FRIEND_LOAD_REQUEST",get:function(){return"USER_DETAIL_FRIEND_LOAD_REQUEST"}},{key:"USER_DETAIL_FRIEND_LOAD_RESPONSE",get:function(){return"USER_DETAIL_FRIEND_LOAD_RESPONSE"}},{key:"USER_FRIEND_LIST_LOAD_REQUEST",get:function(){return"USER_FRIEND_LIST_LOAD_REQUEST"}},{key:"USER_FRIEND_LIST_LOAD_RESPONSE",get:function(){return"USER_FRIEND_LIST_LOAD_RESPONSE"}}],(n=null)&&Is(t.prototype,n),i&&Is(t,i),e}();function Ls(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Gs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){LogConsole.log("action "+e),LogConsole.log("friend_id "+t);var n=new SFS2X.SFSObject;return n.putUtfString("action",e),n.putInt("friend_id",t),n}},{key:"ACTION_ADD_FRIEND",get:function(){return"ADD_FRIEND"}},{key:"ACTION_ACCEPT_ADD_REQUEST",get:function(){return"ACCEPT_ADD_REQUEST"}},{key:"ACTION_REFUSE_ADD_REQUEST",get:function(){return"REFUSE_ADD_REQUEST"}},{key:"ACTION_REMOVE_FRIEND",get:function(){return"REMOVE_FRIEND"}}],(n=null)&&Ls(t.prototype,n),i&&Ls(t,i),e}();function Ds(e){return(Ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ms(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ns(e,t){return!t||"object"!==Ds(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bs(e){return(Bs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function js(e,t){return(js=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Us=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ns(this,Bs(t).call(this,game,0,0,"bg_create_room"))).users=e,n.event={refreshSearch:new Phaser.Signal,getUserProfile:new Phaser.Signal},n.afterInit(),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&js(e,t)}(t,Phaser.Button),n=t,(o=[{key:"afterInit",value:function(){this.addEventExtension();var e=new Phaser.Group(game);e.x=0,e.y=220*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-239)*window.GameConfig.RESIZE);for(this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),i=0;i<this.users.length;i++){var n=new Ts(this.users[i],i);n.addInput(this.onInputFriend,this),n.signalInputAva.add(this.inputAva,this),this.listView.add(n)}if(0==this.users.length){var o=new Phaser.Text(game,320,270,"Không có kết quả phù hợp.",{font:"GilroyMedium",fill:"#eeeeee",fontSize:30});o.anchor.set(.5),this.addChild(o)}}},{key:"inputAva",value:function(e){this.event.getUserProfile.dispatch(e)}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.USER_FRIEND_RESPONSE&&(console.log(e.params.getDump()),"OK"==e.params.getUtfString("status")&&this.event.refreshSearch.dispatch())}},{key:"onInputFriend",value:function(e,t){e==Xa.NO_FRIEND&&this.sendUserFriendRequest(t),e==Xa.PENDING_YOU&&this.sendAcceptFriend(t)}},{key:"sendUserFriendRequest",value:function(e){mZ.instance().sendData(As.USER_FRIEND_REQUEST,Gs.begin(Gs.ACTION_ADD_FRIEND,e))}},{key:"sendAcceptFriend",value:function(e){mZ.instance().sendData(As.USER_FRIEND_REQUEST,Gs.begin(Gs.ACTION_ACCEPT_ADD_REQUEST,e))}},{key:"destroy",value:function(){for(this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Ms(n.prototype,o),a&&Ms(n,a),t}();var Fs=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=0,this.code="",this.genre="",this.active=0,this.id=1,this.priority=1,this.region="",this.choosed=!1};function Zs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Hs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.objData={},this.arrLocal=[],this.arrInternational=[],this.arrAll=[]}var t,n,i;return t=e,(n=[{key:"resetData",value:function(){this.objData={},this.arrLocal=[],this.arrInternational=[],this.arrAll=[]}},{key:"setDataGenres",value:function(e){var t=new Fs;t=Object.assign({},t,e),this.objData[t.id]=t,"Local"===t.region?this.arrLocal.push(t.id):this.arrInternational.push(t.id),this.arrAll.push(t.id)}},{key:"getDataGenresByLocal",value:function(e){var t=[];if("Local"===e)for(var n=0;n<this.arrLocal.length;n++)t.push(this.objData[this.arrLocal[n]]);else for(var i=0;i<this.arrInternational.length;i++)"au_my"===this.objData[this.arrInternational[i]].code||t.push(this.objData[this.arrInternational[i]]);return t}},{key:"getAll",value:function(){for(var e=[],t=0;t<this.arrAll.length;t++)e.push(this.objData[this.arrAll[t]]);return e}}])&&Zs(t.prototype,n),i&&Zs(t,i),e}();var Qs=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.level=0,this.playlist_id=0,this.exp_score=0,this.created=0,this.active=0,this.id=0,this.current_level_score=0,this.next_level_score=0,this.updated=0,this.master=0};var Vs=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.is_highlight=0,this.used_times=0,this.thumb="",this.created=0,this.is_owner=0,this.description="",this.active=0,this.is_default=0,this.genre_id=0,this.price=0,this.is_general=0,this.name="",this.purchased_count=0,this.id=0,this.vip=0,this.is_solo_mode=0,this.updated=0,this.country_id=0,this.region="",this.user=new Qs};function Ws(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){qs(e,t,n[t])})}return e}function qs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ks(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var zs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.objData={},this.objGenres={},this.arrShop=[],this.arrMe=[]}var t,n,i;return t=e,(n=[{key:"resetData",value:function(){this.objData={},this.objGenres={},this.arrShop=[],this.arrMe=[]}},{key:"changeBuyItemById",value:function(e){this.objData[e]&&(this.objData[e].is_owner=1,this.setUpdateTimePlaylistById(e),this.objData[e].user.next_level_score=Kr.instance().playlist_level_setting[this.objData[e].user.level].exp_score)}},{key:"setDataMePlaylist",value:function(e,t){console.log("setDataMePlaylist : -----------------"+e),this.objData.hasOwnProperty(e)&&(this.objData[e].user=t,this.removePlaylistInArrShop(e))}},{key:"setDataPlayList",value:function(e){var t=new Vs;t=Object.assign({},t,e),this.objData[t.id]=t,this.objGenres.hasOwnProperty(t.genre_id)||(this.objGenres[t.genre_id]=[]),this.objGenres[t.genre_id].push(t.id),1==t.is_owner?1===t.active&&this.arrMe.push(t.id):this.arrShop.push(t.id)}},{key:"getArrByGenresId",value:function(e){var t=[];this.objGenres.hasOwnProperty(e)||(this.objGenres[e]=[]);for(var n=0;n<this.objGenres[e].length;n++)t.push(this.objData[this.objGenres[e][n]]);return t}},{key:"removePlaylistInArrShop",value:function(e){var t=this.arrShop.indexOf(e);t>-1&&(this.objData[e].is_owner=1,this.arrShop.splice(t,1),this.arrMe.push(e))}},{key:"getArrShop",value:function(){for(var e=[],t=0;t<this.arrShop.length;t++)e.push(this.objData[this.arrShop[t]]);return e}},{key:"getArrMe",value:function(){for(var e=[],t=0;t<this.arrMe.length;t++){var n=this.getPlayListById(this.arrMe[t]);console.log("PLAYLIST"),console.log(n.user),n.user_playlist_mapping=n.user,e.push(Ws({},n))}return e}},{key:"getSuggestPlaylist",value:function(){var e=Un.instance().randomNumber(0,this.arrShop.length-1);return this.objData[this.arrShop[e]]}},{key:"getPlayListById",value:function(e){return this.objData.hasOwnProperty(e)?(this.objData[e].user_playlist_mapping=this.objData[e].user,Ws({},this.objData[e])):null}},{key:"setUpdateTimePlaylistById",value:function(e){if(this.objData.hasOwnProperty(e)){var t=new Vs;1===(t=Object.assign({},t,this.objData[e])).is_owner&&(t.user.updated=(new Date).getTime())}}},{key:"setExpPlaylistById",value:function(e){if(this.objData.hasOwnProperty(e)){var t=new Vs;if(1===(t=Object.assign({},t,this.objData[e])).is_owner)t.user.exp_score+=2,t.user.exp_score-t.user.current_level_score>t.user.next_level_score-t.user.current_level_score&&(t.user.level+=1,t.user.current_level_score=t.user.next_level_score,Kr.instance().playlist_level_setting[t.user.level]&&(t.user.next_level_score=Kr.instance().playlist_level_setting[t.user.level].exp_score)),this.setUpdateTimePlaylistById(e)}}}])&&Ks(t.prototype,n),i&&Ks(t,i),e}();function Ys(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Js=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"SHOP_PLAYLIST_LOAD_REQUEST",get:function(){return"SHOP_PLAYLIST_LOAD_REQUEST"}},{key:"SHOP_PLAYLIST_LOAD_RESPONSE",get:function(){return"SHOP_PLAYLIST_LOAD_RESPONSE"}},{key:"SHOP_BUY_PLAYLIST_REQUEST",get:function(){return"SHOP_BUY_PLAYLIST_REQUEST"}},{key:"SHOP_BUY_PLAYLIST_RESPONSE",get:function(){return"SHOP_BUY_PLAYLIST_RESPONSE"}},{key:"PLAYLIST_DETAIL_REQUEST",get:function(){return"PLAYLIST_DETAIL_REQUEST"}},{key:"PLAYLIST_DETAIL_RESPONSE",get:function(){return"PLAYLIST_DETAIL_RESPONSE"}},{key:"PLAYLIST_CHANGE_ACTIVE_REQUEST",get:function(){return"PLAYLIST_CHANGE_ACTIVE_REQUEST"}},{key:"PLAYLIST_CHANGE_ACTIVE_RESPONSE",get:function(){return"PLAYLIST_CHANGE_ACTIVE_RESPONSE"}},{key:"RESOURCE_PACKAGE_LOAD_REQUEST",get:function(){return"RESOURCE_PACKAGE_LOAD_REQUEST"}},{key:"RESOURCE_PACKAGE_LOAD_RESPONSE",get:function(){return"RESOURCE_PACKAGE_LOAD_RESPONSE"}},{key:"RESOURCE_BUY_SUPPORT_ITEM_REQUEST",get:function(){return"RESOURCE_BUY_SUPPORT_ITEM_REQUEST"}},{key:"RESOURCE_BUY_SUPPORT_ITEM_RESPONSE",get:function(){return"RESOURCE_BUY_SUPPORT_ITEM_RESPONSE"}},{key:"RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_REQUEST",get:function(){return"RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_REQUEST"}},{key:"RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE",get:function(){return"RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE"}}],(n=null)&&Ys(t.prototype,n),i&&Ys(t,i),e}();function Xs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(){return new SFS2X.SFSObject}}],(n=null)&&Xs(t.prototype,n),i&&Xs(t,i),e}();function er(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var tr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"genres",get:function(){return"genres"}},{key:"parent",get:function(){return"parent"}},{key:"code",get:function(){return"code"}},{key:"genre",get:function(){return"genre"}},{key:"id",get:function(){return"id"}},{key:"priority",get:function(){return"priority"}},{key:"region",get:function(){return"region"}},{key:"playlists",get:function(){return"playlists"}},{key:"is_highlight",get:function(){return"is_highlight"}},{key:"thumb",get:function(){return"thumb"}},{key:"created",get:function(){return"created"}},{key:"is_owner",get:function(){return"is_owner"}},{key:"is_default",get:function(){return"is_default"}},{key:"genre_id",get:function(){return"genre_id"}},{key:"purchased",get:function(){return"purchased"}},{key:"songs",get:function(){return"songs"}},{key:"price",get:function(){return"price"}},{key:"is_general",get:function(){return"is_general"}},{key:"name",get:function(){return"name"}},{key:"vip",get:function(){return"vip"}},{key:"is_solo_mode",get:function(){return"is_solo_mode"}},{key:"updated",get:function(){return"updated"}},{key:"country_id",get:function(){return"country_id"}},{key:"status",get:function(){return"status"}},{key:"user_playlist_mapping",get:function(){return"user_playlist_mapping"}},{key:"user_id",get:function(){return"user_id"}},{key:"level",get:function(){return"level"}},{key:"playlist_id",get:function(){return"playlist_id"}},{key:"exp_score",get:function(){return"exp_score"}},{key:"active",get:function(){return"active"}},{key:"current_level_score",get:function(){return"current_level_score"}},{key:"next_level_score",get:function(){return"next_level_score"}},{key:"playlist",get:function(){return"playlist"}},{key:"author",get:function(){return"author"}},{key:"title",get:function(){return"title"}},{key:"singer",get:function(){return"singer"}},{key:"avatar",get:function(){return"avatar"}},{key:"file_path",get:function(){return"file_path"}},{key:"used_times",get:function(){return"used_times"}},{key:"song_links",get:function(){return"song_links"}},{key:"link_type",get:function(){return"link_type"}},{key:"song_id",get:function(){return"song_id"}},{key:"is_movie",get:function(){return"is_movie"}},{key:"link",get:function(){return"link"}},{key:"purchased_count",get:function(){return"purchased_count"}},{key:"description",get:function(){return"description"}}],(n=null)&&er(t.prototype,n),i&&er(t,i),e}();function nr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ir=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event={call_load:new Phaser.Signal},this.arrUser=[]}var t,n,i;return t=e,(n=[{key:"resetData",value:function(){this.arrUser=[]}},{key:"setUser",value:function(e){this.arrUser.push(e)}},{key:"getUser",value:function(){if(this.arrUser.length>0){var e=this.arrUser[0];return this.arrUser.splice(0,1),1===this.arrUser.length&&this.event.call_load.dispatch(),e}return null}},{key:"getArrLenght",value:function(){return this.arrUser.length}}])&&nr(t.prototype,n),i&&nr(t,i),e}();var or=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.finish_at=0,this.created=0,this.description=0,this.banner=0,this.active=0,this.start_at=0,this.event_type="",this.name="",this.medal="",this.id=0,this.state="",this.updated=0,this.number_user=0,this.reward_1st={}};function ar(e){return(ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rr(e,t){return!t||"object"!==ar(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lr(e){return(lr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hr(e,t){return(hr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cr=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=rr(this,lr(t).call(this,game,null))).countNumber=0,e.timerToCountTime=null,e.event={complete:new Phaser.Signal},e.ktRed=!1,e.ktPlayTween=!1,e.positionEventMode=e.mainData.positionEventMode,e.clock=new rt(e.positionEventMode.selectroom_icon_clock),e.addChild(e.clock),e.txtCount=new St(e.positionEventMode.selectroom_text_time_clock,""),e.txtCount.setTextBounds(0,0,77*z.instance().scale,24*z.instance().scale),e.addChild(e.txtCount),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hr(e,t)}(t,Mt),n=t,(i=[{key:"setTimer",value:function(e){var t=e-(new Date).getTime();this.countNumber=parseInt(t/1e3),this.setTextTimer(),this.stopCountTime(),this.timerToCountTime=this.game.time.create(!0),this.timerToCountTime.loop(1e3,this.onTimerToCountTime,this),this.timerToCountTime.start()}},{key:"setTextTimer",value:function(){var e,t="",n=parseInt(this.countNumber/3600),i=0,o=0;n>0?(t=n>9?n+":":"0"+n+":",i=parseInt(this.countNumber%3600/60),o=this.countNumber-(3600*n+60*i)):(i=parseInt(this.countNumber/60),o=this.countNumber%60),e=t+(i>9?i+":":"0"+i+":")+(o>9?o+"":"0"+o),0===n&&i<5?!1===this.ktPlayTween&&(this.ktPlayTween=!0):!0===this.ktPlayTween&&(this.ktPlayTween=!1),this.txtCount.text=e}},{key:"onTimerToCountTime",value:function(){this.countNumber--,this.countNumber<0&&(this.countNumber=0),0===this.countNumber&&(this.stopCountTime(),this.event.complete.dispatch()),LogConsole.log("this.ktPlayTween : "+this.ktPlayTween+" this.ktRed : "+this.ktRed),!0===this.ktPlayTween&&(!1===this.ktRed?(this.ktRed=!0,this.clock.tint=16711680):(this.ktRed=!1,this.clock.tint=16777215)),this.setTextTimer()}},{key:"getTime",value:function(){return this.countNumber}},{key:"stopCountTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy(),this.timerToCountTime=null)}},{key:"destroy",value:function(){this.stopCountTime(),this.removeAllItem()}}])&&sr(n.prototype,i),o&&sr(n,o),t}();function ur(e){return(ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fr(e,t){return!t||"object"!==ur(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pr(e){return(pr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gr(e,t){return(gr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yr=function(e){function t(e,n){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=fr(this,pr(t).call(this,game,null));var o="",a=new Date(e),s=new Date(n),r=a.getDate(),l=a.getMonth()+1,h=(a.getFullYear(),a.getHours()),c=a.getMinutes(),u=s.getDate(),d=s.getMonth()+1,f=s.getFullYear(),p=s.getHours(),g=s.getMinutes();return o=u===r?h+"h"+c+" - "+p+"h"+g+" "+u+"/"+d+"/"+f:h+"h"+c+" "+r+"/"+l+" - "+p+"h"+g+" "+u+"/"+d+"/"+f,LogConsole.log(r),LogConsole.log(l),i.positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),i.clock=new rt(i.positionEventMode.selectroom_icon_clock),i.clock.x=0,i.clock.y=2*z.instance().scale,i.addChild(i.clock),i.txtTime=new St(i.positionEventMode.selectroom_text_time,o),i.addChild(i.txtTime),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gr(e,t)}(t,Mt),n=t,(i=[{key:"width",get:function(){return this.clock.width+this.txtTime.width+6*z.instance().scale}}])&&dr(n.prototype,i),o&&dr(n,o),t}();function mr(e){return(mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wr(e,t){return!t||"object"!==mr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function br(e){return(br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sr(e,t){return(Sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _r=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"otherSprites",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Nhactre";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=wr(this,br(t).call(this,game,0,0,n,i))).defaultImage=i,e.defaultAtlas=n,e._width=0,e._height=0,e.countLoad=0,e.isDefault=!0,e.afterCreate(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sr(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterCreate",value:function(){this.url="",this.loader=null,this.idTimeOut=null}},{key:"setSize",value:function(e,t){this._width=e,this._height=t,this.width=e,this.height=t}},{key:"beginLoad",value:function(e,t){this.url=e,this.idx=t,null!==this.idTimeOut&&clearTimeout(this.idTimeOut),""===this.url?this.default():game.cache.checkImageKey(this.url)?this.loadComplete():(this.removeLoader(),this.loader=new Phaser.Loader(game),this.loader.crossOrigin="anonymous",this.loader.onLoadStart.add(this.loadStart,this),this.loader.onLoadComplete.add(this.loadComplete,this),this.loader.image(e,e),this.loader.start())}},{key:"removeLoader",value:function(){null!=this.loader&&(this.loader.onLoadStart.remove(this.loadStart,this),this.loader.onLoadComplete.remove(this.loadComplete,this),this.loader.reset(),this.loader.removeAll(),this.loader=null)}},{key:"default",value:function(){!0===this.isDefault||(this.isDefault=!0,this.loadTexture(this.defaultAtlas,this.defaultImage),this.width=this._width,this.height=this._height)}},{key:"loadStart",value:function(){}},{key:"loadComplete",value:function(){var e=this;this.removeLoader(),this.idTimeOut=setTimeout(function(){e.onTimerToCountTime()},50*(this.idx+1))}},{key:"onTimerToCountTime",value:function(){this.showImage(this.url)}},{key:"showImage",value:function(e){game.cache.checkImageKey(e)&&(this.isDefault=!1,this.loadTexture(e),this.width=this._width,this.height=this._height)}},{key:"destroy",value:function(){this.timerToCountTime&&this.timerToCountTime.destroy(),null!==this.idTimeOut&&clearTimeout(this.idTimeOut),this.removeLoader()}}])&&vr(n.prototype,i),o&&vr(n,o),t}();function Er(e){return(Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kr(e,t){return!t||"object"!==Er(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pr(e){return(Pr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Or(e,t){return(Or=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rr=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=kr(this,Pr(t).call(this,game,null))).positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),n.bg=new Zt(n.positionEventMode.queueroom_bg_win_item),n.addChild(n.bg),i&&(n.bg.height=50);var o=12*z.instance().scale;return LogConsole.log("---------------------------------"),e.diamond>0&&(n.txtDiamond=new St(n.positionEventMode.queueroom_txt_win,e.diamond),i&&n.txtDiamond.changeStyle({fontSize:24}),n.txtDiamond.x=o,n.txtDiamond.y=(n.bg.height-n.txtDiamond.height)/2+3*z.instance().scale,n.addChild(n.txtDiamond),n.iconDiamon=new rt(n.positionEventMode.queueroom_icon_win_diamond),n.iconDiamon.x=n.txtDiamond.x+n.txtDiamond.width+3*z.instance().scale,n.iconDiamon.y=(n.bg.height-n.iconDiamon.height)/2,n.addChild(n.iconDiamon),o=n.iconDiamon.x+n.iconDiamon.width+12*z.instance().scale),e.ticket>0&&(n.txtTicket=new St(n.positionEventMode.queueroom_txt_win,e.ticket),i&&n.txtTicket.changeStyle({fontSize:24}),n.txtTicket.x=o,n.txtTicket.y=(n.bg.height-n.txtTicket.height)/2+3*z.instance().scale,n.addChild(n.txtTicket),n.iconTicket=new rt(n.positionEventMode.queueroom_icon_win_ticket),n.iconTicket.x=n.txtTicket.x+n.txtTicket.width+3*z.instance().scale,n.iconTicket.y=(n.bg.height-n.iconTicket.height)/2,o=n.iconTicket.x+n.iconTicket.width+12*z.instance().scale,n.addChild(n.iconTicket)),e.support_item>0&&(n.txtSup=new St(n.positionEventMode.queueroom_txt_win,e.support_item),i&&n.txtSup.changeStyle({fontSize:24}),n.txtSup.x=o,n.txtSup.y=(n.bg.height-n.txtSup.height)/2+3*z.instance().scale,n.addChild(n.txtSup),n.iconSup=new rt(n.positionEventMode.queueroom_icon_win_mic),n.iconSup.x=n.txtSup.x+n.txtSup.width+3*z.instance().scale,n.iconSup.y=(n.bg.height-n.iconSup.height)/2,n.addChild(n.iconSup),o=n.iconSup.x+n.iconSup.width+12*z.instance().scale),LogConsole.log("end ---------------------------------"),n.bg.width=o,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Or(e,t)}(t,Mt),n=t,(i=[{key:"hideBg",value:function(){this.bg.visible=!1}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&Cr(n.prototype,i),o&&Cr(n,o),t}();function xr(e){return(xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tr(e){return(Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ir(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ar(e,t,n){return t&&Ir(e.prototype,t),n&&Ir(e,n),e}function Lr(e,t){return(Lr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Dr=function(e){function t(e){var n,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=Tr(t).call(this,game,null))||"object"!==xr(o)&&"function"!=typeof o?Gr(i):o).event={choose_item:new Phaser.Signal,view_history:new Phaser.Signal},n.data=e,n.positionEventMode=n.mainData.positionEventMode,n.btnChoose=new pt(n.positionEventMode.selectroom_bg_default,n.chooseEvent,Gr(Gr(n))),n.btnChoose.alpha=0,n.addChild(n.btnChoose),n.bg=new _r(n.positionEventMode.selectroom_bg_default.nameAtlas,n.positionEventMode.selectroom_bg_default.nameSprite),n.bg.setSize(569*z.instance().scale,160*z.instance().scale),n.bg.beginLoad(n.data.banner,a),n.addChild(n.bg),n.bgWin=new Rr(n.data.reward_1st),n.bgWin.x=18*z.instance().scale,n.bgWin.y=19*z.instance().scale,n.addChild(n.bgWin),n.txtNameEvent=new St(n.positionEventMode.selectroom_text_event_name,n.data.name),n.addChild(n.txtNameEvent),n.data.state===t.STATE_COMING?(n.timeEvent=new yr(n.data.start_at,n.data.finish_at),n.timeEvent.x=18*z.instance().scale,n.timeEvent.y=n.txtNameEvent.y+n.txtNameEvent.height,n.addChild(n.timeEvent)):n.data.state===t.STATE_STARTED?(n.countUser=new ya(n.positionEventMode.queueroom_button_count_user,n.data.number_user),n.addChild(n.countUser),n.bgWin.x=106*z.instance().scale,n.clock=new cr,n.clock.x=18*z.instance().scale,n.clock.y=n.txtNameEvent.y+n.txtNameEvent.height+3*z.instance().scale,n.clock.setTimer(n.data.finish_at),n.addChild(n.clock)):(n.txtXemKetqua=new St(n.positionEventMode.selectroom_text_xemketqua,"XEM KẾT QUẢ"),n.txtXemKetqua.y=n.txtNameEvent.y+n.txtNameEvent.height+3*z.instance().scale,n.addChild(n.txtXemKetqua)),!0===n.data.vip&&(n.iconVip=new rt(n.positionEventMode.selectroom_icon_vip),n.addChild(n.iconVip)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lr(e,t)}(t,Mt),Ar(t,null,[{key:"STATE_FINISHED",get:function(){return"FINISHED"}},{key:"STATE_STARTED",get:function(){return"STARTED"}},{key:"STATE_COMING",get:function(){return"COMING"}}]),Ar(t,[{key:"setCuu",value:function(e){this.countUser&&(this.countUser.text=e)}},{key:"chooseEvent",value:function(){this.data.state===t.STATE_STARTED?this.clock.getTime()>5?this.event.choose_item.dispatch(this.data):iC.instance().addDialog("Sự kiện đã kết thúc."):this.data.state===t.STATE_COMING||this.event.view_history.dispatch(this.data.id)}},{key:"width",get:function(){return 640*z.instance().scale}},{key:"height",get:function(){return 160*z.instance().scale}}]),t}();function Mr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Nr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataEvent={},this.isStart=[],this.isWaitting=[],this.isEnd=[]}var t,n,i;return t=e,(n=[{key:"resetData",value:function(){this.dataEvent={},this.isStart=[],this.isWaitting=[],this.isEnd=[]}},{key:"setData",value:function(e){var t=new or;t=Object.assign({},t,e),this.dataEvent[t.id]=t,t.state===Dr.STATE_COMING?this.isWaitting.push(t.id):t.state===Dr.STATE_STARTED?this.isStart.push(t.id):this.isEnd.push(t.id)}},{key:"changeState",value:function(e,t){if(this.dataEvent.hasOwnProperty(e)){this.dataEvent[e].state=t;var n=this.isWaitting.indexOf(e);n>-1&&this.isWaitting.splice(n,1),(n=this.isStart.indexOf(e))>-1&&this.isStart.splice(n,1),(n=this.isEnd.indexOf(e))>-1&&this.isEnd.splice(n,1),this.dataEvent[e].state===Dr.STATE_COMING?this.isWaitting.push(e):this.dataEvent[e].state===Dr.STATE_STARTED?this.isStart.push(e):this.isEnd.push(e)}}},{key:"getWaittingRoom",value:function(){for(var e=[],t=0;t<this.isWaitting.length;t++)e.push(this.dataEvent[this.isWaitting[t]]);return e.sort(this.sortByTime)}},{key:"getStartRoom",value:function(){for(var e=[],t=0;t<this.isStart.length;t++)e.push(this.dataEvent[this.isStart[t]]);return e.sort(this.sortByTime)}},{key:"getEndRoom",value:function(){for(var e=[],t=0;t<this.isEnd.length;t++)e.push(this.dataEvent[this.isEnd[t]]);return e.sort(this.sortByTimeEnd)}},{key:"sortByTimeEnd",value:function(e,t){return e.finish_at<t.finish_at?1:e.finish_at>t.finish_at?-1:0}},{key:"sortByTime",value:function(e,t){return e.start_at<t.start_at?-1:e.start_at>t.start_at?1:0}}])&&Mr(t.prototype,n),i&&Mr(t,i),e}();function Br(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"events",get:function(){return"events"}},{key:"finish_at",get:function(){return"finish_at"}},{key:"created",get:function(){return"created"}},{key:"description",get:function(){return"description"}},{key:"banner",get:function(){return"banner"}},{key:"active",get:function(){return"active"}},{key:"start_at",get:function(){return"start_at"}},{key:"event_type",get:function(){return"event_type"}},{key:"name",get:function(){return"name"}},{key:"medal",get:function(){return"medal"}},{key:"id",get:function(){return"id"}},{key:"state",get:function(){return"state"}},{key:"updated",get:function(){return"updated"}},{key:"display_players",get:function(){return"display_players"}},{key:"question_index",get:function(){return"question_index"}},{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"is_dead",get:function(){return"is_dead"}},{key:"top_three",get:function(){return"top_three"}},{key:"event_id",get:function(){return"event_id"}},{key:"position",get:function(){return"position"}},{key:"achieved",get:function(){return"achieved"}},{key:"event_ranking",get:function(){return"event_ranking"}},{key:"your_rank",get:function(){return"your_rank"}},{key:"diamond",get:function(){return"diamond"}},{key:"event_reward",get:function(){return"event_reward"}},{key:"ticket",get:function(){return"ticket"}},{key:"support_item",get:function(){return"support_item"}},{key:"rank",get:function(){return"rank"}},{key:"reward_1st",get:function(){return"reward_1st"}},{key:"event_top_rank_log",get:function(){return"event_top_rank_log"}},{key:"top",get:function(){return"top"}},{key:"event",get:function(){return"event"}},{key:"number_user",get:function(){return"number_user"}},{key:"highest_achieved",get:function(){return"highest_achieved"}}],(n=null)&&Br(t.prototype,n),i&&Br(t,i),e}();function Ur(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Fr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reward=0,this.id=0,this.quest="",this.required=0,this.quest_type=0,this.order=0,this.reward_type=""}var t,n,i;return t=e,i=[{key:"get_quest",get:function(){return"quest"}},{key:"get_reward",get:function(){return"reward"}},{key:"get_id",get:function(){return"id"}},{key:"get_required",get:function(){return"required"}},{key:"get_quest_type",get:function(){return"quest_type"}},{key:"get_order",get:function(){return"order"}},{key:"get_reward_type",get:function(){return"reward_type"}}],(n=null)&&Ur(t.prototype,n),i&&Ur(t,i),e}();var Zr=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.created=0,this.quest_id=0,this.id=0,this.state="",this.updated=0};function Hr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Qr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ktSupport=!1,"undefined"!=typeof Storage&&(this.ktSupport=!0),"undefined"!=typeof NativeStorage&&(this.ktSupport=!0)}var t,n,i;return t=e,i=[{key:"VOTE",value:function(){return"vote"}},{key:"instance",value:function(){return this.controllStorage||(this.controllStorage=new e),this.controllStorage}}],(n=[{key:"setItem",value:function(e,t){this.ktSupport&&("web"===z.instance().platform?localStorage.setItem(e,t):NativeStorage.setItem(e,t,function(e){},function(e){}))}},{key:"getItem",value:function(e){if(this.ktSupport){if("web"===z.instance().platform)return localStorage.getItem(e);NativeStorage.getItem(e,function(e){return e},function(e){return"error"})}return"error"}},{key:"removeItem",value:function(e){this.ktSupport&&("web"===z.instance().platform?localStorage.removeItem(e):NativeStorage.remove(e,function(e){},function(e){}))}}])&&Hr(t.prototype,n),i&&Hr(t,i),e}();function Vr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Wr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ktPush=!1,cordova.plugins&&cordova.plugins.notification&&cordova.plugins.notification.local&&(this.ktPush=!0,cordova.plugins.notification.local.on("add",this.addCallback,this),cordova.plugins.notification.local.on("trigger",this.triggerCallback,this),cordova.plugins.notification.local.on("click",this.clickCallback,this),cordova.plugins.notification.local.on("clear",this.clearCallback,this),cordova.plugins.notification.local.on("cancel",this.cancelCallback,this),cordova.plugins.notification.local.on("update",this.updateCallback,this),cordova.plugins.notification.local.on("clearall",this.clearallCallback,this),cordova.plugins.notification.local.on("cancelall",this.cancelallCallback,this))}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.pushLocal||(this.pushLocal=new e),this.pushLocal}}],(n=[{key:"addCallback",value:function(e){console.log("addCallback-----------------------------"),console.log(e)}},{key:"triggerCallback",value:function(e){console.log("triggerCallback-----------------------------"),console.log(e)}},{key:"clickCallback",value:function(e){console.log("clickCallback-----------------------------"),console.log(e)}},{key:"clearCallback",value:function(e){console.log("clearCallback-----------------------------"),console.log(e)}},{key:"cancelCallback",value:function(e){console.log("cancelCallback-----------------------------"),console.log(e)}},{key:"updateCallback",value:function(e){console.log("updateCallback-----------------------------"),console.log(e)}},{key:"clearallCallback",value:function(e){console.log("clearallCallback-----------------------------"),console.log(e)}},{key:"cancelallCallback",value:function(e){console.log("cancelallCallback-----------------------------"),console.log(e)}},{key:"setLocalPush",value:function(e){this.ktPush&&cordova.plugins.notification.local.schedule(e)}},{key:"clearPush",value:function(e){this.ktPush&&cordova.plugins.notification.local.clear(e)}},{key:"add_minutes",value:function(e,t){return new Date(e.getTime()+6e4*t)}}])&&Vr(t.prototype,n),i&&Vr(t,i),e}();function qr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Kr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event={buy_playlist:new Phaser.Signal,event_update:new Phaser.Signal,load_online_mode_bet_complete:new Phaser.Signal,load_online_mode_room_bet_complete:new Phaser.Signal,load_event_list_complete:new Phaser.Signal,load_suggestion_opponent_complete:new Phaser.Signal,load_playlist_level_setting_complete:new Phaser.Signal,load_playlist_complete:new Phaser.Signal,load_random_opponent_complete:new Phaser.Signal,load_main_quest_complete:new Phaser.Signal},this.genres=new Hs,this.playlist=new zs,this.playlist_level_setting={},this.quickplay_bet_setting=[],this.createroom_bet_setting=[],this.random_opponents=new ir,this.random_opponents.event.call_load.add(this.sendReloadRandomOpponent,this),this.roomEvent=new Nr,this.suggestion_opponents=[],this.quests=[],this.quest_logs=[],this.ktLoadOnlineModeBet=!1,this.ktLoadOnlineModeRoomBet=!1,this.ktLoadEventList=!1,this.ktLoadSuggestionOpponent=!1,this.ktLoadPlaylistLevelSetting=!1,this.ktLoadPlaylist=!1,this.ktLoadRandomOpponent=!1,this.ktloadMainQuestComplete=!1,this.ktLoadingEventList=!1,mZ.instance().events.onExtensionResponse.add(this.getData,this)}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.dataUser||(this.dataUser=new e),this.dataUser}}],(n=[{key:"resetData",value:function(){this.genres.resetData(),this.playlist.resetData(),this.playlist_level_setting={},this.quickplay_bet_setting=[],this.createroom_bet_setting=[],this.random_opponents.resetData(),this.roomEvent.resetData(),this.suggestion_opponents=[],this.quests=[],this.quest_logs=[],this.ktLoadOnlineModeBet=!1,this.ktLoadOnlineModeRoomBet=!1,this.ktLoadEventList=!1,this.ktLoadSuggestionOpponent=!1,this.ktLoadPlaylistLevelSetting=!1,this.ktLoadPlaylist=!1,this.ktLoadRandomOpponent=!1,this.ktloadMainQuestComplete=!1,this.ktLoadingEventList=!1}},{key:"getData",value:function(e){switch(e.cmd){case Js.SHOP_PLAYLIST_LOAD_RESPONSE:case Pe.INIT_SHOP_PLAYLIST_RESPONSE:"OK"===e.params.getUtfString(tr.status)&&this.buildDataShop(e.params),this.event.load_playlist_complete.dispatch();break;case Js.SHOP_BUY_PLAYLIST_RESPONSE:if(qe.instance().hideLoading(),"OK"===e.params.getUtfString(tr.status)){var t=e.params.getInt(tr.playlist_id);this.playlist.removePlaylistInArrShop(t),this.playlist.changeBuyItemById(t),this.event.buy_playlist.dispatch()}break;case Pe.INIT_CLIENT_GAME_DATA_RESPONSE:this.buildInitClientData(e.params);break;case Pe.EVENT_UPDATE:this.roomEventUpdate(e.params);break;case Pe.TURNBASE_RELOAD_RANDOM_OPPONENT_RESPONSE:var n=this.random_opponents.getArrLenght();"OK"===e.params.getUtfString(tr.status)&&this.buildRandomOpponent(e.params),0===n&&this.event.load_random_opponent_complete.dispatch();break;case Pe.INIT_ONLINE_MODE_BET_RESPONSE:"OK"===e.params.getUtfString(tr.status)&&this.buildOnlineModeBet(e.params),this.event.load_online_mode_bet_complete.dispatch();break;case Pe.INIT_ONLINE_MODE_ROOM_BET_RESPONSE:"OK"===e.params.getUtfString(tr.status)&&this.buildOnlineModeRoomBet(e.params),this.event.load_online_mode_room_bet_complete.dispatch();break;case Pe.INIT_EVENT_LIST_RESPONSE:!0===this.ktLoadEventList&&(this.ktLoadEventList=!1,"OK"===e.params.getUtfString(tr.status)&&this.buildEventList(e.params),this.event.load_event_list_complete.dispatch());break;case Pe.INIT_SUGGESTION_OPPONENT_RESPONSE:"OK"===e.params.getUtfString(tr.status)&&this.buildSuggestionOpponent(e.params),this.event.load_suggestion_opponent_complete.dispatch();break;case Pe.INIT_PLAYLIST_LEVEL_SETTING_RESPONSE:"OK"===e.params.getUtfString(tr.status)&&this.buildPlaylistLevelSetting(e.params),this.sendGetEventList(),this.checkChangeScreen(),this.event.load_playlist_level_setting_complete.dispatch();break;case Pe.INIT_MAIN_QUEST_DATA_RESPONSE:"OK"===e.params.getUtfString(tr.status)&&this.buildMainQuest(e.params),this.event.load_main_quest_complete.dispatch();break;case Pe.INIT_USER_PLAYLIST_MAPPING_RESPONSE:"OK"===e.params.getUtfString(tr.status)&&this.buildUserPlaylistMapping(e.params),this.sendGetPlaylistLevelSetting()}}},{key:"beginLoadData",value:function(){qe.instance().showLoading(),this.resetData(),this.sendGetDataShop()}},{key:"buildUserPlaylistMapping",value:function(e){if(e.containsKey("user_playlist_mappings"))for(var t=e.getSFSArray("user_playlist_mappings"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o=new Qs;o.user_id=i.getInt("user_id"),o.level=i.getInt("level"),o.playlist_id=i.getInt("playlist_id"),o.exp_score=i.getInt("exp_score"),o.created=i.getLong("created"),o.active=i.getInt("active"),o.id=i.getLong("id"),o.current_level_score=i.getInt("current_level_score"),o.next_level_score=i.getInt("next_level_score"),o.updated=i.getLong("updated"),this.playlist.setDataMePlaylist(o.playlist_id,o)}}},{key:"buildMainQuest",value:function(e){if(e.containsKey("quests"))for(var t=e.getSFSArray("quests"),n=0;n<t.size();n++){var i=new Fr,o=t.getSFSObject(n);i.reward=o.getInt("reward"),i.id=o.getInt("id"),i.quest=o.getUtfString("quest"),i.required=o.getInt("required"),i.quest_type=o.getInt("quest_type"),i.order=o.getInt("order"),i.reward_type=o.getUtfString("reward_type"),this.quests.push(i)}if(e.containsKey("quest_logs"))for(var a=e.getSFSArray("quest_logs"),s=0;s<a.size();s++){var r=new Zr,l=a.getSFSObject(s);r.user_id=l.getInt("user_id"),r.created=l.getLong("created"),r.quest_id=l.getInt("quest_id"),r.id=l.getLong("id"),r.state=l.getUtfString("state"),r.updated=l.getLong("updated"),this.quest_logs.push(r)}this.ktloadMainQuestComplete=!0}},{key:"buildRandomOpponent",value:function(e){if(e.containsKey("random_opponents")){for(var t=e.getSFSArray("random_opponents"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o={};o.gender=i.getUtfString("gender"),o.userName=i.getUtfString("user_name"),o.last_login=i.getLong("last_login"),o.genre_count=i.getLong("genre_count"),o.id=i.getInt("id"),o.avatar=i.getUtfString("avatar"),this.random_opponents.setUser(o)}this.ktLoadRandomOpponent=!0}}},{key:"buildPlaylistLevelSetting",value:function(e){if(e.containsKey("playlist_level_setting")){for(var t=e.getSFSArray("playlist_level_setting"),n=0;n<t.size();n++){var i=t.getSFSObject(n);this.playlist_level_setting[i.getInt("level")]=i.getInt("exp_score")}this.ktLoadPlaylistLevelSetting=!0}}},{key:"buildSuggestionOpponent",value:function(e){if(e.containsKey("suggestion_opponents")){for(var t=e.getSFSArray("suggestion_opponents"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o={};o.gender=i.getUtfString("gender"),o.user_name=i.getUtfString("user_name"),o.last_login=i.getLong("last_login"),o.id=i.getInt("id"),o.avatar=i.getUtfString("avatar"),this.suggestion_opponents.push(o)}this.ktLoadSuggestionOpponent=!0}}},{key:"buildEventList",value:function(e){if(e.containsKey("events")){for(var t=e.getSFSArray(jr.events),n=0;n<t.size();n++){var i=t.getSFSObject(n),o=new or;if(o.finish_at=i.getLong(jr.finish_at),o.created=i.getLong(jr.created),o.description=i.getUtfString(jr.description),o.banner=i.getUtfString(jr.banner),o.active=i.getInt(jr.active),o.start_at=i.getLong(jr.start_at),o.event_type=i.getUtfString(jr.event_type),o.name=i.getUtfString(jr.name),o.medal=i.getUtfString(jr.medal),o.id=i.getLong(jr.id),o.state=i.getUtfString(jr.state),o.updated=i.getLong(jr.updated),i.containsKey(jr.number_user)&&(o.number_user=i.getInt(jr.number_user)),i.containsKey(jr.reward_1st)){var a=i.getSFSObject(jr.reward_1st);o.reward_1st.diamond=a.getInt(jr.diamond),o.reward_1st.event_id=a.getLong(jr.event_id),o.reward_1st.ticket=a.getInt(jr.ticket),o.reward_1st.created=a.getLong(jr.created),o.reward_1st.event_ranking=a.getUtfString(jr.event_ranking),o.reward_1st.updated=a.getLong(jr.updated),o.reward_1st.support_item=a.getInt(jr.support_item)}this.roomEvent.setData(o)}this.ktLoadEventList=!0,this.checkSetLocalPush()}}},{key:"buildOnlineModeRoomBet",value:function(e){if(e.containsKey("online_mode_room_bet_setting")){for(var t=e.getSFSArray("online_mode_room_bet_setting"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o={};o.id=i.getInt("id"),o.bet_place=i.getInt("bet_place"),o.percent_of_fee=i.getInt("percent_of_fee"),this.createroom_bet_setting.push(o)}this.ktLoadOnlineModeRoomBet=!0}}},{key:"buildOnlineModeBet",value:function(e){if(e.containsKey("online_mode_bet_setting")){for(var t=e.getSFSArray("online_mode_bet_setting"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o={};o.user_level_required=i.getInt("user_level_required"),o.id=i.getInt("id"),o.bet_place=i.getInt("bet_place"),o.percent_of_fee=i.getInt("percent_of_fee"),this.quickplay_bet_setting.push(o)}this.ktLoadOnlineModeBet=!0}}},{key:"roomEventUpdate",value:function(e){if("OK"===e.getUtfString(tr.status)){var t=e.getLong("event_id"),n=e.getUtfString("event_state");this.roomEvent.changeState(t,n),this.event.event_update.dispatch()}}},{key:"getNewPlaylist",value:function(e){this.playlist.removePlaylistInArrShop(e),this.playlist.changeBuyItemById(e)}},{key:"buildInitClientData",value:function(e){"OK"===e.getUtfString(tr.status)&&(this.buildOnlineModeBet(e),this.buildOnlineModeRoomBet(e),this.buildEventList(e),this.buildSuggestionOpponent(e),this.buildPlaylistLevelSetting(e),this.buildRandomOpponent(e),this.buildMainQuest(e),this.checkSetLocalPush()),this.checkChangeScreen()}},{key:"checkSetLocalPush",value:function(){var e=this.roomEvent.getWaittingRoom();if(e.length>0)for(var t=0;t<e.length;t++){var n=e[t].id,i=Qr.instance().getItem("RoomEvent"+n);if("error"===i||null===i||"null"===i){var o=(new Date).getTime();if(!(e[t].start_at-o<3e5)){var a="",s=new Date(e[t].start_at),r=new Date(e[t].finish_at),l=s.getDate(),h=s.getMonth()+1,c=s.getHours(),u=s.getMinutes(),d=r.getDate(),f=r.getMonth()+1,p=r.getFullYear(),g=r.getHours(),y=r.getMinutes();a=d===l?c+"h"+u+" - "+g+"h"+y+" "+d+"/"+f+"/"+p:c+"h"+u+" "+l+"/"+h+" - "+g+"h"+y+" "+d+"/"+f+"/"+p;var m={id:999,title:"Sự kiện "+e[t].name+" sắp bắt đầu",text:a,trigger:{at:new Date(e[t].start_at-3e5)}};Wr.instance().setLocalPush(m),Wr.instance().ktPush&&Le.instance().logEvent("LocalRoomEventPush"),Qr.instance().setItem("RoomEvent"+n,!0);break}}}}},{key:"buildDataShop",value:function(e){if("OK"===e.getUtfString(tr.status)){for(var t=e.getSFSArray(tr.genres),n={},i={genres:[],playlists:[]},o=0;o<t.size();o++){var a=t.getSFSObject(o),s=new Fs;s.code=a.getUtfString(tr.code),s.genre=a.getUtfString(tr.genre),s.id=a.getInt(tr.id),s.region=a.getUtfString(tr.region),s.parent=a.getInt(tr.parent),s.priority=a.getInt(tr.priority),s.active=a.getInt(tr.active),n[s.id]=s.region,i.genres.push(s)}for(var r=e.getSFSArray(tr.playlists),l=0;l<r.size();l++){var h=r.getSFSObject(l),c=new Vs;if(c.is_highlight=h.getInt(tr.is_highlight),c.used_times=h.getInt(tr.used_times),c.thumb=h.getUtfString(tr.thumb),c.created=h.getLong(tr.created),c.is_owner=h.getInt(tr.is_owner),c.is_default=h.getInt(tr.is_default),c.genre_id=h.getInt(tr.genre_id),c.purchased=h.getInt(tr.purchased),c.songs=h.getUtfString(tr.songs),c.price=h.getInt(tr.price),c.is_general=h.getInt(tr.is_general),c.name=h.getUtfString(tr.name),c.id=h.getInt(tr.id),c.vip=h.getInt(tr.vip),c.is_solo_mode=h.getInt(tr.is_solo_mode),c.updated=h.getLong(tr.updated),c.country_id=h.getInt(tr.country_id),c.purchased_count=h.getInt(tr.purchased_count),c.active=h.getInt(tr.active),n.hasOwnProperty(c.genre_id)&&(c.region=n[c.genre_id]),h.containsKey(tr.user_playlist_mapping)){var u=h.getSFSObject(tr.user_playlist_mapping);u&&(c.user.user_id=u.getInt(tr.user_id),c.user.level=u.getInt(tr.level),c.user.playlist_id=u.getInt(tr.playlist_id),c.user.exp_score=u.getInt(tr.exp_score),c.user.created=u.getLong(tr.created),c.user.active=u.getInt(tr.active),c.user.id=u.getLong(tr.id),c.user.current_level_score=u.getInt(tr.current_level_score),c.user.next_level_score=u.getInt(tr.next_level_score),c.user.updated=u.getLong(tr.updated))}i.playlists.push(c)}this.setDataPlaylist(i),Qr.instance().setItem("playlist_reload_at",window.RESOURCE.playlist_reload_at),Qr.instance().setItem("playlist_data",JSON.stringify(i))}}},{key:"setDataPlaylist",value:function(e){for(var t=0;t<e.genres.length;t++)this.genres.setDataGenres(e.genres[t]);for(var n=0;n<e.playlists.length;n++)this.playlist.setDataPlayList(e.playlists[n]);this.ktLoadPlaylist=!0,this.sendGetUserPlaylistMapping()}},{key:"sendReloadRandomOpponent",value:function(){mZ.instance().sendData(Pe.TURNBASE_RELOAD_RANDOM_OPPONENT_REQUEST,null)}},{key:"sendGetInitClientGameData",value:function(){mZ.instance().sendData(Pe.INIT_CLIENT_GAME_DATA_REQUEST,null)}},{key:"sendGetDataShop",value:function(){var e=Qr.instance().getItem("playlist_reload_at");if("error"===e||null===e||"null"===e)mZ.instance().sendData(Pe.INIT_SHOP_PLAYLIST_REQUEST,null);else if(e!==window.RESOURCE.playlist_reload_at)mZ.instance().sendData(Pe.INIT_SHOP_PLAYLIST_REQUEST,null);else{var t=Qr.instance().getItem("playlist_data");"error"===t||null===t||"null"===t?mZ.instance().sendData(Pe.INIT_SHOP_PLAYLIST_REQUEST,null):(this.setDataPlaylist(JSON.parse(t)),this.event.load_playlist_complete.dispatch())}}},{key:"setPlayList",value:function(e){this.playlist.setDataPlayList(e)}},{key:"sendGetOnlineModeBet",value:function(){mZ.instance().sendData(Pe.INIT_ONLINE_MODE_BET_REQUEST,null)}},{key:"sendGetOnlineModeRoomBet",value:function(){mZ.instance().sendData(Pe.INIT_ONLINE_MODE_ROOM_BET_REQUEST,null)}},{key:"sendGetEventList",value:function(){!1===this.ktLoadEventList&&(this.ktLoadEventList=!0,mZ.instance().sendData(Pe.INIT_EVENT_LIST_REQUEST,null))}},{key:"sendGetSuggestionOpponent",value:function(){mZ.instance().sendData(Pe.INIT_SUGGESTION_OPPONENT_REQUEST,null)}},{key:"sendGetPlaylistLevelSetting",value:function(){mZ.instance().sendData(Pe.INIT_PLAYLIST_LEVEL_SETTING_REQUEST,null)}},{key:"sendGetMainQuest",value:function(){mZ.instance().sendData(Pe.INIT_MAIN_QUEST_DATA_REQUEST,null)}},{key:"sendGetUserPlaylistMapping",value:function(){mZ.instance().sendData(Pe.INIT_USER_PLAYLIST_MAPPING_REQUEST,null)}},{key:"checkChangeScreen",value:function(){qe.instance().hideLoading(),void 0!==z.instance().isNewUser&&1==z.instance().isNewUser?WF.instance().changeScreen(Ce.NEW_USER):WF.instance().changeScreen(Ce.MAIN_MENU)}}])&&qr(t.prototype,n),i&&qr(t,i),e}();function zr(e){return(zr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jr(e,t){return!t||"object"!==zr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xr(e){return(Xr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $r(e,t){return($r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var el=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Jr(this,Xr(t).call(this,game))).event={choose_playlist:new Phaser.Signal,onBack:new Phaser.Signal,challengeGame:new Phaser.Signal},e.typeOfSearchFriend=t.NAME,e.valueKeyboard="",e.screenSearchResult=null,e.isClickSearch=!1,e.afterInit(),e}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$r(e,t)}(t,Phaser.Group),n=t,a=[{key:"NAME",get:function(){return"NAME"}},{key:"ID",get:function(){return"ID"}},{key:"MUST_INT",get:function(){return"Bạn phải nhập đúng ID(là số)!"}},{key:"MUST_GREATER_3",get:function(){return"Bạn phải nhập ít nhất 3 ký tự!"}}],(o=[{key:"afterInit",value:function(){this.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),this.findgameGroup=null,this.findGameSuggestionFriend=new Ia,this.findGameSuggestionFriend.event.challengeGame.add(this.challengeGame,this),this.findGameRandomUser=new Ha,this.findGameRandomUser.event.challengeGame.add(this.challengeGame,this),this.findGameHeaderAndTextInField=new ys,this.findGameHeaderAndTextInField.event.challengeGame.add(this.getChallengeGame,this),this.findGameHeaderAndTextInField.event.onBack.add(this.onBackFindGame,this),this.findGameHeaderAndTextInField.event.onSearch.add(this.onSearchFriend,this),this.findGameFriendlist=new _s,this.findGameFriendlist.event.challengeGame.add(this.challengeGame,this),this.addEventExtension(),this.sendRequestFindGame(),Le.instance().logEvent(Le.Find_Game_turnbase_mode)}},{key:"sendRequestFindGame",value:function(){this.checkRequestSocketFindGame(),0==z.instance().isChallengeGameFindOpponents.checking?(z.instance().friendLists=[],z.instance().suggestion_users=[],z.instance().random_user=null,this.sendTurnBaseFindOpponentRequest()):this.handleParamsOnFindOpponentsResponse(1,function(){})}},{key:"sendTurnBaseFindOpponentRequest",value:function(){mZ.instance().sendData(Et.USER_FRIEND_LIST_LOAD_REQUEST,null),z.instance().isChallengeGameFindOpponents.checking=!0,z.instance().isChallengeGameFindOpponents.updated=Date.now()}},{key:"checkRequestSocketFindGame",value:function(){1==z.instance().isChallengeGameFindOpponents.checking?Date.now()-z.instance().isChallengeGameFindOpponents.updated<6e3?z.instance().isChallengeGameFindOpponents.checking=!0:z.instance().isChallengeGameFindOpponents.checking=!1:z.instance().isChallengeGameFindOpponents.checking=!1}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.clickOKDialog.add(this.clickOKDialog,this),De.instance().event.searchFriendBackUserProfile.add(this.searchFriendBackUserProfile,this),rl.instance().event.changeTypeSearch.add(this.changeTypeSearch,this),rl.instance().event.enter.add(this.onSubmitSearch,this),rl.instance().event.submit.add(this.onSubmitSearch,this),rl.instance().event.cancle.add(this.keyboardCancle,this),Kr.instance().event.load_random_opponent_complete.add(this.loadRandomOpponentComplete,this),Kr.instance().event.load_suggestion_opponent_complete.add(this.loadSuggestionUsersComplete,this)}},{key:"loadRandomOpponentComplete",value:function(){z.instance().random_user=Kr.instance().random_opponents.getUser(),this.doneHandleFindOpponentsRandomAndSuggestionResponse()}},{key:"loadSuggestionUsersComplete",value:function(){for(var e=[],t=0;t<3;t++)if(Kr.instance().suggestion_opponents[t]){var n=Kr.instance().suggestion_opponents[t];e.push(n)}z.instance().suggestion_users=e,this.handleRandomUser()}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),rl.instance().event.changeTypeSearch.remove(this.changeTypeSearch,this),rl.instance().event.submit.remove(this.onSubmitSearch,this),rl.instance().event.enter.remove(this.onSubmitSearch,this),De.instance().event.clickOKDialog.remove(this.clickOKDialog,this),De.instance().event.searchFriendBackUserProfile.remove(this.searchFriendBackUserProfile,this),rl.instance().event.cancle.remove(this.keyboardCancle,this),Kr.instance().event.load_random_opponent_complete.remove(this.loadRandomOpponentComplete,this),Kr.instance().event.load_suggestion_opponent_complete.remove(this.loadSuggestionUsersComplete,this)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.SEARCH_USER_BY_ID_RESPONSE&&(this.searchedUsers=this.handleSearchResponse(e.params),this.addScreenSearch(this.searchedUsers),qe.instance().hideLoading()),e.cmd==Et.SEARCH_USER_BY_NAME_RESPONSE&&(this.searchedUsers=this.handleSearchResponse(e.params),this.addScreenSearch(this.searchedUsers),qe.instance().hideLoading()),e.cmd==Et.USER_FRIEND_LIST_LOAD_RESPONSE&&this.handleParamsFriendList(e.params,function(){t.handleParamsOnFindOpponentsResponse(1,function(){})})}},{key:"handleParamsFriendList",value:function(e,t){if("OK"==e.getUtfString("status"))for(var n=e.getSFSArray("friends"),i=0;i<n.size();i++){for(var o=n.getSFSObject(i),a=o.getUtfString("user_name"),s=o.getUtfString("avatar"),r=o.getInt("id"),l=o.getBool("is_online"),h="NO_GAME",c=0;c<z.instance().menuOpponentsResponse.length;c++)if(r==z.instance().menuOpponentsResponse[c].opponentEntity.id){h=z.instance().menuOpponentsResponse[c].status;break}z.instance().friendLists.push({userName:a,avatar:s,id:r,isOnline:l,status:h})}t()}},{key:"doneHandleFindOpponentsRandomAndSuggestionResponse",value:function(){this.findGameSuggestionFriend.addGroupSuggestionFriend(),this.findGameSuggestionFriend.addSuggestionFriend(z.instance().suggestion_users,function(){}),this.findGameRandomUser.initGroup(),this.findGameRandomUser.addButtonRandomUser(z.instance().random_user),this.findGameRandomUser.addBtnInviteFriendFB(),this.doneHandleFindOpponentsResponse()}},{key:"doneHandleFindOpponentsResponse",value:function(){this.createFindGameScreenChooseFriend(),this.addChildInScreen()}},{key:"addChildInScreen",value:function(){this.addChild(this.findGameHeaderAndTextInField),this.addChild(this.findGameFriendlist),this.addChild(this.findGameSuggestionFriend),this.addChild(this.findGameRandomUser),qe.instance().hideLoading()}},{key:"addScreenSearch",value:function(e){this.removeScreenSearch(),this.screenSearchResult=new Us(e),this.screenSearchResult.event.refreshSearch.add(this.refreshSearch,this),this.screenSearchResult.event.getUserProfile.add(this.getUserProfile,this),this.addChild(this.screenSearchResult),this.onSearchFriend()}},{key:"refreshSearch",value:function(){this.removeScreenSearch(),this.searchFriend(this.typeOfSearchFriend,this.valueKeyboard)}},{key:"getUserProfile",value:function(e){z.instance().isGetUserProfileSearch=!0,rl.instance().hide(),iC.instance().addUserProfile(e)}},{key:"searchFriendBackUserProfile",value:function(){this.onSearchFriend()}},{key:"removeScreenSearch",value:function(){null!==this.screenSearchResult&&(this.screenSearchResult.event.refreshSearch.remove(this.refreshSearch,this),this.screenSearchResult.event.getUserProfile.remove(this.getUserProfile,this),this.removeChild(this.screenSearchResult),this.screenSearchResult.destroy(),this.isClickSearch=!1,this.screenSearchResult=null)}},{key:"handleSearchResponse",value:function(e){var t=[];if(e.containsKey("user_founds")){var n=e.getSFSArray(Cs.user_founds);for(i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString(Cs.friend_status),s=o.getUtfString(Cs.user_name),r=o.getBool(Cs.is_online),l=o.getInt(Cs.id),h=o.getUtfString(Cs.avatar);t.push({friend_status:a,user_name:s,is_online:r,id:l,avatar:h})}}return t}},{key:"handleParamsOnFindOpponentsResponse",value:function(e,t){1==e&&(this.handleSuggestionUsers(),t())}},{key:"handleParamsFriendsOnFindOpponentsResponse",value:function(e,t){if("OK"==e.getUtfString("status"))for(var n=e.getSFSArray("friends"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString("user_name"),s=o.getUtfString("avatar"),r=o.getInt("id"),l=o.getUtfString("status"),h=o.getBool("is_online");z.instance().friendLists.push({userName:a,avatar:s,id:r,isOnline:h,status:l})}t()}},{key:"handleRandomUser",value:function(){1==Kr.instance().ktLoadRandomOpponent?this.loadRandomOpponentComplete():Kr.instance().sendReloadRandomOpponent()}},{key:"handleSuggestionUsers",value:function(){1==Kr.instance().ktLoadSuggestionOpponent?this.loadSuggestionUsersComplete():Kr.instance().sendGetSuggestionOpponent()}},{key:"getBuddyListFriend",value:function(e){this.listBuddy=[];for(var t=mZ.instance().socket.buddyManager.getBuddyList(),n=0;n<t.length;n++){var i=t[n],o=new ma;o.avatar=i.getVariable("$"+wa.avatar).value,o.diamond=i.getVariable("$"+wa.diamond).value,o.isOnline=i[wa.isOnline],o.userId=i.getVariable("$"+wa.userId).value,o.userName=i.getVariable("$"+wa.userName).value,this.listBuddy.push(o)}this.listBuddy=this.listBuddy.sort(this.compareOnline),e()}},{key:"compareOnline",value:function(e){return 1==e.isOnline?-1:1}},{key:"createFindGameScreenChooseFriend",value:function(){var e=this;this.sortFriendlistsOfStatus(z.instance().friendLists,function(t){if(null==e.findgameGroup||null==e.findgameGroup){e.findgameGroup=new Phaser.Group(game),e.addChild(e.findgameGroup);var n=new Phaser.Button(game,0,0,"bg_create_room");e.findgameGroup.add(n),e.findGameFriendlist.afterInit(),e.findGameFriendlist.addListFriend(t),e.findGameHeaderAndTextInField.addHeader(t.length,t)}e.findgameGroup.position.x=0})}},{key:"getChallengeGame",value:function(e){LogConsole.log(e),this.event.challengeGame.dispatch(e)}},{key:"mergeListOnlineToListFriend",value:function(e){for(var t=[],n=0;n<this.listBuddy.length;n++)for(var i=0;i<this.friendLists.length;i++)if(this.friendLists[i].id==this.listBuddy[n].userId){var o={avatar:this.friendLists[i].avatar,id:this.friendLists[i].id,isOnline:this.listBuddy[n].isOnline,userName:this.friendLists[i].userName,status:this.friendLists[i].status};t.push(o)}e(t)}},{key:"sortFriendlistsOfStatus",value:function(e,t){t(e=e.sort(function(e,t){return e.status-t.status}))}},{key:"onBackFindGame",value:function(){0==this.isClickSearch?WF.instance().changeScreen(Ce.MAIN_MENU):(this.removeScreenSearch(),this.isClickSearch=!1)}},{key:"onSearchFriend",value:function(){var e=this;this.url="onSearchFriend";var t="";""==this.valueKeyboard&&(t="Nhập tên"),setTimeout(function(){e.isClickSearch=!0,rl.instance().show({maxLength:"",showTransparent:!0,placeholder:t,isSearch:!0,isSearchFriend:!0,typeSearch:e.typeOfSearchFriend}),""!==e.valueKeyboard&&rl.instance().setValue(e.valueKeyboard)},100)}},{key:"challengeGame",value:function(e){this.event.challengeGame.dispatch(e)}},{key:"changeTypeSearch",value:function(e){this.typeOfSearchFriend=e}},{key:"onSubmitSearch",value:function(){if(this.valueKeyboard=rl.instance().getValue(),this.typeOfSearchFriend==t.ID){var e=this.valueKeyboard;"NaN"!==e&&e>0?this.searchFriend(this.typeOfSearchFriend,this.valueKeyboard):iC.instance().addDialog(t.MUST_INT)}else this.typeOfSearchFriend==t.NAME&&(this.valueKeyboard.length>2?this.searchFriend(this.typeOfSearchFriend,this.valueKeyboard):iC.instance().addDialog(t.MUST_GREATER_3,this.url));rl.instance().hide()}},{key:"searchFriend",value:function(e,n){this.searchedUsers=[];var i=new SFS2X.SFSObject;e==t.ID&&(i.putInt("user_id",parseInt(n)),mZ.instance().sendData(Et.SEARCH_USER_BY_ID_REQUEST,i),qe.instance().showLoading()),e==t.NAME&&(i.putUtfString("user_name",n),mZ.instance().sendData(Et.SEARCH_USER_BY_NAME_REQUEST,i),qe.instance().showLoading())}},{key:"clickOKDialog",value:function(e){e==this.url&&this.onSearchFriend()}},{key:"keyboardCancle",value:function(){this.removeScreenSearch()}},{key:"destroy",value:function(){for(this.removeEventExtension(),rl.instance().hide();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Yr(n.prototype,o),a&&Yr(n,a),t}();function tl(e){return(tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nl(e,t){return!t||"object"!==tl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function il(e){return(il=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ol(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function al(e,t,n){return t&&ol(e.prototype,t),n&&ol(e,n),e}function sl(e,t){return(sl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rl=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=nl(this,il(t).call(this,game,null))).event={enter:new Phaser.Signal,change:new Phaser.Signal,submit:new Phaser.Signal,cancle:new Phaser.Signal,changeHeight:new Phaser.Signal,hideKeyboard:new Phaser.Signal,changeTypeSearch:new Phaser.Signal},e.opened=!1,e.transparentObj=null,e.container=null,e.layoutChat=null,e.keyboardHeight=game.height,e.varTimeout=null,e.varTimeoutChange=null,window.addEventListener("resize",function(){e.varTimeout=setTimeout(function(){e.setStyleInput()},50)}),window.addEventListener("keyboardDidShow",function(t){console.log(t),"ios"===z.instance().platform?e.keyboardHeight=game.height-(screen.height-t.keyboardHeight)/game.scale.scaleFactorInversed.y+120:e.keyboardHeight=t.keyboardHeight/game.scale.scaleFactorInversed.y+Un.instance().getChangeHeight()+120,"ios"!==e.mainData.platform&&"and"!==e.mainData.platform||(e.event.changeHeight.dispatch(e.keyboardHeight),e.changeHeightText())}),window.addEventListener("keyboardDidHide",function(t){console.log(t),e.event.hideKeyboard.dispatch()}),window.addEventListener("keyboardHeightWillChange",function(t){console.log(t.keyboardHeight);var n=0;n="ios"===z.instance().platform?game.height-(screen.height-t.keyboardHeight)/game.scale.scaleFactorInversed.y+120:t.keyboardHeight/game.scale.scaleFactorInversed.y+Un.instance().getChangeHeight()+120,e.keyboardHeight!==n&&(e.keyboardHeight=n,"ios"!==e.mainData.platform&&"and"!==e.mainData.platform||(e.event.changeHeight.dispatch(e.keyboardHeight),e.changeHeightText()))}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sl(e,t)}(t,Mt),al(t,null,[{key:"instance",value:function(){return this.keyBoard||(this.keyBoard=new t),this.keyBoard}}]),al(t,[{key:"changeHeightText",value:function(){null!==this.layoutChat&&(this.layoutChat.y=game.height-this.keyboardHeight,this.layoutChat.y<0&&(this.layoutChat.y=0),this.setStyleInput()),game.world.add(this)}},{key:"setStyleInput",value:function(){if(LogConsole.log("setStyleInput"),LogConsole.log(game.canvas.getBoundingClientRect()),$("#chatInput").length){var e=game.canvas.getBoundingClientRect().width/game.width,t=game.canvas.getBoundingClientRect().height/game.height;console.log(game.scale);var n=Math.min(e,t);console.log(this.options.configText);var i=(window.innerWidth-game.canvas.getBoundingClientRect().width)/2,o={};o="input"===this.options.typeInputText?{top:game.canvas.getBoundingClientRect().top+this.options.configText.y*n+"px",left:i+this.options.configText.x*n+"px",width:(this.options.configText.width-24)*n+"px",height:(this.options.configText.height-5)*n+"px",position:"absolute"}:"chat"===this.options.typeInputText?{top:(game.canvas.getBoundingClientRect().top+(this.layoutChat.y+10))*n+"px",left:i+20*n+"px",width:480*n+"px",height:85*n+"px",position:"absolute"}:{top:game.canvas.getBoundingClientRect().top+105*n+"px",left:i+37*n+"px",width:460*n+"px",height:85*n+"px",position:"absolute"},console.log(o),o["font-size"]=30*n+"px",o["padding-left"]=10*n+"px",o["padding-right"]=10*n+"px",this.setStyleOnElement($("#chatInput"),o),$("#chatInput").focus()}}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.options=Object.assign({},{maxLength:"",showTransparent:!0,placeholder:"Nhập id phòng",isSearch:!1,isSearchFriend:!1,typeSearch:"NAME",typeInputText:"search",configText:{width:0,height:0,x:0,y:0}},e),null===this.container)this.container=new Phaser.Sprite(game,0,0,""),this.addChild(this.container);else for(null!=this.layoutChat&&(this.container.removeChild(this.layoutChat),this.layoutChat.destroy(!0),this.layoutChat=null);this.container.children.length>0;){var t=this.container.children[0];this.container.removeChild(t),t.destroy(),t=null}"input"===e.typeInputText||("chat"===e.typeInputText?this.addChat():this.addSearch()),!1===this.opened?(this.opened=!0,this.open(e.maxLength,e.placeholder||"")):this.setStyleInput(),e.defaultText&&this.setValue(e.defaultText),game.world.add(this)}},{key:"onUpBg",value:function(){this.hide()}},{key:"addSearch",value:function(){var e=this;null!=this.layoutChat&&(this.container.removeChild(this.layoutChat),this.layoutChat.destroy(!0),this.layoutChat=null);var t={x:0,y:0,nameAtlas:"defaultSource",nameSprite:"BG",left:4,right:4,top:4,bot:4,width:game.width,height:222,name:"chatBgkeyboard",configText:{x:0,y:0,style:{fontSize:25,font:"GilroyMedium",align:"left",boundsAlignH:"left",boundsAlignV:"middle"}}},n=new ya(t,"");n.input.useHandCursor=!1,this.container.addChild(n),this.options.hasOwnProperty("isSearchFriend")&&!0===this.options.isSearchFriend&&(this.isSearchFriend=!0,this.textName=new Phaser.Text(game,40,45,"Theo tên",{fontSize:25,font:"GilroyMedium",align:"left",fill:"#ffffff"}),n.addChild(this.textName),this.textName.inputEnabled=!0,this.options.hasOwnProperty("typeSearch")&&"ID"!==this.options.typeSearch?this.textName.activeTxt=!0:(this.textName.activeTxt=!1,this.textName.addColor("#8a8a8a",0)),this.textName.events.onInputUp.add(function(){1==e.textName.activeTxt||(e.textName.addColor("#ffffff",0),e.textName.activeTxt=!0),e.event.changeTypeSearch.dispatch(el.NAME)},this),n.addChild(this.addDoc(160,48)));var i={x:530,y:108,nameAtlas:"defaultSource",nameSprite:"Send_Icon"};this.options.hasOwnProperty("isSearch")&&!0===this.options.isSearch?i.nameSprite="Btn_Search_Icon":i.nameSprite="Send_Icon";var o=new pt(i,this.onSubmit,this),a=new pt({x:582,y:38,nameAtlas:"defaultSource",nameSprite:"Exit"},this.onCancel,this);n.addChild(o),n.addChild(a)}},{key:"addChat",value:function(){if(null===this.layoutChat){this.layoutChat=new Phaser.Sprite(game,0,0,"");var e={x:0,y:0,nameAtlas:"defaultSource",nameSprite:"BG",left:4,right:4,top:4,bot:4,width:game.width,height:120,name:"chatBgkeyboard",configText:{x:0,y:0,style:{fontSize:25,font:"GilroyMedium",align:"left",boundsAlignH:"left",boundsAlignV:"middle"}}},t=new ya(e,"");t.input.useHandCursor=!1,this.layoutChat.addChild(t);var n=new pt({x:545,y:23,nameAtlas:"defaultSource",nameSprite:"Close_Icon"},this.onCancel,this);this.layoutChat.addChild(n),this.layoutChat.y=game.height-this.keyboardHeight,this.layoutChat.y<0&&(this.layoutChat.y=0)}this.container.addChild(this.layoutChat)}},{key:"onSubmit",value:function(){this.event.submit.dispatch()}},{key:"onCancel",value:function(){this.event.cancle.dispatch(),this.hide()}},{key:"hide",value:function(){this.opened=!1,window.navigationbar&&window.navigationbar.hideNavigationBar(),"undefined"!=typeof StatusBar&&StatusBar.hide(),null!=this.layoutChat&&(this.container.removeChild(this.layoutChat),this.layoutChat.destroy(!0),this.layoutChat=null),null!=this.container&&(this.removeChild(this.container),this.container.destroy(!0),this.container=null),null!=this.transparentObj&&(this.transparentObj.destroy(!0),this.transparentObj=null),this.parent&&game.world.remove(this),null!==this.varTimeout&&(clearTimeout(this.varTimeout),this.varTimeout=null),null!=this.varTimeoutChange&&(clearTimeout(this.varTimeoutChange),this.varTimeoutChange=null),this.close()}},{key:"open",value:function(e,t){this.appendDOM(e,t)}},{key:"close",value:function(){$("#chatInput").length&&($("#game").remove("#chatInput"),$("#chatInput").remove())}},{key:"setValue",value:function(e){$("#chatInput").length&&$("#chatInput").val(e)}},{key:"getValue",value:function(){return $("#chatInput").length?$("#chatInput").val():""}},{key:"appendDOM",value:function(e,t){var n=this;this.close(),$("#game").append('<input id="chatInput" type="text" placeholder="'+t+'" value="" maxlength="'+e+'" autofocus>'),$("#chatInput").keypress(function(e){LogConsole.log("event.key : "+e.which),null!=n.varTimeoutChange&&clearTimeout(n.varTimeoutChange),13===e.which?(LogConsole.log("enter"),n.event.enter.dispatch()):n.varTimeoutChange=setTimeout(function(){n.event.change.dispatch()},300)}),this.setStyleInput()}},{key:"addDoc",value:function(e,t){return new Phaser.Sprite(game,e,t,"defaultSource","LineDoc")}},{key:"setStyleOnElement",value:function(e,t){e.css(t)}}]),t}();function ll(e){return(ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cl(e,t){return!t||"object"!==ll(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ul(e){return(ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dl(e,t){return(dl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fl=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=cl(this,ul(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.txtMess=":)"==e||"(:"==e?"(smile)":":("==e||"):"==e?"(sad)":e,o.timeValue=n,o.checkShowTime=!1,o.isLastMess=i,o.index=0,o.event={showTime:new Phaser.Signal,hideTime:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dl(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.bgText=new Phaser.Group(game),this.addChild(this.bgText),this.text=new St(this.positionMenuConfig.chat_screen.txt_mess,this.txtMess),this.addChild(this.text);var e=40*window.GameConfig.RESIZE,t=70*window.GameConfig.RESIZE;this.configHeight=40*window.GameConfig.RESIZE;var n={x:35,y:22,nameAtlas:"mailSprites",nameSprite:"R_Chat_Violet",left:25,right:25,top:25,bot:25,width:0,height:0,name:"messageYour"};n.width=(this.text.width+e)/window.GameConfig.RESIZE,n.height=(this.text.height+e)/window.GameConfig.RESIZE,this.bg=new Zt(n),this.bgText.addChild(this.bg),this.text.x=this.bg.x+e/2,this.text.y=this.bg.y+e/2,this.addTimeSent(),1==this.isLastMess?this.height=this.bg.height+this.configHeight:this.height=this.bg.height+3,this.width=this.bg.width+t,this.bgText.x=window.GameConfig.GAME_WIDTH-this.width,this.text.x+=window.GameConfig.GAME_WIDTH-this.width,this.bg.inputEnabled=!0,this.bg.events.onInputUp.add(this.showTime,this)}},{key:"showTime",value:function(){0==this.checkShowTime?(this.event.showTime.dispatch(this.index),this.txtTime.revive(),this.checkShowTime=!0):(this.event.hideTime.dispatch(this.index),this.txtTime.kill(),this.checkShowTime=!1)}},{key:"setPosMess",value:function(e){void 0!==e?e.type==Ll.THEIR_MESS&&(this.height=this.bg.height+this.configHeight):this.height=this.bg.height+this.configHeight}},{key:"addTimeSent",value:function(){this.timeValue=this.handleTime(),this.txtTime=new Phaser.Text(game,this.positionMenuConfig.chat_screen.txt_mess_time.x*window.GameConfig.RESIZE,this.bg.height+this.positionMenuConfig.chat_screen.txt_mess_time.y*window.GameConfig.RESIZE,"".concat(this.timeValue[1]," - ").concat(this.timeValue[0]),this.positionMenuConfig.chat_screen.txt_mess_time.style),this.addChild(this.txtTime),this.txtTime.kill()}},{key:"handleTime",value:function(){var e=new Date(this.timeValue).toISOString().split("T");return e[1]=e[1].split(".000Z"),e[1]=e[1][0],[e[0],e[1]]}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&hl(n.prototype,i),o&&hl(n,o),t}();function pl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var gl=function(){function e(t,n,i,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.thumbUrl=o,this.index=a,this.sprite=game.add.sprite(t,n,"songDetailSprites",i),this.event={loadAvaDone:new Phaser.Signal},this.loadUrl()}var t,n,i;return t=e,(n=[{key:"loadUrl",value:function(){if(game.cache.checkImageKey(this.thumbUrl))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.thumbUrl,this.thumbUrl),e.start()}}},{key:"loadStart",value:function(){}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.thumbUrl)?(""!==e.thumbUrl?e.sprite.loadTexture(e.thumbUrl):e.sprite.loadTexture("songDetailSprites","ava-default"),e.event.loadAvaDone.dispatch(e.thumbUrl)):e.event.loadAvaDone.dispatch(e.thumbUrl)}catch(e){}},100*this.index)}}])&&pl(t.prototype,n),i&&pl(t,i),e}();function yl(e){return(yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ml(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vl(e,t){return!t||"object"!==yl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wl(e){return(wl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bl(e,t){return(bl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sl=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ll.YOUR_MESS,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=vl(this,wl(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),i.friend=e,i.txtMess=":)"==n||"(:"==n?"(smile)":":("==n||"):"==n?"(sad)":n,i.beforeType=o,i.timeValue=a,i.checkShowTime=!1,i.isLastMess=s,i.index=0,i.event={clickAva:new Phaser.Signal,showTime:new Phaser.Signal,hideTime:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bl(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.bgText=new Phaser.Group(game),this.addChild(this.bgText),this.text=new St(this.positionMenuConfig.chat_screen.txt_mess_friend,this.txtMess),this.addChild(this.text),this.beforeType==Ll.YOUR_MESS&&this.addAvaCircle();var e=40*window.GameConfig.RESIZE,t=35*window.GameConfig.RESIZE,n=70*window.GameConfig.RESIZE;this.configHeight=40*window.GameConfig.RESIZE;var i={x:77,y:22,nameAtlas:"mailSprites",nameSprite:"L_Chat_White",left:25,right:25,top:25,bot:25,width:0,height:0,name:"messageTheir"};i.width=(this.text.width+e)/window.GameConfig.RESIZE,i.height=(this.text.height+e)/window.GameConfig.RESIZE,this.bg=new Zt(i),this.bgText.addChild(this.bg),this.text.x=this.bg.x+e/2,this.text.y=this.bg.y+e/2,this.addTimeSent(),1==this.isLastMess?this.height=this.bg.height+this.configHeight:this.height=this.bg.height+3,this.width=this.bg.width+n,this.bgText.x=t,this.text.x+=t,this.ava&&(this.ava.x+=t,this.maskAva.x+=t),this.bg.inputEnabled=!0,this.bg.events.onInputUp.add(this.showTime,this)}},{key:"setPosMess",value:function(e){void 0!==e?e.type==Ll.YOUR_MESS&&(this.height=this.bg.height+this.configHeight):this.height=this.bg.height+this.configHeight}},{key:"addAvaCircle",value:function(){var e=this;this.ava=new gl(this.positionMenuConfig.chat_screen.ava_friend.x*window.GameConfig.RESIZE,this.positionMenuConfig.chat_screen.ava_friend.y*window.GameConfig.RESIZE,"ava-default",this.friend.avatar),this.ava.sprite.inputEnabled=!0,this.ava.sprite.events.onInputUp.add(this.clickAva,this),this.ava.event.loadAvaDone.add(function(){e.ava.sprite.width=70,e.ava.sprite.height=70},this),this.addChild(this.ava.sprite),this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(16777215),this.maskAva.drawCircle(35*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,69*window.GameConfig.RESIZE),this.maskAva.anchor.set(.5),this.addChild(this.maskAva),this.ava.sprite.mask=this.maskAva}},{key:"clickAva",value:function(){iC.instance().addUserProfile(this.friend.id),this.event.clickAva.dispatch()}},{key:"showTime",value:function(){0==this.checkShowTime?(this.event.showTime.dispatch(this.index),this.txtTime.revive(),this.checkShowTime=!0):(this.event.hideTime.dispatch(this.index),this.txtTime.kill(),this.checkShowTime=!1)}},{key:"addTimeSent",value:function(){this.timeValue=this.handleTime(),this.txtTime=new Phaser.Text(game,this.positionMenuConfig.chat_screen.txt_mess_time_their.x*window.GameConfig.RESIZE,this.bg.height+this.positionMenuConfig.chat_screen.txt_mess_time_their.y*window.GameConfig.RESIZE,"".concat(this.timeValue[1]," - ").concat(this.timeValue[0]),this.positionMenuConfig.chat_screen.txt_mess_time_their.style),this.addChild(this.txtTime),this.txtTime.kill()}},{key:"handleTime",value:function(){var e=new Date(this.timeValue).toISOString().split("T");return e[1]=e[1].split(".000Z"),e[1]=e[1][0],[e[0],e[1]]}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&ml(n.prototype,i),o&&ml(n,o),t}();function _l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var El=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.coreUrl=window.RESOURCE.admin_domain,this.mainUrl="",this.method="",this.params={}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.ajaxServer||(this.ajaxServer=new e),this.ajaxServer}},{key:"LIMIT_10",get:function(){return 20}},{key:"OFF_SET_0",get:function(){return 0}}],(n=[{key:"sendData",value:function(e){$.ajax({type:this.method,url:this.mainUrl,data:this.params,dataType:"JSON",success:function(t){e(t)},error:function(e){LogConsole.log(e)}})}},{key:"countMessage",value:function(e){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/countMessage"),this.params={user_id:e,token:z.instance().token},this.method="GET"}},{key:"listConversation",value:function(e,t,n,i){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/listConversation"),this.params={user_from:e,user_to:t,limit:n,offset:i,token:z.instance().token},this.method="GET"}},{key:"listMessage",value:function(e,t,n){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/getMessenger"),this.params={user_id:e,limit:t,offset:n,token:z.instance().token},this.method="GET"}},{key:"sendMessage",value:function(e,t,n){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/sendMessenger"),this.params={user_from:e,user_to:t,message:n,token:z.instance().token},this.method="GET"}},{key:"getNotiSystem",value:function(e,t,n){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/getNotification"),this.params={user_id:e,limit:t,offset:n,token:z.instance().token},this.method="GET"}},{key:"seeNoticeSystem",value:function(e,t){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/seenNotification"),this.params={user_id:e,message_id:t,token:z.instance().token},this.method="GET"}},{key:"settingAccount",value:function(e,t,n,i,o){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/settingGame"),this.params={user_id:e,user_name:t,gender:n,avatar:i,description:o,token:z.instance().token},this.method="POST"}},{key:"cleanData",value:function(){this.coreUrl=window.RESOURCE.admin_domain,this.mainUrl="",this.method="",this.params={}}}])&&_l(t.prototype,n),i&&_l(t,i),e}();function Cl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.ajaxMessages||(this.ajaxMessages=new e),this.ajaxMessages}}],(n=[{key:"countMessage",value:function(e,t){for(var n=0,i=0;i<e.length;i++)e[i].to==mZ.instance().dataMySeft.user_id&&0==e[i].is_read&&n++;for(var o=0;o<t.length;o++)0==t[o].is_read&&n++;return n}},{key:"countNewMessages",value:function(e){if(e){for(var t=0,n=0;n<e.length;n++)e[n].to==mZ.instance().dataMySeft.user_id&&0==e[n].is_read&&t++;return t}}},{key:"countSystemMessages",value:function(e){if(e){for(var t=0,n=0;n<e.length;n++)0==e[n].is_read&&t++;return t}}},{key:"listConversation",value:function(e){for(var t=[],n=[],i=0;i<e.dataMessages.length;i++)if(e.dataMessages[i].from!==mZ.instance().dataMySeft.user_id){for(var o=!1,a=0;a<n.length;a++)e.dataMessages[i].from===n[a]&&(o=!0);0==o&&n.push(e.dataMessages[i].from)}for(var s=0;s<e.dataMessages.length;s++)if(e.dataMessages[s].to!==mZ.instance().dataMySeft.user_id){for(var r=!1,l=0;l<n.length;l++)e.dataMessages[s].to===n[l]&&(r=!0);0==r&&n.push(e.dataMessages[s].to)}for(var h=0;h<n.length;h++){var c=this.getLastestConversation(n[h],e.dataMessages);t.push(c)}for(var u=function(n){if(t[n].from==mZ.instance().dataMySeft.user_id){var i=e.users.find(function(e){return e.id==t[n].to});t[n].user=i}if(t[n].to==mZ.instance().dataMySeft.user_id){var o=e.users.find(function(e){return e.id==t[n].from});t[n].user=o}},d=0;d<t.length;d++)u(d);return t.sort(function(e,t){if(e.updated>t.updated)return-1}),t}},{key:"getLastestConversation",value:function(e,t){for(var n={created:0,from:0,id:0,is_read:0,message:"",state:"",to:0,updated:0},i=t.length-1;i>=0;i--)if(e===t[i].from||e===t[i].to){var o=t[i];n.updated<o.updated&&(n=o)}return n}},{key:"listMessage",value:function(e,t){for(var n=[],i=0;i<e.length;i++)e[i].from!=t.id&&e[i].to!=t.id||n.push(e[i]);return n.sort(function(e,t){if(e.updated<t.updated)return 1}),function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){Cl(e,t,n[t])})}return e}({},n)}},{key:"sendMessage",value:function(e,t){var n=new SFS2X.SFSObject;n.putInt("to",e),n.putUtfString("message",t),mZ.instance().sendData(Et.USER_MESSAGE_SEND_REQUEST,n)}},{key:"sendMarkAsRead",value:function(e){var t=new SFS2X.SFSObject;t.putInt("user_id",e),mZ.instance().sendData(Et.USER_MESSAGE_MARK_AS_READ_REQUEST,t)}},{key:"markAsRead",value:function(e,t){var n=[];for(var i in t)t[i].from!=e.id&&t[i].to!=e.id||(t[i].is_read=1),n.push(t[i]);z.instance().dataMessagesLocal.dataMessages=n,Qr.instance().removeItem("data_messages"),Qr.instance().setItem("data_messages",JSON.stringify(z.instance().dataMessagesLocal))}},{key:"getNotiSystem",value:function(e){return e.reverse()}},{key:"seeNoticeSystem",value:function(e,t){for(var n=null,i=0;i<t.length;i++)if(t[i].message_content_id==e){n=t[i];break}return n}},{key:"sendSystemMarkAsRead",value:function(e){var t=new SFS2X.SFSObject;t.putLong("message_content_id",e),mZ.instance().sendData(Et.SYSTEM_MESSAGE_MARK_AS_READ_REQUEST,t)}},{key:"systemMarkAsRead",value:function(e,t){for(var n=[],i=0;i<t.length;i++)t[i].message_content_id==e&&(t[i].is_read=1),n.push(t[i]);z.instance().systemMessagesLocal.dataMessages=n.reverse(),Qr.instance().removeItem("system_messages"),Qr.instance().setItem("system_messages",JSON.stringify(z.instance().systemMessagesLocal))}}])&&kl(t.prototype,n),i&&kl(t,i),e}();function Ol(e){return(Ol="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Tl(e,t){return!t||"object"!==Ol(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Il(e){return(Il=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Al(e,t){return(Al=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ll=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Tl(this,Il(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.friend=e,n.clickAvaFriend=!1,n.countMessSend=0,n.afterInit(),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Al(e,t)}(t,Phaser.Group),n=t,a=[{key:"YOUR_MESS",get:function(){return"YOUR_MESS"}},{key:"THEIR_MESS",get:function(){return"THEIR_MESS"}}],(o=[{key:"afterInit",value:function(){this.listView=null,this.heightDefault=144,this.listMessageOld=[],this.isHasNewMess=!1,this.bg,this.headerTab,this.scrollListChat,this.boxKeyboard,this.addBG(),this.addScrollListChat(),this.ajaxGetMessages(),this.addBoxKeyboard(),this.addEventExtension(),this.addHeaderTab()}},{key:"ajaxGetMessages",value:function(){this.onGetListConversationCallback(Pl.instance().listMessage(z.instance().dataMessagesLocal.dataMessages,this.friend))}},{key:"onGetListConversationCallback",value:function(e){this.listMessageNew=[],qe.instance().hideLoading();var n=[];for(var i in e)n.push(e[i]);for(var o=[],a=(n=n.length>20?n.slice(n.length-20).reverse():n.reverse()).length;a>0;a--){var s=n[a-1];s.from==this.friend.id?s.type=t.THEIR_MESS:s.type=t.YOUR_MESS,o.push(s)}if(this.listMessageNew=o,this.listMessageOld.length>19)if(this.listMessageNew[this.listMessageNew.length-1].message==this.listMessageOld[this.listMessageOld.length-1].message&&this.listMessageNew[this.listMessageNew.length-1].created==this.listMessageOld[this.listMessageOld.length-1].created);else for(var r=this.listMessageNew.length;r>0;r--)if(this.listMessageNew[r-1].message==this.listMessageOld[this.listMessageOld.length-1].message&&this.listMessageNew[r-1].created==this.listMessageOld[this.listMessageOld.length-1].created){this.listMessageOld.splice(0,this.listMessageNew.length-r);break}this.addListMess()}},{key:"addBG",value:function(){this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg)}},{key:"addHeaderTab",value:function(){this.headerTab=new Phaser.Group(game,0,0),this.tab=new rt(this.positionMenuConfig.chat_screen.header.tab),this.headerTab.addChild(this.tab),this.btnBack=new pt(this.positionMenuConfig.chat_screen.header.back,this.onBack,this),this.btnBack.anchor.set(.5),this.headerTab.addChild(this.btnBack),this.nameFriend=new St(this.positionMenuConfig.chat_screen.header.name,this.friend.user_name),this.nameFriend.anchor.set(.5),this.headerTab.addChild(this.nameFriend),this.addChild(this.headerTab)}},{key:"onBack",value:function(){0==this.clickAvaFriend?this.destroy():this.clickAvaFriend=!1}},{key:"addScrollListChat",value:function(){this.removeScrollListChat(),this.group=new Phaser.Group(game),this.addChild(this.group);var e=new Phaser.Rectangle(0,0*window.GameConfig.RESIZE,game.width,(game.height-this.heightDefault-30)*window.GameConfig.RESIZE);this.group.y=66,this.listView=new Jo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}},{key:"removeScrollListChat",value:function(){null!==this.listView&&(this.removeChild(this.group),this.group.remove(this.listView),this.listView.removeAll(),this.listView.destroy(),this.listView=null,this.group=null)}},{key:"addListMess",value:function(){for(var e=this.listMessageOld.length;e<this.listMessageNew.length;e++){this.isHasNewMess=!0;var n=!1;if(e==this.listMessageNew.length-1&&(n=!0),this.listMessageNew[e].type==t.YOUR_MESS){e>0&&e===this.listMessageOld.length&&this.listMessageNew[e-1].type==t.THEIR_MESS&&(this.listView.grp.children[this.listView.grp.children.length-1].height=this.listView.grp.children[this.listView.grp.children.length-1].bg.height+40);var i=new fl(this.listMessageNew[e].message,this.listMessageNew[e].created,n);i.event.showTime.add(this.onClickShowTime,this),i.event.hideTime.add(this.onHideTimeItem,this),i.setPosMess(this.listMessageNew[e+1]),this.listView.add(i),i.index=this.listView.grp.children.length-1}else if(e>0){this.listMessageNew[e-1].type==t.THEIR_MESS&&(this.listView.grp.children[this.listView.grp.children.length-1].height=this.listView.grp.children[this.listView.grp.children.length-1].bg.height+3);var o=new Sl(this.friend,this.listMessageNew[e].message,this.listMessageNew[e-1].type,this.listMessageNew[e].created,n);o.event.clickAva.add(this.onClickAvaFr,this),o.event.showTime.add(this.onClickShowTime,this),o.event.hideTime.add(this.onHideTimeItem,this),o.setPosMess(this.listMessageNew[e+1]),this.listView.add(o),o.index=this.listView.grp.children.length-1}else{var a=new Sl(this.friend,this.listMessageNew[e].message,t.YOUR_MESS,this.listMessageNew[e].created,n);a.event.clickAva.add(this.onClickAvaFr,this),a.event.showTime.add(this.onClickShowTime,this),a.event.hideTime.add(this.onHideTimeItem,this),a.setPosMess(this.listMessageNew[e+1]),this.listView.add(a),a.index=this.listView.grp.children.length-1}this.listMessageOld.push(this.listMessageNew[e])}1==this.isHasNewMess&&(this.isHasNewMess=!1,this.listView.grp.children.length>0&&this.listView.tweenToItem(this.listView.grp.children.length-1)),this.listMessageOld[this.listMessageOld.length-1]&&0==this.listMessageOld[this.listMessageOld.length-1].is_read&&Pl.instance().sendMarkAsRead(this.friend.id),Pl.instance().markAsRead(this.friend,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){Rl(e,t,n[t])})}return e}({},z.instance().dataMessagesLocal.dataMessages))}},{key:"onClickShowTime",value:function(e){for(i=e;i<this.listView.grp.children.length-1;i++){game.add.tween(this.listView.grp.children[i+1]).to({y:this.listView.grp.children[i+1].y+30},100,"Linear",!0).start()}}},{key:"onHideTimeItem",value:function(e){for(i=e;i<this.listView.grp.children.length-1;i++){game.add.tween(this.listView.grp.children[i+1]).to({y:this.listView.grp.children[i+1].y-30},100,"Linear",!0).start()}}},{key:"onClickAvaFr",value:function(){this.clickAvaFriend=!0,this.destroy()}},{key:"addBoxKeyboard",value:function(){this.boxKeyboard=new rt(this.positionMenuConfig.chat_screen.keyboard.bg),this.boxKeyboard.y=game.height-107,this.addChild(this.boxKeyboard),this.whiteSpace=new Zt(this.positionMenuConfig.chat_screen.white_space),this.boxKeyboard.addChild(this.whiteSpace);var e=new St(this.positionMenuConfig.chat_screen.txt_white_space,this.positionMenuConfig.chat_screen.txt_white_space.text);this.whiteSpace.addChild(e),this.btnSend=new pt(this.positionMenuConfig.chat_screen.btn_send,this.onClickSend,this),this.boxKeyboard.addChild(this.btnSend),this.boxKeyboard.inputEnabled=!0,this.boxKeyboard.events.onInputUp.add(this.inputKeyboard,this)}},{key:"onClickSend",value:function(){this.keyboardDone()}},{key:"inputKeyboard",value:function(){ce.instance().playSound(ce.buttonclick);var e={maxLength:"",showTransparent:!0,placeholder:"Nhắn tin",isSearch:!1,typeInputText:"input",configText:{width:this.whiteSpace.width,height:this.whiteSpace.height,x:this.boxKeyboard.x+36,y:this.boxKeyboard.y+21}};rl.instance().show(e)}},{key:"keyboardClose",value:function(){rl.instance().hide(),this.boxKeyboard.revive(),this.heightDefault=144,this.listMessageOld=[],this.addScrollListChat(),this.addListMess()}},{key:"keyboardDone",value:function(){this.message=rl.instance().getValue(),this.addNewMessage(),rl.instance().setValue("")}},{key:"hideKeyboard",value:function(){this.keyboardClose()}},{key:"addNewMessage",value:function(){qe.instance().showLoading(),Pl.instance().sendMessage(this.friend.id,this.message)}},{key:"handleNewTime",value:function(){var e=(new Date).toISOString().split("T");return e[1]=e[1].split(".000Z"),e[1]=e[1][0],e[0]+" "+e[1]}},{key:"onSendSuccess",value:function(e){this.listView.grp.children.length>0&&(this.listView.grp.children[this.listView.grp.children.length-1].height=this.listView.grp.children[this.listView.grp.children.length-1].bg.height+3)}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this),rl.instance().event.changeHeight.add(this.onChangeHeightKeyboard,this),rl.instance().event.cancle.add(this.keyboardClose,this),rl.instance().event.enter.add(this.keyboardDone,this),rl.instance().event.submit.add(this.keyboardDone,this),rl.instance().event.hideKeyboard.add(this.hideKeyboard,this),mZ.instance().events.onExtensionResponse.add(this.onExtensionResponse,this),De.instance().event.newMessage.add(this.newMessage,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this),rl.instance().event.changeHeight.remove(this.onChangeHeightKeyboard,this),rl.instance().event.cancle.remove(this.keyboardClose,this),rl.instance().event.enter.remove(this.keyboardDone,this),rl.instance().event.submit.remove(this.keyboardDone,this),rl.instance().event.hideKeyboard.remove(this.hideKeyboard,this),mZ.instance().events.onExtensionResponse.remove(this.onExtensionResponse,this),De.instance().event.newMessage.remove(this.newMessage,this)}},{key:"newMessage",value:function(){this.ajaxGetMessages()}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.USER_MESSAGE_SEND_RESPONSE&&"OK"==e.params.getUtfString("status")&&(this.onSendSuccess(),De.instance().callMessageFromChatScreen=!0,mZ.instance().sendRequestDataMessages()),e.cmd==Et.USER_MESSAGE_LOAD_RESPONSE&&e.params.getUtfString("status")}},{key:"onChangeHeightKeyboard",value:function(e){var t={maxLength:"",showTransparent:!0,placeholder:"Nhắn tin",isSearch:!1,typeInputText:"chat",configText:{width:this.whiteSpace.width,height:this.whiteSpace.height,x:this.boxKeyboard.x+35,y:this.boxKeyboard.y+17}};rl.instance().show(t),this.listMessageOld=[],this.heightDefault=e+35,this.addScrollListChat(),this.addListMess()}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.keyboardClose(),De.instance().event.backChat.dispatch(),null!==this.listView&&(this.listView.removeAll(),this.listView.destroy(),this.listView=null),game.time.events.remove(this.timeCounting);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&xl(n.prototype,o),a&&xl(n,a),t}();function Gl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Dl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sound=null,this.playId=null,this.isLoading=!1,this.src="",this.event={loadComplete:new Phaser.Signal,playSoundComplete:new Phaser.Signal,loadFail:new Phaser.Signal},this.currentLoad=null,this.dic={},this.arrSrc=[],this.idxLoad=0,this.idDelayCall=null}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllSound||(this.controllSound=new e),this.controllSound}}],(n=[{key:"loadSound",value:function(e){var t=this;console.log("loadSound : ------- : "+e),this.dic[e]=new Howl({src:[Un.instance().genUrlSound(e)]}),this.dic[e].once("load",function(e){t.event.loadComplete.dispatch()}),this.dic[e].once("loaderror",function(){console.log("load fail------------------- : "+e),t.loadSound(e),t.event.loadFail.dispatch()})}},{key:"loadSoundArray",value:function(e){!1===this.isLoading&&(this.src="",this.arrSrc=e,this.isLoading=!0,this.idxLoad=0,this.loadItemInArray(this.arrSrc[this.idxLoad]),this.removeDelayCall(),this.idDelayCall=game.time.events.add(30*Phaser.Timer.SECOND,this.callLoadFail,this))}},{key:"removeDelayCall",value:function(){null!==this.idDelayCall&&(game.time.events.remove(this.idDelayCall),this.idDelayCall=null)}},{key:"callLoadFail",value:function(){this.event.loadFail.dispatch(),this.removeAllSound()}},{key:"loadItemInArray",value:function(e){var t=this;this.dic[e]?this.checkLoadContinuteArray():(this.dic[e]=new Howl({src:[Un.instance().genUrlSound(e)]}),this.dic[e].once("load",function(){t.checkLoadContinuteArray()}),this.dic[e].once("loaderror",function(){t.idxLoad--,t.checkLoadContinuteArray()}))}},{key:"checkLoadContinuteArray",value:function(){LogConsole.log("cccccccheckLoadContinuteArray"),this.idxLoad++,this.idxLoad<this.arrSrc.length?this.loadItemInArray(this.arrSrc[this.idxLoad]):(LogConsole.log("checkLoadContinuteArray"),this.isLoading=!1,this.event.loadComplete.dispatch(),this.removeDelayCall())}},{key:"playsound",value:function(e){!1===game.paused&&(this.removeSound(),this.src=e,console.log(" playsound :  "+this.src),console.log(this.dic),"ctx"in Howler&&null!==Howler.ctx&&("suspended"!==Howler.ctx.state&&"interrupted"!==Howler.ctx.state||Howler.ctx.resume()),this.dic.hasOwnProperty(e)?(console.log("load roi ---------"),this.sound=this.dic[e],this.playId=this.sound.play()):(console.log("chua load ---------"),this.sound=this.dic[e]=new Howl({src:[Un.instance().genUrlSound(e)]}),this.sound.once("end",function(){console.log("Finish play")}),this.playId=this.sound.play()),this.sound.volume(1))}},{key:"pauseSound",value:function(){!1===game.paused&&null!=this.sound&&this.sound.pause(this.playId)}},{key:"resumeSound",value:function(){!1===game.paused&&null!=this.sound&&this.sound.play(this.playId)}},{key:"removeAllSound",value:function(){for(var e in console.log("removeAllSound--------"),this.dic){var t=this.dic[e];t.stop(),t.unload(),t=null}this.dic={},this.isLoading=!1,this.removeSound(),this.src="",null!==this.currentLoad&&(this.currentLoad.stop(this.playId),this.currentLoad.unload(),this.currentLoad=null)}},{key:"removeSound",value:function(){if(console.log("removeSound : "+this.src),null!==this.sound&&(this.sound.stop(this.playId),this.sound.unload(),this.sound=null),""!==this.src&&this.dic[this.src]){var e=this.dic[this.src];e.stop(),e.unload(),e=null,delete this.dic[this.src],this.src=""}}},{key:"removeSoundFromUrl",value:function(e){if(console.log("removeSoundFromUrl---------------- : "+e),""!==e&&this.dic[e]){var t=this.dic[e];t.stop(),t.unload(),t=null,delete this.dic[e]}}}])&&Gl(t.prototype,n),i&&Gl(t,i),e}();function Ml(e){return(Ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bl(e,t){return!t||"object"!==Ml(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jl(e){return(jl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ul(e,t){return(Ul=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fl=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Bl(this,jl(t).call(this,game,e,n,null))).ava,o.btnPlay,o.btnPause,o.nameSong,o.nameSinger,o.checkAudioStop=!1,o.configsValue=i,o.songListen,o.urlSong=o.configsValue.listenLink,o.key="",o.isPlay=!1,o.tween,o.spriteTween,o.songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ul(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addAva(this.songDetailScreenConfig.songDetail.ava),this.addNameSong(this.songDetailScreenConfig.songDetail.nameSong),this.addNameSinger(this.songDetailScreenConfig.songDetail.nameSinger),this.loadToPlay()}},{key:"loadToPlay",value:function(){if(this.checkAudioStop=!1,game.cache.checkSoundKey(this.urlSong))this.onLoadAudio();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadComplete.addOnce(this.onLoadAudio,this),Dl.instance().loadSound(this.urlSong),e.start()}}},{key:"addAva",value:function(e){this.ava=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.ava.scale.set(1*window.GameConfig.RESIZE),this.ava.anchor.set(.5,0),this.addChild(this.ava);var t=new Phaser.Graphics(game,0,0);t.beginFill(16777215),t.drawRoundedRect((e.x-118)*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,237*window.GameConfig.RESIZE,237*window.GameConfig.RESIZE,15),t.anchor.set(.5),this.addChild(t),this.ava.mask=t,this.beginLoad(this.configsValue.thumb)}},{key:"beginLoad",value:function(e){if(e&&(this.key=e),game.cache.checkImageKey(this.key))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadComplete.add(this.onLoad,this),t.image(this.key,this.key),t.start()}}},{key:"onLoad",value:function(){game.cache.checkImageKey(this.key)&&this.ava.loadTexture(this.key)}},{key:"addBtnPlayAndPause",value:function(e){this.btnPlay=new Phaser.Sprite(game,e.btn_play.x*window.GameConfig.RESIZE,e.btn_play.y*window.GameConfig.RESIZE,e.btn_play.nameAtlas,e.btn_play.nameSprite),this.btnPlay.inputEnabled=!0,this.btnPlay.events.onInputUp.add(this.onPlay,this),this.btnPause=new Phaser.Sprite(game,e.btn_pause.x*window.GameConfig.RESIZE,e.btn_pause.y*window.GameConfig.RESIZE,e.btn_pause.nameAtlas,e.btn_pause.nameSprite),this.btnPause.inputEnabled=!0,this.btnPause.events.onInputUp.add(this.onPause,this),this.btnPause.kill(),this.addChild(this.btnPlay),this.addChild(this.btnPause)}},{key:"onPlay",value:function(){ce.instance().playSound(ce.buttonclick),this.isPlay?(this.tween.resume(),Dl.instance().resumeSound(this.urlSong)):(this.spriteTween=new Phaser.Sprite(game,this.ava.x-118*window.GameConfig.RESIZE,this.ava.y+237*window.GameConfig.RESIZE,"otherSprites","tween-time"),this.addChild(this.spriteTween),this.tween=game.add.tween(this.spriteTween.scale).to({x:27,y:1},10500,"Linear"),Dl.instance().playsound(this.urlSong),this.tween.start(),this.tween.onComplete.add(this.tweenComplete,this),this.checkAudioStop=!1,this.isPlay=!0),this.btnPlay.kill(),this.btnPause.revive()}},{key:"onPause",value:function(){ce.instance().playSound(ce.buttonclick),this.tween.pause(),Dl.instance().pauseSound(this.urlSong),this.btnPlay.revive(),this.btnPause.kill()}},{key:"onLoadAudio",value:function(){this.addBtnPlayAndPause(this.songDetailScreenConfig.songDetail)}},{key:"tweenComplete",value:function(){null!==this.spriteTween&&(this.spriteTween.destroy(),this.spriteTween=null,this.stopAudio())}},{key:"stopAudio",value:function(){0==this.checkAudioStop&&(this.checkAudioStop=!0,this.isPlay=!1,this.btnPause.kill(),this.btnPlay.revive(),Dl.instance().removeSound(this.urlSong))}},{key:"removeMethod",value:function(){Dl.instance().removeAllSound(),LogConsole.log(this.songListen)}},{key:"addNameSong",value:function(e){this.nameSong=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.configsValue.song,e.configs),this.nameSong.anchor.set(.5,0),this.addChild(this.nameSong)}},{key:"addNameSinger",value:function(e){this.nameSinger=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.configsValue.singer,e.configs),this.nameSinger.anchor.set(.5,0),this.addChild(this.nameSinger)}}])&&Nl(n.prototype,i),o&&Nl(n,o),t}();function Zl(e){return(Zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ql(e,t){return!t||"object"!==Zl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vl(e){return(Vl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wl(e,t){return(Wl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ql=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Ql(this,Vl(t).call(this,game,e,n,null))).songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),o.iconShareActive,o.txtShareActive,o.btnShareActive,o.btnShareDisactive,o.txtShareDisactive,o.iconShareDisactive,o.configsValue=i,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wl(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addDisactive(this.songDetailScreenConfig.btn_share.disactive),this.addActive(this.songDetailScreenConfig.btn_share.active)}},{key:"addDisactive",value:function(e){this.btnShareDisactive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnShareDisactive.inputEnabled=!0,this.btnShareDisactive.events.onInputUp.addOnce(this.onActive,this),this.addChild(this.btnShareDisactive),this.iconShareDisactive=new Phaser.Sprite(game,e.icon.x*window.GameConfig.RESIZE,e.icon.y*window.GameConfig.RESIZE,e.icon.nameAtlas,e.icon.nameSprite),this.btnShareDisactive.addChild(this.iconShareDisactive),this.txtShareDisactive=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs),this.btnShareDisactive.addChild(this.txtShareDisactive)}},{key:"addActive",value:function(e){this.btnShareActive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnShareActive.kill(),this.addChild(this.btnShareActive),this.iconShareActive=new Phaser.Sprite(game,e.icon.x*window.GameConfig.RESIZE,e.icon.y*window.GameConfig.RESIZE,e.icon.nameAtlas,e.icon.nameSprite),this.btnShareActive.addChild(this.iconShareActive),this.txtShareActive=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs),this.btnShareActive.addChild(this.txtShareActive)}},{key:"onActive",value:function(){ce.instance().playSound(ce.buttonclick),this.btnShareDisactive.destroy(),this.btnShareActive.revive()}}])&&Hl(n.prototype,i),o&&Hl(n,o),t}();function Kl(e){return(Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yl(e,t){return!t||"object"!==Kl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jl(e){return(Jl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xl(e,t){return(Xl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $l=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Yl(this,Jl(t).call(this,game,e,n,null))).songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),o.iconLikeActive,o.txtLikeActive,o.btnLikeActive,o.btnLikeDisactive,o.txtLikeDisactive,o.iconLikeDisactive,o.configsValue=i,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xl(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addDisactive(this.songDetailScreenConfig.btn_like.disactive),this.addActive(this.songDetailScreenConfig.btn_like.active)}},{key:"addDisactive",value:function(e){this.btnLikeDisactive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnLikeDisactive.inputEnabled=!0,this.btnLikeDisactive.events.onInputUp.addOnce(this.onActive,this),this.addChild(this.btnLikeDisactive),this.iconLikeDisactive=new Phaser.Sprite(game,e.icon.x*window.GameConfig.RESIZE,e.icon.y*window.GameConfig.RESIZE,e.icon.nameAtlas,e.icon.nameSprite),this.btnLikeDisactive.addChild(this.iconLikeDisactive),this.txtLikeDisactive=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs),this.btnLikeDisactive.addChild(this.txtLikeDisactive)}},{key:"addActive",value:function(e){this.btnLikeActive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnLikeActive.kill(),this.addChild(this.btnLikeActive),this.iconLikeActive=new Phaser.Sprite(game,e.icon.x*window.GameConfig.RESIZE,e.icon.y*window.GameConfig.RESIZE,e.icon.nameAtlas,e.icon.nameSprite),this.btnLikeActive.addChild(this.iconLikeActive),this.txtLikeActive=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs),this.btnLikeActive.addChild(this.txtLikeActive)}},{key:"onActive",value:function(){ce.instance().playSound(ce.buttonclick),this.btnLikeDisactive.destroy(),this.btnLikeActive.revive()}}])&&zl(n.prototype,i),o&&zl(n,o),t}();function eh(e){return(eh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function th(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nh(e,t){return!t||"object"!==eh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ih(e){return(ih=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oh(e,t){return(oh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ah=function(e){function t(e,n,i){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=nh(this,ih(t).call(this,game,e,n,null))).configsValue=i,o.linkMp3="",o.linkYoutube="";for(var a=0;a<o.configsValue.song_links.length;a++){var s=o.configsValue.song_links[a];s.link_type==uh.LINK_ZING_MP3&&(o.linkMp3=s.link),s.link_type==uh.LINK_YOUTUBE&&(o.linkYoutube=s.link)}return o.songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),o.txtListenFull,o.line,o.iconZing,o.iconYoutube,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oh(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addTxtListenFull(this.songDetailScreenConfig.otherOnBottom.txtListenFull),this.addLine(this.songDetailScreenConfig.otherOnBottom),this.addIconZing(this.songDetailScreenConfig.otherOnBottom.icon_zing),this.addIconYoutube(this.songDetailScreenConfig.otherOnBottom.icon_youtube)}},{key:"addTxtListenFull",value:function(e){this.txtListenFull=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtListenFull.anchor.set(.5,0),this.addChild(this.txtListenFull)}},{key:"addLine",value:function(e){this.line=new Phaser.Sprite(game,e.line_long.x*window.GameConfig.RESIZE,e.line_long.y*window.GameConfig.RESIZE,e.line_long.nameAtlas,e.line_long.nameSprite),this.line.anchor.set(.5,0);var t=new Phaser.Sprite(game,e.line.x*window.GameConfig.RESIZE,e.line.y*window.GameConfig.RESIZE,e.line.nameAtlas,e.line.nameSprite);t.anchor.set(.5),this.line.addChild(t),this.addChild(this.line)}},{key:"addIconZing",value:function(e){this.icon_zing=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.icon_zing.anchor.set(.5),this.icon_zing.inputEnabled=!0,this.icon_zing.events.onInputUp.add(this.clickZing,this),this.addChild(this.icon_zing)}},{key:"clickZing",value:function(){ce.instance().playSound(ce.buttonclick),"ios"!==z.instance().platform?window.open(this.linkMp3,"_blank"):iC.instance().addDialog("Hệ thống đang phát triển tính năng. Bạn vui lòng quay lại sau nhé!")}},{key:"addIconYoutube",value:function(e){this.icon_youtube=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.icon_youtube.anchor.set(.5),this.icon_youtube.inputEnabled=!0,this.icon_youtube.events.onInputUp.add(this.clickYoutube,this),this.addChild(this.icon_youtube)}},{key:"clickYoutube",value:function(){ce.instance().playSound(ce.buttonclick),LogConsole.log("Youtube: ".concat(this.configsValue.songLink))}}])&&th(n.prototype,i),o&&th(n,o),t}();function sh(e){return(sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lh(e,t){return!t||"object"!==sh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hh(e){return(hh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ch(e,t){return(ch=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var uh=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=lh(this,hh(t).call(this,game,0,0,"bg_create_room")),LogConsole.log(e),n.songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),n.configsValue=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ch(e,t)}(t,Phaser.Button),n=t,o=[{key:"LINK_ZING_MP3",get:function(){return"mp3zing"}},{key:"LINK_YOUTUBE",get:function(){return"youtube"}}],(i=[{key:"afterInit",value:function(){this.headerTab,this.songDetail,this.btnShare,this.btnLike,this.otherOnBottom,this.addHeaderTab(this.songDetailScreenConfig.header),this.addSongDetail(),this.addBtnShare(),this.addBtnLike(),this.addOtherOnBottom(),li.instance().showBanerInfoSongScreen()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.borderDiamond,this.diamond,this.txtDiamond,this.addButtonBack(e),this.addBorderDiamond(e),this.addDiamond(e)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.btn_back.x*window.GameConfig.RESIZE,e.btn_back.y*window.GameConfig.RESIZE,e.btn_back.nameAtlas,e.btn_back.nameSprite),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),this.destroy(),this.songDetail.removeMethod()}},{key:"addBorderDiamond",value:function(e){this.borderDiamond=new Phaser.Sprite(game,e.border_diamond.x*window.GameConfig.RESIZE,e.border_diamond.y*window.GameConfig.RESIZE,e.border_diamond.nameAtlas,e.border_diamond.nameSprite),this.headerTab.addChild(this.borderDiamond)}},{key:"addDiamond",value:function(e){this.diamond=new Phaser.Sprite(game,e.diamond.x*window.GameConfig.RESIZE,e.diamond.y*window.GameConfig.RESIZE,e.diamond.nameAtlas,e.diamond.nameSprite),this.borderDiamond.addChild(this.diamond),this.txtDiamond=new Phaser.Text(game,e.txt_diamond.x*window.GameConfig.RESIZE,e.txt_diamond.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,e.txt_diamond.configs),this.borderDiamond.addChild(this.txtDiamond)}},{key:"addSongDetail",value:function(){this.songDetail=new Fl(320*window.GameConfig.RESIZE,160*window.GameConfig.RESIZE,this.configsValue),this.addChild(this.songDetail)}},{key:"addBtnShare",value:function(){this.btnShare=new ql(35*window.GameConfig.RESIZE,535*window.GameConfig.RESIZE),this.addChild(this.btnShare)}},{key:"addBtnLike",value:function(){this.btnLike=new $l(329*window.GameConfig.RESIZE,535*window.GameConfig.RESIZE),this.addChild(this.btnLike)}},{key:"addOtherOnBottom",value:function(){this.otherOnBottom=new ah(0,705*window.GameConfig.RESIZE,this.configsValue),this.addChild(this.otherOnBottom)}},{key:"destroy",value:function(){for(li.instance().hideBanner();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&rh(n.prototype,i),o&&rh(n,o),t}();function dh(e){return(dh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ph(e,t,n){return(ph="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gh(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function gh(e){return(gh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yh(e,t){return(yh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var vh=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=gh(t).call(this,game,null))||"object"!==dh(i)&&"function"!=typeof i?mh(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.topBg=new rt(e.positionPopup.popup_confirm_top_bg),e.addChild(e.topBg),e.bgText=new Zt(e.positionPopup.popup_confirm_bg_text),e.addChild(e.bgText),e.btnOk=new ln(e.positionPopup.popup_confirm_button_ok,"ĐỒNG Ý",e.chooseOK,mh(mh(e))),e.addChild(e.btnOk),e.btnCancle=new ln(e.positionPopup.popup_confirm_button_cancle,"HỦY BỎ",e.chooseCancle,mh(mh(e))),e.addChild(e.btnCancle),e.txtContent=new St(e.positionPopup.popup_confirm_text_content,o),e.txtContent.setTextBounds(0,0,545*z.instance().scale,278*z.instance().scale),e.addChild(e.txtContent),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yh(e,t)}(t,Mt),n=t,(i=[{key:"setHeight",value:function(e){this.bgText.height=e,this.txtContent.setTextBounds(0,0,545*z.instance().scale,this.bgText.height-168*z.instance().scale),this.btnCancle.y=this.bgText.height-103*z.instance().scale,this.btnOk.y=this.bgText.height-103*z.instance().scale}},{key:"setTextCancle",value:function(e){this.btnCancle.setText(e)}},{key:"setTextOk",value:function(e){this.btnOk.setText(e)}},{key:"setContent",value:function(e){this.txtContent.setText(e)}},{key:"chooseOK",value:function(){LogConsole.log("chooseOK"),this.btnOk.inputEnabled=!1,this.btnCancle.inputEnabled=!1,this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){LogConsole.log("chooseCancle"),this.btnOk.inputEnabled=!1,this.btnCancle.inputEnabled=!1,this.event.CANCLE.dispatch()}},{key:"destroy",value:function(){this.topBg.destroy(),this.bgText.destroy(),this.btnOk.destroy(),this.btnCancle.destroy(),this.txtContent.destroy(),ph(gh(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.bgText.width}}])&&fh(n.prototype,i),o&&fh(n,o),t}();function wh(e){return(wh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Sh(e,t){return!t||"object"!==wh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _h(e){return(_h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eh(e,t){return(Eh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ch=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Sh(this,_h(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eh(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.ava=new _r,this.addChild(this.ava),this.maskAva=new Phaser.Graphics(game,this.ava.x,this.ava.x),this.maskAva.beginFill(16711680,1),this.maskAva.drawRoundedRect(this.ava.x,this.ava.y,this.ava.width,this.ava.height,10),this.maskAva.endFill(),this.addChild(this.maskAva),this.ava.mask=this.maskAva}},{key:"setSize",value:function(e,t){this.ava.setSize(e,t),this.maskAva.clear(),this.maskAva.beginFill(16711680,1),this.maskAva.drawRoundedRect(this.ava.x,this.ava.y,this.ava.width,this.ava.height,10),this.maskAva.endFill()}},{key:"beginLoad",value:function(e,t){this.ava.beginLoad(e,t)}},{key:"width",get:function(){return this.ava.width}},{key:"height",get:function(){return this.ava.height}}])&&bh(n.prototype,i),o&&bh(n,o),t}();function kh(e){return(kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ph(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oh(e,t){return!t||"object"!==kh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rh(e){return(Rh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xh(e,t){return(xh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Th=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Oh(this,Rh(t).call(this,game,null))).positionShop=n.mainData.positionDefaultSource,n.loaderPerc=0,n.beginLoad=!1,n.maxLoading=0,n.bg=new rt(e?n.positionShop.gennes_current_level_deactive1:n.positionShop.gennes_current_level_deactive),n.addChild(n.bg),n.bgLoading=new rt(e?n.positionShop.gennes_current_level_active1:n.positionShop.gennes_current_level_active),n.addChild(n.bgLoading),n.maskLoading=new Phaser.Graphics(game,n.bgLoading.width/2,n.bgLoading.height/2),n.maskLoading.anchor.setTo(.5,.5),n.addChild(n.maskLoading),n.bgLoading.mask=n.maskLoading,n.drawMask(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xh(e,t)}(t,Mt),n=t,(i=[{key:"drawMask",value:function(){this.maxLoading<100&&this.maxLoading>0&&(this.loaderPerc=this.maxLoading,this.maskLoading.clear(),this.maskLoading.beginFill(16777215),this.maskLoading.arc(0,0,this.bgLoading.width/2,this.game.math.degToRad(-220),this.game.math.degToRad(3.6*this.loaderPerc-220)),this.maskLoading.endFill())}},{key:"setMaxLoading",value:function(e){this.maxLoading=80*e/100,0===this.maxLoading&&(this.maxLoading=1),this.drawMask()}},{key:"width",get:function(){return this.bgLoading.width}}])&&Ph(n.prototype,i),o&&Ph(n,o),t}();function Ih(e){return(Ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ah(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Lh(e,t){return!t||"object"!==Ih(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gh(e){return(Gh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dh(e,t){return(Dh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mh=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Lh(this,Gh(t).call(this,game,null))).user=new Qs,e.setData(n,i),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dh(e,t)}(t,Mt),n=t,(i=[{key:"setData",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.user=Object.assign({},this.user,e),this.removeAllItem(),this.user.level<5){for(var n=0,i=0;i<5;i++){var o=null;if(i==e.level)(o=new Th(t)).setMaxLoading(100*(this.user.exp_score-this.user.current_level_score)/(this.user.next_level_score-this.user.current_level_score));else{var a={x:0,y:10,nameAtlas:"defaultSource",nameSprite:"LevelActive"};t?i<this.user.level?a.nameSprite="LevelActive1":a.nameSprite="LevelDeactive1":i<this.user.level?a.nameSprite="LevelActive":a.nameSprite="LevelDeactive",o=new rt(a)}o.x=n,this.addChild(o),n+=i<4?o.width+7*z.instance().scale:o.width}LogConsole.log(this.children.length),this._width=n}else{var s=new rt({x:4,y:7,nameAtlas:"defaultSource",nameSprite:"Master_Icon"});this.addChild(s),this._width=s.width+5}}},{key:"width",get:function(){return this._width}}])&&Ah(n.prototype,i),o&&Ah(n,o),t}();function Nh(e){return(Nh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jh(e,t,n){return(jh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Uh(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Uh(e){return(Uh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fh(e,t){return(Fh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Hh=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Uh(t).call(this,game,null))||"object"!==Nh(i)&&"function"!=typeof i?Zh(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.data=null,e.positionPopup=e.mainData.positionPopup,e.bgConfirm=new vh,e.bgConfirm.event.OK.add(e.chooseOk,Zh(Zh(e))),e.bgConfirm.event.CANCLE.add(e.chooseCancle,Zh(Zh(e))),e.bgConfirm.x=0,e.bgConfirm.y=74*z.instance().scale,e.addChild(e.bgConfirm),e.avaPlayList=new Ch,e.avaPlayList.setSize(200*z.instance().scale,200*z.instance().scale),e.avaPlayList.x=177*z.instance().scale,e.avaPlayList.y=0,e.addChild(e.avaPlayList),e.textName=new St(e.positionPopup.popup_buy_playlist_text_name,""),e.textName.setTextBounds(0,0,560*z.instance().scale,47*z.instance().scale),e.addChild(e.textName),e.textContent=new St(e.positionPopup.popup_buy_playlist_text_content,"Bạn muốn mua playlist này?"),e.textContent.setTextBounds(0,0,560*z.instance().scale,88*z.instance().scale),e.addChild(e.textContent),e.levePlayList=new Mh({},!1),e.levePlayList.y=266*z.instance().scale,e.levePlayList.x=e.avaPlayList.x+(e.avaPlayList.width-e.levePlayList.width)/2,e.addChild(e.levePlayList),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fh(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e){this.textContent.text=e}},{key:"setData",value:function(e){this.data=e,this.textName.text=this.formatName(this.data.name,25),this.levePlayList.setData(this.data.user,!1),this.levePlayList.x=this.avaPlayList.x+(this.avaPlayList.width-this.levePlayList.width)/2,this.avaPlayList.beginLoad(this.data.thumb,1)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}},{key:"destroy",value:function(){this.bgConfirm.destroy(),this.avaPlayList.destroy(),jh(Uh(t.prototype),"destroy",this).call(this)}}])&&Bh(n.prototype,i),o&&Bh(n,o),t}();var Qh=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.is_highlight=0,this.thumb="",this.created=0,this.is_owner=0,this.is_default=0,this.genre_id=0,this.songs="",this.price=0,this.is_general=0,this.name="",this.id=0,this.vip=0,this.is_solo_mode=0,this.updated=0,this.country_id=0,this.user=new Qs,this.region="",this.arrSong=[],this.questions="",this.bet_id=0,this.purchased_count=0,this.description=""};function Vh(e){return(Vh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qh(e,t,n){return(qh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kh(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Kh(e){return(Kh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zh(e,t){return(zh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Jh=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Kh(t).call(this,game,null))||"object"!==Vh(i)&&"function"!=typeof i?Yh(n):i).data=new Qh,e.event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.itemConfirm=new Hh,e.itemConfirm.event.OK.add(e.chooseOk,Yh(Yh(e))),e.itemConfirm.event.CANCLE.add(e.chooseCancle,Yh(Yh(e))),e.itemConfirm.x=35*z.instance().scale,e.itemConfirm.y=game.height+237*z.instance().scale,e.addChild(e.itemConfirm),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zh(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e){this.itemConfirm.setContent(e)}},{key:"setData",value:function(e){this.data=Object.assign({},this.data,e),this.itemConfirm.setData(e),this.tweenItemPopup(this.itemConfirm,game.height-900*z.instance().scale)}},{key:"chooseOk",value:function(){this.event.OK.dispatch(this.data)}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}},{key:"destroy",value:function(){this.bg.destroy(),this.itemConfirm.destroy(),qh(Kh(t.prototype),"destroy",this).call(this)}}])&&Wh(n.prototype,i),o&&Wh(n,o),t}();function Xh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("playlist_id",e),t}}],(n=null)&&Xh(t.prototype,n),i&&Xh(t,i),e}();var ec=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=0,this.title="",this.author="",this.fileName="",this.listenLink="",this.singer="",this.song="",this.thumb="",this.song_links=[],this.playlist_name=""};function tc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var nc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"genres",get:function(){return"genres"}},{key:"parent",get:function(){return"parent"}},{key:"code",get:function(){return"code"}},{key:"genre",get:function(){return"genre"}},{key:"number_player",get:function(){return"number_player"}},{key:"id",get:function(){return"id"}},{key:"priority",get:function(){return"priority"}},{key:"status",get:function(){return"status"}},{key:"user_level_required",get:function(){return"user_level_required"}},{key:"bet_reward",get:function(){return"bet_reward"}},{key:"bet_place",get:function(){return"bet_place"}},{key:"genre_id",get:function(){return"genre_id"}},{key:"bets",get:function(){return"bets"}},{key:"playlists",get:function(){return"playlists"}},{key:"thumb",get:function(){return"thumb"}},{key:"price",get:function(){return"price"}},{key:"is_general",get:function(){return"is_general"}},{key:"name",get:function(){return"name"}},{key:"questions",get:function(){return"questions"}},{key:"vip",get:function(){return"vip"}},{key:"is_default",get:function(){return"is_default"}},{key:"country_id",get:function(){return"country_id"}},{key:"bet_id",get:function(){return"bet_id"}},{key:"online_mode_loaded",get:function(){return"online_mode_loaded"}},{key:"genres_user_count",get:function(){return"genres_user_count"}},{key:"purchased",get:function(){return"purchased"}},{key:"created",get:function(){return"created"}},{key:"is_owner",get:function(){return"is_owner"}},{key:"is_highlight",get:function(){return"is_highlight"}},{key:"is_solo_mode",get:function(){return"is_solo_mode"}},{key:"updated",get:function(){return"updated"}},{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"file_path",get:function(){return"file_path"}},{key:"question_type",get:function(){return"question_type"}},{key:"title",get:function(){return"title"}},{key:"correct_answer",get:function(){return"correct_answer"}},{key:"answer1",get:function(){return"answer1"}},{key:"answer2",get:function(){return"answer2"}},{key:"answer3",get:function(){return"answer3"}},{key:"answer4",get:function(){return"answer4"}},{key:"question_index",get:function(){return"question_index"}},{key:"streak",get:function(){return"streak"}},{key:"score",get:function(){return"score"}},{key:"players",get:function(){return"players"}},{key:"region",get:function(){return"region"}},{key:"diamond_change",get:function(){return"diamond_change"}},{key:"exp_score",get:function(){return"exp_score"}},{key:"song",get:function(){return"song"}},{key:"singer",get:function(){return"singer"}},{key:"count_down_time",get:function(){return"count_down_time"}},{key:"album",get:function(){return"album"}},{key:"is_correct_answer",get:function(){return"is_correct_answer"}},{key:"user",get:function(){return"user"}}],(n=null)&&tc(t.prototype,n),i&&tc(t,i),e}();function ic(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var oc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=e.getSFSObject(tr.playlist),n=this.getPlayList(t),i=e.getSFSArray(tr.songs),o=0;o<i.size();o++){var a=i.getSFSObject(o),s=this.getSongDetail(a);s.playlist_name=t.getUtfString("name"),n.arrSong.push(s)}if(t.containsKey(tr.user_playlist_mapping)){var r=t.getSFSObject(tr.user_playlist_mapping);r&&(n.user=this.getUserPlayList(r))}return n}},{key:"getPlayList",value:function(e){var t=new Qh;return t.is_highlight=e.getInt(tr.is_highlight),t.thumb=e.getUtfString(tr.thumb),t.created=e.getLong(tr.created),t.is_owner=e.getInt(tr.is_owner),t.is_default=e.getInt(tr.is_default),t.genre_id=e.getInt(tr.genre_id),t.purchased=e.getInt(tr.purchased),t.songs=e.getUtfString(tr.songs),t.price=e.getInt(tr.price),t.is_general=e.getInt(tr.is_general),t.name=e.getUtfString(tr.name),t.id=e.getInt(tr.id),t.vip=e.getInt(tr.vip),t.is_solo_mode=e.getInt(tr.is_solo_mode),t.updated=e.getLong(tr.updated),t.country_id=e.getInt(tr.country_id),e.containsKey(tr.description)&&(t.description=e.getUtfString(tr.description)),e.containsKey(nc.questions)&&(t.questions=e.getUtfString(nc.questions)),t}},{key:"getUserPlayList",value:function(e){var t=new Qs;return t.user_id=e.getInt(tr.user_id),t.level=e.getInt(tr.level),t.playlist_id=e.getInt(tr.playlist_id),t.exp_score=e.getInt(tr.exp_score),t.created=e.getLong(tr.created),t.active=e.getInt(tr.active),t.id=e.getLong(tr.id),t.current_level_score=e.getInt(tr.current_level_score),t.next_level_score=e.getInt(tr.next_level_score),t.updated=e.getLong(tr.updated),t}},{key:"getSongDetail",value:function(e){var t=new ec;if(t.id=e.getLong(tr.id),t.author=e.getUtfString(tr.author),t.title=e.getUtfString(tr.title),t.thumb=e.getSFSObject(tr.singer).getUtfString(tr.avatar),t.fileName=e.getUtfString(tr.title),t.listenLink=e.getUtfString(tr.file_path),t.singer=e.getSFSObject(tr.singer).getUtfString(tr.name),t.song=e.getUtfString(tr.title),e.containsKey(tr.song_links))for(var n=0;n<e.getSFSArray(tr.song_links).size();n++){var i={},o=e.getSFSArray(tr.song_links).getSFSObject(n);i.link_type=o.getUtfString(tr.link_type),i.song_id=o.getLong(tr.song_id),i.is_movie=o.getInt(tr.is_movie),i.link=o.getUtfString(tr.link),i.id=o.getLong(tr.id),t.song_links.push(i)}return t}}],(n=null)&&ic(t.prototype,n),i&&ic(t,i),e}();function ac(e){return(ac="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rc(e,t,n){return(rc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lc(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function lc(e){return(lc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hc(e,t){return(hc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var uc=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=lc(t).call(this,game,null))||"object"!==ac(i)&&"function"!=typeof i?cc(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.data=null,e.positionPopup=e.mainData.positionPopup,LogConsole.log(e.positionPopup),e.bgConfirm=new gn,e.bgConfirm.setTextButton("TIẾP TỤC"),e.bgConfirm.event.OK.add(e.chooseOk,cc(cc(e))),e.bgConfirm.x=0,e.bgConfirm.y=74*e.mainData.scale,e.addChild(e.bgConfirm),e.avaPlayList=new Ch,e.avaPlayList.setSize(200*e.mainData.scale,200*e.mainData.scale),e.avaPlayList.x=175*e.mainData.scale,e.avaPlayList.y=0,e.addChild(e.avaPlayList),e.textName=new St(e.positionPopup.popup_buy_playlist_text_name,""),e.textName.setTextBounds(0,0,560*e.mainData.scale,47*e.mainData.scale),e.addChild(e.textName),e.textContent=new St(e.positionPopup.popup_buy_playlist_text_content,"Bạn đã mua thành công playlist."),e.textContent.setTextBounds(0,0,560*e.mainData.scale,88*e.mainData.scale),e.addChild(e.textContent),e.levePlayList=new Mh({},!1),e.levePlayList.y=266*e.mainData.scale,e.levePlayList.x=e.avaPlayList.x+(e.avaPlayList.width-e.levePlayList.width)/2,e.addChild(e.levePlayList),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hc(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e){this.textContent.text=e}},{key:"setData",value:function(e){this.data=e,this.textName.text=this.formatName(this.data.name,25),this.levePlayList.setData(this.data.user,!1),this.levePlayList.x=this.avaPlayList.x+(this.avaPlayList.width-this.levePlayList.width)/2,this.avaPlayList.beginLoad(this.data.thumb,1)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"destroy",value:function(){this.bgConfirm.destroy(),this.avaPlayList.destroy(),rc(lc(t.prototype),"destroy",this).call(this)}}])&&sc(n.prototype,i),o&&sc(n,o),t}();function dc(e){return(dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pc(e,t,n){return(pc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gc(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function gc(e){return(gc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yc(e,t){return(yc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var vc=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=gc(t).call(this,game,null))||"object"!==dc(o)&&"function"!=typeof o?mc(i):o).playlist_id=e,n.data=new Qh,n.event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"screen-dim"),n.addChild(n.bg),n.itemConfirm=new uc,n.itemConfirm.event.OK.add(n.chooseOk,mc(mc(n))),n.itemConfirm.x=35*z.instance().scale,n.itemConfirm.y=game.height+237*z.instance().scale,n.addChild(n.itemConfirm),n.addEvent(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yc(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().sendData(Js.PLAYLIST_DETAIL_REQUEST,$h.begin(this.playlist_id))}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case Js.PLAYLIST_DETAIL_RESPONSE:"OK"===e.params.getUtfString(tr.status)&&this.setData(oc.begin(e.params))}}},{key:"setContent",value:function(e){this.itemConfirm.setContent(e)}},{key:"setData",value:function(e){this.data=Object.assign({},this.data,e),this.itemConfirm.setData(e),this.tweenItemPopup(this.itemConfirm,game.height-810*z.instance().scale)}},{key:"chooseOk",value:function(){this.event.OK.dispatch(this.data)}},{key:"destroy",value:function(){this.bg.destroy(),this.itemConfirm.destroy(),this.removeEvent(),pc(gc(t.prototype),"destroy",this).call(this)}}])&&fc(n.prototype,i),o&&fc(n,o),t}();function wc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var bc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("playlist_id",e),t}}],(n=null)&&wc(t.prototype,n),i&&wc(t,i),e}();function Sc(e){return(Sc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ec(e,t){return!t||"object"!==Sc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cc(e){return(Cc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kc(e,t){return(kc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pc=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ec(this,Cc(t).call(this,game,null))).maskAva=null,e.ava=new _r("songDetailSprites","ava-default"),e.addChild(e.ava),e.createMask(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kc(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"setSize",value:function(e,t){this.ava.setSize(e,t),this.createMask()}},{key:"setAvatar",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.ava.beginLoad(e,t)}},{key:"createMask",value:function(){this.removeMask(),this.maskAva=new Phaser.Graphics(game,this.ava.x,this.ava.y),this.maskAva.beginFill(16711680,1),this.maskAva.drawCircle(this.ava.width/2,this.ava.height/2,this.ava.width-4*z.instance().scale),this.maskAva.endFill(),this.addChild(this.maskAva),this.ava.mask=this.maskAva}},{key:"removeMask",value:function(){null!==this.maskAva&&(this.maskAva.clear(),this.maskAva.destroy(),this.maskAva=null)}},{key:"width",get:function(){return this.ava.width}},{key:"height",get:function(){return this.ava.height}}])&&_c(n.prototype,i),o&&_c(n,o),t}();function Oc(e){return(Oc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xc(e){return(xc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tc(e,t){return(Tc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ic(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ac=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=xc(t).call(this,game,null))||"object"!==Oc(i)&&"function"!=typeof i?Ic(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.popup=new vh,e.popup.setHeight(562*z.instance().scale),e.popup.y=59*z.instance().scale,e.popup.event.OK.add(e.chooseOk,Ic(Ic(e))),e.popup.event.CANCLE.add(e.chooseCancle,Ic(Ic(e))),e.addChild(e.popup),e.ava=new Pc,e.ava.setSize(197*z.instance().scale,197*z.instance().scale),e.ava.x=185*z.instance().scale,e.ava.y=0,e.addChild(e.ava),e.txtName=new St(e.positionPopup.popup_invite_friend_txt_name,"Viet PV"),e.txtName.setTextBounds(0,0,568*z.instance().scale,47*z.instance().scale),e.addChild(e.txtName),e.txtDes=new St(e.positionPopup.popup_invite_friend_txt_des,"Kien Pham mời bạn vào  phòng chơi cb247"),e.txtDes.setTextBounds(0,0,568*z.instance().scale,77*z.instance().scale),e.addChild(e.txtDes),e.txtMucCuoc=new St(e.positionPopup.popup_invite_friend_txt_muccuoc,"Mức cược"),e.txtMucCuoc.setTextBounds(0,0,568*z.instance().scale,35*z.instance().scale),e.addChild(e.txtMucCuoc),e.btnMucCuoc=new ln(e.positionPopup.popup_invite_friend_btn_muccuoc,1e3),e.addChild(e.btnMucCuoc),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tc(e,t)}(t,Mt),n=t,(i=[{key:"setAvatar",value:function(e){this.ava.setAvatar(e,1)}},{key:"setContent",value:function(e,t){this.txtName.text=e,this.txtDes.text=e+" mời bạn vào phòng chơi "+t,this.txtDes.addColor("#FEAC4F",0),this.txtDes.addColor("#333333",e.length),this.txtDes.addColor("#FEAC4F",e.length+24)}},{key:"setMucCuoc",value:function(e){this.btnMucCuoc.setText(e)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}}])&&Rc(n.prototype,i),o&&Rc(n,o),t}();function Lc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Gc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataBlock={}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllInvatation||(this.controllInvatation=new e),this.controllInvatation}}],(n=[{key:"getUserBlock",value:function(e){return!!this.dataBlock.hasOwnProperty(e)}},{key:"addBlock",value:function(e){this.dataBlock.hasOwnProperty(e)?this.removeIdTime(this.dataBlock[e].idTime):this.dataBlock[e]={},this.dataBlock[e].idTime=game.time.events.add(180*Phaser.Timer.SECOND,this.removeUserBlock,this,e)}},{key:"removeUserBlock",value:function(e){console.log("removeUserBlock : "+e),this.dataBlock.hasOwnProperty(e)&&delete this.dataBlock[e],console.log(this.dataBlock)}},{key:"removeIdTime",value:function(e){null!==this.idTime&&(game.time.events.remove(this.idTime),this.idTime=null)}}])&&Lc(t.prototype,n),i&&Lc(t,i),e}();function Dc(e){return(Dc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nc(e){return(Nc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bc(e,t){return(Bc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Uc=function(e){function t(e){var n,i,o,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=Nc(t).call(this,game,null))||"object"!==Dc(o)&&"function"!=typeof o?jc(i):o).invitation=e,n.cmd=a,n.event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal,OK_CMD:new Phaser.Signal,CANCLE_CMD:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"screen-dim"),n.addChild(n.bg),n.popup=new Ac,n.popup.event.OK.add(n.chooseOk,jc(jc(n))),n.popup.event.CANCLE.add(n.chooseCancle,jc(jc(n))),n.popup.x=35*z.instance().scale,n.popup.y=266*z.instance().scale,n.addChild(n.popup),n.popup.y=game.height+237*z.instance().scale,n.tweenItemPopup(n.popup,game.height-870*z.instance().scale),!1===a?(n.setContent(e.inviter.getVariable("user_name").value,e.params.getInt("room_id")),n.popup.setAvatar(e.inviter.getVariable("avatar").value),n.popup.setMucCuoc(e.params.getInt("bet_place"))):(n.setContent(e.getUtfString("inviter_name"),e.getInt("room_id")),n.popup.setAvatar(e.getUtfString("inviter_avatar")),n.popup.setMucCuoc(e.getInt("bet_place"))),ce.instance().playSound(ce.popupinviteroom),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bc(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e,t){this.popup.setContent(e,t)}},{key:"chooseOk",value:function(){this.cmd?this.event.OK_CMD.dispatch(this.invitation.getInt("room_id"),this.invitation.getInt("bet_place")):this.event.OK.dispatch(this.invitation)}},{key:"chooseCancle",value:function(){this.cmd?(this.event.CANCLE_CMD.dispatch(),Gc.instance().addBlock(this.invitation.getInt("inviter_id"))):this.event.CANCLE.dispatch(this.invitation)}}])&&Mc(n.prototype,i),o&&Mc(n,o),t}();function Fc(e){return(Fc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hc(e){return(Hc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qc(e,t){return(Qc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Wc=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Hc(t).call(this,game,null))||"object"!==Fc(i)&&"function"!=typeof i?Vc(n):i).tryNo=a,e.event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.popup=new vh(o),e.popup.x=35*z.instance().scale,e.addChild(e.popup),e.popup.event.OK.add(e.chooseOk,Vc(Vc(e))),e.popup.event.CANCLE.add(e.chooseCancle,Vc(Vc(e))),e.popup.y=game.height+237*z.instance().scale,e.tweenItemPopup(e.popup,game.height-900*z.instance().scale),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qc(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e){this.popup.setContent(e)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){De.instance().event.chooseNoPopupConfirm.dispatch(this.tryNo),this.event.CANCLE.dispatch()}}])&&Zc(n.prototype,i),o&&Zc(n,o),t}();function qc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Kc(e,t,n){return t&&qc(e.prototype,t),n&&qc(e,n),e}var zc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tween1=null,this.tween2=null,this.timeTween=200,this.ktComplete=!1,this.event={tweenComplete:new Phaser.Signal}}return Kc(e,null,[{key:"instance",value:function(){return this.switch||(this.switch=new e),this.switch}}]),Kc(e,[{key:"beginSwitch",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=0;this.removeAllTween(),this.ktComplete=!1,null!==t&&(t.x=n?-game.width:game.width,this.tween2=game.add.tween(t).to({x:0},this.timeTween,Phaser.Easing.Power1,!0,i),this.tween2.onComplete.add(this.onCompleteTween,this)),null!==e&&(o=n?game.width:-game.width,e.x=0,this.tween1=game.add.tween(e).to({x:o},this.timeTween,Phaser.Easing.Power1,!0,i),this.tween1.onComplete.add(this.onCompleteTween,this))}},{key:"onCompleteTween",value:function(){!1===this.ktComplete&&(this.ktComplete=!0,this.event.tweenComplete.dispatch(),this.removeAllTween())}},{key:"removeTween1",value:function(){null!==this.tween1&&(this.tween1.stop(),game.tweens.remove(this.tween1),this.tween1=null)}},{key:"removeTween2",value:function(){null!==this.tween2&&(this.tween2.stop(),game.tweens.remove(this.tween2),this.tween2=null)}},{key:"removeAllTween",value:function(){this.removeTween1(),this.removeTween2()}}]),e}();function Yc(e){return(Yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xc(e,t){return!t||"object"!==Yc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $c(e){return($c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eu(e,t){return(eu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tu=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Xc(this,$c(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.event={chooseSetting:new Phaser.Signal},e.name,e.btn,e.addLine(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eu(e,t)}(t,Phaser.Group),n=t,o=[{key:"SETTING_GAME",get:function(){return"setting_game"}},{key:"SETTING_ACCOUNT",get:function(){return"setting_account"}},{key:"SETTING_PROFILE",get:function(){return"setting_profile"}},{key:"SETTING_NOTI",get:function(){return"setting_noti"}},{key:"SETTING_SECRET",get:function(){return"setting_secret"}},{key:"SETTING_LANGUAGE",get:function(){return"setting_language"}},{key:"SETTING_TERMS",get:function(){return"setting_terms"}},{key:"SETTING_FOLLOW",get:function(){return"setting_follow"}},{key:"GIFT_CODE",get:function(){return"gift_code"}},{key:"REPORT_BUG",get:function(){return"report_bug"}},{key:"SYNS_FB",get:function(){return"syns_fb"}},{key:"VERSION_PLATFORM",get:function(){return"version_platform"}}],(i=[{key:"addLine",value:function(){var e=new rt(this.positionSetting.setting_item.line);this.addChild(e)}},{key:"addLanguage",value:function(){this.txtLanguage=new St(this.positionSetting.setting_item.config_language,this.positionSetting.setting_item.config_language.text),this.addChild(this.txtLanguage)}},{key:"addVersion",value:function(){"and"==z.instance().platform?(this.txtVersion=new St(this.positionSetting.setting_item.config_version,"".concat(z.instance().platform.toUpperCase()," ").concat(this.positionSetting.setting_item.config_version.text," ").concat(z.VERSION_AND)),this.txtVersion.anchor.set(1,0),this.addChild(this.txtVersion)):(this.txtVersion=new St(this.positionSetting.setting_item.config_version,"".concat(z.instance().platform.toUpperCase()," ").concat(this.positionSetting.setting_item.config_version.text," ").concat(z.VERSION_IOS)),this.txtVersion.anchor.set(1,0),this.addChild(this.txtVersion))}},{key:"addType",value:function(e){this.type=e}},{key:"addNameSetting",value:function(e){this.name=new St(this.positionSetting.setting_item.name,e),this.addChild(this.name)}},{key:"addButtonRight",value:function(){this.btn=new pt(this.positionSetting.setting_item.button_right,this.clickButton,this),this.btn.anchor.set(.5),this.addChild(this.btn)}},{key:"addButtonTop",value:function(){}},{key:"addButtonBottom",value:function(){}},{key:"addFacebookIcon",value:function(){this.fbIcon=new rt(this.positionSetting.setting_item.fb_icon),this.addChild(this.fbIcon),this.fbIcon.inputEnabled=!0,this.fbIcon.events.onInputUp.add(this.clickFBIcon,this)}},{key:"clickFBIcon",value:function(){ce.instance().playSound(ce.buttonclick),window.open("https://www.facebook.com/wazzat.sotaiamnhac","_blank")}},{key:"addInstagramIcon",value:function(){this.instaIcon=new rt(this.positionSetting.setting_item.insta_icon),this.addChild(this.instaIcon),this.instaIcon.inputEnabled=!0,this.instaIcon.events.onInputUp.add(this.clickInstaIcon,this)}},{key:"clickInstaIcon",value:function(){ce.instance().playSound(ce.buttonclick),window.open("https://www.instagram.com/wazzat.sotaiamnhac","_blank")}},{key:"setDisactive",value:function(){this.alpha=.4}},{key:"clickButton",value:function(){this.event.chooseSetting.dispatch(this.type)}},{key:"height",get:function(){return 102*window.GameConfig.RESIZE}}])&&Jc(n.prototype,i),o&&Jc(n,o),t}();function nu(e){return(nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ou(e,t){return!t||"object"!==nu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function au(e){return(au=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function su(e,t){return(su=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ru=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ou(this,au(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&su(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addHeaderTab(this.positionSetting.header),this.addListSetting(),this.addEventExtension()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addListSetting",value:function(){var e=new Phaser.Group(game,this);e.x=0,e.y=109*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0*window.GameConfig.RESIZE,0,640*window.GameConfig.RESIZE,(game.height-130)*window.GameConfig.RESIZE);this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.settingGame,this.settingAccount,this.settingProfile,this.settingNoti,this.settingSecret,this.settingLanguage,this.settingTerms,this.settingFollow,this.reportBug,this.giftCode,this.synsFB,this.addSettingGame(),this.addSettingAccount(),this.addSettingProfile(),this.addSynsFB(),this.addSettingNoti(),this.addSettingSecret(),this.addSettingLanguage(),this.addSettingTerms(),this.addSettingFollow(),this.addReportBug(),this.addVersionPlatform(),""==z.instance().tokenYanAccount&&this.addBtnLogout()}},{key:"addSettingGame",value:function(){this.settingGame=new tu,this.settingGame.addType(tu.SETTING_GAME),this.settingGame.event.chooseSetting.add(this.chooseSetting,this),this.settingGame.addNameSetting("Trò chơi"),this.settingGame.addButtonRight(),this.listView.add(this.settingGame)}},{key:"addSettingAccount",value:function(){this.settingAccount=new tu,this.settingAccount.addType(tu.SETTING_ACCOUNT),this.settingAccount.event.chooseSetting.add(this.chooseSetting,this),this.settingAccount.addNameSetting("Tài khoản"),this.settingAccount.addButtonRight(),this.listView.add(this.settingAccount)}},{key:"addSettingProfile",value:function(){this.settingProfile=new tu,this.settingProfile.addType(tu.SETTING_PROFILE),this.settingProfile.event.chooseSetting.add(this.chooseSetting,this),this.settingProfile.addNameSetting("Hồ sơ"),this.settingProfile.addButtonRight(),this.listView.add(this.settingProfile)}},{key:"addSettingNoti",value:function(){this.settingNoti=new tu,this.settingNoti.addType(tu.SETTING_NOTI),this.settingNoti.event.chooseSetting.add(this.chooseSetting,this),this.settingNoti.addNameSetting("Thông báo"),this.settingNoti.addButtonRight(),this.settingNoti.setDisactive(),this.listView.add(this.settingNoti)}},{key:"addSettingSecret",value:function(){this.settingSecret=new tu,this.settingSecret.addType(tu.SETTING_SECRET),this.settingSecret.event.chooseSetting.add(this.chooseSetting,this),this.settingSecret.addNameSetting("Riêng tư"),this.settingSecret.addButtonRight(),this.settingSecret.setDisactive(),this.listView.add(this.settingSecret)}},{key:"addSettingLanguage",value:function(){this.settingLanguage=new tu,this.settingLanguage.addType(tu.SETTING_LANGUAGE),this.settingLanguage.event.chooseSetting.add(this.chooseSetting,this),this.settingLanguage.addNameSetting("Ngôn ngữ"),this.settingLanguage.addLanguage(),this.settingLanguage.addButtonRight(),this.settingLanguage.setDisactive(),this.listView.add(this.settingLanguage)}},{key:"addSettingTerms",value:function(){this.settingTerms=new tu,this.settingTerms.addType(tu.SETTING_TERMS),this.settingTerms.event.chooseSetting.add(this.chooseSetting,this),this.settingTerms.addNameSetting("Điều khoản"),this.settingTerms.addButtonRight(),this.settingTerms.setDisactive(),this.listView.add(this.settingTerms)}},{key:"addSettingFollow",value:function(){this.settingFollow=new tu,this.settingFollow.addType(tu.SETTING_FOLLOW),this.settingFollow.event.chooseSetting.add(this.chooseSetting,this),this.settingFollow.addNameSetting("Theo dõi Wazzat"),this.settingFollow.addFacebookIcon(),this.settingFollow.addInstagramIcon(),this.listView.add(this.settingFollow)}},{key:"addReportBug",value:function(){this.reportBug=new tu,this.reportBug.addType(tu.REPORT_BUG),this.reportBug.event.chooseSetting.add(this.chooseSetting,this),this.reportBug.addNameSetting("Báo lỗi"),this.reportBug.addButtonRight(),this.reportBug.setDisactive(),this.listView.add(this.reportBug)}},{key:"addGiftCode",value:function(){this.giftCode=new tu,this.giftCode.addType(tu.GIFT_CODE),this.giftCode.event.chooseSetting.add(this.chooseSetting,this),this.giftCode.addNameSetting("Giftcode"),this.giftCode.addButtonRight(),this.listView.add(this.giftCode)}},{key:"addSynsFB",value:function(){this.synsFB=new tu,this.synsFB.addType(tu.SYNS_FB),this.synsFB.event.chooseSetting.add(this.chooseSetting,this),this.synsFB.addNameSetting("Liên kết với Facebook"),this.synsFB.addButtonRight(),this.listView.add(this.synsFB)}},{key:"addVersionPlatform",value:function(){this.versionPlatform=new tu,this.versionPlatform.addType(tu.VERSION_PLATFORM),this.versionPlatform.event.chooseSetting.add(this.chooseSetting,this),this.versionPlatform.addNameSetting("Phiên bản trò chơi"),this.versionPlatform.addVersion(),this.versionPlatform.setDisactive(),this.listView.add(this.versionPlatform)}},{key:"chooseSetting",value:function(e){switch(e){case tu.SETTING_GAME:iC.instance().addSettingGameScreen();break;case tu.SETTING_ACCOUNT:iC.instance().addSettingAccountScreen();break;case tu.SETTING_PROFILE:iC.instance().addSettingProfileScreen();break;case tu.GIFT_CODE:iC.instance().addSettingGiftcode();break;case tu.SYNS_FB:this.synsWithFacebook()}}},{key:"addBtnLogout",value:function(){this.btnLogout=new Phaser.Button(game,this.positionSetting.btn_logout.x,game.height-z.instance().STANDARD_HEIGHT+this.positionSetting.btn_logout.y,this.positionSetting.btn_logout.nameAtlas,this.onClickLogout,this,null,this.positionSetting.btn_logout.nameSprite),this.btnLogout.anchor.set(.5,0);var e=new St(this.positionSetting.txt_logout,this.positionSetting.txt_logout.text);e.anchor.set(.5),this.btnLogout.addChild(e),this.listView.add(this.btnLogout)}},{key:"onClickLogout",value:function(){1==z.instance().LOG_IN_BY_FB?ui.instance().logout(function(e){"unknown"==e.status&&(z.instance().LOG_IN_BY_FB=!1,mZ.instance().sendLogout())}):mZ.instance().sendLogout()}},{key:"synsWithFacebook",value:function(){!0!==z.instance().LOG_IN_BY_FB?(qe.instance().showLoading(),console.log("Let's syns FB"+z.instance().platform),"web"!==z.instance().platform?(Ie.instance().login(),qe.instance().showLoading()):FB.login(function(e){if("unknown"==e.status&&alert("Đăng nhập lỗi, hãy đăng nhập lại! :'("),"connected"==e.status){var t=e.authResponse,n={userId:mZ.instance().dataMySeft.user_id,fbId:t.userID,accessToken:t.accessToken};$.ajax({type:"POST",url:window.RESOURCE.fb_sync_api,data:n,dataType:"json",success:function(e){"Failed"==e.status?Gn.instance().addDialog(e.message):"OK"==e.status&&(WF.instance().changeScreen(Ce.LOGIN),iC.instance().removeAllItem(),Gn.instance().removeAllItem())}})}},{scope:"email, user_gender, user_friends"})):Gn.instance().addDialog("It's already login FB!")}},{key:"addEventExtension",value:function(){Ie.instance().event.loginComplete.add(this.loginFbMobileComplete,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){Ie.instance().event.loginComplete.remove(this.loginFbMobileComplete,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"loginFbMobileComplete",value:function(e){var t={userId:mZ.instance().dataMySeft.user_id,fbId:e.userID,accessToken:e.accessToken};$.ajax({type:"POST",url:window.RESOURCE.fb_sync_api,data:t,dataType:"json",success:function(e){"Failed"==e.status?Gn.instance().addDialog(e.message):"OK"==e.status&&(WF.instance().changeScreen(Ce.LOGIN),iC.instance().removeAllItem(),Gn.instance().removeAllItem())}})}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&iu(n.prototype,i),o&&iu(n,o),t}();function lu(e){return(lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cu(e,t){return!t||"object"!==lu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uu(e){return(uu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function du(e,t){return(du=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fu=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=cu(this,uu(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.event={onSetting:new Phaser.Signal,offSetting:new Phaser.Signal},e.name,e.btnOn,e.btnOff,e.boolean=!1,e.addLine(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&du(e,t)}(t,Phaser.Group),n=t,o=[{key:"SOUND_FX",get:function(){return"setting_game_soundfx"}},{key:"INVITE_PARTY",get:function(){return"setting_game_invite_party"}}],(i=[{key:"addType",value:function(e){this.type=e}},{key:"addNameSetting",value:function(e){this.name=new St(this.positionSetting.setting_item.name,e),this.addChild(this.name)}},{key:"addButton",value:function(e){this.boolean=e,1==e?(this.addButtonOn(1,1),this.addButtonOff(0,1)):(this.addButtonOn(0,1),this.addButtonOff(1,1)),this.txtBtnOn=new St(this.positionSetting.setting_item.txt_button_on,this.positionSetting.setting_item.txt_button_on.text),this.txtBtnOn.kill(),this.txtBtnOff=new St(this.positionSetting.setting_item.txt_button_off,this.positionSetting.setting_item.txt_button_off.text),this.txtBtnOff.kill(),this.addChild(this.txtBtnOn),this.addChild(this.txtBtnOff),1==this.boolean?this.txtBtnOn.revive():this.txtBtnOff.revive()}},{key:"addButtonOn",value:function(e,t){this.btnOn=new pt(this.positionSetting.setting_item.button_on,this.clickOn,this),this.btnOn.scale.set(e,t),this.addChild(this.btnOn)}},{key:"addButtonOff",value:function(e,t){this.btnOff=new pt(this.positionSetting.setting_item.button_off,this.clickOff,this),this.btnOff.anchor.set(1,0),this.btnOff.scale.set(e,t),this.addChild(this.btnOff)}},{key:"clickOn",value:function(){this.boolean=!1,this.event.offSetting.dispatch(),this.addTweenButton()}},{key:"clickOff",value:function(){this.boolean=!0,this.event.onSetting.dispatch(),this.addTweenButton()}},{key:"addTweenButton",value:function(){1==this.boolean?(this.txtBtnOn.revive(),this.txtBtnOff.kill(),game.add.tween(this.btnOn.scale).to({x:1,y:1},250,"Linear",!1).start(),game.add.tween(this.btnOff.scale).to({x:0,y:1},250,"Linear",!1).start()):(this.txtBtnOff.revive(),this.txtBtnOn.kill(),game.add.tween(this.btnOff.scale).to({x:1,y:1},250,"Linear",!1).start(),game.add.tween(this.btnOn.scale).to({x:0,y:1},250,"Linear",!1).start())}},{key:"setDisactive",value:function(){this.alpha=.4,this.inputEnabled=!1,this.btnOff.inputEnabled=!1,this.btnOn.inputEnabled=!1}},{key:"addLine",value:function(){var e=new rt(this.positionSetting.setting_item.line);this.addChild(e)}},{key:"height",get:function(){return 102*window.GameConfig.RESIZE}}])&&hu(n.prototype,i),o&&hu(n,o),t}();function pu(e){return(pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yu(e,t){return!t||"object"!==pu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mu(e){return(mu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vu(e,t){return(vu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wu=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=yu(this,mu(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vu(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addHeaderTab(this.positionSetting.header),this.addListSetting()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting_game)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addListSetting",value:function(){var e=new Phaser.Group(game,this);e.x=0,e.y=109*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0*window.GameConfig.RESIZE,0,640*window.GameConfig.RESIZE,885*window.GameConfig.RESIZE);this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.settingSoundFx,this.settingInviteParty,this.addSettingSoundFx(),this.addSettingInviteParty()}},{key:"addSettingSoundFx",value:function(){this.settingSoundFx=new fu,this.settingSoundFx.event.onSetting.add(this.onSettingSoundFX,this),this.settingSoundFx.event.offSetting.add(this.offSettingSoundFX,this),this.settingSoundFx.addType(fu.SOUND_FX),this.settingSoundFx.addNameSetting("Âm thanh"),this.settingSoundFx.addButton(window.GameConfig.SOUND_FX),this.listView.add(this.settingSoundFx)}},{key:"onSettingSoundFX",value:function(){window.GameConfig.SOUND_FX=!0}},{key:"offSettingSoundFX",value:function(){window.GameConfig.SOUND_FX=!1}},{key:"addSettingInviteParty",value:function(){this.settingInviteParty=new fu,this.settingInviteParty.addType(fu.INVITE_PARTY),this.settingInviteParty.addNameSetting("Lời mời chơi nhóm"),this.settingInviteParty.addButton(!0),this.settingInviteParty.setDisactive(),this.listView.add(this.settingInviteParty)}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&gu(n.prototype,i),o&&gu(n,o),t}();function bu(e){return(bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Su(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _u(e,t){return!t||"object"!==bu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Eu(e){return(Eu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cu(e,t){return(Cu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ku=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=_u(this,Eu(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.event={chooseSetting:new Phaser.Signal},e.name,e.btn,e.txtOnRight,e.addLine(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cu(e,t)}(t,Phaser.Group),n=t,o=[{key:"SETTING_ACCOUNT_VIP",get:function(){return"setting_account_vip"}},{key:"SETTING_ACCOUNT_USERNAME",get:function(){return"setting_account_username"}},{key:"SETTING_ACCOUNT_EMAIL",get:function(){return"setting_account_email"}},{key:"SETTING_ACCOUNT_PASSWORD",get:function(){return"setting_account_password"}},{key:"SETTING_ACCOUNT_GENDER",get:function(){return"setting_account_gender"}}],(i=[{key:"addLine",value:function(){var e=new rt(this.positionSetting.setting_item.line);this.addChild(e)}},{key:"addTxtOnright",value:function(e){this.txtOnRight=new St(this.positionSetting.setting_item.txt_on_right,e),this.txtOnRight.anchor.set(1,0),this.addChild(this.txtOnRight)}},{key:"addType",value:function(e){this.type=e}},{key:"addNameSetting",value:function(e){this.name=new St(this.positionSetting.setting_item.name,e),this.addChild(this.name)}},{key:"addButtonRight",value:function(){this.btn=new pt(this.positionSetting.setting_item.button_right,this.clickButton,this),this.btn.anchor.set(.5),this.addChild(this.btn)}},{key:"addButtonTop",value:function(){}},{key:"addButtonBottom",value:function(){}},{key:"setDisactive",value:function(){this.alpha=.4}},{key:"clickButton",value:function(){this.event.chooseSetting.dispatch(this.type)}},{key:"height",get:function(){return 102*window.GameConfig.RESIZE}}])&&Su(n.prototype,i),o&&Su(n,o),t}();function Pu(e){return(Pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ou(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ru(e){return(Ru=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xu(e,t){return(xu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Tu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Iu=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Ru(t).call(this,game))||"object"!==Pu(i)&&"function"!=typeof i?Tu(n):i).event={choose_gender:new Phaser.Signal},e.positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.bgGenres=new pt(e.positionSetting.sort_play_list_bg_search_menu),e.bgGenres.height=120*z.instance().scale,e.bgGenres.width=161*z.instance().scale,e.addChild(e.bgGenres),e.arrSort=["MALE","FEMALE"];for(var o=10,a=0;a<e.arrSort.length;a++){var s=new ln(e.positionSetting.bg_tab_menu_select_item,e.arrSort[a],e.chooseItem,Tu(Tu(e)));s.name=a,s.y=o,s.x=10,o+=45,e.addChild(s)}return e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xu(e,t)}(t,Phaser.Group),n=t,(i=[{key:"chooseItem",value:function(e){LogConsole.log("chooseItem : "+e.name),this.event.choose_gender.dispatch(e.name,this.arrSort[parseInt(e.name)])}}])&&Ou(n.prototype,i),o&&Ou(n,o),t}();function Au(e){return(Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Gu(e,t){return!t||"object"!==Au(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Du(e){return(Du=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mu(e,t){return(Mu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nu=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Gu(this,Du(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mu(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.settingGender=null,this.addHeaderTab(this.positionSetting.header),this.addListSetting()}},{key:"addEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"onUpdateUserVars",value:function(){this.userName.txtOnRight.setText(mZ.instance().dataMySeft.user_name),this.gender.txtOnRight.setText(mZ.instance().dataMySeft.gender)}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting_account)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addListSetting",value:function(){var e=new Phaser.Group(game,this);e.x=0,e.y=109*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0*window.GameConfig.RESIZE,0,640*window.GameConfig.RESIZE,885*window.GameConfig.RESIZE);this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.vip,this.userName,this.gender,this.email,this.password,this.addVip(),this.addUserName(),this.addGender(),this.addEmail(),this.addPassword(),this.addEventExtension()}},{key:"addVip",value:function(){this.vip=new ku,this.vip.addNameSetting("Tài khoản Vip"),this.vip.addType(ku.SETTING_ACCOUNT_VIP),this.vip.addTxtOnright("Chưa có"),this.vip.event.chooseSetting.add(this.chooseSetting,this),this.listView.add(this.vip)}},{key:"addGender",value:function(){this.gender=new ku,this.gender.addNameSetting("Giới tính"),this.gender.addType(ku.SETTING_ACCOUNT_GENDER),this.gender.addButtonRight(),null!==mZ.instance().socket.mySelf?this.gender.addTxtOnright(mZ.instance().dataMySeft.gender):this.gender.addTxtOnright("Chưa có"),this.gender.event.chooseSetting.add(this.chooseSetting,this),this.listView.add(this.gender)}},{key:"addUserName",value:function(){this.userName=new ku,this.userName.addNameSetting("Tên người dùng"),this.userName.addType(ku.SETTING_ACCOUNT_USERNAME),this.userName.addButtonRight(),null!==mZ.instance().socket.mySelf?this.userName.addTxtOnright(mZ.instance().dataMySeft.user_name):this.userName.addTxtOnright("Chưa có"),this.userName.event.chooseSetting.add(this.chooseSetting,this),this.listView.add(this.userName)}},{key:"addEmail",value:function(){this.email=new ku,this.email.addNameSetting("Email"),this.email.addType(ku.SETTING_ACCOUNT_EMAIL),this.email.addButtonRight(),this.email.addTxtOnright("anh******@gmail.com"),this.email.event.chooseSetting.add(this.chooseSetting,this),this.email.setDisactive(),this.listView.add(this.email)}},{key:"addPassword",value:function(){this.password=new ku,this.password.addNameSetting("Mật khẩu"),this.password.addType(ku.SETTING_ACCOUNT_PASSWORD),this.password.addButtonRight(),this.password.addTxtOnright("*********"),this.password.event.chooseSetting.add(this.chooseSetting,this),this.password.setDisactive(),this.listView.add(this.password)}},{key:"chooseSetting",value:function(e){switch(e){case ku.SETTING_ACCOUNT_USERNAME:iC.instance().addSettingAccountUserNameScreen();break;case ku.SETTING_ACCOUNT_GENDER:this.addSettingGender()}}},{key:"addSettingGender",value:function(){this.removeSettingGender(),this.settingGender=new Iu,this.settingGender.x=430,this.settingGender.y=360,this.settingGender.event.choose_gender.add(this.choosedGender,this),this.addChild(this.settingGender)}},{key:"removeSettingGender",value:function(){null!==this.settingGender&&(this.removeChild(this.settingGender),this.settingGender.destroy(),this.settingGender=null)}},{key:"choosedGender",value:function(e,t){this.settingGender.destroy(),El.instance().settingAccount(mZ.instance().socket.mySelf.getVariable("user_id").value,mZ.instance().dataMySeft.user_name,t,null),El.instance().sendData(this.onChangeGender.bind(this))}},{key:"onChangeGender",value:function(e){if("ok"==e.code){var t=[];t.push(new SFS2X.SFSUserVariable("gender",e.data.gender)),mZ.instance().socket.send(new SFS2X.SetUserVariablesRequest(t)),mZ.instance().dataMySeft.setGender(e.data.gender)}}},{key:"destroy",value:function(){for(this.listView.removeAll(),this.removeEventExtension(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Lu(n.prototype,i),o&&Lu(n,o),t}();function Bu(e){return(Bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ju(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Uu(e,t){return!t||"object"!==Bu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fu(e){return(Fu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zu(e,t){return(Zu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hu=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Uu(this,Fu(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zu(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){null!==mZ.instance().socket.mySelf?this.nameChange=mZ.instance().dataMySeft.user_name:this.nameChange="NameXXX_XXX",this.addEventExtension(),this.addHeaderTab(this.positionSetting.header),this.txtSettingHead,this.boxText,this.txtBoxText,this.btnSave,this.tick,this.addTxtSettingHead(),this.addBoxText(),this.addTxtBoxText(),this.addBtnSave(),this.addTick()}},{key:"addTxtSettingHead",value:function(){this.txtSettingHead=new St(this.positionSetting.setting_account.txt_setting_head,this.positionSetting.setting_account.txt_setting_head.text),this.txtSettingHead.anchor.set(.5),this.addChild(this.txtSettingHead)}},{key:"addBoxText",value:function(){this.boxText=new pt(this.positionSetting.setting_account.box_text,this.clickBoxText,this),this.boxText.anchor.set(.5),this.addChild(this.boxText)}},{key:"addTxtBoxText",value:function(){this.txtBoxText=new St(this.positionSetting.setting_account.txt_box_text,this.nameChange),this.txtBoxText.anchor.set(.5),this.boxText.addChild(this.txtBoxText)}},{key:"addBtnSave",value:function(){this.btnSave=new pt(this.positionSetting.setting_account.btn_save,this.clickSave,this),this.btnSave.anchor.set(.5);var e=new St(this.positionSetting.setting_account.txt_btn_save,this.positionSetting.setting_account.txt_btn_save.text);e.anchor.set(.5),this.btnSave.addChild(e),this.addChild(this.btnSave)}},{key:"addTick",value:function(){this.tick=new rt(this.positionSetting.setting_account.tick),this.boxText.addChild(this.tick)}},{key:"clickBoxText",value:function(){this.tick.kill(),this.inputKeyboard()}},{key:"inputKeyboard",value:function(){var e={maxLength:"",showTransparent:!0,placeholder:"Nhập tên thay đổi",isSearch:!1,typeInputText:"input",configText:{width:this.boxText.width-70,height:this.boxText.height-5,x:this.boxText.x-this.boxText.width/2,y:this.boxText.y-this.boxText.height/2}};rl.instance().event.cancle.add(this.keyboardClose,this),rl.instance().event.enter.add(this.keyboardDone,this),rl.instance().event.submit.add(this.keyboardDone,this),rl.instance().show(e),rl.instance().setValue(this.nameChange)}},{key:"keyboardClose",value:function(){rl.instance().event.cancle.remove(this.keyboardClose,this),rl.instance().event.enter.remove(this.keyboardDone,this),rl.instance().event.submit.remove(this.keyboardDone,this),rl.instance().hide(),this.boxText.revive(),this.btnSave.revive()}},{key:"keyboardDone",value:function(){""!==this.nameChange&&""==rl.instance().getValue()||(this.nameChange=rl.instance().getValue(),LogConsole.log(this.nameChange)),this.changeTxtBoxText(),this.keyboardClose()}},{key:"changeTxtBoxText",value:function(){this.txtBoxText.setText(this.nameChange)}},{key:"clickSave",value:function(){this.keyboardDone(),this.nameChange==mZ.instance().dataMySeft.user_name||(this.btnSave.kill(),El.instance().settingAccount(mZ.instance().socket.mySelf.getVariable("user_id").value,this.nameChange,mZ.instance().socket.mySelf.getVariable("gender").value,null),El.instance().sendData(this.onSendSettingDone.bind(this)))}},{key:"onSendSettingDone",value:function(e){if(LogConsole.log(e),this.btnSave.revive(),"ok"==e.code){this.tick.revive(),Gn.instance().addDialog("Đổi tên thành công");var t=[];t.push(new SFS2X.SFSUserVariable("user_name",this.nameChange)),mZ.instance().socket.send(new SFS2X.SetUserVariablesRequest(t)),mZ.instance().dataMySeft.setUserName(this.nameChange)}}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting_account_username)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(rl.instance().hide(),this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&ju(n.prototype,i),o&&ju(n,o),t}();var Qu=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.login_id=0,this.gender="",this.ticket=0,this.login_type="",this.level=0,this.user_name="",this.all_time_high_score=0,this.last_login=0,this.created=0,this.heart_updated=0,this.active=0,this.avatar=0,this.experience_score=0,this.heart=0,this.support_item=0,this.diamond=0,this.weekly_high_score=0,this.id=0,this.is_online=!1,this.email="",this.count_login=0,this.vip=!1,this.support_item=0,this.level_title=""};function Vu(e){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qu(e,t){return!t||"object"!==Vu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ku(e){return(Ku=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zu(e,t){return(zu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yu=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=qu(this,Ku(t).call(this,game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite))).configsValue=n,i.initChild(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zu(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addEvent",value:function(){Kr.instance().event.buy_playlist.add(this.buyPlaylistDone,this)}},{key:"removeEvent",value:function(){Kr.instance().event.buy_playlist.remove(this.buyPlaylistDone,this)}},{key:"getData",value:function(e){switch(e.cmd){case Js.SHOP_BUY_PLAYLIST_RESPONSE:this.signalInput.dispatch({isBuyDone:!0})}}},{key:"buyPlaylistDone",value:function(){this.signalInput.dispatch({isBuyDone:!0})}},{key:"initChild",value:function(){this.avaThumb=null,this.tabGem=null,this.txtPlaylist=null,this.txtGem=null,this.signalInput=new Phaser.Signal,this.inputEnabled=!0,this.txtNoHasPlaylist=null,this.addEvent()}},{key:"checkHasSuggestPlaylist",value:function(e,t){e?null==e.id?t(!1):t(!0):t(!1)}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t),this.events.onInputUp.add(this.onClickSprite,this)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"onClickSprite",value:function(){if(ce.instance().playSound(ce.buttonclick),1==this.configsValue.isFree&&this.signalInput.dispatch({id:this.configsValue.id,isBuy:null}),0==this.configsValue.isFree){var e=new Qh;e=Object.assign({},e,this.configsValue),iC.instance().buyItem(e)}}},{key:"addThumb",value:function(){this.thumb=new Phaser.Sprite(game,35*window.GameConfig.RESIZE,19*window.GameConfig.RESIZE,"songDetailSprites","Nhactre"),this.thumb.scale.set(105/165);var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawRoundedRect(35*window.GameConfig.RESIZE,19*window.GameConfig.RESIZE,105*window.GameConfig.RESIZE,105*window.GameConfig.RESIZE,20*window.GameConfig.RESIZE),this.addChild(e),this.addChild(this.thumb),this.thumb.mask=e}},{key:"addTextNoHasPlaylist",value:function(){this.txtNoHasPlaylist=new Phaser.Text(game,this.width/2*window.GameConfig.RESIZE,this.height/2*window.GameConfig.RESIZE,"BẠN ĐÃ ĐỦ HẾT PLAYLIST",{font:"GilroyBold",fill:"white",align:"center",fontSize:30}),this.txtNoHasPlaylist.anchor.set(.5),this.addChild(this.txtNoHasPlaylist)}},{key:"addTabGem",value:function(e,t){0==this.configsValue.isFree?(this.tabGem=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.addChild(this.tabGem)):1==this.configsValue.isFree&&(this.tabGem=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.text,t.configs),this.tabGem.anchor.set(1,0),this.addChild(this.tabGem))}},{key:"addTxtPlaylist",value:function(e,t){this.txtPlaylist=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,e,t.configs),this.addChild(this.txtPlaylist)}},{key:"addTxtGem",value:function(e,t){if(0==this.configsValue.isFree){this.txtGem=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,e,t.configs);var n=new rt(t.gem);this.tabGem.addChild(n),this.tabGem.addChild(this.txtGem)}}},{key:"beginLoadThumb",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"loadStart",value:function(){}},{key:"onLoad",value:function(){game.cache.checkImageKey(this.key)&&this.thumb.loadTexture("".concat(this.key))}},{key:"destroy",value:function(){for(this.removeEvent();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&Wu(n.prototype,i),o&&Wu(n,o),t}();function Ju(e){return(Ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $u(e,t){return!t||"object"!==Ju(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ed(e){return(ed=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function td(e,t){return(td=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nd=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=$u(this,ed(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.signalBuyPlaylistDone=new Phaser.Signal,e.event={choosedPlaylist:new Phaser.Signal},e.friend=n,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&td(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterGetPlaylistDone",value:function(e){this.playlist=e,null!=this.group&&null!=this.group||(this.group=new Phaser.Group(game),this.addChild(this.group))}},{key:"addSuggestPlaylist",value:function(){var e=this,t=new Yu(this.positionMainConfig.tab_recent,this.playlist);this.addChild(t),t.checkHasSuggestPlaylist(this.playlist,function(n){n?(t.addThumb(),t.beginLoadThumb(e.playlist.thumb),t.addTabGem(e.positionMainConfig.Tab_gem,e.positionMainConfig.txt_try_suggest_playlist_free),t.addTxtGem(e.playlist.price,e.positionMainConfig.txt_price_suggest_playlist),t.addTxtPlaylist(e.playlist.name,e.positionMainConfig.txt_suggest_playlist),t.addInput(e.onClickSuggestPlaylist,e)):e.destroy()})}},{key:"addOwnerPlaylist",value:function(){}},{key:"onClickSuggestPlaylist",value:function(e){LogConsole.log(e),e.isBuyDone?1==e.isBuyDone&&this.signalBuyPlaylistDone.dispatch():!0===e.isBuy?(LogConsole.log("true: ".concat(e.isBuy)),this.sendRequestBuyPlaylist(e.id)):!1===e.isBuy?LogConsole.log("false: ".concat(e.isBuy)):(this.questions=[],this.playlistId=e.id,this.playlistName=e.name,this.sendRequestChoosePlaylist(e.id))}},{key:"removeGroup",value:function(){null!==this.group&&this.group.destroy(),this.group=null}},{key:"sendRequestChoosePlaylist",value:function(e){LogConsole.log(this.idOpponent),this.event.choosedPlaylist.dispatch({id:e,name:this.playlist.name})}},{key:"sendRequestBuyPlaylist",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),mZ.instance().sendData(Et.SHOP_BUY_PLAYLIST_REQUEST,t)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&Xu(n.prototype,i),o&&Xu(n,o),t}();function id(e){return(id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function od(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ad(e,t){return!t||"object"!==id(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sd(e){return(sd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rd(e,t){return(rd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ld=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ad(this,sd(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),n.friend=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.signalBuyPlaylistDone=new Phaser.Signal,this.event={choosePlaylist:new Phaser.Signal,backScreen:new Phaser.Signal}}},{key:"addChallPlayListGroup",value:function(e,t){if(this.listView,this.addGroupChallPlaylist(),this.addTabHeaderChoosePlaylist(),this.addTextHeader(),this.addBtnBackToMenu(),this.getPlaylistSuggestPlaylist=new nd,this.getPlaylistSuggestPlaylist.event.choosedPlaylist.add(this.choosedSuggestPlaylist,this),this.getPlaylistSuggestPlaylist.afterGetPlaylistDone(t),this.getPlaylistSuggestPlaylist.signalBuyPlaylistDone.add(this.suggestPlaylistCallback,this),this.getPlaylistSuggestPlaylist.addSuggestPlaylist(),this.addChild(this.getPlaylistSuggestPlaylist),t)if(null==t.id){(o=new Phaser.Group(game)).x=0,o.y=105*window.GameConfig.RESIZE,this.addChild(o);var n=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-381)*window.GameConfig.RESIZE);this.listView=new Jo(game,o,n,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}else{(o=new Phaser.Group(game)).x=0,o.y=248*window.GameConfig.RESIZE,this.addChild(o);var i=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-381)*window.GameConfig.RESIZE);this.listView=new Jo(game,o,i,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}else{var o;(o=new Phaser.Group(game)).x=0,o.y=105*window.GameConfig.RESIZE,this.addChild(o);var a=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-381)*window.GameConfig.RESIZE);this.listView=new Jo(game,o,a,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}for(var s=0;s<e.length;s++)this.createTabPlaylist(e[s],s);this.loadLayerClassPlaylist()}},{key:"choosedSuggestPlaylist",value:function(e){this.event.choosePlaylist.dispatch(e)}},{key:"suggestPlaylistCallback",value:function(){this.signalBuyPlaylistDone.dispatch(),this.removeAllChild(),this.destroyAll(),this.destroy()}},{key:"addGroupChallPlaylist",value:function(){this.challPlaylistGroup=new Phaser.Group(game),this.addChild(this.challPlaylistGroup),this.challPlaylistGroup.position.x=0;var e=new Phaser.Button(game,0,0,"bg_create_room");this.addChild(e)}},{key:"addTabHeaderChoosePlaylist",value:function(){this.tab_chonplaylist=new Phaser.Sprite(game,this.positionMainConfig.tab_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.tab_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.tab_chonplaylist.nameAtlas,this.positionMainConfig.tab_chonplaylist.nameSprite),this.tab_chonplaylist.anchor.set(.5,0),this.addChild(this.tab_chonplaylist)}},{key:"addTextHeader",value:function(){var e=new Phaser.Text(game,this.positionMainConfig.txt_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.txt_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.txt_chonplaylist.text,this.positionMainConfig.txt_chonplaylist.configs);e.anchor.set(.5),this.tab_chonplaylist.addChild(e)}},{key:"addBtnBackToMenu",value:function(){var e=this,t=new Phaser.Button(game,this.positionMainConfig.arrow_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.arrow_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.arrow_chonplaylist.nameAtlas,function(){},this,null,this.positionMainConfig.arrow_chonplaylist.nameSprite);t.anchor.set(.5),this.tab_chonplaylist.addChild(t),t.events.onInputDown.add(function(){ce.instance().playSound(ce.buttonclick),e.destroyAll(),e.event.backScreen.dispatch()})}},{key:"loadLayerClassPlaylist",value:function(){var e=new Phaser.Sprite(game,this.positionMainConfig.tab_gem_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.tab_gem_playlist.y*window.GameConfig.RESIZE,this.positionMainConfig.tab_gem_playlist.nameAtlas,this.positionMainConfig.tab_gem_playlist.nameSprite);e.anchor.set(1,0);var t=new Phaser.Sprite(game,this.positionMainConfig.gem_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.gem_playlist.y*window.GameConfig.RESIZE,this.positionMainConfig.gem_playlist.nameAtlas,this.positionMainConfig.gem_playlist.nameSprite);e.addChild(t);var n=new Phaser.Text(game,this.positionMainConfig.txt_gem_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.txt_gem_playlist.y*window.GameConfig.RESIZE,"".concat(mZ.instance().socket.mySelf.getVariable("diamond").value),this.positionMainConfig.txt_gem_playlist.configs);e.addChild(n);var i=t.width+n.width;n.x=(e.width-i)/2-2.5-e.width,t.x=(e.width-i)/2+n.width+5-e.width,this.tab_chonplaylist.addChild(e);var o=new Phaser.Button(game,this.positionMainConfig.btn_change_playlist.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionMainConfig.btn_change_playlist.y)*window.GameConfig.RESIZE,this.positionMainConfig.btn_change_playlist.nameAtlas,this.onClickChangePlaylist,this,null,this.positionMainConfig.btn_change_playlist.nameSprite);o.anchor.set(.5),this.addChild(o);var a=new Phaser.Text(game,this.positionMainConfig.txt_change_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.txt_change_playlist.y*window.GameConfig.RESIZE,this.positionMainConfig.txt_change_playlist.text,this.positionMainConfig.txt_change_playlist.configs);a.anchor.set(.5),o.addChild(a)}},{key:"onClickChangePlaylist",value:function(){ce.instance().playSound(ce.buttonclick),iC.instance().addShop(0)}},{key:"createTabPlaylist",value:function(e,t){var n=this,i=new Phaser.Button(game,this.positionMainConfig.tab_playlist.x*window.GameConfig.RESIZE,(this.positionMainConfig.tab_playlist.y+193*t)*window.GameConfig.RESIZE,this.positionMainConfig.tab_playlist.nameAtlas,function(){},this,null,this.positionMainConfig.tab_playlist.nameSprite);i.anchor.set(.5,0);var o=new Phaser.Graphics(game,0,0);o.beginFill(16777215),o.drawRoundedRect(-283*window.GameConfig.RESIZE,5*window.GameConfig.RESIZE,105*window.GameConfig.RESIZE,105*window.GameConfig.RESIZE,10*window.GameConfig.RESIZE),i.addChild(o);var a=new gl(-283*window.GameConfig.RESIZE,5,"Nhactre",e.thumb,t);a.sprite.scale.set(105/165),a.sprite.mask=o,i.addChild(a.sprite);var s=new Phaser.Text(game,this.positionMainConfig.txt_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.txt_playlist.y*window.GameConfig.RESIZE,"".concat(e.name),this.positionMainConfig.txt_playlist.configs);i.addChild(s);var r=new Mh;r.x=this.positionMainConfig.level_playlist.x*window.GameConfig.RESIZE,r.y=this.positionMainConfig.level_playlist.y*window.GameConfig.RESIZE,e.user&&r.setData(e.user),i.addChild(r),this.resizeTxtAndLevel(s,r),i.id=e.id,i.name=e.name,this.addChild(i),i.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),n.event.choosePlaylist.dispatch({id:i.id,name:i.name})}),LogConsole.log(i.height),this.addLineUnder(i),this.listView.add(i)}},{key:"resizeTxtAndLevel",value:function(e,t){console.log(e.height,t.height);var n=(139-(e.height+t.height))/2;e.y=n-15*window.GameConfig.RESIZE,t.y=e.y+e.height+7}},{key:"addLineUnder",value:function(e){var t=new rt(this.positionMainConfig.line_under);e.addChild(t)}},{key:"destroyAll",value:function(){this.removeAllChild(),this.destroy(),this.listView&&(this.listView.removeAll(),this.listView.y&&this.listView.reset(),this.listView.destroy())}},{key:"removeAllChild",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"destroy",value:function(){for(this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&od(n.prototype,i),o&&od(n,o),t}();function hd(e){return(hd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ud(e,t){return!t||"object"!==hd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dd(e){return(dd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fd(e,t){return(fd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pd=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ud(this,dd(t).call(this,game))).friend=e,n.afterInit(),n.playlist={id:null,name:null},n.event={choosePlaylist:new Phaser.Signal,backScreen:new Phaser.Signal},n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.challPlaylistGroupMenuModule=null,this.sendRequestGetPlaylist()}},{key:"sendRequestGetPlaylist",value:function(){1==Kr.instance().ktLoadPlaylist?this.loadPlaylistComplete():Kr.instance().sendGetDataShop()}},{key:"sendRequestChoosePlaylist",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),t.putInt("opponent_id",this.friend.id),mZ.instance().sendData(Et.CHALLENGE_GAME_QUESTIONS_REQUEST,t),qe.instance().showLoading()}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.choosePlaylistBack,this),Kr.instance().event.load_playlist_complete.add(this.loadPlaylistComplete,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.choosePlaylistBack,this),Kr.instance().event.load_playlist_complete.remove(this.loadPlaylistComplete,this)}},{key:"onExtensionResponse",value:function(e){}},{key:"loadPlaylistComplete",value:function(){var e=this;this.handleParamsOnGetPlaylistResponse(1,function(){e.addChallPlaylist(),qe.instance().hideLoading()})}},{key:"signalBuyPlaylistDone",value:function(){this.sendRequestGetPlaylist(this.friend.id)}},{key:"handleParamsOnGetPlaylistResponse",value:function(e,t){this.playlists=[],1==e&&(this.playlists=Kr.instance().playlist.getArrMe(),this.playlists=this.playlists.sort(this.sortPlaylists),this.handleSuggestionPlaylist(),t())}},{key:"sortPlaylists",value:function(e,t){return e.user_playlist_mapping?e.user_playlist_mapping.updated>t.user_playlist_mapping.updated?-1:e.user_playlist_mapping.updated<t.user_playlist_mapping.updated?1:0:1}},{key:"handleSuggestionPlaylist",value:function(){this.suggestion_playlist=Kr.instance().playlist.getSuggestPlaylist(),this.suggestion_playlist.isFree=Math.round(Math.random())}},{key:"addChallPlaylist",value:function(){this.removeChallPlaylist(),this.challPlaylistGroupMenuModule=new ld(this.friend),this.challPlaylistGroupMenuModule.signalBuyPlaylistDone.add(this.signalBuyPlaylistDone,this),this.challPlaylistGroupMenuModule.event.choosePlaylist.add(this.choosePlaylist,this),this.challPlaylistGroupMenuModule.event.backScreen.add(this.choosePlaylistBack,this),this.challPlaylistGroupMenuModule.addChallPlayListGroup(this.playlists,this.suggestion_playlist),this.addChild(this.challPlaylistGroupMenuModule)}},{key:"choosePlaylistBack",value:function(){this.event.backScreen.dispatch()}},{key:"choosePlaylist",value:function(e){this.playlist=e,this.event.choosePlaylist.dispatch(this.playlist),this.sendRequestChoosePlaylist(e.id)}},{key:"removeChallPlaylist",value:function(){null!==this.challPlaylistGroupMenuModule&&(this.removeChild(this.challPlaylistGroupMenuModule),this.challPlaylistGroupMenuModule.destroy(),this.challPlaylistGroupMenuModule=null)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&cd(n.prototype,i),o&&cd(n,o),t}();function gd(e){return(gd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function md(e,t){return!t||"object"!==gd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vd(e){return(vd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wd(e,t){return(wd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bd=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=md(this,vd(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Mh,this.playlistLevel.x=413*window.GameConfig.RESIZE,this.playlistLevel.y=this.positionPlayConfig.scoreText.y*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:310*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this),this.scoreText.revive()}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=310*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){game.cache.checkImageKey(this.keyAva)?this.ava=new Phaser.Sprite(game,this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionPlayConfig.ava_fb.y*window.GameConfig.RESIZE,this.keyAva):this.ava=new Phaser.Sprite(game,this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionPlayConfig.ava_fb.y*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.width=151,this.ava.height=151,this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(16777215),this.maskAva.drawCircle(this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionPlayConfig.ava_fb.y*window.GameConfig.RESIZE,151),this.maskAva.anchor.set(.5),this.ava.mask=this.maskAva,this.addChild(this.ava),this.addChild(this.maskAva),this.frameAva=new Phaser.Sprite(game,this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionPlayConfig.ava_fb.y*window.GameConfig.RESIZE,this.positionPlayConfig.frame_ava_right.nameAtlas,this.positionPlayConfig.frame_ava_right.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.875*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionPlayConfig.nameFB.x*window.GameConfig.RESIZE,this.positionPlayConfig.nameFB.y*window.GameConfig.RESIZE,this.nameValue,this.positionPlayConfig.nameFB.configs),this.name.anchor.set(.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionPlayConfig.scoreText.x*window.GameConfig.RESIZE,this.positionPlayConfig.scoreText.y*window.GameConfig.RESIZE,this.scoreValue,this.positionPlayConfig.scoreText.configs),this.scoreText.anchor.set(.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){this.dotOnline=new rt(this.positionPlayConfig.dot_online_right),this.addChild(this.dotOnline)}}])&&yd(n.prototype,i),o&&yd(n,o),t}();function Sd(e){return(Sd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ed(e,t){return!t||"object"!==Sd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cd(e){return(Cd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kd(e,t){return(kd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pd=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ed(this,Cd(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=-this.positionPlayConfig.avaOpp.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse,this.playlistLevel}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Mh,this.playlistLevel.x=78*window.GameConfig.RESIZE,this.playlistLevel.y=this.positionPlayConfig.scoreTextOpp.y*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:310*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this),this.scoreText.revive()}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=310*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){var e=this;this.ava=new gl(this.positionPlayConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.avaOpp.y*window.GameConfig.RESIZE,"ava-default",this.keyAva,1),this.ava.sprite.anchor.set(.5),this.ava.event.loadAvaDone.add(function(t){e.ava.sprite.width=151,e.ava.sprite.height=151},this),this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(16777215),this.maskAva.drawCircle(this.positionPlayConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.avaOpp.y*window.GameConfig.RESIZE,151),this.maskAva.anchor.set(.5),this.ava.sprite.mask=this.maskAva,this.addChild(this.ava.sprite),this.addChild(this.maskAva),this.frameAva=new Phaser.Sprite(game,this.positionPlayConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.avaOpp.y*window.GameConfig.RESIZE,this.positionPlayConfig.frame_ava_left.nameAtlas,this.positionPlayConfig.frame_ava_left.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.875*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionPlayConfig.nameFBOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.nameFBOpp.y*window.GameConfig.RESIZE,this.nameValue,this.positionPlayConfig.nameFBOpp.configs),this.name.anchor.set(.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionPlayConfig.scoreTextOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.scoreTextOpp.y*window.GameConfig.RESIZE,this.scoreValue,this.positionPlayConfig.scoreTextOpp.configs),this.scoreText.anchor.set(.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){1==this.configs.is_online?this.dotOnline=new rt(this.positionPlayConfig.dot_online_left):this.dotOnline=new rt(this.positionPlayConfig.dot_offline_left),this.addChild(this.dotOnline)}}])&&_d(n.prototype,i),o&&_d(n,o),t}();function Od(e){return(Od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xd(e){return(xd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Td(e,t){return(Td=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Id(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ad=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,s=xd(t).call(this,game),(o=!s||"object"!==Od(s)&&"function"!=typeof s?Id(a):s).posX=e,o.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),o.sprite=new Phaser.Button(game,e+640,n,o.positionPlayConfig.answer_tab.nameAtlas,function(){},Id(Id(o)),null,o.positionPlayConfig.answer_tab.nameSprite),o.sprite.anchor=new Phaser.Point(.5,.5),o.sprite.update=o.update.bind(Id(Id(o))),o.sprite.inputEnabled=!0,o.configs=i,o.choosed=!1,o.addChild(o.sprite),o.event={answer:new Phaser.Signal},o.addTextToTabAnswer(),o.sprite.events.onInputDown.add(function(){o.choosed=!0,o.event.answer.dispatch(o.configs.index)}),o.addTweenSprite(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Td(e,t)}(t,Phaser.Group),n=t,(i=[{key:"addTweenSprite",value:function(){var e=this;setTimeout(function(){game.add.tween(e.sprite).to({x:e.posX},300,Phaser.Easing.Power1,!1).start()},200*(this.configs.index+1))}},{key:"update",value:function(){}},{key:"displayScreenWhenAnswerRight",value:function(){this.sprite.inputEnabled=!1,this.answerText.addColor("#01c66a",0)}},{key:"displayScreenWhenAnswerWrong",value:function(){this.sprite.inputEnabled=!1,this.answerText.addColor("#ff0000",0)}},{key:"displayScreenWhenAnswerNotChoosed",value:function(){this.answerText.addColor("#ffffff",0),this.sprite.inputEnabled=!1,this.sprite.alpha=.15}},{key:"addTextToTabAnswer",value:function(){this.answerText=new Phaser.Text(game,0,0,"".concat(this.configs.questions[this.configs.countQuiz].answers[this.configs.index]),{font:"GilroyMedium",fill:"#000000",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:500}),this.answerText.anchor.set(.5),this.sprite.value=this.configs.index+1,this.sprite.addChild(this.answerText)}},{key:"hide",value:function(){this.answerText.addColor("#ffffff",0),this.sprite.alpha=.15,this.sprite.inputEnabled=!1}},{key:"activeInput",value:function(){this.sprite.inputEnabled=!0}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Rd(n.prototype,i),o&&Rd(n,o),t}();function Ld(e){return(Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Dd(e){return(Dd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Md(e,t){return(Md=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Bd=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Dd(t).call(this,game,null))||"object"!==Ld(i)&&"function"!=typeof i?Nd(n):i).trueAnswer=new Phaser.Sprite(game,0,0,"trueanswer"),e.trueAnswer.animations.add("trueanswer").onComplete.add(e.animTrueAnswerComplete,Nd(Nd(e))),e.trueAnswer.visible=!1,e.addChild(e.trueAnswer),e.failAnswer=new Phaser.Sprite(game,0,0,"failanswer"),e.failAnswer.animations.add("failanswer").onComplete.add(e.animFailAnswerComplete,Nd(Nd(e))),e.failAnswer.visible=!1,e.addChild(e.failAnswer),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Md(e,t)}(t,Mt),n=t,(i=[{key:"setSize",value:function(e,t){this.trueAnswer.width=e,this.trueAnswer.height=t,this.failAnswer.width=e,this.failAnswer.height=t}},{key:"animTrueAnswerComplete",value:function(){this.trueAnswer.visible=!1}},{key:"animFailAnswerComplete",value:function(){this.failAnswer.visible=!1}},{key:"setTrueAnswer",value:function(){this.trueAnswer.visible=!0,this.trueAnswer.animations.play("trueanswer",20,!1)}},{key:"setFailtAnswer",value:function(){this.failAnswer.visible=!0,this.failAnswer.animations.play("failanswer",20,!1)}},{key:"destroy",value:function(){this.failAnswer.destroy(),this.trueAnswer.destroy()}}])&&Gd(n.prototype,i),o&&Gd(n,o),t}();function jd(e){return(jd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ud(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fd(e,t){return!t||"object"!==jd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zd(e,t,n){return(Zd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Hd(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Hd(e){return(Hd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qd(e,t){return(Qd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vd=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Fd(this,Hd(t).call(this,game,null))).tween=null,e.countTween=0,e.scaleMin=.8,e.arrStr=["Tốt!","Hay quá","Tuyệt!","Quá giỏi","Đỉnh!","Tuyệt vời","Quá đỉnh","Không thể tin được","Thánh rồi"],e.arrColor=["#0cdb69","#fff222","#0ff5f8"],e.arrSpriteStreak=["actionphaseanswer1","actionphaseanswer2","actionphaseanswer3"],e.arrSize=[70,70,65,70,70,65,70,60,70],e.action=null,e.lbText=new St(e.mainData.positionCreateRoom.text_action_phase_true_answer,""),e.lbText.anchor.set(.5),e.lbText.x=e.getWidth()/2,e.lbText.y=e.getHeight()/2,e.addChild(e.lbText),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qd(e,t)}(t,Mt),n=t,(i=[{key:"addStreak",value:function(){this.removeStreak(),ce.instance().playSound(ce.streakanswer),this.action=new Phaser.Sprite(game,0,0,this.arrSpriteStreak[Un.instance().randomNumber(0,2)]),this.action.animations.add("actionphaseanswer"),this.action.animations.play("actionphaseanswer",30),this.action.x=(this.getWidth()-this.action.width)/2,this.action.y=(this.getHeight()-this.action.height)/2,this.addChildAt(this.action,0)}},{key:"removeStreak",value:function(){null!==this.action&&(this.removeChild(this.action),this.action.destroy(),this.action=null)}},{key:"getWidth",value:function(){return 280}},{key:"getHeight",value:function(){return 280}},{key:"setStreak",value:function(e){(e-=1)<0&&(e=0),e>this.arrStr.length-1&&(e=this.arrStr.length-1),this.countTween=0,this.scaleMin=.8,this.addStreak();var t={fontSize:this.arrSize[e],fill:this.arrColor[Un.instance().randomNumber(0,2)]};this.bounces=100,this.lbText.scale.set(0),this.lbText.changeStyle(t),this.lbText.text=this.arrStr[e].toUpperCase(),this.beginTween(),this.removeIdTime(),this.idTime=game.time.events.add(1.5*Phaser.Timer.SECOND,this.setDefault,this)}},{key:"beginTween",value:function(){this.removeTween(),this.countTween++,1===this.countTween?this.tween=game.add.tween(this.lbText.scale).to({x:1,y:1},150,Phaser.Easing.Sinusoidal.InOut,!0):this.tween=game.add.tween(this.lbText.scale).to({x:1,y:1},this.bounces,Phaser.Easing.Sinusoidal.InOut,!0),this.tween.onComplete.add(this.onCompleteTween,this),this.bounces+=50}},{key:"onCompleteTween",value:function(){this.removeTween(),this.countTween<2&&(this.tween=game.add.tween(this.lbText.scale).to({x:this.scaleMin,y:this.scaleMin},this.bounces,Phaser.Easing.Sinusoidal.InOut,!0),this.tween.onComplete.add(this.beginTween,this),this.bounces+=50,this.scaleMin+=.1)}},{key:"removeTween",value:function(){null!==this.tween&&(game.tweens.remove(this.tween),this.tween=null)}},{key:"removeIdTime",value:function(){null!==this.idTime&&game.time.events.remove(this.idTime)}},{key:"setDefault",value:function(){this.removeIdTime(),this.removeStreak(),this.lbText.text=""}},{key:"destroy",value:function(){this.setDefault(),Zd(Hd(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.getWidth()}}])&&Ud(n.prototype,i),o&&Ud(n,o),t}();function Wd(e){return(Wd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Kd(e,t){return!t||"object"!==Wd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zd(e){return(zd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yd(e,t){return(Yd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jd=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Kd(this,zd(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.event={resultGame:new Phaser.Signal},e.checkUseSpt=!1,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addScreenLoadTurnBase()}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"addScreenLoadTurnBase",value:function(){this.score=0,this.scoreOpp=0,this.countQuiz=0,this.correctList=[],this.wrongList=[],this.streak=1,this.answers=[],this.result,this.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new rt(this.positionPlayConfig.line_top);this.addChild(e),this.loadScreenPlayChallenged("Lượt tiếp"),this.addNamePlaylistAndTextLoading(),this.addActionPhase()}},{key:"addNamePlaylistAndTextLoading",value:function(){this.namePlaylist=new Phaser.Text(game,this.positionPlayConfig.namePlaylist.x*window.GameConfig.RESIZE,(this.positionPlayConfig.namePlaylist.y+80)*window.GameConfig.RESIZE,this.playlist.name,this.positionPlayConfig.namePlaylist.configs),this.namePlaylist.anchor.set(.5),this.addChild(this.namePlaylist),game.add.tween(this.namePlaylist).to({y:this.positionPlayConfig.namePlaylist.y*window.GameConfig.RESIZE},300,Phaser.Easing.Linear.Out,!1).start(),this.loadingAnim=new Fe,this.addChild(this.loadingAnim)}},{key:"addActionPhase",value:function(){this.actionPhase=new Vd,this.actionPhase.position.x=(this.game.width-this.actionPhase.width)/2,this.addChild(this.actionPhase)}},{key:"loadScreenPlayChallenged",value:function(e){var t=new Phaser.Sprite(game,this.positionPlayConfig.versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.versus.nameAtlas,this.positionPlayConfig.versus.nameSprite);t.anchor.set(.5);var n=new Phaser.Text(game,this.positionPlayConfig.txt_versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.text,this.positionPlayConfig.txt_versus.configs);n.anchor.set(.5),t.addChild(n),t.scale.set(.1),this.addChild(t),game.add.tween(t.scale).to({x:1,y:1},400,"Linear").start(),this.UserSpriteRight=new bd,this.UserSpriteRight.setAva("ava_fb"),this.UserSpriteRight.setPosition(),this.UserSpriteRight.setNameAndScore("You",this.score),this.UserSpriteRight.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRight.addDotOnline(),this.addChild(this.UserSpriteRight),this.UserSpriteRight.makeTweenAvaLoading(),this.trueOrFalseUser=new Bd,this.trueOrFalseUser.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseUser.x=320*window.GameConfig.RESIZE,this.trueOrFalseUser.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseUser),this.UserSpriteLeft=new Pd(this.opponent),this.UserSpriteLeft.setAva(this.opponent.avatar),this.UserSpriteLeft.setPosition(),this.UserSpriteLeft.setNameAndScore(this.opponent.userName,e),this.UserSpriteLeft.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeft.addDotOnline(),this.addChild(this.UserSpriteLeft),this.trueOrFalseOpp=new Bd,this.trueOrFalseOpp.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseOpp.x=-10*window.GameConfig.RESIZE,this.trueOrFalseOpp.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseOpp),this.UserSpriteLeft.makeTweenAvaLoading(),this.loadAfter()}},{key:"loadAfter",value:function(){for(var e=[],t=0;t<5;t++)e.push(this.questions[t].songEntity.fileUrl);Dl.instance().loadSoundArray(e),Dl.instance().event.loadComplete.add(this.loadComplete,this)}},{key:"setData",value:function(e,t,n,i,o){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o}},{key:"loadComplete",value:function(){LogConsole.log("load complete"),this.loadingAnim.destroy(),this.makeTweenToPlay()}},{key:"loadStart",value:function(){}},{key:"makeTweenToPlay",value:function(){0==this.countQuiz&&(this.UserSpriteLeft.makeTweenAva(),this.UserSpriteRight.makeTweenAva()),this.addBtnRemoveAnswer(),this.createGamePlayChallenged()}},{key:"createGamePlayChallenged",value:function(){this.timeCounter=game.time.create(),0==this.countQuiz?this.createLoadingScreenAfterStart():this.displayAnswering()}},{key:"addCircleNormal",value:function(){for(var e=this,t=function(t){0==e.countQuiz&&setTimeout(function(){var n=new Phaser.Sprite(game,(e.positionPlayConfig.circleNormal.x+62*t)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y+50)*window.GameConfig.RESIZE,e.positionPlayConfig.circleNormal.nameAtlas,e.positionPlayConfig.circleNormal.nameSprite);n.anchor.set(.5),game.add.tween(n).to({y:(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start(),e.addChild(n)},50*t)},n=0;n<5;n++)t(n)}},{key:"addCorrectListSprites",value:function(){for(var e=0;e<this.correctList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.correctList[e].countQuiz)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Text(game,0,3*window.GameConfig.RESIZE,this.correctList[e].time.toFixed(1),{font:"GilroyBold",fontSize:15});n.anchor.set(.5),t.addChild(n)}}},{key:"addWrongListSprites",value:function(){for(var e=0;e<this.wrongList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.wrongList[e])*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,this.positionPlayConfig.wrongMini.nameAtlas,this.positionPlayConfig.wrongMini.nameSprite);n.anchor.set(.5),t.addChild(n)}}},{key:"createLoadingScreenAfterStart",value:function(){var e=this,t=game.add.audio("beep_audio"),n=new Phaser.Text(game,this.positionPlayConfig.countdownNumber.x*window.GameConfig.RESIZE,(this.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,"3",this.positionPlayConfig.countdownNumber.configs);n.anchor.set(.5),this.addChild(n);var i=game.add.tween(n).to({y:this.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("2");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("1");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){Le.instance().logEvent(Le.pro_quiz_start_turnbase),n.setText("Bắt đầu"),n.scale.set(.5),n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE;var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),i.onComplete.add(function(){n.destroy(),t.destroy(),e.addCircleNormal(),e.displayAnswering()})})})})}},{key:"displayAnswering",value:function(){var e=this;this.namePlaylist.destroy(),this.btn_remove_answer.revive(),Dl.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.timeTweenBegin=game.time.events.add(.5*Phaser.Timer.SECOND,function(){e.spriteTime=new Phaser.Sprite(game,0,(game.height-746)*window.GameConfig.RESIZE,"otherSprites","tween-time"),e.spriteTime.anchor.set(0,.5),e.addChild(e.spriteTime),e.tweenSpriteTime=game.add.tween(e.spriteTime.scale).to({x:70,y:1},1e4,"Linear"),e.createFourAnswer(),e.timeTweenStart=game.time.events.add(.2*Phaser.Timer.SECOND,function(){e.tweenSpriteTime.start(),e.timeCounter.start()},e),e.btn_remove_answer.inputEnabled=!0,e.btn_remove_answer.alpha=1,e.tweenSpriteTime.onComplete.add(function(){})})}},{key:"activeAnswer",value:function(){this.answerA.activeInput(),this.answerB.activeInput(),this.answerC.activeInput(),this.answerD.activeInput()}},{key:"addBtnRemoveAnswer",value:function(){this.btn_remove_answer=new Phaser.Button(game,this.positionPlayConfig.btn_remove_answer.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.btn_remove_answer.y)*window.GameConfig.RESIZE,this.positionPlayConfig.btn_remove_answer.nameAtlas,function(){},this,null,this.positionPlayConfig.btn_remove_answer.nameSprite),this.btn_remove_answer.anchor.set(.5),this.btn_remove_answer.kill();var e=new Phaser.Text(game,this.positionPlayConfig.txt_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.text,this.positionPlayConfig.txt_remove_answer.configs);e.anchor.set(.5);var t=new St(this.positionPlayConfig.txt_dis_one,this.positionPlayConfig.txt_dis_one.text);t.anchor.set(.5),this.btn_remove_answer.addChild(t);var n=new Phaser.Sprite(game,this.positionPlayConfig.diamond_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.nameAtlas,this.positionPlayConfig.diamond_remove_answer.nameSprite);n.anchor.set(1,.5);var i=new rt(this.positionPlayConfig.mic_so_luong);i.anchor.set(.5),this.countMic=mZ.instance().socket.mySelf.getVariable("support_item").value,this.numberOfSptItem=new St(this.positionPlayConfig.number_mic_so_luong,mZ.instance().socket.mySelf.getVariable("support_item").value),this.numberOfSptItem.anchor.set(.5),i.addChild(this.numberOfSptItem),this.btn_remove_answer.addChild(i),this.btn_remove_answer.addChild(n),this.btn_remove_answer.addChild(e),this.btn_remove_answer.inputEnabled=!1,this.btn_remove_answer.events.onInputDown.add(this.sendRemoveAnswer,this),this.addChild(this.btn_remove_answer)}},{key:"removeAnswer",value:function(){this.countMic--,this.numberOfSptItem.setText(this.countMic),this.btn_remove_answer.inputEnabled=!1,this.btn_remove_answer.alpha=.5,Bn.getTwoOfFourAnswer(this.answerA,this.answerB,this.answerC,this.answerD,this.questions[this.countQuiz])}},{key:"sendRemoveAnswer",value:function(){ce.instance().playSound(ce.buttonclick),0==this.checkUseSpt&&(mZ.instance().dataMySeft.support_item>0?mZ.instance().sendData(Et.SUPPORT_REQUEST,null):iC.instance().addDialog("Bạn không đủ Míc"))}},{key:"createFourAnswer",value:function(){for(var e=0;e<4;e++)0==e&&(this.answerA=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerA.event.answer.add(this.updateOnClickAnswer,this),this.addChild(this.answerA)),1==e&&(this.answerB=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerB.event.answer.add(this.updateOnClickAnswer,this),this.addChild(this.answerB)),2==e&&(this.answerC=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerC.event.answer.add(this.updateOnClickAnswer,this),this.addChild(this.answerC)),3==e&&(this.answerD=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerD.event.answer.add(this.updateOnClickAnswer,this),this.addChild(this.answerD))}},{key:"updateOnClickAnswer",value:function(e){if(this.answerA.sprite.inputEnabled=!1,this.answerB.sprite.inputEnabled=!1,this.answerC.sprite.inputEnabled=!1,this.answerD.sprite.inputEnabled=!1,this.answered=e,LogConsole.log(this.questions),LogConsole.log(e),e+1==this.questions[this.countQuiz].correctAnswer){if(this.setActionPhaseOnCorrect(),this.setTrueAva(),this.answeredResult=!0,this.timeCounter.ms/1e3>10)this.score+=Math.floor(100*Math.pow(1,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:10});else{var t=parseFloat((this.timeCounter.ms/1e3).toFixed(1));this.score+=Math.floor(100*(11-t)*Math.pow(11-t,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:t})}this.setScore(this.score),Kr.instance().playlist.setExpPlaylistById(this.playlist.id)}else this.setFalseAva(),this.answeredResult=!1,this.wrongList.push(this.countQuiz);for(var n=0;n<4;n++)0==n&&this.setTrueFalseTabAnswer(this.answerA,n),1==n&&this.setTrueFalseTabAnswer(this.answerB,n),2==n&&this.setTrueFalseTabAnswer(this.answerC,n),3==n&&this.setTrueFalseTabAnswer(this.answerD,n);this.pushResultAnswer(),this.addCorrectListSprites(),this.addWrongListSprites(),this.timeNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.resetQuestion,this)}},{key:"setActionPhaseOnCorrect",value:function(){this.questions[this.countQuiz].correctAnswer>2?this.actionPhase.position.y=game.height-636:this.actionPhase.position.y=game.height-416,this.actionPhase.setStreak(this.streak),this.addChild(this.actionPhase)}},{key:"pushResultAnswer",value:function(){var e="INCORRECT";if(1==this.answeredResult&&(e="CORRECT"),this.timeCounter.ms/1e3>10)this.answers.push({answer_time:10,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0});else{var t=parseFloat((this.timeCounter.ms/1e3).toFixed(1));this.answers.push({answer_time:t,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0})}}},{key:"removeTimeNextQuestion",value:function(){null!==this.timeNextQuestion&&game.time.events.remove(this.timeNextQuestion)}},{key:"resetQuestion",value:function(){this.removeTimeNextQuestion(),this.tweenSpriteTime.stop(),this.timeCounter.stop(),this.actionPhase.setDefault(),this.spriteTime.destroy(),this.timeCounter.destroy(),this.checkUseSpt=!1,this.answerA.destroy(),this.answerB.destroy(),this.answerC.destroy(),this.answerD.destroy(),1==this.answeredResult?this.streak++:this.streak=1,this.countQuiz<4?(this.countQuiz+=1,this.createGamePlayChallenged()):(Dl.instance().removeSound(),this.result={answers:this.answers,score:this.score,opponent_id:this.opponent.id,playlist_id:this.playlist.id},this.event.resultGame.dispatch(this.result))}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SUPPORT_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.removeAnswer()}},{key:"setTrueFalseTabAnswer",value:function(e,t){t==this.answered?t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerWrong():t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerNotChoosed()}},{key:"setTrueAva",value:function(){this.trueOrFalseUser.setTrueAnswer()}},{key:"setFalseAva",value:function(){this.trueOrFalseUser.setFailtAnswer()}},{key:"setTrueAvaOpp",value:function(){this.trueOrFalseOpp.setTrueAnswer()}},{key:"setFalseAvaOpp",value:function(){this.trueOrFalseOpp.setFailtAnswer()}},{key:"setScore",value:function(e){this.UserSpriteRight.setScore(e)}},{key:"setScoreOpp",value:function(e){this.UserSpriteLeft.setScore(e)}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timeTweenBegin),game.time.events.remove(this.timeTweenStart),Dl.instance().event.loadComplete.remove(this.loadComplete,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&qd(n.prototype,i),o&&qd(n,o),t}();function Xd(e){return(Xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ef(e,t){return!t||"object"!==Xd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tf(e){return(tf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nf(e,t){return(nf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var of=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=ef(this,tf(t).call(this,game,0,0,e.tab.nameAtlas,function(){},o,null,e.tab.nameSprite))).configs=e,a.gemCount=n,a.expCount=i,a.anchor.set(.5),a.gem,a.exp,a.txtGem,a.txtExp,a.addGemAndExp(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nf(e,t)}(t,Phaser.Button),n=t,(i=[{key:"addGemAndExp",value:function(){this.gem=new rt(this.configs.gem),this.addChild(this.gem),this.exp=new rt(this.configs.exp),this.addChild(this.exp),this.txtGem=new St(this.configs.txt1,"+".concat(this.gemCount)),this.addChild(this.txtGem),this.txtExp=new St(this.configs.txt2,"+".concat(this.expCount)),this.addChild(this.txtExp);var e=this.gem.width+this.txtGem.width,t=this.exp.width+this.txtExp.width;this.txtGem.x=(-this.width/2-e)/2+5*window.GameConfig.RESIZE,this.gem.x=(-this.width/2-e)/2+this.txtGem.width+10*window.GameConfig.RESIZE,this.txtExp.x=(this.width/2-t)/2-10*window.GameConfig.RESIZE,this.exp.x=(this.width/2-t)/2+this.txtGem.width-5*window.GameConfig.RESIZE}}])&&$d(n.prototype,i),o&&$d(n,o),t}();function af(e){return(af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rf(e,t){return!t||"object"!==af(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lf(e){return(lf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hf(e,t){return(hf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cf=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=rf(this,lf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Mh,this.playlistLevel.x=355*window.GameConfig.RESIZE,this.playlistLevel.y=155*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:200*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this),this.scoreText.revive()}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=190*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){game.cache.checkImageKey(this.keyAva)?this.ava=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,this.keyAva):this.ava=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.width=80,this.ava.height=80;var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawCircle(this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,80),e.anchor.set(.5),this.ava.mask=e,this.addChild(e),this.addChild(this.ava),this.frameAva=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,this.positionWinConfig.frame_ava_right.nameAtlas,this.positionWinConfig.frame_ava_right.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.025*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionWinConfig.nameFB.x*window.GameConfig.RESIZE,140*window.GameConfig.RESIZE,this.nameValue,this.positionWinConfig.nameFB.configs),this.name.anchor.set(1,.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionWinConfig.scoreText.x*window.GameConfig.RESIZE,175*window.GameConfig.RESIZE,this.scoreValue,this.positionWinConfig.scoreText.configs),this.scoreText.anchor.set(1,.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){this.dotOnline=new rt(this.positionWinConfig.dot_online_right_challen),this.addChild(this.dotOnline)}},{key:"addBtnChallenGemAndExp",value:function(){var e=this;this.btnGemAndExp=new of(this.positionWinConfig.btn_gem_exp,1,1),this.btnGemAndExp.x=320,this.btnGemAndExp.y=275,this.btnGemAndExp.scale.set(0),this.addChild(this.btnGemAndExp),game.time.events.add(1*Phaser.Timer.SECOND,function(){game.add.tween(e.btnGemAndExp.scale).to({x:1,y:1},200,"Linear",!0).start()},this)}}])&&sf(n.prototype,i),o&&sf(n,o),t}();function uf(e){return(uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function df(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ff(e,t){return!t||"object"!==uf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pf(e){return(pf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gf(e,t){return(gf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yf=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ff(this,pf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Mh,this.playlistLevel.x=140*window.GameConfig.RESIZE,this.playlistLevel.y=155*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:200*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this),this.scoreText.revive()}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=190*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){var e=this;this.ava=new gl(this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,"ava-default",this.keyAva,0),this.ava.sprite.anchor.set(.5),this.ava.sprite.inputEnabled=!0,this.ava.event.loadAvaDone.add(function(){e.ava.sprite.width=80,e.ava.sprite.height=80},this),this.ava.sprite.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),iC.instance().addUserProfile(e.configs.id)},this);var t=new Phaser.Graphics(game,0,0);t.beginFill(16777215),t.drawCircle(this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,80),t.anchor.set(.5),this.ava.sprite.mask=t,this.addChild(t),this.addChild(this.ava.sprite),this.frameAva=new Phaser.Sprite(game,this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,this.positionWinConfig.frame_ava_left.nameAtlas,this.positionWinConfig.frame_ava_left.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.025*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionWinConfig.nameFBOpp.x*window.GameConfig.RESIZE,140*window.GameConfig.RESIZE,this.nameValue,this.positionWinConfig.nameFBOpp.configs),this.name.anchor.set(0,.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionWinConfig.scoreTextOpp.x*window.GameConfig.RESIZE,170*window.GameConfig.RESIZE,this.scoreValue,{font:"GilroyMedium",fill:"#93909d",fontSize:23}),this.scoreText.anchor.set(0,.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){1==this.configs.is_online?this.dotOnline=new rt(this.positionWinConfig.dot_online_left_challen):this.dotOnline=new rt(this.positionWinConfig.dot_offline_left_challen),this.addChild(this.dotOnline)}}])&&df(n.prototype,i),o&&df(n,o),t}();function mf(e){return(mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wf(e,t){return!t||"object"!==mf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bf(e){return(bf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sf(e,t){return(Sf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _f=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=wf(this,bf(t).call(this,game,e,n,"songDetailSprites","Ava_Playlist"))).anchor.set(.5),o.scale.set(65/165*window.GameConfig.RESIZE),o.positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),o.configValues=i,o.ktPlay=!1,o.ktPause=!1,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sf(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.key="",this.btn,this.addUnBtn(this.positionWinConfig.songDetail_btn_pause),this.addBtn(this.positionWinConfig.songDetail_btn_play)}},{key:"loadAva",value:function(e,t){this.key=e||"",this.idx=t,this.beginLoad()}},{key:"addBtn",value:function(e){this.btn=new Phaser.Sprite(game,e.x,e.y,e.nameAtlas,e.nameSprite),this.btn.scale.set(80/65*window.GameConfig.RESIZE),this.addChild(this.btn)}},{key:"addUnBtn",value:function(e){this.unBtn=new Phaser.Sprite(game,e.x,e.y,e.nameAtlas,e.nameSprite),this.unBtn.scale.set(80/65*window.GameConfig.RESIZE),this.unBtn.kill(),this.addChild(this.unBtn)}},{key:"beginLoad",value:function(){if(game.cache.checkImageKey(this.key))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadComplete.add(this.onLoad,this),e.image(this.key,this.key),e.start()}}},{key:"playsound",value:function(){this.btn.kill(),this.unBtn.revive()}},{key:"stopSound",value:function(){this.btn.revive(),this.unBtn.kill()}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){game.cache.checkImageKey(e.key)&&e.loadTexture(e.key)},100*this.idx)}},{key:"width",get:function(){return 65}},{key:"height",get:function(){return 65}}])&&vf(n.prototype,i),o&&vf(n,o),t}();function Ef(e){return(Ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kf(e,t){return!t||"object"!==Ef(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pf(e){return(Pf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Of(e,t){return(Of=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rf=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=kf(this,Pf(t).call(this,game,285,0,null))).configValues=e,i.result=n,i.opponentResult=o,i.inputEnabled=!0,i.ktPlay=!1,i.index=a,i.anchor.set(.5,0),i.event={playSound:new Phaser.Signal,pauseSound:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Of(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){var e=this,t=new Phaser.Button(game,-114,0,"otherSprites",function(){var t=new uh(e.configValues);game.add.existing(t)},this,null,"Song_Result");this.addChild(t);var n=new Phaser.Sprite(game,0,135*window.GameConfig.RESIZE,"otherSprites","line-box-win");n.anchor.set(.5),this.addChild(n),this.imgAlbum=new _f(-160*window.GameConfig.RESIZE,70*window.GameConfig.RESIZE,this.configValues),this.imgAlbum.loadAva(this.configValues.thumb,this.index),this.imgAlbum.inputEnabled=!0,this.imgAlbum.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),1==e.ktPlay?e.pauseSound():e.event.playSound.dispatch(e.index)},this);var i=new Phaser.Graphics(game,0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE);i.beginFill(16777215),i.drawRoundedRect(-110*window.GameConfig.RESIZE,-110*window.GameConfig.RESIZE,220*window.GameConfig.RESIZE,220*window.GameConfig.RESIZE,10),i.anchor.set(.5),this.imgAlbum.mask=i,this.imgAlbum.addChild(i);var o=this.configValues.song;o=(new Mt).formatName(o,21);var a=new Phaser.Text(game,-99*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"".concat(o),{font:"Gilroy",fill:"#ffffff",wordWrap:!0,wordWrapWidth:500,maxLines:1,fontSize:22});a.anchor.set(0,.5),this.addChild(a);var s=new Phaser.Text(game,-99*window.GameConfig.RESIZE,81*window.GameConfig.RESIZE,"".concat(this.configValues.singer),{font:"Gilroy",fill:"#93909d",fontSize:19});if(s.anchor.set(0,.5),this.addChild(s),"CORRECT"==this.result.result.toUpperCase()){var r=game.add.sprite(230*window.GameConfig.RESIZE,51*window.GameConfig.RESIZE,"otherSprites","v_icon");r.anchor.set(.5),this.addChild(r);var l=new Phaser.Text(game,230*window.GameConfig.RESIZE,77*window.GameConfig.RESIZE,"".concat(this.result.answer_time.toFixed(1),"s"),{font:"GilroyMedium",fill:"#07cf81",fontSize:17});l.anchor.set(.5),this.addChild(l)}else{var h=game.add.sprite(230*window.GameConfig.RESIZE,51*window.GameConfig.RESIZE,"otherSprites","x_icon");h.anchor.set(.5),this.addChild(h);var c=new Phaser.Text(game,230*window.GameConfig.RESIZE,77*window.GameConfig.RESIZE,"".concat(this.result.answer_time.toFixed(1),"s"),{font:"GilroyMedium",fill:"#ff1d58",fontSize:17});c.anchor.set(.5),this.addChild(c)}if(null!==this.opponentResult)if("CORRECT"==this.opponentResult.result.toUpperCase()){var u=game.add.sprite(-230*window.GameConfig.RESIZE,51*window.GameConfig.RESIZE,"otherSprites","v_icon");u.anchor.set(.5),this.addChild(u);var d=new Phaser.Text(game,-230*window.GameConfig.RESIZE,77*window.GameConfig.RESIZE,"".concat(this.opponentResult.answer_time.toFixed(1),"s"),{font:"GilroyMedium",fill:"#07cf81",fontSize:17});d.anchor.set(.5),this.addChild(d)}else{var f=game.add.sprite(-230*window.GameConfig.RESIZE,51*window.GameConfig.RESIZE,"otherSprites","x_icon");f.anchor.set(.5),this.addChild(f);var p=new Phaser.Text(game,-230*window.GameConfig.RESIZE,77*window.GameConfig.RESIZE,"".concat(this.opponentResult.answer_time.toFixed(1),"s"),{font:"GilroyMedium",fill:"#ff1d58",fontSize:17});p.anchor.set(.5),this.addChild(p)}this.addChild(this.imgAlbum)}},{key:"pauseSound",value:function(){this.ktPlay=!1,this.imgAlbum.stopSound(),Dl.instance().pauseSound()}},{key:"stopSound",value:function(){this.ktPlay=!1,this.imgAlbum.stopSound()}},{key:"playSound",value:function(){!1===this.ktPlay&&(this.ktPlay=!0,Dl.instance().playsound(this.configValues.listenLink),this.imgAlbum.playsound())}},{key:"height",get:function(){return 135}}])&&Cf(n.prototype,i),o&&Cf(n,o),t}();function xf(e){return(xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function If(e,t){return!t||"object"!==xf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Af(e){return(Af=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lf(e,t){return(Lf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gf=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=If(this,Af(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),e.addChild(e.bg),e.event={reHome:new Phaser.Signal,nextGame:new Phaser.Signal},e.challenge_msg_updated=0,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this;this.addEventExtension(),this.loadDisplayChallenge(function(){e.handleBtnNext()})}},{key:"handleBtnNext",value:function(){var e=this;if(this.listGame=[],this.gamesList=[],this.challengeGames=[],this.doneGames=[],this.waitingGames=[],this.gamesList=z.instance().menuOpponentsResponse,this.filterResponseGames(),this.listGame=this.checkHasGames(),this.listGame=this.listGame.sort(function(e,t){return e.base_updated-t.base_updated}),this.listGame.length>0&&void 0!==this.listGame){(n=new Phaser.Button(game,374*window.GameConfig.RESIZE,(game.height-81)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"btn_next_game")).anchor.set(.5);var t=new Phaser.Text(game,0,0,"".concat(this.positionWinConfig.txt_btn_next_game.text," ( ").concat(this.listGame.length," )"),this.positionWinConfig.txt_btn_next_game.configs);t.anchor.set(.5),n.addChild(t),n.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),"YOUR_TURN"==e.listGame[0].status?e.listGame[0].turnCount>0?e.event.nextGame.dispatch({opponent:e.listGame[0].opponentEntity,type:"BECHALLENGED",weeklyResult:{userWon:e.listGame[0].weeklyResult.userWon,opponentWon:e.listGame[0].weeklyResult.opponentWon},isHasHistory:!0,gameLogId:e.listGame[0].userGameLog,requestId:e.listGame[0].id,challenge_msg:e.listGame[0].challenge_msg}):e.event.nextGame.dispatch({opponent:e.listGame[0].opponentEntity,type:"BECHALLENGED",weeklyResult:{userWon:e.listGame[0].weeklyResult.userWon,opponentWon:e.listGame[0].weeklyResult.opponentWon},isHasHistory:!1,gameLogId:e.listGame[0].userGameLog,requestId:e.listGame[0].id,challenge_msg:e.listGame[0].challenge_msg}):"NO_GAME"==e.listGame[0].status&&e.event.nextGame.dispatch({opponent:e.listGame[0].opponentEntity,type:"CHALLENGE",weeklyResult:{userWon:e.listGame[0].weeklyResult.userWon,opponentWon:e.listGame[0].weeklyResult.opponentWon,challenge_msg:e.listGame[0].challenge_msg}})}),this.addChild(n)}else{var n;(n=new Phaser.Button(game,374*window.GameConfig.RESIZE,(game.height-81)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"btn_next_game")).anchor.set(.5);var i=new Phaser.Text(game,0,0,"".concat(this.positionWinConfig.txt_btn_find_game.text),this.positionWinConfig.txt_btn_next_game.configs);i.anchor.set(.5),n.addChild(i),n.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),WF.instance().changeScreen(Ce.TURN_BASE)},this),this.addChild(n)}}},{key:"sendRequestMainMenuLoad",value:function(){mZ.instance().sendData(Et.MAIN_MENU_LOAD_REQUEST,null)}},{key:"setData",value:function(e,t,n,i,o,a,s,r,l){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.result=a,this.play_log_id=r,this.request_id=l,this.challenge_msg=s,this.challenge_msg=Bn.formatName(this.challenge_msg,25),LogConsole.log(this.result),LogConsole.log(this.opponent),LogConsole.log(this.questions),LogConsole.log(this.playlist)}},{key:"loadDisplayChallenge",value:function(e){this.UserSpriteRightWin=new cf,this.UserSpriteRightWin.setAva("ava_fb"),this.UserSpriteRightWin.setNameAndScore("You",this.result.score),this.UserSpriteRightWin.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRightWin.makeDefaultScreenNotTween(),this.UserSpriteRightWin.addDotOnline(),this.addChild(this.UserSpriteRightWin),this.UserSpriteLeftWin=new yf(this.opponent),this.UserSpriteLeftWin.setAva(this.opponent.avatar),this.UserSpriteLeftWin.setNameAndScore(this.opponent.userName,"Lượt tiếp"),this.UserSpriteLeftWin.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeftWin.makeDefaultScreenNotTween(),this.UserSpriteLeftWin.addDotOnline(),this.addChild(this.UserSpriteLeftWin),this.createBoxScoreYourChallen(),this.addEditMessage(),e()}},{key:"createBoxScoreYourChallen",value:function(){var e=new Phaser.Sprite(game,0,0,"playSprites","Header"),t=new Phaser.Text(game,game.width/2,38*window.GameConfig.RESIZE,this.playlist.name,{font:"Gilroy",fill:"white",fontSize:23});t.anchor.set(.5),e.addChild(t),this.addChild(e);var n=new Phaser.Graphics(game,0,(game.height-785)*window.GameConfig.RESIZE);n.beginFill(),n.drawRect(0,0,game.width,(game.height-491)*window.GameConfig.RESIZE),n.endFill(),this.addChild(n);var i=new Phaser.Button(game,game.width/2,1200*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Box_ketqua_old");i.anchor.set(.5,0),i.mask=n,this.UserSpriteRightWin.addBtnChallenGemAndExp(),this.addChild(i);var o=new Phaser.Group(game,0,0);o.y=1200,this.addChild(o);var a=new Phaser.Rectangle(35,0,615*window.GameConfig.RESIZE,(game.height-510)*window.GameConfig.RESIZE);this.listView=new Jo(game,o,a,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addTweenBoxResult(i,o);for(var s=0;s<5;s++){var r=new Rf(this.questions[s].songEntity,this.result.answers[s],null,s);r.event.playSound.add(this.playSongResult,this),this.listView.add(r)}var l=new rt(this.positionWinConfig.shadow);l.y=game.height-z.instance().STANDARD_HEIGHT+this.positionWinConfig.shadow.y,this.addChild(l);var h=new Phaser.Button(game,80*window.GameConfig.RESIZE,(game.height-81)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Button_home");h.anchor.set(.5),h.events.onInputUp.add(this.backHome,this),this.addChild(h)}},{key:"addEditMessage",value:function(){this.txtEdit=new Phaser.Text(game,this.positionWinConfig.edit_message.txt.x,this.positionWinConfig.edit_message.txt.y,this.challenge_msg,this.positionWinConfig.edit_message.txt.configs),this.txtEdit.anchor.set(.5),this.addChild(this.txtEdit),this.btnEdit=new Phaser.Button(game,480,329,this.positionWinConfig.edit_message.btn.nameAtlas,this.onClickEditMessage,this,null,this.positionWinConfig.edit_message.btn.nameSprite),this.btnEdit.anchor.set(.5),this.addChild(this.btnEdit)}},{key:"onClickEditMessage",value:function(){rl.instance().show({maxLength:"",showTransparent:!0,placeholder:"Nhắn tin",isSearch:!1,typeInputText:"search",configText:{width:250,height:40,x:180,y:300}}),rl.instance().setValue(this.txtEdit.text)}},{key:"backHome",value:function(){ce.instance().playSound(ce.buttonclick),this.event.reHome.dispatch()}},{key:"playSongResult",value:function(e){Dl.instance().pauseSound();for(var t=0;t<this.listView.grp.children.length;t++){var n=this.listView.grp.children[t];n.index!==e?n.stopSound():n.playSound()}}},{key:"addTweenBoxResult",value:function(e,t){game.add.tween(e).to({y:(game.height-765)*window.GameConfig.RESIZE},500,"Linear",!1).start(),game.add.tween(t).to({y:(game.height-765)*window.GameConfig.RESIZE},500,"Linear",!1).start()}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.MAIN_MENU_LOAD_RESPONSE&&("OK"==e.params.getUtfString("status")||console.error("MAIN_MENU_LOAD_RESPONSE not response: ".concat(e.params.errorMessage)))}},{key:"filterResponseGames",value:function(){this.waitingGames=this.gamesList.filter(function(e){return"THEIR_TURN"==e.status}),this.doneGames=this.gamesList.filter(function(e){return"NO_GAME"==e.status}),this.challengeGames=this.gamesList.filter(function(e){return"YOUR_TURN"==e.status})}},{key:"checkHasGames",value:function(){return void 0!==this.challengeGames?this.challengeGames.concat(this.doneGames):[]}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.backHome,this),rl.instance().event.enter.add(this.doneKeyboard,this),rl.instance().event.submit.add(this.doneKeyboard,this)}},{key:"doneKeyboard",value:function(){var e=(new Date).getTime();e-this.challenge_msg_updated>6e3?(this.challenge_msg=rl.instance().getValue(),this.challenge_msg=Bn.formatName(this.challenge_msg,25),this.txtEdit.setText(this.challenge_msg),this.challenge_msg_updated=e,this.updateChallengeMsg(),rl.instance().hide()):(Gn.instance().addDialog("Bạn thay đổi quá nhanh, vui lòng thử lại"),rl.instance().hide())}},{key:"updateChallengeMsg",value:function(){var e=new SFS2X.SFSObject;e.putUtfString("challenge_msg",this.challenge_msg),e.putLong("challenge_request_id",this.request_id),mZ.instance().sendData(Et.CHALLENGE_GAME_UPDATE_MESSAGE_REQUEST,e)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.backHome,this),rl.instance().event.enter.remove(this.doneKeyboard,this),rl.instance().event.submit.remove(this.doneKeyboard,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Tf(n.prototype,i),o&&Tf(n,o),t}();function Df(e){return(Df="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nf(e,t){return!t||"object"!==Df(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bf(e,t,n){return(Bf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jf(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function jf(e){return(jf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uf(e,t){return(Uf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ff=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Nf(this,jf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse,this.dotOnline,this.btnGemAndExp}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Mh,this.playlistLevel.x=348*window.GameConfig.RESIZE,this.playlistLevel.y=272*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:323*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this)}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=272*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){game.cache.checkImageKey(this.keyAva)?this.ava=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionWinConfig.ava_fb.y*window.GameConfig.RESIZE,this.keyAva):this.ava=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionWinConfig.ava_fb.y*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.width=80,this.ava.height=80;var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawCircle(this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionWinConfig.ava_fb.y*window.GameConfig.RESIZE,80),e.anchor.set(.5),this.ava.mask=e,this.addChild(e),this.addChild(this.ava),this.frameAva=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionWinConfig.ava_fb.y*window.GameConfig.RESIZE,this.positionWinConfig.frame_ava_right.nameAtlas,this.positionWinConfig.frame_ava_right.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.035*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionWinConfig.nameFB.x*window.GameConfig.RESIZE,this.positionWinConfig.nameFB.y*window.GameConfig.RESIZE,this.nameValue,this.positionWinConfig.nameFB.configs),this.name.anchor.set(1,.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionWinConfig.scoreText.x*window.GameConfig.RESIZE,this.positionWinConfig.scoreText.y*window.GameConfig.RESIZE,this.scoreValue,this.positionWinConfig.scoreText.configs),this.scoreText.anchor.set(1,.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){this.dotOnline=new rt(this.positionWinConfig.dot_online_right),this.addChild(this.dotOnline)}},{key:"addBtnWinGemAndExp",value:function(){var e=this;this.btnGemAndExp=new of(this.positionWinConfig.btn_gem_exp,2,2),this.btnGemAndExp.x=320,this.btnGemAndExp.y=350,this.btnGemAndExp.scale.set(0),this.addChild(this.btnGemAndExp),this.timeTweenBtn=game.time.events.add(1*Phaser.Timer.SECOND,function(){game.add.tween(e.btnGemAndExp.scale).to({x:1,y:1},200,"Linear",!0).start()},this)}},{key:"addBtnLoseGemAndExp",value:function(){var e=this;this.btnGemAndExp=new of(this.positionWinConfig.btn_gem_exp,1,1),this.btnGemAndExp.x=320,this.btnGemAndExp.y=350,this.btnGemAndExp.scale.set(0),this.addChild(this.btnGemAndExp),this.timeTweenBtn=game.time.events.add(1*Phaser.Timer.SECOND,function(){game.add.tween(e.btnGemAndExp.scale).to({x:1,y:1},200,"Linear",!0).start()},this)}},{key:"destroy",value:function(){game.time.events.remove(this.timeTweenBtn),Bf(jf(t.prototype),"destroy",this).call(this)}}])&&Mf(n.prototype,i),o&&Mf(n,o),t}();function Zf(e){return(Zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qf(e,t){return!t||"object"!==Zf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vf(e){return(Vf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wf(e,t){return(Wf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qf=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Qf(this,Vf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Mh,this.playlistLevel.x=155*window.GameConfig.RESIZE,this.playlistLevel.y=272*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:324*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this)}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=272*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){var e=this;this.ava=new gl(this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.avaOpp.y*window.GameConfig.RESIZE,"ava-default",this.keyAva,0),this.ava.sprite.anchor.set(.5),this.ava.sprite.inputEnabled=!0,this.ava.event.loadAvaDone.add(function(){e.ava.sprite.width=80,e.ava.sprite.height=80},this),this.ava.sprite.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),iC.instance().addUserProfile(e.configs.id)},this);var t=new Phaser.Graphics(game,0,0);t.beginFill(16777215),t.drawCircle(this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.avaOpp.y*window.GameConfig.RESIZE,80),t.anchor.set(.5),this.ava.sprite.mask=t,this.addChild(this.ava.sprite),this.addChild(t),this.frameAva=new Phaser.Sprite(game,this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.avaOpp.y*window.GameConfig.RESIZE,this.positionWinConfig.frame_ava_left.nameAtlas,this.positionWinConfig.frame_ava_left.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.035*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionWinConfig.nameFBOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.nameFBOpp.y*window.GameConfig.RESIZE,this.nameValue,this.positionWinConfig.nameFBOpp.configs),this.name.anchor.set(0,.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionWinConfig.scoreTextOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.scoreTextOpp.y*window.GameConfig.RESIZE,this.scoreValue,this.positionWinConfig.scoreTextOpp.configs),this.scoreText.anchor.set(0,.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){1==this.configs.is_online?this.dotOnline=new rt(this.positionWinConfig.dot_online_left):this.dotOnline=new rt(this.positionWinConfig.dot_offline_left),this.addChild(this.dotOnline)}}])&&Hf(n.prototype,i),o&&Hf(n,o),t}();function Kf(e){return(Kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yf(e,t){return!t||"object"!==Kf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jf(e){return(Jf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xf(e,t){return(Xf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $f=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Yf(this,Jf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),e.addChild(e.bg),e.isLastWeek=!1,e.event={challengeAgain:new Phaser.Signal,reHome:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.loadDisplayBeChallenged(function(){})}},{key:"setData",value:function(e,t,n,i,o,a,s,r,l,h,c){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.result=a,this.play_log_id=l,this.request_id=h,this.opponentAnswerLogs=s,this.weeklyResult=r,this.dataTurnbase=c,LogConsole.log(this.result),LogConsole.log(this.opponent),LogConsole.log(this.questions),LogConsole.log(this.playlist),LogConsole.log(this.opponentAnswerLogs),LogConsole.log(this.weeklyResult)}},{key:"loadDisplayBeChallenged",value:function(e){this.UserSpriteRightWin=new Ff,this.UserSpriteRightWin.setAva("ava_fb"),this.UserSpriteRightWin.setNameAndScore("You",this.result.score),this.UserSpriteRightWin.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRightWin.makeDefaultScreenNotTween(this.user_playlist_mapping),this.UserSpriteRightWin.addDotOnline(),this.addChild(this.UserSpriteRightWin),this.UserSpriteLeftWin=new qf(this.opponent),this.UserSpriteLeftWin.setAva(this.opponent.avatar),this.UserSpriteLeftWin.setNameAndScore(this.opponent.userName,this.result.scoreOpp),this.UserSpriteLeftWin.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeftWin.makeDefaultScreenNotTween(),this.UserSpriteLeftWin.addDotOnline(),this.addChild(this.UserSpriteLeftWin),this.createBoxScoreFriendChallen(),e()}},{key:"createBoxScoreFriendChallen",value:function(){var e=this;console.log("createBoxScoreFriendChallencreateBoxScoreFriendChallen"),console.log(this.weeklyResult);var t=new Phaser.Text(game,game.width/2,485*window.GameConfig.RESIZE,"Kết quả trong tuần",{font:"Gilroy",fill:"#9d92a6",fontSize:19});t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,"playSprites","Header"),i=new Phaser.Text(game,game.width/2,35*window.GameConfig.RESIZE,this.playlist.name,{font:"Gilroy",fill:"white",fontSize:23});i.anchor.set(.5),n.addChild(i),this.addChild(n);var o=new Phaser.Graphics(game,0,551*window.GameConfig.RESIZE);o.beginFill(),o.drawRect(0,0,game.width,(game.height-676)*window.GameConfig.RESIZE),o.endFill(),this.addChild(o);var a=new Phaser.Button(game,game.width/2,1200*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Box_ketqua_old");a.anchor.set(.5,0),a.mask=o;var s=new Phaser.Text(game,game.width/2,520*window.GameConfig.RESIZE,"Score",{font:"GilroyBold",fill:"white",fontSize:30});if(this.result.score>this.result.scoreOpp){ce.instance().playSound(ce.winturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Chiến thắng !!!",{font:"GilroyBold",fill:"white",fontSize:43})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon+1));var r=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,140*window.GameConfig.RESIZE,"firework");r.anchor.set(.5),this.addChild(r);r.animations.add("run_win");r.animations.play("run_win",30,!0),this.addChild(l),this.UserSpriteRightWin.addBtnWinGemAndExp()}else if(this.result.score==this.result.scoreOpp){ce.instance().playSound(ce.loseturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Điểm số hòa !!!",{font:"GilroyBold",fill:"white",fontSize:43})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon)),this.addChild(l),this.UserSpriteRightWin.addBtnLoseGemAndExp()}else{var l;ce.instance().playSound(ce.loseturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Thua cuộc !!!",{font:"GilroyBold",fill:"white",fontSize:43})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon+1," - ").concat(this.weeklyResult.userWon)),this.addChild(l),this.UserSpriteRightWin.addBtnLoseGemAndExp()}s.anchor.set(.5),this.addChild(s),this.addChild(a);var h=new Phaser.Group(game,0,0);h.y=1200,this.addChild(h);var c=new Phaser.Rectangle(35,0,615*window.GameConfig.RESIZE,(game.height-685)*window.GameConfig.RESIZE);this.listView=new Jo(game,h,c,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addTweenBoxResult(a,h);for(var u=0;u<5;u++){var d=new Rf(this.questions[u].songEntity,this.result.answers[u],this.opponentAnswerLogs[u],u);d.event.playSound.add(this.playSongResult,this),this.listView.add(d)}var f=new rt(this.positionWinConfig.shadow);f.y=game.height-z.instance().STANDARD_HEIGHT+this.positionWinConfig.shadow.y,this.addChild(f);var p=new Phaser.Button(game,378*window.GameConfig.RESIZE,(game.height-86)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"btn_next_game");p.anchor.set(.5),this.addChild(p);var g=new Phaser.Text(game,0,0,this.positionWinConfig.txt_challenge_your_turn.text,this.positionWinConfig.txt_challenge_your_turn.configs);g.anchor.set(.5),p.addChild(g),p.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),e.event.challengeAgain.dispatch()},this);var y=new Phaser.Button(game,this.positionWinConfig.share.x*window.GameConfig.RESIZE,this.positionWinConfig.share.y*window.GameConfig.RESIZE,this.positionWinConfig.share.nameAtlas,function(){},this,null,this.positionWinConfig.share.nameSprite);y.anchor.set(.5),y.events.onInputUp.add(this.shareResult,this),this.addChild(y);var m=new Phaser.Button(game,80*window.GameConfig.RESIZE,(game.height-86)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Button_home");m.anchor.set(.5),m.events.onInputUp.add(this.backHome,this),this.addChild(m),this.addMessageOpp(),this.addBtnLastWeekResult()}},{key:"addBtnLastWeekResult",value:function(){this.btnLastWeekResult=new Phaser.Button(game,this.positionWinConfig.last_week.x*window.GameConfig.RESIZE,this.positionWinConfig.last_week.y*window.GameConfig.RESIZE,this.positionWinConfig.last_week.nameAtlas,function(){},this,null,this.positionWinConfig.last_week.nameSprite),this.btnLastWeekResult.anchor.set(.5),this.btnLastWeekResult.events.onInputUp.add(this.chooseLastWeek,this);var e=new Phaser.Text(game,this.positionWinConfig.last_week.txt.x,this.positionWinConfig.last_week.txt.y,this.positionWinConfig.last_week.txt.text,this.positionWinConfig.last_week.txt.configs);e.anchor.set(.5),this.btnLastWeekResult.addChild(e),this.addChild(this.btnLastWeekResult)}},{key:"chooseLastWeek",value:function(){ce.instance().playSound(ce.buttonclick),this.isLastWeek=!0,iC.instance().addLastWeekResultScreen(this.opponent)}},{key:"addMessageOpp",value:function(){if(void 0!==this.dataTurnbase.challenge_msg&&""!==this.dataTurnbase.challenge_msg&&null!==this.dataTurnbase.challenge_msg){var e=new Phaser.Sprite(game,75,298,"playSprites","Box_Chat_02");this.addChild(e),this.msgChallenge=new Phaser.Text(game,25,25,this.dataTurnbase.challenge_msg,{font:"Gilroy",fill:"#333333",fontSize:18,wordWrap:!0,wordWrapWidth:130,align:"center"});var t=20*window.GameConfig.RESIZE,n={x:35,y:310,nameAtlas:"mailSprites",nameSprite:"Box_Chat_01",left:25,right:25,top:25,bot:25,width:0,height:0,name:"challengeMsg"};n.width=(this.msgChallenge.width+t)/window.GameConfig.RESIZE,n.height=(this.msgChallenge.height+t)/window.GameConfig.RESIZE,this.bg=new Zt(n),this.bg.addChild(this.msgChallenge),this.addChild(this.bg),this.msgChallenge.x=t/2,this.msgChallenge.y=t/2}}},{key:"playSongResult",value:function(e){Dl.instance().pauseSound();for(var t=0;t<this.listView.grp.children.length;t++){var n=this.listView.grp.children[t];n.index!==e?n.stopSound():n.playSound()}}},{key:"shareResult",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"onShared",value:function(e){e.hasOwnProperty("error_code")||this.sendShareResult()}},{key:"sendShareResult",value:function(){mZ.instance().sendData(Et.FB_USER_SHARED_RESULT_REQUEST,null)}},{key:"onExtensionResponse",value:function(e){}},{key:"addTweenBoxResult",value:function(e,t){game.add.tween(e).to({y:551*window.GameConfig.RESIZE},500,"Linear",!1).start(),game.add.tween(t).to({y:551*window.GameConfig.RESIZE},500,"Linear",!1).start()}},{key:"backHome",value:function(){ce.instance().playSound(ce.buttonclick),0==this.isLastWeek&&this.event.reHome.dispatch()}},{key:"backLastWeek",value:function(){this.isLastWeek=!1}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.backHome,this),De.instance().event.backLastWeek.add(this.backLastWeek,this),ui.instance().event.share.add(this.onShared,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.backHome,this),De.instance().event.backLastWeek.remove(this.backLastWeek,this),ui.instance().event.share.remove(this.onShared,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&zf(n.prototype,i),o&&zf(n,o),t}();function ep(e){return(ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function np(e,t){return!t||"object"!==ep(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ip(e){return(ip=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function op(e,t){return(op=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ap=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=np(this,ip(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),n.type=e,n.screenChallenge=null,n.screenBeChallenged=null,n.challenge_msg="",n.event={screenReHome:new Phaser.Signal,screenBeChallengedChallengAgain:new Phaser.Signal,screenChallengeNextGame:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&op(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){}},{key:"addScreen",value:function(){"CHALLENGE"==this.type?this.addScreenChallenge():this.addScreenBeChallenged(),li.instance().playTurnBase(),li.instance().showInterstitialTurnBase()}},{key:"addScreenChallenge",value:function(){this.removeScreenChallenge(),this.screenChallenge=new Gf,this.screenChallenge.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.result,this.challenge_msg,this.play_log_id,this.request_id),this.screenChallenge.afterInit(),this.screenChallenge.event.reHome.add(this.screenReHome,this),this.screenChallenge.event.nextGame.add(this.screenChallengeNextGame,this),this.addChild(this.screenChallenge)}},{key:"removeScreenChallenge",value:function(){null!==this.screenChallenge&&(this.removeChild(this.screenChallenge),this.screenChallenge.destroy(),this.screenChallenge=null)}},{key:"screenReHome",value:function(){this.event.screenReHome.dispatch()}},{key:"screenChallengeNextGame",value:function(e){this.event.screenChallengeNextGame.dispatch(e)}},{key:"addScreenBeChallenged",value:function(){this.removeScreenBeChallenged(),this.screenBeChallenged=new $f,this.screenBeChallenged.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.result,this.opponentAnswerLogs,this.weeklyResult,this.play_log_id,this.request_id,this.dataTurnbase),this.screenBeChallenged.afterInit(),this.screenBeChallenged.event.challengeAgain.add(this.challengeAgain,this),this.screenBeChallenged.event.reHome.add(this.screenReHome,this),this.addChild(this.screenBeChallenged)}},{key:"removeScreenBeChallenged",value:function(){null!==this.screenBeChallenged&&(this.removeChild(this.screenBeChallenged),this.screenBeChallenged.destroy(),this.screenBeChallenged=null)}},{key:"challengeAgain",value:function(){this.event.screenBeChallengedChallengAgain.dispatch()}},{key:"setData",value:function(e,t,n,i,o,a,s){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.result=a,this.challenge_msg=s}},{key:"setDataBeChallenged",value:function(e,t,n,i,o,a){"BECHALLENGED"==this.type&&(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.opponentAnswerLogs=i,this.weeklyResult=o,this.dataTurnbase=a)}},{key:"setDataChallenge",value:function(e,t){"CHALLENGE"==this.type&&(this.play_log_id=e,this.request_id=t)}}])&&tp(n.prototype,i),o&&tp(n,o),t}();function sp(e){return(sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lp(e,t){return!t||"object"!==sp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hp(e){return(hp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cp(e,t){return(cp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var up=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=lp(this,hp(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.event={resultGame:new Phaser.Signal},e.checkUseSpt=!1,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addScreenLoadTurnBase()}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"addScreenLoadTurnBase",value:function(){this.score=0,this.scoreOpp=0,this.countQuiz=0,this.correctList=[],this.wrongList=[],this.streak=1,this.answers=[],this.result,this.timeNextQuestion=null,this.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new rt(this.positionPlayConfig.line_top);this.addChild(e),this.loadScreenPlayChallenged(this.scoreOpp),this.addNamePlaylistAndTextLoading(),this.addActionPhase()}},{key:"addNamePlaylistAndTextLoading",value:function(){this.namePlaylist=new Phaser.Text(game,this.positionPlayConfig.namePlaylist.x*window.GameConfig.RESIZE,(this.positionPlayConfig.namePlaylist.y+80)*window.GameConfig.RESIZE,this.playlist.name,this.positionPlayConfig.namePlaylist.configs),this.namePlaylist.anchor.set(.5),this.addChild(this.namePlaylist),game.add.tween(this.namePlaylist).to({y:this.positionPlayConfig.namePlaylist.y*window.GameConfig.RESIZE},300,Phaser.Easing.Linear.Out,!1).start(),this.loadingAnim=new Fe,this.addChild(this.loadingAnim)}},{key:"addActionPhase",value:function(){this.actionPhase=new Vd,this.actionPhase.position.x=(this.game.width-this.actionPhase.width)/2,this.addChild(this.actionPhase)}},{key:"loadScreenPlayChallenged",value:function(e){var t=new Phaser.Sprite(game,this.positionPlayConfig.versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.versus.nameAtlas,this.positionPlayConfig.versus.nameSprite);t.anchor.set(.5);var n=new Phaser.Text(game,this.positionPlayConfig.txt_versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.text,this.positionPlayConfig.txt_versus.configs);n.anchor.set(.5),t.addChild(n),t.scale.set(.1),this.addChild(t),game.add.tween(t.scale).to({x:1,y:1},400,"Linear").start(),this.UserSpriteRight=new bd,this.UserSpriteRight.setAva("ava_fb"),this.UserSpriteRight.setPosition(),this.UserSpriteRight.setNameAndScore("You",this.score),this.UserSpriteRight.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRight.addDotOnline(),this.addChild(this.UserSpriteRight),this.UserSpriteRight.makeTweenAvaLoading(),this.trueOrFalseUser=new Bd,this.trueOrFalseUser.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseUser.x=320*window.GameConfig.RESIZE,this.trueOrFalseUser.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseUser),this.UserSpriteLeft=new Pd(this.opponent),this.UserSpriteLeft.setAva(this.opponent.avatar),this.UserSpriteLeft.setPosition(),this.UserSpriteLeft.setNameAndScore(this.opponent.userName,e),this.UserSpriteLeft.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeft.addDotOnline(),this.addChild(this.UserSpriteLeft),this.trueOrFalseOpp=new Bd,this.trueOrFalseOpp.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseOpp.x=-10*window.GameConfig.RESIZE,this.trueOrFalseOpp.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseOpp),this.UserSpriteLeft.makeTweenAvaLoading(),this.loadAfter()}},{key:"loadAfter",value:function(){for(var e=[],t=0;t<5;t++)e.push(this.questions[t].songEntity.fileUrl);Dl.instance().loadSoundArray(e),LogConsole.log("arrSongs:------- "),Dl.instance().event.loadComplete.add(this.loadComplete,this)}},{key:"setData",value:function(e,t,n,i,o,a){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.opponentAnswerLogs=a}},{key:"setDataBeChallenged",value:function(e,t,n){this.play_log_id=e,this.request_id=t,this.isHasHistory=n}},{key:"loadComplete",value:function(){LogConsole.log("load complete"),this.loadingAnim.destroy(),this.makeTweenToPlay()}},{key:"loadStart",value:function(){}},{key:"makeTweenToPlay",value:function(){0==this.countQuiz&&(this.UserSpriteLeft.makeTweenAva(),this.UserSpriteRight.makeTweenAva()),this.addBtnRemoveAnswer(),this.createGamePlayChallenged()}},{key:"createGamePlayChallenged",value:function(){this.timeCounter=game.time.create(),0==this.countQuiz?this.createLoadingScreenAfterStart():this.displayAnswering()}},{key:"addCircleNormal",value:function(){for(var e=this,t=function(t){0==e.countQuiz&&setTimeout(function(){var n=new Phaser.Sprite(game,(e.positionPlayConfig.circleNormal.x+62*t)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y+50)*window.GameConfig.RESIZE,e.positionPlayConfig.circleNormal.nameAtlas,e.positionPlayConfig.circleNormal.nameSprite);n.anchor.set(.5),game.add.tween(n).to({y:(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start(),e.addChild(n)},50*t)},n=0;n<5;n++)t(n)}},{key:"addCorrectListSprites",value:function(){for(var e=0;e<this.correctList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.correctList[e].countQuiz)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Text(game,0,3*window.GameConfig.RESIZE,this.correctList[e].time.toFixed(1),{font:"GilroyBold",fontSize:15});n.anchor.set(.5),t.addChild(n)}}},{key:"addWrongListSprites",value:function(){for(var e=0;e<this.wrongList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.wrongList[e])*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,this.positionPlayConfig.wrongMini.nameAtlas,this.positionPlayConfig.wrongMini.nameSprite);n.anchor.set(.5),t.addChild(n)}}},{key:"createLoadingScreenAfterStart",value:function(){var e=this,t=game.add.audio("beep_audio"),n=new Phaser.Text(game,this.positionPlayConfig.countdownNumber.x*window.GameConfig.RESIZE,(this.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,"3",this.positionPlayConfig.countdownNumber.configs);n.anchor.set(.5),this.addChild(n);var i=game.add.tween(n).to({y:this.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("2");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("1");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){Le.instance().logEvent(Le.pro_quiz_start_turnbase),n.setText("Bắt đầu"),n.scale.set(.5),n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE;var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),i.onComplete.add(function(){n.destroy(),t.destroy(),e.addCircleNormal(),e.displayAnswering()})})})})}},{key:"displayAnswering",value:function(){var e=this;this.namePlaylist.destroy(),this.btn_remove_answer.revive(),console.log("LINK PLAY"+this.questions[this.countQuiz].songEntity.fileUrl),Dl.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.timeTweenBegin=game.time.events.add(.5*Phaser.Timer.SECOND,function(){if(e.spriteTime=new Phaser.Sprite(game,0,(game.height-746)*window.GameConfig.RESIZE,"otherSprites","tween-time"),e.spriteTime.anchor.set(0,.5),e.addChild(e.spriteTime),e.tweenSpriteTime=game.add.tween(e.spriteTime.scale).to({x:70,y:1},1e4,"Linear"),e.createFourAnswer(),e.timeTweenStart=game.time.events.add(.2*Phaser.Timer.SECOND,function(){e.tweenSpriteTime.start(),e.timeCounter.start()},e),e.btn_remove_answer.inputEnabled=!0,e.btn_remove_answer.alpha=1,e.tweenSpriteTime.onComplete.add(function(){}),0==e.countQuiz){var t=new en;t.afterInit(),t.addHelperStep4(),t.changeBg(),e.addChild(t),z.instance().playScript.playing_guide==en.DONE_GET_QUEST?e.timePS4=game.time.events.add(1.4*Phaser.Timer.SECOND,function(){t.addStep4UseSupportItem(),t.event.step4.add(e.stepRemoveAnswer,e)}):t.destroy()}if(1==e.countQuiz){var n=new en;n.afterInit(),e.addChild(n),z.instance().playScript.playing_guide==en.DONE_GET_QUEST?(n.addStep9GoodLuck(),z.instance().playScript.playing_guide=en.DONE_ALL):n.destroy()}})}},{key:"stepRemoveAnswer",value:function(){this.tweenSpriteTime.resume(),this.timeCounter.resume(),Dl.instance().resumeSound(),mZ.instance().sendData(Et.PLAY_SCRIPT_DONE_ALL_REQUEST,null),this.sendRemoveAnswer()}},{key:"activeAnswer",value:function(){this.answerA.activeInput(),this.answerB.activeInput(),this.answerC.activeInput(),this.answerD.activeInput()}},{key:"addBtnRemoveAnswer",value:function(){this.btn_remove_answer=new Phaser.Button(game,this.positionPlayConfig.btn_remove_answer.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.btn_remove_answer.y)*window.GameConfig.RESIZE,this.positionPlayConfig.btn_remove_answer.nameAtlas,function(){},this,null,this.positionPlayConfig.btn_remove_answer.nameSprite),this.btn_remove_answer.anchor.set(.5),this.btn_remove_answer.kill();var e=new Phaser.Text(game,this.positionPlayConfig.txt_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.text,this.positionPlayConfig.txt_remove_answer.configs);e.anchor.set(.5);var t=new St(this.positionPlayConfig.txt_dis_one,this.positionPlayConfig.txt_dis_one.text);t.anchor.set(.5),this.btn_remove_answer.addChild(t);var n=new Phaser.Sprite(game,this.positionPlayConfig.diamond_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.nameAtlas,this.positionPlayConfig.diamond_remove_answer.nameSprite);n.anchor.set(1,.5);var i=new rt(this.positionPlayConfig.mic_so_luong);i.anchor.set(.5),this.countMic=mZ.instance().socket.mySelf.getVariable("support_item").value,this.numberOfSptItem=new St(this.positionPlayConfig.number_mic_so_luong,mZ.instance().socket.mySelf.getVariable("support_item").value),this.numberOfSptItem.anchor.set(.5),i.addChild(this.numberOfSptItem),this.btn_remove_answer.addChild(i),this.btn_remove_answer.addChild(n),this.btn_remove_answer.addChild(e),this.btn_remove_answer.inputEnabled=!1,this.btn_remove_answer.events.onInputUp.add(this.sendRemoveAnswer,this),this.addChild(this.btn_remove_answer)}},{key:"removeAnswer",value:function(){this.countMic--,this.numberOfSptItem.setText(this.countMic),this.btn_remove_answer.inputEnabled=!1,this.btn_remove_answer.alpha=.5,Bn.getTwoOfFourAnswer(this.answerA,this.answerB,this.answerC,this.answerD,this.questions[this.countQuiz])}},{key:"sendRemoveAnswer",value:function(){this.btn_remove_answer.inputEnabled=!1,0==this.checkUseSpt&&(this.checkUseSpt=!0,mZ.instance().dataMySeft.support_item>0?(mZ.instance().sendData(Et.SUPPORT_REQUEST,null),this.removeAnswer()):iC.instance().addDialog("Bạn không đủ Míc")),ce.instance().playSound(ce.buttonclick)}},{key:"createFourAnswer",value:function(){for(var e=0;e<4;e++)0==e&&(this.answerA=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerA.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerA.sprite),this.addChild(this.answerA)),1==e&&(this.answerB=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerB.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerB.sprite),this.addChild(this.answerB)),2==e&&(this.answerC=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerC.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerC.sprite),this.addChild(this.answerC)),3==e&&(this.answerD=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerD.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerD.sprite),this.addChild(this.answerD))}},{key:"updateOnClickAnswer",value:function(e){if(this.answerA.sprite.inputEnabled=!1,this.answerB.sprite.inputEnabled=!1,this.answerC.sprite.inputEnabled=!1,this.answerD.sprite.inputEnabled=!1,this.answered=e,this.calculateScoreOpp(),e+1==this.questions[this.countQuiz].correctAnswer){if(this.setActionPhaseOnCorrect(),this.setTrueAva(),this.answeredResult=!0,this.timeCounter.ms/1e3>10)this.score+=Math.floor(100*Math.pow(1,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:10});else{var t=parseFloat((this.timeCounter.ms/1e3).toFixed(1));this.score+=Math.floor(100*(11-t)*Math.pow(11-t,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:t})}this.setScore(this.score),Kr.instance().playlist.setExpPlaylistById(this.playlist.id)}else this.setFalseAva(),this.answeredResult=!1,this.wrongList.push(this.countQuiz);for(var n=0;n<4;n++)0==n&&this.setTrueFalseTabAnswer(this.answerA,n),1==n&&this.setTrueFalseTabAnswer(this.answerB,n),2==n&&this.setTrueFalseTabAnswer(this.answerC,n),3==n&&this.setTrueFalseTabAnswer(this.answerD,n);this.pushResultAnswer(),this.addCorrectListSprites(),this.addWrongListSprites(),this.timeNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.resetQuestion,this)}},{key:"setActionPhaseOnCorrect",value:function(){this.questions[this.countQuiz].correctAnswer>2?this.actionPhase.position.y=game.height-636:this.actionPhase.position.y=game.height-416,this.actionPhase.setStreak(this.streak),this.addChild(this.actionPhase)}},{key:"addAvaMiniInTheLeftOfTab",value:function(e){var t,n=game.add.graphics(0,0);(n.beginFill(16777215),n.drawCircle(-246*window.GameConfig.RESIZE,0,40*window.GameConfig.RESIZE),n.anchor.set(.5),window.MQ.isBotMode)?((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,"bot-mini".concat(window.MQ.botKey))).anchor.set(.5),t.mask=n):""!==this.opponent.avatar?((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,this.opponent.avatar)).anchor.set(.5),t.scale.set(window.GameConfig.SCALE_AVA_OPPO_INTHELEFT*window.GameConfig.RESIZE),t.mask=n):((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,"songDetailSprites","ava-default")).anchor.set(.5),t.scale.set(window.GameConfig.SCALE_AVA_OPPO_INTHELEFT*window.GameConfig.RESIZE),t.mask=n);t.kill(),e.addChild(n),e.addChild(t),this.timeAvaMiniShow=game.time.create(!0),this.timeAvaMiniShow.add(Phaser.Timer.SECOND*(this.opponentAnswerLogs[this.countQuiz].answer_time+.4),function(){t.revive()}),this.timeAvaMiniShow.start()}},{key:"calculateScoreOpp",value:function(){if(this.countQuiz<=4)if("CORRECT"==this.opponentAnswerLogs[this.countQuiz].result.toUpperCase()){this.setTrueAvaOpp();var e=Math.floor(100*(11-this.opponentAnswerLogs[this.countQuiz].answer_time)*Math.pow(11-this.opponentAnswerLogs[this.countQuiz].answer_time,(this.opponentAnswerLogs[this.countQuiz].streak-1)/4));this.scoreOpp+=e,this.setScoreOpp(this.scoreOpp)}else this.setFalseAvaOpp()}},{key:"pushResultAnswer",value:function(){var e="INCORRECT";if(1==this.answeredResult&&(e="CORRECT"),this.timeCounter.ms/1e3>10)this.answers.push({answer_time:10,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0});else{var t=(this.timeCounter.ms/1e3).toFixed(1);this.answers.push({answer_time:parseFloat(t),result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0})}}},{key:"removeTimeNextQuestion",value:function(){null!==this.timeNextQuestion&&game.time.events.remove(this.timeNextQuestion)}},{key:"resetQuestion",value:function(){this.removeTimeNextQuestion(),this.tweenSpriteTime.stop(),this.spriteTime.destroy(),this.timeCounter.stop(),this.actionPhase.setDefault(),this.timeCounter.destroy(),this.checkUseSpt=!1,this.answerA.destroy(),this.answerB.destroy(),this.answerC.destroy(),this.answerD.destroy(),this.btn_remove_answer.revive(),1==this.answeredResult?this.streak++:this.streak=1,this.countQuiz<4?(this.countQuiz+=1,this.createGamePlayChallenged()):(Dl.instance().removeSound(),this.result={answers:this.answers,score:this.score,scoreOpp:this.scoreOpp,game_log_id:this.play_log_id,challenge_request_id:this.request_id,opponentAnswerLogs:this.opponentAnswerLogs,playlist_id:this.playlist.id},this.event.resultGame.dispatch(this.result))}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SUPPORT_RESPONSE&&e.params.getUtfString("status")}},{key:"setTrueFalseTabAnswer",value:function(e,t){t==this.answered?t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerWrong():t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerNotChoosed()}},{key:"setTrueAva",value:function(){this.trueOrFalseUser.setTrueAnswer()}},{key:"setFalseAva",value:function(){this.trueOrFalseUser.setFailtAnswer()}},{key:"setTrueAvaOpp",value:function(){this.trueOrFalseOpp.setTrueAnswer()}},{key:"setFalseAvaOpp",value:function(){this.trueOrFalseOpp.setFailtAnswer()}},{key:"setScore",value:function(e){this.UserSpriteRight.setScore(e)}},{key:"setScoreOpp",value:function(e){this.UserSpriteLeft.setScore(e)}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timeTweenBegin),game.time.events.remove(this.timeTweenStart),game.time.events.remove(this.timePS4),game.time.events.remove(this.timeNextQuestion),Dl.instance().event.loadComplete.remove(this.loadComplete,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&rp(n.prototype,i),o&&rp(n,o),t}();function dp(e){return(dp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pp(e,t){return!t||"object"!==dp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gp(e){return(gp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yp(e,t){return(yp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mp=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=pp(this,gp(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),e.addChild(e.bg),e.event={playYourTurn:new Phaser.Signal,challenge:new Phaser.Signal,reHome:new Phaser.Signal},e.type=null,e.isLastWeek=!1,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setType",value:function(e){this.type=e}},{key:"afterInit",value:function(){this.addEventExtension(),this.loadDisplayBeChallenged(function(){qe.instance().hideLoading()})}},{key:"setData",value:function(e,t,n,i,o,a,s,r,l){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.result=a,this.opponentAnswerLogs=s,this.weeklyResult=r,this.historyGameLog=l}},{key:"loadDisplayBeChallenged",value:function(e){this.UserSpriteRightWin=new Ff,this.UserSpriteRightWin.setAva("ava_fb"),this.UserSpriteRightWin.setNameAndScore("You",this.result.score),this.UserSpriteRightWin.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRightWin.makeDefaultScreenNotTween(),this.UserSpriteRightWin.addDotOnline(),this.addChild(this.UserSpriteRightWin),this.UserSpriteLeftWin=new qf(this.opponent),this.UserSpriteLeftWin.setAva(this.opponent.avatar),this.UserSpriteLeftWin.setNameAndScore(this.opponent.userName,this.result.scoreOpp),this.UserSpriteLeftWin.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeftWin.makeDefaultScreenNotTween(),this.UserSpriteLeftWin.addDotOnline(),this.addChild(this.UserSpriteLeftWin),this.createBoxScoreFriendChallen(),e()}},{key:"createBoxScoreFriendChallen",value:function(){var e=this,t=new Phaser.Text(game,game.width/2,485*window.GameConfig.RESIZE,"Kết quả trong tuần",{font:"Gilroy",fill:"#9d92a6",fontSize:19});t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,"playSprites","Header"),i=new Phaser.Text(game,game.width/2,35*window.GameConfig.RESIZE,this.playlist.name,{font:"Gilroy",fill:"white",fontSize:23});i.anchor.set(.5),n.addChild(i),this.addChild(n);var o=new Phaser.Graphics(game,0,551*window.GameConfig.RESIZE);o.beginFill(),o.drawRect(0,0,game.width,(game.height-676)*window.GameConfig.RESIZE),o.endFill(),this.addChild(o);var a=new Phaser.Button(game,game.width/2,1200*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Box_ketqua_old");a.anchor.set(.5,0),a.mask=o;var s=new Phaser.Text(game,game.width/2,520*window.GameConfig.RESIZE,"Score",{font:"GilroyBold",fill:"white",fontSize:30});if(this.result.score>this.result.scoreOpp){ce.instance().playSound(ce.winturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Chiến thắng !!!",{font:"GilroyBold",fill:"white",fontSize:40})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon));var r=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,140*window.GameConfig.RESIZE,"firework");r.anchor.set(.5),this.addChild(r);r.animations.add("run_win");r.animations.play("run_win",30,!0),this.addChild(l),this.UserSpriteRightWin.addBtnWinGemAndExp()}else if(this.result.score==this.result.scoreOpp){ce.instance().playSound(ce.loseturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Điểm số hòa !!!",{font:"GilroyBold",fill:"white",fontSize:40})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon)),this.addChild(l),this.UserSpriteRightWin.addBtnLoseGemAndExp()}else{var l;ce.instance().playSound(ce.loseturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Thua cuộc !!!",{font:"GilroyBold",fill:"white",fontSize:40})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon)),this.addChild(l),this.UserSpriteRightWin.addBtnLoseGemAndExp()}s.anchor.set(.5),this.addChild(s),this.addChild(a);var h=new Phaser.Group(game,0,0);h.y=1200,this.addChild(h);var c=new Phaser.Rectangle(35,0,615*window.GameConfig.RESIZE,(game.height-685)*window.GameConfig.RESIZE);this.listView=new Jo(game,h,c,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addTweenBoxResult(a,h);for(var u=0;u<5;u++){var d=new Rf(this.questions[u].songEntity,this.result.answers[u],this.opponentAnswerLogs[u],u);d.event.playSound.add(this.playSongResult,this),this.listView.add(d)}var f=new rt(this.positionWinConfig.shadow);f.y=game.height-z.instance().STANDARD_HEIGHT+this.positionWinConfig.shadow.y,this.addChild(f);var p=new Phaser.Button(game,378*window.GameConfig.RESIZE,(game.height-86)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"btn_next_game");p.anchor.set(.5),this.addChild(p);var g=new Phaser.Text(game,0,0,this.positionWinConfig.txt_play_your_turn.text,this.positionWinConfig.txt_play_your_turn.configs);"CHALLENGE"==this.type&&g.setText("THÁCH ĐẤU LẠI"),g.anchor.set(.5),p.addChild(g),p.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),"CHALLENGE"==e.type?e.event.challenge.dispatch():e.event.playYourTurn.dispatch()},this);var y=new Phaser.Button(game,this.positionWinConfig.share.x*window.GameConfig.RESIZE,this.positionWinConfig.share.y*window.GameConfig.RESIZE,this.positionWinConfig.share.nameAtlas,function(){},this,null,this.positionWinConfig.share.nameSprite);y.anchor.set(.5),y.events.onInputUp.add(this.shareResult,this),this.addChild(y);var m=new Phaser.Button(game,80*window.GameConfig.RESIZE,(game.height-86)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Button_home");m.anchor.set(.5),m.events.onInputUp.add(this.backHome,this),this.addChild(m),this.addBtnLastWeekResult()}},{key:"addBtnLastWeekResult",value:function(){this.btnLastWeekResult=new Phaser.Button(game,this.positionWinConfig.last_week.x*window.GameConfig.RESIZE,this.positionWinConfig.last_week.y*window.GameConfig.RESIZE,this.positionWinConfig.last_week.nameAtlas,function(){},this,null,this.positionWinConfig.last_week.nameSprite),this.btnLastWeekResult.anchor.set(.5),this.btnLastWeekResult.events.onInputUp.add(this.chooseLastWeek,this);var e=new Phaser.Text(game,this.positionWinConfig.last_week.txt.x,this.positionWinConfig.last_week.txt.y,this.positionWinConfig.last_week.txt.text,this.positionWinConfig.last_week.txt.configs);e.anchor.set(.5),this.btnLastWeekResult.addChild(e),this.addChild(this.btnLastWeekResult)}},{key:"chooseLastWeek",value:function(){this.isLastWeek=!0,iC.instance().addLastWeekResultScreen(this.opponent)}},{key:"backHome",value:function(){ce.instance().playSound(ce.buttonclick),0==this.isLastWeek&&this.event.reHome.dispatch()}},{key:"playSongResult",value:function(e){Dl.instance().pauseSound();for(var t=0;t<this.listView.grp.children.length;t++){var n=this.listView.grp.children[t];n.index!==e?n.stopSound():n.playSound()}}},{key:"shareResult",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"backLastWeek",value:function(){this.isLastWeek=!1}},{key:"onShared",value:function(e){e.hasOwnProperty("error_code")||this.sendShareResult()}},{key:"sendShareResult",value:function(){mZ.instance().sendData(DataCommand.FB_USER_SHARED_RESULT_REQUEST,null)}},{key:"onExtensionResponse",value:function(e){}},{key:"addTweenBoxResult",value:function(e,t){game.add.tween(e).to({y:551*window.GameConfig.RESIZE},500,"Linear",!1).start(),game.add.tween(t).to({y:551*window.GameConfig.RESIZE},500,"Linear",!1).start()}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.backHome,this),De.instance().event.backLastWeek.add(this.backLastWeek,this),ui.instance().event.share.add(this.onShared,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.backHome,this),De.instance().event.backLastWeek.remove(this.backLastWeek,this),ui.instance().event.share.remove(this.onShared,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&fp(n.prototype,i),o&&fp(n,o),t}();function vp(e){return(vp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bp(e,t){return!t||"object"!==vp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sp(e){return(Sp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _p(e,t){return(_p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ep=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=bp(this,Sp(t).call(this,game,0,0,"screen-dim"))).input.useHandCursor=!1,e.signalInput=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_p(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.avaOpp,this.nameOpp,this.avaUrl}},{key:"setAvaUrl",value:function(e){this.avaUrl=e}},{key:"setTxtNameOpp",value:function(e){this.txtNameOpp=e}},{key:"addPopup",value:function(){this.removePopupConfirm(),this.popup=new vh,this.popup.x=35*window.GameConfig.RESIZE,this.popup.y=372*window.GameConfig.RESIZE,this.popup.setTextCancle("ĐỂ SAU"),this.popup.setContent("".concat(this.txtNameOpp," đã thách đấu bạn trước!")),this.popup.txtContent.addColor("#ffab4f",0),this.popup.txtContent.addColor("#000000",this.txtNameOpp.length),this.popup.event.OK.add(this.onOK,this),this.popup.event.CANCLE.add(this.onCancle,this),this.addChild(this.popup),this.addAvaAndNameOpp()}},{key:"onOK",value:function(){LogConsole.log("onOK"),this.popup.destroy(),this.popup=null,this.signalInput.dispatch("OK"),this.destroy()}},{key:"onCancle",value:function(){LogConsole.log("ononCancle"),this.popup.destroy(),this.popup=null,this.signalInput.dispatch("CANCLE"),this.destroy()}},{key:"removePopupConfirm",value:function(){null!==this.popup&&void 0!==this.popup&&(this.popup.destroy(),this.popup=null)}},{key:"addAvaAndNameOpp",value:function(){this.avaOpp=new ka(0),this.avaOpp.x=284*window.GameConfig.RESIZE,this.avaOpp.beginLoad(this.avaUrl),this.avaOpp.anchor.set(.5),this.avaOpp.addMaskAva(200),this.avaOpp.setScale(.825*window.GameConfig.RESIZE),this.popup.addChild(this.avaOpp)}}])&&wp(n.prototype,i),o&&wp(n,o),t}();function Cp(e){return(Cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pp(e,t){return!t||"object"!==Cp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Op(e){return(Op=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rp(e,t){return(Rp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xp=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Pp(this,Op(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.event={playIllegalTurn:new Phaser.Signal,illegalTurnCancle:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"makeNewGameBeChallenged",value:function(e,t){this.game_log_id=e.game_log_id,this.request_id=e.request_id,t()}},{key:"setData",value:function(e){this.opponent=e}},{key:"addPopupIllegalTurn",value:function(){this.popup=new Ep,this.popup.setAvaUrl(this.opponent.avatar),this.popup.setTxtNameOpp(this.opponent.userName),this.popup.addPopup(),this.popup.signalInput.add(this.onPopupCallback,this),this.addChild(this.popup)}},{key:"onPopupCallback",value:function(e){"OK"==e?this.event.playIllegalTurn.dispatch({game_log_id:this.game_log_id,request_id:this.request_id}):this.event.illegalTurnCancle.dispatch()}}])&&kp(n.prototype,i),o&&kp(n,o),t}();function Tp(e){return(Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ip(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ap(e,t){return!t||"object"!==Tp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lp(e){return(Lp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gp(e,t){return(Gp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Dp=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ap(this,Lp(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.event={resultGame:new Phaser.Signal,doneTutorial:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addScreenLoadTurnBase()}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"addScreenLoadTurnBase",value:function(){this.score=0,this.scoreOpp=0,this.countQuiz=0,this.correctList=[],this.wrongList=[],this.streak=1,this.answers=[],this.result,this.timeNextQuestion=null,this.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new rt(this.positionPlayConfig.line_top);this.addChild(e),this.loadScreenPlayChallenged(this.scoreOpp),this.addNamePlaylistAndTextLoading(),this.addActionPhase()}},{key:"addNamePlaylistAndTextLoading",value:function(){this.namePlaylist=new Phaser.Text(game,this.positionPlayConfig.namePlaylist.x*window.GameConfig.RESIZE,(this.positionPlayConfig.namePlaylist.y+80)*window.GameConfig.RESIZE,this.playlist.name,this.positionPlayConfig.namePlaylist.configs),this.namePlaylist.anchor.set(.5),this.addChild(this.namePlaylist),game.add.tween(this.namePlaylist).to({y:this.positionPlayConfig.namePlaylist.y*window.GameConfig.RESIZE},300,Phaser.Easing.Linear.Out,!1).start(),this.loadingAnim=new Fe,this.addChild(this.loadingAnim)}},{key:"addActionPhase",value:function(){this.actionPhase=new Vd,this.actionPhase.position.x=(this.game.width-this.actionPhase.width)/2,this.addChild(this.actionPhase)}},{key:"loadScreenPlayChallenged",value:function(e){var t=new Phaser.Sprite(game,this.positionPlayConfig.versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.versus.nameAtlas,this.positionPlayConfig.versus.nameSprite);t.anchor.set(.5);var n=new Phaser.Text(game,this.positionPlayConfig.txt_versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.text,this.positionPlayConfig.txt_versus.configs);n.anchor.set(.5),t.addChild(n),t.scale.set(.1),this.addChild(t),game.add.tween(t.scale).to({x:1,y:1},400,"Linear").start(),this.UserSpriteRight=new bd,this.UserSpriteRight.setAva("ava_fb"),this.UserSpriteRight.setPosition(),this.UserSpriteRight.setNameAndScore("You",this.score),this.UserSpriteRight.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRight.addDotOnline(),this.addChild(this.UserSpriteRight),this.UserSpriteRight.makeTweenAvaLoading(),this.trueOrFalseUser=new Bd,this.trueOrFalseUser.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseUser.x=320*window.GameConfig.RESIZE,this.trueOrFalseUser.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseUser),this.UserSpriteLeft=new Pd(this.opponent),this.UserSpriteLeft.setAva(this.opponent.avatar),this.UserSpriteLeft.setPosition(),this.UserSpriteLeft.setNameAndScore(this.opponent.userName,e),this.UserSpriteLeft.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeft.addDotOnline(),this.addChild(this.UserSpriteLeft),this.trueOrFalseOpp=new Bd,this.trueOrFalseOpp.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseOpp.x=-10*window.GameConfig.RESIZE,this.trueOrFalseOpp.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseOpp),this.UserSpriteLeft.makeTweenAvaLoading(),this.loadAfter()}},{key:"loadAfter",value:function(){for(var e=[],t=0;t<5;t++)e.push(this.questions[t].songEntity.fileUrl);Dl.instance().loadSoundArray(e),LogConsole.log("arrSongs:------- "),LogConsole.log(e),Dl.instance().event.loadComplete.add(this.loadComplete,this)}},{key:"setData",value:function(e,t,n,i,o,a){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.opponentAnswerLogs=a}},{key:"setDataBeChallenged",value:function(e,t,n){this.play_log_id=e,this.request_id=t,this.isHasHistory=n}},{key:"loadComplete",value:function(){LogConsole.log("load complete"),this.loadingAnim.destroy(),this.makeTweenToPlay()}},{key:"loadStart",value:function(){}},{key:"makeTweenToPlay",value:function(){0==this.countQuiz&&(this.UserSpriteLeft.makeTweenAva(),this.UserSpriteRight.makeTweenAva()),this.addBtnRemoveAnswer(),this.createGamePlayChallenged()}},{key:"createGamePlayChallenged",value:function(){this.timeCounter=game.time.create(),0==this.countQuiz?this.createLoadingScreenAfterStart():(this.timeCounter.start(),this.displayAnswering())}},{key:"addCircleNormal",value:function(){for(var e=this,t=function(t){0==e.countQuiz&&setTimeout(function(){var n=new Phaser.Sprite(game,(e.positionPlayConfig.circleNormal.x+62*t)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y+50)*window.GameConfig.RESIZE,e.positionPlayConfig.circleNormal.nameAtlas,e.positionPlayConfig.circleNormal.nameSprite);n.anchor.set(.5),game.add.tween(n).to({y:(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start(),e.addChild(n)},50*t)},n=0;n<5;n++)t(n)}},{key:"addCorrectListSprites",value:function(){for(var e=0;e<this.correctList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.correctList[e].countQuiz)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Text(game,0,3*window.GameConfig.RESIZE,this.correctList[e].time.toFixed(1),{font:"GilroyBold",fontSize:15});n.anchor.set(.5),t.addChild(n)}}},{key:"addWrongListSprites",value:function(){for(var e=0;e<this.wrongList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.wrongList[e])*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,this.positionPlayConfig.wrongMini.nameAtlas,this.positionPlayConfig.wrongMini.nameSprite);n.anchor.set(.5),t.addChild(n)}}},{key:"createLoadingScreenAfterStart",value:function(){var e=this,t=game.add.audio("beep_audio"),n=new Phaser.Text(game,this.positionPlayConfig.countdownNumber.x*window.GameConfig.RESIZE,(this.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,"3",this.positionPlayConfig.countdownNumber.configs);n.anchor.set(.5),this.addChild(n);var i=game.add.tween(n).to({y:this.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("2");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("1");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){Le.instance().logEvent(Le.pro_quiz_start_turnbase),n.setText("Bắt đầu"),n.scale.set(.5),n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE;var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),i.onComplete.add(function(){n.destroy(),t.destroy(),e.addCircleNormal(),e.displayAnswering()})})})})}},{key:"displayAnswering",value:function(){var e=this;if(this.namePlaylist.destroy(),this.btn_remove_answer.revive(),Dl.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.spriteTime=new Phaser.Sprite(game,0,(game.height-746)*window.GameConfig.RESIZE,"otherSprites","tween-time"),this.spriteTime.anchor.set(0,.5),this.addChild(this.spriteTime),this.tweenSpriteTime=game.add.tween(this.spriteTime.scale).to({x:70,y:1},1e4,"Linear"),this.tweenSpriteTime.start(),this.timeCounter.start(),this.createFourAnswer(),this.tweenSpriteTime.onComplete.add(function(){}),0==this.countQuiz){var t=new en;t.afterInit(),t.addHelperStep1(),this.addChild(t),this.timePS1=game.time.events.add(1.2*Phaser.Timer.SECOND,function(){t.addStep1ChooseAnswerQuest1(e.questions[0],e.countQuiz),t.event.step1.add(e.stepOneChoosed,e)})}if(1==this.countQuiz){var n=new en;n.afterInit(),n.addHelperStep2(),this.addChild(n),this.timePS2=game.time.events.add(1.2*Phaser.Timer.SECOND,function(){n.addStep2ChooseAnswerQuest2(e.questions[1],e.countQuiz),n.event.step2.add(e.stepTwoChoosed,e)})}if(2==this.countQuiz){var i=new en;i.afterInit(),i.addHelperStep3(),this.addChild(i),this.timePS3=game.time.events.add(1.2*Phaser.Timer.SECOND,function(){i.addStep3ChooseAnswerQuest3(e.questions[2],e.countQuiz),i.event.step3.add(e.stepThreeChoosed,e)})}}},{key:"stepOneChoosed",value:function(e){this.updateOnClickAnswer(e)}},{key:"stepTwoChoosed",value:function(e){this.updateOnClickAnswer(e)}},{key:"stepThreeChoosed",value:function(e){this.updateOnClickAnswer(e)}},{key:"addBtnRemoveAnswer",value:function(){this.btn_remove_answer=new Phaser.Button(game,this.positionPlayConfig.btn_remove_answer.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.btn_remove_answer.y)*window.GameConfig.RESIZE,this.positionPlayConfig.btn_remove_answer.nameAtlas,function(){},this,null,this.positionPlayConfig.btn_remove_answer.nameSprite),this.btn_remove_answer.anchor.set(.5),this.btn_remove_answer.kill();var e=new Phaser.Text(game,this.positionPlayConfig.txt_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.text,this.positionPlayConfig.txt_remove_answer.configs);e.anchor.set(.5);var t=new St(this.positionPlayConfig.txt_dis_one,this.positionPlayConfig.txt_dis_one.text);t.anchor.set(.5),this.btn_remove_answer.addChild(t);var n=new Phaser.Sprite(game,this.positionPlayConfig.diamond_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.nameAtlas,this.positionPlayConfig.diamond_remove_answer.nameSprite);n.anchor.set(1,.5);var i=new rt(this.positionPlayConfig.mic_so_luong);i.anchor.set(.5),this.countMic=mZ.instance().socket.mySelf.getVariable("support_item").value,this.numberOfSptItem=new St(this.positionPlayConfig.number_mic_so_luong,mZ.instance().socket.mySelf.getVariable("support_item").value),this.numberOfSptItem.anchor.set(.5),i.addChild(this.numberOfSptItem),this.btn_remove_answer.addChild(i),this.btn_remove_answer.addChild(n),this.btn_remove_answer.addChild(e),this.btn_remove_answer.events.onInputDown.add(this.sendRemoveAnswer,this),this.addChild(this.btn_remove_answer)}},{key:"removeAnswer",value:function(){this.countMic--,this.numberOfSptItem.setText(this.countMic),this.btn_remove_answer.kill(),Bn.getTwoOfFourAnswer(this.answerA,this.answerB,this.answerC,this.answerD,this.questions[this.countQuiz])}},{key:"sendRemoveAnswer",value:function(){mZ.instance().dataMySeft.support_item>0||iC.instance().addDialog("Bạn không đủ Míc"),ce.instance().playSound(ce.buttonclick)}},{key:"createFourAnswer",value:function(){for(var e=0;e<4;e++)0==e&&(this.answerA=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerA.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerA.sprite),this.addChild(this.answerA)),1==e&&(this.answerB=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerB.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerB.sprite),this.addChild(this.answerB)),2==e&&(this.answerC=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerC.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerC.sprite),this.addChild(this.answerC)),3==e&&(this.answerD=new Ad(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerD.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerD.sprite),this.addChild(this.answerD))}},{key:"updateOnClickAnswer",value:function(e){this.answerA.sprite.inputEnabled=!1,this.answerB.sprite.inputEnabled=!1,this.answerC.sprite.inputEnabled=!1,this.answerD.sprite.inputEnabled=!1,this.answered=e,this.calculateScoreOpp(),e+1==this.questions[this.countQuiz].correctAnswer?(this.setActionPhaseOnCorrect(),this.setTrueAva(),this.answeredResult=!0,this.timeCounter.ms/1e3>10?(this.score+=Math.floor(100*Math.pow(1,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:10})):(this.score+=Math.floor(100*(11-this.timeCounter.ms/1e3)*Math.pow(11-this.timeCounter.ms/1e3,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:this.timeCounter.ms/1e3})),this.setScore(this.score)):(this.setFalseAva(),this.answeredResult=!1,this.wrongList.push(this.countQuiz));for(var t=0;t<4;t++)0==t&&this.setTrueFalseTabAnswer(this.answerA,t),1==t&&this.setTrueFalseTabAnswer(this.answerB,t),2==t&&this.setTrueFalseTabAnswer(this.answerC,t),3==t&&this.setTrueFalseTabAnswer(this.answerD,t);this.pushResultAnswer(),this.addCorrectListSprites(),this.addWrongListSprites(),this.timeNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.resetQuestion,this)}},{key:"setActionPhaseOnCorrect",value:function(){this.questions[this.countQuiz].correctAnswer>2?this.actionPhase.position.y=game.height-636:this.actionPhase.position.y=game.height-416,this.actionPhase.setStreak(this.streak),this.addChild(this.actionPhase)}},{key:"addAvaMiniInTheLeftOfTab",value:function(e){var t,n=game.add.graphics(0,0);(n.beginFill(16777215),n.drawCircle(-246*window.GameConfig.RESIZE,0,40*window.GameConfig.RESIZE),n.anchor.set(.5),window.MQ.isBotMode)?((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,"bot-mini".concat(window.MQ.botKey))).anchor.set(.5),t.mask=n):((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,this.opponent.avatar)).anchor.set(.5),t.scale.set(window.GameConfig.SCALE_AVA_OPPO_INTHELEFT*window.GameConfig.RESIZE),t.mask=n);t.kill(),e.addChild(n),e.addChild(t),this.timeAvaMiniShow=game.time.create(!0),this.timeAvaMiniShow.add(Phaser.Timer.SECOND*this.opponentAnswerLogs[this.countQuiz].timeAnswer,function(){t.revive()}),this.timeAvaMiniShow.start()}},{key:"calculateScoreOpp",value:function(){if(this.countQuiz<=4)if("CORRECT"==this.opponentAnswerLogs[this.countQuiz].trueOrFalse.toUpperCase()){this.setTrueAvaOpp();var e=Math.floor(100*(11-this.opponentAnswerLogs[this.countQuiz].timeAnswer)*Math.pow(11-this.opponentAnswerLogs[this.countQuiz].timeAnswer,(this.opponentAnswerLogs[this.countQuiz].streak-1)/4));this.scoreOpp+=e,this.setScoreOpp(this.scoreOpp)}else this.setFalseAvaOpp()}},{key:"pushResultAnswer",value:function(){var e="INCORRECT";1==this.answeredResult&&(e="CORRECT"),this.timeCounter.ms/1e3>10?this.answers.push({answer_time:10,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0}):this.answers.push({answer_time:this.timeCounter.ms/1e3,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0})}},{key:"removeTimeNextQuestion",value:function(){null!==this.timeNextQuestion&&game.time.events.remove(this.timeNextQuestion)}},{key:"resetQuestion",value:function(){this.removeTimeNextQuestion(),this.tweenSpriteTime.stop(),this.spriteTime.destroy(),this.timeCounter.stop(),this.actionPhase.setDefault(),this.timeCounter.destroy(),Dl.instance().removeSound(this.questions[this.countQuiz].songEntity.fileUrl),this.answerA.destroy(),this.answerB.destroy(),this.answerC.destroy(),this.answerD.destroy(),this.btn_remove_answer.revive(),1==this.answeredResult?this.streak++:this.streak=1,this.countQuiz<4?(this.countQuiz+=1,this.createGamePlayChallenged()):(Dl.instance().removeSound(),this.result={answers:this.answers,score:this.score,scoreOpp:this.scoreOpp,game_log_id:this.play_log_id,challenge_request_id:this.request_id,opponentAnswerLogs:this.opponentAnswerLogs,playlist_id:this.playlist.id},mZ.instance().sendData(Et.PLAY_SCRIPT_DONE_TURNBASE_REQUEST,null),z.instance().playScript.playing_guide=en.DONE_TURNBASE)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SUPPORT_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.removeAnswer(),e.cmd==Et.PLAY_SCRIPT_DONE_TURNBASE_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.event.doneTutorial.dispatch(),e.cmd==Et.PLAY_SCRIPT_DONE_ALL_RESPONSE&&(console.log("PLAY_SCRIPT_DONE_TURNBASE_RESPONSE"),"OK"==e.params.getUtfString("status")&&(z.instance().playScript.playing_guide=en.DONE_ALL,this.event.doneTutorial.dispatch()))}},{key:"setTrueFalseTabAnswer",value:function(e,t){t==this.answered?t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerWrong():t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerNotChoosed()}},{key:"setTrueAva",value:function(){this.trueOrFalseUser.setTrueAnswer()}},{key:"setFalseAva",value:function(){this.trueOrFalseUser.setFailtAnswer()}},{key:"setTrueAvaOpp",value:function(){this.trueOrFalseOpp.setTrueAnswer()}},{key:"setFalseAvaOpp",value:function(){this.trueOrFalseOpp.setFailtAnswer()}},{key:"setScore",value:function(e){this.UserSpriteRight.setScore(e)}},{key:"setScoreOpp",value:function(e){this.UserSpriteLeft.setScore(e)}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timePS1),game.time.events.remove(this.timePS2),game.time.events.remove(this.timePS3),game.time.events.remove(this.timeNextQuestion),Dl.instance().event.loadComplete.remove(this.loadComplete,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Ip(n.prototype,i),o&&Ip(n,o),t}();function Mp(e){return(Mp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Np(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bp(e,t){return!t||"object"!==Mp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jp(e){return(jp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Up(e,t){return(Up=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fp=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Bp(this,jp(t).call(this,game))).type=n,e.screenChallenge=null,e.screenBeChallenged=null,e.screenTutorial=null,e.screenWin=null,e.screenHistory=null,e.challengeMsg="",e.event={historyPlayTurn:new Phaser.Signal,screenRehome:new Phaser.Signal,screenWinScreenBeChallengedChallengAgain:new Phaser.Signal,playIllegalTurn:new Phaser.Signal,illegalTurnCancle:new Phaser.Signal,screenChallengeNextGame:new Phaser.Signal,historyChallenge:new Phaser.Signal},e.addEventExtension(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Up(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setData",value:function(e,t,n,i,o,a){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,"BECHALLENGED"==this.type&&(this.opponentAnswerLogs=a),"TUTORIAL"==this.type&&(this.opponentAnswerLogs=a)}},{key:"setDataBeChallenged",value:function(e,t,n,i,o,a){"BECHALLENGED"==this.type&&(n?(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.weeklyResult=i,this.historyGameLog=o,this.dataTurnbase=a):(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.weeklyResult=i,this.dataTurnbase=a))}},{key:"setDataChallenge",value:function(e,t,n,i,o){"CHALLENGE"==this.type&&(n?(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.weeklyResult=i,this.historyGameLog=o):(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.weeklyResult=i))}},{key:"addScreenPlay",value:function(){this.timeCountActionPhase=game.time.create(),"CHALLENGE"==this.type?this.isHasHistory?this.addScreenHistory():(this.addScreenChallenge(),this.timeCountActionPhase.start()):"BECHALLENGED"==this.type?this.isHasHistory?this.addScreenHistory():(this.addScreenBeChallenged(),this.timeCountActionPhase.start()):(this.addScreenTutorial(),this.timeCountActionPhase.start())}},{key:"addScreenTutorial",value:function(){this.removeScreenTutorial(),this.screenTutorial=new Dp,this.screenTutorial.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.opponentAnswerLogs),this.screenTutorial.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory),this.screenTutorial.event.resultGame.add(this.onCompleteBeChallenged,this),this.screenTutorial.event.doneTutorial.add(this.doneTutorial,this),this.screenTutorial.afterInit(),this.addChild(this.screenTutorial)}},{key:"doneTutorial",value:function(){window.GameConfig.IS_TUTORIAL=!1,WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"removeScreenTutorial",value:function(){null!==this.screenTutorial&&(this.removeChild(this.screenTutorial),this.screenTutorial.destroy(),this.screenTutorial=null)}},{key:"addScreenChallenge",value:function(){this.removeScreenChallenge(),this.screenChallenge=new Jd,this.screenChallenge.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist),this.screenChallenge.event.resultGame.add(this.onCompleteChallenge,this),this.screenChallenge.afterInit(),this.addChild(this.screenChallenge)}},{key:"removeScreenChallenge",value:function(){null!==this.screenChallenge&&(this.removeChild(this.screenChallenge),this.screenChallenge.destroy(),this.screenChallenge=null)}},{key:"onCompleteChallenge",value:function(e){var t=this;this.result=e,this.handledJSONResultToSfsResultChallengeMode(e,function(e){qe.instance().showLoading(),t.sendGameFinishRequest(Et.CHALLENGE_GAME_FINISH_REQUEST,e),Le.instance().logEvent(Le.play_time,parseInt(t.timeCountActionPhase/1e3)),t.timeCountActionPhase.stop(),t.timeCountActionPhase.destroy()})}},{key:"addScreenBeChallenged",value:function(){this.removeScreenBeChallenged(),this.screenBeChallenged=new up,this.screenBeChallenged.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.opponentAnswerLogs),this.screenBeChallenged.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory),this.screenBeChallenged.event.resultGame.add(this.onCompleteBeChallenged,this),this.screenBeChallenged.afterInit(),this.addChild(this.screenBeChallenged)}},{key:"removeScreenBeChallenged",value:function(){null!==this.screenBeChallenged&&(this.removeChild(this.screenBeChallenged),this.screenBeChallenged.destroy(),this.screenBeChallenged=null)}},{key:"onCompleteBeChallenged",value:function(e){var t=this;this.result=e,this.handledJSONResultToSfsResultBeChallengedMode(e,function(e){qe.instance().showLoading(),t.sendGameFinishRequest(Et.BECHALLENGED_GAME_FINISH_REQUEST,e),LogConsole.log(parseInt(t.timeCountActionPhase.ms/1e3)),Le.instance().logEvent(Le.play_time,parseInt(t.timeCountActionPhase/1e3)),t.timeCountActionPhase.stop(),t.timeCountActionPhase.destroy()})}},{key:"handledJSONResultToSfsResultChallengeMode",value:function(e,t){LogConsole.log(e);var n=new SFS2X.SFSObject,i=new SFS2X.SFSArray;this.putValueToAnswers(i,e,function(e){n.putSFSArray("answers",e)}),n.putInt("score",e.score),n.putInt("opponent_id",e.opponent_id),n.putInt("playlist_id",e.playlist_id),t(n)}},{key:"handledJSONResultToSfsResultBeChallengedMode",value:function(e,t){LogConsole.log(e);var n=new SFS2X.SFSObject,i=new SFS2X.SFSArray;this.putValueToAnswers(i,e,function(e){n.putSFSArray("answers",e)}),n.putInt("score",e.score),n.putInt("playlist_id",e.playlist_id),n.putLong("challenge_request_id",e.challenge_request_id),t(n)}},{key:"putValueToAnswers",value:function(e,t,n){for(var i=0;i<5;i++){var o=new SFS2X.SFSObject;o.putFloat("answer_time",t.answers[i].answer_time),o.putUtfString("result",t.answers[i].result),o.putInt("answer",t.answers[i].answer),o.putInt("streak",t.answers[i].streak),o.putLong("question_id",t.answers[i].question_id),o.putLong("created",t.answers[i].created),o.putInt("index",t.answers[i].index),e.addSFSObject(o)}n(e)}},{key:"sendGameFinishRequest",value:function(e,t){LogConsole.log(t.getDump()),mZ.instance().sendData(e,t)}},{key:"switchToScreenWin",value:function(e){this.removeScreenChallenge(),this.removeScreenBeChallenged(),this.addScreenWin(e)}},{key:"addScreenHistory",value:function(){this.removeScreenHistory(),this.screenHistory=new mp,this.screenHistory.setType(this.type),this.screenHistory.setData(this.historyGameLog.questions,this.opponent,this.historyGameLog.user_playlist_mapping,this.historyGameLog.opponent_playlist_mapping,this.historyGameLog.playlist,this.historyGameLog.result,this.historyGameLog.result.opponentAnswerLogs,this.weeklyResult),this.screenHistory.afterInit(),this.screenHistory.event.playYourTurn.add(this.historyPlayTurn,this),this.screenHistory.event.reHome.add(this.screenRehome,this),this.screenHistory.event.challenge.add(this.historyChallenge,this),this.addChild(this.screenHistory)}},{key:"removeScreenHistory",value:function(){null!==this.screenHistory&&(this.removeChild(this.screenHistory),this.screenHistory.destroy(),this.screenHistory=null)}},{key:"historyPlayTurn",value:function(){this.removeScreenHistory(),this.event.historyPlayTurn.dispatch()}},{key:"historyChallenge",value:function(){this.removeScreenHistory(),this.event.historyChallenge.dispatch()}},{key:"addScreenWin",value:function(e){this.removeScreenWin(),this.screenWin=new ap(e),this.screenWin.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.result,this.challengeMsg),"BECHALLENGED"==e?this.screenWin.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory,this.opponentAnswerLogs,this.weeklyResult,this.dataTurnbase):this.screenWin.setDataChallenge(this.play_log_id,this.request_id),this.screenWin.addScreen(),this.screenWin.event.screenReHome.add(this.screenRehome,this),this.screenWin.event.screenBeChallengedChallengAgain.add(this.screenWinScreenBeChallengedChallengAgain,this),this.screenWin.event.screenChallengeNextGame.add(this.screenChallengeNextGame,this),this.addChild(this.screenWin)}},{key:"removeScreenWin",value:function(){null!==this.screenWin&&(this.removeChild(this.screenWin),this.screenWin.destroy(),this.screenWin=null)}},{key:"screenRehome",value:function(){this.event.screenRehome.dispatch()}},{key:"screenWinScreenBeChallengedChallengAgain",value:function(){this.event.screenWinScreenBeChallengedChallengAgain.dispatch()}},{key:"screenChallengeNextGame",value:function(e){this.event.screenChallengeNextGame.dispatch(e)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.CHALLENGE_GAME_FINISH_RESPONSE?"OK"==e.params.getUtfString("status")?(qe.instance().hideLoading(),this.request_id=e.params.getLong("challenge_request_id"),this.challengeMsg=e.params.getUtfString("challenge_msg"),Le.instance().logEvent(Le.pro_quiz_end_turnbase),this.switchToScreenWin("CHALLENGE")):"WARNING"==e.params.getUtfString("status")&&(qe.instance().hideLoading(),this.handleIllegalTurn(e.params)):e.cmd==Et.BECHALLENGED_GAME_FINISH_RESPONSE&&"OK"==e.params.getUtfString("status")&&(Le.instance().logEvent(Le.pro_quiz_end_turnbase),qe.instance().hideLoading(),this.switchToScreenWin("BECHALLENGED"))}},{key:"handleIllegalTurn",value:function(e){var t=this,n=e.getLong("opponent_game_log"),i=e.getLong("challenge_request_id");this.illlegalTurn={request_id:i,game_log_id:n},this.illlegalTurnModule=new xp,this.illlegalTurnModule.setData(this.opponent),this.illlegalTurnModule.event.playIllegalTurn.add(this.playIllegalTurn,this),this.illlegalTurnModule.event.illegalTurnCancle.add(this.illegalTurnCancle,this),this.addChild(this.illlegalTurnModule),this.illlegalTurnModule.makeNewGameBeChallenged(this.illlegalTurn,function(){t.illlegalTurnModule.addPopupIllegalTurn()})}},{key:"playIllegalTurn",value:function(e){this.event.playIllegalTurn.dispatch(e)}},{key:"illegalTurnCancle",value:function(){this.event.illegalTurnCancle.dispatch()}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),Dl.instance().removeAllSound();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Np(n.prototype,i),o&&Np(n,o),t}();function Zp(e){return(Zp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qp(e,t){return!t||"object"!==Zp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vp(e,t,n){return(Vp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Wp(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Wp(e){return(Wp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qp(e,t){return(qp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Kp=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Qp(this,Wp(t).call(this,game))).arrResource=[],e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"loadResource",value:function(){for(var e=0;e<this.arrResource.length;e++){var t=this.arrResource[e],n=t.type,i=t.link+"?v=".concat(window.VersionClient),o=t.key;switch(n){case"text":game.load.text(o,i);break;case"image":game.load.image(o,i);break;case"atlas":var a=t.linkJson+"?v=".concat(window.VersionClient);game.load.atlas(o,i,a,Phaser.Loader.TEXTURE_ATLAS_JSON_HASH);break;case"spritesheet":var s=t.width,r=t.height,l=t.countFrame;game.load.spritesheet(o,i,s,r,l)}}game.load.onLoadComplete.add(this.loadFileComplete,this),game.load.start()}},{key:"loadFileComplete",value:function(){game.load.onLoadComplete.remove(this.loadFileComplete,this),this.onLoadFileComplete()}},{key:"onLoadFileComplete",value:function(){}},{key:"removeResource",value:function(){for(var e=0;e<this.arrResource.length;e++){var t=this.arrResource[e],n=t.type,i=(t.link,"?v=".concat(window.VersionClient),t.key);switch(n){case"text":console.log("remove text : "+i),game.cache.checkTextKey(i)&&(console.log("da xoa"),game.cache.removeText(i));break;case"image":console.log("remove image : "+i),game.cache.checkImageKey(i)&&(console.log("da xoa"),game.cache.removeImage(i));break;case"atlas":console.log("remove atlas : "+i),game.cache.checkImageKey(i)&&(console.log("da xoa image"),game.cache.removeImage(i));var o=t.linkJson+"?v=".concat(window.VersionClient);game.cache.checkJSONKey(o)&&(console.log("da xoa json"),game.cache.checkJSONKey(o)),game.cache.checkXMLKey(o)&&(console.log("da xoa xml"),game.cache.checkXMLKey(o));break;case"spritesheet":console.log("remove spritesheet : "+i),game.cache.checkImageKey(i)&&(console.log("da xoa image"),game.cache.removeImage(i))}}}},{key:"destroy",value:function(){this.removeResource(),Vp(Wp(t.prototype),"destroy",this).call(this),console.log(game.cache)}}])&&Hp(n.prototype,i),o&&Hp(n,o),t}();function zp(e){return(zp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yp(e,t){return!t||"object"!==zp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jp(e,t,n){return(Jp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xp(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Xp(e){return(Xp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eg(e,t,n){return t&&$p(e.prototype,t),n&&$p(e,n),e}function tg(e,t){return(tg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ng=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=Yp(this,Xp(t).call(this)),null==n&&null==i?e.screenType=1:i==t.TYPE_BECHALLENGED?e.screenType=3:i==t.TYPE_CHALLENGE?e.screenType=2:e.screenType=4,e.opponent=n,e.type=i,e.dataTurnbase=o,e.findgame=null,e.choosePlaylist=null,e.playGame=null,e.event={backMenu:new Phaser.Signal},e.arrResource=[{type:"text",link:"img/config/positionCreateRoom.json",key:"positionCreateRoom"},{type:"text",link:"img/config/findOpponents.json",key:"findOpponentConfig"},{type:"text",link:"img/config/positionWinConfig.json",key:"positionWinConfig"},{type:"text",link:"img/config/positionMainConfig.json",key:"positionMainConfig"},{type:"text",link:"img/config/limitTurn.json",key:"limitTurnConfig"},{type:"atlas",link:"img/atlas/playTurnBase.png",key:"playSprites",linkJson:"img/atlas/playTurnBase.json"},{type:"atlas",link:"img/atlas/findOpponent.png",key:"findOpponentSprites",linkJson:"img/atlas/findOpponent.json"}],e.loadResource(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tg(e,t)}(t,Kp),eg(t,null,[{key:"TYPE_BECHALLENGED",get:function(){return"BECHALLENGED"}},{key:"TYPE_CHALLENGE",get:function(){return"CHALLENGE"}},{key:"TUTORIAL",get:function(){return"TUTORIAL"}}]),eg(t,[{key:"onLoadFileComplete",value:function(){this.afterInit(),this.addScreen()}},{key:"afterInit",value:function(){this.playScript=JSON.parse(game.cache.getText("playScript")),this.definedData(),this.addEventExtension()}},{key:"definedData",value:function(){this.historyGameLog={questions:[],playlist:{},result:{answers:[],score:0,scoreOpp:0,opponentAnswerLogs:[]},user_playlist_mapping:{},opponent_playlist_mapping:{}},this.playlistHisTory,this.questions=[],this.playlist={},this.opponentAnswerLogs=[],qe.instance().showLoading()}},{key:"addScreen",value:function(){null!==this.opponent?this.type==t.TYPE_CHALLENGE?(this.sendChallengeGameHistoryRequest(),this.screenType=2):this.type==t.TYPE_BECHALLENGED?(this.handleRequestBeChallengedGame(),this.screenType=3):(this.addPlayGame(t.TUTORIAL),this.screenType=4):this.addFindGame()}},{key:"sendChallengeGameHistoryRequest",value:function(){var e=new SFS2X.SFSObject;e.putInt("opponent_id",this.opponent.id),mZ.instance().sendData(Et.CHALLENGE_GAME_HISTORY_REQUEST,e),qe.instance().showLoading()}},{key:"handleRequestBeChallengedGame",value:function(){this.sendBeChallengedGameLogRequest(mZ.instance().dataMySeft.user_id,this.opponent.id)}},{key:"sendBeChallengedGameLogRequest",value:function(e,t){var n=new SFS2X.SFSObject;n.putInt("user_id",e),n.putInt("opponent_id",t),mZ.instance().sendData(Et.BECHALLENGED_GAME_OPPONENT_GAME_LOG_REQUEST,n),qe.instance().showLoading()}},{key:"setDataBeChallenged",value:function(e,n,i,o,a){this.type==t.TYPE_BECHALLENGED&&(this.play_log_id=e,this.request_id=n,this.isHasHistory=i),this.weeklyResult=o,this.dataTurnbase=a}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),Kr.instance().event.load_playlist_complete.add(this.loadPlaylistComplete,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),Kr.instance().event.load_playlist_complete.remove(this.loadPlaylistComplete,this)}},{key:"onExtensionResponse",value:function(e){var n=this;e.cmd==Et.CHALLENGE_GAME_QUESTIONS_RESPONSE&&("WARNING"===e.params.getUtfString("status")?(iC.instance().addLimitTurn(),qe.instance().hideLoading()):this.handleQuestionResponse(e.params,function(){n.isHandleQuestionResponse=!0,n.addPlayGame(t.TYPE_CHALLENGE),qe.instance().hideLoading()})),e.cmd==Et.BECHALLENGED_GAME_OPPONENT_GAME_LOG_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.opponentAnswerLogs=[],this.beChallengedParamsSimple=e.params,1==Kr.instance().ktLoadPlaylist?this.loadPlaylistComplete():Kr.instance().sendGetDataShop()):WF.instance().changeScreen(Ce.MAIN_MENU)),e.cmd==Et.CHALLENGE_GAME_HISTORY_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.handleHistory(e.params),1==this.isHasHistory?this.addPlayGame(t.TYPE_CHALLENGE):this.addChoosePlaylist(this.opponent)):WF.instance().changeScreen(Ce.MAIN_MENU))}},{key:"loadPlaylistComplete",value:function(){var e=this;this.type==t.TYPE_BECHALLENGED&&this.handleResponseBeChallengedGame(this.beChallengedParamsSimple,function(){e.sortQuestions(e.questions),e.sortQuestions(e.opponentAnswerLogs),e.addPlayGame(t.TYPE_BECHALLENGED),qe.instance().hideLoading()})}},{key:"sortQuestions",value:function(e){e=e.sort(function(e,t){return e.questionId-t.questionId})}},{key:"addFindGame",value:function(){this.removeFindGame(),this.findgame=new el,this.findgame.event.choose_playlist.add(this.addChoosePlaylist,this),this.findgame.event.onBack.add(this.onBackFindGame,this),this.findgame.event.challengeGame.add(this.challengeGame,this),this.addChild(this.findgame)}},{key:"removeFindGame",value:function(){null!==this.findgame&&(this.removeChild(this.findgame),this.findgame.destroy(),this.findgame=null)}},{key:"addChoosePlaylist",value:function(e){qe.instance().showLoading(),this.opponent=e,this.removeChoosePlaylist(),this.choosePlaylist=new pd(e),this.choosePlaylist.event.choosePlaylist.add(this.onChoosedPlaylist,this),this.choosePlaylist.event.backScreen.add(this.onBackChoosePlaylist,this),this.addChild(this.choosePlaylist)}},{key:"removeChoosePlaylist",value:function(){null!==this.choosePlaylist&&(this.removeChild(this.choosePlaylist),this.choosePlaylist.destroy(),this.choosePlaylist=null)}},{key:"onBackChoosePlaylist",value:function(){1!==this.screenType?(this.removeChoosePlaylist(),WF.instance().changeScreen(Ce.TURN_BASE)):this.removeChoosePlaylist()}},{key:"onChoosedPlaylist",value:function(e){this.playlist=e,this.removeChoosePlaylist(),this.removeFindGame()}},{key:"onBackFindGame",value:function(){this.removeFindGame()}},{key:"challengeGame",value:function(e){this.type=t.TYPE_CHALLENGE,this.opponent=e,this.sendChallengeGameHistoryRequest(),this.screenType=2}},{key:"addPlayGame",value:function(e){this.removePlayGame(),this.playGame=new Fp(e),this.playGame.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.opponentAnswerLogs),this.type==t.TYPE_BECHALLENGED&&(this.isHasHistory?(this.playGame.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory,this.weeklyResult,this.historyGameLog,this.dataTurnbase),this.playGame.event.historyPlayTurn.add(this.historyPlayTurn,this)):this.playGame.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory,this.weeklyResult,this.historyGameLog,this.dataTurnbase)),e==t.TYPE_CHALLENGE&&(this.isHasHistory?this.playGame.setDataChallenge(this.play_log_id,this.request_id,this.isHasHistory,this.weeklyResult,this.historyGameLog):this.playGame.setDataChallenge(this.play_log_id,this.request_id,this.isHasHistory,this.weeklyResult)),this.type==t.TUTORIAL&&(this.playGame.setData(this.playScript.demoData.questions,this.playScript.demoData.opponent,this.playScript.demoData.user_playlist_mapping,this.playScript.demoData.opponent_playlist_mapping,this.playScript.demoData.playlist,this.playScript.demoData.opponentAnswerLogs),this.playGame.setDataBeChallenged(this.playScript.demoData.play_log_id,this.playScript.demoData.request_id,this.playScript.demoData.isHasHistory,this.playScript.demoData.weeklyResult),qe.instance().hideLoading()),this.playGame.addScreenPlay(),this.playGame.event.screenRehome.add(this.playGameScreenWinScreenChallengeReHome,this),this.playGame.event.screenWinScreenBeChallengedChallengAgain.add(this.screenWinScreenBeChallengedChallengAgain,this),this.playGame.event.illegalTurnCancle.add(this.illegalTurnCancle,this),this.playGame.event.playIllegalTurn.add(this.playIllegalTurn,this),this.playGame.event.screenChallengeNextGame.add(this.screenChallengeNextGame,this),this.playGame.event.historyChallenge.add(this.historyChallenge,this),this.addChild(this.playGame)}},{key:"removePlayGame",value:function(){null!==this.playGame&&(this.removeChild(this.playGame),this.playGame.destroy(),this.playGame=null)}},{key:"historyPlayTurn",value:function(){this.removePlayGame(),this.isHasHistory=!1,this.addPlayGame(t.TYPE_BECHALLENGED)}},{key:"historyChallenge",value:function(){this.removePlayGame(),this.isHasHistory=!1,this.addChoosePlaylist(this.opponent)}},{key:"playGameScreenWinScreenChallengeReHome",value:function(){WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"screenWinScreenBeChallengedChallengAgain",value:function(){this.removePlayGame(),this.type=t.TYPE_CHALLENGE,this.definedData(),this.addChoosePlaylist(this.opponent)}},{key:"illegalTurnCancle",value:function(){this.removePlayGame(),WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"playIllegalTurn",value:function(e){this.removePlayGame(),this.type=t.TYPE_BECHALLENGED,this.definedData(),this.addScreen()}},{key:"screenChallengeNextGame",value:function(e){this.removePlayGame(),this.type=e.type,this.opponent=e.opponent,this.definedData(),this.setDataBeChallenged(e.gameLogId,e.requestId,e.isHasHistory,e.weeklyResult,e),this.addScreen()}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this),Jp(Xp(t.prototype),"destroy",this).call(this)}},{key:"handleQuestionResponse",value:function(e,t){if("OK"==e.getUtfString("status")){for(var n=e.getSFSArray("response"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString("question_type"),s=o.getUtfString("answer1"),r=o.getUtfString("answer2"),l=o.getUtfString("answer3"),h=o.getUtfString("answer4"),c=o.getLong("id"),u=o.getInt("correct_answer"),d=o.getUtfString("file_path"),f=o.getUtfString("file_path"),p=o.getSFSObject("song"),g=p.getUtfString("title"),y=p.getLong("id"),m=p.getUtfString("title"),v=p.getUtfString("author"),w=p.getSFSObject("singer"),b=w.getUtfString("name"),S=w.getUtfString("avatar"),_=[];if(p.containsKey("song_links"))for(var E=p.getSFSArray("song_links"),C=0;C<E.size();C++){var k=E.getSFSObject(C),P=k.getUtfString("link_type"),O=k.getLong("song_id"),R=k.getInt("is_movie"),x=k.getUtfString("link"),T=k.getLong("id");_.push({link_type:P,song_id:O,is_movie:R,link:x,id:T})}this.questions.push({questionType:a,answers:[s,r,l,h],correctAnswer:u,songEntity:{thumb:S,song:g,song_links:_,fileName:m,author:v,singer:b,listenLink:f,id:y,fileUrl:d},id:c})}if(e.containsKey("opponent_playlist_mapping"))var I=e.getSFSObject("opponent_playlist_mapping");if(e.containsKey("user_playlist_mapping"))e.getSFSObject("user_playlist_mapping");this.user_playlist_mapping=this.handleUserPlaylistMapping(this.playlist),this.opponent_playlist_mapping=this.handlePlaylistMapping(I),t()}else WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"handleResponseBeChallengedGame",value:function(e,t){var n=e.getSFSArray("opponent_answer_logs"),i=e.getSFSObject("playlist"),o=i.getInt("id"),a=i.getUtfString("name");this.playlist={id:o,name:a};for(var s=0;s<n.size();s++){var r=n.getSFSObject(s),l=r.getSFSObject("question_entity"),h=l.getUtfString("question_type"),c=l.getUtfString("answer1"),u=l.getUtfString("answer2"),d=l.getUtfString("answer3"),f=l.getUtfString("answer4"),p=l.getLong("id"),g=l.getInt("correct_answer"),y=l.getUtfString("file_path"),m=l.getUtfString("file_path"),v=l.getSFSObject("song"),w=v.getUtfString("title"),b=v.getLong("id"),S=v.getUtfString("title"),_=v.getUtfString("author"),E=v.getSFSObject("singer"),C=E.getUtfString("name"),k=E.getUtfString("avatar"),P=[];if(v.containsKey("song_links"))for(var O=v.getSFSArray("song_links"),R=0;R<O.size();R++){var x=O.getSFSObject(R),T=x.getUtfString("link_type"),I=x.getLong("song_id"),A=x.getInt("is_movie"),L=x.getUtfString("link"),G=x.getLong("id");P.push({link_type:T,song_id:I,is_movie:A,link:L,id:G})}var D=r.getLong("question_id"),M=r.getDouble("answer_time"),N=r.getInt("answer"),B=r.getInt("streak"),j=r.getUtfString("result");this.opponentAnswerLogs.push({questionId:D,answer_time:M,answer:N,streak:B,result:j}),this.questions.push({questionId:D,questionType:h,answers:[c,u,d,f],correctAnswer:g,songEntity:{thumb:k,song:w,fileName:S,song_links:P,author:_,singer:C,listenLink:m,id:b,fileUrl:y},id:p})}if(e.containsKey("opponent_playlist_mapping"))var U=e.getSFSObject("opponent_playlist_mapping");if(e.containsKey("user_playlist_mapping"))e.getSFSObject("user_playlist_mapping");this.user_playlist_mapping=this.handleUserPlaylistMapping(this.playlist),this.opponent_playlist_mapping=this.handlePlaylistMapping(U),this.handleHistory(e);var F=e.getLong("challenge_request_id");this.request_id=F;var Z=e.getSFSObject("weekly_result"),H=Z.getInt("user_won"),Q=Z.getInt("opponent_won");this.weeklyResult={userWon:H,opponentWon:Q},t()}},{key:"handleHistory",value:function(e){if(e.containsKey("history")){this.isHasHistory=!0;var t=e.getSFSObject("history");t.containsKey("user_id")?(this.handleResponseBechallengedGameHistory(t,function(){}),this.sortQuestions(this.historyGameLog.questions),this.sortQuestions(this.historyGameLog.result.answers),this.sortQuestions(this.historyGameLog.result.opponentAnswerLogs)):this.isHasHistory=!1}else this.isHasHistory=!1}},{key:"handleUserPlaylistMapping",value:function(e){return Kr.instance().playlist.getPlayListById(e.id).user_playlist_mapping}},{key:"handlePlaylistMapping",value:function(e){var t=new Qs;return e?(t.user_id=e.getInt(tr.user_id),t.level=e.getInt(tr.level),t.playlist_id=e.getInt(tr.playlist_id),t.exp_score=e.getInt(tr.exp_score),t.created=e.getLong(tr.created),t.active=e.getInt(tr.active),t.id=e.getLong(tr.id),t.current_level_score=e.getInt(tr.current_level_score),t.next_level_score=e.getInt(tr.next_level_score),t.updated=e.getLong(tr.updated),t):t}},{key:"handleResponseBechallengedGameHistory",value:function(e,t){var n=e.getInt("user_id"),i=e.getInt("playlist_id"),o=e.getSFSObject("playlist").getUtfString("name"),a=e.getSFSObject("user_play_log_entity"),s=e.getSFSObject("opponent_play_log_entity"),r=a.getInt("score"),l=s.getInt("score");if(e.containsKey("opponent_playlist_mapping"))var h=e.getSFSObject("opponent_playlist_mapping");if(e.containsKey("user_playlist_mapping"))var c=e.getSFSObject("user_playlist_mapping");n==mZ.instance().dataMySeft.user_id?(this.historyGameLog.user_playlist_mapping=this.handleUserPlaylistMapping({id:i,name:o}),this.historyGameLog.opponent_playlist_mapping=this.handlePlaylistMapping(h),this.handleGameLogEntity(a,this.historyGameLog.result.answers),this.handleGameLogEntity(s,this.historyGameLog.result.opponentAnswerLogs),this.historyGameLog.result.score=r,this.historyGameLog.result.scoreOpp=l):(this.historyGameLog.user_playlist_mapping=this.handleUserPlaylistMapping({id:i,name:o}),this.historyGameLog.opponent_playlist_mapping=this.handlePlaylistMapping(c),this.handleGameLogEntity(a,this.historyGameLog.result.opponentAnswerLogs),this.handleGameLogEntity(s,this.historyGameLog.result.answers),this.historyGameLog.result.score=l,this.historyGameLog.result.scoreOpp=r),this.handleQuestionLogEntity(s,this.historyGameLog.questions),this.historyGameLog.playlist={id:i,name:o},t()}},{key:"handleQuestionLogEntity",value:function(e,t){for(var n=e.getSFSArray("answer_entities"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getSFSObject("question_entity"),s=a.getUtfString("question_type"),r=a.getUtfString("file_path"),l=a.getUtfString("file_path"),h=a.getSFSObject("song"),c=h.getUtfString("title"),u=h.getLong("id"),d=h.getUtfString("title"),f=h.getUtfString("author"),p=h.getSFSObject("singer"),g=p.getUtfString("name"),y=p.getUtfString("avatar"),m=o.getLong("question_id"),v=[];if(h.containsKey("song_links"))for(var w=h.getSFSArray("song_links"),b=0;b<w.size();b++){var S=w.getSFSObject(b),_=S.getUtfString("link_type"),E=S.getLong("song_id"),C=S.getInt("is_movie"),k=S.getUtfString("link"),P=S.getLong("id");v.push({link_type:_,song_id:E,is_movie:C,link:k,id:P})}t.push({questionId:m,questionType:s,songEntity:{thumb:y,song:c,fileName:d,song_links:v,author:f,singer:g,listenLink:l,id:u,fileUrl:r}})}}},{key:"handleGameLogEntity",value:function(e,t){for(var n=e.getSFSArray("answer_entities"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getDouble("answer_time"),s=o.getUtfString("result"),r=o.getLong("question_id");t.push({answer_time:a,result:s,questionId:r})}}}]),t}();function ig(e){return(ig="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function og(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ag(e,t){return!t||"object"!==ig(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sg(e){return(sg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rg(e,t){return(rg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lg=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=ag(this,sg(t).call(this,game))).positionUserProfile=JSON.parse(game.cache.getText("positionUserProfile")),o.current_exp_level=e,o.next_exp_level=n,o.percentLevelCurrent=0,mZ.instance().dataMySeft&&(o.experience_score=i),o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rg(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.calCurrentExpLevel=this.experience_score-this.current_exp_level,this.calExpLevel=this.next_exp_level-this.current_exp_level,this.txt=new St(this.positionUserProfile.profile_exp_current_txt,"Level hiện tại (".concat(this.calCurrentExpLevel,"/").concat(this.calExpLevel,")")),this.txt.anchor.set(.5),this.exp_current,this.ext_require,this.exp_current=new rt(this.positionUserProfile.profile_current_level),this.exp_current.anchor.set(0,.5),this.ext_require=new rt(this.positionUserProfile.profile_require_level),this.ext_require.anchor.set(0,.5),this.calculatePercentLevelCurrent(),this.addChild(this.txt),this.addChild(this.ext_require),this.addChild(this.exp_current)}},{key:"calculatePercentLevelCurrent",value:function(){this.percentLevelCurrent=(this.calCurrentExpLevel/this.calExpLevel).toFixed(1),this.exp_current.scale.set(this.percentLevelCurrent,1)}}])&&og(n.prototype,i),o&&og(n,o),t}();function hg(e){return(hg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ug(e,t,n){return(ug="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dg(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dg(e){return(dg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fg(e,t){return(fg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gg=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=dg(t).call(this,game,null))||"object"!==hg(i)&&"function"!=typeof i?pg(n):i).event={back:new Phaser.Signal},e.isMe=!1,e.heightGame=474*window.GameConfig.RESIZE,e.user=new Qu,e.game_status=0,e.positionUserProfile=e.mainData.positionUserProfile,e.header=new Ya,e.header.event.back.add(e.chooseBack,pg(pg(e))),e.addChild(e.header),e.txtOnline=new St(e.positionUserProfile.profile_txt_online,""),e.txtOnline.setTextBounds(0,0,game.width,27*window.GameConfig.RESIZE),e.addChild(e.txtOnline),e.bgAva=new rt(e.positionUserProfile.profile_bg_avatar),e.addChild(e.bgAva),e.clickBigAva=!1,e.ava=new Pc,e.ava.setSize(148*window.GameConfig.RESIZE,148*window.GameConfig.RESIZE),e.ava.inputEnabled=!0,e.ava.events.onInputUp.add(e.onClickAva,pg(pg(e))),e.ava.x=246*window.GameConfig.RESIZE,e.ava.y=43*window.GameConfig.RESIZE,e.addChild(e.ava),e.bgAvaVip=new rt(e.positionUserProfile.profile_bg_avatar_vip),e.bgAvaVip.visible=!1,e.addChild(e.bgAvaVip),e.txtUserName=new St(e.positionUserProfile.profile_txt_username,"MrViet"),e.txtUserName.setTextBounds(0,0,game.width,35*window.GameConfig.RESIZE),e.addChild(e.txtUserName),e.txtLevel=new St(e.positionUserProfile.profile_txt_level,"Level 12- abc"),e.txtLevel.setTextBounds(0,0,game.width,27*window.GameConfig.RESIZE),e.addChild(e.txtLevel),e.addEventExtension(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fg(e,t)}(t,Mt),n=t,(i=[{key:"onClickAva",value:function(){this.clickBigAva=!0,this.bigAvatar=new Rn(this.user.avatar),this.bigAvatar.event.back.add(this.backBigAva,this),Gn.instance().addChild(this.bigAvatar)}},{key:"backBigAva",value:function(){this.clickBigAva=!1}},{key:"chooseBack",value:function(){0==this.clickBigAva&&this.event.back.dispatch()}},{key:"addOtherUser",value:function(e,t,n){LogConsole.log("friend_status"),LogConsole.log(e),this.txtDescription=new St(this.positionUserProfile.profile_txt_description,this.user.description),this.txtDescription.setTextBounds(0,0,game.width,30*window.GameConfig.RESIZE),this.addChild(this.txtDescription),"NO_FRIEND"===n?(this.btnSendMessage=new pt(this.positionUserProfile.profile_btn_nhantin,this.chooseSendMessage,this),this.addChild(this.btnSendMessage),this.btnInviteFriend=new ln(this.positionUserProfile.profile_btn_ketban,"KẾT BẠN",this.chooseInviteFriend,this),this.addChild(this.btnInviteFriend),this.btnDuel=new ln(this.positionUserProfile.profile_btn_thachdau,"THÁCH ĐẤU",this.chooseDuel,this),this.addChild(this.btnDuel),!0===e.vip?(this.btnInviteFriend.y=(this.positionUserProfile.profile_btn_ketban.y+12)*window.GameConfig.RESIZE,this.btnDuel.y=(this.positionUserProfile.profile_btn_thachdau.y+12)*window.GameConfig.RESIZE,this.txtDescription.y=(this.positionUserProfile.profile_txt_description.y+12)*window.GameConfig.RESIZE,this.heightGame=575*window.GameConfig.RESIZE):(this.btnInviteFriend.y=this.positionUserProfile.profile_btn_ketban.y*window.GameConfig.RESIZE,this.btnDuel.y=this.positionUserProfile.profile_btn_thachdau.y*window.GameConfig.RESIZE,this.txtDescription.y=this.positionUserProfile.profile_txt_description.y*window.GameConfig.RESIZE,this.heightGame=563*window.GameConfig.RESIZE)):(this.btnSendMessage=new pt(this.positionUserProfile.profile_btn_nhantin,this.chooseSendMessage,this),this.addChild(this.btnSendMessage),this.btnDuel=new ln(this.positionUserProfile.profile_btn_thachdau_friend,"THÁCH ĐẤU",this.chooseDuel,this),this.addChild(this.btnDuel),!0===e.vip?(this.btnDuel.y=(this.positionUserProfile.profile_btn_thachdau_friend.y+12)*window.GameConfig.RESIZE,this.btnSendMessage.y=(this.positionUserProfile.profile_btn_nhantin_friend.y+12)*window.GameConfig.RESIZE,this.txtDescription.y=(this.positionUserProfile.profile_txt_description.y+12)*window.GameConfig.RESIZE,this.heightGame=474*window.GameConfig.RESIZE):(this.btnDuel.y=this.positionUserProfile.profile_btn_thachdau_friend.y*window.GameConfig.RESIZE,this.btnSendMessage.y=this.positionUserProfile.profile_btn_nhantin_friend.y*window.GameConfig.RESIZE,this.txtDescription.y=this.positionUserProfile.profile_txt_description.y*window.GameConfig.RESIZE,this.heightGame=462*window.GameConfig.RESIZE),"PENDING_THEM"===n&&(this.txtWarning=new St(this.positionUserProfile.profile_txt_warning_pending_them,""),Bn.getGender(e),this.txtWarning.setText("Bạn đã gửi yêu cầu kết bạn tới "+e.user_name),this.txtWarning.setTextBounds(0,0,game.width,30*window.GameConfig.RESIZE),this.addChild(this.txtWarning),this.txtWarning.addColor("#93909d",0),this.txtWarning.addFontStyle("italic",0),!0===e.vip?(this.txtWarning.y=(this.positionUserProfile.profile_txt_warning_pending_them.y+12)*window.GameConfig.RESIZE,this.heightGame=515*window.GameConfig.RESIZE):(this.txtWarning.y=this.positionUserProfile.profile_txt_warning_pending_them.y*window.GameConfig.RESIZE,this.heightGame=504*window.GameConfig.RESIZE)),"FRIEND"===n&&(this.hideUnfriend=!0,this.btnHuyKetBan=new ln(this.positionUserProfile.profile_btn_huy_ket_ban,"Hủy kết bạn",this.chooseRemoveFriend,this),this.addChild(this.btnHuyKetBan),this.btnHuyKetBan.kill(),this.btnViewMore=new pt(this.positionUserProfile.profile_btn_view_more,this.onClickViewMore,this),this.addChild(this.btnViewMore),this.btnSendMessage.revive()),"PENDING_YOU"===n&&(this.btnDongYFriend=new ln(this.positionUserProfile.profile_btn_dongy_friend,"ĐỒNG Ý",this.chooseOkFriend,this),this.addChild(this.btnDongYFriend),this.btnHuyBoFriend=new ln(this.positionUserProfile.profile_btn_huybo_friend,"TỪ CHỐI",this.chooseCancle,this),this.addChild(this.btnHuyBoFriend),this.txtWarning=new St(this.positionUserProfile.profile_txt_warning_pending_you,this.user.user_name+" đã gửi yêu cầu kết bạn."),this.txtWarning.setTextBounds(0,0,game.width,30*window.GameConfig.RESIZE),this.txtWarning.addColor("#ffa33a",0),this.txtWarning.addColor("#93909d",this.user.user_name.length),this.txtWarning.addFontStyle("italic",this.user.user_name.length),this.addChild(this.txtWarning),!0===e.vip?(this.btnDongYFriend.y=(this.positionUserProfile.profile_btn_dongy_friend.y+12)*window.GameConfig.RESIZE,this.btnHuyBoFriend.y=(this.positionUserProfile.profile_btn_huybo_friend.y+12)*window.GameConfig.RESIZE,this.txtWarning.y=(this.positionUserProfile.profile_txt_warning_pending_you.y+12)*window.GameConfig.RESIZE,this.heightGame=622*window.GameConfig.RESIZE):(this.btnDongYFriend.y=this.positionUserProfile.profile_btn_dongy_friend.y*window.GameConfig.RESIZE,this.btnHuyBoFriend.y=this.positionUserProfile.profile_btn_huybo_friend.y*window.GameConfig.RESIZE,this.txtWarning.y=this.positionUserProfile.profile_txt_warning_pending_you.y*window.GameConfig.RESIZE,this.heightGame=610*window.GameConfig.RESIZE))),"NO_GAME"===t||"ARCHIVED"===t?this.btnDuel.setText("THÁCH ĐẤU"):"THEIR_TURN"===t?(this.btnDuel.setText("ĐÃ THÁCH ĐẤU"),this.btnDuel.inputEnabled=!1):"YOUR_TURN"===t&&this.btnDuel.setText("NHẬN THÁCH ĐẤU")}},{key:"onClickViewMore",value:function(){1==this.hideUnfriend?(this.btnHuyKetBan.revive(),this.hideUnfriend=!1):(this.btnHuyKetBan.kill(),this.hideUnfriend=!0)}},{key:"setTextVip",value:function(){this.txtUserName.y=232*window.GameConfig.RESIZE,this.txtLevel.y=267*window.GameConfig.RESIZE}},{key:"addEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this),De.instance().event.backButton.add(this.chooseBack,this)}},{key:"removeEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this),De.instance().event.backButton.remove(this.chooseBack,this)}},{key:"addMe",value:function(e){this.btnMic=new ln(this.positionUserProfile.profile_btn_mic,mZ.instance().dataMySeft.support_item),this.addChild(this.btnMic),this.btnDiamond=new ln(this.positionUserProfile.profile_btn_diamond,mZ.instance().dataMySeft.diamond),this.addChild(this.btnDiamond),this.btnTicket=new ln(this.positionUserProfile.profile_btn_ticket,mZ.instance().dataMySeft.ticket),this.addChild(this.btnTicket),this.txtDescription=new St(this.positionUserProfile.profile_txt_description_me,this.user.description),this.txtDescription.anchor.set(.5),this.txtDescription.lineSpacing=-5,this.addChild(this.txtDescription),this.heightGame=421*window.GameConfig.RESIZE,this.hideSetting=!0,this.btnSetting=new ln(this.positionUserProfile.profile_btn_huy_ket_ban,"Cài đặt",this.chooseSetting,this),this.addChild(this.btnSetting),this.btnSetting.kill(),this.btnViewSetting=new pt(this.positionUserProfile.profile_btn_view_more,this.onClickViewSetting,this),!1===mZ.instance().dataMySeft.is_playing_game&&this.addChild(this.btnViewSetting),this.levelExpCurrent=new lg(this.current_level.experience_score,this.next_level.experience_score,this.user.experience_score),this.addChild(this.levelExpCurrent),1==e.vip&&(this.btnDiamond.y+=20,this.btnTicket.y+=20,this.btnMic.y+=20)}},{key:"onClickViewSetting",value:function(){1==this.hideSetting?(this.btnSetting.revive(),this.hideSetting=!1):(this.btnSetting.kill(),this.hideSetting=!0)}},{key:"chooseSetting",value:function(){this.btnSetting.kill(),this.hideSetting=!0,iC.instance().addSettingGame()}},{key:"setData",value:function(e,t,n,i,o){LogConsole.log(t,n),this.game_status=t,this.user=Object.assign({},this.user,e),this.txtUserName.text=e.user_name,this.txtLevel.text="LV "+e.level+" - "+e.level_title,e.level>9?this.txtLevel.addColor("#ffffff",5):this.txtLevel.addColor("#ffffff",4),this.current_level=i,this.next_level=o,this.ava.setAvatar(e.avatar),this.urlAvatar=e.avatar,z.instance().userDescription=e.description,this.header.setBg(this.user.vip),!0===e.vip?(this.bgAvaVip.visible=!0,this.bgAva.visible=!1,this.txtUserName.y=(this.positionUserProfile.profile_txt_username.y+12)*window.GameConfig.RESIZE,this.txtLevel.y=(this.positionUserProfile.profile_txt_level.y+12)*window.GameConfig.RESIZE):(this.bgAvaVip.visible=!1,this.bgAva.visible=!0),mZ.instance().dataMySeft.user_id==e.id?this.addMe(e):this.addOtherUser(e,t,n)}},{key:"chooseRemoveFriend",value:function(){this.btnHuyKetBan.inputEnabled=!1,mZ.instance().sendData(As.USER_FRIEND_REQUEST,Gs.begin(Gs.ACTION_REMOVE_FRIEND,this.user.id))}},{key:"chooseOkFriend",value:function(){this.btnDongYFriend.inputEnabled=!1,mZ.instance().sendData(As.USER_FRIEND_REQUEST,Gs.begin(Gs.ACTION_ACCEPT_ADD_REQUEST,this.user.id))}},{key:"chooseCancle",value:function(){this.btnHuyBoFriend.inputEnabled=!1,mZ.instance().sendData(As.USER_FRIEND_REQUEST,Gs.begin(Gs.ACTION_REFUSE_ADD_REQUEST,this.user.id))}},{key:"chooseInviteFriend",value:function(){LogConsole.log("chooseInviteFriend"),this.btnInviteFriend.inputEnabled=!1,mZ.instance().sendData(As.USER_FRIEND_REQUEST,Gs.begin(Gs.ACTION_ADD_FRIEND,this.user.id))}},{key:"chooseSendMessage",value:function(){LogConsole.log("chooseSendMessage"),!0===mZ.instance().dataMySeft.is_playing_game?iC.instance().addDialog("Bạn đang chơi game không thể chat."):(z.instance().isGetUserProfileSearch=!1,WF.instance().changeScreen(Ce.MAIN_MENU),li.instance().hideBanner(),iC.instance().addChatScreen(this.user))}},{key:"chooseDuel",value:function(){LogConsole.log("chooseDuel"+this.game_status),!0===mZ.instance().dataMySeft.is_playing_game?iC.instance().addDialog("Bạn đang chơi game không thể thách đấu."):(this.chooseBack(),"NO_GAME"==this.game_status?WF.instance().changeScreen(Ce.TURN_BASE,{opponent:{id:this.user.id,userName:this.user.user_name,avatar:this.user.avatar,is_online:this.user.is_online},type:ng.TYPE_CHALLENGE}):"YOUR_TURN"==this.game_status?WF.instance().changeScreen(Ce.TURN_BASE,{opponent:{id:this.user.id,userName:this.user.user_name,avatar:this.user.avatar,is_online:this.user.is_online},type:ng.TYPE_BECHALLENGED}):"ARCHIVED"==this.game_status&&Gn.instance().addDialog("Bạn hoặc đối thủ đã ẩn game của nhau. Hãy quay lại thách đấu sau 1 tuần nữa"))}},{key:"onUpdateUserVars",value:function(){mZ.instance().dataMySeft.user_id==this.user.id&&(this.txtUserName.setText(mZ.instance().dataMySeft.user_name),this.urlAvatar!==mZ.instance().dataMySeft.avatar&&this.ava.setAvatar(mZ.instance().dataMySeft.avatar),parseInt(this.btnDiamond.lbBtn.text)!==mZ.instance().dataMySeft.diamond&&this.btnDiamond.setText(mZ.instance().dataMySeft.diamond),parseInt(this.btnMic.lbBtn.text)!==mZ.instance().dataMySeft.support_item&&this.btnMic.setText(mZ.instance().dataMySeft.support_item),parseInt(this.btnTicket.lbBtn.text)!==mZ.instance().dataMySeft.ticket&&this.btnTicket.setText(mZ.instance().dataMySeft.ticket))}},{key:"destroy",value:function(){this.removeEventExtension(),this.removeEvent(),this.removeAllItem(),ug(dg(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this.heightGame}}])&&cg(n.prototype,i),o&&cg(n,o),t}();function yg(e){return(yg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vg(e){return(vg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wg(e,t){return(wg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Sg=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=vg(t).call(this,game,null))||"object"!==yg(i)&&"function"!=typeof i?bg(n):i).event={view_all:new Phaser.Signal},e.positionUserProfile=JSON.parse(game.cache.getText("positionUserProfile")),e.txtPlayList=new St(e.positionUserProfile.playlist_txt_playlist,"Playlist (0)"),e.txtPlayList.setTextBounds(0,0,237*window.GameConfig.RESIZE,35*window.GameConfig.RESIZE),e.addChild(e.txtPlayList),e.txtViewAll=new St(e.positionUserProfile.playlist_txt_xemtatca,"Xem tất cả"),e.txtViewAll.setTextBounds(0,0,191*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtViewAll),e.btnViewAll=new pt(e.positionUserProfile.playlist_line_select,e.chooseViewAll,bg(bg(e))),e.btnViewAll.x=e.txtViewAll.x,e.btnViewAll.y=e.txtViewAll.y,e.btnViewAll.width=191*window.GameConfig.RESIZE,e.btnViewAll.height=30*window.GameConfig.RESIZE,e.btnViewAll.alpha=0,e.addChild(e.btnViewAll),e.line=new rt(e.positionUserProfile.playlist_line),e.addChild(e.line),e.lineActive=new rt(e.positionUserProfile.playlist_line_select),e.addChild(e.lineActive),e.addPlayList=new Phaser.Sprite(game,0,0,null),e.addChild(e.addPlayList),e.heightGame=89*window.GameConfig.RESIZE,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wg(e,t)}(t,Mt),n=t,(i=[{key:"chooseViewAll",value:function(){this.event.view_all.dispatch()}},{key:"setData",value:function(e){for(;this.addPlayList.children.length>0;){var t=this.addPlayList.children[0];this.addPlayList.removeChild(t),t.destroy(),t=null}this.txtPlayList.text="Playlist("+e+")"}},{key:"choosePlaylist",value:function(e){iC.instance().addPlaylistDetail(e.id)}},{key:"height",get:function(){return this.heightGame}},{key:"width",get:function(){return game.width}}])&&mg(n.prototype,i),o&&mg(n,o),t}();var _g=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.medal="",this.title="",this.current_level=0};function Eg(e){return(Eg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kg(e,t){return!t||"object"!==Eg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pg(e){return(Pg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Og(e,t){return(Og=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rg=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=kg(this,Pg(t).call(this,game,null)),n>0&&e.setLevel(n),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Og(e,t)}(t,Mt),n=t,(i=[{key:"setLevel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=[];1===e?n.push({x:47,y:6,scale:1}):2===e?(n.push({x:40,y:22,scale:.75}),n.push({x:73,y:22,scale:.75})):3===e?(n.push({x:21,y:21,scale:.75}),n.push({x:47,y:6,scale:1}),n.push({x:91,y:21,scale:.75})):4===e?(n.push({x:18,y:35,scale:.6}),n.push({x:40,y:17,scale:.75}),n.push({x:73,y:17,scale:.75}),n.push({x:104,y:35,scale:.6})):5===e&&(n.push({x:-1,y:40,scale:.6}),n.push({x:21,y:21,scale:.75}),n.push({x:47,y:6,scale:1}),n.push({x:91,y:21,scale:.75}),n.push({x:120,y:40,scale:.6})),console.log(n);for(var i=0;i<n.length;i++){var o=new Phaser.Sprite(game,n[i].x*t,n[i].y*t,"defaultSource","Stars");o.scale.setTo(n[i].scale*t,n[i].scale*t),this.addChild(o)}}}])&&Cg(n.prototype,i),o&&Cg(n,o),t}();function xg(e){return(xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ig(e,t){return!t||"object"!==xg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ag(e,t,n){return(Ag="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lg(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Lg(e){return(Lg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gg(e,t){return(Gg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Dg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ig(this,Lg(t).call(this,game,null))).idRemove=null,e.positionUserProfile=e.mainData.positionUserProfile,e.data=new _g,e.ava=new Pc,e.ava.y=40,e.ava.setSize(118*window.GameConfig.RESIZE,118*window.GameConfig.RESIZE),e.addChild(e.ava),e.txtName=new St(e.positionUserProfile.achievement_txt_name,"hahah ahha ha hah ah ha hah ah ha hah"),e.txtName.setTextBounds(0,0,118*window.GameConfig.RESIZE,47*window.GameConfig.RESIZE),e.txtName.y=e.positionUserProfile.achievement_txt_name.y+40,e.addChild(e.txtName),e.iconAchiment=new Phaser.Sprite(game,0,0,"EffectAchiment"),e.iconAchiment.x=e.ava.x+(e.ava.width-e.iconAchiment.width)/2,e.iconAchiment.y=e.ava.y+(e.ava.height-e.iconAchiment.height)/2,e.iconAchiment.smoothed=!0,e.iconAchiment.animations.add("EffectAchiment"),e.addChild(e.iconAchiment),e.levelAchi=new Rg,e.levelAchi.x=12,e.addChild(e.levelAchi),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gg(e,t)}(t,Mt),n=t,(i=[{key:"removeDelayCall",value:function(){null!==this.idRemove&&game.time.events.remove(this.idRemove)}},{key:"setData",value:function(e,t){this.data=Object.assign({},this.data,e),this.ava.setAvatar(this.data.medal,t),this.txtName.text=this.data.title+" "+e.current_level;var n=.5+.5*t;this.levelAchi.setLevel(e.current_level,.58),this.removeDelayCall(),this.idRemove=game.time.events.add(Phaser.Timer.SECOND*n,this.playSpriteSheet,this)}},{key:"playSpriteSheet",value:function(){this.iconAchiment.animations.play("EffectAchiment",60)}},{key:"destroy",value:function(){this.removeDelayCall(),Ag(Lg(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return 118*window.GameConfig.RESIZE}},{key:"height",get:function(){return 218*window.GameConfig.RESIZE}}])&&Tg(n.prototype,i),o&&Tg(n,o),t}();function Mg(e){return(Mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ng(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bg(e){return(Bg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jg(e,t){return(jg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ug(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Fg=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Bg(t).call(this,game,null))||"object"!==Mg(i)&&"function"!=typeof i?Ug(n):i).event={view_all:new Phaser.Signal},e.positionUserProfile=e.mainData.positionUserProfile,e.txtPlayList=new St(e.positionUserProfile.playlist_txt_playlist,"Huy chương (0)"),e.txtPlayList.setTextBounds(0,0,237*window.GameConfig.RESIZE,35*window.GameConfig.RESIZE),e.addChild(e.txtPlayList),e.txtViewAll=new St(e.positionUserProfile.playlist_txt_xemtatca,"Xem tất cả"),e.txtViewAll.setTextBounds(0,0,191*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtViewAll),e.btnViewAll=new pt(e.positionUserProfile.playlist_line_select,e.chooseViewAll,Ug(Ug(e))),e.btnViewAll.x=e.txtViewAll.x,e.btnViewAll.y=e.txtViewAll.y,e.btnViewAll.width=191*window.GameConfig.RESIZE,e.btnViewAll.height=30*window.GameConfig.RESIZE,e.btnViewAll.alpha=0,e.addChild(e.btnViewAll),e.line=new rt(e.positionUserProfile.playlist_line),e.addChild(e.line),e.lineActive=new rt(e.positionUserProfile.playlist_line_select),e.addChild(e.lineActive),e.addAchi=new Phaser.Sprite(game,0,0,null),e.addChild(e.addAchi),e.heightGame=89*window.GameConfig.RESIZE,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jg(e,t)}(t,Mt),n=t,(i=[{key:"chooseViewAll",value:function(){this.event.view_all.dispatch()}},{key:"setData",value:function(e){for(;this.addAchi.children.length>0;){var t=this.addAchi.children[0];this.addAchi.removeChild(t),t.destroy(),t=null}this.txtPlayList.text="Huy chương ("+e+")"}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this.heightGame}}])&&Ng(n.prototype,i),o&&Ng(n,o),t}();function Zg(e){return(Zg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qg(e){return(Qg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vg(e,t){return(Vg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var qg=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Qg(t).call(this,game,null))||"object"!==Zg(i)&&"function"!=typeof i?Wg(n):i).event={view_all:new Phaser.Signal},e.positionUserProfile=e.mainData.positionUserProfile,e.txtPlayList=new St(e.positionUserProfile.playlist_txt_playlist,"Danh sách bạn bè (0)"),e.txtPlayList.setTextBounds(0,0,237*window.GameConfig.RESIZE,35*window.GameConfig.RESIZE),e.addChild(e.txtPlayList),e.txtViewAll=new St(e.positionUserProfile.playlist_txt_xemtatca,"Xem tất cả"),e.txtViewAll.setTextBounds(0,0,191*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtViewAll),e.btnViewAll=new pt(e.positionUserProfile.playlist_line_select,e.chooseViewAll,Wg(Wg(e))),e.btnViewAll.x=e.txtViewAll.x,e.btnViewAll.y=e.txtViewAll.y,e.btnViewAll.width=191*window.GameConfig.RESIZE,e.btnViewAll.height=30*window.GameConfig.RESIZE,e.btnViewAll.alpha=0,e.addChild(e.btnViewAll),e.line=new rt(e.positionUserProfile.playlist_line),e.addChild(e.line),e.lineActive=new rt(e.positionUserProfile.playlist_line_select),e.addChild(e.lineActive),e.addAchi=new Phaser.Sprite(game,0,0,null),e.addChild(e.addAchi),e.heightGame=89*window.GameConfig.RESIZE,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vg(e,t)}(t,Mt),n=t,(i=[{key:"chooseViewAll",value:function(){this.event.view_all.dispatch()}},{key:"setData",value:function(e){for(;this.addAchi.children.length>0;){var t=this.addAchi.children[0];this.addAchi.removeChild(t),t.destroy(),t=null}this.txtPlayList.text="Bạn bè ("+e+")"}},{key:"height",get:function(){return this.heightGame}},{key:"width",get:function(){return game.width}}])&&Hg(n.prototype,i),o&&Hg(n,o),t}();function Kg(e){return(Kg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yg(e,t){return!t||"object"!==Kg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jg(e){return(Jg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xg(e,t){return(Xg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $g=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Yg(this,Jg(t).call(this,game,null))).positionUserProfile=e.mainData.positionUserProfile,e.txtPlayList=new St(e.positionUserProfile.playlist_txt_playlist,"Điểm số cao nhất"),e.txtPlayList.setTextBounds(0,0,237*window.GameConfig.RESIZE,35*window.GameConfig.RESIZE),e.addChild(e.txtPlayList),e.line=new rt(e.positionUserProfile.playlist_line),e.addChild(e.line),e.lineActive=new rt(e.positionUserProfile.playlist_line_select),e.addChild(e.lineActive),e.lbMonth=new St(e.positionUserProfile.maxscore_label_month,"Tuần"),e.lbMonth.setTextBounds(0,0,255*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.lbMonth),e.lbAll=new St(e.positionUserProfile.maxscore_label_all,"Toàn bộ thời gian"),e.lbAll.setTextBounds(0,0,255*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.lbAll),e.txtScoreMonth=new St(e.positionUserProfile.maxscore_txt_month,"0"),e.txtScoreMonth.setTextBounds(0,0,255*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtScoreMonth),e.txtScoreAll=new St(e.positionUserProfile.maxscore_txt_all,"0"),e.txtScoreAll.setTextBounds(0,0,255*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtScoreAll),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xg(e,t)}(t,Mt),n=t,(i=[{key:"setData",value:function(e,t){this.txtScoreMonth.text=e,this.txtScoreAll.text=t}},{key:"height",get:function(){return 225*window.GameConfig.RESIZE}},{key:"width",get:function(){return game.width}}])&&zg(n.prototype,i),o&&zg(n,o),t}();function ey(e){return(ey="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ty(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ny(e,t){return!t||"object"!==ey(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iy(e,t,n){return(iy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oy(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oy(e){return(oy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ay(e,t){return(ay=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sy=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ny(this,oy(t).call(this,game,null))).dataProfile=null,e.event={view_all_playlist:new Phaser.Signal,view_all_friend:new Phaser.Signal,view_all_achievement:new Phaser.Signal,back:new Phaser.Signal},e.list=null,e.userProfile=null,e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),li.instance().showBanerUserProfileScreen(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ay(e,t)}(t,Mt),n=t,(i=[{key:"setData",value:function(e){null!==this.list&&(this.list.removeAll(),this.list.destroy(),this.list=null),this.dataProfile=e,null!==this.userProfile&&(this.removeChild(this.userProfile),this.userProfile.destroy(),this.userProfile=null),this.userProfile=new gg,this.userProfile.event.back.add(this.chooseBack,this),this.addChild(this.userProfile),this.userProfile.setData(this.dataProfile.user,this.dataProfile.game_status,this.dataProfile.friend_status,this.dataProfile.current_level,this.dataProfile.next_level);var t=new Phaser.Group(game,0,0,null);this.list=new Jo(game,t,new Phaser.Rectangle(0,this.userProfile.height+20,game.width,(game.height-this.userProfile.height)*window.GameConfig.RESIZE),{direction:"y",padding:0,searchForClicks:!0}),this.addChild(t),this.playList=new Sg,this.playList.event.view_all.add(this.viewAllPlaylist,this),this.playList.setData(this.dataProfile.number_of_playlist),this.list.add(this.playList),this.achievement=new Fg,this.achievement.event.view_all.add(this.viewAllAchievement,this),this.achievement.setData(this.dataProfile.number_achievement),this.list.add(this.achievement),this.friends=new qg,this.friends.event.view_all.add(this.viewAllFriend,this),this.friends.setData(this.dataProfile.count_friend),this.list.add(this.friends),this.maxScore=new $g,this.maxScore.setData(this.dataProfile.user.weekly_high_score,this.dataProfile.user.all_time_high_score),this.list.add(this.maxScore)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.list.removeAll(),this.list.destroy(),this.removeAllItem(),li.instance().hideBanner(),iy(oy(t.prototype),"destroy",this).call(this)}},{key:"viewAllPlaylist",value:function(){this.event.view_all_playlist.dispatch()}},{key:"viewAllAchievement",value:function(){this.event.view_all_achievement.dispatch()}},{key:"viewAllFriend",value:function(){this.event.view_all_friend.dispatch()}}])&&ty(n.prototype,i),o&&ty(n,o),t}();function ry(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ly=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("user_id",e),t}}],(n=null)&&ry(t.prototype,n),i&&ry(t,i),e}();function hy(e){return(hy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function uy(e,t){return!t||"object"!==hy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dy(e){return(dy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fy(e,t){return(fy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var py=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),uy(this,dy(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fy(e,t)}(t,Mt),n=t,(i=[{key:"init",value:function(){}},{key:"afterCreate",value:function(){this.columnNumber=0,this.rowNumber=0,this.viewWidth=0,this.viewHeight=0,this.leftDistance=0,this.distanceBetweenColumns=0,this.distanceBetweenRows=0}},{key:"setViewList",value:function(e){for(var t=0;t<e.length;t++){t%this.columnNumber==0?e[t].x=this.leftDistance:e[t].x=e[t-1].x+e[t-1].width+this.distanceBetweenColumns;var n=Math.floor(t/this.columnNumber);e[t].y=0===n?0:e[t-this.columnNumber].y+e[t-this.columnNumber].height+this.distanceBetweenRows,this.addChild(e[t])}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"height",get:function(){return this.viewHeight}},{key:"width",get:function(){return this.viewWidth}}])&&cy(n.prototype,i),o&&cy(n,o),t}();function gy(e){return(gy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function my(e,t,n){return(my="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vy(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function vy(e){return(vy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wy(e,t){return(wy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function by(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Sy=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=vy(t).call(this,game,null))||"object"!==gy(o)&&"function"!=typeof o?by(i):o).event={changeIndex:new Phaser.Signal},e&&(n.columnNumber=e.column,n.viewWidth=e.width,n.viewHeight=e.height,n.rowHeight=e.rowHeight,n.leftDistance=e.leftDistance,n.direction=e.direction,n.distanceBetweenColumns=e.distanceBetweenColumns,n.distanceBetweenRows=e.distanceBetweenRows),n.idDelay=null,n.idx=0,n.countItem=0,n.list=[];var a=new Phaser.Group(game),s=new Phaser.Rectangle(0,0,n.viewWidth,n.viewHeight);return n.scroll=new Jo(n.game,a,s,{direction:n.direction,searchForClicks:!0,padding:n.distanceBetweenRows}),n.scroll.events.changeIndex.add(n.changeIndex,by(by(n))),n.addChild(a),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wy(e,t)}(t,Mt),n=t,(i=[{key:"changeIndex",value:function(){this.event.changeIndex.dispatch(this.scroll.getIdx())}},{key:"buildListItem",value:function(){for(var e,t=this.idx;t<this.list.length;t++){if(t%this.columnNumber==0&&(e=[]),e.push(this.list[t]),this.idx++,e.length===this.columnNumber||t===this.list.length-1){var n=new py;n.columnNumber=this.columnNumber,n.rowNumber=1,n.viewWidth=this.viewWidth,n.viewHeight=this.rowHeight,n.leftDistance=this.leftDistance,n.distanceBetweenColumns=this.distanceBetweenColumns,n.distanceBetweenRows=this.distanceBetweenRows,n.setViewList(e),this.countItem++,this.scroll.add(n)}}}},{key:"addItem",value:function(e){var t=new py;t.columnNumber=this.columnNumber,t.rowNumber=1,t.viewWidth=this.viewWidth,t.viewHeight=this.rowHeight,t.leftDistance=this.leftDistance,t.distanceBetweenColumns=this.distanceBetweenColumns,t.distanceBetweenRows=this.distanceBetweenRows,t.setViewList(e),this.scroll.add(t)}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){if(this.removeDelayBuild(),this.scroll.removeAll(),this.scroll.destroy(),this.removeAllItem(),this.parent){var e=this;this.parent.removeChild(e),e.destroy(),e=null}my(vy(t.prototype),"destroy",this).call(this)}},{key:"viewList",set:function(e){this.scroll.removeAll(),this.scroll.reset(),this.idx=0,this.countItem=0,this.list=e,this.list.length>0&&(this.removeDelayBuild(),this.idDelay=game.time.events.add(.3*Phaser.Timer.SECOND,this.buildListItem,this))}}])&&yy(n.prototype,i),o&&yy(n,o),t}();function _y(e){return(_y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ey(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cy(e){return(Cy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ky(e,t){return(ky=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Py(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Oy=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Cy(t).call(this,game,null))||"object"!==_y(i)&&"function"!=typeof i?Py(n):i).event={BUY:new Phaser.Signal,CHOOSE:new Phaser.Signal},e.data=null,e.positionShop=z.instance().positionDefaultSource,e.bgButton=new pt(e.positionShop.playlist_button_buy,e.chooseItem,Py(Py(e))),e.bgButton.alpha=0,e.bgButton.x=0,e.bgButton.y=0,e.bgButton.width=166*z.instance().scale,e.bgButton.height=260*z.instance().scale,e.addChild(e.bgButton),e.ava=new Ch,e.ava.setSize(166*z.instance().scale,166*z.instance().scale),e.addChild(e.ava),e.lbName=new St(e.positionShop.gennes_text_name_playlist,""),e.lbName.lineSpacing=6,e.lbName.setTextBounds(0,0,166*z.instance().scale,89*z.instance().scale),e.addChild(e.lbName),e.btnBuy=new ln(e.positionShop.playlist_button_buy,"",e.chooseBuy,Py(Py(e))),e.btnBuy.visible=!1,e.addChild(e.btnBuy),e.lbWarning=new St(e.positionShop.playlist_text_warning,""),e.lbWarning.setTextBounds(0,0,166*z.instance().scale,41*z.instance().scale),e.lbWarning.text="",e.addChild(e.lbWarning),e.addLayout=new Phaser.Sprite(game,0,0,null),e.addLayout.x=6*z.instance().scale,e.addLayout.y=250*z.instance().scale,e.addChild(e.addLayout),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ky(e,t)}(t,Phaser.Group),n=t,(i=[{key:"chooseItem",value:function(){LogConsole.log("ShopItemPlayList - chooseItem"),this.event.CHOOSE.dispatch(this.data)}},{key:"chooseBuy",value:function(){LogConsole.log("chooseBuy : "+this.parent.x+" --- "+this.parent.y+"this.data  "+this.data.id),this.event.BUY.dispatch(this.data)}},{key:"setData",value:function(e,t){if(console.log("data.user"),console.log(e.user),this.data=e,null!=e)if(this.addLayout.removeChildren(),this.ava.beginLoad(this.data.thumb,t),this.lbName.text=this.data.name,1==this.data.is_owner){this.btnBuy.visible=!1;var n=new Mh(e.user);this.addLayout.addChild(n)}else this.btnBuy.setText(this.data.price),this.btnBuy.visible=!0}},{key:"getData",value:function(){return this.data}},{key:"destroy",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"width",get:function(){return this.ava.width}},{key:"height",get:function(){return 326*z.instance().scale}}])&&Ey(n.prototype,i),o&&Ey(n,o),t}();function Ry(e){return(Ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ty(e){return(Ty=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Iy(e,t){return(Iy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ay(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ly=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=Ty(t).call(this,game,null))||"object"!==Ry(o)&&"function"!=typeof o?Ay(i):o).user_id=e,qe.instance().showLoading(),n.event={back:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg);var a={column:3,width:game.width,height:game.height-160*window.GameConfig.RESIZE,rowHeight:326*window.GameConfig.RESIZE,leftDistance:35*window.GameConfig.RESIZE,direction:"y",distanceBetweenColumns:35*window.GameConfig.RESIZE,distanceBetweenRows:35*window.GameConfig.RESIZE};return n.scroll=new Sy(a),n.scroll.y=148*window.GameConfig.RESIZE,n.addChild(n.scroll),n.header=new Ya,n.header.event.back.add(n.chooseBack,Ay(Ay(n))),n.header.setBg(!1),n.header.setTitle("Playlist"),n.addChild(n.header),!0===Kr.instance().ktLoadPlaylist?n.buildDataPlaylistUser():(Kr.instance().event.load_playlist_complete.add(n.buildDataPlaylistUser,Ay(Ay(n))),Kr.instance().sendGetDataShop()),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iy(e,t)}(t,Mt),n=t,(i=[{key:"buildDataPlaylistUser",value:function(){this.user_id===mZ.instance().dataMySeft.user_id?(this.setPlaylist(Kr.instance().playlist.getArrMe()),qe.instance().hideLoading()):mZ.instance().sendData(As.USER_DETAIL_PLAYLIST_LOAD_REQUEST,ly.begin(this.user_id))}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"setPlaylist",value:function(e){var t=[];LogConsole.log("playlists -----------");for(var n=0;n<e.length;n++){var i=new Oy;i.event.CHOOSE.add(this.choosePlaylist,this),i.setData(e[n],n),t.push(i)}this.scroll.viewList=t}},{key:"choosePlaylist",value:function(e){iC.instance().addPlaylistDetail(e.id)}},{key:"destroy",value:function(){Kr.instance().event.load_playlist_complete.remove(this.buildDataPlaylistUser,this),this.scroll.destroy(),this.removeAllItem()}}])&&xy(n.prototype,i),o&&xy(n,o),t}();function Gy(e){return(Gy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function My(e){return(My=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ny(e,t){return(Ny=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function By(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var jy=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,n=!(o=My(t).call(this,game,null))||"object"!==Gy(o)&&"function"!=typeof o?By(i):o,qe.instance().showLoading(),n.event={back:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg);var a={column:4,width:game.width,height:game.height-160*window.GameConfig.RESIZE,rowHeight:178*window.GameConfig.RESIZE,leftDistance:35*window.GameConfig.RESIZE,direction:"y",distanceBetweenColumns:32*window.GameConfig.RESIZE,distanceBetweenRows:32*window.GameConfig.RESIZE};return n.scroll=new Sy(a),n.scroll.y=148*window.GameConfig.RESIZE,n.addChild(n.scroll),n.header=new Ya,n.header.event.back.add(n.chooseBack,By(By(n))),n.header.setBg(!1),n.header.setTitle("Huy chương"),n.addChild(n.header),mZ.instance().sendData(As.USER_DETAIL_ACHIEVEMENT_LOAD_REQUEST,ly.begin(e)),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ny(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"setAchievement",value:function(e){var t=[];LogConsole.log("playlists -----------");for(var n=0;n<e.length;n++){var i=new Dg;i.setData(e[n],n),t.push(i)}this.scroll.viewList=t}},{key:"destroy",value:function(){this.scroll.destroy(),this.removeAllItem()}}])&&Dy(n.prototype,i),o&&Dy(n,o),t}();function Uy(e){return(Uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zy(e,t){return!t||"object"!==Uy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hy(e){return(Hy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qy(e,t){return(Qy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vy=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Zy(this,Hy(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qy(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.positionCreateRoom=this.mainData.positionDefaultSource,this.event={invite:new Phaser.Signal},this.data=new ma,this.ava=new Pc,this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.chooseInfo,this),this.ava.setSize(68*z.instance().scale,68*z.instance().scale),this.ava.x=36*z.instance().scale,this.ava.y=27*z.instance().scale,this.addChild(this.ava),this.txtName=new St(this.positionCreateRoom.listfriend_txt_name,"Viet PV"),this.addChild(this.txtName),this.btnInvite=new ln(this.positionCreateRoom.listfriend_btn_invite,"MỜI",this.chooseInvite,this),this.addChild(this.btnInvite),this.inviteDone=new rt(this.positionCreateRoom.friend_invite_done),this.inviteDone.x=this.btnInvite.x+(this.btnInvite.width-this.inviteDone.width)/2,this.inviteDone.y=this.btnInvite.y+(this.btnInvite.height-this.inviteDone.height)/2,this.inviteDone.visible=!1,this.addChild(this.inviteDone),this.iconOnline=new rt(this.positionCreateRoom.listfriend_icon_online),this.iconOnline.visible=!1,this.addChild(this.iconOnline),this.iconOffline=new rt(this.positionCreateRoom.listfriend_icon_offline),this.addChild(this.iconOffline),this.line=new rt(this.positionCreateRoom.listfriend_bg_line),this.addChild(this.line)}},{key:"chooseInfo",value:function(e,t,n){n&&iC.instance().addUserProfile(this.data.userId)}},{key:"setData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];LogConsole.log(e),this.data=Object.assign({},this.data,e),this.txtName.text=this.data.userName,!0===n?(this.data.isOnline?(this.iconOnline.visible=!0,this.iconOffline.visible=!1):(this.iconOnline.visible=!1,this.iconOffline.visible=!0),this.btnInvite.visible=!1):this.data.isOnline?(this.iconOnline.visible=!0,this.iconOffline.visible=!1,this.btnInvite.visible=!0):(this.iconOnline.visible=!1,this.iconOffline.visible=!0,this.btnInvite.visible=!1),this.ava.setAvatar(this.data.avatar,t),this.x=game.width,game.add.tween(this).to({x:0},150,Phaser.Easing.Power1,!0,80*(t+1))}},{key:"chooseInvite",value:function(){LogConsole.log("chooseInvite"),this.btnInvite.visible=!1,this.inviteDone.visible=!0,this.event.invite.dispatch(this.data)}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return 110*z.instance().scale}}])&&Fy(n.prototype,i),o&&Fy(n,o),t}();function Wy(e){return(Wy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ky(e){return(Ky=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zy(e,t){return(zy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Jy=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,n=!(o=Ky(t).call(this,game,null))||"object"!==Wy(o)&&"function"!=typeof o?Yy(i):o,qe.instance().showLoading(),n.event={back:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg);var a=new Phaser.Group(game,0,0,null);return n.listFriends=new Jo(game,a,new Phaser.Rectangle(0,0,game.width,game.height-100*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),a.x=0,a.y=100*z.instance().scale,n.addChild(a),n.header=new Ya,n.header.event.back.add(n.chooseBack,Yy(Yy(n))),n.header.setBg(!1),n.header.setTitle("Bạn bè"),n.addChild(n.header),li.instance().showBanerViewAllFriendScreen(),mZ.instance().sendData(As.USER_FRIEND_LIST_LOAD_REQUEST,ly.begin(e)),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zy(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"setFriend",value:function(e){LogConsole.log("playlists -----------");for(var t=0;t<e.length;t++){var n=new Vy;n.setData(e[t],t,!0),this.listFriends.add(n)}}},{key:"destroy",value:function(){li.instance().hideBanner(),this.listFriends.removeAll(),this.listFriends.destroy(),this.removeAllItem()}}])&&qy(n.prototype,i),o&&qy(n,o),t}();function Xy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t={game_status:"",friend_status:"",number_achievement:0,its_me:!1,user:{level:0,level_title:"",user_name:"",all_time_high_score:0,last_login:0,weekly_high_score:0,description:"",id:0,avatar:"",is_online:!1,experience_score:0},number_of_playlist:0,count_friend:0,next_level:{level:0,id:0,experience_score:0},current_level:{level:0,id:0,experience_score:0}};if(!0===e.getBool("its_me")){var n=mZ.instance().dataMySeft;t.user.level=n.level,t.user.level_title=e.getUtfString("level_title"),t.user.user_name=n.user_name,t.user.all_time_high_score=n.all_time_high_score,t.user.weekly_high_score=n.weekly_high_score,t.user.description=n.description,t.user.id=n.user_id,t.user.avatar=n.avatar,t.user.experience_score=n.experience_score;var i=e.getSFSObject("current_level");t.current_level.level=i.getInt("level"),t.current_level.id=i.getInt("id"),t.current_level.experience_score=i.getInt("experience_score");var o=e.getSFSObject("next_level");t.next_level.level=o.getInt("level"),t.next_level.id=o.getInt("id"),t.next_level.experience_score=o.getInt("experience_score")}else{t.game_status=e.getUtfString("game_status"),t.friend_status=e.getUtfString("friend_status");var a=e.getSFSObject("user");t.user.level=a.getInt("level"),t.user.level_title=a.getUtfString("level_title"),t.user.user_name=a.getUtfString("user_name"),t.user.all_time_high_score=a.getInt("all_time_high_score"),t.user.last_login=a.getLong("last_login"),t.user.weekly_high_score=a.getInt("weekly_high_score"),t.user.description=a.getUtfString("description"),t.user.id=a.getInt("id"),t.user.avatar=a.getUtfString("avatar"),t.user.is_online=a.getBool("is_online"),t.user.experience_score=a.getInt("experience_score")}return t.number_achievement=e.getInt("number_achievement"),t.number_of_playlist=e.getInt("number_of_playlist"),t.count_friend=e.getInt("count_friend"),t}}],(n=null)&&Xy(t.prototype,n),i&&Xy(t,i),e}();function em(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var tm=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=[],n=e.getSFSArray("playlists"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=Kr.instance().playlist.getPlayListById(o.getInt("playlist_id"));if(null!==a){var s=new Vs;s.is_highlight=a.is_highlight,s.used_times=a.used_times,s.thumb=a.thumb,s.created=a.created,s.is_owner=a.is_owner,s.is_default=a.is_default,s.genre_id=a.genre_id,s.purchased=a.purchased,s.songs=a.songs,s.price=a.price,s.is_general=a.is_general,s.name=a.name,s.id=a.id,s.vip=a.vip,s.is_solo_mode=a.is_solo_mode,s.updated=a.updated,s.country_id=a.country_id,s.purchased_count=a.purchased_count,s.active=a.active,s.user.level=o.getInt("level"),s.user.exp_score=o.getInt("exp_score"),s.user.current_level_score=o.getInt("current_level_score"),s.user.next_level_score=o.getInt("next_level_score"),s.user.updated=o.getLong("updated"),s.is_owner=1,t.push(s)}}return t}}],(n=null)&&em(t.prototype,n),i&&em(t,i),e}();function nm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var im=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"achievements",get:function(){return"achievements"}},{key:"reward",get:function(){return"reward"}},{key:"condition",get:function(){return"condition"}},{key:"achievement_type_id",get:function(){return"achievement_type_id"}},{key:"is_done",get:function(){return"is_done"}},{key:"reward_type",get:function(){return"reward_type"}},{key:"medal",get:function(){return"medal"}},{key:"achieved",get:function(){return"achieved"}},{key:"description",get:function(){return"description"}},{key:"id",get:function(){return"id"}},{key:"title",get:function(){return"title"}},{key:"required",get:function(){return"required"}},{key:"playlists",get:function(){return"playlists"}},{key:"is_highlight",get:function(){return"is_highlight"}},{key:"used_times",get:function(){return"used_times"}},{key:"thumb",get:function(){return"thumb"}},{key:"created",get:function(){return"created"}},{key:"is_owner",get:function(){return"is_owner"}},{key:"is_default",get:function(){return"is_default"}},{key:"genre_id",get:function(){return"genre_id"}},{key:"price",get:function(){return"price"}},{key:"is_general",get:function(){return"is_general"}},{key:"name",get:function(){return"name"}},{key:"purchased_count",get:function(){return"purchased_count"}},{key:"vip",get:function(){return"vip"}},{key:"is_solo_mode",get:function(){return"is_solo_mode"}},{key:"updated",get:function(){return"updated"}},{key:"user_playlist_mapping",get:function(){return"user_playlist_mapping"}},{key:"user_id",get:function(){return"user_id"}},{key:"level",get:function(){return"level"}},{key:"playlist_id",get:function(){return"playlist_id"}},{key:"exp_score",get:function(){return"exp_score"}},{key:"active",get:function(){return"active"}},{key:"current_level_score",get:function(){return"current_level_score"}},{key:"next_level_score",get:function(){return"next_level_score"}},{key:"master",get:function(){return"master"}},{key:"gender",get:function(){return"gender"}},{key:"user_name",get:function(){return"user_name"}},{key:"all_time_high_score",get:function(){return"all_time_high_score"}},{key:"last_login",get:function(){return"last_login"}},{key:"weekly_high_score",get:function(){return"weekly_high_score"}},{key:"avatar",get:function(){return"avatar"}},{key:"is_online",get:function(){return"is_online"}},{key:"user",get:function(){return"user"}},{key:"friends",get:function(){return"friends"}},{key:"game_status",get:function(){return"game_status"}},{key:"friend_status",get:function(){return"friend_status"}},{key:"support_item",get:function(){return"support_item"}},{key:"level_title",get:function(){return"level_title"}},{key:"next_level",get:function(){return"next_level"}},{key:"current_level",get:function(){return"current_level"}},{key:"experience_score",get:function(){return"experience_score"}}],(n=null)&&nm(t.prototype,n),i&&nm(t,i),e}();function om(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var am=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=[],n=e.getSFSArray(im.achievements),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new _g;a.medal=o.getUtfString(im.medal),a.title=o.getUtfString(im.title),a.current_level=o.getInt("current_level"),t.push(a)}return t}}],(n=null)&&om(t.prototype,n),i&&om(t,i),e}();function sm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var rm=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=[],n=e.getSFSArray(im.friends),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new ma;a.avatar=o.getUtfString(im.avatar),a.isOnline=o.getBool(im.is_online),a.userId=o.getInt(im.id),a.userName=o.getUtfString(im.user_name),t.push(a)}return t}}],(n=null)&&sm(t.prototype,n),i&&sm(t,i),e}();function lm(e){return(lm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cm(e,t){return!t||"object"!==lm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function um(e,t,n){return(um="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dm(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dm(e){return(dm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fm(e,t){return(fm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pm=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=cm(this,dm(t).call(this,game,null))).arrResource=[],e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fm(e,t)}(t,Mt),n=t,(i=[{key:"loadResource",value:function(){for(var e=0;e<this.arrResource.length;e++){console.log(this.arrResource[e]);var t=this.arrResource[e],n=t.type,i=t.link+"?v=".concat(window.VersionClient),o=t.key;switch(n){case"text":game.load.text(o,i);break;case"image":game.load.image(o,i);break;case"atlas":var a=t.linkJson+"?v=".concat(window.VersionClient);game.load.atlas(o,i,a,Phaser.Loader.TEXTURE_ATLAS_JSON_HASH);break;case"spritesheet":var s=t.width,r=t.height,l=t.countFrame;game.load.spritesheet(o,i,s,r,l)}}game.load.onLoadComplete.add(this.loadDataFileComplete,this),game.load.start()}},{key:"loadDataFileComplete",value:function(){console.log("loadDataFileComplete----------"),game.load.onLoadComplete.remove(this.loadDataFileComplete,this),this.loadFileComplete()}},{key:"loadFileComplete",value:function(){}},{key:"removeResource",value:function(){console.log("removeResource--------------");for(var e=0;e<this.arrResource.length;e++){var t=this.arrResource[e],n=t.type,i=t.key;switch(n){case"text":game.cache.checkTextKey(i)&&game.cache.removeText(i);break;case"image":game.cache.checkImageKey(i)&&game.cache.removeImage(i);break;case"atlas":game.cache.checkImageKey(i)&&game.cache.removeImage(i);var o=t.linkJson+"?v=".concat(window.VersionClient);game.cache.checkJSONKey(o)&&game.cache.removeJSON(o),game.cache.checkXMLKey(o)&&game.cache.removeXML(o);break;case"spritesheet":game.cache.checkImageKey(i)&&game.cache.removeImage(i)}}}},{key:"destroy",value:function(){this.removeResource(),um(dm(t.prototype),"destroy",this).call(this)}}])&&hm(n.prototype,i),o&&hm(n,o),t}();function gm(e){return(gm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ym(e,t){return!t||"object"!==gm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mm(e,t,n){return(mm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vm(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function vm(e){return(vm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bm(e,t,n){return t&&wm(e.prototype,t),n&&wm(e,n),e}function Sm(e,t){return(Sm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _m=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ym(this,vm(t).call(this,game,null))).event={back:new Phaser.Signal},LogConsole.log("user_id : "+e),n.screenIdx=i,n.user_id=e,n.userProfile=null,n.allPlaylist=null,n.allAchievement=null,n.allFriend=null,n.dataProfile=null,n.arrResource=[{type:"atlas",link:"img/atlas/userprofile.png",key:"userprofile",linkJson:"img/atlas/userprofile.json"}],n.loadResource(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sm(e,t)}(t,pm),bm(t,null,[{key:"SCREEN_PROFILE",get:function(){return 0}},{key:"SCREEN_PLAYLIST",get:function(){return 1}},{key:"SCREEN_ACHIEVEMENT",get:function(){return 2}},{key:"SCREEN_FRIEND",get:function(){return 3}}]),bm(t,[{key:"loadFileComplete",value:function(){switch(mm(vm(t.prototype),"loadFileComplete",this).call(this),this.screenIdx){case t.SCREEN_PROFILE:this.addUserProfile();break;case t.SCREEN_ACHIEVEMENT:this.addAllAchievement();break;case t.SCREEN_PLAYLIST:this.addAllPlaylist();break;case t.SCREEN_FRIEND:this.addAllFriend()}this.addEvent()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),qe.instance().showLoading(),this.updateDescription(),De.instance().event.updateDescription.add(this.updateDescription,this)}},{key:"updateDescription",value:function(){mZ.instance().sendData(As.USER_DETAIL_LOAD_REQUEST,ly.begin(this.user_id))}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),De.instance().event.updateDescription.remove(this.updateDescription,this)}},{key:"getData",value:function(e){switch(e.cmd){case As.USER_DETAIL_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")?(this.dataProfile=$y.begin(e.params),null!==this.userProfile&&this.userProfile.setData(this.dataProfile)):this.chooseBackUser(),qe.instance().hideLoading();break;case As.USER_FRIEND_RESPONSE:case As.USER_FRIEND_REQUEST:this.updateDescription();break;case As.USER_DETAIL_PLAYLIST_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&null!==this.allPlaylist?this.allPlaylist.setPlaylist(tm.begin(e.params)):this.chooseBack(),qe.instance().hideLoading();break;case As.USER_DETAIL_ACHIEVEMENT_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&null!==this.allAchievement?this.allAchievement.setAchievement(am.begin(e.params)):this.chooseBack(),qe.instance().hideLoading();break;case As.USER_FRIEND_LIST_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&null!==this.allFriend?this.allFriend.setFriend(rm.begin(e.params)):this.chooseBack(),qe.instance().hideLoading()}}},{key:"removeAllScreen",value:function(){this.removeUserProfile(),this.removeAllPlaylist(),this.removeAllAchievement(),this.removeAllFriend()}},{key:"addUserProfile",value:function(){this.removeAllScreen(),this.userProfile=new sy,this.userProfile.event.back.add(this.chooseBackUser,this),this.userProfile.event.view_all_achievement.add(this.addAllAchievement,this),this.userProfile.event.view_all_friend.add(this.addAllFriend,this),this.userProfile.event.view_all_playlist.add(this.addAllPlaylist,this),null!==this.dataProfile&&this.userProfile.setData(this.dataProfile),this.addChild(this.userProfile)}},{key:"removeUserProfile",value:function(){null!==this.userProfile&&(this.removeChild(this.userProfile),this.userProfile.destroy(),this.userProfile=null)}},{key:"addAllPlaylist",value:function(){this.removeAllScreen(),this.allPlaylist=new Ly(this.user_id),this.allPlaylist.event.back.add(this.chooseBack,this),this.addChild(this.allPlaylist)}},{key:"removeAllPlaylist",value:function(){null!==this.allPlaylist&&(this.removeChild(this.allPlaylist),this.allPlaylist.destroy(),this.allPlaylist=null)}},{key:"addAllAchievement",value:function(){this.removeAllScreen(),this.allAchievement=new jy(this.user_id),this.allAchievement.event.back.add(this.chooseBack,this),this.addChild(this.allAchievement)}},{key:"removeAllAchievement",value:function(){null!==this.allAchievement&&(this.removeChild(this.allAchievement),this.allAchievement.destroy(),this.allAchievement=null)}},{key:"addAllFriend",value:function(){this.removeAllScreen(),this.allFriend=new Jy(this.user_id),this.allFriend.event.back.add(this.chooseBack,this),this.addChild(this.allFriend)}},{key:"removeAllFriend",value:function(){null!==this.allFriend&&(this.removeChild(this.allFriend),this.allFriend.destroy(),this.allFriend=null)}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack"+this.screenIdx),this.screenIdx>0?this.event.back.dispatch():this.addUserProfile()}},{key:"chooseBackUser",value:function(){LogConsole.log("chooseBackUser"),this.event.back.dispatch()}},{key:"destroy",value:function(){this.removeEvent(),this.removeAllScreen(),this.removeAllItem(),mm(vm(t.prototype),"destroy",this).call(this)}}]),t}();function Em(e){return(Em="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function km(e,t){return!t||"object"!==Em(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pm(e){return(Pm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Om(e,t){return(Om=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rm=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=km(this,Pm(t).call(this,e,n,i))).positionShop=z.instance().positionShop,o.btn=null,o.idx=-1,o.txtContent=new St(o.positionShop.bot_menu_text_button,""),o.txtContent.setTextBounds(0,0,160*z.instance().scale,27*z.instance().scale),o.addChild(o.txtContent),o.lineDoc=new rt(o.positionShop.playlist_menu_linedoc),o.lineDoc.x=159*z.instance().scale,o.lineDoc.y=41*z.instance().scale,o.addChild(o.lineDoc),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Om(e,t)}(t,pt),n=t,(i=[{key:"setButton",value:function(e,t){this.idx=t,this.btn=new rt(e.obj),LogConsole.log("this.width : "+this.width+" this.btn.width "+this.btn.width),this.btn.x=(this.width-this.btn.width)/2,this.addChild(this.btn),this.txtContent.text=e.content,3==t&&(this.lineDoc.visible=!1)}},{key:"getIdx",value:function(){return this.idx}},{key:"active",value:function(){this.btn.alpha=1,this.btn.y=25*z.instance().scale,this.txtContent.visible=!0}},{key:"deactive",value:function(){this.btn.alpha=.2,this.btn.y=41*z.instance().scale,this.txtContent.visible=!1}}])&&Cm(n.prototype,i),o&&Cm(n,o),t}();function xm(e){return(xm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Im(e){return(Im=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Am(e,t){return(Am=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Gm=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Im(t).call(this,game,null))||"object"!==xm(i)&&"function"!=typeof i?Lm(n):i).event={change_menu:new Phaser.Signal},e.positionShop=z.instance().positionShop,e.idxTab=o;var a=[{obj:{x:0,y:0,nameAtlas:"shop",nameSprite:"Icon_Playlist_active"},content:"Playlist"},{obj:{x:0,y:0,nameAtlas:"shop",nameSprite:"Icon_Tainguyen_active"},content:"Tài nguyên"},{obj:{x:0,y:0,nameAtlas:"shop",nameSprite:"Icon_Hotro_active"},content:"Hỗ trợ"},{obj:{x:0,y:0,nameAtlas:"shop",nameSprite:"Icon_Vip_active"},content:"Vip"}];e.line=new rt(e.positionShop.bot_menu_line_top),e.addChild(e.line),e.arrButtonTab=[];for(var s=0,r=0;r<a.length;r++){var l=new Rm(e.positionShop.bot_menu_bg_button,e.chooseButton,Lm(Lm(e)));l.setButton(a[r],r),l.x=s,s+=l.width,e.addChild(l),r===e.idxTab?l.active():l.deactive(),e.arrButtonTab.push(l)}return e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Am(e,t)}(t,Mt),n=t,(i=[{key:"chooseButton",value:function(e){LogConsole.log("chooseButton"),LogConsole.log(e);var t=e.getIdx();if(t===this.idxTab);else{for(var n=0;n<this.arrButtonTab.length;n++){var i=this.arrButtonTab[n];i.getIdx()!==t?i.deactive():i.active()}this.idxTab=t,this.event.change_menu.dispatch(this.idxTab)}}}])&&Tm(n.prototype,i),o&&Tm(n,o),t}();function Dm(e){return(Dm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nm(e,t){return!t||"object"!==Dm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bm(e,t,n){return(Bm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jm(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function jm(e){return(jm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Um(e,t){return(Um=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fm=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Nm(this,jm(t).call(this,game,0,0,null,n,i))).positionShop=z.instance().positionShop,o.lineNgang=new rt(o.positionShop.sort_play_list_icon_active_search_menu),o.addChild(o.lineNgang),o.lineDoc=new rt(o.positionShop.sort_play_list_linedoc_search_menu),o.addChild(o.lineDoc),o.txtContent=new St(o.positionShop.sort_play_list_text_search_menu,e),o.txtContent.setTextBounds(0,0,o.width,o.height),o.addChild(o.txtContent),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Um(e,t)}(t,Phaser.Button),n=t,(i=[{key:"active",value:function(){this.lineNgang.visible=!0,this.txtContent.changeStyle({fill:"#ffffff"})}},{key:"deactive",value:function(){this.lineNgang.visible=!1,this.txtContent.changeStyle({fill:"#695782"})}},{key:"hideDoc",value:function(){this.lineDoc.visible=!1}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),Bm(jm(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"destroy",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}Bm(jm(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return 213*z.instance().scale}},{key:"height",get:function(){return 100*z.instance().scale}}])&&Mm(n.prototype,i),o&&Mm(n,o),t}();function Zm(e){return(Zm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qm(e,t){return!t||"object"!==Zm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vm(e){return(Vm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wm(e,t){return(Wm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qm(this,Vm(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wm(e,t)}(t,Mt),n=t,o=[{key:"SORT_AZ",value:function(){return"SORT_AZ"}},{key:"SORT_NEW",value:function(){return"SORT_NEW"}},{key:"SORT_POP",value:function(){return"SORT_POP"}}],(i=[{key:"afterCreate",value:function(){this.eventChangeMenu=new Phaser.Signal,this.eventSearch=new Phaser.Signal,this.positionShop=this.mainData.positionShop,this.type=t.sortAZ,this.bg=new pt(this.positionShop.sort_play_list_bg_search_menu),this.addChild(this.bg),this.sortAZ=new Fm("Top nghệ sĩ",this.chooseSortAZ,this),this.sortAZ.active(),this.addChild(this.sortAZ),this.sortNew=new Fm("Mới Nhất",this.chooseSortNew,this),this.sortNew.deactive(),this.sortNew.x=this.sortAZ.x+213*z.instance().scale,this.addChild(this.sortNew),this.sortPhobien=new Fm("Phổ Biến",this.chooseSortPhobien,this),this.sortPhobien.deactive(),this.sortPhobien.hideDoc(),this.sortPhobien.x=this.sortNew.x+213*z.instance().scale,this.addChild(this.sortPhobien)}},{key:"setMenu",value:function(e){e===t.SORT_AZ?(this.type=t.SORT_AZ,this.sortAZ.active(),this.sortNew.deactive(),this.sortPhobien.deactive()):e===t.SORT_NEW?(this.type=t.SORT_NEW,this.sortAZ.deactive(),this.sortNew.active(),this.sortPhobien.deactive()):(this.type=t.SORT_POP,this.sortAZ.deactive(),this.sortNew.deactive(),this.sortPhobien.active())}},{key:"addEventChangeMenu",value:function(e,t){this.eventChangeMenu.add(e,t)}},{key:"removeEventChangeMenu",value:function(e,t){this.eventChangeMenu.remove(e,t)}},{key:"dispatchEventChangeMenu",value:function(){this.eventChangeMenu.dispatch(this.type)}},{key:"addEventSearch",value:function(e,t){this.eventSearch.add(e,t)}},{key:"removeEventSearch",value:function(e,t){this.eventSearch.remove(e,t)}},{key:"dispatchEventSearch",value:function(e){this.eventSearch.dispatch(e)}},{key:"chooseSortAZ",value:function(){LogConsole.log("chooseSortAZ"),this.type!==t.SORT_AZ&&(this.type=t.SORT_AZ,this.sortAZ.active(),this.sortNew.deactive(),this.sortPhobien.deactive(),this.dispatchEventChangeMenu())}},{key:"chooseSortNew",value:function(){LogConsole.log("chooseSortNew"),this.type!==t.SORT_NEW&&(this.type=t.SORT_NEW,this.sortAZ.deactive(),this.sortNew.active(),this.sortPhobien.deactive(),this.dispatchEventChangeMenu())}},{key:"chooseSortPhobien",value:function(){LogConsole.log("chooseSortPhobien"),this.type!==t.SORT_POP&&(this.type=t.SORT_POP,this.sortAZ.deactive(),this.sortNew.deactive(),this.sortPhobien.active(),this.dispatchEventChangeMenu())}},{key:"destroy",value:function(){this.bg.destroy(),this.sortAZ.destroy(),this.sortNew.destroy(),this.sortPhobien.destroy()}}])&&Hm(n.prototype,i),o&&Hm(n,o),t}();function Km(e){return(Km="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ym(e,t){return!t||"object"!==Km(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jm(e,t,n){return(Jm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xm(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Xm(e){return(Xm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $m(e,t){return($m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ev=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ym(this,Xm(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$m(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.eventSearch=new Phaser.Signal,this.eventBack=new Phaser.Signal,this.positionShop=this.mainData.positionShop,this.bg=new rt(this.positionShop.sort_play_list_bg_top_menu),this.addChild(this.bg),this.btnBack=new pt(this.positionShop.sort_play_list_bg_back_top_menu,this.chooseBack,this),this.addChild(this.btnBack),this.btnSearch=new pt(this.positionShop.sort_play_list_bg_search_icon_top_menu,this.chooseSearch,this),this.addChild(this.btnSearch),this.btnDiamond=new ln(this.positionShop.sort_play_list_bg_diamond_top_menu,mZ.instance().dataMySeft.diamond),this.addChild(this.btnDiamond),this.addEvent()}},{key:"addEvent",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this),De.instance().event.backButton.add(this.chooseBack,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this),De.instance().event.backButton.remove(this.chooseBack,this)}},{key:"onUserVarsUpdate",value:function(e){null!==this.btnDiamond&&this.btnDiamond.setText(mZ.instance().dataMySeft.diamond)}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack"),this.dispatchEventBack()}},{key:"chooseSearch",value:function(){LogConsole.log("chooseSearch"),this.addKeyBoard()}},{key:"addEventSearch",value:function(e,t){this.eventSearch.add(e,t)}},{key:"removeEventSearch",value:function(e,t){this.eventSearch.remove(e,t)}},{key:"dispatchEventSearch",value:function(e){this.eventSearch.dispatch(e)}},{key:"addEventBack",value:function(e,t){this.eventBack.add(e,t)}},{key:"removeEventBack",value:function(e,t){this.eventBack.remove(e,t)}},{key:"dispatchEventBack",value:function(){this.eventBack.dispatch()}},{key:"addKeyBoard",value:function(){rl.instance().show({maxLength:"",showTransparent:!0,placeholder:"Nhập từ khóa",isSearch:!0,typeInputText:"search"}),rl.instance().event.change.add(this.changeKeyBoard,this),rl.instance().event.hideKeyboard.add(this.hideKeyboard,this),rl.instance().event.enter.add(this.onSubmit,this),rl.instance().event.submit.add(this.onSubmit,this),rl.instance().event.cancle.add(this.onCancel,this)}},{key:"hideKeyboard",value:function(){rl.instance().hide()}},{key:"onSubmit",value:function(){var e=rl.instance().getValue();this.dispatchEventSearch(e),setTimeout(function(){rl.instance().hide()},100)}},{key:"onCancel",value:function(){rl.instance().event.change.remove(this.changeKeyBoard,this),rl.instance().event.hideKeyboard.remove(this.hideKeyboard,this),rl.instance().event.enter.remove(this.onSubmit,this),rl.instance().event.submit.remove(this.onSubmit,this),rl.instance().event.cancle.remove(this.onCancel,this),rl.instance().hide()}},{key:"changeKeyBoard",value:function(){var e=rl.instance().getValue();this.dispatchEventSearch(e)}},{key:"destroy",value:function(){this.removeEvent(),this.bg.destroy(),this.btnBack.destroy(),this.btnSearch.destroy(),this.btnDiamond.destroy(),this.onCancel(),Jm(Xm(t.prototype),"destroy",this).call(this)}}])&&zm(n.prototype,i),o&&zm(n,o),t}();function tv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var nv=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"getNameRegion",value:function(t){return t===e.Local?"Nhạc Châu Á":t===e.International?"Nhạc Âu Mỹ":void 0}},{key:"Local",get:function(){return"Local"}},{key:"International",get:function(){return"International"}}],(n=null)&&tv(t.prototype,n),i&&tv(t,i),e}();function iv(e){return(iv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ov(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function av(e,t){return!t||"object"!==iv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sv(e,t,n){return(sv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rv(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function rv(e){return(rv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lv(e,t){return(lv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hv=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=av(this,rv(t).call(this,game,0,0,null,e,n))).data=null,i.idx=0,i.positionShop=z.instance().positionShop,i.bgGenes=new Zt(i.positionShop.gennes_bg_item),i.addChild(i.bgGenes),i.bgGenesActive=new Zt(i.positionShop.gennes_bg_item_active),i.addChild(i.bgGenesActive),i.lbGennes=new St(i.positionShop.gennes_text_item),i.addChild(i.lbGennes),i.deactive(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lv(e,t)}(t,Phaser.Button),n=t,(i=[{key:"active",value:function(){this.bgGenesActive.visible=!0,this.bgGenes.visible=!1}},{key:"deactive",value:function(){this.bgGenesActive.visible=!1,this.bgGenes.visible=!0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e,t){this.data=e,this.idx=t,this.lbGennes.text=this.data.genre,this.bgGenes.width=this.lbGennes.width+35*z.instance().scale,this.bgGenes.height=65*z.instance().scale,this.bgGenesActive.width=this.lbGennes.width+35*z.instance().scale,this.bgGenesActive.height=65*z.instance().scale,this.lbGennes.x=(this.bgGenes.width-this.lbGennes.width)/2,this.lbGennes.y=(this.bgGenes.height-this.lbGennes.height)/2,LogConsole.log(this.lbGennes.width),LogConsole.log(this.bgGenes.width)}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),sv(rv(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"destroy",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}sv(rv(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.bgGenes.width}},{key:"height",get:function(){return this.bgGenes.height}}])&&ov(n.prototype,i),o&&ov(n,o),t}();function cv(e){return(cv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dv(e,t){return!t||"object"!==cv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fv(e,t,n){return(fv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pv(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pv(e){return(pv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gv(e,t){return(gv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yv=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=dv(this,pv(t).call(this,game,0,0,null,n,i))).positionShop=z.instance().positionShop,o.lineNgang=new rt(o.positionShop.playlist_menu_linengang),o.lineNgang.width=224,o.addChild(o.lineNgang),o.lineDoc=new rt(o.positionShop.playlist_menu_linedoc),o.addChild(o.lineDoc),o.txtContent=new St(o.positionShop.playlist_menu_textcontent,e),o.txtContent.setTextBounds(0,0,o.width,o.height),o.addChild(o.txtContent),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gv(e,t)}(t,Phaser.Button),n=t,(i=[{key:"active",value:function(){this.lineNgang.visible=!0,this.txtContent.changeStyle({fill:"#ffffff"})}},{key:"deactive",value:function(){this.lineNgang.visible=!1,this.txtContent.changeStyle({fill:"#695782"})}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),fv(pv(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"destroy",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}fv(pv(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return 225*z.instance().scale}},{key:"height",get:function(){return 87*z.instance().scale}}])&&uv(n.prototype,i),o&&uv(n,o),t}();function mv(e){return(mv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wv(e,t){return!t||"object"!==mv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bv(e){return(bv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sv(e,t){return(Sv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _v=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),wv(this,bv(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sv(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={close:new Phaser.Signal,change_menu:new Phaser.Signal,choose_sort:new Phaser.Signal},this.type=nv.Local,this.positionShop=this.mainData.positionShop,this.bgMenu=new pt(this.positionShop.playlist_bg_menu),this.bgMenu.height=89*this.mainData.scale,this.addChild(this.bgMenu),this.btnNhacViet=new yv(nv.getNameRegion(nv.Local),this.chooseNhacViet,this),this.btnNhacViet.active(),this.addChild(this.btnNhacViet),this.btnQuocTe=new yv(nv.getNameRegion(nv.International),this.chooseQuocTe,this),this.btnQuocTe.x=this.btnNhacViet.width*this.mainData.scale,this.btnQuocTe.deactive(),this.addChild(this.btnQuocTe),this.btnChooseSort=new ln(this.positionShop.bg_tab_menu_select,"A-Z",this.btnChooseSort,this),this.addChild(this.btnChooseSort)}},{key:"setTextSort",value:function(e){this.btnChooseSort.setText(e)}},{key:"btnChooseSort",value:function(){this.event.choose_sort.dispatch()}},{key:"chooseClose",value:function(){LogConsole.log("chooseClose"),this.event.close.dispatch()}},{key:"chooseNhacViet",value:function(){LogConsole.log("chooseNhacViet"),this.type===nv.International&&(this.type=nv.Local,this.btnNhacViet.active(),this.btnQuocTe.deactive(),this.event.change_menu.dispatch(nv.Local))}},{key:"chooseQuocTe",value:function(){LogConsole.log("chooseQuocTe"),this.type===nv.Local&&(this.type=nv.International,this.btnNhacViet.deactive(),this.btnQuocTe.active(),this.event.change_menu.dispatch(nv.International))}}])&&vv(n.prototype,i),o&&vv(n,o),t}();function Ev(e){return(Ev="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kv(e){return(kv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pv(e,t){return(Pv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ov(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Rv=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=kv(t).call(this,game,null))||"object"!==Ev(i)&&"function"!=typeof i?Ov(n):i).event={choose_sort:new Phaser.Signal},e.positionShop=e.mainData.positionShop,e.bgGenres=new pt(e.positionShop.sort_play_list_bg_search_menu),e.bgGenres.height=165*z.instance().scale,e.bgGenres.width=166*z.instance().scale,e.addChild(e.bgGenres),e.arrSort=["A-Z","Mới Nhất","Phổ Biến"];for(var o=10,a=0;a<e.arrSort.length;a++){var s=new ln(e.positionShop.bg_tab_menu_select_item,e.arrSort[a],e.chooseItem,Ov(Ov(e)));s.name=a,s.y=o,s.x=10,o+=45,e.addChild(s)}return e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pv(e,t)}(t,Mt),n=t,(i=[{key:"chooseItem",value:function(e){LogConsole.log("chooseItem : "+e.name),this.event.choose_sort.dispatch(e.name,this.arrSort[parseInt(e.name)])}}])&&Cv(n.prototype,i),o&&Cv(n,o),t}();function xv(e){return(xv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Iv(e,t){return!t||"object"!==xv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Av(e,t,n){return(Av="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lv(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Lv(e){return(Lv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gv(e,t){return(Gv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Dv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Iv(this,Lv(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gv(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){qe.instance().showLoading(),this.event={back:new Phaser.Signal,close:new Phaser.Signal,show_all:new Phaser.Signal,search:new Phaser.Signal},this.ktShowSort=!1,this.positionShop=this.mainData.positionShop,this.dataPlayList={genres:[],playlists:[]},this.idxItem=0,this.countItem=0,this.idDelay=null,this.ktBuildItem=!1,this.detail=null,this.popupBuy=null,this.popupMoney=null,this.chooseSort=null,this.type=qm.SORT_POP,this.local=nv.Local,this.genres=-1,this.itemGenresActive=null,this.strSearch="",this.dataList=[],this.ktSearch=!1,this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.addChild(this.bg);var e={column:3,width:game.width,height:game.height-460*z.instance().scale,rowHeight:326*z.instance().scale,leftDistance:35*z.instance().scale,direction:"y",distanceBetweenColumns:35*z.instance().scale,distanceBetweenRows:35*z.instance().scale};this.scroll=new Sy(e),this.scroll.event.changeIndex.add(this.changeIndex,this),this.scroll.y=335*z.instance().scale,this.addChild(this.scroll),this.parentGenres=new Phaser.Group(game,0,0,null),this.listGenres=new Jo(game,this.parentGenres,new Phaser.Rectangle(0,0,game.width-70,95*z.instance().scale),{direction:"x",padding:18*z.instance().scale,bouncing:!0,searchForClicks:!0}),this.parentGenres.x=35,this.parentGenres.y=189*z.instance().scale,this.addChild(this.parentGenres),this.header=new ev,this.header.addEventSearch(this.searchData,this),this.header.addEventBack(this.chooseBackHeader,this),this.addChild(this.header),this.menu=new _v,this.menu.event.change_menu.add(this.changeMenu,this),this.menu.event.choose_sort.add(this.chooseSortPlaylist,this),this.menu.y=100,this.addChild(this.menu),this.txtSearch=new St(this.positionShop.sort_play_list_text_current_search,"Tất cả"),this.txtSearch.setTextBounds(0,0,game.width-71*z.instance().scale,59*z.instance().scale),this.addChild(this.txtSearch),this.btnCloseTextSearch=new pt(this.positionShop.sort_play_list_btn_close_search,this.chooseCloseTextSearch,this),this.addChild(this.btnCloseTextSearch),this.btnCloseTextSearch.visible=!1}},{key:"addEvent",value:function(){LogConsole.log("addEvent"),mZ.instance().events.onExtensionResponse.add(this.getData,this),Kr.instance().event.buy_playlist.add(this.resetShop,this),Kr.instance().event.load_playlist_complete.add(this.buildDataShop,this),!0===Kr.instance().ktLoadPlaylist?this.buildDataShop():Kr.instance().sendGetDataShop()}},{key:"buildDataShop",value:function(){this.buildListGenres(),this.buildDataList(),!0===this.ktSearch&&(this.ktSearch=!1,this.addKeyBoard()),qe.instance().hideLoading()}},{key:"removeEvent",value:function(){Kr.instance().event.buy_playlist.remove(this.resetShop,this),this.scroll.event.changeIndex.remove(this.changeIndex,this),mZ.instance().events.onExtensionResponse.remove(this.getData,this),Kr.instance().event.load_playlist_complete.remove(this.buildDataShop,this)}},{key:"getData",value:function(e){switch(e.cmd){case Js.SHOP_PLAYLIST_LOAD_RESPONSE:case Js.SHOP_BUY_PLAYLIST_RESPONSE:}}},{key:"resetShop",value:function(){this.buildDataList()}},{key:"addKeyBoard",value:function(){this.header.addKeyBoard()}},{key:"chooseBackHeader",value:function(){LogConsole.log("chooseBackHeader"),this.event.close.dispatch()}},{key:"chooseCloseTextSearch",value:function(){this.btnCloseTextSearch.visible=!1,this.txtSearch.text="Tất cả",this.strSearch="",this.buildDataList()}},{key:"changeMenu",value:function(e){this.local=e,this.buildListGenres(),this.buildDataList()}},{key:"setData",value:function(e,t,n,i){this.local=e,this.genres=t,this.type=n,this.ktSearch=i,""!=this.type&&this.menu.setMenu(this.type)}},{key:"changeData",value:function(e){this.dataPlayList=e,this.buildDataList()}},{key:"chooseItem",value:function(e){-1===this.genres?(this.itemGenresActive.deactive(),this.itemGenresActive=e,this.itemGenresActive.active(),this.genres=e.getData().id):this.genres===e.getData().id?(e.deactive(),this.genres=-1,this.itemGenresActive=null):(this.itemGenresActive.deactive(),e.active(),this.genres=e.getData().id,this.itemGenresActive=e),this.listGenres.tweenToItem(e.idx,.5),this.buildDataList()}},{key:"searchData",value:function(e){if(LogConsole.log("searchData : "+e),this.strSearch=e,this.txtSearch.text=this.strSearch,""!=this.strSearch){this.btnCloseTextSearch.visible=!0,this.dataList=[];for(var t=Kr.instance().playlist.getArrShop(),n=0;n<t.length;n++)-1!==this.xoa_dau(t[n].name).toUpperCase().indexOf(this.xoa_dau(e).toUpperCase())&&this.dataList.push(t[n])}else this.btnCloseTextSearch.visible=!1,this.txtSearch.text="Tất cả";this.buildDataList()}},{key:"buildDataList",value:function(){if(""===this.strSearch){var e=Kr.instance().playlist.getArrShop();this.type===qm.SORT_AZ?(this.dataList=e.sort(this.sortAZ),this.menu.setTextSort("A-Z")):this.type===qm.SORT_NEW?(this.dataList=e.sort(this.sortNewPlayList),this.menu.setTextSort("Mới Nhất")):(this.type,qm.SORT_POP,this.dataList=e.sort(this.sortPhoBien),this.menu.setTextSort("Phổ Biến"))}else this.type===qm.SORT_AZ?(this.dataList.sort(this.sortAZ),this.menu.setTextSort("A-Z")):this.type===qm.SORT_NEW?(this.dataList.sort(this.sortNewPlayList),this.menu.setTextSort("Mới Nhất")):(this.type,qm.SORT_POP,this.dataList.sort(this.sortPhoBien),this.menu.setTextSort("Phổ Biến"));this.idxItem=0,this.countItem=0,this.scroll.viewList=[],this.removeDelayBuild(),this.idDelay=game.time.events.add(.1*Phaser.Timer.SECOND,this.addItemPageShop,this)}},{key:"changeIndex",value:function(e){console.log("this.countItem : "+this.countItem),console.log("idx : "+e),this.countItem===e+1&&!1===this.ktBuildItem&&this.addItemPageShop()}},{key:"addItemPageShop",value:function(){var e=[],t=0;this.ktBuildItem=!0;for(var n=this.idxItem;n<this.dataList.length;n++){if(this.idxItem++,(-1===this.genres||this.dataList[n].genre_id===this.genres)&&this.local===this.dataList[n].region&&1!==this.dataList[n].is_owner){t++;var i=new Oy;i.event.CHOOSE.add(this.chooseItemShop,this),i.event.BUY.add(this.buyItemShop,this),i.setData(this.dataList[n],t),e.push(i)}if(e.length===this.scroll.columnNumber||this.idxItem===this.dataList.length){if(this.countItem++,this.scroll.addItem(e),this.countItem%3==0){this.ktBuildItem=!1;break}this.idxItem===this.dataList.length&&(this.ktBuildItem=!1),e=[]}}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"buildListGenres",value:function(){LogConsole.log(this.listGenres),this.listGenres.reset(),this.listGenres.removeAll();var e=-1,t=0;this.genres=-1;var n=Kr.instance().genres.getDataGenresByLocal(this.local),i=new Fs;i.genre="Tất cả",i.id=-1;var o=new hv(this.chooseItem,this);o.active(),o.y=20,o.setData(i,t),this.itemGenresActive=o,this.listGenres.add(o);for(var a=0;a<n.length;a++){t++;var s=new hv(this.chooseItem,this);n[a].id===this.genres?(this.itemGenresActive=s,s.active(),e=t):s.deactive(),s.y=20*this.mainData.scale,s.setData(n[a],t),this.listGenres.add(s)}e>-1&&this.listGenres.tweenToItem(e,.5)}},{key:"chooseItemShop",value:function(e){rl.instance().hide(),iC.instance().addPlaylistDetail(e.id)}},{key:"buyItemShop",value:function(e){iC.instance().buyItem(e)}},{key:"chooseSortPlaylist",value:function(){this.ktShowSort=!this.ktShowSort,!0===this.ktShowSort?this.addChooseSortPlaylist():this.removeChooseSortPlayList()}},{key:"addChooseSortPlaylist",value:function(){this.removeChooseSortPlayList(),this.ktShowSort=!0,this.chooseSort=new Rv,this.chooseSort.event.choose_sort.add(this.changeSortPlayList,this),this.chooseSort.x=455*this.mainData.scale,this.chooseSort.y=165*this.mainData.scale,this.addChild(this.chooseSort)}},{key:"changeSortPlayList",value:function(e,t){this.removeChooseSortPlayList(),this.type=0===e?qm.SORT_AZ:1===e?qm.SORT_NEW:qm.SORT_POP,this.menu.setTextSort(t),this.buildDataList()}},{key:"removeChooseSortPlayList",value:function(){null!==this.chooseSort&&(this.ktShowSort=!1,this.removeChild(this.chooseSort),this.chooseSort.destroy(),this.chooseSort=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),this.bg.destroy(),this.header.destroy(),this.menu.destroy(),this.txtSearch.destroy(),this.btnCloseTextSearch.destroy(),this.listGenres.removeAll(),this.listGenres.destroy(),this.scroll.destroy(),this.removeAllItem(),this.parentGenres.destroy(),iC.instance().removePlaylistDetail(),iC.instance().removePopupBuy(),iC.instance().removePopupMoney(),Av(Lv(t.prototype),"destroy",this).call(this)}}])&&Tv(n.prototype,i),o&&Tv(n,o),t}();function Mv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Nv=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putUtfString("payment_service",e),t.putBool("new_ticket",!0),t}},{key:"GOOGLE_PLAY",get:function(){return"GOOGLE_PLAY"}},{key:"APPLE",get:function(){return"APPLE"}},{key:"AMAZON_IAP",get:function(){return"AMAZON_IAP"}},{key:"GAME",get:function(){return"GAME"}},{key:"FACEBOOK",get:function(){return"FACEBOOK"}}],(n=null)&&Mv(t.prototype,n),i&&Mv(t,i),e}();function Bv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jv=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ktIPA=!1,this.ktCall=!1,this.event={buy_complete:new Phaser.Signal,buy_error:new Phaser.Signal},mZ.instance().events.onExtensionResponse.add(this.getData,this),window.Cocoon&&Cocoon.InApp&&(this.ktIPA=!0,this.service=Cocoon.InApp,this.service.on("purchase",{start:function(e){console.log("purchase started "+e)},error:function(e,n){console.log("purchase failed "+e+" error: "+JSON.stringify(n)),t.event.buy_error.dispatch(n.message)},complete:function(e){console.log("purchase completed "+JSON.stringify(e))}}),this.service.initialize({autofinish:!0},function(e){console.log(e)}),this.service.setValidationHandler(this.setupCompletePurchase.bind(this)))}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.ipa||(this.ipa=new e),this.ipa}}],(n=[{key:"setupCompletePurchase",value:function(e,t,n){console.log("setValidationHandler"),console.log(t),this.callToServerIos(this.data.getInt("id"),this.data.getInt("quantity"),this.data.getUtfString("resource_type"),this.data.getInt("price"),e)}},{key:"callToServerIos",value:function(e,t,n,i,o){var a=this;qe.instance().showLoading(),console.log("receiptBase64Data: "+o),console.log("callToServerIos");var s={userId:mZ.instance().dataMySeft.user_id,resourcePackageId:e,resourceQuantity:t,resourceType:n,resourcePrice:i,receiptBase64Data:o};console.log("url : "+window.RESOURCE.in_app_apple_validator),console.log("postData"),console.log(s),$.ajax({url:window.RESOURCE.in_app_apple_validator,type:"POST",data:s,dataType:"json",success:function(e){LogConsole.log("callToServerAndroid"),LogConsole.log(e),a.event.buy_complete.dispatch(e)},error:function(e,t,n){console.error("Error get server infomation"),console.error(n),console.error(e.status),console.error(e.responseJSON),a.event.buy_error.dispatch("Thanh toán lỗi")}})}},{key:"buyItem",value:function(e){var t=this;if(this.ktIPA){this.data=e,this.ktCall=!1;var n=e.getUtfString("pack_name");this.service.purchase(n,1,function(e){console.log("error"),console.log(e),t.event.buy_error.dispatch(e.message)}),this.service.isPurchased(n)}}},{key:"getDataInapp",value:function(){if(null===z.instance().dataPackage){this.ktLoad=!0;var e="";e=!0===this.ktIPA?"android"===device.platform.toLowerCase()?Nv.GOOGLE_PLAY:"ios"===device.platform.toLowerCase()?Nv.APPLE:"amazon-fireos"===device.platform.toLowerCase()?Nv.AMAZON_IAP:Nv.GAME:Nv.GAME,mZ.instance().sendData(Js.RESOURCE_PACKAGE_LOAD_REQUEST,Nv.begin(e))}}},{key:"getData",value:function(e){switch(e.cmd){case Js.RESOURCE_PACKAGE_LOAD_RESPONSE:!0===this.ktLoad&&(this.ktLoad=!1,"OK"===e.params.getUtfString("status")&&(z.instance().dataPackage=e.params))}}}])&&Bv(t.prototype,n),i&&Bv(t,i),e}();function Uv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Fv=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ktIPA=!1,mZ.instance().events.onExtensionResponse.add(this.getData,this),"undefined"!=typeof store&&(this.ktIPA=!0),!0===this.ktIPA&&(store.verbosity=store.INFO,store.autoFinishTransactions=!0,store.ready(function(){console.log("\\o/ STORE READY \\o/")}),store.refresh()),this.ktLoad=!1,this.event={buy_complete:new Phaser.Signal,buy_error:new Phaser.Signal},this.ktCall=!1}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.ipa||(this.ipa=new e),this.ipa}}],(n=[{key:"getDataInapp",value:function(){if(null===z.instance().dataPackage){this.ktLoad=!0;var e="";e=!0===this.ktIPA?"android"===device.platform.toLowerCase()?Nv.GOOGLE_PLAY:"ios"===device.platform.toLowerCase()?Nv.APPLE:"amazon-fireos"===device.platform.toLowerCase()?Nv.AMAZON_IAP:Nv.GAME:""===z.instance().tokenYanAccount?Nv.FACEBOOK:Nv.GAME,mZ.instance().sendData(Js.RESOURCE_PACKAGE_LOAD_REQUEST,Nv.begin(e))}}},{key:"getData",value:function(e){switch(e.cmd){case Js.RESOURCE_PACKAGE_LOAD_RESPONSE:if(!0===this.ktLoad&&(this.ktLoad=!1,"OK"===e.params.getUtfString("status")&&(z.instance().dataPackage=e.params,LogConsole.log(e.params),!0===this.ktIPA))){for(var t=0;t<z.instance().dataPackage.getSFSArray("resource_packages").size();t++){var n=z.instance().dataPackage.getSFSArray("resource_packages").getSFSObject(t);""!==n.getUtfString("pack_name")&&store.register({id:n.getUtfString("pack_name"),alias:n.getUtfString("pack_name"),type:store.CONSUMABLE})}store.refresh()}}}},{key:"buyItem",value:function(e){var t=this;if(!0===this.ktIPA){this.ktCall=!1;var n=e.getUtfString("pack_name");console.log("pack_name : "+n),store.order(n).then(function(){console.log("success")}).error(function(e){console.log("error.."+e.code),t.event.buy_error.dispatch(e.code)}),store.when(n).approved(function(e){console.log("approved"),console.log(e),"android"==device.platform||"Android"==device.platform?(console.log("1111111111111"),e.finish()):(console.log("2222222222222"),e.verify())}),store.validator=function(e){console.log("validator"),console.log(e)},store.when(n).verified(function(n){n.hasOwnProperty("transaction")&&n.transaction.hasOwnProperty("appStoreReceipt")&&!1===t.ktCall&&(t.ktCall=!0,t.callToServerIos(e.getInt("id"),e.getInt("quantity"),e.getUtfString("resource_type"),e.getInt("price"),n.transaction.appStoreReceipt),n.finish())}),store.error(function(e){console.log("ERROR "+e.code+": "+e.message),t.event.buy_error.dispatch(e.message)}),store.when(n).cancelled(function(e){console.log("cancelled"),console.log(e),t.event.buy_error.dispatch("")}),store.when(n).error(function(e){console.log("error"),console.log(e),t.event.buy_error.dispatch("")}),store.when(n).updated(function(e){console.log("updated"),console.log(e),e.loaded&&e.valid&&e.state===store.APPROVED&&null!=e.transaction&&e.finish()}),store.when(n).finished(function(i){var o;console.log("finished----------------------------"),console.log(n+" finished "+i.state+", title is "+i.title+" "+JSON.stringify(i)),console.log(i),"android"==device.platform||"Android"==device.platform?!1===t.ktCall&&(t.ktCall=!0,i.transaction.purchaseToken,o=JSON.parse(i.transaction.receipt),t.callToServerAndroid(o.orderId,o.packageName,o.productId,o.purchaseToken,o.purchaseTime,e.getInt("id"),e.getInt("quantity"),e.getUtfString("resource_type"),e.getInt("price"))):i.transaction.id})}else this.event.buy_error.dispatch("Chưa có thanh toán qua web")}},{key:"callToServerFacebook",value:function(e){console.log("callToServerFacebook : "+e),FB.ui({method:"pay",action:"purchaseitem",product:e},this.buyFacebookItemComplete.bind(this))}},{key:"buyFacebookItemComplete",value:function(e){var t=this;if(console.log("result -----------------"),console.log(e),void 0===e)this.event.buy_error.dispatch("Thanh toán lỗi");else if(e.hasOwnProperty("status")&&"completed"===e.status){var n={signed_request:e.signed_request};console.log("url : "+window.RESOURCE.in_app_facebook_validator),console.log("postData"),console.log(n),$.ajax({url:window.RESOURCE.in_app_facebook_validator,type:"POST",data:n,dataType:"json",success:function(e){LogConsole.log("callToServerFacebook"),LogConsole.log(e),e.hasOwnProperty("error_message")?t.event.buy_error.dispatch(e.error_message):t.event.buy_complete.dispatch(e)},error:function(e,n,i){console.error("Error get server infomation"),console.error(i),console.error(e.status),console.error(e.responseJSON),e.hasOwnProperty("error_message")?t.event.buy_error.dispatch(e.error_message):t.event.buy_error.dispatch("Thanh toán lỗi")}})}else this.event.buy_error.dispatch("Thanh toán lỗi")}},{key:"callToServerIos",value:function(e,t,n,i,o){var a=this;console.log("callToServerIos");var s={userId:mZ.instance().dataMySeft.user_id,resourcePackageId:e,resourceQuantity:t,resourceType:n,resourcePrice:i,receiptBase64Data:o};console.log("url : "+window.RESOURCE.in_app_apple_validator),console.log("postData"),console.log(s),$.ajax({url:window.RESOURCE.in_app_apple_validator,type:"POST",data:s,dataType:"json",success:function(e){LogConsole.log("callToServerAndroid"),LogConsole.log(e),a.event.buy_complete.dispatch(e)},error:function(e,t,n){console.error("Error get server infomation"),console.error(n),console.error(e.status),console.error(e.responseJSON),a.event.buy_error.dispatch("Thanh toán lỗi")}})}},{key:"callToServerAndroid",value:function(e,t,n,i,o,a,s,r,l){var h=this;console.log("callToServerAndroid");var c={userId:mZ.instance().dataMySeft.user_id,orderId:e,packageName:t,productId:n,purchaseToken:i,purchaseTime:o,resourcePackageId:a,resourceQuantity:s,resourceType:r,resourcePrice:l};console.log("postData"),console.log(c),$.ajax({url:window.RESOURCE.in_app_google_validator,type:"POST",data:c,dataType:"json",success:function(e){LogConsole.log("callToServerAndroid"),LogConsole.log(e),h.event.buy_complete.dispatch(e)},error:function(e,t,n){console.error("Error get server infomation"),console.error(n),console.error(e.status),console.error(e.responseJSON),h.event.buy_error.dispatch("Thanh toán lỗi")}})}}])&&Uv(t.prototype,n),i&&Uv(t,i),e}();function Zv(e){return(Zv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qv(e){return(Qv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vv(e,t){return(Vv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Wv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var qv=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=Qv(t).call(this,game,null))||"object"!==Zv(o)&&"function"!=typeof o?Wv(i):o).data=e,n.bg=n.create(0,0,"shop","bg_item_vip"),n.title=game.add.text(285,55,"QUYỀN LỢI",{fill:"#ffa140",fontSize:23,font:"GilroyBold"},Wv(Wv(n))),n.addChild(n.title),n.description=game.add.text(285,90,"Thay đổi avatar, Vip Daily reward, Vip Playlist, Vip Chat Quick",{fill:"#ffffff",fontSize:17,font:"Gilroy",wordWrap:!0,wordWrapWidth:225,maxLines:3},Wv(Wv(n))),n.addChild(n.description),n.btnPrice=new ln({x:285,y:175,nameAtlas:"shop",nameSprite:"bg_price_vip",configText:{x:0,y:0,style:{fontSize:20,font:"GilroyBold"},paddingTop:7}},Un.instance().format(n.data.getInt("price"))+" đ",n.clickBuy,Wv(Wv(n))),n.addChild(n.btnPrice),n.btnDetail=new ln({x:420,y:175,nameAtlas:"shop",nameSprite:"bg_chitiet_vip",configText:{x:0,y:0,style:{fontSize:20,font:"GilroyBold"},paddingTop:7}},"Chi tiết",n.clickDetail,Wv(Wv(n))),n.addChild(n.btnDetail),n.titleName=game.add.text(139,200,n.data.getUtfString("name"),{fill:"#ffffff",fontSize:15,font:"GilroyBold"},Wv(Wv(n))),n.titleName.anchor.set(.5),n.addChild(n.titleName),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vv(e,t)}(t,Mt),n=t,(i=[{key:"clickBuy",value:function(){if(console.log("clickBuy"),window.cordova&&"undefined"!=typeof device)qe.instance().showLoading(),"ios"===z.instance().platform?jv.instance().buyItem(this.data):Fv.instance().buyItem(this.data);else if(console.log("this.data.payment_service  : "+this.data.getUtfString("payment_service")),"FACEBOOK"===this.data.getUtfString("payment_service"))if(window.RESOURCE.fb_products.hasOwnProperty(this.data.getUtfString("pack_name"))){var e=window.RESOURCE.fb_products[this.data.getUtfString("pack_name")];Fv.instance().callToServerFacebook(e)}else iC.instance().addDialog("Sản phẩm không tồn tại")}},{key:"clickDetail",value:function(){console.log("clickDetail")}}])&&Hv(n.prototype,i),o&&Hv(n,o),t}();function Kv(e){return(Kv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yv(e,t,n){return(Yv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Jv(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Jv(e){return(Jv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xv(e,t){return(Xv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ew=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Jv(t).call(this,game,null))||"object"!==Kv(i)&&"function"!=typeof i?$v(n):i).event={back:new Phaser.Signal},e.positionShop=e.mainData.positionShop,e.bg=new rt(e.positionShop.sort_play_list_bg_top_menu),e.addChild(e.bg),e.scoreDiamond=0,e.scoreTicket=0,e.scoreHeart=0,e.btnBack=new pt(e.positionShop.sort_play_list_bg_back_top_menu,e.chooseBack,$v($v(e))),e.addChild(e.btnBack),e.scoreDiamond=mZ.instance().dataMySeft.diamond,e.btnDiamond=new ln(e.positionShop.tn_header_item_gem,e.scoreDiamond),e.addChild(e.btnDiamond),e.scoreTicket=mZ.instance().dataMySeft.ticket,e.btnTicket=new ln(e.positionShop.tn_header_item_ticket,e.scoreTicket),e.addChild(e.btnTicket),e.scoreHeart=mZ.instance().dataMySeft.heart,e.btnHeart=new ln(e.positionShop.tn_header_item_heart,e.scoreHeart),e.addChild(e.btnHeart),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xv(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),mZ.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),mZ.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this)}},{key:"onUserVarsUpdate",value:function(e){var t,n=this,i={score:0};this.scoreDiamond<mZ.instance().dataMySeft.diamond?(game.tweens.removeFrom(this.btnDiamond),i.score=this.scoreDiamond,this.scoreDiamond=mZ.instance().dataMySeft.diamond,console.log("scoreDiamond : "+this.scoreDiamond),(t=game.add.tween(i).to({score:mZ.instance().dataMySeft.diamond},500,"Linear",!0,1500)).start(),t.onUpdateCallback(function(){n.btnDiamond&&n.btnDiamond.setText(parseInt(i.score))},this),t.onComplete.add(function(){n.btnDiamond&&n.btnDiamond.setText(parseInt(n.scoreDiamond))},this)):this.btnDiamond.setText(mZ.instance().dataMySeft.diamond),this.scoreHeart<mZ.instance().dataMySeft.heart&&(game.tweens.removeFrom(this.btnHeart),i.score=this.scoreHeart,this.scoreHeart=mZ.instance().dataMySeft.heart,console.log("scoreHeart : "+this.scoreHeart),(t=game.add.tween(i).to({score:mZ.instance().dataMySeft.heart},500,"Linear",!0,1500)).start(),t.onUpdateCallback(function(){n.btnHeart&&n.btnHeart.setText(parseInt(i.score))},this),t.onComplete.add(function(){n.btnHeart&&n.btnHeart.setText(parseInt(n.scoreHeart))},this)),this.scoreTicket<mZ.instance().dataMySeft.ticket&&(game.tweens.removeFrom(this.btnTicket),i.score=this.scoreTicket,this.scoreTicket=mZ.instance().dataMySeft.ticket,console.log("scoreTicket : "+this.scoreTicket),(t=game.add.tween(i).to({score:mZ.instance().dataMySeft.ticket},500,"Linear",!0,1500)).start(),t.onUpdateCallback(function(){n.btnTicket&&n.btnTicket.setText(parseInt(i.score))},this),t.onComplete.add(function(){n.btnTicket&&n.btnTicket.setText(parseInt(n.scoreTicket))},this))}},{key:"removeTween",value:function(){game.tweens.removeFrom(this.btnDiamond),game.tweens.removeFrom(this.btnTicket),game.tweens.removeFrom(this.btnHeart)}},{key:"destroy",value:function(){console.log("destroy header"),this.removeTween(),Yv(Jv(t.prototype),"destroy",this).call(this)}}])&&zv(n.prototype,i),o&&zv(n,o),t}();function tw(e){return(tw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iw(e,t,n){return(iw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ow(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ow(e){return(ow=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aw(e,t){return(aw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var rw=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,e=!(i=ow(t).call(this,game,null))||"object"!==tw(i)&&"function"!=typeof i?sw(n):i,Le.instance().logEvent(Le.Shop_Vip);var o=new Phaser.Group(game,0,0,null);return e.listVip=new Jo(game,o,new Phaser.Rectangle(0,0,game.width,game.height-270),{direction:"y",padding:38,searchForClicks:!0}),o.x=0,o.y=135,e.addChild(o),e.header=new ew,e.header.event.back.add(e.chooseBackMenu,sw(sw(e))),e.addChild(e.header),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aw(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),"ios"===z.instance().platform?(jv.instance().event.buy_complete.add(this.buyItemComplete,this),jv.instance().event.buy_error.add(this.buyItemError,this)):(Fv.instance().event.buy_complete.add(this.buyItemComplete,this),Fv.instance().event.buy_error.add(this.buyItemError,this)),null===this.mainData.dataPackage?"ios"===z.instance().platform?jv.instance().getDataInapp():Fv.instance().getDataInapp():(this.dataServer=this.mainData.dataPackage,this.buildData(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),"ios"===z.instance().platform?(jv.instance().event.buy_complete.remove(this.buyItemComplete,this),jv.instance().event.buy_error.remove(this.buyItemError,this)):(Fv.instance().event.buy_complete.remove(this.buyItemComplete,this),Fv.instance().event.buy_error.remove(this.buyItemError,this))}},{key:"buyItemComplete",value:function(e){if(console.log("buyItemComplete------ "),console.log(e),qe.instance().hideLoading(),"OK"===e.status){var t=[];t.push(new SFS2X.SFSUserVariable("vip_expired",e.vip_expired)),mZ.instance().socket.send(new SFS2X.SetUserVariablesRequest(t))}}},{key:"buyItemError",value:function(e){qe.instance().hideLoading(),""!==e&&iC.instance().addDialog(e)}},{key:"getData",value:function(e){switch(e.cmd){case Js.RESOURCE_PACKAGE_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&(this.mainData.dataPackage=e.params,this.dataServer=this.mainData.dataPackage,this.buildData()),qe.instance().hideLoading()}}},{key:"buildData",value:function(){console.log("buildData------"),this.listVip.removeAll(),this.listVip.reset();for(var e=0;e<this.dataServer.getSFSArray("resource_packages").size();e++){var t=this.dataServer.getSFSArray("resource_packages").getSFSObject(e);if(console.log(t),"VIP"===t.getUtfString("resource_type")){var n=new qv(t);n.x=(game.width-n.width)/2,this.listVip.add(n)}}}},{key:"chooseBackMenu",value:function(){}},{key:"destroy",value:function(){this.removeEvent(),iw(ow(t.prototype),"destroy",this).call(this)}}])&&nw(n.prototype,i),o&&nw(n,o),t}();function lw(e){return(lw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hw(e,t){return!t||"object"!==lw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cw(e){return(cw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dw(e,t,n){return t&&uw(e.prototype,t),n&&uw(e,n),e}function fw(e,t){return(fw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pw=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=hw(this,cw(t).call(this,game,0,0,null,n,i))).positionShop=z.instance().positionShop,o.bg=new rt(o.positionShop.sort_play_list_icon_active_search_menu),o.bg.height=89,o.bg.y=0,o.bg.alpha=0,o.addChild(o.bg),e===t.GEM?(o.icon=new rt(o.positionShop.tn_tab_icon_gem),o.iconActive=new rt(o.positionShop.tn_tab_icon_gem_active)):e===t.TICKET?(o.icon=new rt(o.positionShop.tn_tab_icon_ticket),o.iconActive=new rt(o.positionShop.tn_tab_icon_ticket_active)):e===t.HEART&&(o.icon=new rt(o.positionShop.tn_tab_icon_heart),o.iconActive=new rt(o.positionShop.tn_tab_icon_heart_active)),o.icon.x=(o.width-o.icon.width)/2,o.icon.y=(o.height-o.icon.height)/2,o.iconActive.x=(o.width-o.iconActive.width)/2,o.iconActive.y=(o.height-o.iconActive.height)/2,o.addChild(o.icon),o.addChild(o.iconActive),o.lineActive=new rt(o.positionShop.sort_play_list_icon_active_search_menu),o.lineActive.y=83,o.addChild(o.lineActive),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fw(e,t)}(t,Phaser.Button),dw(t,null,[{key:"GEM",get:function(){return"DIAMOND"}},{key:"TICKET",get:function(){return"TICKET"}},{key:"HEART",get:function(){return"HEART"}}]),dw(t,[{key:"active",value:function(){this.icon.visible=!1,this.iconActive.visible=!0,this.lineActive.visible=!0}},{key:"deactive",value:function(){this.icon.visible=!0,this.iconActive.visible=!1,this.lineActive.visible=!1}},{key:"width",get:function(){return 213*z.instance().scale}},{key:"height",get:function(){return 89*z.instance().scale}}]),t}();function gw(e){return(gw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mw(e){return(mw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vw(e,t){return(vw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ww(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var bw=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=mw(t).call(this,game,null))||"object"!==gw(o)&&"function"!=typeof o?ww(i):o).event={change_menu:new Phaser.Signal},n.positionShop=n.mainData.positionShop,n.bg=new rt(n.positionShop.playlist_bg_menu),n.addChild(n.bg),n.typeTab=e,n.tabGem=new pw(pw.GEM,n.chooseTabGem,ww(ww(n))),n.typeTab===pw.GEM?n.tabGem.active():n.tabGem.deactive(),n.addChild(n.tabGem),n.tabTicket=new pw(pw.TICKET,n.chooseTabTicket,ww(ww(n))),n.tabTicket.x=213*n.mainData.scale,n.typeTab===pw.TICKET?n.tabTicket.active():n.tabTicket.deactive(),n.addChild(n.tabTicket),n.tabHeart=new pw(pw.HEART,n.chooseTabHeart,ww(ww(n))),n.tabHeart.x=426*n.mainData.scale,n.typeTab===pw.HEART?n.tabHeart.active():n.tabHeart.deactive(),n.addChild(n.tabHeart),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vw(e,t)}(t,Mt),n=t,(i=[{key:"chooseTabGem",value:function(){this.typeTab===pw.GEM||(this.tabGem.active(),this.tabTicket.deactive(),this.tabHeart.deactive(),this.typeTab=pw.GEM,this.event.change_menu.dispatch(this.typeTab))}},{key:"chooseTabTicket",value:function(){this.typeTab===pw.TICKET||(this.tabGem.deactive(),this.tabTicket.active(),this.tabHeart.deactive(),this.typeTab=pw.TICKET,this.event.change_menu.dispatch(this.typeTab))}},{key:"chooseTabHeart",value:function(){this.typeTab===pw.HEART||(this.tabGem.deactive(),this.tabTicket.deactive(),this.tabHeart.active(),this.typeTab=pw.HEART,this.event.change_menu.dispatch(this.typeTab))}}])&&yw(n.prototype,i),o&&yw(n,o),t}();function Sw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _w=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t,n){var i=new SFS2X.SFSObject;return i.putInt("resource_pakage_id",e),i.putInt("quantity",t),i.putUtfString("resource_type",n),i}}],(n=null)&&Sw(t.prototype,n),i&&Sw(t,i),e}();function Ew(e){return(Ew="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kw(e,t,n){return(kw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pw(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pw(e){return(Pw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ow(e,t){return(Ow=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var xw=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=Pw(t).call(this,game,null))||"object"!==Ew(s)&&"function"!=typeof s?Rw(a):s).positionShop=z.instance().positionShop,o.data=e,o.iconStr=n,o.isSup=i,o.timeWait=0,o.timerToCountTime=null,o.totalVideo=null,o.bg=new rt(o.positionShop.tn_item_bg),o.addChild(o.bg),o.btnNamePackage=new ln(o.positionShop.tn_item_package_name,e.getUtfString("name")),o.addChild(o.btnNamePackage),o.txtPrice=new St(o.positionShop.tn_item_price,Un.instance().format(e.getInt("quantity"))),o.txtPrice.setTextBounds(0,0,200*z.instance().scale,52*z.instance().scale),o.addChild(o.txtPrice),o.icon=new Phaser.Sprite(game,0,0,n),o.icon.smoothed=!0,o.icon.animations.pause=!0,o.icon.animations.add("shop"+n),o.icon.x=(o.bg.width-o.icon.width)/2,o.icon.y=90*z.instance().scale+(60*z.instance().scale-o.icon.height)/2,o.icon.animations.play("shop"+n,30,!0),o.addChild(o.icon),i?"ADS"===e.getUtfString("price_type")?o.checkShowTotalVideo():(o.buyItem=new ln(o.positionShop.tn_item_total_support,Un.instance().format(e.getInt("price")),o.buyDiamond,Rw(Rw(o))),o.addChild(o.buyItem)):"ADS"===e.getUtfString("price_type")?o.checkShowTotalVideo():(o.totalMoney=new ln(o.positionShop.tn_item_total_money,Un.instance().format(e.getInt("price"))+"đ",o.chooseBuy,Rw(Rw(o))),o.addChild(o.totalMoney)),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ow(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this),li.instance().event.rewardedVideoClosed.add(this.rewardedVideoClosed,this),"ios"===z.instance().platform?(jv.instance().event.buy_complete.add(this.removeLoading,this),jv.instance().event.buy_error.add(this.removeLoading,this)):(Fv.instance().event.buy_complete.add(this.removeLoading,this),Fv.instance().event.buy_error.add(this.removeLoading,this))}},{key:"removeEvent",value:function(){li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.remove(this.rewardedVideoFailed,this),li.instance().event.rewardedVideoClosed.remove(this.rewardedVideoClosed,this),"ios"===z.instance().platform?(jv.instance().event.buy_complete.remove(this.removeLoading,this),jv.instance().event.buy_error.remove(this.removeLoadingError,this)):(Fv.instance().event.buy_complete.remove(this.removeLoading,this),Fv.instance().event.buy_error.remove(this.removeLoadingError,this))}},{key:"rewardedVideoClosed",value:function(){qe.instance().hideLoading()}},{key:"rewardedVideoFailed",value:function(){qe.instance().hideLoading(),iC.instance().addDialog("No Ads to show")}},{key:"rewardedVideoRewardReceived",value:function(e){qe.instance().hideLoading();var t=e.placement,n=t.name,i=t.amount,o=t.reward;console.log("placementName : "+n),console.log("rewardAmount : "+i),console.log("rewardName : "+o),mZ.instance().sendData(Js.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_REQUEST,_w.begin(this.data.getInt("id"),this.data.getInt("quantity"),this.data.getUtfString("resource_type")))}},{key:"checkShowTotalVideo",value:function(){this.removeTotalVideo(),!0===this.data.getBool("isAllowWatch")?(this.totalVideo=new ln(this.positionShop.tn_item_total_video,"1x",this.chooseBuyVideo,this),this.addEvent()):(this.timeWait=parseInt((this.data.getLong("next_watched_at")-this.getTime())/1e3),this.timeWait>0?(this.totalVideo=new ln(this.positionShop.tn_item_total_video_wait,""),this.stopCountTime(),this.timerToCountTime=this.game.time.create(!0),this.timerToCountTime.loop(1e3,this.onTimerToCountTime,this),this.timerToCountTime.start(),this.setTextTimer()):(this.totalVideo=new ln(this.positionShop.tn_item_total_video,"1x",this.chooseBuyVideo,this),this.addEvent())),this.addChild(this.totalVideo)}},{key:"onTimerToCountTime",value:function(){this.timeWait=this.timeWait-1,this.timeWait<0&&(this.timeWait=0),0===this.timeWait?(this.stopCountTime(),qe.instance().showLoading(),this.mainData.dataPackage=null,"ios"===z.instance().platform?jv.instance().getDataInapp():Fv.instance().getDataInapp()):this.setTextTimer()}},{key:"setTextTimer",value:function(){var e,t="",n=parseInt(this.timeWait/3600),i=0,o=0;n>0?(t=n>9?n+":":"0"+n+":",i=parseInt(this.timeWait%3600/60),o=this.timeWait-(3600*n+60*i)):(i=parseInt(this.timeWait/60),o=this.timeWait%60),e=t+(i>9?i+":":"0"+i+":")+(o>9?o+"":"0"+o),this.totalVideo.setText(e)}},{key:"stopCountTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy(),this.timerToCountTime=null)}},{key:"removeTotalVideo",value:function(){null!==this.totalVideo&&(this.removeChild(this.totalVideo),this.totalVideo.destroy(),this.totalVideo=null)}},{key:"buyDiamond",value:function(){LogConsole.log("buyDiamond"),iC.instance().addPopupConfirmBuyItemShop(this.data,this.iconStr,this.isSup)}},{key:"chooseBuy",value:function(){if(LogConsole.log("chooseBuy"),window.cordova&&"undefined"!=typeof device)qe.instance().showLoading(),"ios"===z.instance().platform?jv.instance().buyItem(this.data):Fv.instance().buyItem(this.data),this.removeIdLoading(),this.idRemoveLoading=game.time.events.add(10*Phaser.Timer.SECOND,this.removeLoading,this);else if(console.log("this.data.payment_service  : "+this.data.getUtfString("payment_service")),"FACEBOOK"===this.data.getUtfString("payment_service"))if(window.RESOURCE.fb_products.hasOwnProperty(this.data.getUtfString("pack_name"))){var e=window.RESOURCE.fb_products[this.data.getUtfString("pack_name")];Fv.instance().callToServerFacebook(e)}else iC.instance().addDialog("Sản phẩm không tồn tại")}},{key:"removeLoadingError",value:function(e){this.removeLoading(),""!==e&&iC.instance().addDialog(e)}},{key:"removeLoading",value:function(){this.removeIdLoading(),qe.instance().hideLoading()}},{key:"removeIdLoading",value:function(){null!==this.idRemoveLoading&&game.time.events.remove(this.idRemoveLoading)}},{key:"chooseBuyVideo",value:function(){LogConsole.log("chooseBuyVideo"),window.cordova&&"undefined"!=typeof device?(qe.instance().showLoading(),li.instance().showRewardVideoInappPurchase(this.data.getUtfString("resource_type"))):iC.instance().addDialog("comming soon")}},{key:"destroy",value:function(){this.removeEvent(),kw(Pw(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return 213*z.instance().scale}},{key:"height",get:function(){return 324*z.instance().scale}}])&&Cw(n.prototype,i),o&&Cw(n,o),t}();function Tw(e){return(Tw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Iw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Aw(e,t,n){return(Aw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lw(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Lw(e){return(Lw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gw(e,t){return(Gw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Dw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Mw=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,e=!(i=Lw(t).call(this,game,null))||"object"!==Tw(i)&&"function"!=typeof i?Dw(n):i,qe.instance().showLoading(),e.event={close:new Phaser.Signal},e.arrResource=[],e.typeMenu=o,e.dataServer=null;var a={column:2,width:game.width,height:game.height-356*z.instance().scale,rowHeight:325*z.instance().scale,leftDistance:80*z.instance().scale,direction:"y",distanceBetweenColumns:55*z.instance().scale,distanceBetweenRows:35*z.instance().scale};return e.scroll=new Sy(a),e.scroll.y=230*z.instance().scale,e.addChild(e.scroll),e.header=new ew,e.header.event.back.add(e.chooseBackMenu,Dw(Dw(e))),e.addChild(e.header),""===e.typeMenu&&(e.typeMenu=pw.GEM),e.tabMenu=new bw(e.typeMenu),e.tabMenu.event.change_menu.add(e.changeMenu,Dw(Dw(e))),e.tabMenu.y=100*e.mainData.scale,e.addChild(e.tabMenu),e.addEvent(),Le.instance().logEvent(Le.Shop_resource),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gw(e,t)}(t,pm),n=t,(i=[{key:"loadFileComplete",value:function(){Aw(Lw(t.prototype),"loadFileComplete",this).call(this),this.buildData()}},{key:"chooseBackMenu",value:function(){this.event.close.dispatch()}},{key:"changeMenu",value:function(e){console.log("this.typeMenu : "+this.typeMenu),this.typeMenu=e,qe.instance().showLoading(),this.typeMenu===pw.GEM?this.arrResource=[{type:"spritesheet",link:"img/atlas/Diamond1.png",key:"Diamond1",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond2.png",key:"Diamond2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond3.png",key:"Diamond3",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond4.png",key:"Diamond4",width:200,height:140,countFrame:30}]:this.typeMenu===pw.TICKET?this.arrResource=[{type:"spritesheet",link:"img/atlas/Ticket1.png",key:"Ticket1",width:200,height:140,countFrame:24},{type:"spritesheet",link:"img/atlas/Ticket2.png",key:"Ticket2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Ticket3.png",key:"Ticket3",width:200,height:140,countFrame:60},{type:"spritesheet",link:"img/atlas/Ticket4.png",key:"Ticket4",width:200,height:140,countFrame:44}]:this.typeMenu===pw.HEART&&(this.arrResource=[{type:"spritesheet",link:"img/atlas/Heart1.png",key:"Heart1",width:200,height:140,countFrame:10},{type:"spritesheet",link:"img/atlas/Heart2.png",key:"Heart2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Heart3.png",key:"Heart3",width:200,height:140,countFrame:13},{type:"spritesheet",link:"img/atlas/Heart4.png",key:"Heart4",width:200,height:140,countFrame:60}]),this.loadResource()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),"ios"===z.instance().platform?(jv.instance().event.buy_complete.add(this.buyItemComplete,this),jv.instance().event.buy_error.add(this.buyItemError,this)):(Fv.instance().event.buy_complete.add(this.buyItemComplete,this),Fv.instance().event.buy_error.add(this.buyItemError,this)),null===this.mainData.dataPackage?"ios"===z.instance().platform?jv.instance().getDataInapp():Fv.instance().getDataInapp():(this.dataServer=this.mainData.dataPackage,this.changeMenu(this.typeMenu),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),"ios"===z.instance().platform?(jv.instance().event.buy_complete.remove(this.buyItemComplete,this),jv.instance().event.buy_error.remove(this.buyItemError,this)):(Fv.instance().event.buy_complete.remove(this.buyItemComplete,this),Fv.instance().event.buy_error.remove(this.buyItemError,this))}},{key:"buyItemCompleteDiamond",value:function(e){if(console.log("buyItemCompleteDiamond ------------"),"OK"===e.getUtfString("status")){var t=500*this.mainData.scale,n=45*this.mainData.scale,i="HEART";"DIAMOND"===e.getUtfString("resource_type")?(i="DIAMOND",t=140*this.mainData.scale,n=45*this.mainData.scale):"TICKET"===e.getUtfString("resource_type")?(i="TICKET",t=316*this.mainData.scale,n=45*this.mainData.scale):"HEART"===e.getUtfString("resource_type")&&(i="HEART",t=500*this.mainData.scale,n=45*this.mainData.scale);var o={type:i,reward:e.getInt("resource_up"),finishPoint:{x:t,y:n}};iC.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,o)}}},{key:"buyItemComplete",value:function(e){if(console.log("buyItemComplete------ "),console.log(e),qe.instance().hideLoading(),"OK"===e.status){var t=500*this.mainData.scale,n=45*this.mainData.scale,i="HEART",o="";"DIAMOND"===e.resourceType?(i="DIAMOND",t=140*this.mainData.scale,n=45*this.mainData.scale,o="diamond"):"TICKET"===e.resourceType?(i="TICKET",t=316*this.mainData.scale,n=45*this.mainData.scale,o="ticket"):"HEART"===e.resourceType&&(i="HEART",t=500*this.mainData.scale,n=45*this.mainData.scale,o="heart");var a={type:i,reward:e.newResource-e.oldResource,finishPoint:{x:t,y:n}};console.log("data.newResource : "+e.newResource);var s=[];s.push(new SFS2X.SFSUserVariable(o,e.newResource)),mZ.instance().socket.send(new SFS2X.SetUserVariablesRequest(s)),iC.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,a)}}},{key:"buyItemError",value:function(e){qe.instance().hideLoading(),""!==e&&iC.instance().addDialog(e)}},{key:"getData",value:function(e){switch(e.cmd){case Js.RESOURCE_PACKAGE_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&(this.mainData.dataPackage=e.params,this.dataServer=this.mainData.dataPackage,this.changeMenu(this.typeMenu)),qe.instance().hideLoading();break;case Js.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE:if("OK"===e.params.getUtfString("status")){var t={newResource:0,oldResource:0,resourceType:"DIAMOND",status:"OK"};t.newResource=e.params.getInt("new_resource"),t.resourceType=e.params.getUtfString("resource_type"),t.oldResource=e.params.getInt("old_resource"),this.buyItemComplete(t),this.mainData.dataPackage=null,"ios"===z.instance().platform?jv.instance().getDataInapp():Fv.instance().getDataInapp()}qe.instance().hideLoading();break;case Js.RESOURCE_BUY_SUPPORT_ITEM_RESPONSE:"OK"===e.params.getUtfString("status")&&this.buyItemCompleteDiamond(e.params)}}},{key:"buildData",value:function(){var e=[],t=[];this.typeMenu===pw.GEM?t=["Diamond1","Diamond2","Diamond3","Diamond4"]:this.typeMenu===pw.TICKET?t=["Ticket1","Ticket2","Ticket3","Ticket4"]:this.typeMenu===pw.HEART&&(t=["Heart1","Heart2","Heart3","Heart4"]);for(var n=0,i=0;i<this.dataServer.getSFSArray("resource_packages").size();i++){var o=this.dataServer.getSFSArray("resource_packages").getSFSObject(i);if(o.getUtfString("resource_type")===this.typeMenu)if(o.getUtfString("resource_type")===pw.TICKET&&"CASH"===o.getUtfString("price_type")||o.getUtfString("resource_type")===pw.TICKET&&"ADS"===o.getUtfString("price_type"));else{var a="";a=n<t.length?t[n]:t[t.length-1];var s=void 0;s="DIAMOND"===o.getUtfString("price_type")?new xw(o,a,!0):new xw(o,a),e.push(s),n++}}this.scroll.viewList=e,qe.instance().hideLoading()}},{key:"destroy",value:function(){this.arrResource=[{type:"spritesheet",link:"img/atlas/Diamond1.png",key:"Diamond1",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond2.png",key:"Diamond2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond3.png",key:"Diamond3",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond4.png",key:"Diamond4",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Ticket1.png",key:"Ticket1",width:200,height:140,countFrame:24},{type:"spritesheet",link:"img/atlas/Ticket2.png",key:"Ticket2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Ticket3.png",key:"Ticket3",width:200,height:140,countFrame:60},{type:"spritesheet",link:"img/atlas/Ticket4.png",key:"Ticket4",width:200,height:140,countFrame:44},{type:"spritesheet",link:"img/atlas/Heart1.png",key:"Heart1",width:200,height:140,countFrame:10},{type:"spritesheet",link:"img/atlas/Heart2.png",key:"Heart2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Heart3.png",key:"Heart3",width:200,height:140,countFrame:13},{type:"spritesheet",link:"img/atlas/Heart4.png",key:"Heart4",width:200,height:140,countFrame:60}],this.scroll.viewList=[],this.scroll.destroy(),this.removeEvent(),Aw(Lw(t.prototype),"destroy",this).call(this)}}])&&Iw(n.prototype,i),o&&Iw(n,o),t}();function Nw(e){return(Nw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jw(e,t,n){return(jw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Uw(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Uw(e){return(Uw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fw(e,t){return(Fw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Hw=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Uw(t).call(this,game,null))||"object"!==Nw(i)&&"function"!=typeof i?Zw(n):i).event={back:new Phaser.Signal},e.positionShop=e.mainData.positionShop,e.bg=new rt(e.positionShop.sort_play_list_bg_top_menu),e.addChild(e.bg),e.btnBack=new pt(e.positionShop.sort_play_list_bg_back_top_menu,e.chooseBack,Zw(Zw(e))),e.addChild(e.btnBack),e.score=mZ.instance().dataMySeft.support_item,e.btnMic=new ln(e.positionShop.tn_header_item_mic,mZ.instance().dataMySeft.support_item),e.addChild(e.btnMic),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fw(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),mZ.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),mZ.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this)}},{key:"onUserVarsUpdate",value:function(){var e=this,t={score:this.score};this.score=mZ.instance().dataMySeft.support_item;var n=game.add.tween(t).to({score:mZ.instance().dataMySeft.support_item},500,"Linear",!0,1500);n.start(),n.onUpdateCallback(function(){e.btnMic&&e.btnMic.setText(parseInt(t.score))},this),n.onComplete.add(function(){e.btnMic&&e.btnMic.setText(parseInt(e.score))},this)}},{key:"destroy",value:function(){this.removeEvent(),game.tweens.removeFrom(this.btnMic),jw(Uw(t.prototype),"destroy",this).call(this)}}])&&Bw(n.prototype,i),o&&Bw(n,o),t}();function Qw(e){return(Qw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ww(e,t){return!t||"object"!==Qw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qw(e,t,n){return(qw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Kw(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Kw(e){return(Kw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zw(e,t){return(zw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yw=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=Ww(this,Kw(t).call(this,game,null)),qe.instance().showLoading(),e.event={close:new Phaser.Signal},e.arrResource=[{type:"spritesheet",link:"img/atlas/Mic1.png",key:"Mic1",width:200,height:140,countFrame:16},{type:"spritesheet",link:"img/atlas/Mic2.png",key:"Mic2",width:200,height:140,countFrame:16},{type:"spritesheet",link:"img/atlas/Mic3.png",key:"Mic3",width:200,height:140,countFrame:60},{type:"spritesheet",link:"img/atlas/Mic4.png",key:"Mic4",width:200,height:140,countFrame:60}];var n={column:2,width:game.width,height:game.height-256*z.instance().scale,rowHeight:325*z.instance().scale,leftDistance:80*z.instance().scale,direction:"y",distanceBetweenColumns:55*z.instance().scale,distanceBetweenRows:35*z.instance().scale};return e.scroll=new Sy(n),e.scroll.y=230*z.instance().scale,e.addChild(e.scroll),e.loadResource(),Le.instance().logEvent(Le.Shop_items_support),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zw(e,t)}(t,pm),n=t,(i=[{key:"loadFileComplete",value:function(){qw(Kw(t.prototype),"loadFileComplete",this).call(this),this.header=new Hw,this.header.event.back.add(this.chooseBackMenu,this),this.addChild(this.header),this.addEvent()}},{key:"chooseBackMenu",value:function(){this.event.close.dispatch()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataPackage?"ios"===z.instance().platform?jv.instance().getDataInapp():Fv.instance().getDataInapp():(this.dataServer=this.mainData.dataPackage,this.buildData(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(LogConsole.log("cmd : "+e.cmd),LogConsole.log(e.params.getDump()),e.cmd){case Js.RESOURCE_PACKAGE_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&(this.mainData.dataPackage=e.params,this.dataServer=this.mainData.dataPackage,this.buildData()),qe.instance().hideLoading();break;case Js.RESOURCE_BUY_SUPPORT_ITEM_RESPONSE:"OK"===e.params.getUtfString("status")&&this.buyItemComplete(e.params.getInt("resource_up"));break;case Js.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE:"OK"===e.params.getUtfString("status")&&"SUPPORT_ITEM"===e.params.getUtfString("resource_type")&&(this.buyItemComplete(e.params.getInt("new_resource")-e.params.getInt("old_resource")),this.mainData.dataPackage=null,"ios"===z.instance().platform?jv.instance().getDataInapp():Fv.instance().getDataInapp()),qe.instance().hideLoading()}}},{key:"buyItemComplete",value:function(e){var t={type:"SUPPORT_ITEM",reward:e,finishPoint:{x:330*this.mainData.scale,y:45*this.mainData.scale}};iC.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,t)}},{key:"buildData",value:function(){var e,t=[];e=["Mic1","Mic2","Mic3","Mic4"];for(var n=0,i=0;i<this.dataServer.getSFSArray("resource_packages").size();i++){var o=this.dataServer.getSFSArray("resource_packages").getSFSObject(i);if(console.log(o),"SUPPORT_ITEM"===o.getUtfString("resource_type")){var a=new xw(o,n<e.length?e[n]:e[e.length-1],!0);t.push(a),n++}}this.scroll.viewList=t}},{key:"destroy",value:function(){this.scroll.viewList=[],this.removeEvent(),this.scroll.destroy(),qw(Kw(t.prototype),"destroy",this).call(this)}}])&&Vw(n.prototype,i),o&&Vw(n,o),t}();function Jw(e){return(Jw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $w(e,t){return!t||"object"!==Jw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eb(e,t,n){return(eb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tb(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function tb(e){return(tb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nb(e,t){return(nb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ib=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=$w(this,tb(t).call(this,game,null))).event={close:new Phaser.Signal,view_all_shop:new Phaser.Signal,search_shop:new Phaser.Signal},e.ktTween=!1,e.shop=null,e.vip=null,e.buyDiamond=null,e.help=null,e.idxTab=n,e.typeSubTab=i,e.bg=new Phaser.Button(game,0,0,"bg-playlist"),e.addChild(e.bg),e.arrResource=[{type:"text",link:"img/config/positionShop.json",key:"positionShop"},{type:"atlas",link:"img/atlas/shop.png",key:"shop",linkJson:"img/atlas/shop.json"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nb(e,t)}(t,pm),n=t,(i=[{key:"loadFileComplete",value:function(){eb(tb(t.prototype),"loadFileComplete",this).call(this),this.menuBot=new Gm(this.idxTab),this.menuBot.event.change_menu.add(this.change_menu,this),this.menuBot.y=game.height-120*z.instance().scale,this.addChild(this.menuBot),game.time.events.add(.1*Phaser.Timer.SECOND,this.change_menu,this,this.idxTab)}},{key:"change_menu",value:function(e){if(!1===this.ktTween){switch(this.idxTab=e,e){case 0:Le.instance().logEvent(Le.Shop_Vip_button),this.addShop();break;case 1:Le.instance().logEvent(Le.Shop_resource_button),this.addBuyDiamond();break;case 2:Le.instance().logEvent(Le.Shop_items_support_butotn),this.addHelp();break;case 3:Gn.instance().addDialog("Tính năng vip sắp ra mắt")}this.addChild(this.menuBot)}}},{key:"tweenVipComplete",value:function(){this.ktTween=!1,zc.instance().event.tweenComplete.remove(this.tweenVipComplete,this),null!==this.shop&&this.shop.addEvent(),this.removeVip()}},{key:"tweenHelpComplete",value:function(){this.ktTween=!1,zc.instance().event.tweenComplete.remove(this.tweenHelpComplete,this),null!==this.shop&&this.shop.addEvent(),this.removeHelp()}},{key:"tweenBuyDiamondComplete",value:function(){this.ktTween=!1,zc.instance().event.tweenComplete.remove(this.tweenBuyDiamondComplete,this),null!==this.shop&&this.shop.addEvent(),this.removeBuyDiamond()}},{key:"tweenShopComplete",value:function(){this.ktTween=!1,zc.instance().event.tweenComplete.remove(this.tweenShopComplete,this),this.removeShop()}},{key:"addShop",value:function(){this.removeShop(),this.shop=new Dv,this.shop.event.close.add(this.chooseClose,this),this.addChild(this.shop),null!==this.vip?(this.ktTween=!0,zc.instance().beginSwitch(this.vip,this.shop,!0),zc.instance().event.tweenComplete.add(this.tweenVipComplete,this)):null!==this.help?(this.ktTween=!0,zc.instance().beginSwitch(this.help,this.shop,!0),zc.instance().event.tweenComplete.add(this.tweenHelpComplete,this)):null!==this.buyDiamond?(this.ktTween=!0,zc.instance().beginSwitch(this.buyDiamond,this.shop,!0),zc.instance().event.tweenComplete.add(this.tweenBuyDiamondComplete,this)):(this.ktTween=!0,zc.instance().beginSwitch(null,this.shop,!0),zc.instance().event.tweenComplete.add(this.tweenShopBeginComplete,this))}},{key:"shopSearch",value:function(e){this.event.search_shop.dispatch(e)}},{key:"showAllShop",value:function(e){this.event.view_all_shop.dispatch(e)}},{key:"tweenShopBeginComplete",value:function(){null!==this.shop&&(this.ktTween=!1,zc.instance().event.tweenComplete.remove(this.tweenShopBeginComplete,this),this.shop.addEvent())}},{key:"removeShop",value:function(){null!==this.shop&&(this.removeChild(this.shop),this.shop.destroy(),this.shop=null)}},{key:"addVip",value:function(){this.removeVip(),this.vip=new rw,this.addChild(this.vip),null!==this.shop&&(this.ktTween=!0,zc.instance().beginSwitch(this.shop,this.vip,!1),zc.instance().event.tweenComplete.add(this.tweenShopComplete,this)),null!==this.buyDiamond&&(this.ktTween=!0,zc.instance().beginSwitch(this.buyDiamond,this.vip,!1),zc.instance().event.tweenComplete.add(this.tweenBuyDiamondComplete,this)),null!==this.help&&(this.ktTween=!0,zc.instance().beginSwitch(this.help,this.vip,!1),zc.instance().event.tweenComplete.add(this.tweenHelpComplete,this))}},{key:"removeVip",value:function(){null!==this.vip&&(this.removeChild(this.vip),this.vip.destroy(),this.vip=null)}},{key:"addBuyDiamond",value:function(){this.removeBuyDiamond(),this.buyDiamond=new Mw(this.typeSubTab),this.buyDiamond.event.close.add(this.chooseClose,this),this.addChild(this.buyDiamond),null!==this.shop&&(this.ktTween=!0,zc.instance().beginSwitch(this.shop,this.buyDiamond,!1),zc.instance().event.tweenComplete.add(this.tweenShopComplete,this)),null!==this.help&&(this.ktTween=!0,zc.instance().beginSwitch(this.help,this.buyDiamond,!0),zc.instance().event.tweenComplete.add(this.tweenHelpComplete,this)),null!==this.vip&&(this.ktTween=!0,zc.instance().beginSwitch(this.vip,this.buyDiamond,!0),zc.instance().event.tweenComplete.add(this.tweenVipComplete,this)),this.typeSubTab=""}},{key:"removeBuyDiamond",value:function(){null!==this.buyDiamond&&(this.removeChild(this.buyDiamond),this.buyDiamond.destroy(),this.buyDiamond=null)}},{key:"addHelp",value:function(){this.removeHelp(),this.help=new Yw,this.help.event.close.add(this.chooseClose,this),this.addChild(this.help),null!==this.vip&&(this.ktTween=!0,zc.instance().beginSwitch(this.vip,this.help,!0),zc.instance().event.tweenComplete.add(this.tweenVipComplete,this)),null!==this.shop&&(this.ktTween=!0,zc.instance().beginSwitch(this.shop,this.help,!1),zc.instance().event.tweenComplete.add(this.tweenShopComplete,this)),null!==this.buyDiamond&&(this.ktTween=!0,zc.instance().beginSwitch(this.buyDiamond,this.help,!1),zc.instance().event.tweenComplete.add(this.tweenBuyDiamondComplete,this))}},{key:"removeHelp",value:function(){null!==this.help&&(this.removeChild(this.help),this.help.destroy(),this.help=null)}},{key:"chooseClose",value:function(){this.event.close.dispatch()}},{key:"destroy",value:function(){this.mainData.positionShopData=null,this.removeBuyDiamond(),this.removeEvent(),this.removeHelp(),this.removeShop(),this.removeVip(),eb(tb(t.prototype),"destroy",this).call(this)}}])&&Xw(n.prototype,i),o&&Xw(n,o),t}();var ob=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=0,this.code="",this.genre="",this.id=0,this.priority=0,this.region=""};function ab(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var sb=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t={genres:[],playlists:[]};if("OK"===e.getUtfString(tr.status)){for(var n=[],i={},o=e.getSFSArray(tr.genres),a=0;a<o.size();a++){var s=o.getSFSObject(a),r=new ob;r.code=s.getUtfString(tr.code),r.genre=s.getUtfString(tr.genre),r.id=s.getInt(tr.id),r.region=s.getUtfString(tr.region),r.parent=s.getInt(tr.parent),r.priority=s.getInt(tr.priority),i[r.id]=r.region,n.push(r)}t.genres=n;for(var l=[],h=e.getSFSArray(tr.playlists),c=0;c<h.size();c++){var u=h.getSFSObject(c),d=new Qh;if(d.is_highlight=u.getInt(tr.is_highlight),d.used_times=u.getInt(tr.used_times),d.thumb=u.getUtfString(tr.thumb),d.created=u.getLong(tr.created),d.is_owner=u.getInt(tr.is_owner),d.is_default=u.getInt(tr.is_default),d.genre_id=u.getInt(tr.genre_id),d.purchased=u.getInt(tr.purchased),d.songs=u.getUtfString(tr.songs),d.price=u.getInt(tr.price),d.is_general=u.getInt(tr.is_general),d.name=u.getUtfString(tr.name),d.id=u.getInt(tr.id),d.vip=u.getInt(tr.vip),d.is_solo_mode=u.getInt(tr.is_solo_mode),d.updated=u.getLong(tr.updated),d.country_id=u.getInt(tr.country_id),d.purchased_count=u.getInt(tr.purchased_count),i.hasOwnProperty(d.genre_id)&&(d.region=i[d.genre_id]),u.containsKey(tr.user_playlist_mapping)){var f=u.getSFSObject(tr.user_playlist_mapping);f&&(d.user.user_id=f.getInt(tr.user_id),d.user.level=f.getInt(tr.level),d.user.playlist_id=f.getInt(tr.playlist_id),d.user.exp_score=f.getInt(tr.exp_score),d.user.created=f.getLong(tr.created),d.user.active=f.getInt(tr.active),d.user.id=f.getLong(tr.id),d.user.current_level_score=f.getInt(tr.current_level_score),d.user.next_level_score=f.getInt(tr.next_level_score),d.user.updated=f.getLong(tr.updated))}1==d.is_owner||l.push(d)}t.playlists=l}return t}}],(n=null)&&ab(t.prototype,n),i&&ab(t,i),e}();function rb(e){return(rb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hb(e,t){return!t||"object"!==rb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cb(e,t,n){return(cb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ub(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ub(e){return(ub=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function db(e,t){return(db=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fb=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),hb(this,ub(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&db(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={back:new Phaser.Signal},this.positionShop=this.mainData.positionShop,this.dataPlayList={genres:[],playlists:[]},this.detail=null,this.popupBuy=null,this.popupMoney=null,this.type=qm.SORT_AZ,this.local=nv.Local,this.genres=-1,this.itemGenresActive=null,this.strSearch="",this.dataList=[],this.ktSearch=!1,this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.addChild(this.bg);var e={column:3,width:game.width,height:732*z.instance().scale,rowHeight:326*z.instance().scale,leftDistance:35*z.instance().scale,direction:"y",distanceBetweenColumns:35*z.instance().scale,distanceBetweenRows:35*z.instance().scale};this.scroll=new Sy(e),this.scroll.y=376*z.instance().scale,this.addChild(this.scroll),this.bgGenres=new pt(this.positionShop.sort_play_list_bg_search_menu),this.bgGenres.height=136*z.instance().scale,this.bgGenres.y=100*z.instance().scale,this.addChild(this.bgGenres),this.line=new Zt(this.positionShop.shop_line),this.line.x=0*z.instance().scale,this.line.y=this.bgGenres.y+this.bgGenres.height-2*z.instance().scale,this.addChild(this.line);var t=new Phaser.Group(game,0,0,null);this.listGenres=new Jo(game,t,new Phaser.Rectangle(0,0,game.width,95*z.instance().scale),{direction:"x",padding:18*z.instance().scale,bouncing:!0,searchForClicks:!0}),t.x=0,t.y=112*z.instance().scale,this.addChild(t),this.header=new ev,this.header.addEventSearch(this.searchData,this),this.header.addEventBack(this.chooseBackHeader,this),this.addChild(this.header),this.menu=new qm,this.menu.addEventChangeMenu(this.changeMenu,this),this.menu.y=238*z.instance().scale,this.addChild(this.menu),this.txtSearch=new St(this.positionShop.sort_play_list_text_current_search,""),this.txtSearch.setTextBounds(0,0,game.width-71*z.instance().scale,59*z.instance().scale),this.addChild(this.txtSearch),this.btnCloseTextSearch=new pt(this.positionShop.sort_play_list_btn_close_search,this.chooseCloseTextSearch,this),this.addChild(this.btnCloseTextSearch),this.btnCloseTextSearch.visible=!1}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().sendData(Js.SHOP_PLAYLIST_LOAD_REQUEST,$s.begin())}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case Js.SHOP_PLAYLIST_LOAD_RESPONSE:this.dataPlayList=sb.begin(e.params),this.buildListGenres(),this.buildDataList(),!0===this.ktSearch&&(this.ktSearch=!1,this.addKeyBoard());break;case Js.SHOP_BUY_PLAYLIST_RESPONSE:"OK"===e.params.getUtfString(ShopDataField.status)&&mZ.instance().sendData(Js.SHOP_PLAYLIST_LOAD_REQUEST,$s.begin())}}},{key:"addKeyBoard",value:function(){this.header.addKeyBoard()}},{key:"chooseBackHeader",value:function(){LogConsole.log("chooseBackHeader"),this.event.back.dispatch()}},{key:"chooseCloseTextSearch",value:function(){this.btnCloseTextSearch.visible=!1,this.txtSearch.text="",this.strSearch="",this.buildDataList()}},{key:"changeMenu",value:function(e){this.type=e,this.buildDataList()}},{key:"setData",value:function(e,t,n,i){this.local=e,this.genres=t,this.type=n,this.ktSearch=i,""!=this.type&&this.menu.setMenu(this.type)}},{key:"changeData",value:function(e){this.dataPlayList=e,this.buildDataList()}},{key:"chooseItem",value:function(e){-1===this.genres?(this.itemGenresActive=e,this.itemGenresActive.active(),this.genres=e.getData().id):this.genres===e.getData().id?(e.deactive(),this.genres=-1,this.itemGenresActive=null):(this.itemGenresActive.deactive(),e.active(),this.genres=e.getData().id,this.itemGenresActive=e),this.listGenres.tweenToItem(e.idx,.5),this.buildDataList()}},{key:"searchData",value:function(e){if(LogConsole.log("searchData : "+e),this.strSearch=e,this.txtSearch.text=this.strSearch,""!=this.strSearch){this.btnCloseTextSearch.visible=!0,this.dataList=[];for(var t=0;t<this.dataPlayList.playlists.length;t++)-1!==this.xoa_dau(this.dataPlayList.playlists[t].name).toUpperCase().indexOf(this.xoa_dau(e).toUpperCase())&&this.dataList.push(this.dataPlayList.playlists[t])}else this.btnCloseTextSearch.visible=!1;this.buildDataList()}},{key:"buildDataList",value:function(){""===this.strSearch?this.type===qm.SORT_AZ?this.dataList=this.dataPlayList.playlists.sort(this.sortTopNgheSi):this.type===qm.SORT_NEW?this.dataList=this.dataPlayList.playlists.sort(this.sortNewPlayList):this.type===qm.SORT_POP?this.dataList=this.dataPlayList.playlists.sort(this.sortPhoBien):this.dataList=this.dataPlayList.playlists.sort(this.sortAZ):this.type===qm.SORT_AZ?this.dataList.sort(this.sortTopNgheSi):this.type===qm.SORT_NEW?this.dataList.sort(this.sortNewPlayList):this.type===qm.SORT_POP?this.dataList.sort(this.sortPhoBien):this.dataList.sort(this.sortAZ);for(var e=[],t=-1,n=0;n<this.dataList.length;n++)if((-1===this.genres||this.dataList[n].genre_id===this.genres)&&this.local===this.dataList[n].region&&1!==this.dataList[n].is_owner){t++;var i=new Oy;i.event.CHOOSE.add(this.chooseItemShop,this),i.event.BUY.add(this.buyItemShop,this),i.setData(this.dataList[n],t),e.push(i)}this.scroll.viewList=e}},{key:"buildListGenres",value:function(){this.listGenres.removeAll(),this.listGenres.reset();for(var e=-1,t=-1,n=0;n<this.dataPlayList.genres.length;n++)if(this.dataPlayList.genres[n].region===this.local){t++;var i=new hv(this.chooseItem,this);this.dataPlayList.genres[n].id===this.genres?(this.itemGenresActive=i,i.active(),e=t):i.deactive(),i.y=15*this.mainData.scale,i.setData(this.dataPlayList.genres[n],t),this.listGenres.add(i)}e>-1&&this.listGenres.tweenToItem(e,.5)}},{key:"chooseItemShop",value:function(e){KeyBoard.instance().hide(),iC.instance().addPlaylistDetail(e.id)}},{key:"buyItemShop",value:function(e){iC.instance().buyItem(e)}},{key:"destroy",value:function(){LogConsole.log("destroy - ShopSortPlayList"),this.removeEvent(),this.bg.destroy(),this.header.destroy(),this.menu.destroy(),this.txtSearch.destroy(),this.btnCloseTextSearch.destroy(),this.listGenres.removeAll(),this.listGenres.destroy(),this.scroll.destroy(),this.removeAllItem(),iC.instance().removePlaylistDetail(),iC.instance().removePopupBuy(),iC.instance().removePopupMoney(),cb(ub(t.prototype),"destroy",this).call(this)}}])&&lb(n.prototype,i),o&&lb(n,o),t}();function pb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var gb=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("resource_package_id",e),t}}],(n=null)&&pb(t.prototype,n),i&&pb(t,i),e}();function yb(e){return(yb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vb(e){return(vb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wb(e,t){return(wb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Sb=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=vb(t).call(this,game,null))||"object"!==yb(s)&&"function"!=typeof s?bb(a):s).event={exit:new Phaser.Signal},o.positionShop=o.mainData.positionShop,o.data=e,o.bg=new $i,o.bg.y=96,o.addChild(o.bg),o.icon=new Phaser.Sprite(game,0,0,n),o.icon.smoothed=!0,o.icon.animations.pause=!0,o.icon.animations.add("shop"+n),o.icon.animations.play("shop"+n,30,!0),o.icon.width=2*o.icon.width,o.icon.height=2*o.icon.height,o.icon.x=(o.bg.width-o.icon.width)/2,o.icon.y=(200*o.mainData.scale-o.icon.height)/2,o.addChild(o.icon),o.txtName=new St(o.positionShop.popup_confirm_txt_name,e.getUtfString("name")),o.txtName.setTextBounds(0,0,o.bg.width,64),o.addChild(o.txtName),o.txtPrice=new St(o.positionShop.popup_confirm_txt_price,e.getInt("quantity")),o.txtPrice.setTextBounds(0,0,o.bg.width,48),o.addChild(o.txtPrice),o.txtDes=new St(o.positionShop.popup_confirm_txt_des,"Bạn có muốn sở hữu số tài nguyên này không?"),o.txtDes.setTextBounds(0,0,o.bg.width,91),o.addChild(o.txtDes),o.btnThoat=new ln(o.positionShop.popup_confirm_button_thoat,"THOÁT",o.chooseExit,bb(bb(o))),o.addChild(o.btnThoat),o.btnBuy=i?new ln(o.positionShop.popup_confirm_button_mua_diamond,e.getInt("price"),o.chooseBuyDiamond,bb(bb(o))):new ln(o.positionShop.popup_confirm_button_mua,e.getInt("price")+"đ",o.chooseBuy,bb(bb(o))),o.addChild(o.btnBuy),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wb(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch()}},{key:"chooseBuyDiamond",value:function(){this.btnBuy.inputEnabled=!1,mZ.instance().sendData(Js.RESOURCE_BUY_SUPPORT_ITEM_REQUEST,gb.begin(this.data.getInt("id"))),this.event.exit.dispatch()}}])&&mb(n.prototype,i),o&&mb(n,o),t}();function _b(e){return(_b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Eb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cb(e){return(Cb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kb(e,t){return(kb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ob=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=Cb(t).call(this,game,null))||"object"!==_b(s)&&"function"!=typeof s?Pb(a):s).event={exit:new Phaser.Signal},o.bg=new Phaser.Button(game,0,0,"screen-dim"),o.addChild(o.bg),o.popup=new Sb(e,n,i),o.popup.event.exit.add(o.chooseExit,Pb(Pb(o))),o.popup.x=35*o.mainData.scale,o.popup.y=game.height,o.addChild(o.popup),o.tweenItemPopup(o.popup,275*o.mainData.scale),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kb(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch()}}])&&Eb(n.prototype,i),o&&Eb(n,o),t}();function Rb(e){return(Rb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Tb(e,t){return!t||"object"!==Rb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ib(e){return(Ib=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ab(e,t){return(Ab=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lb=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Tb(this,Ib(t).call(this,game))).quest=e,n.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),n.dailyRewardConfig=JSON.parse(game.cache.getText("dailyRewardConfig")),n.eventInput={claim:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ab(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this;this.screenDim,this.addScreenDim(),this.headerResource,this.addHeaderResource(),this.popup,this.addPopup(),Le.instance().logEvent(Le.Popup_Quest),this.timeoutPopup=setTimeout(function(){e.makeTweenPopup()},1e3)}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addHeaderResource",value:function(){this.headerResource=new Phaser.Group(game,0,0),this.addChild(this.headerResource),this.txtGem,this.txtTicket,this.txtMic,this.tabGemHeader,this.tabTicketHeader,this.tabMicHeader,this.addTabGemHeader(this.dailyRewardConfig.header),this.addTabTicketHeader(this.dailyRewardConfig.header),this.addTabMicHeader(this.dailyRewardConfig.header)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.dailyRewardConfig.header.gem);this.txtGem=this.addTxtGem(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtGem.width;this.txtGem.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtGem.width+10*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(this.txtGem),this.headerResource.addChild(this.tabGemHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return"DIAMOND"==this.quest.reward_type?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value-this.quest.reward,e.configs):new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addTabTicketHeader",value:function(e){this.tabTicketHeader=new Phaser.Sprite(game,e.tabTicket.x*window.GameConfig.RESIZE,e.tabTicket.y*window.GameConfig.RESIZE,e.tabTicket.nameAtlas,e.tabTicket.nameSprite);var t=this.addTicket(this.dailyRewardConfig.header.ticket);this.txtTicket=this.addTxtTicket(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtTicket.width;this.txtTicket.x=(this.tabTicketHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabTicketHeader.width-n)/2+this.txtTicket.width+10*window.GameConfig.RESIZE,this.tabTicketHeader.addChild(t),this.tabTicketHeader.addChild(this.txtTicket),this.headerResource.addChild(this.tabTicketHeader)}},{key:"addTicket",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtTicket",value:function(e){return"TICKET"==this.quest.reward_type?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("ticket").value-this.quest.reward,e.configs):new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("ticket").value,e.configs)}},{key:"addTabMicHeader",value:function(e){this.tabMicHeader=new Phaser.Sprite(game,e.tabMic.x*window.GameConfig.RESIZE,e.tabMic.y*window.GameConfig.RESIZE,e.tabMic.nameAtlas,e.tabMic.nameSprite);var t=this.addMic(this.dailyRewardConfig.header.micro);this.txtMic=this.addTxtMic(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtMic.width;this.txtMic.x=(this.tabMicHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabMicHeader.width-n)/2+this.txtMic.width+10*window.GameConfig.RESIZE,this.tabMicHeader.addChild(t),this.tabMicHeader.addChild(this.txtMic),this.headerResource.addChild(this.tabMicHeader)}},{key:"addMic",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtMic",value:function(e){return"SUPPORT_ITEM"==this.quest.reward_type?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("support_item").value-this.quest.reward,e.configs):new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("support_item").value,e.configs)}},{key:"addPopup",value:function(){this.txtPopup,this.rewardClaimed,this.txtQuestReward,this.btnClaim,this.popup=new $i,this.popup.x=35*window.GameConfig.RESIZE,this.popup.y=1140*window.GameConfig.RESIZE,this.popup.setHeight(400*window.GameConfig.RESIZE),this.addTxtPopup(),this.addRewardClaimed(),this.addTxtQuestReward(),this.addBtnClaim(),this.addChild(this.popup)}},{key:"addTxtPopup",value:function(){this.txtPopup=new Phaser.Text(game,this.positionQAndAConfig.txtPopupClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.txtPopupClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.txtPopupClaim.text,this.positionQAndAConfig.txtPopupClaim.configs),this.txtPopup.anchor.set(.5,0),this.popup.addChild(this.txtPopup)}},{key:"addRewardClaimed",value:function(){if(this.rewardClaimed=new Phaser.Text(game,this.positionQAndAConfig.rewardClaimed.x*window.GameConfig.RESIZE,this.positionQAndAConfig.rewardClaimed.y*window.GameConfig.RESIZE,this.quest.reward,this.positionQAndAConfig.rewardClaimed.configs),"DIAMOND"==this.quest.reward_type)(e=new Phaser.Sprite(game,this.positionQAndAConfig.gemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.gemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.gemClaim.nameAtlas,this.positionQAndAConfig.gemClaim.nameSprite)).scale.set(1.2);else if("TICKET"==this.quest.reward_type){(e=new Phaser.Sprite(game,this.positionQAndAConfig.ticketClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.ticketClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.ticketClaim.nameAtlas,this.positionQAndAConfig.ticketClaim.nameSprite)).scale.set(1.2)}else{var e;(e=new Phaser.Sprite(game,this.positionQAndAConfig.sptItemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.sptItemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.sptItemClaim.nameAtlas,this.positionQAndAConfig.sptItemClaim.nameSprite)).scale.set(1.2)}var t=this.rewardClaimed.width+e.width;this.rewardClaimed.x=(570*window.GameConfig.RESIZE-t)/2-5*window.GameConfig.RESIZE,e.x=(570*window.GameConfig.RESIZE-t)/2+this.rewardClaimed.width+10*window.GameConfig.RESIZE,this.popup.addChild(this.rewardClaimed),this.popup.addChild(e)}},{key:"addTxtQuestReward",value:function(){this.txtQuestReward=new Phaser.Text(game,this.positionQAndAConfig.questReward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.questReward.y*window.GameConfig.RESIZE,this.quest.quest,this.positionQAndAConfig.questReward.configs),this.txtQuestReward.anchor.set(.5,0),this.popup.addChild(this.txtQuestReward)}},{key:"addBtnClaim",value:function(){var e=this;this.btnClaim=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,295*window.GameConfig.RESIZE,"questAndAchieveSprites","Button_Nhan_popup"),this.btnClaim.anchor.set(.5,0);var t=new Phaser.Text(game,0,27*window.GameConfig.RESIZE,"NHẬN",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:30});t.anchor.set(.5,0),this.btnClaim.addChild(t),this.btnClaim.inputEnabled=!0,this.btnClaim.events.onInputUp.add(function(){e.btnClaim.inputEnabled=!1,ce.instance().playSound(ce.buttonclick);var t={x:0,y:0};"DIAMOND"==e.quest.reward_type?(t.x=351,t.y=55):"TICKET"==e.quest.reward_type?(t.x=529,t.y=55):(t.x=164,t.y=55),iC.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:e.quest.reward_type,reward:e.quest.reward,finishPoint:t}),e.timeUpdateRs=game.time.events.add(2*Phaser.Timer.SECOND,function(){e.updateVariableResource(e.quest)},e),iC.instance().animClaimReward.event.tweenDoneAll.add(e.onClaimDone,e)},this),this.popup.addChild(this.btnClaim)}},{key:"updateVariableResource",value:function(e){var t=this;if("DIAMOND"==e.reward_type){var n=game.add.tween(this.txtGem).to({text:mZ.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.txtGem.text=parseInt(t.txtGem.text)},this)}else if("TICKET"==e.reward_type){var i=game.add.tween(this.txtTicket).to({text:mZ.instance().socket.mySelf.getVariable("ticket").value},300,"Linear",!1);i.start(),i.onUpdateCallback(function(){t.txtTicket.text=parseInt(t.txtTicket.text)},this)}else if("SUPPORT_ITEM"==e.reward_type){var o=game.add.tween(this.txtMic).to({text:mZ.instance().socket.mySelf.getVariable("support_item").value},300,"Linear",!1);o.start(),o.onUpdateCallback(function(){t.txtMic.text=parseInt(t.txtMic.text)},this)}}},{key:"onClaimDone",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-430*window.GameConfig.RESIZE},400,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.eventInput.claim.dispatch(),e.destroy()},this)}},{key:"makeTweenPopup",value:function(){ce.instance().playSound(ce.popupfinishquest),game.add.tween(this.popup).to({y:(game.height-763)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start()}},{key:"onClose",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-430*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.destroy()},this),this.popup.event.close.remove(this.onClose,this)}},{key:"destroy",value:function(){for(game.time.events.remove(this.timeUpdateRs);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&xb(n.prototype,i),o&&xb(n,o),t}();function Gb(e){return(Gb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Db(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Mb(e){return(Mb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nb(e,t){return(Nb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var jb=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=Mb(t).call(this,game,null))||"object"!==Gb(o)&&"function"!=typeof o?Bb(i):o).event={complete:new Phaser.Signal},n.timerToCountTime=null,n.graphics=game.add.graphics(0,0),n.graphics.beginFill(0,.8),n.graphics.drawRect(0,0,game.width,60*z.instance().scale),n.graphics.endFill(),n.addChild(n.graphics),n.txtContent=new St({x:0,y:0,style:{fontSize:26*z.instance().scale}},e),n.addChild(n.txtContent),n.txtContent.x=game.width,n.txtContent.y=15,n.timerToCountTime=n.game.time.create(!0),n.timerToCountTime.loop(20,n.onTimerToCountTime,Bb(Bb(n))),n.timerToCountTime.start(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nb(e,t)}(t,Mt),n=t,(i=[{key:"onTimerToCountTime",value:function(){this.txtContent.x-=3,this.txtContent.x<-this.txtContent.width&&(this.timerToCountTime.stop(),this.event.complete.dispatch())}},{key:"destroyTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy())}},{key:"destroy",value:function(){this.graphics.clear(),this.destroyTime(),this.removeAllItem()}}])&&Db(n.prototype,i),o&&Db(n,o),t}();function Ub(e){return(Ub="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zb(e,t){return!t||"object"!==Ub(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hb(e,t,n){return(Hb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qb(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qb(e){return(Qb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vb(e,t){return(Vb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wb=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Zb(this,Qb(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vb(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.eventBack=new Phaser.Signal,this.positionShop=this.mainData.positionDetailPlaylist,this.bg=new rt(this.positionShop.sort_play_list_bg_top_menu),this.addChild(this.bg),this.btnBack=new pt(this.positionShop.sort_play_list_bg_back_top_menu,this.chooseBack,this),this.addChild(this.btnBack),this.btnDiamond=new ln(this.positionShop.sort_play_list_bg_diamond_top_menu,mZ.instance().dataMySeft.diamond),this.addChild(this.btnDiamond),De.instance().event.backButton.add(this.chooseBack,this)}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack"),this.dispatchEventBack()}},{key:"addEventBack",value:function(e,t){this.eventBack.add(e,t)}},{key:"removeEventBack",value:function(e,t){this.eventBack.remove(e,t)}},{key:"dispatchEventBack",value:function(){this.eventBack.dispatch()}},{key:"destroy",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),Hb(Qb(t.prototype),"destroy",this).call(this)}}])&&Fb(n.prototype,i),o&&Fb(n,o),t}();function qb(e){return(qb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zb(e,t){return!t||"object"!==qb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yb(e){return(Yb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jb(e,t){return(Jb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xb=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zb(this,Yb(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jb(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.data=new ec,this.positionShop=this.mainData.positionDetailPlaylist,this.bg=new Phaser.Button(game,0,0,"bg-playlist",this.chooseDetail,this),this.bg.alpha=0,this.bg.width=this.width,this.bg.height=this.height,this.addChild(this.bg),this.line=new rt(this.positionShop.detail_playlist_item_line),this.line.width=570*z.instance().scale,this.addChild(this.line),this.txtNameSong=new St(this.positionShop.detail_playlist_item_name_song),this.txtNameSong.setTextBounds(0,0,551*z.instance().scale,59*z.instance().scale),this.addChild(this.txtNameSong),this.txtNameCaSi=new St(this.positionShop.detail_playlist_item_name_casi),this.txtNameCaSi.setTextBounds(0,0,551*z.instance().scale,31*z.instance().scale),this.addChild(this.txtNameCaSi),this.btnDetailSong=new pt(this.positionShop.detail_playlist_btn_detail_song,this.chooseDetail,this),this.addChild(this.btnDetailSong)}},{key:"chooseDetail",value:function(){LogConsole.log("chooseDetail"),iC.instance().addDetailSong(this.data)}},{key:"hideLine",value:function(){this.line.visible=!1}},{key:"setData",value:function(e){this.data=e,this.txtNameSong.text=this.data.title,this.txtNameCaSi.text=this.data.singer}},{key:"width",get:function(){return 586*z.instance().scale}},{key:"height",get:function(){return 115*z.instance().scale}}])&&Kb(n.prototype,i),o&&Kb(n,o),t}();function $b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var eS=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){var n=new SFS2X.SFSObject;return n.putInt("playlist_id",e),n.putInt("active",t),n}}],(n=null)&&$b(t.prototype,n),i&&$b(t,i),e}();function tS(e){return(tS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iS(e,t){return!t||"object"!==tS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oS(e,t,n){return(oS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aS(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function aS(e){return(aS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sS(e,t){return(sS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rS=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=iS(this,aS(t).call(this,game,null))).playListDetail=new Qh,n.playlist_id=e,n.eventBack=new Phaser.Signal,n.arrResource=[{type:"text",link:"img/config/positionDetailPlaylist.json",key:"positionDetailPlaylist"},{type:"atlas",link:"img/atlas/detailplaylist.png",key:"detailplaylist",linkJson:"img/atlas/detailplaylist.json"}],n.loadResource(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sS(e,t)}(t,pm),n=t,(i=[{key:"loadFileComplete",value:function(){oS(aS(t.prototype),"loadFileComplete",this).call(this),this.buildScreen()}},{key:"buildScreen",value:function(){this.positionShop=this.mainData.positionDetailPlaylist,this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.addChild(this.bg),this.popupBuy=null,this.popupMoney=null,this.header=new Wb,this.header.addEventBack(this.chooseBack,this),this.addChild(this.header),this.ava=new Ch,this.ava.setSize(163*z.instance().scale,163*z.instance().scale),this.ava.x=234*z.instance().scale,this.ava.y=148*z.instance().scale,this.addChild(this.ava),this.namePlayList=new St(this.positionShop.detail_playlist_name,""),this.namePlayList.setTextBounds(0,0,game.width-47*z.instance().scale,41*z.instance().scale),this.addChild(this.namePlayList),this.detailPlayList=new St(this.positionShop.detail_playlist_detail,""),this.detailPlayList.setTextBounds(0,0,533*z.instance().scale,118*z.instance().scale),this.addChild(this.detailPlayList),this.btnBuy=new ln(this.positionShop.playlist_button_buy,"0",this.chooseBuy,this),this.btnBuy.visible=!1,this.btnBuy.x=(game.width-this.btnBuy.width)/2,this.addChild(this.btnBuy),this.btnKichHoat=new ln(this.positionShop.detail_button_kichhoat,"aaaaaaaa",this.chooseKickHoat,this),this.btnKichHoat.visible=!1,this.addChild(this.btnKichHoat),this.btnBuy.y=this.positionShop.detail_button_kichhoat.y*z.instance().scale,this.txtBaiHat=new St(this.positionShop.detail_playlist_lb_baihat,"Bài hát"),this.txtBaiHat.setTextBounds(0,0,207*z.instance().scale,35*z.instance().scale),this.addChild(this.txtBaiHat),this.levelPlayList=new Mh,this.levelPlayList.x=this.ava.x+(this.ava.width-this.levelPlayList.width)/2,this.levelPlayList.y=373*z.instance().scale,this.addChild(this.levelPlayList),this.txtCountBaiHat=new St(this.positionShop.detail_playlist_lb_count_baihat,"0"),this.txtCountBaiHat.setTextBounds(0,0,189*z.instance().scale,31*z.instance().scale),this.addChild(this.txtCountBaiHat);var e=new Phaser.Group(game,0,0,null);this.listSong=new Jo(game,e,new Phaser.Rectangle(0,0,586*z.instance().scale,420*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),e.x=35*z.instance().scale,e.y=708*z.instance().scale,this.addChild(e),this.line=new rt(this.positionShop.detail_playlist_item_line),this.line.width=570*z.instance().scale,this.addChild(this.line),this.activeBaiHat=new rt(this.positionShop.detail_playlist_active_baihat),this.addChild(this.activeBaiHat),this.line.y=this.activeBaiHat.y+3,this.line.x=this.activeBaiHat.x,this.addEvent()}},{key:"addEventBack",value:function(e,t){this.eventBack.add(e,t)}},{key:"removeEventBack",value:function(e,t){this.eventBack.remove(e,t)}},{key:"dispatchEventBack",value:function(){this.eventBack.dispatch()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().sendData(Js.PLAYLIST_DETAIL_REQUEST,$h.begin(this.playlist_id))}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case Js.PLAYLIST_DETAIL_RESPONSE:LogConsole.log("PLAYLIST_DETAIL_RESPONSE : "+e.params.getDump()),"OK"===e.params.getUtfString(tr.status)&&(this.playListDetail=oc.begin(e.params),this.buildDataDetail());break;case Js.PLAYLIST_CHANGE_ACTIVE_RESPONSE:case Js.SHOP_BUY_PLAYLIST_RESPONSE:"OK"===e.params.getUtfString(tr.status)&&mZ.instance().sendData(Js.PLAYLIST_DETAIL_REQUEST,$h.begin(this.playlist_id))}}},{key:"buildDataDetail",value:function(){this.ava.beginLoad(this.playListDetail.thumb,1),this.namePlayList.text=this.playListDetail.name,this.btnBuy.setText(this.playListDetail.price),this.txtCountBaiHat.text=this.playListDetail.arrSong.length,this.detailPlayList.text=this.playListDetail.description,this.levelPlayList.setData(this.playListDetail.user),this.levelPlayList.x=this.ava.x+(this.ava.width-this.levelPlayList.width)/2,this.listSong.removeAll(),this.listSong.reset();for(var e=0;e<this.playListDetail.arrSong.length;e++){var t=new Xb;0===e&&t.hideLine(),t.setData(this.playListDetail.arrSong[e]),this.listSong.add(t)}1==this.playListDetail.is_owner?(this.btnBuy.visible=!1,this.btnKichHoat.visible=!0,0===this.playListDetail.user.active?this.btnKichHoat.setText("KÍCH HOẠT"):this.btnKichHoat.setText("HỦY")):(this.btnBuy.visible=!0,this.btnKichHoat.visible=!1)}},{key:"chooseBuy",value:function(){iC.instance().buyItem(this.playListDetail)}},{key:"chooseKickHoat",value:function(){var e=0;e=0===this.playListDetail.user.active?1:0,mZ.instance().sendData(Js.PLAYLIST_CHANGE_ACTIVE_REQUEST,eS.begin(this.playlist_id,e))}},{key:"chooseBack",value:function(){this.dispatchEventBack()}},{key:"destroy",value:function(){this.removeEvent(),this.mainData.positionDetailPlaylistData=null,this.listSong.removeAll(),this.listSong.destroy(),iC.instance().removePopupBuy(),iC.instance().removePopupMoney(),oS(aS(t.prototype),"destroy",this).call(this)}}])&&nS(n.prototype,i),o&&nS(n,o),t}();function lS(e){return(lS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cS(e,t,n){return(cS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=uS(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function uS(e){return(uS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dS(e,t){return(dS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var pS=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=uS(t).call(this,game,null))||"object"!==lS(i)&&"function"!=typeof i?fS(n):i).event={close:new Phaser.Signal},e.tweenAlphaText=null,e.level=o,e.dialog=new Fi,e.dialog.event.close.add(e.chooseClose,fS(fS(e))),e.dialog.setHeight(420*z.instance().scale),e.addChild(e.dialog),e.levelUp=new Phaser.Sprite(game,0,0,"LevelUp"),e.levelUp.width=444*z.instance().scale,e.levelUp.height=270.47*z.instance().scale,e.levelUp.x=62*z.instance().scale,e.levelUp.y=29*z.instance().scale,e.levelUp.smoothed=!0,e.levelUp.animations.pause=!0,e.anim=e.levelUp.animations.add("playLevelUp"),e.anim.enableUpdate=!0,e.levelUp.animations.play("playLevelUp",30,!0),e.addChild(e.levelUp),e.anim.onUpdate.add(e.animationUpdate,fS(fS(e)));return e.txtLeveUp=new St({x:0,y:0,style:{fontSize:32,wordWrap:!0,wordWrapWidth:388,align:"center",boundsAlignH:"center",boundsAlignV:"middle",fill:"#000000",font:"GilroyBold"}},"Chúc mừng bạn đã lên Level "+o),e.txtLeveUp.setTextBounds(0,0,568*.7*z.instance().scale,118*z.instance().scale),e.txtLeveUp.lineSpacing=12*z.instance().scale,e.txtLeveUp.y=296*z.instance().scale,e.txtLeveUp.x=(568-568*.7)*z.instance().scale/2,e.addChild(e.txtLeveUp),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dS(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseClose,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseClose,this)}},{key:"animationUpdate",value:function(){console.log("animationUpdate: "+this.levelUp.animations.frame),59===this.levelUp.animations.frame&&this.levelUp.animations.stop()}},{key:"chooseClose",value:function(){var e=Qr.instance().getItem(Qr.VOTE);console.log("voteCheck : "+e),"error"===e||null===e||"null"===e?this.checkShowVote(this.level):"VoteSau"===e&&this.checkShowVote(this.level),this.event.close.dispatch()}},{key:"setData",value:function(e){this.level=e,this.txtLeveUp.text="Chúc mừng bạn đã lên Level "+e,this.levelUp.animations.play("playLevelUp",30,!0)}},{key:"checkShowVote",value:function(e){(console.log("voteCheck : "+e),e>5)?(e-6)%2==0&&iC.instance().addSuggetRating():5===e&&iC.instance().addSuggetRating()}},{key:"destroy",value:function(){this.removeEvent(),null!==this.tweenAlphaText&&(this.tweenAlphaText.stop(),game.tweens.remove(this.tweenAlphaText),this.tweenAlphaText=null),this.anim.destroy(),this.removeAllItem(),cS(uS(t.prototype),"destroy",this).call(this)}}])&&hS(n.prototype,i),o&&hS(n,o),t}();function gS(e){return(gS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mS(e,t,n){return(mS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vS(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function vS(e){return(vS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wS(e,t){return(wS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var SS=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=vS(t).call(this,game,null))||"object"!==gS(o)&&"function"!=typeof o?bS(i):o).level_up=e,n.event={close:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"screen-dim",n.closeLevelUp,bS(bS(n))),n.addChild(n.bg),n.arrResource=[{type:"spritesheet",link:"img/atlas/LevelUp.png",key:"LevelUp",width:240,height:146,countFrame:61}],n.loadResource(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wS(e,t)}(t,pm),n=t,(i=[{key:"loadFileComplete",value:function(){mS(vS(t.prototype),"loadFileComplete",this).call(this),this.level=new pS(this.level_up),this.level.event.close.add(this.closeLevelUp,this),this.level.x=35*z.instance().scale,this.addChild(this.level),this.level.y=game.height-89*z.instance().scale,this.tweenItemPopup(this.level,385*z.instance().scale),ce.instance().playSound(ce.popuplevelup)}},{key:"closeLevelUp",value:function(){this.event.close.dispatch(),ce.instance().removeSound()}}])&&yS(n.prototype,i),o&&yS(n,o),t}();function _S(e){return(_S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ES(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function CS(e){return(CS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kS(e,t){return(kS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function PS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var OS=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=CS(t).call(this,game,null))||"object"!==_S(i)&&"function"!=typeof i?PS(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.popup=new vh,e.popup.setTextOk("ĐỒNG Ý"),e.popup.setTextCancle("QUAY LẠI"),e.popup.event.OK.add(e.chooseOk,PS(PS(e))),e.popup.event.CANCLE.add(e.chooseCancle,PS(PS(e))),e.popup.setHeight(580*e.mainData.scale),e.addChild(e.popup),e.dia=new Phaser.Sprite(game,0,0,"disconnect"),e.dia.width=228*e.mainData.scale,e.dia.height=228*e.mainData.scale,e.dia.x=172*e.mainData.scale,e.dia.y=70*e.mainData.scale,e.dia.smoothed=!0,e.dia.animations.pause=!0,e.anim=e.dia.animations.add("disconnect"),e.anim.enableUpdate=!0,e.addChild(e.dia),e.dia.animations.play("disconnect",30,!0);var o=new St(e.mainData.positionPopup.bad_connection_label_thongbao,"Kết nối internet của bạn không tốt");return o.setTextBounds(0,0,e.popup.width,30*e.mainData.scale),e.addChild(o),e.lbConfirm=new St(e.mainData.positionPopup.bad_connection_label_confirm,"Nếu bạn vẫn muốn chơi có thể bạn sẽ phải nghe nhạc chất lượng thấp."),e.lbConfirm.setTextBounds(0,0,e.popup.width,50*e.mainData.scale),e.addChild(e.lbConfirm),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kS(e,t)}(t,Mt),n=t,(i=[{key:"setTextConfirm",value:function(e){this.lbConfirm.text=e}},{key:"setTextOk",value:function(e){this.popup.setTextOk(e)}},{key:"setTextCancle",value:function(e){this.popup.setTextCancle(e)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}}])&&ES(n.prototype,i),o&&ES(n,o),t}();function RS(e){return(RS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function TS(e){return(TS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IS(e,t){return(IS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function AS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var LS=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=TS(t).call(this,game,null))||"object"!==RS(i)&&"function"!=typeof i?AS(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.popup=new OS,e.popup.event.OK.add(e.chooseOk,AS(AS(e))),e.popup.event.CANCLE.add(e.chooseCancle,AS(AS(e))),e.popup.x=35*e.mainData.scale,e.popup.y=game.height+237*e.mainData.scale,e.tweenItemPopup(e.popup,game.height-810*e.mainData.scale),e.addChild(e.popup),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IS(e,t)}(t,Mt),n=t,(i=[{key:"setTextOk",value:function(e){this.popup.setTextOk(e)}},{key:"setTextCancle",value:function(e){this.popup.setTextCancle(e)}},{key:"setTextConfirm",value:function(e){this.popup.setTextConfirm(e)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}}])&&xS(n.prototype,i),o&&xS(n,o),t}();function GS(e){return(GS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function MS(e,t){return!t||"object"!==GS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NS(e){return(NS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BS(e,t){return(BS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jS=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=MS(this,NS(t).call(this,game,e,n,"settingSprites","Hoso_Box_Ten"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),a.label=i,a.valueText=o,a.afterInit(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BS(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){var e=Bn.formatName(this.valueText,21);this.valueText=e,this.labelTxt,this.valueTextTxt,this.addLabel(),this.addValueText()}},{key:"addLabel",value:function(){this.label=new Phaser.Text(game,this.positionSetting.setting_profile.lbl_box.x,this.positionSetting.setting_profile.lbl_box.y,this.label,this.positionSetting.setting_profile.lbl_box.style),this.addChild(this.label)}},{key:"addValueText",value:function(){this.valueTextTxt=new Phaser.Text(game,this.positionSetting.setting_profile.value_box.x,this.positionSetting.setting_profile.value_box.y,this.valueText,this.positionSetting.setting_profile.value_box.style),this.addChild(this.valueTextTxt)}}])&&DS(n.prototype,i),o&&DS(n,o),t}();function US(e){return(US="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZS(e,t){return!t||"object"!==US(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HS(e){return(HS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QS(e,t){return(QS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var VS=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ZS(this,HS(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),null!==mZ.instance().socket.mySelf&&(e.name=mZ.instance().dataMySeft.user_name),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QS(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.boxName,this.boxLocation,this.addBoxName(),this.addBoxLocation()}},{key:"addBoxName",value:function(){this.boxName=new jS(255*z.instance().scale,169*z.instance().scale,this.positionSetting.setting_profile.lbl_box.name,this.name),this.addChild(this.boxName)}},{key:"addBoxLocation",value:function(){this.boxLocation=new jS(255*z.instance().scale,255*z.instance().scale,this.positionSetting.setting_profile.lbl_box.location,"Việt Nam"),this.addChild(this.boxLocation)}}])&&FS(n.prototype,i),o&&FS(n,o),t}();function WS(e){return(WS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function KS(e,t){return!t||"object"!==WS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zS(e){return(zS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function YS(e,t){return(YS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var JS=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=KS(this,zS(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.description=z.instance().userDescription,e.event={changeDes:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YS(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.lbl,this.box,this.addLabel(),this.addBox()}},{key:"addLabel",value:function(){this.lbl=new St(this.positionSetting.setting_profile.lbl_des,this.positionSetting.setting_profile.lbl_des.text),this.addChild(this.lbl)}},{key:"addBox",value:function(){this.box=new pt(this.positionSetting.setting_profile.box_des,this.onClickBox,this);var e=new rt(this.positionSetting.setting_profile.icon_edit);this.box.addChild(e),this.desText=new St(this.positionSetting.setting_profile.txt_des,this.description),this.tick=new rt(this.positionSetting.setting_profile.tick_des),this.box.addChild(this.tick),this.box.addChild(this.desText),this.addChild(this.box)}},{key:"onClickBox",value:function(){this.inputKeyboard(),this.tick.kill()}},{key:"inputKeyboard",value:function(){var e={maxLength:"",showTransparent:!0,placeholder:"Nhập trạng thái",isSearch:!1,typeInputText:"input",configText:{width:this.box.width-70,height:this.box.height-5,x:this.box.x,y:this.box.y}};rl.instance().event.cancle.add(this.keyboardClose,this),rl.instance().event.enter.add(this.keyboardDone,this),rl.instance().event.submit.add(this.keyboardDone,this),rl.instance().show(e),rl.instance().setValue(this.description)}},{key:"keyboardClose",value:function(){rl.instance().event.cancle.remove(this.keyboardClose,this),rl.instance().event.enter.remove(this.keyboardDone,this),rl.instance().event.submit.remove(this.keyboardDone,this),rl.instance().hide(),this.box.revive()}},{key:"keyboardDone",value:function(){this.description=rl.instance().getValue(),this.changeTxtBoxText(),this.sendDes(),this.keyboardClose()}},{key:"sendDes",value:function(){El.instance().settingAccount(mZ.instance().socket.mySelf.getVariable("user_id").value,mZ.instance().dataMySeft.user_name,mZ.instance().socket.mySelf.getVariable("gender").value,null,this.description),El.instance().sendData(this.onSendSettingDone.bind(this))}},{key:"onSendSettingDone",value:function(e){if("ok"==e.code){De.instance().event.updateDescription.dispatch(),this.description=e.data.description,this.desText.setText(this.description),this.tick.revive();var t=[];t.push(new SFS2X.SFSUserVariable("description",e.data.description)),mZ.instance().socket.send(new SFS2X.SetUserVariablesRequest(t)),mZ.instance().dataMySeft.setDescription(e.data.description)}}},{key:"changeTxtBoxText",value:function(){this.desText.setText(this.description)}},{key:"destroy",value:function(){for(rl.instance().hide();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&qS(n.prototype,i),o&&qS(n,o),t}();function XS(e){return(XS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $S(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function e_(e,t){return!t||"object"!==XS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function t_(e){return(t_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n_(e,t){return(n_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=e_(this,t_(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.event={reloadScreen:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n_(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.ava,this.frameAva,this.btnCamera,this.name,this.description,this.addAva(),this.addFrameAva(),this.addName(),this.addDescription(),this.addBtnCamera(),this.addEventExtension()}},{key:"addEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this)}},{key:"onUpdateUserVars",value:function(){this.urlAvatar!==mZ.instance().dataMySeft.avatar&&this.event.reloadScreen.dispatch()}},{key:"addAva",value:function(){this.urlAvatar=mZ.instance().dataMySeft.avatar,this.ava=new gl(this.positionSetting.setting_profile.ava.x*window.GameConfig.RESIZE,this.positionSetting.setting_profile.ava.y*window.GameConfig.RESIZE,"ava-default",mZ.instance().dataMySeft.avatar,1),this.ava.sprite.scale.set(.85*window.GameConfig.RESIZE),this.ava.sprite.anchor.set(.5),this.addChild(this.ava.sprite);var e=new Phaser.Graphics(game,0,0);e.drawCircle(128*window.GameConfig.RESIZE,238*window.GameConfig.RESIZE,170*window.GameConfig.RESIZE),e.anchor.set(.5),this.ava.sprite.mask=e}},{key:"addName",value:function(){this.name=new VS,this.addChild(this.name)}},{key:"addDescription",value:function(){this.description=new JS,this.description.event.changeDes.add(this.changeDes,this),this.addChild(this.description)}},{key:"changeDes",value:function(){this.event.reloadScreen.dispatch()}},{key:"addFrameAva",value:function(){this.frameAva=new rt(this.positionSetting.setting_profile.frame_ava),this.frameAva.anchor.set(.5),this.addChild(this.frameAva)}},{key:"addBtnCamera",value:function(){this.btnCamera=new pt(this.positionSetting.setting_profile.btn_camera,this.onClickBtnCam,this),this.btnCamera.anchor.set(.5),this.addChild(this.btnCamera)}},{key:"onClickBtnCam",value:function(){this.appendDOMFile()}},{key:"setStylesAvaField",value:function(){var e=game.canvas.getBoundingClientRect().width/game.width,t=game.canvas.getBoundingClientRect().height/game.height,n=(window.innerWidth-game.canvas.getBoundingClientRect().width)/2,i={top:game.canvas.getBoundingClientRect().top+150*z.instance().scale*t+"px",left:n+250*z.instance().scale*e+"px",width:300*z.instance().scale*e+"px",height:85*z.instance().scale*t+"px",position:"absolute","z-index":1};i["padding-left"]=10*z.instance().scale*e+"px",i["padding-right"]=10*z.instance().scale*e+"px",this.setStyleOnElement($("#avatarField"),i);var o={top:game.canvas.getBoundingClientRect().top+140*z.instance().scale*t+"px",left:game.canvas.getBoundingClientRect().left+50*z.instance().scale*e+"px",width:130*z.instance().scale*e+"px",height:130*z.instance().scale*t+"px",position:"absolute"};this.setStyleOnElement($("#preview"),o)}},{key:"setStyleOnElement",value:function(e,t){e.css(t)}},{key:"addFundametal",value:function(){this.bg=new pt({x:36,y:120,nameAtlas:"settingSprites",nameSprite:"Hoso_Box_Mota"},function(){},this),this.addChild(this.bg),this.btnSubmit=new pt({x:470,y:110,nameAtlas:"defaultSource",nameSprite:"Send_Icon"},this.onSubmit,this),this.bg.addChild(this.btnSubmit),this.btnCancle=new pt({x:570,y:-30,nameAtlas:"defaultSource",nameSprite:"Exit"},this.cancleBg,this),this.bg.addChild(this.btnCancle),this.addTick()}},{key:"addTick",value:function(){this.tick=new rt(this.positionSetting.setting_account.tick_ava),this.tick.kill(),this.bg.addChild(this.tick)}},{key:"cancleBg",value:function(){this.closeDOM(),this.btnCancle.destroy(),this.btnSubmit.destroy(),this.bg.destroy()}},{key:"onSubmit",value:function(){this.avaRender=$("#getImageDataUrl").attr("src"),void 0!==this.avaRender&&(qe.instance().showLoading(),El.instance().settingAccount(mZ.instance().socket.mySelf.getVariable("user_id").value,mZ.instance().dataMySeft.user_name,mZ.instance().socket.mySelf.getVariable("gender").value,this.avaRender),El.instance().sendData(this.onSendAvaDone.bind(this)))}},{key:"onSendAvaDone",value:function(e){if("ok"==e.code){this.tick.revive();var t=[];t.push(new SFS2X.SFSUserVariable("avatar",e.data.avatar)),mZ.instance().socket.send(new SFS2X.SetUserVariablesRequest(t)),qe.instance().hideLoading(),mZ.instance().dataMySeft.setAvatar(e.data.avatar)}}},{key:"closeDOM",value:function(){$("#avatarField").remove(),$("#preview").remove()}},{key:"appendDOMFile",value:function(){this.addFundametal(),$("#game").append('<input type="file" id="avatarField">'),$("#game").append('<div id="preview"></div>'),this.setStylesAvaField(),$("#avatarField").change(function(){this.files[0].size>z.instance().SIZE_AVA_UPLOAD?alert("photo file has too big size!! Pls choose another."):renderImage(this.files[0],function(e){$("#preview").html("<img id='getImageDataUrl' style=width:100px; src='"+e+"' />")})})}},{key:"destroy",value:function(){for(this.closeDOM(),this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&$S(n.prototype,i),o&&$S(n,o),t}();function o_(e){return(o_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s_(e,t){return!t||"object"!==o_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r_(e){return(r_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l_(e,t){return(l_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=s_(this,r_(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l_(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addHeaderTab(this.positionSetting.header),this.addListSetting()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting_profile)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),this.ava&&this.ava.closeDOM(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addListSetting",value:function(){this.ava,this.location,this.description,this.name,this.addAva()}},{key:"addAva",value:function(){this.ava=new i_,this.ava.event.reloadScreen.add(this.reloadScreen,this),this.addChild(this.ava)}},{key:"reloadScreen",value:function(){this.ava.destroy(),this.addAva()}},{key:"addBtnSave",value:function(){this.btnSave=new pt(this.positionSetting.setting_profile.btn_save,this.clickSave,this),this.btnSave.anchor.set(.5);var e=new St(this.positionSetting.setting_profile.txt_btn_save,this.positionSetting.setting_profile.txt_btn_save.text);e.anchor.set(.5),this.btnSave.addChild(e),this.addChild(this.btnSave)}},{key:"clickSave",value:function(){}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.ava&&this.ava.closeDOM();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&a_(n.prototype,i),o&&a_(n,o),t}();function c_(e){return(c_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d_(e,t){return!t||"object"!==c_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f_(e){return(f_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p_(e,t){return(p_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g_=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=d_(this,f_(t).call(this,game,0,0,"screen-dim2"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),n.claimValues=e,n.getReward(),n.afterInit(),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p_(e,t)}(t,Phaser.Button),n=t,a=[{key:"HEART",get:function(){return"HEART"}},{key:"DIAMOND",get:function(){return"DIAMOND"}},{key:"TICKET",get:function(){return"TICKET"}},{key:"SUPPORT_ITEM",get:function(){return"SUPPORT_ITEM"}}],(o=[{key:"getReward",value:function(){this.rewards=[],this.claimValues.diamond>0&&this.rewards.push({type:t.DIAMOND,reward:this.claimValues.diamond}),this.claimValues.heart>0&&this.rewards.push({type:t.HEART,reward:this.claimValues.heart}),this.claimValues.ticket>0&&this.rewards.push({type:t.TICKET,reward:this.claimValues.ticket}),this.claimValues.support_item>0&&this.rewards.push({type:t.SUPPORT_ITEM,reward:this.claimValues.support_item})}},{key:"afterInit",value:function(){this.addHeaderTab(this.positionSetting.header)}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_giftcode)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.headerTab.addChild(this.btnBack)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addGift",value:function(){var e=this.rewards.length;for(this.txtQuest.kill(),i=0;i<e;i++)this.addClaim(this.rewards[i].type,this.rewards[i].reward,i,e)}},{key:"addClaim",value:function(e,n,i,o){var a=this,s=this.addTabResource(this.positionSetting.header,e,n);this.addChild(s),this.timeTweenBox=game.time.events.add(3*Phaser.Timer.SECOND*i,function(){var i=game.add.tween(s).to({y:a.positionSetting.header.tab_resource.y},200,Phaser.Easing.Back.Out,!1);i.start(),i.onComplete.add(function(){var i=new si(e,n,{x:355,y:47});a.addChild(i),a.timeTweenTxtRs=game.time.events.add(1.5*Phaser.Timer.SECOND,function(){if(e==t.DIAMOND){var n=game.add.tween(s.txtResource).to({text:mZ.instance().socket.mySelf.getVariable("diamond").value},500,Phaser.Easing.Back.Out,!1);n.start(),n.onUpdateCallback(function(){s.txtResource.text=parseInt(s.txtResource.text)},a)}else if(e==t.TICKET){var i=game.add.tween(s.txtResource).to({text:mZ.instance().socket.mySelf.getVariable("ticket").value},500,Phaser.Easing.Back.Out,!1);i.start(),i.onUpdateCallback(function(){s.txtResource.text=parseInt(s.txtResource.text)},a)}else if(e==t.HEART){var o=game.add.tween(s.txtResource).to({text:mZ.instance().socket.mySelf.getVariable("heart").value},500,Phaser.Easing.Back.Out,!1);o.start(),o.onUpdateCallback(function(){s.txtResource.text=parseInt(s.txtResource.text)},a)}else if(e==t.SUPPORT_ITEM){var r=game.add.tween(s.txtResource).to({text:mZ.instance().socket.mySelf.getVariable("support_item").value},500,Phaser.Easing.Back.Out,!1);r.start(),r.onUpdateCallback(function(){s.txtResource.text=parseInt(s.txtResource.text)},a)}}),a.timeTweenBoxRs=game.time.events.add(2.5*Phaser.Timer.SECOND,function(){game.add.tween(s).to({y:-100},200,Phaser.Easing.Back.Out,!1).start()})},a)}),i==o-1&&(this.timeTweenDestroy=game.time.events.add(Phaser.Timer.SECOND*o*3,function(){a.destroy()}))}},{key:"addTabResource",value:function(e,t,n){var i=new Phaser.Sprite(game,e.tab_resource.x*window.GameConfig.RESIZE,-100*window.GameConfig.RESIZE,e.tab_resource.nameAtlas,e.tab_resource.nameSprite);i.iconResourse=this.addGem(this.positionSetting.header.icon_resource,t),i.txtResource=this.addTxtGem(this.positionSetting.header.txt_resource,t,n);var o=i.iconResourse.width+i.txtResource.width;return i.txtResource.x=(i.width-o)/2-5*window.GameConfig.RESIZE,i.iconResourse.x=(i.width-o)/2+i.txtResource.width+5*window.GameConfig.RESIZE,i.addChild(i.iconResourse),i.addChild(i.txtResource),i}},{key:"addGem",value:function(e,n){var i="";return n==t.DIAMOND?i="Gem":n==t.TICKET?i="Ticket":n==t.HEART?i="Heart":n==t.SUPPORT_ITEM&&(i="Mic"),new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,i)}},{key:"addTxtGem",value:function(e,n,i){return n==t.DIAMOND?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value-i,e.configs):n==t.TICKET?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("ticket").value-i,e.configs):n==t.HEART?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("heart").value-i,e.configs):n==t.SUPPORT_ITEM?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("support_item").value-i,e.configs):void 0}},{key:"destroy",value:function(){for(game.time.events.remove(this.timeTweenBox),game.time.events.remove(this.timeTweenTxtRs),game.time.events.remove(this.timeTweenBoxRs),game.time.events.remove(this.timeTweenDestroy);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&u_(n.prototype,o),a&&u_(n,a),t}();var y_=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.amount=0,this.diamond=0,this.ticket=0,this.created=0,this.name="",this.id=0,this.expiration_date=0,this.updated=0,this.heart=0,this.support_item=0};function m_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var v_=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new y_,n=e.getSFSObject("gift_code");return t.amount=n.getInt("amount"),t.created=n.getLong("created"),t.diamond=n.getInt("diamond"),t.expiration_date=n.getLong("expiration_date"),t.heart=n.getInt("heart"),t.id=n.getLong("id"),t.name=n.getUtfString("name"),t.support_item=n.getInt("support_item"),t.ticket=n.getInt("ticket"),t.updated=n.getLong("updated"),t}}],(n=null)&&m_(t.prototype,n),i&&m_(t,i),e}();function w_(e){return(w_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function S_(e,t){return!t||"object"!==w_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function __(e){return(__=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E_(e,t){return(E_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var C_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=S_(this,__(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&E_(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.giftcode={},this.isActiveBtnSave=!0,this.addHeaderTab(this.positionSetting.header),this.txtSettingHead,this.boxText,this.txtBoxText,this.btnSave,this.tick,this.addTxtSettingHead(),this.addBoxText(),this.addTxtBoxText(),this.addBtnSave(),this.addTick()}},{key:"addTxtSettingHead",value:function(){this.txtSettingHead=new St(this.positionSetting.setting_giftcode.txt_setting_head,this.positionSetting.setting_giftcode.txt_setting_head.text),this.txtSettingHead.anchor.set(.5),this.addChild(this.txtSettingHead)}},{key:"addBoxText",value:function(){this.boxText=new pt(this.positionSetting.setting_giftcode.box_text,this.clickBoxText,this),this.boxText.anchor.set(.5),this.addChild(this.boxText)}},{key:"addBtnSave",value:function(){this.btnSave=new pt(this.positionSetting.setting_giftcode.btn_save,this.clickSave,this),this.btnSave.anchor.set(.5);var e=new St(this.positionSetting.setting_giftcode.txt_btn_save,this.positionSetting.setting_giftcode.txt_btn_save.text);e.anchor.set(.5),this.btnSave.addChild(e),this.addChild(this.btnSave)}},{key:"addTick",value:function(){this.tick=new rt(this.positionSetting.setting_giftcode.tick),this.tick.kill(),this.boxText.addChild(this.tick)}},{key:"clickBoxText",value:function(){this.tick.kill(),this.inputKeyboard()}},{key:"inputKeyboard",value:function(){this.isActiveBtnSave=!1,ce.instance().playSound(ce.buttonclick),this.boxText.kill();rl.instance().event.cancle.add(this.keyboardClose,this),rl.instance().event.enter.add(this.keyboardDone,this),rl.instance().event.submit.add(this.keyboardDone,this),rl.instance().show({maxLength:"",showTransparent:!0,placeholder:"Nhập Giftcode",isSearch:!1}),rl.instance().setValue(this.codeGift)}},{key:"keyboardClose",value:function(){this.isActiveBtnSave=!0,rl.instance().event.cancle.remove(this.keyboardClose,this),rl.instance().event.enter.remove(this.keyboardDone,this),rl.instance().event.submit.remove(this.keyboardDone,this),rl.instance().hide(),this.boxText.revive()}},{key:"keyboardDone",value:function(){this.codeGift=rl.instance().getValue(),LogConsole.log(this.codeGift),this.changeTxtBoxText(),this.keyboardClose()}},{key:"changeTxtBoxText",value:function(){this.txtBoxText.setText(this.codeGift)}},{key:"clickSave",value:function(){1==this.isActiveBtnSave&&this.sendGiftcode()}},{key:"sendGiftcode",value:function(){var e=new SFS2X.SFSObject;e.putUtfString("code",this.codeGift),mZ.instance().sendData(Et.GIFT_CODE_CLAIM_REQUEST,e)}},{key:"addTxtBoxText",value:function(){this.txtBoxText=new St(this.positionSetting.setting_giftcode.txt_box_text,"Giftcode"),this.txtBoxText.anchor.set(.5),this.boxText.addChild(this.txtBoxText)}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_giftcode)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"onExtensionResponse",value:function(e){if(e.cmd==Et.GIFT_CODE_CLAIM_RESPONSE){if("OK"==e.params.getUtfString("status")){this.giftcode=v_.begin(e.params);var t=new g_(this.giftcode);t.addGift(),this.addChild(t)}"WARNING"==e.params.getUtfString("status")&&Gn.instance().addDialog("Giftcode sai hoặc đã được sử dụng.")}}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&b_(n.prototype,i),o&&b_(n,o),t}();function k_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var P_=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("room_id",e),t}}],(n=null)&&k_(t.prototype,n),i&&k_(t,i),e}();function O_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var R_=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"ONLINE_MODE_ROOM_CREATE_REQUEST",get:function(){return"ONLINE_MODE_ROOM_CREATE_REQUEST"}},{key:"ONLINE_MODE_ROOM_CREATE_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_CREATE_RESPONSE"}},{key:"ONLINE_MODE_ROOM_LOAD_PLAYLIST_AND_BET_REQUEST",get:function(){return"ONLINE_MODE_ROOM_LOAD_PLAYLIST_AND_BET_REQUEST"}},{key:"ONLINE_MODE_ROOM_LOAD_PLAYLIST_AND_BET_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_LOAD_PLAYLIST_AND_BET_RESPONSE"}},{key:"ONLINE_MODE_ROOM_INVITE_REQUEST",get:function(){return"ONLINE_MODE_ROOM_INVITE_REQUEST"}},{key:"ONLINE_MODE_ROOM_INVITE_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_INVITE_RESPONSE"}},{key:"ONLINE_MODE_ROOM_ONLINE_USER_LIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_ONLINE_USER_LIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_ONLINE_USER_LIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_ONLINE_USER_LIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_PLAYLIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_PLAYLIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_START_GAME_REQUEST",get:function(){return"ONLINE_MODE_ROOM_START_GAME_REQUEST"}},{key:"ONLINE_MODE_ROOM_START_GAME_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_START_GAME_RESPONSE"}},{key:"ONLINE_MODE_ROOM_SERVER_QUESTIONS_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_SERVER_QUESTIONS_RESPONSE"}},{key:"ONLINE_MODE_ROOM_GAME_START",get:function(){return"ONLINE_MODE_ROOM_GAME_START"}},{key:"ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_REQUEST",get:function(){return"ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_REQUEST"}},{key:"ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_RESPONSE"}},{key:"ONLINE_MODE_ROOM_LOAD_PLAYLIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_LOAD_PLAYLIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_LOAD_PLAYLIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_LOAD_PLAYLIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_LOAD_BET_REQUEST",get:function(){return"ONLINE_MODE_ROOM_LOAD_BET_REQUEST"}},{key:"ONLINE_MODE_ROOM_LOAD_BET_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_LOAD_BET_RESPONSE"}},{key:"ONLINE_MODE_ROOM_MOVE_TO_NEXT_QUESTION",get:function(){return"ONLINE_MODE_ROOM_MOVE_TO_NEXT_QUESTION"}},{key:"ONLINE_MODE_ROOM_GAME_RESULT",get:function(){return"ONLINE_MODE_ROOM_GAME_RESULT"}},{key:"ONLINE_MODE_ROOM_GAME_FINISH",get:function(){return"ONLINE_MODE_ROOM_GAME_FINISH"}},{key:"ONLINE_MODE_ROOM_QUICK_JOIN_REQUEST",get:function(){return"ONLINE_MODE_ROOM_QUICK_JOIN_REQUEST"}},{key:"ONLINE_MODE_ROOM_QUICK_JOIN_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_QUICK_JOIN_RESPONSE"}},{key:"ONLINE_MODE_ROOM_KICK_USER_REQUEST",get:function(){return"ONLINE_MODE_ROOM_KICK_USER_REQUEST"}},{key:"ONLINE_MODE_ROOM_ONLINE_USERS_LIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_ONLINE_USERS_LIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_ONLINE_USERS_LIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_ONLINE_USERS_LIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_BE_KICKED",get:function(){return"ONLINE_MODE_ROOM_BE_KICKED"}},{key:"SUPPORT_RESPONSE",get:function(){return"SUPPORT_RESPONSE"}},{key:"SUPPORT_REQUEST",get:function(){return"SUPPORT_REQUEST"}},{key:"ONLINE_MODE_ROOM_FRIEND_LIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_FRIEND_LIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_FRIEND_LIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_FRIEND_LIST_RESPONSE"}},{key:"USER_FRIEND_LIST_LOAD_REQUEST",get:function(){return"USER_FRIEND_LIST_LOAD_REQUEST"}},{key:"USER_FRIEND_LIST_LOAD_RESPONSE",get:function(){return"USER_FRIEND_LIST_LOAD_RESPONSE"}}],(n=null)&&O_(t.prototype,n),i&&O_(t,i),e}();function x_(e){return(x_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T_(e,t,n){return(T_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I_(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function I_(e){return(I_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function L_(e,t,n){return t&&A_(e.prototype,t),n&&A_(e,n),e}function G_(e,t){return(G_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var M_=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=I_(t).call(this,game,0,0,"IconChatOnlineMode","Circle_Icon"))||"object"!==x_(o)&&"function"!=typeof o?D_(i):o).event={call_remove:new Phaser.Signal},n.idRemove=null,n.iconChat=new Phaser.Sprite(game,0,0,"IconChatOnlineMode"),n.iconChat.anchor.x=.5,n.iconChat.anchor.y=.5,n.iconChat.smoothed=!0,n.addChild(n.iconChat);var a={prefix:"",start:0,stop:0,zeroPad:5};return e===t.chenhao?(a.prefix="01_CuoiCheNhao_",a.start=0,a.stop=7):e===t.vuive?(a.prefix="02_CuoiVuiVe_",a.start=0,a.stop=9):e===t.ngaingung?(a.prefix="03_CuoiNgaiNgung_",a.start=0,a.stop=9):e===t.khoc?(a.prefix="04_Khoc_",a.start=0,a.stop=9):e===t.buon?(a.prefix="05_Buon_",a.start=0,a.stop=19):e===t.batngo?(a.prefix="06_Batngo_",a.start=0,a.stop=14):e===t.tucgian&&(a.prefix="07_Tucgian_",a.start=0,a.stop=23),n.action=n.iconChat.animations.add("playiconchat",Phaser.Animation.generateFrameNames(a.prefix,a.start,a.stop,"",a.zeroPad)),n.action.play(30,!0),n.removeIcon(),n.idRemove=game.time.events.add(2*Phaser.Timer.SECOND,n.callRemove,D_(D_(n))),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G_(e,t)}(t,Phaser.Sprite),L_(t,null,[{key:"chenhao",get:function(){return"chenhao"}},{key:"vuive",get:function(){return"vuive"}},{key:"ngaingung",get:function(){return"ngaingung"}},{key:"khoc",get:function(){return"khoc"}},{key:"buon",get:function(){return"buon"}},{key:"batngo",get:function(){return"batngo"}},{key:"tucgian",get:function(){return"tucgian"}}]),L_(t,[{key:"removeIcon",value:function(){null!==this.idRemove&&game.time.events.remove(this.idRemove)}},{key:"callRemove",value:function(){this.event.call_remove.dispatch()}},{key:"destroy",value:function(){this.removeIcon(),T_(I_(t.prototype),"destroy",this).call(this)}}]),t}();function N_(e){return(N_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function B_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function j_(e){return(j_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U_(e,t){return(U_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function F_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Z_=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=j_(t).call(this,game,null))||"object"!==N_(i)&&"function"!=typeof i?F_(n):i).event={close_dialog:new Phaser.Signal},e.positionCreateRoom=e.mainData.positionCreateRoom,e.bg=new rt(e.positionCreateRoom.chat_icon_bg),e.addChild(e.bg),e.arrType=[M_.batngo,M_.buon,M_.chenhao,M_.khoc,M_.ngaingung,M_.tucgian,M_.vuive],e.arrString=["06_Batngo","05_Buon","01_CuoiCheNhao","04_Khoc","03_CuoiNgaiNgung","07_Tucgian","02_CuoiVuiVe"];for(var o=30,a=30,s=0,r=0;r<e.arrType.length;r++){s++;var l={x:0,y:0,nameAtlas:"IconChatOnlineMode",nameSprite:"Circle_Icon",configText:{x:0,y:0,style:{fontSize:26,font:"GilroyBold"}},icon:{x:0,y:8,nameAtlas:"IconChatOnlineMode",nameSprite:e.arrString[r]},alignAll:"center"};console.log("aaaaaaaaaa ------------------"),console.log(l);var h=new ln(l,"",e.chooseItem,F_(F_(e)));h.x=o,h.y=a,h.type=e.arrType[r],o+=133,s%4==0&&(a+=135,o=30),e.addChild(h)}return e.btnClose=new pt(e.positionCreateRoom.chat_icon_btn_close,e.chooseClose,F_(F_(e))),e.addChild(e.btnClose),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U_(e,t)}(t,Mt),n=t,(i=[{key:"chooseClose",value:function(){this.event.close_dialog.dispatch()}},{key:"chooseItem",value:function(e){console.log("chooseItem---------"),console.log(e.type);var t=new SFS2X.SFSObject;t.putUtfString("typeicon",e.type),mZ.instance().sendPublicChat(Pe.CHAT_ONLINE_MODE,t),this.chooseClose()}}])&&B_(n.prototype,i),o&&B_(n,o),t}();function H_(e){return(H_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Q_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function V_(e,t){return!t||"object"!==H_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W_(e,t,n){return(W_="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=q_(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function q_(e){return(q_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K_(e,t){return(K_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var z_=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=V_(this,q_(t).call(this,game,0,0,"limitTurn",function(){},e,null,"BG_Opacity_limit_turn"))).limitTurnConfig=JSON.parse(game.cache.getText("limitTurnConfig")),n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K_(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addBg(),this.addText(),this.addBtnRemove(),this.addBtnBecomeVip()}},{key:"addBg",value:function(){this.bg=new Phaser.Sprite(game,0,0,"limitTurn","BG_Opacity_limit_turn"),this.bg.width=game.width,this.bg.height=game.height,this.addChild(this.bg)}},{key:"addText",value:function(){this.txt=new St(this.limitTurnConfig.txt_limit,this.limitTurnConfig.txt_limit.text),this.txt.position.y=-300,this.txt.anchor.set(.5);var e=new St(this.limitTurnConfig.txt_want,this.limitTurnConfig.txt_want.text);e.anchor.set(.5),this.txt.addChild(e),this.addChild(this.txt),game.add.tween(this.txt).to({y:this.limitTurnConfig.txt_limit.y},1250,Phaser.Easing.Exponential.Out,!1).start()}},{key:"addBtnRemove",value:function(){this.btnRemove=new pt(this.limitTurnConfig.btn_delete,this.onClickRemove,this),this.btnRemove.position.x=-300,this.btnRemove.anchor.set(.5);var e=new St(this.limitTurnConfig.btn_delete.txt,this.limitTurnConfig.btn_delete.txt.text);e.anchor.set(.5),this.btnRemove.addChild(e),this.addChild(this.btnRemove),game.add.tween(this.btnRemove).to({x:this.limitTurnConfig.btn_delete.x},1250,Phaser.Easing.Exponential.Out,!1).start()}},{key:"onClickRemove",value:function(){WF.instance().changeScreen(Ce.MAIN_MENU),this.destroy()}},{key:"addBtnBecomeVip",value:function(){this.btnBecomeVip=new pt(this.limitTurnConfig.btn_vip,this.onClickBecomeVip,this),this.btnBecomeVip.position.x=game.width+300,this.btnBecomeVip.anchor.set(.5);var e=new St(this.limitTurnConfig.btn_vip.txt,this.limitTurnConfig.btn_vip.txt.text);e.anchor.set(.5),this.btnBecomeVip.addChild(e),this.addChild(this.btnBecomeVip),game.add.tween(this.btnBecomeVip).to({x:this.limitTurnConfig.btn_vip.x},1250,Phaser.Easing.Exponential.Out,!1).start()}},{key:"onClickBecomeVip",value:function(){}},{key:"destroy",value:function(){W_(q_(t.prototype),"destroy",this).call(this)}}])&&Q_(n.prototype,i),o&&Q_(n,o),t}();function Y_(e){return(Y_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function X_(e){return(X_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $_(e,t){return($_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var tE=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=X_(t).call(this,game,0,0,""))||"object"!==Y_(i)&&"function"!=typeof i?eE(n):i).event={close:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.bg=new rt(e.positionPopup.popup_suggets_rating_bg),e.addChild(e.bg),e.btnVoteSau=new ln(e.positionPopup.popup_suggets_rating_btn_votesau,"VOTE SAU",e.chooseVoteSau,eE(eE(e))),e.addChild(e.btnVoteSau),e.btnVoteNgay=new ln(e.positionPopup.popup_suggets_rating_btn_votengay,"VOTE NGAY",e.chooseVoteNgay,eE(eE(e))),e.addChild(e.btnVoteNgay),e.btnClose=new pt(e.positionPopup.popup_suggets_rating_btn_close,e.chooseClose,eE(eE(e))),e.addChild(e.btnClose),e.txt1=new St(e.positionPopup.popup_suggets_rating_lb1,"Hãy ủng hộ chúng mình nhé!"),e.txt1.x=(e.bg.width-e.txt1.width)/2,e.addChild(e.txt1),e.txt2=new St(e.positionPopup.popup_suggets_rating_lb2,"Bạn có yêu thích Wazzat không?"),e.txt2.x=(e.bg.width-e.txt2.width)/2,e.addChild(e.txt2),Le.instance().logEvent(Le.SuggetRatingShow),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$_(e,t)}(t,Mt),n=t,(i=[{key:"chooseVoteSau",value:function(){LogConsole.log("chooseVoteSau"),Qr.instance().setItem(Qr.VOTE,"VoteSau"),Le.instance().logEvent(Le.SuggetRatingVoteSau),this.event.close.dispatch()}},{key:"chooseVoteNgay",value:function(){LogConsole.log("chooseVoteNgay"),Qr.instance().setItem(Qr.VOTE,"VoteNgay"),"and"===z.instance().platform?window.open(window.RESOURCE.android_storage_link):"ios"===z.instance().platform&&window.open(window.RESOURCE.ios_storage_link),Le.instance().logEvent(Le.SuggetRatingVoteNgay),this.event.close.dispatch()}},{key:"chooseClose",value:function(){LogConsole.log("chooseClose"),Qr.instance().setItem(Qr.VOTE,"Close"),Le.instance().logEvent(Le.SuggetRatingClose),this.event.close.dispatch()}}])&&J_(n.prototype,i),o&&J_(n,o),t}();function nE(e){return(nE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oE(e){return(oE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aE(e,t){return(aE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var rE=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=oE(t).call(this,game,null))||"object"!==nE(i)&&"function"!=typeof i?sE(n):i).event={close:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.item=new tE,e.item.event.close.add(e.chooseClose,sE(sE(e))),e.item.x=35*z.instance().scale,e.item.y=game.height+237*z.instance().scale,e.addChild(e.item),e.tweenItemPopup(e.item,game.height-850*z.instance().scale),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aE(e,t)}(t,Mt),n=t,(i=[{key:"chooseClose",value:function(){this.event.close.dispatch()}}])&&iE(n.prototype,i),o&&iE(n,o),t}();function lE(e){return(lE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cE(e,t){return!t||"object"!==lE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uE(e){return(uE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dE(e,t){return(dE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fE=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=cE(this,uE(t).call(this,game))).positionLoadConfig=JSON.parse(game.cache.getText("positionLoadConfig")),n.messenger=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.ava,this.name,this.from,this.time,this.ava=new rt(this.positionLoadConfig.mail_system.mailDetail.ava),this.addChild(this.ava),this.name=new St(this.positionLoadConfig.mail_system.mailDetail.name,this.positionLoadConfig.mail_system.mailDetail.name.text),this.addChild(this.name),this.from=new St(this.positionLoadConfig.mail_system.mailDetail.from,this.positionLoadConfig.mail_system.mailDetail.from.text),this.addChild(this.from);var e=new Date;e.setTime(this.messenger.created);var t=e.getSeconds(),n=e.getMinutes(),i=e.getHours(),o=e.getFullYear(),a=e.getMonth(),s=e.getDate();this.time=new St(this.positionLoadConfig.mail_system.mailDetail.time,"".concat(o,"-").concat(a,"-").concat(s," ").concat(i,":").concat(n,":").concat(t)),this.addChild(this.time)}},{key:"height",get:function(){return 131*window.GameConfig.RESIZE}}])&&hE(n.prototype,i),o&&hE(n,o),t}();function pE(e){return(pE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yE(e,t){return!t||"object"!==pE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mE(e){return(mE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vE(e,t){return(vE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wE=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=yE(this,mE(t).call(this,game))).positionLoadConfig=JSON.parse(game.cache.getText("positionLoadConfig")),n.data=e,n.eventClickBtn=new Phaser.Signal,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.txtDes,this.btn,this.addTxtDes(),this.addBtn()}},{key:"addTxtDes",value:function(){this.txtDes=new St(this.positionLoadConfig.system_btn_link.text,this.data.description),this.addChild(this.txtDes)}},{key:"addBtn",value:function(){this.btn=new pt(this.positionLoadConfig.system_btn_link,this.onClick,this);var e={x:this.btn.x+15,y:this.btn.y+15,text:"EMAIL",style:{font:"GilroyBold",fill:"#bfbec4",fontSize:24,align:"center"}},t=new St(e,this.data.name.toUpperCase());this.btn.width=t.width+30,this.addChild(this.btn),this.addChild(t)}},{key:"onClick",value:function(){this.eventClickBtn.dispatch(this.data)}},{key:"height",get:function(){return 151}}])&&gE(n.prototype,i),o&&gE(n,o),t}();function bE(e){return(bE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _E(e,t){return!t||"object"!==bE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function EE(e){return(EE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CE(e,t){return(CE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kE=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=_E(this,EE(t).call(this,game))).positionLoadConfig=JSON.parse(game.cache.getText("positionLoadConfig")),n.messengerId=e,n.messenger,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.bg,this.headerTab,this.title,this.inforSystem,this.detail,this.addBG(),this.addHeaderTab(),this.ajaxGetNotiDetail(),this.addEventExtension()}},{key:"ajaxGetNotiDetail",value:function(){this.detailMessageCallback(Pl.instance().seeNoticeSystem(this.messengerId,z.instance().systemMessagesLocal.dataMessages))}},{key:"detailMessageCallback",value:function(e){if(this.dataControls=[],this.messenger=e,null!==this.messenger.control){var t=JSON.parse(this.messenger.control);for(var n in t)this.dataControls.push(t[n])}this.addTitle(),this.addListView(),this.addInforSystem(),this.addDetailMessage(),this.addButtonLink(),this.markAsRead()}},{key:"addBG",value:function(){this.bg=new Phaser.Button(game,0,0,this.positionLoadConfig.mail_system.bg.nameSprite),this.addChild(this.bg)}},{key:"addHeaderTab",value:function(){this.headerTab=new rt(this.positionLoadConfig.mail_system.header.tab),this.addChild(this.headerTab),this.btnBack,this.emailTxt,this.btnBack=new pt(this.positionLoadConfig.mail_system.header.btn_back,this.onClickBack,this),this.btnBack.anchor.set(.5),this.addChild(this.btnBack),this.emailTxt=new St(this.positionLoadConfig.mail_system.header.txt_email,this.positionLoadConfig.mail_system.header.txt_email.text),this.emailTxt.anchor.set(.5),this.addChild(this.emailTxt)}},{key:"onClickBack",value:function(){De.instance().event.backSystemChat.dispatch(),this.destroy()}},{key:"addTitle",value:function(){this.title=new St(this.positionLoadConfig.mail_system.title,this.messenger.title),this.addChild(this.title),this.lineUnder,this.lineUnder=new rt(this.positionLoadConfig.mail_system.line_under),this.lineUnder.y+=this.title.y+this.title.height,this.addChild(this.lineUnder)}},{key:"addListView",value:function(){this.group=new Phaser.Group(game),this.addChild(this.group);var e=new Phaser.Rectangle(0,this.lineUnder.y+2,game.width,(game.height-253)*window.GameConfig.RESIZE);this.listView=new Jo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}},{key:"addInforSystem",value:function(){this.inforSystem=new fE(this.messenger),this.listView.add(this.inforSystem)}},{key:"addDetailMessage",value:function(){this.detail=new St(this.positionLoadConfig.mail_system.detailMessage,this.messenger.message);var e=new Phaser.Sprite(game,0,this.detail.height+25,"mailSprites","line_line");this.detail.addChild(e),this.listView.add(this.detail)}},{key:"addButtonLink",value:function(){for(var e=0;e<this.dataControls.length;e++)if("ios"!==z.instance().platform&&void 0!==this.dataControls[e].link){var t=new wE(this.dataControls[e]);t.eventClickBtn.add(this.eventClickBtn,this),this.listView.add(t)}}},{key:"markAsRead",value:function(){0==this.messenger.is_read&&(Pl.instance().sendSystemMarkAsRead(this.messengerId),Pl.instance().systemMarkAsRead(this.messengerId,z.instance().systemMessagesLocal.dataMessages))}},{key:"eventClickBtn",value:function(e){window.open(e.link,"_blank")}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onClickBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onClickBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&SE(n.prototype,i),o&&SE(n,o),t}();function PE(e){return(PE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function RE(e,t){return!t||"object"!==PE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xE(e,t,n){return(xE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TE(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TE(e){return(TE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IE(e,t){return(IE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var AE=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=RE(this,TE(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),e.signalBtn=new Phaser.Signal,e.typeRsr=n,e.confirmWatchVideoReward=!1,e.timeWait=0,e.timerToCountTime=null,e.popup=null,e.btnWatch=null,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IE(e,t)}(t,Phaser.Group),n=t,o=[{key:"TICKET",get:function(){return"TICKET"}},{key:"HEART",get:function(){return"HEART"}}],(i=[{key:"addEventExtension",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this),li.instance().event.rewardedVideoClosed.add(this.rewardedVideoClosed,this)}},{key:"removeEventExtension",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.remove(this.rewardedVideoFailed,this),li.instance().event.rewardedVideoClosed.remove(this.rewardedVideoClosed,this)}},{key:"rewardedVideoRewardReceived",value:function(e){this.confirmWatchVideoReward=!0;var t=e.placement;t.name,t.amount,t.reward}},{key:"rewardedVideoFailed",value:function(){console.log("GGGGGGGGGAAA")}},{key:"rewardedVideoClosed",value:function(){if(1==this.confirmWatchVideoReward){var e=0,n=0,i="";this.typeRsr==t.HEART?(e=this.rsrPkgs.heart.id,n=this.rsrPkgs.heart.quantity,i=this.rsrPkgs.heart.resource_type):(e=this.rsrPkgs.ticket.id,n=this.rsrPkgs.ticket.quantity,i=this.rsrPkgs.ticket.resource_type),mZ.instance().sendData(Js.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_REQUEST,_w.begin(e,n,i))}else qe.instance().hideLoading()}},{key:"afterInit",value:function(){qe.instance().showLoading(),this.botSprite=new Phaser.Sprite(game,0,0,null),this.addChild(this.botSprite),this.topSprite=new Phaser.Sprite(game,0,0,null),this.addChild(this.topSprite),this.screenDim,this.tabGem,this.tabHeart,this.popup,this.addScreenDim(),this.typeRsr!=t.HEART&&null!=this.typeRsr||this.addGemAndHeart(),this.addEventExtension(),null===z.instance().dataPackage?"ios"===z.instance().platform?jv.instance().getDataInapp():Fv.instance().getDataInapp():this.handlePackage()}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.botSprite.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.botSprite.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.botSprite.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),this.txtGem=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().dataMySeft.diamond,this.positionPracticePopupConfig.gem_reward_txt.configs);var t=e.width+this.txtGem.width;this.txtGem.x=(this.tabGem.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-t)/2+this.txtGem.width+5*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(this.txtGem)}},{key:"addHeartDetail",value:function(){var e;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),this.txtHeart=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,mZ.instance().dataMySeft.heart,this.positionPracticePopupConfig.heart_reward_txt.configs);var t=e.width+this.txtHeart.width;this.txtHeart.x=(this.tabHeart.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-t)/2+this.txtHeart.width+5*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(this.txtHeart)}},{key:"addPopup",value:function(){null!==this.popup?(this.removeBtnWatch(),this.addBtnWatch(),this.checkConfirmAds()):(this.removePopup(),this.txtMainPopup,this.txtQuestPopup,this.popup=new Phaser.Sprite(game,35,1140,"dailyRewardSprites","Box"),this.addIconCamera(),this.addBtnWatch(),this.addBtnBuy(),this.addTxtMainPopup(),this.addTxtQuestPopup(),this.addBtnClose(),this.botSprite.addChild(this.popup),this.makeTweenPopup(),this.checkConfirmAds())}},{key:"removePopup",value:function(){null!==this.popup&&(this.botSprite.removeChild(this.popup),this.popup.destroy(),this.popup=null)}},{key:"removeBtnWatch",value:function(){null!==this.btnWatch&&(this.popup.removeChild(this.btnWatch),this.btnWatch.destroy(),this.btnWatch=null)}},{key:"addIconCamera",value:function(){this.icon=new Phaser.Sprite(game,285,42,"dailyRewardSprites","Camera"),this.icon.anchor.set(.5,0),this.popup.addChild(this.icon)}},{key:"addBtnWatch",value:function(){this.btnWatch=new Phaser.Button(game,414,379,"dailyRewardSprites",this.onWatch,this,null,"Button_Xem"),this.btnWatch.anchor.set(.5),"web"===z.instance().platform&&(this.btnWatch.alpha=.5,this.btnWatch.inputEnabled=!1),this.txtBtnWatch=new Phaser.Text(game,0,0,"XEM",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:35}),this.txtBtnWatch.anchor.set(.5),this.txtCountBtnWatch=new Phaser.Text(game,0,23,"",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:18}),this.txtCountBtnWatch.anchor.set(.5),this.btnWatch.addChild(this.txtBtnWatch),this.btnWatch.addChild(this.txtCountBtnWatch),this.popup.addChild(this.btnWatch)}},{key:"addBtnBuy",value:function(){this.btnBuy=new Phaser.Button(game,156,379,"dailyRewardSprites",this.onBuy,this,null,"Button_Mua"),this.btnBuy.anchor.set(.5),this.txtBtnBuy=new Phaser.Text(game,0,0,"MUA",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:35}),this.txtBtnBuy.anchor.set(.5),this.btnBuy.addChild(this.txtBtnBuy),this.popup.addChild(this.btnBuy)}},{key:"onWatch",value:function(){ce.instance().playSound(ce.buttonclick),qe.instance().showLoading(),li.instance().showRewardVideoInappPurchase(this.typeRsr)}},{key:"getData",value:function(e){switch(e.cmd){case Js.RESOURCE_PACKAGE_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&(z.instance().dataPackage=e.params,this.handlePackage());break;case Js.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE:"OK"===e.params.getUtfString("status")&&(this.animClaim(),z.instance().dataPackage=null,"ios"===z.instance().platform?jv.instance().getDataInapp():Fv.instance().getDataInapp(),qe.instance().hideLoading())}}},{key:"onBuy",value:function(){ce.instance().playSound(ce.buttonclick),iC.instance().addShop(1,pw.HEART),this.destroy()}},{key:"addTxtMainPopup",value:function(){var e="";e=this.typeRsr==t.HEART?this.positionPracticePopupConfig.txtNotEnoughHeart.text:this.positionPracticePopupConfig.txtNotEnoughTicket.text,this.txtMainPopup=new Phaser.Text(game,this.positionPracticePopupConfig.txtNotEnoughHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txtNotEnoughHeart.y*window.GameConfig.RESIZE,e,this.positionPracticePopupConfig.txtNotEnoughHeart.configs),this.txtMainPopup.anchor.set(.5,0),this.popup.addChild(this.txtMainPopup)}},{key:"addTxtQuestPopup",value:function(){var e="";e=this.typeRsr==t.HEART?this.positionPracticePopupConfig.txtQuestNotEnoughHeart.text:this.positionPracticePopupConfig.txtQuestNotEnoughTicket.text,this.txtQuestPopup=new Phaser.Text(game,this.positionPracticePopupConfig.txtQuestNotEnoughHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txtQuestNotEnoughHeart.y*window.GameConfig.RESIZE,e,this.positionPracticePopupConfig.txtQuestNotEnoughHeart.configs),this.txtQuestPopup.anchor.set(.5,0),this.popup.addChild(this.txtQuestPopup)}},{key:"addBtnClose",value:function(){this.btnClose=new Phaser.Button(game,536,-29,"dailyRewardSprites",this.onClose,this,null,"Button_Exit"),this.popup.addChild(this.btnClose)}},{key:"onClose",value:function(){ce.instance().playSound(ce.buttonclick),this.destroy()}},{key:"makeTweenPopup",value:function(){game.add.tween(this.popup).to({y:(game.height-830)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Bounce.Out,!1).start()}},{key:"removeTabGemAndTabHeart",value:function(){this.tabGem.destroy(),this.tabHeart.destroy()}},{key:"handlePackage",value:function(){this.rsrPkgs={heart:{},ticket:{}};for(var e=z.instance().dataPackage.getSFSArray("resource_packages"),t=0;t<e.size();t++){var n=e.getSFSObject(t);if("HEART"==n.getUtfString("resource_type")&&"ADS"==n.getUtfString("price_type")){var i=n.getUtfString("pack_name"),o=n.getInt("sale"),a=n.getInt("quantity"),s=n.getUtfString("payment_service"),r=n.getInt("price"),l=n.getUtfString("name"),h=n.getUtfString("resource_type"),c=n.getUtfString("price_type"),u=n.getInt("active"),d=n.getLong("next_watched_at"),f=n.getInt("id"),p=n.getBool("is_allow_watch");this.rsrPkgs.heart={pack_name:i,sale:o,quantity:a,payment_service:s,price:r,name:l,resource_type:h,price_type:c,active:u,id:f,is_allow_watch:p,next_watched_at:d}}if("HEART"==n.getUtfString("resource_type")&&"ADS"==n.getUtfString("price_type")){var g=n.getUtfString("pack_name"),y=n.getInt("sale"),m=n.getInt("quantity"),v=n.getUtfString("payment_service"),w=n.getInt("price"),b=n.getUtfString("name"),S=n.getUtfString("resource_type"),_=n.getUtfString("price_type"),E=n.getInt("active"),C=n.getInt("id"),k=n.getLong("next_watched_at"),P=n.getBool("is_allow_watch");this.rsrPkgs.ticket={pack_name:g,sale:y,quantity:m,payment_service:v,price:w,name:b,resource_type:S,price_type:_,active:E,id:C,is_allow_watch:P,next_watched_at:k}}}qe.instance().hideLoading(),this.addPopup()}},{key:"checkConfirmAds",value:function(){"HEART"==this.typeRsr?1==this.rsrPkgs.heart.is_allow_watch?(this.btnWatch.inputEnabled=!0,this.btnWatch.alpha=1):(this.timeWait=parseInt((this.rsrPkgs.heart.next_watched_at-(new Date).getTime())/1e3),this.changeTxtBtnAds()):this.rsrPkgs.ticket.is_allow_watch}},{key:"changeTxtBtnAds",value:function(){this.timeWait>0?(this.btnWatch.inputEnabled=!1,this.btnWatch.alpha=.7,this.txtBtnWatch.y=-5,this.stopCountTime(),this.timerToCountTime=game.time.create(!0),this.timerToCountTime.loop(1e3,this.onTimerToCountTime,this),this.timerToCountTime.start(),this.setTextTimer()):"web"===z.instance().platform?(this.btnWatch.alpha=.5,this.btnWatch.inputEnabled=!1):(this.btnWatch.inputEnabled=!0,this.btnWatch.alpha=1,this.txtBtnWatch.y=0)}},{key:"onTimerToCountTime",value:function(){this.timeWait=this.timeWait-1,this.timeWait<0&&(this.timeWait=0),0===this.timeWait?(this.stopCountTime(),qe.instance().showLoading(),z.instance().dataPackage=null,"ios"===z.instance().platform?jv.instance().getDataInapp():Fv.instance().getDataInapp()):this.setTextTimer()}},{key:"setTextTimer",value:function(){var e,t="",n=parseInt(this.timeWait/3600),i=0,o=0;n>0?(t=n>9?n+":":"0"+n+":",i=parseInt(this.timeWait%3600/60),o=this.timeWait-(3600*n+60*i)):(i=parseInt(this.timeWait/60),o=this.timeWait%60),e="( "+t+(i>9?i+":":"0"+i+":")+(o>9?o+"":"0"+o)+" )",this.txtCountBtnWatch.setText(e)}},{key:"animClaim",value:function(){var e={x:0,y:0};if("HEART"==this.typeRsr?(e.x=this.positionPracticePopupConfig.tabHeart.x+100,e.y=this.positionPracticePopupConfig.tabHeart.y+25):"TICKET"==this.typeRsr&&(e.x=0,e.y=0),this.typeRsr==t.HEART){var n=new si(this.typeRsr,5,e);this.topSprite.addChild(n);var i=game.add.tween(this.txtHeart).to({text:mZ.instance().dataMySeft.heart},300,"Linear",!1);this.tweenTxtRsr(i,this.txtHeart)}}},{key:"tweenTxtRsr",value:function(e,t){var n=this;this.timeStartTween=game.time.events.add(2*Phaser.Timer.SECOND,function(){e.start()},this),e.onUpdateCallback(function(){t.text=parseInt(t.text)},this),e.onComplete.add(function(){window.cordova&&"undefined"!=typeof device?(n.isWatchRewardVideo,n.tweenDestroy()):n.tweenDestroy()},this)}},{key:"tweenDestroy",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-1200*window.GameConfig.RESIZE},200,"Linear",!1);this.timeTweenDestroy=game.time.events.add(1*Phaser.Timer.SECOND,function(){t.start()},this),t.onComplete.add(function(){e.destroy()},this)}},{key:"stopCountTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy(),game.time.events.remove(this.timerToCountTime),this.timerToCountTime=null)}},{key:"destroy",value:function(){this.stopCountTime(),this.removeEventExtension(),xE(TE(t.prototype),"destroy",this).call(this)}}])&&OE(n.prototype,i),o&&OE(n,o),t}();function LE(e){return(LE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function DE(e,t){return!t||"object"!==LE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ME(e){return(ME=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NE(e,t){return(NE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var BE=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=DE(this,ME(t).call(this,game))).x=e,o.y=n,o.positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),o.user=i,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.avatar,this.frame,this.name,this.levelTitle,this.frame=new Phaser.Sprite(game,-5,-5,"playSprites","Khung_Ava_Thuong"),this.frame.width=130,this.frame.height=130,this.addChild(this.frame),this.avatar=new Phaser.Sprite(game,0,0,"otherSprites","ava-default"),this.avatar.width=120,this.avatar.height=120,this.maskAva=new Phaser.Graphics(game,this.avatar.width/2,this.avatar.width/2),this.maskAva.beginFill(),this.maskAva.drawCircle(0,0,this.avatar.width),this.addChild(this.maskAva),this.avatar.mask=this.maskAva,this.addChild(this.avatar),this.name=new Phaser.Text(game,this.positionWinConfig.last_week_screen.user_name.x,this.positionWinConfig.last_week_screen.user_name.y,this.user.userName,this.positionWinConfig.last_week_screen.user_name.configs),this.name.anchor.set(.5,0),this.addChild(this.name),this.levelTitle=new Phaser.Text(game,this.positionWinConfig.last_week_screen.level_title.x,this.positionWinConfig.last_week_screen.level_title.y,this.user.level_title,this.positionWinConfig.last_week_screen.level_title.configs),this.levelTitle.anchor.set(.5,0),this.addChild(this.levelTitle),""!==this.user.avatar&&this.loadAva()}},{key:"loadAva",value:function(){if(game.cache.checkImageKey(this.user.avatar))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.user.avatar,this.user.avatar),e.start()}}},{key:"loadStart",value:function(){}},{key:"onLoad",value:function(){try{game.cache.checkImageKey(this.user.avatar)&&(""!==this.user.avatar?this.avatar.loadTexture(this.user.avatar):this.avatar.loadTexture("otherSprites","ava-default"))}catch(e){}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&GE(n.prototype,i),o&&GE(n,o),t}();function jE(e){return(jE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function FE(e,t){return!t||"object"!==jE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZE(e){return(ZE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HE(e,t){return(HE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var QE=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=FE(this,ZE(t).call(this,game))).x=245,n.y=244,n.positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.user=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.avatar,this.frame,this.name,this.levelTitle,this.frame=new Phaser.Sprite(game,-6,-24,"playSprites","ava"),this.addChild(this.frame),this.avatar=new Phaser.Sprite(game,0,10,"otherSprites","ava-default"),this.avatar.width=140,this.avatar.height=140,this.maskAva=new Phaser.Graphics(game,this.avatar.x+this.avatar.width/2,this.avatar.y+this.avatar.width/2),this.maskAva.beginFill(),this.maskAva.drawCircle(0,0,this.avatar.width),this.addChild(this.maskAva),this.avatar.mask=this.maskAva,this.addChild(this.avatar),this.name=new Phaser.Text(game,this.positionWinConfig.last_week_screen.user_name_win.x,this.positionWinConfig.last_week_screen.user_name_win.y,this.user.userName,this.positionWinConfig.last_week_screen.user_name_win.configs),this.name.anchor.set(.5,0),this.addChild(this.name),this.levelTitle=new Phaser.Text(game,this.positionWinConfig.last_week_screen.level_title_win.x,this.positionWinConfig.last_week_screen.level_title_win.y,this.user.level_title,this.positionWinConfig.last_week_screen.level_title_win.configs),this.levelTitle.anchor.set(.5,0),this.addChild(this.levelTitle),""!==this.user.avatar&&this.loadAva()}},{key:"loadAva",value:function(){if(game.cache.checkImageKey(this.user.avatar))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.user.avatar,this.user.avatar),e.start()}}},{key:"loadStart",value:function(){}},{key:"onLoad",value:function(){try{game.cache.checkImageKey(this.user.avatar)&&(""!==this.user.avatar?this.avatar.loadTexture(this.user.avatar):this.avatar.loadTexture("otherSprites","ava-default"))}catch(e){}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&UE(n.prototype,i),o&&UE(n,o),t}();function VE(e){return(VE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qE(e,t){return!t||"object"!==VE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KE(e){return(KE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zE(e,t){return(zE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var YE=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=qE(this,KE(t).call(this,game))).opponent=n,e.positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),e.lastWeekResult=null,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtensions(),this.addHeader(),this.addFundaMetal(),this.sendRequestLastWeekResult()}},{key:"sendRequestLastWeekResult",value:function(){qe.instance().showLoading();var e=new SFS2X.SFSObject;e.putInt("opponent_id",this.opponent.id),mZ.instance().sendData(Et.TURNBASE_LAST_WEEK_RESULT_REQUEST,e)}},{key:"addHeader",value:function(){this.headerTab=new Phaser.Sprite(game,this.positionWinConfig.header.tab.x,this.positionWinConfig.header.tab.y,this.positionWinConfig.header.tab.nameAtlas,this.positionWinConfig.header.tab.nameSprite),this.addChild(this.headerTab),this.btnBack=new Phaser.Button(game,this.positionWinConfig.header.back.x,this.positionWinConfig.header.back.y,this.positionWinConfig.header.back.nameAtlas,this.onBack,this,null,this.positionWinConfig.header.back.nameSprite),this.headerTab.addChild(this.btnBack),this.txtHeader=new Phaser.Text(game,this.positionWinConfig.header.txt.x,this.positionWinConfig.header.txt.y,this.positionWinConfig.header.txt.text,this.positionWinConfig.header.txt.configs),this.txtHeader.anchor.set(.5,0),this.headerTab.addChild(this.txtHeader)}},{key:"addFundaMetal",value:function(){this.txtScore,this.vsIcon,this.btnShare,this.boxScore,this.txtScore=new Phaser.Text(game,this.positionWinConfig.last_week_screen.txt_score.x,this.positionWinConfig.last_week_screen.txt_score.y,this.positionWinConfig.last_week_screen.txt_score.text,this.positionWinConfig.last_week_screen.txt_score.configs),this.txtScore.anchor.set(.5,0),this.addChild(this.txtScore),this.boxScore=new Phaser.Sprite(game,this.positionWinConfig.last_week_screen.box_score.x,this.positionWinConfig.last_week_screen.box_score.y,this.positionWinConfig.last_week_screen.box_score.nameAtlas,this.positionWinConfig.last_week_screen.box_score.nameSprite),this.boxScore.anchor.set(.5),this.addChild(this.boxScore),this.vsIcon=new Phaser.Sprite(game,this.positionWinConfig.last_week_screen.vs.x,this.positionWinConfig.last_week_screen.vs.y,this.positionWinConfig.last_week_screen.vs.nameAtlas,this.positionWinConfig.last_week_screen.vs.nameSprite),this.vsIcon.anchor.set(.5);var e=new Phaser.Text(game,this.positionWinConfig.last_week_screen.txt_vs.x,this.positionWinConfig.last_week_screen.txt_vs.y,this.positionWinConfig.last_week_screen.txt_vs.text,this.positionWinConfig.last_week_screen.txt_vs.configs);e.anchor.set(.5),this.vsIcon.addChild(e),this.addChild(this.vsIcon),this.btnShare=new Phaser.Button(game,this.positionWinConfig.last_week_screen.btn_share.x,this.positionWinConfig.last_week_screen.btn_share.y,this.positionWinConfig.last_week_screen.btn_share.nameAtlas,this.onClickShare,this,null,this.positionWinConfig.last_week_screen.btn_share.nameSprite),this.btnShare.anchor.set(.5);var t=new Phaser.Text(game,this.positionWinConfig.last_week_screen.btn_share.txt.x,this.positionWinConfig.last_week_screen.btn_share.txt.y,this.positionWinConfig.last_week_screen.btn_share.txt.text,this.positionWinConfig.last_week_screen.btn_share.txt.configs);t.anchor.set(0,.5),this.btnShare.addChild(t),this.addChild(this.btnShare)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),De.instance().event.backLastWeek.dispatch(),this.destroy()}},{key:"onClickShare",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"onExtensionResponse",value:function(e){if(e.cmd==Et.TURNBASE_LAST_WEEK_RESULT_RESPONSE&&"OK"==e.params.getUtfString("status")){var t=e.params.getSFSObject("last_week_result"),n=t.getInt("user_won"),i=t.getInt("opponent_won"),o={level:0,level_title:"",is_online:!1};if(t.containsKey("opponent_info")){var a=t.getSFSObject("opponent_info");o.level=a.getInt("level"),o.level_title=a.getUtfString("level_title"),o.is_online=a.getBool("is_online")}this.lastWeekResult={user_won:n,opponent_won:i,opponent_info:o},this.opponent.level_title=o.level_title,this.showResult()}}},{key:"showResult",value:function(){this.scorePoint,this.userSprite,this.opponentSprite,this.scorePoint=new Phaser.Text(game,this.positionWinConfig.last_week_screen.score_point.x,this.positionWinConfig.last_week_screen.score_point.y,"".concat(this.lastWeekResult.opponent_won," - ").concat(this.lastWeekResult.user_won),this.positionWinConfig.last_week_screen.score_point.configs),this.scorePoint.anchor.set(.5),this.boxScore.addChild(this.scorePoint),this.circle=new Phaser.Sprite(game,320,320,"playSprites","Light"),this.circle.anchor.set(.5),this.tweenCircle=game.add.tween(this.circle).to({angle:359},2e3,"Linear",!0,0,-1,!1),this.tweenCircle.start(),this.addChild(this.circle),this.userSprite=new BE(395,734,{id:mZ.instance().dataMySeft.user_id,userName:mZ.instance().dataMySeft.user_name,avatar:mZ.instance().dataMySeft.avatar,is_online:!0,level_title:mZ.instance().dataMySeft.level_title}),this.opponentSprite=new BE(125,734,this.opponent),this.addChild(this.userSprite),this.addChild(this.opponentSprite),this.addCongrat(),qe.instance().hideLoading()}},{key:"addCongrat",value:function(){this.lastWeekResult.user_won>this.lastWeekResult.opponent_won?(this.addTxtWhoWin(),this.userWin=new QE({id:mZ.instance().dataMySeft.user_id,userName:mZ.instance().dataMySeft.user_name,avatar:mZ.instance().dataMySeft.avatar,is_online:!0,level_title:mZ.instance().dataMySeft.level_title}),this.addChild(this.userWin)):this.lastWeekResult.user_won==this.lastWeekResult.opponent_won?this.addTxtDeuce():(this.addTxtWhoWin(),this.userWin=new QE(this.opponent),this.addChild(this.userWin)),this.addFirework()}},{key:"addTxtWhoWin",value:function(){this.txtWhoWin=new Phaser.Text(game,this.positionWinConfig.last_week_screen.txt_who_win.x,this.positionWinConfig.last_week_screen.txt_who_win.y,this.positionWinConfig.last_week_screen.txt_who_win.text,this.positionWinConfig.last_week_screen.txt_who_win.configs),this.txtWhoWin.anchor.set(.5,0),this.addChild(this.txtWhoWin)}},{key:"addTxtDeuce",value:function(){this.txtDeuce=new Phaser.Sprite(game,this.positionWinConfig.last_week_screen.deuce.x,this.positionWinConfig.last_week_screen.deuce.y,this.positionWinConfig.last_week_screen.deuce.nameAtlas,this.positionWinConfig.last_week_screen.deuce.nameSprite),this.txtDeuce.anchor.set(.5),this.addChild(this.txtDeuce)}},{key:"addFirework",value:function(){this.fireWork=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,210*window.GameConfig.RESIZE,"firework"),this.fireWork.anchor.set(.5),this.fireWork.scale.set(1.3),this.addChild(this.fireWork);this.fireWork.animations.add("run_firework");this.fireWork.animations.play("run_firework",30,!0)}},{key:"addEventExtensions",value:function(){mZ.instance().events.onExtensionResponse.add(this.onExtensionResponse,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtensions",value:function(){mZ.instance().events.onExtensionResponse.remove(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtensions(),this.tweenCircle&&this.tweenCircle.stop();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&WE(n.prototype,i),o&&WE(n,o),t}();function JE(e){return(JE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XE(e,t){return!t||"object"!==JE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $E(e){return($E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tC(e,t,n){return t&&eC(e.prototype,t),n&&eC(e,n),e}function nC(e,t){return(nC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=XE(this,$E(t).call(this,game))).event={change_turnbase:new Phaser.Signal,change_menu:new Phaser.Signal,change_value_resource:new Phaser.Signal},e.badConnection=null,e.popupBuy=null,e.popupMoney=null,e.detail=null,e.levelUp=null,e.popupBuyDone=null,e.detailSong=null,e.inviteFriend=null,e.dialog=null,e.dialogConfirmMoney=null,e.dialogConfirmTicket=null,e.shop=null,e.sortShop=null,e.qAndAPopup=null,e.popupClaimQuest=null,e.userProfile=null,e.ranking=null,e.chatOnlineMode=null,e.turnbase=null,e.animClaimReward=null,e.achievedNotification=null,e.chatScreen=null,e.popupShortUserProfile=null,e.dailyReward=null,e.dailyRewardPopup=null,e.soloModeRankingClaimPopup=null,e.screenTimeout=null,e.screenLosePopup=null,e.screenReward=null,e.screenNotReward=null,e.screenDoneSoloMode=null,e.animClaimReward=null,e.questClaimPopup=null,e.achievementClaimPopup=null,e.dailyrewardPopup=null,e.chatScreen=null,e.settingScreen=null,e.settingGameScreen=null,e.settingAccountScreen=null,e.settingAccountUserNameScreen=null,e.settingProfileScreen=null,e.popupBuyItemConfirm=null,e.textScroll=null,e.settingGiftcode=null,e.limitTurn=null,e.suggetRating=null,e.mailSystemScreen=null,e.popupNotEnoughResource=null,e.lastWeekResultScreen=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nC(e,t)}(t,Phaser.Group),tC(t,[{key:"buyItem",value:function(e){mZ.instance().dataMySeft.diamond<e.price?this.addPopupMoney(e):this.addPopupBuy(e)}},{key:"addPopupBuyDone",value:function(e){this.removePopupBuyDone(),this.popupBuyDone=new vc(e),this.popupBuyDone.event.OK.add(this.chooseBuyDoneOk,this),this.addChild(this.popupBuyDone)}},{key:"chooseBuyDoneOk",value:function(){this.removePopupBuyDone()}},{key:"removePopupBuyDone",value:function(){null!==this.popupBuyDone&&(this.removeChild(this.popupBuyDone),this.popupBuyDone.destroy(),this.popupBuyDone=null)}},{key:"addPopupQAndA",value:function(e){this.removePopupQAndA(),this.qAndAPopup=new QuestAndAchievementScreen(e),this.qAndAPopup.setQuestAndQuestLogs(),this.qAndAPopup.signalBack.add(this.onQAndAPopupBack,this),this.addChild(this.qAndAPopup)}},{key:"onQAndAPopupBack",value:function(){this.removePopupQAndA(),window.smartFoxSignal.sendData(DataCommand.QUEST_LOAD_REQUEST,null)}},{key:"removePopupQAndA",value:function(){null!==this.qAndAPopup&&(this.removeChild(this.qAndAPopup),this.qAndAPopup.destroy(),this.qAndAPopup=null)}},{key:"addPopupBuy",value:function(e){this.removePopupBuy(),this.popupBuy=new Jh,this.popupBuy.event.OK.add(this.chooseOk,this),this.popupBuy.event.CANCLE.add(this.chooseCanle,this),this.popupBuy.setData(e),this.addChild(this.popupBuy)}},{key:"chooseOk",value:function(e){mZ.instance().dataMySeft.diamond<e.price?this.addPopupMoney(e):(qe.instance().showLoading(),mZ.instance().sendData(Js.SHOP_BUY_PLAYLIST_REQUEST,bc.begin(e.id))),this.removePopupBuy()}},{key:"chooseCanle",value:function(){this.removePopupBuy()}},{key:"removePopupBuy",value:function(){null!==this.popupBuy&&(this.removeChild(this.popupBuy),this.popupBuy.destroy(),this.popupBuy=null)}},{key:"addPopupMoney",value:function(e){this.removePopupBuy(),this.popupMoney=new Jh,this.popupMoney.event.OK.add(this.chooseMoneyOk,this),this.popupMoney.event.CANCLE.add(this.chooseMoneyCancle,this),this.popupMoney.setContent("Bạn không đủ ngọc\nbạn muốn mua thêm ngọc?"),this.popupMoney.setData(e),this.addChild(this.popupMoney)}},{key:"chooseMoneyOk",value:function(e){this.addShop(1),this.removePopupMoney()}},{key:"chooseMoneyCancle",value:function(){this.removePopupMoney()}},{key:"removePopupMoney",value:function(){null!==this.popupMoney&&(this.removeChild(this.popupMoney),this.popupMoney.destroy(),this.popupMoney=null)}},{key:"addPlaylistDetail",value:function(e){LogConsole.log("addPlaylistDetail"),this.removePlaylistDetail(),this.detail=new rS(e),this.detail.addEventBack(this.removePlaylistDetail,this),this.addChild(this.detail)}},{key:"removePlaylistDetail",value:function(){null!==this.detail&&(this.removeChild(this.detail),this.detail.destroy(),this.detail=null)}},{key:"addLevelUp",value:function(e){var t=this;setTimeout(function(){t.beginAddUpLevel(e)},2500)}},{key:"beginAddUpLevel",value:function(e){this.removeLevelUp(),this.levelUp=new SS(e),this.levelUp.event.close.add(this.closeLevelUp,this),this.addChild(this.levelUp)}},{key:"closeLevelUp",value:function(){this.removeLevelUp()}},{key:"removeLevelUp",value:function(){null!==this.levelUp&&(this.removeChild(this.levelUp),this.levelUp.destroy(),this.levelUp=null)}},{key:"addDetailSong",value:function(e){this.removeDetailSong(),this.detailSong=new uh(e),this.addChild(this.detailSong)}},{key:"removeDetailSong",value:function(){null!==this.detailSong&&(this.removeChild(this.detailSong),this.detailSong.destroy(),this.detailSong=null)}},{key:"addDialogInviteFriend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.removeDialogInviteFriend(),z.instance().playScript.playing_guide==en.DONE_ALL&&(this.inviteFriend=new Uc(e,t),this.inviteFriend.event.OK.add(this.chooseOkInviteFriend,this),this.inviteFriend.event.CANCLE.add(this.chooseCancleInviteFriend,this),this.inviteFriend.event.OK_CMD.add(this.chooseOkCmdInviteFriend,this),this.inviteFriend.event.CANCLE_CMD.add(this.chooseCancleCmdInviteFriend,this),this.addChild(this.inviteFriend))}},{key:"chooseOkCmdInviteFriend",value:function(e,t){mZ.instance().dataMySeft.diamond<t?this.addDialogConfirnMoney("Bạn không đủ kim cương để vào phòng, bạn có muốn nạp thêm?"):mZ.instance().sendData(R_.ONLINE_MODE_ROOM_QUICK_JOIN_REQUEST,P_.begin(e)),this.removeDialogInviteFriend()}},{key:"chooseOkInviteFriend",value:function(e){mZ.instance().dataMySeft.diamond<e.params.getInt("bet_place")?this.addDialogConfirnMoney("Bạn không đủ kim cương để vào phòng, bạn có muốn nạp thêm?"):mZ.instance().sendInvitationReply(e,SFS2X.InvitationReply.ACCEPT),this.removeDialogInviteFriend()}},{key:"chooseCancleCmdInviteFriend",value:function(){this.removeDialogInviteFriend()}},{key:"chooseCancleInviteFriend",value:function(e){mZ.instance().sendInvitationReply(e,SFS2X.InvitationReply.REFUSE),this.removeDialogInviteFriend()}},{key:"removeDialogInviteFriend",value:function(){null!==this.inviteFriend&&(this.removeChild(this.inviteFriend),this.inviteFriend.destroy(),this.inviteFriend=null)}},{key:"addDialog",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.removeDialog(),this.dialog=new Sn(e,t),""!==n&&this.dialog.setContentButton(n),this.dialog.event.OK.add(this.removeDialog,this),this.addChild(this.dialog)}},{key:"removeDialog",value:function(){null!==this.dialog&&(this.removeChild(this.dialog),this.dialog.destroy(),this.dialog=null)}},{key:"addDialogConfirnMoney",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.removeDialogConfirnMoney(),this.dialogConfirmMoney=new Wc(e,t),this.dialogConfirmMoney.event.OK.add(this.chooseOkConfirmMoney,this),this.dialogConfirmMoney.event.CANCLE.add(this.chooseCancleConfirmMoney,this),this.addChild(this.dialogConfirmMoney)}},{key:"removeDialogConfirnMoney",value:function(){null!==this.dialogConfirmMoney&&(this.removeChild(this.dialogConfirmMoney),this.dialogConfirmMoney.destroy(),this.dialogConfirmMoney=null)}},{key:"chooseOkConfirmMoney",value:function(){this.addShop(1,pw.GEM),this.removeDialogConfirnMoney()}},{key:"chooseCancleConfirmMoney",value:function(){this.removeDialogConfirnMoney()}},{key:"addDialogConfirnTicket",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.removeDialogConfirnTicket(),this.dialogConfirmTicket=new Wc(e,t),this.dialogConfirmTicket.event.OK.add(this.chooseOkConfirmTicket,this),this.dialogConfirmTicket.event.CANCLE.add(this.chooseCancleConfirmTicket,this),this.addChild(this.dialogConfirmTicket)}},{key:"removeDialogConfirnTicket",value:function(){null!==this.dialogConfirmTicket&&(this.removeChild(this.dialogConfirmTicket),this.dialogConfirmTicket.destroy(),this.dialogConfirmTicket=null)}},{key:"chooseOkConfirmTicket",value:function(){this.addShop(1,pw.TICKET),this.removeDialogConfirnTicket()}},{key:"chooseCancleConfirmTicket",value:function(){this.removeDialogConfirnTicket()}},{key:"addShop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.removeShop(),this.shop=new ib(e,t),this.shop.event.close.add(this.tweenRemoveShop,this),this.shop.event.view_all_shop.add(this.addSortShop,this),this.shop.event.search_shop.add(this.addSortShop,this),this.addChild(this.shop)}},{key:"tweenRemoveShop",value:function(){null!==this.shop&&(zc.instance().beginSwitch(this.shop,null,!1),zc.instance().event.tweenComplete.add(this.tweenShopComplete,this))}},{key:"tweenShopComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenShopComplete,this),this.removeShop()}},{key:"removeShop",value:function(){null!==this.shop&&(this.removeChild(this.shop),this.shop.destroy(),this.shop=null)}},{key:"addSortShop",value:function(e){this.removeSortShop(),this.sortShop=new fb,this.sortShop.setData(e.type,e.genres,e.typeMenu,e.ktSearch),this.sortShop.event.back.add(this.choosebackSortShop,this),zc.instance().beginSwitch(null,this.sortShop,!1),zc.instance().event.tweenComplete.add(this.tweenSortShopBeginComplete,this),this.addChild(this.sortShop)}},{key:"choosebackSortShop",value:function(){this.addShop(0),this.removeSortShop()}},{key:"tweenSortShopComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenSortShopComplete,this),this.removeSortShop()}},{key:"tweenSortShopBeginComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenSortShopBeginComplete,this),this.sortShop.addEvent()}},{key:"removeSortShop",value:function(){null!==this.sortShop&&(this.removeChild(this.sortShop),this.sortShop.destroy(),this.sortShop=null)}},{key:"addUserProfile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.removeUserProfile(),this.userProfile=new _m(e,t),this.userProfile.event.back.add(this.removeUserProfile,this),this.addChild(this.userProfile)}},{key:"removeUserProfile",value:function(){null!==this.userProfile&&(this.removeChild(this.userProfile),this.userProfile.destroy(),this.userProfile=null)}},{key:"addRanking",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.ranking=new Ranking(e),this.ranking.event.back.add(this.removeRanking,this),this.addChild(this.ranking)}},{key:"removeRanking",value:function(){null!==this.ranking&&(this.removeChild(this.ranking),this.ranking.destroy(),this.ranking=null)}},{key:"addChatOnlineMode",value:function(){this.chatOnlineMode=new Z_,this.chatOnlineMode.x=36,this.chatOnlineMode.y=game.height-444,this.chatOnlineMode.event.close_dialog.add(this.removeChatOnlineMode,this),this.addChild(this.chatOnlineMode)}},{key:"removeChatOnlineMode",value:function(){null!==this.chatOnlineMode&&(this.removeChild(this.chatOnlineMode),this.chatOnlineMode.destroy(),this.chatOnlineMode=null)}},{key:"addChatScreen",value:function(e){this.removeChatScreen(),this.chatScreen=new Ll(e),this.addChild(this.chatScreen)}},{key:"removeChatScreen",value:function(){null!==this.chatScreen&&(this.removeChild(this.chatScreen),this.chatScreen.destroy(),this.chatScreen=null)}},{key:"addShortUserProfile",value:function(e){this.removeShortUserProfile(),this.popupShortUserProfile=new PopupShortProfileUser(e),this.addChild(this.popupShortUserProfile)}},{key:"removeShortUserProfile",value:function(){null!==this.popupShortUserProfile&&(this.removeChild(this.popupShortUserProfile),this.popupShortUserProfile.destroy(),this.popupShortUserProfile=null)}},{key:"addDailyReward",value:function(e,t){this.removeDailyReward(),this.dailyReward=new ha(e,t),this.dailyReward.event.claimDone.add(this.claimDone,this),this.addChild(this.dailyReward)}},{key:"claimDone",value:function(){this.removeDailyReward(),this.event.change_menu.dispatch()}},{key:"removeDailyReward",value:function(){null!==this.dailyReward&&(this.removeChild(this.dailyReward),this.dailyReward.destroy(),this.dailyReward=null)}},{key:"addDailyRewardPopup",value:function(e){this.removeDailyRewardPopup(),this.dailyRewardPopup=new Lb(e),this.dailyRewardPopup.eventInput.claim.add(this.dailyRewardPopupClaim,this),this.addChild(this.dailyRewardPopup),this.dailyRewardPopup.makeTweenPopup()}},{key:"dailyRewardPopupClaim",value:function(){this.removeDailyRewardPopup()}},{key:"removeDailyRewardPopup",value:function(){null!==this.dailyRewardPopup&&(this.removeChild(this.dailyRewardPopup),this.dailyRewardPopup.destroy(),this.dailyRewardPopup=null)}},{key:"addSoloModeRankingClaimPopup",value:function(e,t){this.removeSoloModeRankingClaimPopup(),this.soloModeRankingClaimPopup=new PopupClaimSoloMode(e,t),this.addChild(this.soloModeRankingClaimPopup)}},{key:"removeSoloModeRankingClaimPopup",value:function(){null!==this.soloModeRankingClaimPopup&&(this.removeChild(this.soloModeRankingClaimPopup),this.soloModeRankingClaimPopup.destroy(),this.soloModeRankingClaimPopup=null)}},{key:"addSettingGame",value:function(){this.removeSettingGame(),this.settingScreen=new ru,this.addChild(this.settingScreen)}},{key:"removeSettingGame",value:function(){null!==this.settingScreen&&(this.removeChild(this.settingScreen),this.settingScreen.destroy(),this.settingScreen=null)}},{key:"addSettingGameScreen",value:function(){this.removeSettingGameScreen(),this.settingGameScreen=new wu,this.addChild(this.settingGameScreen)}},{key:"removeSettingGameScreen",value:function(){null!==this.settingGameScreen&&(this.removeChild(this.settingGameScreen),this.settingGameScreen.destroy(),this.settingGameScreen=null)}},{key:"addSettingAccountScreen",value:function(){this.removeSettingAccountScreen(),this.settingAccountScreen=new Nu,this.addChild(this.settingAccountScreen)}},{key:"removeSettingAccountScreen",value:function(){null!==this.settingAccountScreen&&(this.removeChild(this.settingAccountScreen),this.settingAccountScreen.destroy(),this.settingAccountScreen=null)}},{key:"addSettingAccountUserNameScreen",value:function(){this.removeSettingAccoungUserNameScreen(),this.settingAccountUserNameScreen=new Hu,this.addChild(this.settingAccountUserNameScreen)}},{key:"removeSettingAccoungUserNameScreen",value:function(){null!==this.settingAccountUserNameScreen&&(this.removeChild(this.settingAccountUserNameScreen),this.settingAccountUserNameScreen.destroy(),this.settingAccountUserNameScreen=null)}},{key:"addPopupConfirmBuyItemShop",value:function(e,t,n){this.removePopupConfirmBuyItemShop(),this.popupBuyItemConfirm=new Ob(e,t,n),this.popupBuyItemConfirm.event.exit.add(this.removePopupConfirmBuyItemShop,this),this.addChild(this.popupBuyItemConfirm)}},{key:"removePopupConfirmBuyItemShop",value:function(){null!==this.popupBuyItemConfirm&&(this.removeChild(this.popupBuyItemConfirm),this.popupBuyItemConfirm.destroy(),this.popupBuyItemConfirm=null)}},{key:"addTextScroll",value:function(e){this.removeTextScroll(),this.textScroll=new jb(e),this.textScroll.event.complete.add(this.removeTextScroll,this),this.addChild(this.textScroll)}},{key:"removeTextScroll",value:function(){null!==this.textScroll&&(this.removeChild(this.textScroll),this.textScroll.destroy(),this.textScroll=null)}},{key:"addBadConnection",value:function(){this.removeBadConnection(),this.badConnection=new LS,this.badConnection.event.OK.add(this.chooseOkBadConnection,this),this.badConnection.event.CANCLE.add(this.chooseCancleBadConnection,this),this.addChild(this.badConnection)}},{key:"chooseOkBadConnection",value:function(){this.removeBadConnection()}},{key:"chooseCancleBadConnection",value:function(){De.instance().event.chooseExitBadConnection.dispatch(),this.removeBadConnection()}},{key:"removeBadConnection",value:function(){null!=this.badConnection&&(this.removeChild(this.badConnection),this.badConnection.destroy(),this.badConnection=null)}},{key:"addSettingProfileScreen",value:function(){this.removeSettingProfileScreen(),this.settingProfileScreen=new h_,this.addChild(this.settingProfileScreen)}},{key:"removeSettingProfileScreen",value:function(){null!==this.settingProfileScreen&&(this.removeChild(this.settingProfileScreen),this.settingProfileScreen.destroy(),this.settingProfileScreen=null)}},{key:"addSuggetRating",value:function(){"web"!==z.instance().platform&&(this.removeSuggetRating(),this.suggetRating=new rE,this.suggetRating.event.close.add(this.removeSuggetRating,this),this.addChild(this.suggetRating))}},{key:"removeSuggetRating",value:function(){null!==this.suggetRating&&(this.removeChild(this.suggetRating),this.suggetRating.destroy(),this.suggetRating=null)}}],[{key:"instance",value:function(){return this.controllScreenDialog||(this.controllScreenDialog=new t),this.controllScreenDialog}}]),tC(t,[{key:"removeAllItem",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"removeScreen",value:function(){null!==this.screen&&(this.removeChild(this.screen),this.screen.destroy(),this.screen=null)}},{key:"addLastWeekResultScreen",value:function(e){this.removeLastWeekResultScreen(),this.lastWeekResultScreen=new YE(e),this.addChild(this.lastWeekResultScreen)}},{key:"removeLastWeekResultScreen",value:function(){}},{key:"addPopupNotEnoughResource",value:function(e){this.removePopupNotEnoughResource(),this.popupNotEnoughResource=new AE(e),this.addChild(this.popupNotEnoughResource)}},{key:"removePopupNotEnoughResource",value:function(){null!==this.popupNotEnoughResource&&(this.removeChild(this.popupNotEnoughResource),this.popupNotEnoughResource.destroy(),this.popupNotEnoughResource=null)}},{key:"addScreenTimeOut",value:function(e){this.screenTimeout=new qn(e.score),this.screenTimeout.addPopup(),this.screenTimeout.makeTweenPopup(),this.addChild(this.screenTimeout)}},{key:"removeScreenTimeOut",value:function(){null!==this.screenTimeout&&(this.removeChild(this.screenTimeout),this.screenTimeout.destroy(),this.screenTimeout=null)}},{key:"addScreenLosePopup",value:function(e){this.screenLosePopup=new ei(e.score),this.screenLosePopup.addPopup(),this.screenLosePopup.makeTweenPopup(),this.addChild(this.screenLosePopup)}},{key:"removeScreenLosePopup",value:function(){null!==this.screenLosePopup&&(this.removeChild(this.screenLosePopup),this.screenLosePopup.destroy(),this.screenLosePopup=null)}},{key:"addScreenReward",value:function(e){this.screenReward=new mi(e.score,e.reward),this.screenReward.addPopup(),this.screenReward.makeTweenPopup(),this.addChild(this.screenReward)}},{key:"removeScreenReward",value:function(){null!==this.screenReward&&(this.removeChild(this.screenReward),this.screenReward.destroy(),this.screenReward=null)}},{key:"addScreenNotReward",value:function(e){this.screenNotReward=new Ei(e.score),this.screenNotReward.addPopup(),this.screenNotReward.makeTweenPopup(),this.addChild(this.screenNotReward)}},{key:"removeScreenNotReward",value:function(){null!==this.screenNotReward&&(this.removeChild(this.screenNotReward),this.screenNotReward.destroy(),this.screenNotReward=null)}},{key:"addScreenDoneSoloMode",value:function(e){this.screenDoneSoloMode=new Di(e.score,e.reward,e.playlist),this.screenDoneSoloMode.addPopup(),this.screenDoneSoloMode.makeTweenPopup(),this.addChild(this.screenDoneSoloMode)}},{key:"removeScreenDoneSoloMode",value:function(){null!==this.screenDoneSoloMode&&(this.removeChild(this.screenDoneSoloMode),this.screenDoneSoloMode.destroy(),this.screenDoneSoloMode=null)}},{key:"addAnimClaimReward",value:function(e){this.animClaimReward=new si(e.type,e.reward,e.finishPoint),this.addChild(this.animClaimReward)}},{key:"removeAnimClaimReward",value:function(){null!==this.animClaimReward&&(this.removeChild(this.animClaimReward),this.animClaimReward.destroy(),this.animClaimReward=null)}},{key:"addQuestClaimReward",value:function(e){this.questClaimPopup=new qi(e),this.questClaimPopup.makeTweenPopup(),this.questClaimPopup.eventInput.claim.add(this.onClaimQuest,this),this.addChild(this.questClaimPopup)}},{key:"onClaimQuest",value:function(){this.removeQuestClaimReward(),WF.instance().changeScreen(Ce.QUEST_ACHIEVEMENT,2)}},{key:"removeQuestClaimReward",value:function(){null!==this.questClaimPopup&&(this.removeChild(this.questClaimPopup),this.questClaimPopup.destroy(),this.questClaimPopup=null)}},{key:"addAchievementClaimReward",value:function(e){this.achievementClaimPopup=new uo(e),this.achievementClaimPopup.eventInput.claim.add(this.onClaimAchievement,this),this.addChild(this.achievementClaimPopup)}},{key:"onClaimAchievement",value:function(){this.removeAchievementClaimReward(),WF.instance().changeScreen(Ce.QUEST_ACHIEVEMENT,3)}},{key:"removeAchievementClaimReward",value:function(){null!==this.achievementClaimPopup&&(this.removeChild(this.achievementClaimPopup),this.achievementClaimPopup.destroy(),this.achievementClaimPopup=null)}},{key:"addDailyReward",value:function(e){this.dailyrewardPopup=new ha(e.dailyRewardSettings,e.dailyRewardLog),this.dailyrewardPopup.event.claimDone.add(this.dailyrewardPopupClaimDone,this),this.addChild(this.dailyrewardPopup)}},{key:"dailyrewardPopupClaimDone",value:function(){WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"removeDailyReward",value:function(){null!==this.dailyrewardPopup&&(this.removeChild(this.dailyrewardPopup),this.dailyrewardPopup.destroy(),this.dailyrewardPopup=null)}},{key:"addChatScreen",value:function(e){this.removeChatScreen(),this.chatScreen=new Ll(e),this.addChild(this.chatScreen)}},{key:"removeChatScreen",value:function(){null!==this.chatScreen&&(this.removeChild(this.chatScreen),this.chatScreen.destroy(),this.chatScreen=null)}},{key:"addMailSystemScreen",value:function(e){this.removeMailSystemScreen(),this.mailSystemScreen=new kE(e.message_content_id),this.addChild(this.mailSystemScreen)}},{key:"removeMailSystemScreen",value:function(){null!==this.mailSystemScreen&&(this.removeChild(this.mailSystemScreen),this.mailSystemScreen.destroy(),this.mailSystemScreen=null)}},{key:"addSettingGiftcode",value:function(){this.removeSettingGiftcode(),this.settingGiftcode=new C_,this.addChild(this.settingGiftcode)}},{key:"removeSettingGiftcode",value:function(){null!==this.settingGiftcode&&(this.removeChild(this.settingGiftcode),this.settingGiftcode.destroy(),this.settingGiftcode=null)}},{key:"addLimitTurn",value:function(){this.removeLimitTurn(),this.limitTurn=new z_,this.addChild(this.limitTurn)}},{key:"removeLimitTurn",value:function(){null!==this.limitTurn&&(this.removeChild(this.limitTurn),this.limitTurn.destroy(),this.limitTurn=null)}},{key:"changeScreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(LogConsole.log(e),e){case Ce.SOLOMODE_TIMEOUT:this.removeScreenTimeOut(),this.addScreenTimeOut(t);break;case Ce.SOLOMODE_LOSE_POPUP:this.removeScreenLosePopup(),this.addScreenLosePopup(t);break;case Ce.SOLOMODE_REWARD:this.removeScreenReward(),this.addScreenReward(t);break;case Ce.SOLOMODE_NOT_REWARD:this.removeScreenNotReward(),this.addScreenNotReward(t);break;case Ce.SOLOMODE_DONE:this.removeScreenDoneSoloMode(),this.addScreenDoneSoloMode(t);break;case Ce.ANIM_CLAIM_REWARD:this.removeAnimClaimReward(),this.addAnimClaimReward(t);break;case Ce.QUEST_CLAIM_POPUP:this.removeQuestClaimReward(),this.addQuestClaimReward(t);break;case Ce.ACHIEVEMENT_CLAIM_POPUP:this.removeAchievementClaimReward(),this.addAchievementClaimReward(t);break;case Ce.DAILY_REWARD:this.removeDailyReward(),this.addDailyReward(t)}}}]),t}();function oC(e){return(oC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sC(e,t){return!t||"object"!==oC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rC(e){return(rC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lC(e,t){return(lC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=sC(this,rC(t).call(this,game))).positionBootConfig=JSON.parse(game.cache.getText("positionBootConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this,t=new F;this.addChild(t),this.addLogoSprite();qe.instance().hideLoading(),Bn.getGame(function(t){LogConsole.log("success--------"),LogConsole.log(t),LogConsole.log(t.resource),void 0!==t.resource?(!0,clearInterval(n),e.definedGame(t)):(qe.instance().hideLoading(),iC.instance().addDialog("Kiểm tra kết nối của bạn trước khi vào game"))}),qe.instance().showLoading();var n=setInterval(function(){Bn.getGame(function(t){LogConsole.log("success--------"),LogConsole.log(t),LogConsole.log(t.resource),void 0!==t.resource?(!0,clearInterval(n),qe.instance().hideLoading(),e.definedGame(t)):(qe.instance().hideLoading(),iC.instance().addDialog("Kiểm tra kết nối của bạn trước khi vào game"))})},5e3)}},{key:"addThemeTET",value:function(){var e=new ye;this.addChild(e)}},{key:"definedGame",value:function(e){var t=this;z.instance().isRefreshMenu.checking=!1,z.instance().menuLoadResponses=null;var n=0,i=0;"and"===z.instance().platform?(n=Un.instance().convertVersionToInt(z.VERSION_AND),i=e.resource.hasOwnProperty("android_version")?Un.instance().convertVersionToInt(e.resource.android_version):Un.instance().convertVersionToInt(z.VERSION_AND)):"ios"===z.instance().platform&&(n=Un.instance().convertVersionToInt(z.VERSION_IOS),i=e.resource.hasOwnProperty("ios_version")?Un.instance().convertVersionToInt(e.resource.ios_version):Un.instance().convertVersionToInt(z.VERSION_IOS)),n<i&&(z.instance().ktUpdate=!0),window.RESOURCE=Object.assign({},window.RESOURCE,e.resource),z.instance().ktUpdate?"and"===z.instance().platform?iC.instance().addDialog("Đã có bản cập nhật mới trên store. Bạn hãy ấn vào đây để cập nhật",window.RESOURCE.android_storage_link,"Cập Nhật"):"ios"===z.instance().platform&&iC.instance().addDialog("Đã có bản cập nhật mới trên store. Bạn hãy ấn vào đây để cập nhật",window.RESOURCE.ios_storage_link,"Cập Nhật"):(De.instance().event.onConnectServer.add(this.onConnectServer,this),window.isTest?window.cordova&&"undefined"!=typeof device?(Ie.instance().init(),Ie.instance().event.loginComplete.add(this.loginFbMobileComplete,this),Ie.instance().event.loginStatusUnknown.add(this.loginStatusUnknown,this),Ie.instance().event.loginError.add(this.loginErrorFbMobileComplete,this)):this.initFaceBook(function(){Le.instance().logEvent(Le.LoginScreen),checkLoginState(function(e,n,i){qe.instance().hideLoading(),1==e&&null!=n&&null!=i?(z.instance().LOG_IN_BY_FB=!0,qe.instance().showLoading(),t.getServerInfomationAjax(n,i,function(e){"OK"==e.status?(z.instance().response=e,z.instance().userId=e.userId,z.instance().token=e.token,z.instance().isNewUser=e.isNewUser,t.sfsInfo=e.sfs_info,t.initServer()):"Failed"==e.status?(qe.instance().hideLoading(),iC.instance().addDialog(e.message)):(Gn.instance().addPopupDisconnect(),Gn.instance().addDialog("Đăng nhập Facebook không thành công"))})):(t.addButtonFBLogin(),window.cordova&&"undefined"!=typeof device&&t.addButtonPlayNow(),!1===window.isTest&&t.addButtonPlayNow())})}):(qe.instance().hideLoading(),this.addButtonPlayNow()))}},{key:"loginErrorFbMobileComplete",value:function(){qe.instance().hideLoading(),this.addButtonFBLogin(),window.cordova&&"undefined"!=typeof device&&(Gn.instance().addPopupDisconnect(),this.addButtonPlayNow()),!1===window.isTest&&this.addButtonPlayNow()}},{key:"loginStatusUnknown",value:function(){this.addButtonFBLogin(),this.addButtonPlayNow(),qe.instance().hideLoading()}},{key:"loginFbMobileComplete",value:function(e){var t=this;z.instance().LOG_IN_BY_FB=!0,LogConsole.log(e),this.getServerInfomationAjax(e.userID,e.accessToken,function(e){"OK"==e.status?(LogConsole.log(e),z.instance().response=e,z.instance().userId=e.userId,z.instance().token=e.token,z.instance().isNewUser=e.isNewUser,t.sfsInfo=e.sfs_info,t.initServer()):"Failed"==e.status?(qe.instance().hideLoading(),iC.instance().addDialog(e.message)):(t.addButtonPlayNow(),Gn.instance().addPopupDisconnect(),console.warn("Could not get login & sfs informations from webservice"))})}},{key:"onConnectServer",value:function(){LogConsole.log("onConnectServeronConnectServer"),this.loginSFS(z.instance().userId,z.instance().token)}},{key:"addButtonFBLogin",value:function(){this.fbBtn=game.add.button(this.positionBootConfig.btn_fb.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionBootConfig.btn_fb.y)*window.GameConfig.RESIZE,this.positionBootConfig.btn_fb.nameAtlas,this.onclickFBLoginBt,this,null,this.positionBootConfig.btn_fb.nameSprite),this.fbBtn.anchor.set(.5),this.fbBtn.scale.set(.9),this.addChild(this.fbBtn)}},{key:"addButtonPlayNow",value:function(){this.playNowBtn=game.add.button(this.positionBootConfig.btn_play_now.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionBootConfig.btn_play_now.y)*window.GameConfig.RESIZE,this.positionBootConfig.btn_play_now.nameAtlas,this.onclickPlayNow,this,null,this.positionBootConfig.btn_play_now.nameSprite),this.playNowBtn.anchor.set(.5),this.playNowBtn.scale.set(.9),this.addChild(this.playNowBtn)}},{key:"onclickPlayNow",value:function(){var e=this;mZ.instance().ktLogin=!1,mZ.instance().loginSFSByDevice(function(t){"OK"==t.status?(LogConsole.log(t),z.instance().response=t,z.instance().userId=t.userId,z.instance().token=t.token,z.instance().isNewUser=t.isNewUser,e.sfsInfo=t.sfs_info,e.initServer()):"Failed"==t.status?(qe.instance().hideLoading(),iC.instance().addDialog(t.message)):(Gn.instance().addPopupDisconnect(),console.warn("Could not get login & sfs informations from webservice"))})}},{key:"onclickFBLoginBt",value:function(){mZ.instance().ktLogin=!1,Le.instance().logEvent(Le.Login_buttons),window.cordova&&"undefined"!=typeof device?(Ie.instance().login(),qe.instance().showLoading()):FB.login(function(e){"unknown"==e.status&&alert("Đăng nhập lỗi, hãy đăng nhập lại! :'("),"connected"==e.status&&WF.instance().changeScreen(Ce.LOGIN)},{scope:"email, user_gender, user_friends"})}},{key:"addLogoSprite",value:function(){var e=game.add.sprite(this.positionBootConfig.logo.x*window.GameConfig.RESIZE,this.positionBootConfig.logo.y*window.GameConfig.RESIZE,"".concat(this.positionBootConfig.logo.nameAtlas),"".concat(this.positionBootConfig.logo.nameSprite));e.anchor.set(.5),this.addChild(e)}},{key:"loginSFS",value:function(e,t){mZ.instance().loginSFS(e,t)}},{key:"initFaceBook",value:function(e){FB.init({appId:window.RESOURCE.fb_app,cookie:!0,xfbml:!0,version:"v3.1"}),e()}},{key:"getServerInfomationAjax",value:function(e,t,n){var i={fbId:e,accessToken:t,device:ze.getNamePlatform()};$.ajax({url:window.RESOURCE.login_url,type:"POST",data:i,dataType:"json",success:function(e){n(e)},error:function(e,t,i){console.error("Error get server infomation"),console.error(i),console.error(e.status),console.error(e.responseJSON),n({status:"ERROR_LOGIN"})}})}},{key:"initServer",value:function(){var e={host:"103.9.77.122",port:8096,useSSL:!1,zone:"MusicQuiz",debug:!1};this.sfsInfo&&(e.host=this.sfsInfo.sfs_host,e.port=this.sfsInfo.sfs_port,e.useSSL=this.sfsInfo.sfs_ssl,e.zone=this.sfsInfo.sfs_zone,e.debug=this.sfsInfo.sfs_debug),LogConsole.log(this.sfsInfo),mZ.instance().initListenerSfs(e),mZ.instance().connect()}},{key:"destroy",value:function(){for(De.instance().event.onConnectServer.remove(this.onConnectServer,this),Ie.instance().event.loginComplete.remove(this.loginFbMobileComplete,this),Ie.instance().event.loginError.remove(this.loginErrorFbMobileComplete,this),Ie.instance().event.loginStatusUnknown.remove(this.loginStatusUnknown,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&aC(n.prototype,i),o&&aC(n,o),t}();function cC(e){return(cC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dC(e){return(dC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fC(e,t){return(fC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gC=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,o=dC(t).call(this,game,0,0,e),(n=!o||"object"!==cC(o)&&"function"!=typeof o?pC(i):o).inputEnabled=!0,n.scrollMaskMenu=new Phaser.Graphics(game,0,353*window.GameConfig.RESIZE),n.scrollMaskMenu.drawRect(0,353*window.GameConfig.RESIZE,game.width,1090*window.GameConfig.RESIZE),n.scrollMaskMenu.endFill(),n.countHeight=n.height-440*window.GameConfig.RESIZE,n.txtRefresh=n.addTxtRefresh(),n.addChild(n.txtRefresh),n.savedPosition=new Phaser.Point(n.x,n.y),n.movingSpeed=0,n.friction=.94,n.speedMult=.7,n.input.enableDrag(),n.input.allowHorizontalDrag=!1,n.events.onDragStart.add(function(){z.instance().menuDragging=!0,n.isDraging=!0,n.savedPosition=new Phaser.Point(n.x,n.y),n.movingSpeed=0},pC(pC(n))),n.events.onDragStop.add(n.onDragStop,pC(pC(n))),n.events.onDragUpdate.add(n.onDragUpdate,pC(pC(n))),n.mask=n.scrollMaskMenu,n.countHeightChild=0,n.event={refreshMenu:new Phaser.Signal,scrollChange:new Phaser.Signal,scrollDefault:new Phaser.Signal,scrollList:new Phaser.Signal},n.isScrollChange=!1,1==z.instance().isScrollChange?(n.y=-235,n.scrollMaskMenu.countHeight=1270):(n.y=0,n.scrollMaskMenu.countHeight=1090),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fC(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addTxtRefresh",value:function(){var e=new Phaser.Text(game,game.world.centerX,250*window.GameConfig.RESIZE,"Refresh..",{font:"".concat(20*window.GameConfig.RESIZE,"px GilroyMedium"),fill:"#ffffff"});return e.anchor.set(.5),e}},{key:"onDragStop",value:function(){this.isDraging=!1,this.position.y>100*window.GameConfig.RESIZE?this.tweenInertiaComplete():(this.tweenInertia=game.add.tween(this).to({alpha:1},300,"Linear",!0),this.tweenInertia.start(),this.tweenInertia.onUpdateCallback(this.updateInertia,this),this.tweenInertia.onComplete.add(this.tweenInertiaComplete,this))}},{key:"updateInertia",value:function(){!0!==this.isDraging&&(this.movingSpeed>0?(this.y>30*window.GameConfig.RESIZE?this.y+=this.movingSpeed*Math.sin(this.movingangle)*.1:this.position.y<(game.height-150)*window.GameConfig.RESIZE-this.countHeight?this.y+=this.movingSpeed*Math.sin(this.movingangle)*.1:this.y+=this.movingSpeed*Math.sin(this.movingangle),this.movingSpeed=this.movingSpeed*this.friction,this.distanceNew=this.distanceNew*this.friction):this.distanceNew>0&&(this.movingSpeed=this.distanceNew*this.speedMult,this.movingangle=this.angleNew)),this.catchScrollList()}},{key:"catchScrollChange",value:function(){this.y<=-20?!0!==this.isScrollChange&&(this.isScrollChange=!0,!0!==z.instance().isScrollChange&&(this.event.scrollChange.dispatch(),this.scrollChange(),z.instance().isScrollChange=!0)):!1!==this.isScrollChange&&(this.isScrollChange=!1,!1!==z.instance().isScrollChange&&(z.instance().isScrollChange=!1,this.event.scrollDefault.dispatch(),this.scrollDefault()))}},{key:"tweenInertiaComplete",value:function(){(this.catchScrollChange(),this.catchScrollList(),this.position.y>=0)&&game.add.tween(this).to({y:0},200,"Linear").start();(this.position.y>100*window.GameConfig.RESIZE&&this.sendRequestMenuChallenges(),(game.height-130)*window.GameConfig.RESIZE-this.countHeight<0)?this.position.y<(game.height-130)*window.GameConfig.RESIZE-this.countHeight&&(1==z.instance().isScrollChange&&this.countHeight<this.scrollMaskMenu.countHeight?game.add.tween(this).to({y:-245},200,"Linear").start():game.add.tween(this).to({y:(game.height-130)*window.GameConfig.RESIZE-this.countHeight},200,"Linear").start()):1==z.instance().isScrollChange?game.add.tween(this).to({y:-235},200,"Linear").start():game.add.tween(this).to({y:0},200,"Linear").start();z.instance().menuDragging=!1}},{key:"onDragUpdate",value:function(){this.distanceNew=Math.abs(this.y-this.savedPosition.y),this.angleNew=0,this.y-this.savedPosition.y>0?this.angleNew=90:this.angleNew=-90,this.savedPosition=new Phaser.Point(this.x,this.y)}},{key:"catchScrollList",value:function(){this.y<-420&&this.y>-840?this.event.scrollList.dispatch(4):this.y<-840&&this.y>-1260?this.event.scrollList.dispatch(8):this.y<-1260&&this.y>-1680?this.event.scrollList.dispatch(12):this.y<-1680&&this.y>-2100?this.event.scrollList.dispatch(16):this.y<-2100&&this.y>-2520?this.event.scrollList.dispatch(20):this.y<-2520&&this.y>-2940?this.event.scrollList.dispatch(24):this.y<-2940&&this.y>-3360?this.event.scrollList.dispatch(28):this.y<-2940&&this.y>-3360?this.event.scrollList.dispatch(28):this.y<-3360&&this.y>-3780?this.event.scrollList.dispatch(32):this.y<-3780&&this.y>-4200&&this.event.scrollList.dispatch(36)}},{key:"sendRequestMenuChallenges",value:function(){this.checkRequestSocketMainMenuCheck(),0==z.instance().isRefreshMenu.checking&&(this.countHeightChild=0,this.countHeight=this.height-440*window.GameConfig.RESIZE,this.event.refreshMenu.dispatch())}},{key:"checkRequestSocketMainMenuCheck",value:function(){1==z.instance().isRefreshMenu.checking?Date.now()-z.instance().isRefreshMenu.updated<6e3?z.instance().isRefreshMenu.checking=!0:z.instance().isRefreshMenu.checking=!1:z.instance().isRefreshMenu.checking=!1}},{key:"scrollChange",value:function(){this.scrollMaskMenu.clear(),this.scrollMaskMenu.drawRect(0,333*window.GameConfig.RESIZE,game.width,1110*window.GameConfig.RESIZE),this.scrollMaskMenu.countHeight=1270}},{key:"scrollDefault",value:function(){this.scrollMaskMenu.clear(),this.scrollMaskMenu.drawRect(0,353*window.GameConfig.RESIZE,game.width,1090*window.GameConfig.RESIZE),this.scrollMaskMenu.countHeight=1090}},{key:"addChildren",value:function(e){this.countHeightChild+=e.height,this.countHeight+=e.height,this.addChild(e)}}])&&uC(n.prototype,i),o&&uC(n,o),t}();function yC(e){return(yC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vC(e,t){return!t||"object"!==yC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wC(e){return(wC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bC(e,t){return(bC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var SC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=vC(this,wC(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={onClickFindGame:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this;this.btn=new Phaser.Button(game,this.positionMenuConfig.btn_findgame.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_findgame.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_findgame.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_findgame.nameSprite),this.btn.anchor.set(.5),this.btn.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),e.event.onClickFindGame.dispatch(),Le.instance().logEvent(Le.Find_Game_turnbase_mode_button)},this);var t=new Phaser.Text(game,this.positionMenuConfig.txt_btn_findgame.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_findgame.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_findgame.text,this.positionMenuConfig.txt_btn_findgame.configs);t.anchor.set(.5),this.btn.addChild(t);var n=new Phaser.Sprite(game,0,-23*window.GameConfig.RESIZE,"FindGameButton");n.anchor.set(.5),this.runAnim=n.animations.add("run_anim"),this.runAnim.onLoop.add(this.onAnimLooped,this),this.runAnim.play(30,!0),this.btn.addChild(n),this.addChild(this.btn)}},{key:"startAnim",value:function(){this.runAnim.play(30,!0)}},{key:"onAnimLooped",value:function(e,t){t.loopCount%10==0&&t.stop()}},{key:"setPosY",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"setPosYDefault",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"sendRequestFindGame",value:function(){mZ.instance().sendData(Et.CHALLENGE_GAME_FIND_OPPONENTS_REQUEST,null)}}])&&mC(n.prototype,i),o&&mC(n,o),t}();function _C(e){return(_C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function CC(e,t){return!t||"object"!==_C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kC(e){return(kC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PC(e,t){return(PC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var OC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=CC(this,kC(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={onClickPractice:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn=new Phaser.Button(game,this.positionMenuConfig.btn_practice.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_practice.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_practice.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_practice.nameSprite),this.btn.anchor.set(.5),this.btn.events.onInputUp.add(this.onClickPracticeBtn,this);var e=new Phaser.Text(game,this.positionMenuConfig.txt_btn_practice.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_practice.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_practice.text,this.positionMenuConfig.txt_btn_practice.configs);e.anchor.set(.5),this.btn.addChild(e);var t=new Phaser.Sprite(game,0,-23*window.GameConfig.RESIZE,"PracticeButton");t.anchor.set(.5),this.runAnim=t.animations.add("run_anim"),this.runAnim.onLoop.add(this.onAnimLooped,this),this.runAnim.play(30,!0),this.btn.addChild(t),this.addChild(this.btn)}},{key:"onClickPracticeBtn",value:function(){Le.instance().logEvent(Le.Solo_mode_button),ce.instance().playSound(ce.buttonclick),this.event.onClickPractice.dispatch()}},{key:"startAnim",value:function(){this.runAnim.play(30,!0)}},{key:"onAnimLooped",value:function(e,t){t.loopCount%13==0&&t.stop()}},{key:"setPosY",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"setPosYDefault",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"sendSoloModePlaylistsRequest",value:function(){mZ.instance().sendData(Et.SOLO_MODE_PLAYLISTS_REQUEST,null)}}])&&EC(n.prototype,i),o&&EC(n,o),t}();function RC(e){return(RC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function TC(e,t){return!t||"object"!==RC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function IC(e){return(IC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AC(e,t){return(AC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=TC(this,IC(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={goToParty:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn=new Phaser.Button(game,this.positionMenuConfig.btn_party.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_party.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_party.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_party.nameSprite),this.btn.anchor.set(.5),this.btn.events.onInputUp.add(this.onClickPartyBtn,this);var e=new Phaser.Text(game,this.positionMenuConfig.txt_btn_party.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_party.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_party.text,this.positionMenuConfig.txt_btn_party.configs);e.anchor.set(.5),this.btn.addChild(e);var t=new Phaser.Sprite(game,0,-23*window.GameConfig.RESIZE,"PartyButton");t.anchor.set(.5),this.runAnim=t.animations.add("run_anim"),this.runAnim.onLoop.add(this.onAnimLooped,this),this.runAnim.play(30,!0),this.btn.addChild(t),this.addChild(this.btn)}},{key:"onClickPartyBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.goToParty.dispatch()}},{key:"startAnim",value:function(){this.runAnim.play(30,!0)}},{key:"setPosY",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"setPosYDefault",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"onAnimLooped",value:function(e,t){t.loopCount%10==0&&t.stop()}}])&&xC(n.prototype,i),o&&xC(n,o),t}();function GC(e){return(GC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function MC(e){return(MC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NC(e,t){return(NC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var jC=function(e){function t(e,n,i,o){var a,s,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s=this,r=MC(t).call(this,game,e,n,i,o),(a=!r||"object"!==GC(r)&&"function"!=typeof r?BC(s):r).anchor.set(.5),a.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),a.inputEnabled=!0,a.event={tick:new Phaser.Signal},a.addTick(),a.events.onInputUp.add(function(){a.event.tick.dispatch()},BC(BC(a))),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NC(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addTick",value:function(){this.btn_tick=new Phaser.Sprite(game,this.positionMenuConfig.delete_game.tick_of_btn_delete.x,this.positionMenuConfig.delete_game.tick_of_btn_delete.y,this.positionMenuConfig.delete_game.tick_of_btn_delete.nameAtlas,this.positionMenuConfig.delete_game.tick_of_btn_delete.nameSprite),this.btn_tick.anchor.set(.5),this.btn_tick.kill(),this.addChild(this.btn_tick)}},{key:"showTick",value:function(){void 0!==this.btn_tick&&this.btn_tick.revive()}},{key:"hideTick",value:function(){void 0!==this.btn_tick&&this.btn_tick.kill()}}])&&DC(n.prototype,i),o&&DC(n,o),t}();function UC(e){return(UC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZC(e,t){return!t||"object"!==UC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HC(e){return(HC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QC(e,t){return(QC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var VC=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=ZC(this,HC(t).call(this,game,e,n,i,o))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),a.event={playGame:new Phaser.Signal,nudgeFriend:new Phaser.Signal,deleteChallenge:new Phaser.Signal},a.isHide=!1,a.timeoutInput=null,a}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QC(e,t)}(t,Phaser.Sprite),n=t,(o=[{key:"setData",value:function(e,t,n,i,o,a,s,r,l,h,c,u,d,f){this.avaKey=e,this.btnTexture=t,this.userWon=n,this.opponentWon=i,this.gameLogId=o,this.requestId=a,this.turnCount=s,this.opponentEntity=r,this.mode=l,this.isFinish=h,this.can_be_poked=c,this.poked=u,this.baseUpdated=d,this.updated=this.controllUpdated(this.baseUpdated),this.message=f,-1!==s&&(this.btnTexture=s>0?"btnNotFirstGame":"btnFirstGame")}},{key:"setHide",value:function(){this.isHide=!0,this.x=0,this.visible=!1}},{key:"setAppear",value:function(){this.isHide=!1,this.x=0,this.visible=!0}},{key:"controllUpdated",value:function(e){return this.formatChallengeGameUpdated(e)}},{key:"formatChallengeGameUpdated",value:function(e){var t="",n=Date.now()-e;n=parseInt(n/1e3);var i=parseInt((n/2592e3).toFixed(0));if(i>0)t="".concat(i," tháng trước");else{var o=parseInt(n/604800);if(o>0)t="".concat(o," tuần trước");else{var a=parseInt(n/86400);if(a>0)t="".concat(a," ngày trước");else{var s=parseInt(n/3600);if(s>0)t="".concat(s," giờ trước");else{var r=parseInt(n/60);t=r>0?"".concat(r," phút trước"):"vài giây trước"}}}}return t}},{key:"addItems",value:function(){var e=this;this.isHide=!1;var t=new Phaser.Graphics(game,0,0);t.beginFill(16777215),t.drawCircle(71*window.GameConfig.RESIZE,50*window.GameConfig.RESIZE,68*window.GameConfig.RESIZE),t.anchor.set(.5),this.addChild(t);var n=new gl(71*window.GameConfig.RESIZE,50*window.GameConfig.RESIZE,"ava-default",this.avaKey,i);n.sprite.anchor.set(.5),n.sprite.width=68,n.sprite.height=68,n.sprite.mask=t,n.sprite.inputEnabled=!0,n.event.loadAvaDone.add(function(){n.sprite.width=68,n.sprite.height=68},this),n.sprite.events.onInputUp.add(function(){0==z.instance().menuDragging&&(n.sprite.inputEnabled=!1,ce.instance().playSound(ce.buttonclick),iC.instance().addUserProfile(e.opponentEntity.id),e.timeoutInput=setTimeout(function(){n.sprite.inputEnabled=!0},2e3))},this),this.addChild(n.sprite),this.nameFriendChallenge=new Phaser.Text(game,123*window.GameConfig.RESIZE,50*window.GameConfig.RESIZE,Bn.formatName(this.opponentEntity.userName,20),{font:"Gilroy",fill:"white",fontSize:24*window.GameConfig.RESIZE}),this.nameFriendChallenge.anchor.set(0,.5),this.addChild(this.nameFriendChallenge),this.btn_accept=new Phaser.Button(game,this.positionMenuConfig.btn_accept.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_accept.y*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,this.btnTexture),this.btn_accept.anchor.set(.5),this.addChild(this.btn_accept);var o=new Phaser.Text(game,430*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"".concat(this.opponentWon," : ").concat(this.userWon),{font:"Gilroy",fill:"white",fontSize:24*window.GameConfig.RESIZE});o.anchor.set(.5),this.addChild(o),this.btn_accept.value={gameLogId:this.gameLogId,requestId:this.requestId,opponentEntity:this.opponentEntity,mode:this.mode,can_be_poked:this.can_be_poked,challenge_msg:this.message},"isWaitingGame"==this.mode&&0==this.can_be_poked&&this.btn_accept.kill(),1==this.poked&&(this.btn_accept.y=35,this.txtPoked=new Phaser.Text(game,505*window.GameConfig.RESIZE,70*window.GameConfig.RESIZE,"Đã chọc bạn",{font:"Gilroy",fill:"#8a8a8a",fontSize:16*window.GameConfig.RESIZE}),this.txtPoked.anchor.set(0,.5),this.addChild(this.txtPoked));var a=new Phaser.Text(game,125*window.GameConfig.RESIZE,80*window.GameConfig.RESIZE,this.updated,{font:"Gilroy",fill:"#8a8a8a",fontSize:16*window.GameConfig.RESIZE});if(a.anchor.set(0,.5),this.addChild(a),this.btn_accept.events.onInputUp.addOnce(function(){ce.instance().playSound(ce.buttonclick),e.btn_accept.input.enabled=!1,e.gameLogId=e.gameLogId,"btnFirstGame"==e.btnTexture?e.event.playGame.dispatch({type:"BECHALLENGED",isHasHistory:!1,opponent:e.btn_accept.value.opponentEntity,gameLogId:e.btn_accept.value.gameLogId,requestId:e.btn_accept.value.requestId,weeklyResult:{userWon:e.userWon,opponentWon:e.opponentWon},challenge_msg:e.btn_accept.value.challenge_msg}):"btnNotFirstGame"==e.btnTexture?("isDoneGame"==e.mode&&e.event.playGame.dispatch({type:"CHALLENGE",opponent:e.btn_accept.value.opponentEntity,weeklyResult:{userWon:e.userWon,opponentWon:e.opponentWon},challenge_msg:e.btn_accept.value.challenge_msg}),"isChallengeGame"==e.mode&&e.event.playGame.dispatch({type:"BECHALLENGED",isHasHistory:!0,opponent:e.btn_accept.value.opponentEntity,gameLogId:e.btn_accept.value.gameLogId,requestId:e.btn_accept.value.requestId,weeklyResult:{userWon:e.userWon,opponentWon:e.opponentWon},challenge_msg:e.btn_accept.value.challenge_msg})):e.event.nudgeFriend.dispatch(e.btn_accept.value),setTimeout(function(){e.btn_accept.input.enabled=!0},5e3)}),1==this.opponentEntity.is_online){var s=new rt({x:84,y:68,nameAtlas:"defaultSource",nameSprite:"Online"});this.addChild(s)}else{var r=new rt({x:84,y:68,nameAtlas:"defaultSource",nameSprite:"Offline"});this.addChild(r)}this.addBtnDelete(),this.addMessage()}},{key:"addMessage",value:function(){null!==this.message&&""!==this.message&&(this.nameFriendChallenge.y=30,this.message=Bn.formatName(this.message.toString(),28),this.txtMessage=new Phaser.Text(game,125,57,this.message,{font:"Gilroy",fill:"#ffa33a",fontSize:21}),this.txtMessage.anchor.set(0,.5),this.addChild(this.txtMessage))}},{key:"addBtnDelete",value:function(){this.btnDelete=new jC(this.positionMenuConfig.delete_game.btn_delete.x*window.GameConfig.RESIZE,this.positionMenuConfig.delete_game.btn_delete.y*window.GameConfig.RESIZE,this.positionMenuConfig.delete_game.btn_delete.nameAtlas,this.positionMenuConfig.delete_game.btn_delete.nameSprite),this.btnDelete.event.tick.add(this.deleteChallenge,this),this.btnDelete.kill(),this.addChild(this.btnDelete)}},{key:"deleteChallenge",value:function(){1==this.isClickDelete?(this.isClickDelete=!1,this.btnDelete.hideTick(),null!==this.opponentEntity&&this.event.deleteChallenge.dispatch(this.opponentEntity.id,this.mode)):(this.isClickDelete=!0,this.btnDelete.showTick(),null!==this.opponentEntity&&this.event.deleteChallenge.dispatch(this.opponentEntity.id,this.mode))}},{key:"showBtnDelete",value:function(){this.isClickDelete=!1,void 0!==this.btnDelete&&(this.btnDelete.hideTick(),this.btnDelete.revive()),this.txtPoked&&this.txtPoked.kill(),0!==this.can_be_poked&&this.btn_accept.kill()}},{key:"hideDelete",value:function(){0!==this.can_be_poked&&this.btn_accept.revive(),this.txtPoked&&this.txtPoked.revive(),void 0!==this.btnDelete&&this.btnDelete.kill()}},{key:"destroy",value:function(){for(null!==this.timeoutInput&&clearTimeout(this.timeoutInput);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&FC(n.prototype,o),a&&FC(n,a),t}();function WC(e){return(WC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function KC(e,t){return!t||"object"!==WC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zC(e){return(zC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function YC(e,t){return(YC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var JC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=KC(this,zC(t).call(this,game)))._height=0,e.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.configHeightOfRowTab=106*window.GameConfig.RESIZE,e.countHandleGetMainMenuResponse=0,e.countAppear=0,e.event={playGame:new Phaser.Signal,nudgeFriend:new Phaser.Signal,deleteChallenge:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"sendRequestMenuChallenges",value:function(){mZ.instance().sendData(Et.MAIN_MENU_LOAD_REQUEST,null)}},{key:"sendBeChallengedGameLogRequest",value:function(e,t){var n=new SFS2X.SFSObject;n.putLong("play_log_id",e),n.putLong("challenge_request_id",t),mZ.instance().sendData(Et.BECHALLENGED_GAME_OPPONENT_GAME_LOG_REQUEST,n)}},{key:"handleMainMenuLoadResponse",value:function(e,t,n){var i=this;if(z.instance().menuLoadResponses={waitingGames:[],doneGames:[],challengeGames:[]},this.menuResponseGames=[],1==t){if("OK"==e.getUtfString("status")){var o=e.getSFSArray("opponents");Bn.handleArrMainMenuLoad(o,this.menuResponseGames,function(){z.instance().menuOpponentsResponse=i.menuResponseGames,i.filterResponseGames()}),this.init_quests_count=e.getInt("init_quests_count"),this.new_friend_request_count=e.getLong("new_friend_request_count"),this.started_event_count=e.getLong("started_event_count"),this.handlePlayScript(e),this.handleHoursReward(e)}else console.error("MAIN_MENU_LOAD_RESPONSE not response: ".concat(e.errorMessage));n(z.instance().menuLoadResponses,this.init_quests_count,this.new_friend_request_count,this.started_event_count,this.hoursReward,this.play_script)}}},{key:"handlePlayScript",value:function(e){if(this.play_script={playing_guide:"",play_script_questions:[]},e.containsKey("play_script")){var t=e.getSFSObject("play_script");if(t.containsKey("playing_guide")&&(this.play_script.playing_guide=t.getUtfString("playing_guide")),t.containsKey("play_script_questions"))for(var n=t.getSFSArray("play_script_questions"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString("question_type"),s=o.getUtfString("answer1"),r=o.getUtfString("answer2"),l=o.getUtfString("answer3"),h=o.getUtfString("answer4"),c=o.getLong("id"),u=o.getInt("correct_answer"),d=o.getUtfString("file_path"),f=o.getUtfString("file_path"),p=o.getSFSObject("song"),g=p.getUtfString("title"),y=p.getLong("id"),m=p.getUtfString("title"),v=p.getUtfString("author"),w=p.getSFSObject("singer"),b=w.getUtfString("name"),S=w.getUtfString("avatar");this.play_script.play_script_questions.push({questionType:a,answers:[s,r,l,h],correctAnswer:u,songEntity:{thumb:S,song:g,fileName:m,author:v,singer:b,listenLink:f,id:y,fileUrl:d},id:c})}}this.play_script.playing_guide==en.DONE_GET_QUEST&&(z.instance().botChallenge={value:0,gameLogId:z.instance().menuLoadResponses.challengeGames[0].userGameLog,requestId:z.instance().menuLoadResponses.challengeGames[0].id,opponentEntity:z.instance().menuLoadResponses.challengeGames[0].opponentEntity,mode:"isChallengeGame",can_be_poked:z.instance().menuLoadResponses.challengeGames[0].can_be_poked,weeklyResult:{userWon:0,opponentWon:0}})}},{key:"handleHoursReward",value:function(e){if(e.containsKey("hours_reward")){var t=e.getSFSObject("hours_reward");this.hoursReward={hours_reward_id:t.getInt("hours_reward_id"),user_id:t.getInt("user_id"),created:t.getLong("created"),state:t.getUtfString("state"),updated:t.getLong("updated")}}}},{key:"filterResponseGames",value:function(){z.instance().menuLoadResponses.waitingGames=z.instance().menuOpponentsResponse.filter(function(e){return"THEIR_TURN"==e.status}),z.instance().menuLoadResponses.doneGames=z.instance().menuOpponentsResponse.filter(function(e){return"NO_GAME"==e.status}),z.instance().menuLoadResponses.challengeGames=z.instance().menuOpponentsResponse.filter(function(e){return"YOUR_TURN"==e.status}),z.instance().menuLoadResponses.waitingGames=z.instance().menuLoadResponses.waitingGames.sort(function(e,t){return t.can_be_poked-e.can_be_poked}),z.instance().menuLoadResponses.challengeGames=z.instance().menuLoadResponses.challengeGames.sort(function(e,t){return t.poked-e.poked}),z.instance().menuLoadResponses.challengeGames=z.instance().menuLoadResponses.challengeGames.sort(function(e,t){return t.poked_at-e.poked_at})}},{key:"displayListChallenge",value:function(){var e=this;this.removeAllChild(),this.configHeightOfRowTab=106*window.GameConfig.RESIZE,this.countHandleGetMainMenuResponse=0,this.grapChallenge=new Phaser.Group(game),this.grapChallenge.y=106*window.GameConfig.RESIZE,this.createGrapScrollMenu(),this.addTittleYourTurn(),this.createTabYourTurn(),this.addTittleTheirTurn(),this.createTabTheirTurn(),this.addChild(this.grapMenu);for(var t=0;t<this.grapChallenge.children.length;t++)t<4?function(){var n=game.add.tween(e.grapChallenge.children[t]).to({x:0},500,Phaser.Easing.Back.Out,!1);e.timeout=setTimeout(function(){n.start()},100*t)}():this.grapChallenge.children[t].setHide()}},{key:"createTabYourTurn",value:function(){if(void 0!==z.instance().menuLoadResponses.challengeGames&&z.instance().menuLoadResponses.challengeGames.length>0)for(var e=0;e<z.instance().menuLoadResponses.challengeGames.length;e++)0==z.instance().menuLoadResponses.doneGames.length&&z.instance().menuLoadResponses.challengeGames.length==e+1?this.createTabPlayInScrollMenu(e,0,z.instance().menuLoadResponses.challengeGames[e].opponentEntity.avatar,"afterSet",z.instance().menuLoadResponses.challengeGames[e].weeklyResult.userWon,z.instance().menuLoadResponses.challengeGames[e].weeklyResult.opponentWon,z.instance().menuLoadResponses.challengeGames[e].userGameLog,z.instance().menuLoadResponses.challengeGames[e].challenge_request_id,z.instance().menuLoadResponses.challengeGames[e].turnCount,z.instance().menuLoadResponses.challengeGames[e].opponentEntity,"isChallengeGame",!0,z.instance().menuLoadResponses.challengeGames[e].can_be_poked,z.instance().menuLoadResponses.challengeGames[e].poked,z.instance().menuLoadResponses.challengeGames[e].base_updated,z.instance().menuLoadResponses.challengeGames[e].challenge_msg):this.createTabPlayInScrollMenu(e,0,z.instance().menuLoadResponses.challengeGames[e].opponentEntity.avatar,"afterSet",z.instance().menuLoadResponses.challengeGames[e].weeklyResult.userWon,z.instance().menuLoadResponses.challengeGames[e].weeklyResult.opponentWon,z.instance().menuLoadResponses.challengeGames[e].userGameLog,z.instance().menuLoadResponses.challengeGames[e].challenge_request_id,z.instance().menuLoadResponses.challengeGames[e].turnCount,z.instance().menuLoadResponses.challengeGames[e].opponentEntity,"isChallengeGame",!1,z.instance().menuLoadResponses.challengeGames[e].can_be_poked,z.instance().menuLoadResponses.challengeGames[e].poked,z.instance().menuLoadResponses.challengeGames[e].base_updated,z.instance().menuLoadResponses.challengeGames[e].challenge_msg);if(void 0!==z.instance().menuLoadResponses.doneGames&&z.instance().menuLoadResponses.doneGames.length>0)for(var t=0;t<z.instance().menuLoadResponses.doneGames.length;t++)z.instance().menuLoadResponses.doneGames.length==t+1?this.createTabPlayInScrollMenu(t,z.instance().menuLoadResponses.challengeGames.length,z.instance().menuLoadResponses.doneGames[t].opponentEntity.avatar,"afterSet",z.instance().menuLoadResponses.doneGames[t].weeklyResult.userWon,z.instance().menuLoadResponses.doneGames[t].weeklyResult.opponentWon,z.instance().menuLoadResponses.doneGames[t].userGameLog,z.instance().menuLoadResponses.doneGames[t].challenge_request_id,z.instance().menuLoadResponses.doneGames[t].turnCount,z.instance().menuLoadResponses.doneGames[t].opponentEntity,"isDoneGame",!0,z.instance().menuLoadResponses.doneGames[t].can_be_poked,z.instance().menuLoadResponses.doneGames[t].poked,z.instance().menuLoadResponses.doneGames[t].base_updated,z.instance().menuLoadResponses.doneGames[t].challenge_msg):this.createTabPlayInScrollMenu(t,z.instance().menuLoadResponses.challengeGames.length,z.instance().menuLoadResponses.doneGames[t].opponentEntity.avatar,"afterSet",z.instance().menuLoadResponses.doneGames[t].weeklyResult.userWon,z.instance().menuLoadResponses.doneGames[t].weeklyResult.opponentWon,z.instance().menuLoadResponses.doneGames[t].userGameLog,z.instance().menuLoadResponses.doneGames[t].challenge_request_id,z.instance().menuLoadResponses.doneGames[t].turnCount,z.instance().menuLoadResponses.doneGames[t].opponentEntity,"isDoneGame",!1,z.instance().menuLoadResponses.doneGames[t].can_be_poked,z.instance().menuLoadResponses.doneGames[t].poked,z.instance().menuLoadResponses.doneGames[t].base_updated,z.instance().menuLoadResponses.doneGames[t].challenge_msg)}},{key:"createTabTheirTurn",value:function(){if(void 0!==z.instance().menuLoadResponses.waitingGames&&z.instance().menuLoadResponses.waitingGames.length>0)for(var e=0;e<z.instance().menuLoadResponses.waitingGames.length;e++)z.instance().menuLoadResponses.waitingGames.length==e+1?this.createTabPlayInScrollMenu(e,z.instance().menuLoadResponses.doneGames.length+z.instance().menuLoadResponses.challengeGames.length+1,z.instance().menuLoadResponses.waitingGames[e].opponentEntity.avatar,"btnWaitingGame",z.instance().menuLoadResponses.waitingGames[e].weeklyResult.userWon,z.instance().menuLoadResponses.waitingGames[e].weeklyResult.opponentWon,z.instance().menuLoadResponses.waitingGames[e].userGameLog,z.instance().menuLoadResponses.waitingGames[e].challenge_request_id,-1,z.instance().menuLoadResponses.waitingGames[e].opponentEntity,"isWaitingGame",!0,z.instance().menuLoadResponses.waitingGames[e].can_be_poked,z.instance().menuLoadResponses.waitingGames[e].poked,z.instance().menuLoadResponses.waitingGames[e].base_updated,z.instance().menuLoadResponses.waitingGames[e].challenge_msg):this.createTabPlayInScrollMenu(e,z.instance().menuLoadResponses.doneGames.length+z.instance().menuLoadResponses.challengeGames.length+1,z.instance().menuLoadResponses.waitingGames[e].opponentEntity.avatar,"btnWaitingGame",z.instance().menuLoadResponses.waitingGames[e].weeklyResult.userWon,z.instance().menuLoadResponses.waitingGames[e].weeklyResult.opponentWon,z.instance().menuLoadResponses.waitingGames[e].userGameLog,z.instance().menuLoadResponses.waitingGames[e].challenge_request_id,-1,z.instance().menuLoadResponses.waitingGames[e].opponentEntity,"isWaitingGame",!1,z.instance().menuLoadResponses.waitingGames[e].can_be_poked,z.instance().menuLoadResponses.waitingGames[e].poked,z.instance().menuLoadResponses.waitingGames[e].base_updated,z.instance().menuLoadResponses.waitingGames[e].challenge_msg)}},{key:"createGrapScrollMenu",value:function(){this.grapMenu=new Phaser.Group(game),this.grapMenu.y=545*window.GameConfig.RESIZE,this.addChild(this.grapMenu),this.grapMenu.addChild(this.grapChallenge)}},{key:"addTittleYourTurn",value:function(){var e=new Phaser.Sprite(game,this.positionMenuConfig.tab_yourTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.tab_yourTurn.y*window.GameConfig.RESIZE,"otherSprites","tab-friend"),t=new Phaser.Text(game,this.positionMenuConfig.txt_yourTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_yourTurn.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_yourTurn.text,this.positionMenuConfig.txt_yourTurn.configs);t.anchor.set(0,.5);var n=new Phaser.Text(game,this.positionMenuConfig.txt_count_yourTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_count_yourTurn.y*window.GameConfig.RESIZE,"(".concat(z.instance().menuLoadResponses.doneGames.length+z.instance().menuLoadResponses.challengeGames.length," lượt)"),this.positionMenuConfig.txt_count_yourTurn.configs);n.anchor.set(1,.5),e.addChild(n),e.addChild(t),this.addLineUnder(e),this.grapMenu.addChild(e),this.btnMethodDelete1=new Phaser.Button(game,this.positionMenuConfig.delete_game.btn_bin_blue.x,this.positionMenuConfig.delete_game.btn_bin_blue.y,this.positionMenuConfig.delete_game.btn_bin_blue.nameAtlas,this.onClickMethodDeleteYourTurn,this,null,this.positionMenuConfig.delete_game.btn_bin_blue.nameSprite),this.btnMethodDelete1.anchor.set(.5),this.btnMethodDelete1.scale.set(0),e.addChild(this.btnMethodDelete1),this.btnBin1=new Phaser.Button(game,this.positionMenuConfig.delete_game.bin.x,this.positionMenuConfig.delete_game.bin.y,this.positionMenuConfig.delete_game.bin.nameAtlas,this.onClickBinYourTurn,this,null,this.positionMenuConfig.delete_game.bin.nameSprite),this.btnBin1.anchor.set(.5),e.addChild(this.btnBin1),this.btnCancleDelelte1=new Phaser.Button(game,this.positionMenuConfig.delete_game.btn_x.x,this.positionMenuConfig.delete_game.btn_x.y,this.positionMenuConfig.delete_game.btn_x.nameAtlas,this.onClickCancleDelete,this,null,this.positionMenuConfig.delete_game.btn_x.nameSprite),this.btnCancleDelelte1.anchor.set(.5),this.btnCancleDelelte1.kill(),e.addChild(this.btnCancleDelelte1),this._height+=e.height}},{key:"addTittleTheirTurn",value:function(){var e=new Phaser.Sprite(game,this.positionMenuConfig.tab_yourTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.tab_theirTurn.y*window.GameConfig.RESIZE+this.grapChallenge.y+(z.instance().menuLoadResponses.challengeGames.length+z.instance().menuLoadResponses.doneGames.length)*this.configHeightOfRowTab,"otherSprites","tab-friend"),t=new Phaser.Text(game,this.positionMenuConfig.txt_theirTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_theirTurn.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_theirTurn.text,this.positionMenuConfig.txt_theirTurn.configs);t.anchor.set(0,.5);var n=new Phaser.Text(game,this.positionMenuConfig.txt_count_theirTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_count_theirTurn.y*window.GameConfig.RESIZE,"(".concat(z.instance().menuLoadResponses.waitingGames.length," lượt)"),this.positionMenuConfig.txt_count_theirTurn.configs);n.anchor.set(0,.5),e.addChild(n),e.addChild(t),this.btnMethodDelete2=new Phaser.Button(game,this.positionMenuConfig.delete_game.btn_bin_blue.x,this.positionMenuConfig.delete_game.btn_bin_blue.y,this.positionMenuConfig.delete_game.btn_bin_blue.nameAtlas,this.onClickMethodDeleteTheirTurn,this,null,this.positionMenuConfig.delete_game.btn_bin_blue.nameSprite),this.btnMethodDelete2.anchor.set(.5),this.btnMethodDelete2.scale.set(0),e.addChild(this.btnMethodDelete2),this.btnBin2=new Phaser.Button(game,this.positionMenuConfig.delete_game.bin.x,this.positionMenuConfig.delete_game.bin.y,this.positionMenuConfig.delete_game.bin.nameAtlas,this.onClickBinTheirTurn,this,null,this.positionMenuConfig.delete_game.bin.nameSprite),this.btnBin2.anchor.set(.5),e.addChild(this.btnBin2),this.btnCancleDelelte2=new Phaser.Button(game,this.positionMenuConfig.delete_game.btn_x.x,this.positionMenuConfig.delete_game.btn_x.y,this.positionMenuConfig.delete_game.btn_x.nameAtlas,this.onClickCancleDelete,this,null,this.positionMenuConfig.delete_game.btn_x.nameSprite),this.btnCancleDelelte2.anchor.set(.5),this.btnCancleDelelte2.kill(),e.addChild(this.btnCancleDelelte2),this.addLineUnder(e),this.grapMenu.addChild(e),this._height+=e.height}},{key:"onClickMethodDeleteYourTurn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.deleteChallenge.dispatch(this.listYourTurnDeletes)}},{key:"onClickMethodDeleteTheirTurn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.deleteChallenge.dispatch(this.listTheirTurnDeletes)}},{key:"onClickBinTheirTurn",value:function(){ce.instance().playSound(ce.buttonclick),this.listTheirTurnDeletes=[],this.btnBin2.kill(),this.btnCancleDelelte2.revive();for(var e=0;e<this.grapChallenge.children.length;e++){var t=this.grapChallenge.children[e];"isWaitingGame"==t.mode&&t.showBtnDelete()}}},{key:"onClickBinYourTurn",value:function(){ce.instance().playSound(ce.buttonclick),this.listYourTurnDeletes=[],this.btnBin1.kill(),this.btnCancleDelelte1.revive();for(var e=0;e<this.grapChallenge.children.length;e++){var t=this.grapChallenge.children[e];"isWaitingGame"!==t.mode&&t.showBtnDelete()}}},{key:"onClickCancleDelete",value:function(){ce.instance().playSound(ce.buttonclick),this.btnBin1.revive(),this.btnBin2.revive(),this.btnCancleDelelte1.kill(),this.btnCancleDelelte2.kill(),game.add.tween(this.btnMethodDelete1).to({x:580},50,Phaser.Easing.Linear.In,!0).start(),game.add.tween(this.btnMethodDelete2).to({x:580},50,Phaser.Easing.Linear.In,!0).start(),game.add.tween(this.btnMethodDelete1.scale).to({x:0,y:0},50,"Linear",!0).start(),game.add.tween(this.btnMethodDelete2.scale).to({x:0,y:0},50,"Linear",!0).start();for(var e=0;e<this.grapChallenge.children.length;e++){this.grapChallenge.children[e].hideDelete()}}},{key:"addLineUnder",value:function(e){var t=new rt(this.positionMenuConfig.line_under);e.addChild(t)}},{key:"createTabPlayInScrollMenu",value:function(e,t,n,i,o,a,s,r,l,h,c,u,d,f,p,g){var y=this,m=new VC(640*window.GameConfig.RESIZE,(e+t)*this.configHeightOfRowTab+this.positionMenuConfig.tab_theirTurn.y*window.GameConfig.RESIZE,"otherSprites","tab-friend");m.setData(n,i,o,a,s,r,l,h,c,u,d,f,p,g),m.event.playGame.add(function(e){y.event.playGame.dispatch(e)},this),m.event.nudgeFriend.add(function(e){y.event.nudgeFriend.dispatch(e)},this),m.event.deleteChallenge.add(function(e,t){"isWaitingGame"==t?(y.listTheirTurnDeletes.includes(e)?y.listTheirTurnDeletes=y.removeFromListDeletes(y.listTheirTurnDeletes,e):y.listTheirTurnDeletes.push(e),y.listTheirTurnDeletes.length>0?525!==y.btnMethodDelete2.x&&(game.add.tween(y.btnMethodDelete2).to({x:525},400,Phaser.Easing.Elastic.Out,!0).start(),game.add.tween(y.btnMethodDelete2.scale).to({x:1,y:1},50,"Linear",!0).start()):(game.add.tween(y.btnMethodDelete2).to({x:580},50,Phaser.Easing.Linear.In,!0).start(),game.add.tween(y.btnMethodDelete2.scale).to({x:0,y:0},50,"Linear",!0).start())):(y.listYourTurnDeletes.includes(e)?y.listYourTurnDeletes=y.removeFromListDeletes(y.listYourTurnDeletes,e):y.listYourTurnDeletes.push(e),y.listYourTurnDeletes.length>0?525!==y.btnMethodDelete1.x&&(game.add.tween(y.btnMethodDelete1).to({x:525},400,Phaser.Easing.Elastic.Out,!0).start(),game.add.tween(y.btnMethodDelete1.scale).to({x:1,y:1},50,"Linear",!0).start()):(game.add.tween(y.btnMethodDelete1).to({x:580},50,Phaser.Easing.Linear.In,!0).start(),game.add.tween(y.btnMethodDelete1.scale).to({x:0,y:0},50,"Linear",!0).start()))},this),0==u&&this.addLineUnder(m),this._height+=m.height,m.addItems(),this.grapChallenge.addChild(m)}},{key:"removeFromListDeletes",value:function(e,t){return e.filter(function(e){return e!==t})}},{key:"scrollEventResponse",value:function(e){if(e>this.countAppear){this.countAppear=e;for(var t=this.countAppear-1;t<this.countAppear+3&&!(t>=this.grapChallenge.children.length);t++)1==this.grapChallenge.children[t].isHide&&this.grapChallenge.children[t].setAppear()}}},{key:"removeAllChild",value:function(){for(void 0!==this.timeout&&clearTimeout(this.timeout),this.configHeightOfRowTab=106*window.GameConfig.RESIZE,this.countHandleGetMainMenuResponse=0;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}}])&&qC(n.prototype,i),o&&qC(n,o),t}();function XC(e){return(XC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ek(e,t){return!t||"object"!==XC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tk(e){return(tk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nk(e,t){return(nk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ik=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ek(this,tk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.outSize=!0,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.animCircleScale,this.animButtonInOut,this.addBtn(),this.addAnimButtonInOut()}},{key:"addBtn",value:function(){this.btn=new Phaser.Sprite(game,this.positionMenuConfig.btnQAndA.x*window.GameConfig.RESIZE,this.positionMenuConfig.btnQAndA.y*window.GameConfig.RESIZE,this.positionMenuConfig.btnQAndA.nameAtlas,this.positionMenuConfig.btnQAndA.nameSprite),this.btn.inputEnabled=!0,this.btn.anchor.set(.5),this.txtBtn=new Phaser.Text(game,this.positionMenuConfig.txt_QAndA.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_QAndA.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_QAndA.text,this.positionMenuConfig.txt_QAndA.configs),this.txtBtn.anchor.set(.5),this.btn.addChild(this.txtBtn),this.addChild(this.btn)}},{key:"addAnimCircleScale",value:function(){this.animCircleScale=new Phaser.Sprite(game,0,0,"CircleScale"),this.animCircleScale.anchor.set(.5),this.btn.addChild(this.animCircleScale)}},{key:"addAnimButtonInOut",value:function(){this.animButtonInOut=new Phaser.Sprite(game,0,0,"ButtonQuest"),this.animButtonInOut.anchor.set(.5),this.btn.addChild(this.animButtonInOut)}},{key:"addAnim",value:function(){this.animCircleScale.animations.add("run_scale_circle");this.animCircleScale.animations.play("run_scale_circle",30,!0);this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",15,!0)}},{key:"runAnim",value:function(){this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",25,!0)}},{key:"scrollChange",value:function(){this.txtBtn.kill();var e=game.add.tween(this.btn).to({x:this.positionMenuConfig.btnQAndA.x*window.GameConfig.RESIZE+115},70,"Linear",!0);game.add.tween(this.btn).to({y:65},150,"Linear",!0).start(),e.start()}},{key:"scrollDefault",value:function(){this.txtBtn.revive();var e=game.add.tween(this.btn).to({x:this.positionMenuConfig.btnQAndA.x*window.GameConfig.RESIZE},150,"Linear",!0);game.add.tween(this.btn).to({y:this.positionMenuConfig.btnQAndA.y*window.GameConfig.RESIZE},70,"Linear",!0).start(),e.start()}},{key:"addDotNoti",value:function(e){if(e>0){this.runAnim();var t=new Phaser.Sprite(game,this.positionMenuConfig.notiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.y*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.nameAtlas,this.positionMenuConfig.notiDot.nameSprite),n=new Phaser.Text(game,this.positionMenuConfig.txtNotiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.txtNotiDot.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txtNotiDot.configs);n.anchor.set(.5),t.addChild(n),this.btn.addChild(t)}}}])&&$C(n.prototype,i),o&&$C(n,o),t}();function ok(e){return(ok="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ak(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sk(e,t){return!t||"object"!==ok(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rk(e){return(rk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lk(e,t){return(lk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hk=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=sk(this,rk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.outSize=!0,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.animCircleScale,this.animButtonInOut,this.addBtn(),this.addAnimButtonInOut(),this.runAnim()}},{key:"addBtn",value:function(){this.btn=new Phaser.Sprite(game,this.positionMenuConfig.btnRanking.x*window.GameConfig.RESIZE,this.positionMenuConfig.btnRanking.y*window.GameConfig.RESIZE,this.positionMenuConfig.btnRanking.nameAtlas,this.positionMenuConfig.btnRanking.nameSprite),this.btn.inputEnabled=!0,this.btn.anchor.set(.5),this.txtBtn=new Phaser.Text(game,this.positionMenuConfig.txt_rank.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_rank.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_rank.text,this.positionMenuConfig.txt_rank.configs),this.txtBtn.anchor.set(.5),this.btn.addChild(this.txtBtn),this.addChild(this.btn)}},{key:"addAnimCircleScale",value:function(){this.animCircleScale=new Phaser.Sprite(game,0,0,"CircleScale"),this.animCircleScale.anchor.set(.5),this.btn.addChild(this.animCircleScale)}},{key:"addAnimButtonInOut",value:function(){this.animButtonInOut=new Phaser.Sprite(game,0,0,"ButtonRank"),this.animButtonInOut.anchor.set(.5),this.btn.addChild(this.animButtonInOut)}},{key:"scrollChange",value:function(){this.txtBtn.kill();var e=game.add.tween(this.btn).to({x:this.positionMenuConfig.btnRanking.x*window.GameConfig.RESIZE-115},70,"Linear",!0);game.add.tween(this.btn).to({y:65},150,"Linear",!0).start(),e.start()}},{key:"scrollDefault",value:function(){this.txtBtn.revive();var e=game.add.tween(this.btn).to({x:this.positionMenuConfig.btnRanking.x*window.GameConfig.RESIZE},150,"Linear",!0);game.add.tween(this.btn).to({y:this.positionMenuConfig.btnRanking.y*window.GameConfig.RESIZE},70,"Linear",!0).start(),e.start()}},{key:"runAnim",value:function(){this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",25,!0)}}])&&ak(n.prototype,i),o&&ak(n,o),t}();function ck(e){return(ck="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dk(e,t){return!t||"object"!==ck(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fk(e){return(fk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pk(e,t){return(pk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gk=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=dk(this,fk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.inputEnabled=!0,e.outSize=!0,e.event={gotToEvent:new Phaser.Signal},e.isEvent=!1,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.animCircleScale,this.animButtonInOut,this.addBtn(),this.addAnimCircleScale(),this.addAnimButtonInOut()}},{key:"addBtn",value:function(){this.btn=new Phaser.Sprite(game,this.positionMenuConfig.btnEvent.x*window.GameConfig.RESIZE,this.positionMenuConfig.btnEvent.y*window.GameConfig.RESIZE,this.positionMenuConfig.btnEvent.nameAtlas,this.positionMenuConfig.btnEvent.nameSprite),this.btn.anchor.set(.5),this.btn.inputEnabled=!0,this.btn.events.onInputUp.add(this.onClickBtn,this),this.txtBtn=new Phaser.Text(game,this.positionMenuConfig.txt_event.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_event.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_event.text,this.positionMenuConfig.txt_event.configs),this.txtBtn.anchor.set(.5),this.btn.addChild(this.txtBtn),this.addChild(this.btn)}},{key:"onClickBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.gotToEvent.dispatch()}},{key:"addAnimCircleScale",value:function(){this.animCircleScale=new Phaser.Sprite(game,0,0,"CircleScale"),this.animCircleScale.anchor.set(.5),this.btn.addChild(this.animCircleScale)}},{key:"addAnimButtonInOut",value:function(){this.animButtonInOut=new Phaser.Sprite(game,0,0,"ButtonEvent"),this.animButtonInOut.anchor.set(.5),this.btn.addChild(this.animButtonInOut)}},{key:"runAnim",value:function(){this.isEvent=!0;this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",25,!0);this.animCircleScale.animations.add("run_scale_circle");this.animCircleScale.animations.play("run_scale_circle",30,!0)}},{key:"scrollChange",value:function(){this.txtBtn.kill(),game.add.tween(this.btn).to({y:65},150,"Linear",!0).start(),1==this.isEvent&&this.animCircleScale.animations.stop("run_scale_circle",!0)}},{key:"scrollDefault",value:function(){this.txtBtn.revive(),game.add.tween(this.btn).to({y:this.positionMenuConfig.btnEvent.y*window.GameConfig.RESIZE},150,"Linear",!0).start(),1==this.isEvent&&this.animCircleScale.animations.play("run_scale_circle",30,!0)}},{key:"addDotNoti",value:function(e){if(e>0){this.runAnim();var t=new Phaser.Sprite(game,this.positionMenuConfig.notiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.y*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.nameAtlas,this.positionMenuConfig.notiDot.nameSprite),n=new Phaser.Text(game,this.positionMenuConfig.txtNotiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.txtNotiDot.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txtNotiDot.configs);n.anchor.set(.5),t.addChild(n),this.btn.addChild(t)}}}])&&uk(n.prototype,i),o&&uk(n,o),t}();function yk(e){return(yk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vk(e,t){return!t||"object"!==yk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wk(e){return(wk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bk(e,t){return(bk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sk=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=vk(this,wk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={claimHourRewardDone:new Phaser.Signal},e.user_id=0,e.user_name="",e.avatar="",e.gender="",e.experience_score=0,e.heart=0,e.diamond=0,e.ticket=0,e.weekly_high_score=0,e.all_time_high_score=0,e.u_level=0,e.level_title="",e.user_id=mZ.instance().dataMySeft.user_id,e.user_name=mZ.instance().dataMySeft.user_name,e.avatar=mZ.instance().dataMySeft.avatar,e.gender=mZ.instance().dataMySeft.gender,e.experience_score=mZ.instance().dataMySeft.experience_score,e.heart=mZ.instance().dataMySeft.heart,e.diamond=mZ.instance().dataMySeft.diamond,e.ticket=mZ.instance().dataMySeft.ticket,e.weekly_high_score=mZ.instance().dataMySeft.weekly_high_score,e.all_time_high_score=mZ.instance().dataMySeft.all_time_high_score,e.u_level=mZ.instance().dataMySeft.level,e.level_title=mZ.instance().socket.mySelf.getVariable("level_title").value,e.addEventExtension(),e.addHeartAndtxtHeart(e.heart),e.addDiamondAndTxtDiamond(e.diamond),e.addTicketAndTxtTicket(e.ticket),e.addDoc(),e.addAvaAndName(e.user_name),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bk(e,t)}(t,Phaser.Group),n=t,o=[{key:"UPDATE_AVA",get:function(){return"update_ava"}},{key:"UPDATE_NAME",get:function(){return"update_name"}}],(i=[{key:"addEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this)}},{key:"onUpdateUserVars",value:function(){mZ.instance().dataMySeft.user_id==this.user_id&&(parseInt(this.txt_diamond.text)!==mZ.instance().dataMySeft.diamond&&(this.txt_diamond.text=mZ.instance().dataMySeft.diamond),parseInt(this.txt_heart.text)!==mZ.instance().dataMySeft.heart&&(this.txt_heart.text=mZ.instance().dataMySeft.heart),parseInt(this.txt_ticket.text)!==mZ.instance().dataMySeft.ticket&&(this.txt_ticket.text=mZ.instance().dataMySeft.ticket))}},{key:"updateValue",value:function(e){e==t.UPDATE_AVA||e==t.UPDATE_NAME&&(this.user_name=mZ.instance().dataMySeft.user_name,this.nameFB.setText(this.user_name))}},{key:"addAvaAndName",value:function(e){this.maskAva=null,this.ava=null,this.addAva(),this.addNameAndLvl(e),this.loadAva()}},{key:"addFrameAva",value:function(){if(this.user_vip=!1,1==this.user_vip){this.frameAvatar=new Phaser.Sprite(game,this.positionMenuConfig.frame_ava_vip.x*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip.y*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip.nameAtlas,this.positionMenuConfig.frame_ava_vip.nameSprite),this.frameAvatar.anchor.set(.5),this.frameAvatar.scale.set(145/140*window.GameConfig.RESIZE);var e=new Phaser.Sprite(game,this.positionMenuConfig.frame_ava_vip_icon.x*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip_icon.y*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip_icon.nameAtlas,this.positionMenuConfig.frame_ava_vip_icon.nameSprite);e.anchor.set(.5),this.frameAvatar.addChild(e),this.laurel=new Phaser.Sprite(game,this.positionMenuConfig.frame_ava_vip_laurel.x*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip_laurel.y*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip_laurel.nameAtlas,this.positionMenuConfig.frame_ava_vip_laurel.nameSprite),this.laurel.anchor.set(.5),this.frameAvatar.addChild(this.laurel)}else this.frameAvatar=new Phaser.Sprite(game,this.positionMenuConfig.frame_ava.x*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava.y*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava.nameAtlas,this.positionMenuConfig.frame_ava.nameSprite),this.frameAvatar.anchor.set(.5),this.frameAvatar.scale.set(145/140*window.GameConfig.RESIZE)}},{key:"addAva",value:function(){this.addFrameAva()}},{key:"loadAva",value:function(){if(null!==mZ.instance().dataMySeft){var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.image("ava_fb",this.avatar),e.onLoadComplete.add(this.onLoad,this),1==game.cache.checkImageKey("ava_fb")?this.onLoad():e.start()}}},{key:"onLoad",value:function(){var e=this;null==this.maskAva&&(this.maskAva=new Phaser.Graphics(game,0,0)),this.maskAva.clear(),this.maskAva.drawCircle(0,0,148*window.GameConfig.RESIZE),this.maskAva.anchor.set(.5),this.avaBox=new Phaser.Sprite(game,this.positionMenuConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionMenuConfig.ava_fb.y*window.GameConfig.RESIZE,null),this.addChild(this.avaBox),null!==this.ava&&(this.removeChild(this.ava),this.ava.destroy(),this.ava=null),1==game.cache.checkImageKey("ava_fb")?this.ava=new Phaser.Button(game,0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,"ava_fb"):this.ava=new Phaser.Button(game,0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,"songDetailSprites",function(){},this,null,"ava-default"),this.ava.anchor.set(.5),this.ava.width=148,this.ava.height=148,this.ava.mask=this.maskAva,this.avaBox.addChild(this.maskAva),this.avaBox.addChild(this.ava),this.addChild(this.frameAvatar),this.ava.events.onInputUp.add(function(){iC.instance().addUserProfile(e.user_id)}),1==z.instance().isScrollChange?this.scrollChange():this.scrollDefault()}},{key:"addNameAndLvl",value:function(e){e=Bn.formatName(e,25),this.nameFB=new Phaser.Text(game,320*window.GameConfig.RESIZE,238*window.GameConfig.RESIZE,e,{font:"GilroyBold",fill:"white",fontSize:26*window.GameConfig.RESIZE}),this.nameFB.anchor.set(.5),this.addChild(this.nameFB),this.u_level=new Phaser.Text(game,320*window.GameConfig.RESIZE,270*window.GameConfig.RESIZE,"LV ".concat(this.u_level," - ").concat(this.level_title),{font:"".concat(19*window.GameConfig.RESIZE,"px GilroyMedium"),fill:"orange",boundsAlignH:"center",boundsAlignV:"middle"}),this.u_level.anchor.set(.5),this.u_level.addColor("#ffffff",6),this.addChild(this.u_level)}},{key:"addHeartAndtxtHeart",value:function(e){var t=this;this.heartSprite=new Phaser.Sprite(game,this.positionMenuConfig.heart.x*window.GameConfig.RESIZE,this.positionMenuConfig.heart.y*window.GameConfig.RESIZE,this.positionMenuConfig.heart.nameAtlas,this.positionMenuConfig.heart.nameSprite),this.heartSprite.anchor.set(.5),this.addChild(this.heartSprite),this.txt_heart=new Phaser.Text(game,this.positionMenuConfig.txt_heart.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_heart.y*window.GameConfig.RESIZE,"".concat(e).concat(this.positionMenuConfig.txt_heart.text),this.positionMenuConfig.txt_heart.configs),this.txt_heart.anchor.set(0,.5),this.addChild(this.txt_heart),mZ.instance().events.onUserVarsUpdate.add(function(){t.txt_heart.setText("".concat(mZ.instance().socket.mySelf.getVariable("heart").value).concat(t.positionMenuConfig.txt_heart.text))},this)}},{key:"addDiamondAndTxtDiamond",value:function(e){this.diamondSprite=new Phaser.Button(game,this.positionMenuConfig.diamond.x*window.GameConfig.RESIZE,this.positionMenuConfig.diamond.y*window.GameConfig.RESIZE,this.positionMenuConfig.diamond.nameAtlas,function(){},this,null,this.positionMenuConfig.diamond.nameSprite),this.diamondSprite.anchor.set(.5),this.addChild(this.diamondSprite),this.txt_diamond=new Phaser.Text(game,this.positionMenuConfig.txt_diamond.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_diamond.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txt_diamond.configs),this.txt_diamond.anchor.set(0,.5),this.addChild(this.txt_diamond)}},{key:"addTicketAndTxtTicket",value:function(e){this.ticketSprite=new Phaser.Sprite(game,this.positionMenuConfig.ticket.x*window.GameConfig.RESIZE,this.positionMenuConfig.ticket.y*window.GameConfig.RESIZE,this.positionMenuConfig.ticket.nameAtlas,this.positionMenuConfig.ticket.nameSprite),this.ticketSprite.anchor.set(.5),this.addChild(this.ticketSprite),this.txt_ticket=new Phaser.Text(game,this.positionMenuConfig.txt_ticket.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_ticket.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txt_ticket.configs),this.txt_ticket.anchor.set(0,.5),this.addChild(this.txt_ticket)}},{key:"addDoc",value:function(){this.groupDoc=new Phaser.Group(game,0,0);var e=new rt(this.positionMenuConfig.line_doc1);this.groupDoc.add(e);var t=new rt(this.positionMenuConfig.line_doc2);this.groupDoc.add(t),this.addChild(this.groupDoc)}},{key:"claimHourReward",value:function(e){var t=this;this.hours_reward_setting=e;iC.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:this.hours_reward_setting.reward_type,reward:this.hours_reward_setting.reward,finishPoint:{x:315,y:303}}),this.timeClaimHourReward=game.time.events.add(2*Phaser.Timer.SECOND,function(){if("DIAMOND"==e.reward_type){var n=game.add.tween(t.txt_diamond).to({text:mZ.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.txt_diamond.text=parseInt(t.txt_diamond.text)},t),n.onComplete.add(t.completeClaim,t)}else e.reward_type;z.instance().isRefreshMenu.checking=!1},this)}},{key:"completeClaim",value:function(){this.event.claimHourRewardDone.dispatch()}},{key:"scrollChange",value:function(){1==this.user_vip&&game.add.tween(this.laurel).to({alpha:0},150,"Linear",!0).start();if(null!==this.ava){var e=game.add.tween(this.ava).to({width:103.6*window.GameConfig.RESIZE,height:103.6*window.GameConfig.RESIZE},150,"Linear",!0),t=game.add.tween(this.frameAvatar.scale).to({x:.725*window.GameConfig.RESIZE,y:.725*window.GameConfig.RESIZE},150,"Linear",!0);e.start(),t.start();var n=game.add.tween(this.avaBox).to({y:this.positionMenuConfig.ava_fb.y-50},150,"Linear",!0),i=game.add.tween(this.frameAvatar).to({y:this.positionMenuConfig.frame_ava.y-50},150,"Linear",!0);n.start(),i.start(),game.add.tween(this.maskAva.scale).to({x:.7,y:.7},150,"Linear",!0).start()}this.nameFB.kill(),this.u_level.kill(),this.diamondSprite.kill(),this.txt_diamond.kill(),this.heartSprite.kill(),this.txt_heart.kill(),this.ticketSprite.kill(),this.txt_ticket.kill();for(var o=0;o<this.groupDoc.children.length;o++)this.groupDoc.children[o].kill()}},{key:"scrollDefault",value:function(){1==this.user_vip&&game.add.tween(this.laurel).to({alpha:1},150,"Linear",!0).start();if(null!==this.ava){var e=game.add.tween(this.ava).to({width:148*window.GameConfig.RESIZE,height:148*window.GameConfig.RESIZE},150,"Linear",!0),t=game.add.tween(this.frameAvatar.scale).to({x:145/140*window.GameConfig.RESIZE,y:145/140*window.GameConfig.RESIZE},150,"Linear",!0);e.start(),t.start();var n=game.add.tween(this.avaBox).to({y:this.positionMenuConfig.ava_fb.y},150,"Linear",!0),i=game.add.tween(this.frameAvatar).to({y:this.positionMenuConfig.frame_ava.y},150,"Linear",!0);n.start(),i.start(),game.add.tween(this.maskAva.scale).to({x:1,y:1},150,"Linear",!0).start()}void 0!==this.nameFB&&this.nameFB.revive(),this.u_level.revive(),void 0!==this.diamondSprite&&this.diamondSprite.revive(),this.txt_diamond.revive(),this.heartSprite.revive(),this.txt_heart.revive(),this.ticketSprite.revive(),this.txt_ticket.revive();for(var o=0;o<this.groupDoc.children.length;o++)this.groupDoc.children[o].revive()}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timeClaimHourReward);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&mk(n.prototype,i),o&&mk(n,o),t}();function _k(e){return(_k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ek(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ck(e,t){return!t||"object"!==_k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kk(e){return(kk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pk(e,t){return(Pk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ok=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Ck(this,kk(t).call(this,game))).x=e,o.y=n,o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.type=i,o.event={clickTab:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.layoutBot=new Phaser.Group(game),this.layoutTop=new Phaser.Group(game),this.addChild(this.layoutBot),this.addChild(this.layoutTop),this.bgTab,this.txtTab,this.lineUnderTab,this.addBGTab(),this.addTxtTab(),this.addLineUnderTab()}},{key:"addBGTab",value:function(){this.bgTab=new Phaser.Button(game,this.positionMenuConfig.mail.tab_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.tab_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.mail.tab_active.nameAtlas,this.onClickTab,this,null,this.positionMenuConfig.mail.tab_active.nameSprite),this.bgTab.anchor.set(.5),this.layoutBot.addChild(this.bgTab)}},{key:"addTxtTab",value:function(){this.txtTab=new Phaser.Text(game,this.positionMenuConfig.mail.txt_tab.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.txt_tab.y*window.GameConfig.RESIZE,this.type,this.positionMenuConfig.mail.txt_tab.style),this.txtTab.anchor.set(.5),this.layoutBot.addChild(this.txtTab)}},{key:"addLineUnderTab",value:function(){this.lineUnderTab=new rt(this.positionMenuConfig.mail.line_gradient),this.lineUnderTab.anchor.set(.5),this.layoutBot.addChild(this.lineUnderTab)}},{key:"onClickTab",value:function(){ce.instance().playSound(ce.buttonclick),this.event.clickTab.dispatch()}},{key:"setActive",value:function(){this.txtTab.addColor("#ffffff",0),this.bgTab.loadTexture("mailSprites","Header_tab_Active"),this.lineUnderTab.revive()}},{key:"setDisActive",value:function(){this.txtTab.addColor("#93909d",0),this.bgTab.loadTexture("mailSprites","Header_tab_disActive"),this.lineUnderTab.kill()}},{key:"addCountUnread",value:function(e){null==this.noti&&(this.noti=new rt(this.positionMenuConfig.count_unread),this.noti.kill(),this.noti.anchor.set(.5),this.countUnread=new St(this.positionMenuConfig.txt_count_unread,this.positionMenuConfig.txt_count_unread.text),this.countUnread.anchor.set(.5),this.noti.addChild(this.countUnread),this.layoutTop.addChild(this.noti)),e>0?(this.noti.revive(),this.countUnread.setText(e)):this.noti.kill()}}])&&Ek(n.prototype,i),o&&Ek(n,o),t}();function Rk(e){return(Rk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Tk(e,t){return!t||"object"!==Rk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ik(e){return(Ik=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ak(e,t){return(Ak=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lk=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Tk(this,Ik(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),i.messenger=e,i.index=n,i.event={choosedMessenger:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ak(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.avatar,this.userName,this.message,this.sentTime,void 0!==this.messenger.updated&&(this.addAva(),this.addMaskAva(68),this.addUserName(),this.addMessage(),this.addSentTime(),this.beginLoad(),this.addBtn(),this.addLineUnder())}},{key:"addBtn",value:function(){this.btn=new Phaser.Button(game,0,0,"otherSprites",function(){},this,null,"tab-friend"),this.btn.alpha=0,this.btn.onInputUp.add(this.choosedMessenger,this),this.addChild(this.btn)}},{key:"addAva",value:function(){this.avatar=new Phaser.Sprite(game,this.positionMenuConfig.mail.ava.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava.y*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava.nameAtlas,this.positionMenuConfig.mail.ava.nameSprite),this.avatar.anchor.set(.5),this.addChild(this.avatar)}},{key:"addMaskAva",value:function(e){this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(),this.maskAva.drawCircle(this.positionMenuConfig.mail.ava.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava.y*window.GameConfig.RESIZE,e),this.maskAva.endFill(),this.maskAva.anchor.set(.5),this.avatar.mask=this.maskAva,this.addChild(this.maskAva)}},{key:"addUserName",value:function(){this.userName=new Phaser.Text(game,this.positionMenuConfig.mail.userName.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.userName.y*window.GameConfig.RESIZE,Bn.formatName(this.messenger.user.user_name,30),this.positionMenuConfig.mail.userName.configs),this.messenger.user.user_name==mZ.instance().dataMySeft.user_name&&this.userName.setText(this.messenger.user.user_name),this.messenger.from==mZ.instance().socket.mySelf.getVariable("user_id").value?this.userName.addColor("#93909d",0):1==this.messenger.is_read&&this.userName.addColor("#93909d",0),this.addChild(this.userName)}},{key:"addMessage",value:function(){this.message=new Phaser.Text(game,this.positionMenuConfig.mail.message.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.message.y*window.GameConfig.RESIZE,this.messenger.message,this.positionMenuConfig.mail.message.configs),this.addChild(this.message)}},{key:"addSentTime",value:function(){this.monthAndDate="";var e=new Date(this.messenger.updated).toLocaleDateString("vi-VN");this.monthAndDate=e.slice(0,e.length-5),this.sentTime=new Phaser.Text(game,this.positionMenuConfig.mail.sentTime.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.sentTime.y*window.GameConfig.RESIZE,this.monthAndDate,this.positionMenuConfig.mail.sentTime.configs),this.addChild(this.sentTime)}},{key:"choosedMessenger",value:function(){ce.instance().playSound(ce.buttonclick),this.event.choosedMessenger.dispatch(this.messenger)}},{key:"addLineUnder",value:function(){var e=new rt(this.positionMenuConfig.mail.line_under);this.addChild(e)}},{key:"beginLoad",value:function(){if(this.avaUrl=this.messenger.user.avatar,game.cache.checkImageKey(this.avaUrl))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.avaUrl,this.avaUrl),e.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.avaUrl)&&""!==e.avaUrl&&e.avatar.loadTexture("".concat(e.avaUrl)),e.avatar.width=68,e.avatar.height=68}catch(e){}},30*this.index)}},{key:"loadStart",value:function(){}},{key:"height",get:function(){return 142*window.GameConfig.RESIZE}}])&&xk(n.prototype,i),o&&xk(n,o),t}();function Gk(e){return(Gk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Mk(e,t){return!t||"object"!==Gk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nk(e){return(Nk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bk(e,t){return(Bk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jk=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Mk(this,Nk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.list=e,n.event={countUnread:new Phaser.Signal},n.checkLoad=!1,n.now=n.getTimeNow(),n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"getTimeNow",value:function(){var e=(new Date).toISOString().split("T");return e[1]=e[1].split("Z"),e[1]=e[1][0],e}},{key:"afterInit",value:function(){this.chatScreen=null,this.group=new Phaser.Group(game),this.addChild(this.group);var e=new Phaser.Rectangle(0,207*window.GameConfig.RESIZE,game.width,(game.height-342)*window.GameConfig.RESIZE);this.listView=new Jo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.loadMessagesDone(),this.addEventExtension()}},{key:"addEventExtension",value:function(){De.instance().event.backChat.add(this.backChat,this),De.instance().event.loadMessagesDone.add(this.loadMessagesDone,this),De.instance().event.newMessage.add(this.newMessage,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backChat.remove(this.backChat,this),De.instance().event.loadMessagesDone.remove(this.loadMessagesDone,this),De.instance().event.newMessage.add(this.newMessage,this)}},{key:"newMessage",value:function(){this.ajaxGetListMail()}},{key:"loadMessagesDone",value:function(){0==this.checkLoad&&(null!==z.instance().dataMessagesLocal?(this.checkLoad=!0,void 0!==this.loadingAnim&&(this.loadingAnim.destroy(),this.removeChild(this.loadingAnim)),this.ajaxGetListMail()):(this.checkLoad=!1,this.loadingAnim=new Fe,this.addChild(this.loadingAnim)))}},{key:"backChat",value:function(){this.ajaxGetListMail()}},{key:"ajaxGetListMail",value:function(){this.onListMessageCallback(Pl.instance().listConversation(z.instance().dataMessagesLocal))}},{key:"onListMessageCallback",value:function(e){z.instance().messageData=e,this.handleResponseListMess(e),null!==this.listView&&void 0!==this.listView&&(this.listView.removeAll(),this.addMessenger())}},{key:"addMessenger",value:function(){for(var e=0;e<this.list.length;e++){var t=this.list[e],n=new Lk(t,e);n.event.choosedMessenger.add(this.choosedMessenger,this),this.listView.add(n)}}},{key:"choosedMessenger",value:function(e){this.addChatScreen(e)}},{key:"addChatScreen",value:function(e){var t={};t=e.from==mZ.instance().socket.mySelf.getVariable("user_id").value?{id:e.to,user_name:e.user.user_name,avatar:e.user.avatar}:{id:e.from,user_name:e.user.user_name,avatar:e.user.avatar},iC.instance().addChatScreen(t)}},{key:"handleResponseListMess",value:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);this.list=t}},{key:"countUnread",value:function(e){this.event.countUnread.dispatch(e)}},{key:"destroy",value:function(){for(null!==this.listView&&(this.listView.removeAll(),this.listView.destroy(),this.listView=null),this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Dk(n.prototype,i),o&&Dk(n,o),t}();function Uk(e){return(Uk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zk(e,t){return!t||"object"!==Uk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hk(e){return(Hk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qk(e,t){return(Qk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vk=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Zk(this,Hk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),i.messenger=e,i.index=n,i.event={choosedMessenger:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.avatar,this.userName,this.message,this.sentTime,this.addAva(),this.addMaskAva(68),this.addUserName(),this.addMessage(),this.addSentTime(),this.addBtn()}},{key:"addBtn",value:function(){this.btn=new Phaser.Button(game,0,0,"otherSprites",function(){},this,null,"tab-friend"),this.btn.alpha=0,this.btn.onInputUp.add(this.choosedMessenger,this),this.addChild(this.btn)}},{key:"addAva",value:function(){this.avatar=new Phaser.Sprite(game,this.positionMenuConfig.mail.ava_system.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava_system.y*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava_system.nameAtlas,this.positionMenuConfig.mail.ava_system.nameSprite),this.avatar.anchor.set(.5),this.addChild(this.avatar)}},{key:"addMaskAva",value:function(e){this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(),this.maskAva.drawCircle(0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,e),this.maskAva.endFill(),this.maskAva.anchor.set(.5),this.avatar.mask=this.maskAva,this.avatar.addChild(this.maskAva)}},{key:"addUserName",value:function(){this.userName=new Phaser.Text(game,this.positionMenuConfig.mail.userName.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.userName.y*window.GameConfig.RESIZE,"Hệ thống",this.positionMenuConfig.mail.userName.configs),this.addChild(this.userName),1==this.messenger.is_read&&this.userName.addColor("#93909d",0)}},{key:"addMessage",value:function(){this.message=new Phaser.Text(game,this.positionMenuConfig.mail.message.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.message.y*window.GameConfig.RESIZE,this.messenger.message,this.positionMenuConfig.mail.message.configs),this.addChild(this.message)}},{key:"addSentTime",value:function(){var e=new Date(this.messenger.created).toLocaleDateString("vi-VN");this.monthAndDate=e.slice(0,e.length-5),this.sentTime=new Phaser.Text(game,this.positionMenuConfig.mail.sentTime.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.sentTime.y*window.GameConfig.RESIZE,this.monthAndDate,this.positionMenuConfig.mail.sentTime.configs),this.addChild(this.sentTime)}},{key:"choosedMessenger",value:function(){ce.instance().playSound(ce.buttonclick),this.event.choosedMessenger.dispatch(this.messenger)}},{key:"beginLoad",value:function(e){if(this.avaUrl=e,game.cache.checkImageKey(this.avaUrl))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(this.avaUrl,this.avaUrl),t.start()}}},{key:"onLoad",value:function(){var e=this;game.cache.checkImageKey(this.avaUrl)&&setTimeout(function(){try{e.avatar.loadTexture("".concat(e.avaUrl))}catch(e){}},70*this.index)}},{key:"loadStart",value:function(){}},{key:"height",get:function(){return 142*window.GameConfig.RESIZE}}])&&Fk(n.prototype,i),o&&Fk(n,o),t}();function Wk(e){return(Wk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Kk(e,t){return!t||"object"!==Wk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zk(e){return(zk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yk(e,t){return(Yk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jk=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Kk(this,zk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.positionLoadConfig=JSON.parse(game.cache.getText("positionLoadConfig")),e.checkLoad=!1,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.isSeeMail=!1,this.group=new Phaser.Group(game),this.addChild(this.group);var e=new Phaser.Rectangle(0,207*window.GameConfig.RESIZE,game.width,(game.height-342)*window.GameConfig.RESIZE);this.listView=new Jo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.loadSystemMessagesDone(),this.addEventExtension()}},{key:"addEventExtension",value:function(){De.instance().event.backChat.add(this.backChat,this),De.instance().event.loadSystemMessagesDone.add(this.loadSystemMessagesDone,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backChat.remove(this.backChat,this),De.instance().event.loadSystemMessagesDone.remove(this.loadSystemMessagesDone,this)}},{key:"backChat",value:function(){this.ajaxGetListMail()}},{key:"loadSystemMessagesDone",value:function(){0==this.checkLoad&&(null!==z.instance().systemMessagesLocal?(this.checkLoad=!0,void 0!==this.loadingAnim&&(this.loadingAnim.destroy(),this.removeChild(this.loadingAnim)),this.ajaxGetListMail()):(this.checkLoad=!1,this.loadingAnim=new Fe,this.addChild(this.loadingAnim)))}},{key:"ajaxGetListMail",value:function(){this.onListSystemCallback(Pl.instance().getNotiSystem(z.instance().systemMessagesLocal.dataMessages))}},{key:"onListSystemCallback",value:function(e){z.instance().mailData=e,null!==this.listView&&void 0!==this.listView&&(this.listView.removeAll(),this.handleResponseListSystem(e),this.addListSystem())}},{key:"addListSystem",value:function(){for(var e=0;e<this.list.length;e++){var t=this.list[e],n=new Vk(t,e);n.event.choosedMessenger.add(this.choosedMessenger,this),this.listView.add(n)}}},{key:"choosedMessenger",value:function(e){iC.instance().addMailSystemScreen(e),this.isSeeMail=!0}},{key:"handleResponseListSystem",value:function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);this.list=t}},{key:"destroy",value:function(){for(null!==this.listView&&(this.listView.removeAll(),this.listView.destroy(),this.listView=null),this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&qk(n.prototype,i),o&&qk(n,o),t}();function Xk(e){return(Xk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eP(e,t){return!t||"object"!==Xk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tP(e){return(tP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nP(e,t){return(nP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iP=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=eP(this,tP(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.getData(),e.setData(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"getData",value:function(){this.listMailResponse=[]}},{key:"setData",value:function(){this.afterInit()}},{key:"afterInit",value:function(){this.addLayerTopBottom(),this.bg,this.searchTab,this.newsTab,this.systemTab,this.friendsTab,this.listViewNewsTab=null,this.listViewSystemTab=null,this.listViewFriendsTab=null,this.typeOfTab=null,this.addBG(),this.addSearchTab(),this.addNewsTab(),this.addSystemTab(),this.showTab(1),this.loadSystemMessagesDone(),Le.instance().logEvent(Le.Mail),this.addEventExtension()}},{key:"addLayerTopBottom",value:function(){this.layerBot=new Phaser.Group(game),this.addChild(this.layerBot),this.layerTop=new Phaser.Group(game),this.addChild(this.layerTop)}},{key:"countUnreadSystem",value:function(e){this.systemTab.addCountUnread(e)}},{key:"addBG",value:function(){this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.layerBot.addChild(this.bg)}},{key:"addSearchTab",value:function(){this.searchTab=new Phaser.Sprite(game,0,0,null),this.searchTab.inputEnabled=!0;var e=new rt(this.positionMenuConfig.mail.search_bg),t=new St(this.positionMenuConfig.mail.txt_search,this.positionMenuConfig.mail.txt_search.text);t.anchor.set(.5,0),e.addChild(t),this.searchTab.addChild(e),this.searchTab.events.onInputUp.add(this.onSearchTabInput,this),this.layerBot.addChild(this.searchTab)}},{key:"onSearchTabInput",value:function(){ce.instance().playSound(ce.buttonclick),this.searchTab.inputEnabled=!1}},{key:"addNewsTab",value:function(){this.newsTab=new Ok(160*window.GameConfig.RESIZE,153*window.GameConfig.RESIZE,"Tin nhắn"),this.newsTab.event.clickTab.add(this.onNewsTabInput,this),this.layerTop.addChild(this.newsTab)}},{key:"onNewsTabInput",value:function(){1==this.typeOfTab||(this.typeOfTab=1,this.showTab(1))}},{key:"addSystemTab",value:function(){this.systemTab=new Ok(480*window.GameConfig.RESIZE,153*window.GameConfig.RESIZE,"Hệ thống"),this.systemTab.event.clickTab.add(this.onSystemTabInput,this),this.layerTop.addChild(this.systemTab)}},{key:"onSystemTabInput",value:function(){2==this.typeOfTab||(this.typeOfTab=2,this.showTab(2))}},{key:"showTab",value:function(e){this.typeOfTab=e,1==e?(this.newsTab.setActive(),this.systemTab.setDisActive(),this.addMailTabNews(),this.removeMailTabSystem()):2==e&&(this.newsTab.setDisActive(),this.systemTab.setActive(),this.removeMailTabNews(),this.addMailTabSystem())}},{key:"addMailTabNews",value:function(){this.removeMailTabNews(),this.listViewNewsTab=new jk(this.listMailResponse),this.loadMessagesDone(),this.layerBot.addChild(this.listViewNewsTab)}},{key:"removeMailTabNews",value:function(){null!==this.listViewNewsTab&&(this.layerBot.removeChild(this.listViewNewsTab),this.listViewNewsTab.destroy(),this.listViewNewsTab=null)}},{key:"countUnread",value:function(e){this.newsTab.addCountUnread(e)}},{key:"addMailTabSystem",value:function(){this.removeMailTabSystem(),this.listViewSystemTab=new Jk,this.layerBot.addChild(this.listViewSystemTab)}},{key:"removeMailTabSystem",value:function(){null!==this.listViewSystemTab&&(this.layerBot.removeChild(this.listViewSystemTab),this.listViewSystemTab.destroy(),this.listViewSystemTab=null)}},{key:"addMailTabFriends",value:function(){this.removeMailTabFriends()}},{key:"removeMailTabFriends",value:function(){null!==this.listViewFriendsTab&&(this.removeChild(this.listViewFriendsTab),this.listViewFriendsTab.destroy(),this.listViewFriendsTab=null)}},{key:"addEventExtension",value:function(){De.instance().event.backSystemChat.add(this.backSystemChat,this),De.instance().event.loadMessagesDone.add(this.loadMessagesDone,this),De.instance().event.loadSystemMessagesDone.add(this.loadSystemMessagesDone,this),De.instance().event.backChat.add(this.backChat,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backSystemChat.remove(this.backSystemChat,this),De.instance().event.loadMessagesDone.remove(this.loadMessagesDone,this),De.instance().event.loadSystemMessagesDone.remove(this.loadSystemMessagesDone,this),De.instance().event.backChat.remove(this.backChat,this)}},{key:"loadMessagesDone",value:function(){null!==z.instance().dataMessagesLocal&&this.countUnread(Pl.instance().countNewMessages(z.instance().dataMessagesLocal.dataMessages))}},{key:"loadSystemMessagesDone",value:function(){null!==z.instance().systemMessagesLocal&&this.countUnreadSystem(Pl.instance().countSystemMessages(z.instance().systemMessagesLocal.dataMessages))}},{key:"backChat",value:function(){this.countUnread(Pl.instance().countNewMessages(z.instance().dataMessagesLocal.dataMessages)),this.showTab(1)}},{key:"backSystemChat",value:function(){this.countUnreadSystem(Pl.instance().countSystemMessages(z.instance().systemMessagesLocal.dataMessages)),this.showTab(2)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&$k(n.prototype,i),o&&$k(n,o),t}();function oP(e){return(oP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sP(e,t){return!t||"object"!==oP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rP(e){return(rP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lP(e,t){return(lP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hP=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=sP(this,rP(t).call(this,game,e,n,null))).type=2,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lP(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){}},{key:"createMail",value:function(){this.mailScreen=new iP,this.addChild(this.mailScreen)}},{key:"show",value:function(){game.add.tween(this).to({x:0},150,"Linear",!0)}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300},150,"Linear",!0);i.start(),i.onComplete.add(function(){t.destroy()},this)}}}])&&aP(n.prototype,i),o&&aP(n,o),t}();function cP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var uP=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"friend_requests",get:function(){return"friend_requests"}},{key:"user_2",get:function(){return"user_2"}},{key:"user_1",get:function(){return"user_1"}},{key:"created",get:function(){return"created"}},{key:"friend",get:function(){return"friend"}},{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"state",get:function(){return"state"}},{key:"is_aware",get:function(){return"is_aware"}},{key:"updated",get:function(){return"updated"}},{key:"is_onlines",get:function(){return"is_onlines"}}],(n=null)&&cP(t.prototype,n),i&&cP(t,i),e}();var dP=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_1=0,this.user_2=0,this.created=0,this.friend={user_id:0,user_name:"",avatar:"",is_online:!1},this.state="",this.is_aware=0,this.updated=0};function fP(e){return(fP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gP(e,t){return!t||"object"!==fP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yP(e,t,n){return(yP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mP(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function mP(e){return(mP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vP(e,t){return(vP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wP=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=gP(this,mP(t).call(this,game))).positionFriendRequestConfig=JSON.parse(game.cache.getText("positionFriendRequestConfig")),i.request=e,i.index=n,i.event={accept:new Phaser.Signal,decline:new Phaser.Signal,clickAva:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.ava,this.name,this.btnAccept,this.btnDecline,this.dotOnline,this.line,this.addAva(),this.addName(),this.addLineUnder(),this.addBtnAccept(),this.addBtnDecline(),this.addDotOnline(),this.loadAva()}},{key:"addAva",value:function(){var e=new Phaser.Graphics(game,0,0);e.drawCircle(this.positionFriendRequestConfig.request.ava.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.y*window.GameConfig.RESIZE,68*window.GameConfig.RESIZE),e.anchor.set(.5),this.addChild(e),this.ava=new Phaser.Sprite(game,this.positionFriendRequestConfig.request.ava.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.y*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.nameAtlas,this.positionFriendRequestConfig.request.ava.nameSprite),this.ava.anchor.set(.5),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.inputAva,this),this.ava.mask=e,this.addChild(this.ava)}},{key:"inputAva",value:function(){console.log(this.request.friend.user_id),this.event.clickAva.dispatch(this.request.friend.user_id)}},{key:"loadAva",value:function(){if(game.cache.checkImageKey(this.request.friend.avatar))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.request.friend.avatar,this.request.friend.avatar),e.start()}}},{key:"onLoad",value:function(){var e=this;this.timeOnload=game.time.events.add(.1*Phaser.Timer.SECOND*this.index,function(){try{""!==e.request.friend.avatar&&e.ava.loadTexture("".concat(e.request.friend.avatar)),e.ava.width=70,e.ava.height=70}catch(e){}},this)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"addName",value:function(){this.name=new St(this.positionFriendRequestConfig.request.name,this.request.friend.user_name),this.name.anchor.set(0,.5),this.addChild(this.name)}},{key:"addLineUnder",value:function(){this.line=new rt(this.positionFriendRequestConfig.request.line),this.addChild(this.line)}},{key:"addBtnAccept",value:function(){this.btnAccept=new pt(this.positionFriendRequestConfig.request.btn_accept,this.onClickAccept,this),this.btnAccept.anchor.set(.5);var e=new St(this.positionFriendRequestConfig.request.txt_accept,this.positionFriendRequestConfig.request.txt_accept.text);e.anchor.set(.5),this.btnAccept.addChild(e),this.addChild(this.btnAccept)}},{key:"onClickAccept",value:function(){this.btnAccept.inputEnabled=!1,this.event.accept.dispatch(this.request)}},{key:"addBtnDecline",value:function(){this.btnDecline=new pt(this.positionFriendRequestConfig.request.btn_decline,this.onClickDecline,this),this.btnDecline.anchor.set(.5);var e=new St(this.positionFriendRequestConfig.request.txt_decline,this.positionFriendRequestConfig.request.txt_decline.text);e.anchor.set(.5),this.btnDecline.addChild(e),this.addChild(this.btnDecline)}},{key:"onClickDecline",value:function(){this.event.decline.dispatch(this.request)}},{key:"addDotOnline",value:function(){1==this.request.friend.is_online?(this.dotOnline=new rt(this.positionFriendRequestConfig.request.online_icon),this.addChild(this.dotOnline)):(this.dotOnline=new rt(this.positionFriendRequestConfig.request.offline_icon),this.addChild(this.dotOnline))}},{key:"destroy",value:function(){game.time.events.remove(this.timeOnload),yP(mP(t.prototype),"destroy",this).call(this)}},{key:"height",get:function(){return 114*window.GameConfig.RESIZE}}])&&pP(n.prototype,i),o&&pP(n,o),t}();function bP(e){return(bP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _P(e,t){return!t||"object"!==bP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function EP(e){return(EP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CP(e,t){return(CP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kP=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=_P(this,EP(t).call(this,game))).friendRequestList=e,n.event={accept:new Phaser.Signal,decline:new Phaser.Signal,getUserProfile:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.listView;var e=new Phaser.Group(game);e.x=0,e.y=205*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-321)*window.GameConfig.RESIZE);this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var n=0;n<this.friendRequestList.length;n++){var i=new wP(this.friendRequestList[n],n);i.event.accept.add(this.acceptRequestFriend,this),i.event.decline.add(this.declineRequestFriend,this),i.event.clickAva.add(this.requestClickAva,this),this.listView.add(i)}}},{key:"acceptRequestFriend",value:function(e){this.event.accept.dispatch(e)}},{key:"declineRequestFriend",value:function(e){this.event.decline.dispatch(e)}},{key:"requestClickAva",value:function(e){this.event.getUserProfile.dispatch(e)}},{key:"destroy",value:function(){for(this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&SP(n.prototype,i),o&&SP(n,o),t}();function PP(e){return(PP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function RP(e,t){return!t||"object"!==PP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xP(e){return(xP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TP(e,t){return(TP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var IP=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=RP(this,xP(t).call(this,game,e,n,null))).inputEnabled=!0,o.anchor.set(.5),o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.positionFriendRequestConfig=JSON.parse(game.cache.getText("positionFriendRequestConfig")),o.type=i,o.event={clickTab:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TP(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.layoutBot=new Phaser.Sprite(game,0,0,null),this.layoutTop=new Phaser.Sprite(game,0,0,null),this.addChild(this.layoutBot),this.addChild(this.layoutTop),this.bgTab,this.txtTab,this.lineUnderTab,this.addBGTab(),this.addTxtTab(),this.addLineUnderTab(),this.addLineDoc()}},{key:"addBGTab",value:function(){this.bgTab=new Phaser.Button(game,this.positionFriendRequestConfig.tab_active.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.tab_active.y*window.GameConfig.RESIZE,this.positionFriendRequestConfig.tab_active.nameAtlas,this.onClickTab,this,null,this.positionFriendRequestConfig.tab_active.nameSprite),this.bgTab.anchor.set(.5),this.layoutBot.addChild(this.bgTab)}},{key:"addTxtTab",value:function(){this.txtTab=new Phaser.Text(game,this.positionMenuConfig.mail.txt_tab.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.txt_tab.y*window.GameConfig.RESIZE,this.type,this.positionMenuConfig.mail.txt_tab.style),this.txtTab.anchor.set(.5),this.layoutBot.addChild(this.txtTab)}},{key:"addLineUnderTab",value:function(){this.lineUnderTab=new rt(this.positionMenuConfig.mail.line_gradient),this.lineUnderTab.anchor.set(.5),this.layoutBot.addChild(this.lineUnderTab)}},{key:"onClickTab",value:function(){ce.instance().playSound(ce.buttonclick),this.event.clickTab.dispatch()}},{key:"setActive",value:function(){this.txtTab.addColor("#ffffff",0),this.lineUnderTab.revive()}},{key:"setDisActive",value:function(){this.txtTab.addColor("#93909d",0),this.lineUnderTab.kill()}},{key:"addLineDoc",value:function(){var e=new Phaser.Sprite(game,this.positionFriendRequestConfig.line_doc.x,this.positionFriendRequestConfig.line_doc.y,this.positionFriendRequestConfig.line_doc.nameAtlas,this.positionFriendRequestConfig.line_doc.nameSprite);e.anchor.set(.5),e.scale.set(3,1),this.layoutTop.addChild(e)}},{key:"addCountUnread",value:function(e){null==this.noti&&(this.noti=new rt(this.positionMenuConfig.count_unread),this.noti.kill(),this.noti.anchor.set(.5),this.countUnread=new St(this.positionMenuConfig.txt_count_unread,this.positionMenuConfig.txt_count_unread.text),this.countUnread.anchor.set(.5),this.noti.addChild(this.countUnread),this.layoutTop.addChild(this.noti)),e>0?(this.noti.revive(),this.countUnread.setText(e)):this.noti.kill()}},{key:"addCountFriend",value:function(e){this.txtTab.setText("".concat(this.type," (").concat(e,")"))}}])&&OP(n.prototype,i),o&&OP(n,o),t}();function AP(e){return(AP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GP(e,t){return!t||"object"!==AP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DP(e,t,n){return(DP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MP(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MP(e){return(MP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NP(e,t){return(NP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var BP=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=GP(this,MP(t).call(this,game))).positionFriendRequestConfig=JSON.parse(game.cache.getText("positionFriendRequestConfig")),i.friend=e,i.index=n,i.event={chat:new Phaser.Signal,clickAva:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.ava,this.name,this.btnAccept,this.btnDecline,this.dotOnline,this.line,this.addAva(),this.addName(),this.addLineUnder(),this.addChat(),this.addDotOnline(),this.loadAva()}},{key:"addAva",value:function(){var e=new Phaser.Graphics(game,0,0);e.drawCircle(this.positionFriendRequestConfig.request.ava.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.y*window.GameConfig.RESIZE,68*window.GameConfig.RESIZE),e.anchor.set(.5),this.addChild(e),this.ava=new Phaser.Sprite(game,this.positionFriendRequestConfig.request.ava.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.y*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.nameAtlas,this.positionFriendRequestConfig.request.ava.nameSprite),this.ava.anchor.set(.5),this.ava.scale.set(window.GameConfig.SCALE_AVA_FRIEND*window.GameConfig.RESIZE),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.inputAva,this),this.ava.mask=e,this.addChild(this.ava)}},{key:"inputAva",value:function(){this.event.clickAva.dispatch(this.friend.user_id)}},{key:"loadAva",value:function(){if(game.cache.checkImageKey(this.friend.avatar))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.friend.avatar,this.friend.avatar),e.start()}}},{key:"onLoad",value:function(){var e=this;this.timeOnload=game.time.events.add(.1*Phaser.Timer.SECOND*this.index,function(){try{""!==e.friend.avatar&&e.ava.loadTexture("".concat(e.friend.avatar)),e.ava.width=70,e.ava.height=70}catch(e){}},this)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"addName",value:function(){this.name=new St(this.positionFriendRequestConfig.request.name,this.friend.user_name),this.name.anchor.set(0,.5),this.addChild(this.name)}},{key:"addLineUnder",value:function(){this.line=new rt(this.positionFriendRequestConfig.request.line),this.addChild(this.line)}},{key:"addDotOnline",value:function(){1==this.friend.is_online?(this.dotOnline=new rt(this.positionFriendRequestConfig.request.online_icon),this.addChild(this.dotOnline)):(this.dotOnline=new rt(this.positionFriendRequestConfig.request.offline_icon),this.addChild(this.dotOnline))}},{key:"addChat",value:function(){this.btnChat=new pt(this.positionFriendRequestConfig.request.icon_chat,this.onClickChat,this),this.btnChat.anchor.set(.5),this.addChild(this.btnChat)}},{key:"onClickChat",value:function(){this.event.chat.dispatch({avatar:this.friend.avatar,is_online:this.friend.is_online,status:this.friend.status,id:this.friend.user_id,user_name:this.friend.user_name})}},{key:"destroy",value:function(){game.time.events.remove(this.timeOnload),DP(MP(t.prototype),"destroy",this).call(this)}},{key:"height",get:function(){return 114*window.GameConfig.RESIZE}}])&&LP(n.prototype,i),o&&LP(n,o),t}();function jP(e){return(jP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function FP(e,t){return!t||"object"!==jP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZP(e){return(ZP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HP(e,t){return(HP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var QP=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=FP(this,ZP(t).call(this,game))).friendlist=e,n.event={getUserProfile:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.listView,this.ktBuild=!1,this.idx=0,this.countItem=0;var e=new Phaser.Group(game);e.x=0,e.y=205*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-321)*window.GameConfig.RESIZE);this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.listView.events.changeIndex.add(this.changeIndex,this),this.buildItemPage()}},{key:"changeIndex",value:function(){var e=this.listView.getIdx();this.buildChangeIndex(e)}},{key:"buildChangeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){var e=this.friendlist;this.ktBuild=!0;for(var t=this.idx;t<e.length;t++){var n=new BP(this.friendlist[t],t);if(n.event.clickAva.add(this.requestClickAva,this),n.event.chat.add(this.requestChat,this),this.listView.add(n),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<e.length){this.ktBuild=!1;break}this.idx===e.length&&(this.ktBuild=!1)}}},{key:"requestChat",value:function(e){console.log("FRIEND"),console.log(e),iC.instance().addChatScreen(e)}},{key:"requestClickAva",value:function(e){this.event.getUserProfile.dispatch(e)}},{key:"destroy",value:function(){for(this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&UP(n.prototype,i),o&&UP(n,o),t}();function VP(e){return(VP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qP(e,t){return!t||"object"!==VP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KP(e){return(KP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zP(e,t){return(zP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var YP=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=qP(this,KP(t).call(this,game))).positionFriendRequestConfig=JSON.parse(game.cache.getText("positionFriendRequestConfig")),e.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={back:new Phaser.Signal},e.friendRequestList=[],e.friendLists=[],e.isFriendTab=!0,e.afterInit(),e.addEventExtension(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.addChild(this.bg),this.layoutBot=new Phaser.Group(game),this.layoutTop=new Phaser.Group(game),this.addChild(this.layoutBot),this.addChild(this.layoutTop),this.header,this.frameScreen,this.scrollListRequest=null,this.scrollListFriend=null,this.dotCountFriend=null,this.addHeader(),this.addFrameScreen(),Le.instance().logEvent(Le.Friend_add)}},{key:"afterTweenDone",value:function(){this.sendFriendRequestLoadRequest(),this.sendFriendListLoadRequest()}},{key:"addHeader",value:function(){this.header=new rt(this.positionFriendRequestConfig.header.tab),this.txtHeader=new St(this.positionFriendRequestConfig.header.txt_header,this.positionFriendRequestConfig.header.txt_header.text),this.txtHeader.anchor.set(.5,0),this.header.addChild(this.txtHeader),this.addChild(this.header)}},{key:"addFrameScreen",value:function(){this.txtRequestAddFriend,this.lineUnderTxtRequestAddFriend,this.dotCountFriend,this.lineGradientUnderTxtRequestAddFriend,this.addFriendTab(),this.addRequestTab()}},{key:"addTxtRequestAddFriend",value:function(){this.txtRequestAddFriend=new St(this.positionFriendRequestConfig.txt_request_add_friend,this.positionFriendRequestConfig.txt_request_add_friend.text),this.addChild(this.txtRequestAddFriend)}},{key:"addFriendTab",value:function(){this.friendTab=new IP(160*window.GameConfig.RESIZE,153*window.GameConfig.RESIZE,"Danh sách bạn"),this.friendTab.event.clickTab.add(this.onClickTabFriend,this),this.layoutTop.addChild(this.friendTab)}},{key:"addRequestTab",value:function(){this.requestTab=new IP(480*window.GameConfig.RESIZE,153*window.GameConfig.RESIZE,"Lời mời kết bạn"),this.requestTab.event.clickTab.add(this.onClickTabRequest,this),this.requestTab.setDisActive(),this.layoutTop.addChild(this.requestTab)}},{key:"onClickTabFriend",value:function(){this.isFriendTab=!0,this.friendTab.setActive(),this.requestTab.setDisActive(),this.removeScollListRequest(),this.sendFriendListLoadRequest()}},{key:"onClickTabRequest",value:function(){this.isFriendTab=!1,this.friendTab.setDisActive(),this.requestTab.setActive(),this.removeScrollFriendList(),this.sendFriendRequestLoadRequest()}},{key:"addLineUnderTxtRequestAddFriend",value:function(){this.lineUnderTxtRequestAddFriend=new rt(this.positionFriendRequestConfig.line_under_txt_request_add_friend),this.addChild(this.lineUnderTxtRequestAddFriend)}},{key:"addDotCountFriend",value:function(){this.removeDotCount(),this.dotCountFriend=new rt(this.positionFriendRequestConfig.dot_count_friend),this.dotCountFriend.anchor.set(.5),this.addChild(this.dotCountFriend)}},{key:"removeDotCount",value:function(){null!==this.dotCountFriend&&(this.removeChild(this.dotCountFriend),this.dotCountFriend.destroy(),this.dotCountFriend=null)}},{key:"addNumberInDotCount",value:function(e){if(e>0){this.addDotCountFriend();var t=new Phaser.Text(game,0,2,e,this.positionMenuConfig.txtNotiDot.configs);t.anchor.set(.5),this.dotCountFriend.addChild(t)}}},{key:"addLineGradientUnderTxtRequestAddFriend",value:function(){this.lineGradientUnderTxtRequestAddFriend=new rt(this.positionFriendRequestConfig.line_gradient_under_txt_request_add_friend),this.lineGradientUnderTxtRequestAddFriend.anchor.set(0,.5),this.addChild(this.lineGradientUnderTxtRequestAddFriend)}},{key:"addScrollListRequest",value:function(){this.friendRequestList.length>0&&(this.removeScollListRequest(),this.scrollListRequest=new kP(this.friendRequestList),this.scrollListRequest.event.accept.add(this.acceptRequestFriend,this),this.scrollListRequest.event.decline.add(this.declineRequestFriend,this),this.scrollListRequest.event.getUserProfile.add(this.getUserProfile,this),this.layoutBot.addChild(this.scrollListRequest),1==this.isFriendTab?this.scrollListRequest.visible=!1:this.scrollListRequest.visible=!0)}},{key:"removeScollListRequest",value:function(){null!==this.scrollListRequest&&(this.removeChild(this.scrollListRequest),this.scrollListRequest.destroy(),this.scrollListRequest=null)}},{key:"addScrollFriendList",value:function(){this.friendLists.length>0&&(this.removeScrollFriendList(),this.scrollListFriend=new QP(this.friendLists),this.scrollListFriend.event.getUserProfile.add(this.getUserProfile,this),this.layoutBot.addChild(this.scrollListFriend),1==this.isFriendTab?this.scrollListFriend.visible=!0:this.scrollListFriend.visible=!1)}},{key:"removeScrollFriendList",value:function(){null!==this.scrollListFriend&&(this.removeChild(this.scrollListFriend),this.scrollListFriend.destroy(),this.scrollListFriend=null)}},{key:"acceptRequestFriend",value:function(e){this.sendUserFriendRequest(Gs.begin(Gs.ACTION_ACCEPT_ADD_REQUEST,e.friend.user_id))}},{key:"declineRequestFriend",value:function(e){this.sendUserFriendRequest(Gs.begin(Gs.ACTION_REFUSE_ADD_REQUEST,e.friend.user_id))}},{key:"getUserProfile",value:function(e){iC.instance().addUserProfile(e)}},{key:"sendUserFriendRequest",value:function(e){mZ.instance().sendData(Et.USER_FRIEND_REQUEST,e)}},{key:"onBack",value:function(){this.destroy(),this.event.back.dispatch()}},{key:"sendFriendRequestLoadRequest",value:function(){mZ.instance().sendData(Et.FRIEND_REQUEST_LOAD_REQUEST,null),qe.instance().showLoading()}},{key:"sendFriendListLoadRequest",value:function(){mZ.instance().sendData(Et.USER_FRIEND_LIST_LOAD_REQUEST,null),qe.instance().showLoading()}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){var t=this;qe.instance().hideLoading(),e.cmd==Et.FRIEND_REQUEST_LOAD_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.handleFriendRequestLoadResponse(e.params,function(){t.addScrollListRequest(),t.addNumberInDotCount(t.friendRequestList.length)}),e.cmd==Et.USER_FRIEND_RESPONSE&&"OK"==e.params.getUtfString("status")&&(this.removeScollListRequest(),this.dotCountFriend.destroy(),this.sendFriendRequestLoadRequest()),e.cmd==Et.USER_FRIEND_LIST_LOAD_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.handleParamsFriendsResponse(e.params,function(){t.friendTab.addCountFriend(t.friendLists.length),t.addScrollFriendList()})}},{key:"handleParamsFriendsResponse",value:function(e,t){this.friendLists=[];for(var n=e.getSFSArray("friends"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString("user_name"),s=o.getUtfString("avatar"),r=o.getInt("id"),l=o.getUtfString("status"),h=o.getBool("is_online");this.friendLists.push({user_name:a,avatar:s,user_id:r,is_online:h,status:l})}t()}},{key:"handleFriendRequestLoadResponse",value:function(e,t){for(var n=[],i=e.getSFSArray(uP.friend_requests),o=0;o<i.size();o++){var a=new dP,s=i.getSFSObject(o);a.user_1=s.getInt(uP.user_1),a.user_2=s.getInt(uP.user_2),a.created=s.getLong(uP.created);var r=s.getSFSObject(uP.friend);a.friend.user_id=r.getInt(uP.user_id),a.friend.user_name=r.getUtfString(uP.user_name),a.friend.avatar=r.getUtfString(uP.avatar),a.friend.is_online=r.getBool(uP.is_onlines),a.state=s.getUtfString(uP.state),a.is_aware=s.getInt(uP.is_aware),a.updated=s.getLong(uP.updated),n.push(a)}this.friendRequestList=n,t()}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&WP(n.prototype,i),o&&WP(n,o),t}();function JP(e){return(JP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $P(e,t){return!t||"object"!==JP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eO(e){return(eO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tO(e,t){return(tO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nO=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=$P(this,eO(t).call(this,game,e,n,null))).type=4,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addFriendScreen=null}},{key:"createAddFriendScreen",value:function(){this.addFriendScreen=new YP,this.addChild(this.addFriendScreen)}},{key:"show",value:function(){var e=this,t=game.add.tween(this).to({x:0},150,"Linear",!0);t.start(),t.onComplete.add(function(){e.addFriendScreen.afterTweenDone()})}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300*window.GameConfig.RESIZE},150,"Linear",!0);i.start(),i.onComplete.add(function(){t.destroy()},this)}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&XP(n.prototype,i),o&&XP(n,o),t}();function iO(e){return(iO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aO(e,t){return!t||"object"!==iO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sO(e){return(sO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rO(e,t){return(rO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lO=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=aO(this,sO(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={backMenu:new Phaser.Signal,changeOtherScreen:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rO(e,t)}(t,Phaser.Group),n=t,(i=[{key:"createButton",value:function(){}},{key:"createButtonOnNavigation",value:function(){this.addEventExtension(),this.shopScreen,this.mailScreen,this.addFriendScreen,this.typeNew,this.typeOld=1,this.layoutContent=new Phaser.Group(game),this.layoutTop=new Phaser.Group(game),this.addChild(this.layoutContent),this.addChild(this.layoutTop),this.navBG=this.addNavBG(),this.addChild(this.navBG),this.addFourBtnOnNavbar(),this.buildBtnArray(),this.addChildBtnToNavBG(),Bn.switchButton(this.btnArray,this.activeBtnArray,this.homeBtn,this.activehomeBtn),null!==z.instance().dataMessagesLocal&&this.ajaxCountMessage()}},{key:"addFourBtnOnNavbar",value:function(){this.homeBtn=this.addHomeBtn(),this.activehomeBtn=this.addActiveHomeBtn(),this.mailBtn=this.addMailBtn(),this.activeMailBtn=this.addActiveMailBtn(),this.addFriendBtn=this.addAddFriendBtn(),this.activeAddFriendBtn=this.addActiveAddFriendBtn()}},{key:"addChildBtnToNavBG",value:function(){this.navBG.addChild(this.homeBtn),this.navBG.addChild(this.activehomeBtn),this.navBG.addChild(this.activeMailBtn),this.navBG.addChild(this.mailBtn),this.navBG.addChild(this.activeAddFriendBtn),this.navBG.addChild(this.addFriendBtn)}},{key:"buildBtnArray",value:function(){this.activeBtnArray=[this.activehomeBtn,this.activeMailBtn,this.activeAddFriendBtn],this.btnArray=[this.homeBtn,this.mailBtn,this.addFriendBtn]}},{key:"addNavBG",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.menu_bg.x*window.GameConfig.RESIZE,game.height-61*window.GameConfig.RESIZE,this.positionMenuConfig.menu_bg.nameAtlas,function(){},this,null,this.positionMenuConfig.menu_bg.nameSprite);return e.anchor.set(.5),e}},{key:"addHomeBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_home.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_home.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_home.nameAtlas,this.onClickHomeBtn,this,null,this.positionMenuConfig.btn_home.nameSprite);return e.anchor.set(.5),e.type=1,e}},{key:"onClickHomeBtn",value:function(){ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.homeBtn,this.activehomeBtn),this.typeNew=1,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=1}},{key:"addActiveHomeBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_home_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_home_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_home_active.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_home_active.nameSprite);return e.anchor.set(.5),e}},{key:"addAddFriendBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_setting.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_setting.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_setting.nameAtlas,this.onClickSettingBtn,this,null,this.positionMenuConfig.btn_setting.nameSprite);return e.events.onInputUp.add(this.onClickFriendRequestBtn,this),e.anchor.set(.5),e.type=4,e}},{key:"onClickFriendRequestBtn",value:function(){Le.instance().logEvent(Le.Friend_add_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.addFriendBtn,this.activeAddFriendBtn),this.typeNew=4,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=4,this.noti&&this.noti.destroy()}},{key:"addActiveAddFriendBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_setting_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_setting_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_setting_active.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_setting_active.nameSprite);return e.anchor.set(.5),e}},{key:"addMailBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_mail.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_mail.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_mail.nameAtlas,this.onClickMailBtn,this,null,this.positionMenuConfig.btn_mail.nameSprite);return e.anchor.set(.5),e.type=2,e}},{key:"onClickMailBtn",value:function(){Le.instance().logEvent(Le.Mail_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.mailBtn,this.activeMailBtn),this.typeNew=2,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=2,this.notiMail&&this.notiMail.destroy()}},{key:"addActiveMailBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_mail_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_mail_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_mail_active.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_mail_active.nameSprite);return e.anchor.set(.5),e}},{key:"addShopBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_shop.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_shop.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_shop.nameAtlas,this.onClickShopBtn,this,null,this.positionMenuConfig.btn_shop.nameSprite);return e.anchor.set(.5),e.type=3,e}},{key:"onClickShopBtn",value:function(){ce.instance().playSound(ce.buttonclick),iC.instance().addShop(0)}},{key:"addActiveShopBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_shop_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_shop_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_shop_active.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_shop_active.nameSprite);return e.anchor.set(.5),e}},{key:"changeScreen",value:function(e,t){1==e?(this.hideScreen(e,t),WF.instance().changeScreen(Ce.MAIN_MENU)):2==e?(this.mailScreen=new hP(0,0,t),this.mailScreen.createMail(),this.layoutContent.addChild(this.mailScreen),this.mailScreen.show(),this.hideScreen(e,t),this.event.changeOtherScreen.dispatch()):3==e||4==e&&(this.addFriendScreen=new nO(0,0,t),this.addFriendScreen.createAddFriendScreen(),this.layoutContent.addChild(this.addFriendScreen),this.addFriendScreen.show(),this.hideScreen(e,t),this.event.changeOtherScreen.dispatch())}},{key:"hideScreen",value:function(e,t){1==t?LogConsole.log("don't do nothing"):2==t?this.mailScreen.hide(e):3==t?this.shopScreen.hide(e):4==t&&this.addFriendScreen.hide(e)}},{key:"addFriendRequest",value:function(e){if(e>0){this.noti=new Phaser.Sprite(game,this.positionMenuConfig.notiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.y*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.nameAtlas,this.positionMenuConfig.notiDot.nameSprite);var t=new Phaser.Text(game,this.positionMenuConfig.txtNotiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.txtNotiDot.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txtNotiDot.configs);t.anchor.set(.5),this.noti.addChild(t),this.addFriendBtn.addChild(this.noti)}}},{key:"ajaxCountMessage",value:function(){this.onCountMessageCallback(Pl.instance().countMessage(z.instance().dataMessagesLocal.dataMessages,z.instance().systemMessagesLocal.dataMessages))}},{key:"onCountMessageCallback",value:function(e){this.addMailNoti(e)}},{key:"addMailNoti",value:function(e){if(e>0){this.notiMail=new Phaser.Sprite(game,this.positionMenuConfig.notiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.y*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.nameAtlas,this.positionMenuConfig.notiDot.nameSprite);var t=new Phaser.Text(game,this.positionMenuConfig.txtNotiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.txtNotiDot.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txtNotiDot.configs);t.anchor.set(.5),this.notiMail.addChild(t),this.mailBtn.addChild(this.notiMail)}}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.backMenu,this),De.instance().event.loadMessagesDone.add(this.loadMessagesDone,this)}},{key:"backMenu",value:function(){this.event.backMenu.dispatch(),this.removeEventExtension()}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.backMenu,this),De.instance().event.loadMessagesDone.remove(this.loadMessagesDone,this)}},{key:"loadMessagesDone",value:function(){this.ajaxCountMessage()}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&oO(n.prototype,i),o&&oO(n,o),t}();function hO(e){return(hO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function uO(e,t){return!t||"object"!==hO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dO(e){return(dO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fO(e,t){return(fO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pO=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),uO(this,dO(t).call(this,game,e,n,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"add",value:function(e){this.addChild(e)}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&cO(n.prototype,i),o&&cO(n,o),t}();function gO(e){return(gO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mO(e,t){return!t||"object"!==gO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vO(e){return(vO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wO(e,t){return(wO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bO=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=mO(this,vO(t).call(this,game,e,n,null))).positionConfigs=JSON.parse(game.cache.getText("positionMenuConfig")),a.positionPracticeScreenConfig=JSON.parse(game.cache.getText("positionPracticeScreenConfig")),a.valueScale=window.GameConfig.SCALE_PLAYLIST_PRACTICE,a.configs=i,a.thumbUrl=null,a.thumb,a.namePlaylist=null,a.boxPrice=null,a.btnChoose,a.maskThumb,a.signalInput=new Phaser.Signal,a.signalBuyPlaylist=new Phaser.Signal,a.signalGetRanking=new Phaser.Signal,a.index=o,a.id=10*Math.random(),a.addEvent(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterCreate",value:function(){this.addThumb(),this.addNamePlaylist(),1!==this.configs.is_owner?this.addBoxPrice(this.positionPracticeScreenConfig.practice_box_price):this.addBtnChoose(this.positionPracticeScreenConfig.btn_choose)}},{key:"addThumb",value:function(){this.maskThumb=new Phaser.Graphics(game,0,0),this.maskThumb.beginFill(16777215),this.maskThumb.drawRoundedRect(0,0,165*window.GameConfig.RESIZE,165*window.GameConfig.RESIZE,10*window.GameConfig.RESIZE),this.addChild(this.maskThumb),this.thumb=new Phaser.Sprite(game,0,0,"songDetailSprites","Nhactre"),this.thumb.scale.set(window.GameConfig.SCALE_PLAYLIST_PRACTICE*window.GameConfig.RESIZE);var e=new Phaser.Sprite(game,10,10,"practiceMenuSprites","Ranking");this.thumb.addChild(e),this.thumb.mask=this.maskThumb,this.thumb.inputEnabled=!0,this.thumb.events.onInputUp.add(this.clickThumb,this),this.addChild(this.thumb)}},{key:"clickThumb",value:function(){this.signalGetRanking.dispatch(this.configs)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.inputEnabled=!1;var e={name:this.configs.name,id:this.configs.id};this.practicePlaylist=e,this.signalInput.dispatch(e)}},{key:"addBtnChoose",value:function(e){this.btnChoose=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnChoose.inputEnabled=!0,this.btnChoose.events.onInputUp.add(this.onClickSprite,this);var t=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs);t.anchor.set(.5,0),this.btnChoose.addChild(t),this.addChild(this.btnChoose)}},{key:"addNamePlaylist",value:function(){this.namePlaylist=new Phaser.Text(game,0,180*window.GameConfig.RESIZE,this.configs.name,{font:"Gilroy",fill:"#ffffff",wordWrap:!0,wordWrapWidth:150,maxLines:2,fontSize:20}),this.addChild(this.namePlaylist)}},{key:"addBoxPrice",value:function(e){LogConsole.log("has price"),this.boxPrice=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.boxPrice.inputEnabled=!0,this.boxPrice.events.onInputUp.add(this.onClickBuy,this);var t=this.addGem(this.positionPracticeScreenConfig.practice_gem_box_price),n=this.addPrice(this.positionPracticeScreenConfig.practice_txt_price),i=t.width+n.width;n.x=(this.boxPrice.width-i)/2-5*window.GameConfig.RESIZE,t.x=(this.boxPrice.width-i)/2+n.width+5*window.GameConfig.RESIZE,this.boxPrice.addChild(t),this.boxPrice.addChild(n),this.addChild(this.boxPrice)}},{key:"onClickBuy",value:function(){ce.instance().playSound(ce.buttonclick),this.playlistBuy=new Qh,this.playlistBuy=Object.assign({},this.playlistBuy,this.configs),console.log("HHHHH"),console.log(this.playlistBuy),iC.instance().buyItem(this.playlistBuy)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addPrice",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.configs.price,e.configs)}},{key:"loadThumb",value:function(){if(this.key=this.configs.thumb,game.cache.checkImageKey(this.configs.thumb))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.configs.thumb,this.configs.thumb),e.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.key)?e.thumb.loadTexture("".concat(e.key)):e.thumb.loadTexture("songDetailSprites","Nhactre")}catch(e){}},100*this.index)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case Js.SHOP_BUY_PLAYLIST_RESPONSE:"OK"==e.params.getUtfString("status")&&e.params.getInt("playlist_id")==this.configs.id&&this.signalBuyPlaylist.dispatch(this.configs)}}},{key:"destroy",value:function(){for(this.removeEvent();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&yO(n.prototype,i),o&&yO(n,o),t}();function SO(e){return(SO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function EO(e,t){return!t||"object"!==SO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function CO(e){return(CO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kO(e,t){return(kO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var PO=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=EO(this,CO(t).call(this,game))).index=i,e.afterCreate(n),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kO(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterCreate",value:function(e){this.key=e,this.ava=new Phaser.Sprite(game,0,0,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.scale.set(.35*window.GameConfig.RESIZE),this.addChild(this.ava),this.maskAva=new Phaser.Graphics(game,0,0),this.addMaskAva(),this.beginLoad()}},{key:"addMaskAva",value:function(){this.maskAva.beginFill(),this.maskAva.drawCircle(0,0,200),this.maskAva.endFill(),this.ava.mask=this.maskAva,this.ava.addChild(this.maskAva)}},{key:"beginLoad",value:function(){if(game.cache.checkImageKey(this.key))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadComplete.add(this.onLoad,this),e.image(this.key,this.key),e.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{""!==e.key?e.ava.loadTexture(e.key):e.ava.loadTexture("songDetailSprites","ava-default")}catch(e){}},50*this.index)}}])&&_O(n.prototype,i),o&&_O(n,o),t}();function OO(e){return(OO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xO(e,t){return!t||"object"!==OO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TO(e){return(TO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IO(e,t){return(IO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var AO=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=xO(this,TO(t).call(this,game,640,188*n*window.GameConfig.RESIZE,null))).positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),i.configs=e,i.index=n,i.isFinish=o,i.clickProfile=!1,i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.icon,this.number,this.ava,this.name,this.score,this.diamond,this.txtDiamond,this.ticket,this.txtTicket,this.line,this.addIcon(this.positionRankingConfig.rank[this.index+1]),this.addNumber(),this.addAva(),this.addName(),this.addCircle(this.positionRankingConfig.circle_stroke),this.addScore(),this.addLine(),this.addTweenMoveToScreen()}},{key:"addIcon",value:function(e){this.icon=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.addChild(this.icon)}},{key:"addNumber",value:function(){this.number=new Phaser.Text(game,85*window.GameConfig.RESIZE,47*window.GameConfig.RESIZE,"".concat(this.index+1),{font:"GilroyMedium",fill:"#ffffff",fontSize:21}),this.addChild(this.number)}},{key:"addAva",value:function(){this.ava=new PO(this.configs.avatar,this.index),this.ava.x=170*window.GameConfig.RESIZE,this.ava.y=58*window.GameConfig.RESIZE,this.ava.ava.inputEnabled=!0,this.ava.ava.events.onInputUp.add(this.onClickAvaGetUserProfile,this),this.addChild(this.ava)}},{key:"onClickAvaGetUserProfile",value:function(){0==this.clickProfile?(this.clickProfile=!1,iC.instance().addUserProfile(this.configs.user_id)):this.clickProfile=!1}},{key:"addName",value:function(){this.name=new Phaser.Text(game,225*window.GameConfig.RESIZE,38*window.GameConfig.RESIZE,this.configs.user_name,{font:"GilroyMedium",fill:"#ffffff",fontSize:22}),this.addChild(this.name)}},{key:"addCircle",value:function(e){this.circle=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.circle.anchor.set(1,0),this.addChild(this.circle)}},{key:"addScore",value:function(){this.score=new Phaser.Text(game,-27*window.GameConfig.RESIZE,28*window.GameConfig.RESIZE,this.configs.number_of_correct,{font:"GilroyMedium",fill:"#ffa33a",fontSize:20}),this.score.anchor.set(.5),this.circle.addChild(this.score)}},{key:"addDiamondScore",value:function(){this.diamond=new Phaser.Sprite(game,this.positionRankingConfig.diamond.x*window.GameConfig.RESIZE,this.positionRankingConfig.diamond.y*window.GameConfig.RESIZE,this.positionRankingConfig.diamond.nameAtlas,this.positionRankingConfig.diamond.nameSprite),this.addChild(this.diamond),this.txtDiamond=new Phaser.Text(game,this.positionRankingConfig.txt_diamond.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_diamond.y*window.GameConfig.RESIZE,3e3/(this.index+1),this.positionRankingConfig.txt_diamond.configs),this.addChild(this.txtDiamond)}},{key:"addTicketScore",value:function(){this.ticket=new Phaser.Sprite(game,this.positionRankingConfig.ticket.x*window.GameConfig.RESIZE,this.positionRankingConfig.ticket.y*window.GameConfig.RESIZE,this.positionRankingConfig.ticket.nameAtlas,this.positionRankingConfig.ticket.nameSprite),this.addChild(this.ticket),this.txtTicket=new Phaser.Text(game,this.positionRankingConfig.txt_ticket.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_ticket.y*window.GameConfig.RESIZE,30/(this.index+1),this.positionRankingConfig.txt_ticket.configs),this.addChild(this.txtTicket)}},{key:"addLine",value:function(){this.line=new rt(this.positionRankingConfig.line_under),this.addChild(this.line)}},{key:"addTweenMoveToScreen",value:function(){var e=this;setTimeout(function(){game.add.tween(e).to({x:0},250,"Linear",!0).start()},100*this.index)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}},{key:"height",get:function(){return 115*window.GameConfig.RESIZE}}])&&RO(n.prototype,i),o&&RO(n,o),t}();function LO(e){return(LO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function DO(e,t){return!t||"object"!==LO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MO(e){return(MO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NO(e,t){return(NO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var BO=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=DO(this,MO(t).call(this,game,640,188*n*window.GameConfig.RESIZE,null))).configs=e,o.positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),o.index=n,o.isFinish=i,o.clickProfile=!1,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.icon,this.number,this.ava,this.name,this.circle,this.score,this.line,this.addIcon(this.positionRankingConfig.rank.other),this.addNumber(),this.addAva(),this.addName(),this.addCircle(this.positionRankingConfig.circle_stroke),this.addScore(),this.addLine(),this.addTweenMoveToScreen()}},{key:"addIcon",value:function(e){this.icon=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.addChild(this.icon)}},{key:"addNumber",value:function(){this.number=new Phaser.Text(game,80*window.GameConfig.RESIZE,39*window.GameConfig.RESIZE,"".concat(this.index+1),{font:"GilroyMedium",fill:"#ffffff",fontSize:21}),this.addChild(this.number)}},{key:"addAva",value:function(){this.ava=new PO(this.configs.avatar,this.index),this.ava.x=170*window.GameConfig.RESIZE,this.ava.y=58*window.GameConfig.RESIZE,this.ava.ava.inputEnabled=!0,this.ava.ava.events.onInputUp.add(this.onClickAvaGetUserProfile,this),this.addChild(this.ava)}},{key:"onClickAvaGetUserProfile",value:function(){0==this.clickProfile&&(this.clickProfile=!0,iC.instance().addUserProfile(this.configs.user_id))}},{key:"addName",value:function(){this.name=new Phaser.Text(game,225*window.GameConfig.RESIZE,50*window.GameConfig.RESIZE,this.configs.user_name,{font:"GilroyMedium",fill:"#ffffff",fontSize:22}),this.name.anchor.set(0,.5),this.addChild(this.name)}},{key:"addCircle",value:function(e){this.circle=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.circle.anchor.set(1,0),this.addChild(this.circle)}},{key:"addScore",value:function(){this.score=new Phaser.Text(game,-27*window.GameConfig.RESIZE,28*window.GameConfig.RESIZE,this.configs.number_of_correct,{font:"GilroyMedium",fill:"#ffa33a",fontSize:20}),this.score.anchor.set(.5),this.circle.addChild(this.score)}},{key:"addLine",value:function(){this.line=new rt(this.positionRankingConfig.line_under),this.addChild(this.line)}},{key:"addTweenMoveToScreen",value:function(){var e=this;this.index<8?this.timeOut=setTimeout(function(){game.add.tween(e).to({x:0},250,"Linear",!0).start()},100*this.index):this.position.x=0}},{key:"destroy",value:function(){for(clearTimeout(this.timeOut);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}},{key:"height",get:function(){return 115*window.GameConfig.RESIZE}}])&&GO(n.prototype,i),o&&GO(n,o),t}();function jO(e){return(jO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function FO(e,t){return!t||"object"!==jO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZO(e){return(ZO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HO(e,t){return(HO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var QO=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=FO(this,ZO(t).call(this,game,0,(game.height-108)*window.GameConfig.RESIZE,"practiceMenuSprites","Tab_label"))).configs=e,n.positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.icon,this.number,this.ava,this.name,this.circle,this.score,this.line,"N/A"!==this.configs.rank?(this.addIcon(this.positionRankingConfig.rank.other),this.addNumber(),this.addAva(),this.addName(),this.addCircle(this.positionRankingConfig.circle_stroke),this.addScore()):this.addNotRank()}},{key:"addNotRank",value:function(){this.txtNotRank=new Phaser.Text(game,320,53,"Bạn chưa có xếp hạng",{fontSize:30,font:"Gilroy",fill:"white",align:"center"}),this.txtNotRank.anchor.set(.5),this.addChild(this.txtNotRank)}},{key:"addIcon",value:function(e){this.icon=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.addChild(this.icon)}},{key:"addNumber",value:function(){this.number=new Phaser.Text(game,80*window.GameConfig.RESIZE,53*window.GameConfig.RESIZE,this.configs.rank,{font:"GilroyMedium",fill:"#ffffff",fontSize:22}),this.number.anchor.set(0,.5),this.addChild(this.number)}},{key:"addAva",value:function(){this.ava=new PO(this.configs.user_entity.avatar),this.ava.x=170*window.GameConfig.RESIZE,this.ava.y=58*window.GameConfig.RESIZE,this.addChild(this.ava)}},{key:"addName",value:function(){this.name=new Phaser.Text(game,220*window.GameConfig.RESIZE,53*window.GameConfig.RESIZE,this.configs.user_entity.user_name,{font:"GilroyMedium",fill:"#ffffff",fontSize:22}),this.name.anchor.set(0,.5),this.addChild(this.name)}},{key:"addCircle",value:function(e){this.circle=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.circle.anchor.set(1,0),this.addChild(this.circle)}},{key:"addScore",value:function(){this.score=new Phaser.Text(game,-27*window.GameConfig.RESIZE,28*window.GameConfig.RESIZE,this.configs.number_of_correct,{font:"GilroyMedium",fill:"#ffa33a",fontSize:20}),this.score.anchor.set(.5),this.circle.addChild(this.score)}},{key:"height",get:function(){return 193}}])&&UO(n.prototype,i),o&&UO(n,o),t}();function VO(e){return(VO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qO(e,t){return!t||"object"!==VO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KO(e){return(KO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zO(e,t){return(zO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var YO=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=qO(this,KO(t).call(this,game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,null))).type=n,i.positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),i.initVariable(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"initVariable",value:function(){this.timeCounter,this.timeIcon,this.btnField,this.txtRank,this.timingWeek,this.timeCountDownThisWeekPractice,this.lineUnder,this.addBtnField(),"LAST_WEEK"==this.type||this.type,this.signalInput=new Phaser.Signal}},{key:"addInput",value:function(){this.inputEnabled=!0,this.events.onInputUp.add(this.onClickSprite,this)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch()}},{key:"addBtnField",value:function(){this.btnField=new Phaser.Sprite(game,0,0,"otherSprites","tab_highlight"),this.btnField.scale.set(1.5,1),this.addChild(this.btnField)}},{key:"addTextThisWeek",value:function(){this.txtRank=new Phaser.Text(game,this.positionRankingConfig.txt_rank_this_week.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_rank_this_week.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_rank_this_week.text,this.positionRankingConfig.txt_rank_this_week.configs),this.width=this.txtRank.width,this.addChild(this.txtRank),this.addTiming(),this.lineUnder=new rt(this.positionRankingConfig.header.line),this.addChild(this.lineUnder)}},{key:"addTiming",value:function(){this.timeIcon=new Phaser.Sprite(game,this.positionRankingConfig.clock.x*window.GameConfig.RESIZE,this.positionRankingConfig.clock.y*window.GameConfig.RESIZE,this.positionRankingConfig.clock.nameAtlas,this.positionRankingConfig.clock.nameSprite),this.addChild(this.timeIcon)}},{key:"addTimeCountDown",value:function(e){this.timeCountDownThisWeekPractice=e,this.timeCounter=new Phaser.Text(game,this.positionRankingConfig.txt_timeCounter.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.text,this.positionRankingConfig.txt_timeCounter.configs);var t=game.time.create(!1);t.loop(1e3,this.handleTimer,this),t.start(),this.addChild(this.timeCounter)}},{key:"handleTimer",value:function(){this.timeCountDownThisWeekPractice--;var e=parseInt(this.timeCountDownThisWeekPractice/3600),t=parseInt(this.timeCountDownThisWeekPractice%3600/60),n=parseInt(this.timeCountDownThisWeekPractice%3600%60);this.timeCounter.setText("".concat(e,":").concat(t,":").concat(n))}},{key:"addTextLastWeek",value:function(){this.txtRank=new Phaser.Text(game,this.positionRankingConfig.txt_rank_last_week.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_rank_last_week.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_rank_last_week.text,this.positionRankingConfig.txt_rank_last_week.configs),this.txtRank.tint=9670812,this.width=this.txtRank.width,this.addChild(this.txtRank),this.lineUnder=new rt(this.positionRankingConfig.header.line),this.lineUnder.kill(),this.addChild(this.lineUnder)}},{key:"setWidth",value:function(){}},{key:"setHeight",value:function(){}},{key:"changeEffectShow",value:function(){this.inputEnabled=!1,this.txtRank.tint=16777215,this.lineUnder.revive()}},{key:"changeEffectHide",value:function(){this.inputEnabled=!0,this.txtRank.tint=9670812,this.lineUnder.kill()}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}}])&&WO(n.prototype,i),o&&WO(n,o),t}();function JO(e){return(JO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $O(e,t){return!t||"object"!==JO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eR(e){return(eR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tR(e,t){return(tR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nR=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=$O(this,eR(t).call(this,game))).positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),e.arrHelps=["Top 100 người trả lời đúng nhiều câu hỏi nhất trong tuần (cập nhật sau 10 phút)","Top 100 người trả lời đúng nhiều câu hỏi nhất của tuần trước"],e.event={back:new Phaser.Signal},e.typeButton=1,e.checkAddHelp=!1,e.arrThisWeek,e.arrLastWeek,e.tabUnder=null,e.popupHelp=null,e.tab4To10,e.listView,e.tabUser,e.addEventExtension(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tR(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setData",value:function(e,t,n){this.rankingListThisWeek=e,this.rankingListLastWeek=t,this.playlist=n,this.afterInit()}},{key:"afterInit",value:function(){this.addBG(),this.btnRankingLastWeek,this.btnRankingThisWeek,this.addParentSprite(),this.addButtonSwitch(),this.addHeaderRank(this.positionRankingConfig.header),Le.instance().logEvent(Le.Solo_mode_ranking)}},{key:"addBG",value:function(){var e=new Phaser.Button(game,0,0,"bg-playlist");e.input.useHandCursor=!1,this.addChild(e)}},{key:"addHeaderRank",value:function(e){var t=new Phaser.Sprite(game,e.tab.x*window.GameConfig.RESIZE,e.tab.y*window.GameConfig.RESIZE,e.tab.nameAtlas,e.tab.nameSprite),n=new Phaser.Sprite(game,e.back.x*window.GameConfig.RESIZE,e.back.y*window.GameConfig.RESIZE,e.back.nameAtlas,e.back.nameSprite);n.anchor.set(.5),n.inputEnabled=!0,n.events.onInputUp.add(this.onBack,this),t.addChild(n);var i=new Phaser.Sprite(game,e.line_doc.x*window.GameConfig.RESIZE,e.line_doc.y*window.GameConfig.RESIZE,e.line_doc.nameAtlas,e.line_doc.nameSprite);this.addChild(i);var o=game.add.text(e.name.x*window.GameConfig.RESIZE,e.name.y*window.GameConfig.RESIZE,this.playlist.name,e.name.configs);o.anchor.set(.5,0),t.addChild(o),this.addChild(t),this.btnHelp=new Phaser.Button(game,this.positionRankingConfig.help_btn.x,this.positionRankingConfig.help_btn.y,this.positionRankingConfig.help_btn.nameAtlas,this.onClickHelp,this,null,this.positionRankingConfig.help_btn.nameSprite),this.addChild(this.btnHelp)}},{key:"onClickHelp",value:function(){this.checkAddHelp=!this.checkAddHelp,1==this.checkAddHelp?this.addPopupHelp():this.removePopupHelp()}},{key:"addPopupHelp",value:function(){this.removePopupHelp(),this.popupHelp=new Kt(this.arrHelps[this.typeButton-1]),this.popupHelp.y=83*z.instance().scale,this.popupHelp.x=game.width-this.popupHelp.width-71*z.instance().scale,game.world.add(this.popupHelp)}},{key:"removePopupHelp",value:function(){null!==this.popupHelp&&(game.world.remove(this.popupHelp),this.popupHelp.destroy(),this.popupHelp=null)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),this.event.back.dispatch(),this.destroy(),this.rankingListThisWeek=[],this.rankingListLastWeek=[]}},{key:"addButtonSwitch",value:function(){this.btnRankingLastWeek=new YO(this.positionRankingConfig.button_ranking_last_week,"LAST_WEEK"),this.btnRankingLastWeek.addTextLastWeek(),this.btnRankingLastWeek.addInput(),this.btnRankingLastWeek.addEventInput(this.onClickLastWeek,this),this.btnRankingLastWeek.setWidth(),this.addChild(this.btnRankingLastWeek),this.btnRankingThisWeek=new YO(this.positionRankingConfig.button_ranking_this_week,"THIS_WEEK"),this.btnRankingThisWeek.addTextThisWeek(),this.btnRankingThisWeek.addInput(),this.btnRankingThisWeek.addEventInput(this.onClickThisWeek,this),this.btnRankingThisWeek.setWidth(),this.addChild(this.btnRankingThisWeek)}},{key:"onClickLastWeek",value:function(){qe.instance().showLoading(),this.typeButton=2,this.btnRankingLastWeek.changeEffectShow(),this.btnRankingThisWeek.changeEffectHide(),this.showList()}},{key:"onClickThisWeek",value:function(){qe.instance().showLoading(),this.typeButton=1,this.btnRankingThisWeek.changeEffectShow(),this.btnRankingLastWeek.changeEffectHide(),this.showList()}},{key:"showList",value:function(){var e;this.listView.removeAll(),this.listView.reset(),this.ktBuild=!1,this.idx=0,this.countItem=0,e=1==this.typeButton?this.posThisWeek:this.posLastWeek,this.buildItemPage(),this.addTabUnder(e)}},{key:"addParentSprite",value:function(){var e=new Phaser.Group(game,this);e.x=0,e.y=206*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-311)*window.GameConfig.RESIZE);this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.listView.events.changeIndex.add(this.changeIndex,this)}},{key:"changeIndex",value:function(){var e=this.listView.getIdx();this.buildChangeIndex(e)}},{key:"addChildScrollMap",value:function(){ce.instance().playSound(ce.showranking),this.showList()}},{key:"setRankingThisWeek",value:function(e,t,n){this.arrThisWeek=e||this.positionRankingConfig.users,this.posThisWeek=n,this.addTimeCountDown(t),this.addChildScrollMap(),qe.instance().hideLoading()}},{key:"setRankingLastWeek",value:function(e,t){this.arrLastWeek=e||this.positionRankingConfig.users2,this.posLastWeek=t}},{key:"addTimeCountDown",value:function(e){this.btnRankingThisWeek.addTimeCountDown(e)}},{key:"filterOwnerRanking",value:function(e,t){t(e.filter(function(e){return e.user_id==mZ.instance().socket.mySelf.getVariable("user_id").value}))}},{key:"addTabUnder",value:function(e){null==e&&(e={number_of_correct:0,playlist_id:0,rank:"N/A",user_name:mZ.instance().dataMySeft.user_name,avatar:mZ.instance().socket.mySelf.getVariable("avatar").value,user_id:mZ.instance().socket.mySelf.getVariable("user_id").value}),null!==this.tabUnder&&(this.removeChild(this.tabUnder),this.tabUnder.destroy(),this.tabUnder=null),this.tabUnder=new QO(e),this.addChild(this.tabUnder)}},{key:"buildChangeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){var e=[];e=1==this.typeButton?this.arrThisWeek:this.arrLastWeek,this.ktBuild=!0;for(var t=this.idx;t<e.length;t++){var n=void 0;if(n=t+1==3?new AO(e[t],t,!0):t+1<3?new AO(e[t],t,!1):t+1==e.length?new BO(e[t],t,!0):new BO(e[t],t,!1),this.listView.add(n),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<e.length){this.ktBuild=!1;break}this.idx===e.length&&(this.ktBuild=!1)}this.timeout=setTimeout(function(){qe.instance().hideLoading()},300)}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(clearTimeout(this.timeout),this.removeEventExtension(),this.removePopupHelp();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&XO(n.prototype,i),o&&XO(n,o),t}();var iR=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rank="N/A",this.user_id=mZ.instance().dataMySeft.user_id,this.playlist_id=0,this.number_of_correct=0,this.user_entity={user_name:mZ.instance().dataMySeft.user_name,avatar:mZ.instance().dataMySeft.avatar}};function oR(e){return(oR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sR(e,t){return!t||"object"!==oR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rR(e){return(rR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lR(e,t){return(lR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hR=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=sR(this,rR(t).call(this,game,640*window.GameConfig.RESIZE,0,"bg-playlist"))).positionPracticeScreenConfig=JSON.parse(game.cache.getText("positionPracticeScreenConfig")),e.event={pickAlbum:new Phaser.Signal,refreshPickAlbum:new Phaser.Signal},e.signalInputX=new Phaser.Signal,e.headerTab,e.scrollTab,e.playlists,e.state=null,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lR(e,t)}(t,Kp),n=t,(i=[{key:"afterInit",value:function(){this.onClickRankAlbum=!1,this.addEventExtension(),this.addTweenScreen(),Le.instance().logEvent(Le.Solo_mode)}},{key:"addTweenScreen",value:function(){game.add.tween(this).to({x:0},200,"Linear",!1).start()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Button(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,function(){},this,null,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.txtGem,this.txtHeart,this.tabGemHeader,this.tabHeartHeader,this.addButtonBack(e.btn_back),this.addTabGemHeader(e),this.addTabHeartHeader(e),this.addTxtPractice(e.txt_practice)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;if(0==this.onClickRankAlbum){ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:1080*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}}},{key:"addTxtPractice",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.positionPracticeScreenConfig.header.gem),n=this.addTxtGem(this.positionPracticeScreenConfig.header.txtGem),i=t.width+n.width;n.x=(this.tabGemHeader.width-i)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-i)/2+n.width+5*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(n),this.headerTab.addChild(this.tabGemHeader)}},{key:"addTabHeartHeader",value:function(e){this.tabHeartHeader=new Phaser.Sprite(game,e.tabHeart.x*window.GameConfig.RESIZE,e.tabHeart.y*window.GameConfig.RESIZE,e.tabHeart.nameAtlas,e.tabHeart.nameSprite);var t=this.addHeart(this.positionPracticeScreenConfig.header.heart);this.txtHeart=this.addTxtHeart(this.positionPracticeScreenConfig.header.txtHeart);var n=t.width+this.txtHeart.width;this.txtHeart.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtHeart.width+5*window.GameConfig.RESIZE,this.tabHeartHeader.addChild(t),this.tabHeartHeader.addChild(this.txtHeart),this.headerTab.addChild(this.tabHeartHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addHeart",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtHeart",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("heart").value,e.configs)}},{key:"addPlaylists",value:function(e){this.playlists=e.sort(this.sortPlaylist),this.playlists=this.playlists.sort(this.sortUpdatePlaylist);var t=0,n=0,i=new pO(0,200*window.GameConfig.RESIZE),o=new Phaser.Group(game,this);o.x=0,o.y=230*window.GameConfig.RESIZE,this.addChild(o);var a=new Phaser.Rectangle(35*window.GameConfig.RESIZE,0,570*window.GameConfig.RESIZE,(game.height-206)*window.GameConfig.RESIZE);this.listView=new Jo(game,o,a,{direction:"y",overflow:100,padding:60,searchForClicks:!0});for(var s=1;s<this.playlists.length+1;s++){var r=new bO(t,n,this.playlists[s-1],s);r.afterCreate(),r.loadThumb(),r.signalInput.add(this.onChoosedAlbum,this),r.signalBuyPlaylist.add(this.buyPlaylistSoloMode,this),r.signalGetRanking.add(this.playlistGetRanking,this),i.add(r),s%3==0&&s>0?(t=0,n+=window.GameConfig.CONFIGS_POPUP_PRACTICE.y*window.GameConfig.RESIZE,this.addLine(i,this.positionPracticeScreenConfig.practice_line_scroll,n)):t+=window.GameConfig.CONFIGS_POPUP_PRACTICE.x*window.GameConfig.RESIZE}this.playlists.length%3==0?i.height+=this.playlists.length/3*(window.GameConfig.CONFIGS_POPUP_PRACTICE.y*window.GameConfig.RESIZE):i.height+=(this.playlists.length/3+1)*(window.GameConfig.CONFIGS_POPUP_PRACTICE.y*window.GameConfig.RESIZE),this.listView.add(i),this.addHeaderTab(this.positionPracticeScreenConfig.header)}},{key:"onChoosedAlbum",value:function(e){Le.instance().logEvent(Le.Solo_mode_quiz_play_button),this.event.pickAlbum.dispatch(e)}},{key:"buyPlaylistSoloMode",value:function(e){this.addNewBoughtPlaylist(e,z.instance().soloModePlaylists),this.event.refreshPickAlbum.dispatch()}},{key:"addNewBoughtPlaylist",value:function(e,t){for(var n=0;n<t.length;n++)t[n].id===e.id&&(t[n].is_owner=1,t[n].user_playlist_mapping={active:1,created:(new Date).getTime(),current_level_score:0,exp_score:0,id:0,level:0,next_level_score:50,playlist_id:e.id,updated:(new Date).getTime(),user_id:mZ.instance().dataMySeft.user_id})}},{key:"playlistGetRanking",value:function(e){this.RankingScreen=new nR,this.RankingScreen.setData([],[],e),this.RankingScreen.event.back.add(this.onBackRanking,this),this.addChild(this.RankingScreen),this.sendGetRankingOption(e),this.onClickRankAlbum=!0}},{key:"onBackRanking",value:function(){this.onClickRankAlbum=!1}},{key:"sendGetRankingOption",value:function(e){this.sendSoloModeRanking(e.id)}},{key:"sendSoloModeRanking",value:function(e){qe.instance().showLoading(),this.sendLastWeekRanking(e),this.sendThisWeekRanking(e)}},{key:"sendLastWeekRanking",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),mZ.instance().sendData(Et.SOLO_MODE_TOP10_LAST_WEEK_REQUEST,t)}},{key:"sendThisWeekRanking",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),mZ.instance().sendData(Et.SOLO_MODE_TOP10_THIS_WEEK_REQUEST,t)}},{key:"rankingThisWeek",value:function(e){this.RankingScreen.setRankingThisWeek(this.rankingListThisWeek,e,this.posThisWeek)}},{key:"rankingLastWeek",value:function(){this.RankingScreen.setRankingLastWeek(this.rankingListLastWeek,this.posLastWeek)}},{key:"sortPlaylist",value:function(e,t){return e.is_owner>t.is_owner?-1:e.is_owner<t.is_owner?1:0}},{key:"sortUpdatePlaylist",value:function(e,t){return 1!=e.is_owner||1!=t.is_owner?0:e.user_playlist_mapping?e.user_playlist_mapping.updated>t.user_playlist_mapping.updated?-1:e.user_playlist_mapping.updated<t.user_playlist_mapping.updated?1:0:void 0}},{key:"addLine",value:function(e,t,n){var i=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE+n,t.nameAtlas,t.nameSprite);e.addChild(i)}},{key:"addEventInputX",value:function(e,t){this.signalInputX.add(e,t)}},{key:"removeEventInputX",value:function(e,t){this.signalInputX.remove(e,t)}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.onBack,this),mZ.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),mZ.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"onUpdateUserVars",value:function(){mZ.instance().dataMySeft.heart!==parseInt(this.txtHeart.text)&&(this.txtHeart.text=mZ.instance().dataMySeft.heart)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.SOLO_MODE_TOP10_THIS_WEEK_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.rankingListThisWeek=[],this.posThisWeek=new iR,Bn.handleRankingList(e.params,this.rankingListThisWeek,this.posThisWeek,function(){Bn.handleTime(e.params,function(e){t.rankingThisWeek(e)})})):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_TOP10_LAST_WEEK_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.rankingListLastWeek=[],this.posLastWeek=new iR,Bn.handleRankingList(e.params,this.rankingListLastWeek,this.posLastWeek,function(){t.rankingLastWeek()})):console.warn(e.params.getUtfString("message")))}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&aR(n.prototype,i),o&&aR(n,o),t}();function cR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var uR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadDataComplete=new Phaser.Signal,this.loadDataFail=new Phaser.Signal}var t,n,i;return t=e,(n=[{key:"beginLoadAudio",value:function(e){Dl.instance().loadSound(e.url),Dl.instance().event.loadComplete.add(this.loadComplete,this),Dl.instance().event.loadFail.add(this.loadFail,this)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"loadComplete",value:function(){LogConsole.log("load TT"),this.loadDataComplete.dispatch()}},{key:"loadFail",value:function(){this.loadDataFail.dispatch()}},{key:"addEventLoadComplete",value:function(e,t){this.loadDataComplete.add(e,t)}},{key:"removeEventLoadComplete",value:function(e,t){this.loadDataComplete.remove(e,t)}},{key:"remove",value:function(){Dl.instance().event.loadComplete.remove(this.loadComplete,this)}}])&&cR(t.prototype,n),i&&cR(t,i),e}();function dR(e){return(dR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pR(e){return(pR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gR(e,t){return(gR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var mR=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=pR(t).call(this,game))||"object"!==dR(s)&&"function"!=typeof s?yR(a):s).posX=e,o.positionPracticeScreenConfig=JSON.parse(game.cache.getText("positionPracticeScreenConfig")),o.sprite=new Phaser.Button(game,e+1080*window.GameConfig.RESIZE,n,o.positionPracticeScreenConfig.answer_tab.nameAtlas,o.onClickAnswer,yR(yR(o)),null,o.positionPracticeScreenConfig.answer_tab.nameSprite),o.sprite.anchor=new Phaser.Point(.5,.5),o.configs=i,o.addChild(o.sprite),o.event={chooseAnswer:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gR(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this;this.answerText=new Phaser.Text(game,0,0,"".concat(this.configs.answer),{font:"GilroyMedium",fill:"#000000",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:500}),this.answerText.anchor.set(.5),this.sprite.addChild(this.answerText),this.answer=this.configs.value,setTimeout(function(){game.add.tween(e.sprite).to({x:e.posX},450,Phaser.Easing.Back.Out,!1).start()},70*(this.configs.value-1))}},{key:"onClickAnswer",value:function(){this.event.chooseAnswer.dispatch(this.configs)}},{key:"displayScreenWhenAnswerRight",value:function(){this.answerText.addColor("#01c66a",0)}},{key:"displayScreenWhenAnswerWrong",value:function(){this.answerText.addColor("#ff0000",0)}},{key:"displayScreenWhenAnswerNotChoosed",value:function(){this.sprite.alpha=.5}}])&&fR(n.prototype,i),o&&fR(n,o),t}();function vR(e){return(vR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bR(e,t){return!t||"object"!==vR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SR(e){return(SR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _R(e,t){return(_R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ER=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=bR(this,SR(t).call(this,game))).positionPracticeScreenConfig=JSON.parse(game.cache.getText("positionPracticeScreenConfig")),e.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),e.event={playAgain:new Phaser.Signal,backToHome:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_R(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.countQuiz=0,this.addEventExtension(),this.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),this.addChild(this.bg),this.loadAudioSource=new uR,this.loadAudioSource.loadDataComplete.add(this.onLoadAudioComplete,this),this.loadAudioSource.loadDataFail.add(this.onLoadAudioFail,this),this.definedScreenPracticeModeAndLogicValue()}},{key:"definedScreenPracticeModeAndLogicValue",value:function(){this.choosed=!1,this.dotsGroup=null,this.timeout=!1,this.rankingListThisWeek=[],this.rankingListLastWeek=[],this.question,this.groupAnswer=null,this.RankingScreen=null,this.gotRewardStatus=!1,this.answerGroup=new Phaser.Group(game),this.addChild(this.answerGroup),this.addAvaAndMaskAva(),this.addNameFB(),this.addMapPracticeAndDotAnswer(),this.addFlag(),this.addTabGemAndTabHeart(),this.addLoadingSong(),Le.instance().logEvent(Le.Solo_mode_quiz_play)}},{key:"addLoadingSong",value:function(){this.stopAudio();var e={key:"songChoiced",url:this.questions[this.countQuiz].songEntity.fileUrl};this.question=this.questions[this.countQuiz],this.loadAudioSource.beginLoadAudio(e),this.loadingAnim=new Fe,this.loadingAnim.moveTxtLoading(),this.addChild(this.loadingAnim)}},{key:"onLoadAudioComplete",value:function(){this.loadingAnim.destroy(),this.removeChild(this.loadingAnim),Dl.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.addAnswerGroup()}},{key:"onLoadAudioFail",value:function(){this.loadingAnim.destroy(),this.removeChild(this.loadingAnim),Dl.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.addAnswerGroup()}},{key:"stopAudio",value:function(){Dl.instance().removeSound()}},{key:"addAvaAndMaskAva",value:function(){var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawCircle(this.positionPracticeScreenConfig.avaPractice.x*window.GameConfig.RESIZE,this.positionPracticeScreenConfig.avaPractice.y*window.GameConfig.RESIZE,147*window.GameConfig.RESIZE),e.anchor.set(.5),this.addChild(e);var t=new gl(this.positionPracticeScreenConfig.avaPractice.x*window.GameConfig.RESIZE,this.positionPracticeScreenConfig.avaPractice.y*window.GameConfig.RESIZE,"ava-default","ava_fb",0);t.sprite.anchor.set(.5),t.sprite.scale.set(window.GameConfig.SCALE_AVA_USER*window.GameConfig.RESIZE),t.sprite.mask=e,this.addChild(t.sprite),this.trueOrFalse=new Bd,this.trueOrFalse.setSize(315*window.GameConfig.RESIZE,315*window.GameConfig.RESIZE),this.trueOrFalse.x=-155*window.GameConfig.RESIZE+t.sprite.x,this.trueOrFalse.y=-155*window.GameConfig.RESIZE+t.sprite.y,this.addChild(this.trueOrFalse)}},{key:"setTrueAva",value:function(){this.trueOrFalse.setTrueAnswer()}},{key:"setFalseAva",value:function(){this.trueOrFalse.setFailtAnswer()}},{key:"addTabGemAndTabHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGemMain.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGemMain.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGemMain.nameAtlas,this.positionPracticePopupConfig.tabGemMain.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeartMain.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeartMain.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeartMain.nameAtlas,this.positionPracticePopupConfig.tabHeartMain.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e;this.txtGem,e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_rewardMain.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_rewardMain.nameAtlas,this.positionPracticePopupConfig.gem_rewardMain.nameSprite),this.txtGem=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txtMain.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txtMain.configs);var t=e.width+this.txtGem.width;this.txtGem.x=(this.tabGem.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-t)/2+this.txtGem.width+5*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(this.txtGem)}},{key:"addHeartDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_rewardMain.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_rewardMain.nameAtlas,this.positionPracticePopupConfig.heart_rewardMain.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txtMain.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txtMain.configs);var n=e.width+t.width;t.x=(this.tabHeart.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-n)/2+t.width+5*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(t)}},{key:"addMapPracticeAndDotAnswer",value:function(){var e=new Phaser.Sprite(game,game.world.centerX,419*window.GameConfig.RESIZE,"practiceMenuSprites","Map");e.anchor.set(.5),this.addChild(e),this.addDotsGroup();for(var t=0;t<window.MQ.posAchievementPractice.length;t++)this.CreateAnswerAndDiamondText(window.MQ.posAchievementPractice[t].answerPosX*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[t].answerPosY*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[t].diamondPosX*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[t].diamondPosY*window.GameConfig.RESIZE,this.rewards[t].number_question,this.rewards[t].reward,this.rewards[t].reward_type,window.MQ.posCirclePractice[t].x*window.GameConfig.RESIZE,window.MQ.posCirclePractice[t].y*window.GameConfig.RESIZE)}},{key:"addNameFB",value:function(){var e=new Phaser.Text(game,this.positionPracticeScreenConfig.nameFBPractice.x*window.GameConfig.RESIZE,this.positionPracticeScreenConfig.nameFBPractice.y*window.GameConfig.RESIZE,"You",this.positionPracticeScreenConfig.nameFBPractice.configs);e.anchor.set(.5),this.addChild(e)}},{key:"CreateAnswerAndDiamondText",value:function(e,t,n,i,o,a,s,r,l){if("DIAMOND"==s){var h=new Phaser.Sprite(game,n+10,i,this.positionPracticeScreenConfig.diamond.nameAtlas,this.positionPracticeScreenConfig.diamond.nameSprite);h.anchor.set(0,.5),h.scale.set(.7),this.dotsGroup.addChild(h)}else if("TICKET"==s){var c=new Phaser.Sprite(game,n+10,i,this.positionPracticeScreenConfig.diamond.nameAtlas,"Ticket");c.anchor.set(0,.5),c.scale.set(.7),this.dotsGroup.addChild(c)}else if("SUPPORT_ITEM"==s){var u=new Phaser.Sprite(game,n+10,i,this.positionPracticeScreenConfig.diamond.nameAtlas,"Mic");u.anchor.set(0,.5),u.scale.set(.7),this.dotsGroup.addChild(u)}var d=new Phaser.Text(game,n,i,"".concat(a),{font:"Gilroy",fill:"white",fontSize:17.5});d.anchor.set(1,.5),this.dotsGroup.addChild(d);var f=new Phaser.Text(game,e,t,"".concat(o),{font:"Gilroy",fill:"white",fontSize:17.5});if(f.anchor.set(.5),this.dotsGroup.addChild(f),this.archived.achieved>=o)if(f.alpha=1,this.countQuiz==o){var p=new Phaser.Sprite(game,r,l,"practiceMenuSprites","Circle_Achieved");p.anchor.set(.5),this.dotsGroup.addChild(p)}else if(this.countQuiz>o){var g=new Phaser.Sprite(game,r,l,"practiceMenuSprites","Circle_Achieved");g.anchor.set(.5),this.dotsGroup.addChild(g)}else{var y=new Phaser.Sprite(game,r,l,"practiceMenuSprites","Circle_Active");y.anchor.set(.5),this.dotsGroup.addChild(y)}else f.alpha=.5}},{key:"createDotAnswered",value:function(){var e=this,t=window.MQ.posDotPractice.find(function(t){return t.num==e.countQuiz});if(void 0!==t){var n=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,"practiceMenuSprites","Circle_Active_Small");if(n.anchor.set(.5),this.dotsGroup.addChild(n),t.num>2&&t.num<8||t.num>12&&t.num<25||t.num>33&&t.num<56)(i=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,(t.y+12)*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:18})).anchor.set(.5,0),this.dotsGroup.addChild(i);else if(t.num>8&&t.num<12){(i=new Phaser.Text(game,(t.x+12)*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:18})).anchor.set(0,.5),this.dotsGroup.addChild(i)}else if(t.num>25&&t.num<33){var i;(i=new Phaser.Text(game,(t.x-12)*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:18})).anchor.set(1,.5),this.dotsGroup.addChild(i)}}this.addFlag()}},{key:"addFlag",value:function(){var e=this,t=window.MQ.posDotPractice.find(function(t){return t.num==e.highest_number_of_correct});if(void 0!==t&&this.countQuiz<t.num)if(t.x!==window.MQ.posDotPractice[0].x){if((a=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,"practiceMenuSprites","Flag_small")).anchor.set(.5),this.dotsGroup.addChild(a),t.num>2&&t.num<8||t.num>12&&t.num<25||t.num>33&&t.num<56){a.y-=3;var n=new Phaser.Text(game,(t.x-3)*window.GameConfig.RESIZE,(t.y+15)*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:15});n.anchor.set(.5,0),this.dotsGroup.addChild(n)}else if(t.num>8&&t.num<12){a.x+=5;var i=new Phaser.Text(game,(t.x+15)*window.GameConfig.RESIZE,(t.y+5)*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:15});i.anchor.set(0,.5),this.dotsGroup.addChild(i)}else if(t.num>25&&t.num<33){a.x+=5;var o=new Phaser.Text(game,(t.x-15)*window.GameConfig.RESIZE,(t.y+7)*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:15});o.anchor.set(1,.5),this.dotsGroup.addChild(o)}}else{var a,s=window.MQ.posCirclePractice.find(function(t){return t.num==e.highest_number_of_correct});if(void 0!==s)(a=new Phaser.Sprite(game,s.x*window.GameConfig.RESIZE,(s.y-5)*window.GameConfig.RESIZE,"practiceMenuSprites","Flag")).anchor.set(.5),this.dotsGroup.addChild(a)}}},{key:"addDotsGroup",value:function(){this.removeDotsGroup(),this.dotsGroup=new Phaser.Group(game),this.addChild(this.dotsGroup)}},{key:"removeDotsGroup",value:function(){null!==this.dotsGroup&&(this.removeChild(this.dotsGroup),this.dotsGroup.destroy(),this.dotsGroup=null)}},{key:"addAnswerGroup",value:function(){this.removeAnswerGroup(),this.groupAnswer=new Phaser.Group(game),this.addChild(this.groupAnswer),this.createFourAnswerTab(),this.addSpriteTime(),Le.instance().logEvent(Le.pro_quiz_start_solomode)}},{key:"removeAnswerGroup",value:function(){null!==this.groupAnswer&&(this.removeChild(this.groupAnswer),this.groupAnswer.destroy(),this.groupAnswer=null)}},{key:"addSpriteTime",value:function(){var e=this;this.spriteTime=new Phaser.Sprite(game,0,(game.height-531)*window.GameConfig.RESIZE,"otherSprites","tween-time"),this.spriteTime.anchor.set(0,.5),this.addChild(this.spriteTime),this.tweenSpriteTime=game.add.tween(this.spriteTime.scale).to({x:70,y:1},1e4,"Linear"),this.tweenSpriteTime.start(),this.tweenSpriteTime.onComplete.add(function(){e.timeout=!0,e.answerA.sprite.inputEnabled=!1,e.answerB.sprite.inputEnabled=!1,e.answerC.sprite.inputEnabled=!1,e.answerD.sprite.inputEnabled=!1,e.choosed||setTimeout(function(){e.createTimeoutLostPopup()},1500)})}},{key:"createFourAnswerTab",value:function(){LogConsole.log(this.question);for(var e=0;e<4;e++)0==e&&(this.answerA=new mR(game.width/2,(game.height-459+122*e)*window.GameConfig.RESIZE,{answer:this.question.answers[e],value:e+1}),this.answerA.event.chooseAnswer.add(this.onChoosedAnswered,this),this.groupAnswer.addChild(this.answerA)),1==e&&(this.answerB=new mR(game.width/2,(game.height-459+122*e)*window.GameConfig.RESIZE,{answer:this.question.answers[e],value:e+1}),this.answerB.event.chooseAnswer.add(this.onChoosedAnswered,this),this.groupAnswer.addChild(this.answerB)),2==e&&(this.answerC=new mR(game.width/2,(game.height-459+122*e)*window.GameConfig.RESIZE,{answer:this.question.answers[e],value:e+1}),this.answerC.event.chooseAnswer.add(this.onChoosedAnswered,this),this.groupAnswer.addChild(this.answerC)),3==e&&(this.answerD=new mR(game.width/2,(game.height-459+122*e)*window.GameConfig.RESIZE,{answer:this.question.answers[e],value:e+1}),this.answerD.event.chooseAnswer.add(this.onChoosedAnswered,this),this.groupAnswer.addChild(this.answerD))}},{key:"onChoosedAnswered",value:function(e){this.choosed=!0,this.answerA.sprite.inputEnabled=!1,this.answerB.sprite.inputEnabled=!1,this.answerC.sprite.inputEnabled=!1,this.answerD.sprite.inputEnabled=!1,this.answered=e.value;for(var t=0;t<4;t++)0==t&&this.setTrueFalseTabAnswer(this.answerA,t+1),1==t&&this.setTrueFalseTabAnswer(this.answerB,t+1),2==t&&this.setTrueFalseTabAnswer(this.answerC,t+1),3==t&&this.setTrueFalseTabAnswer(this.answerD,t+1);e.value==this.questions[this.countQuiz].correctAnswer?(this.setTrueAva(),ce.instance().playSound(ce.streakanswer),this.answerResult=!0,this.userChoosedCorrectAnswer()):(this.setFalseAva(),this.answerResult=!1,this.userChoosedWrongAnswer())}},{key:"setTrueFalseTabAnswer",value:function(e,t){t==this.answered?t==this.questions[this.countQuiz].correctAnswer?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerWrong():t==this.questions[this.countQuiz].correctAnswer?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerNotChoosed()}},{key:"createTimeoutLostPopup",value:function(){if(!this.choosed){var e=new qn(this.countQuiz);e.addPopup(),e.addEventBtn(this.losePopupEvent,this),this.addChild(e),e.makeTweenPopup(),this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),li.instance().gameoverSoloMode(),li.instance().showInterstitialGameOverSoloMode()}}},{key:"userChoosedWrongAnswer",value:function(){var e=this;this.stopAudio(),setTimeout(function(){e.createLosePopup(),e.countQuiz=0},1500),this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id)}},{key:"createLosePopup",value:function(){var e=new ei(this.countQuiz);e.addPopup(),e.addEventBtn(this.losePopupEvent,this),this.addChild(e),e.makeTweenPopup(),li.instance().gameoverSoloMode(),li.instance().showInterstitialGameOverSoloMode()}},{key:"losePopupEvent",value:function(e){"RANK"==e.type?(this.stopAudio(),this.getRanking()):"HOME"==e.type?(this.stopAudio(),this.event.backToHome.dispatch()):"REPLAY"==e.type&&(this.stopAudio(),this.event.playAgain.dispatch(this.playlist))}},{key:"userChoosedCorrectAnswer",value:function(){var e=this;(this.countQuiz+=1,this.countQuiz>this.archived.achieved)?void 0!==this.rewards.filter(function(t){return t.number_question==e.countQuiz})[0]?this.sendGetNextQuestion():this.countQuiz==this.questions.length?(this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),setTimeout(function(){var t=new Di(e.questions.length,0,{name:e.playlist.name,id:e.playlist.id});t.addPopup(),t.makeTweenPopup(),t.event.goHome.add(e.doneSoloModeGoHome,e),t.event.getRank.add(e.doneSoloModeGetRank,e),e.addChild(t)},1e3)):setTimeout(function(){e.resetQuestion()},1e3):void 0!==this.rewards.filter(function(t){return t.number_question==e.countQuiz})[0]?this.sendGetNextQuestion():this.countQuiz==this.questions.length?(this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),setTimeout(function(){var t=new Di(e.questions.length,0,{name:e.playlist.name,id:e.playlist.id});t.addPopup(),t.makeTweenPopup(),t.event.goHome.add(e.doneSoloModeGoHome,e),t.event.getRank.add(e.doneSoloModeGetRank,e),e.addChild(t)},1e3)):setTimeout(function(){e.resetQuestion()},1e3)}},{key:"doneSoloModeClaim",value:function(e){this.is_watched_ads=e,this.sendSoloModeGotReward(this.countQuiz,this.playlist.id,e)}},{key:"createRewardPopup",value:function(e,t,n){var i=new mi(t,e,n);i.addPopup(),this.addChild(i),i.makeTweenPopup(),i.signalClaim.addOnce(this.onReceivedReward,this),i.signalNextQuestion.addOnce(this.onNextQuestion,this),i.signalStop.addOnce(this.onSignalStop,this)}},{key:"onSignalStop",value:function(){this.stopAudio()}},{key:"createPopupNotReward",value:function(e){this.resetQuestion()}},{key:"sendGetNextQuestion",value:function(){for(var e=this,t=this.rewards.findIndex(function(t){return t.number_question==e.countQuiz}),n=new SFS2X.SFSArray,i=0;i<this.questions.length;i++)n.addLong(this.questions[i].songEntity.id);if(this.rewards[t].number_question<56){var o=new SFS2X.SFSObject;o.putInt("playlist_id",this.playlist.id),o.putInt("next_question_number",this.rewards[t+1].number_question),o.putSFSArray("song_ids",n),mZ.instance().sendData(Et.SOLO_MODE_NEXT_QUESTION_REQUEST,o)}else this.checkWhatReward()}},{key:"checkWhatReward",value:function(){var e=this,t=this.rewards.filter(function(t){return t.number_question==e.countQuiz});this.countQuiz>this.archived.achieved?(this.archived.achieved=this.countQuiz,this.gotRewardStatus=!0,this.countQuiz<this.questions.length?56!==t[0].number_question&&setTimeout(function(){e.createRewardPopup(t[0].reward,t[0].number_question,t[0].reward_type)},600):(this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),setTimeout(function(){var t=new Di(e.questions.length,e.rewards[e.rewards.length-1].reward,{name:e.playlist.name,id:e.playlist.id});t.addPopup(),t.makeTweenPopup(),t.event.goHome.add(e.doneSoloModeGoHome,e),t.event.getRank.add(e.doneSoloModeGetRank,e),t.event.claim.add(e.doneSoloModeClaim,e),t.event.stopSong.add(e.onSignalStop,e),e.addChild(t)},1e3))):this.countQuiz<this.questions.length?setTimeout(function(){e.createPopupNotReward(t[0].number_question)},600):(this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),setTimeout(function(){var t=new Di(e.questions.length,0,{name:e.playlist.name,id:e.playlist.id});t.addPopup(),t.makeTweenPopup(),t.event.goHome.add(e.doneSoloModeGoHome,e),t.event.getRank.add(e.doneSoloModeGetRank,e),e.addChild(t)},1e3))}},{key:"onNextQuestion",value:function(){this.resetQuestion()}},{key:"onReceivedReward",value:function(e){this.is_watched_ads=e,this.sendSoloModeGotReward(this.countQuiz,this.playlist.id,e)}},{key:"sendSoloModeGotReward",value:function(e,t,n){this.archived.achieved=e;var i=new SFS2X.SFSObject;i.putInt("playlist_id",t),i.putInt("new_achieved",e),i.putInt("is_watched_ads",n),mZ.instance().sendData(Et.SOLO_MODE_GOT_REWARD_REQUEST,i)}},{key:"getRanking",value:function(){this.RankingScreen=new nR,this.RankingScreen.setData([],[],this.playlist),this.addChild(this.RankingScreen),this.sendGetRankingOption()}},{key:"sendGetRankingOption",value:function(){this.sendSoloModeRanking(this.playlist.id)}},{key:"sendSoloModeRanking",value:function(e){qe.instance().showLoading(),this.sendLastWeekRanking(e),this.sendThisWeekRanking(e)}},{key:"sendLastWeekRanking",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),mZ.instance().sendData(Et.SOLO_MODE_TOP10_LAST_WEEK_REQUEST,t)}},{key:"sendThisWeekRanking",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),mZ.instance().sendData(Et.SOLO_MODE_TOP10_THIS_WEEK_REQUEST,t)}},{key:"setData",value:function(e,t,n,i,o){this.questions=e,this.archived=t,this.rewards=n,this.playlist=i,this.highest_number_of_correct=o}},{key:"resetQuestion",value:function(){if(this.countQuiz<this.questions.length){this.choosed=!1,this.gotRewardStatus=!1,this.addDotsGroup();for(var e=0;e<window.MQ.posAchievementPractice.length;e++)this.CreateAnswerAndDiamondText(window.MQ.posAchievementPractice[e].answerPosX*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[e].answerPosY*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[e].diamondPosX*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[e].diamondPosY*window.GameConfig.RESIZE,this.rewards[e].number_question,this.rewards[e].reward,this.rewards[e].reward_type,window.MQ.posCirclePractice[e].x*window.GameConfig.RESIZE,window.MQ.posCirclePractice[e].y*window.GameConfig.RESIZE);this.createDotAnswered(),this.tweenSpriteTime.stop(),this.spriteTime.destroy(),this.answerA.destroy(),this.answerB.destroy(),this.answerC.destroy(),this.answerD.destroy(),this.removeAnswerGroup(),this.addLoadingSong()}}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.SOLO_MODE_FINISH_RESPONSE&&"OK"==e.params.getUtfString("status")&&(Le.instance().logEvent(Le.pro_quiz_end_solomode),LogConsole.log(e.params.getDump()),this.countQuiz==this.questions.length&&this.gotRewardStatus),e.cmd==Et.SOLO_MODE_GOT_REWARD_RESPONSE&&("OK"==e.params.getUtfString("status")?this.countQuiz==this.questions.length?this.txtGem.setText(mZ.instance().dataMySeft.diamond):this.txtGem.setText(mZ.instance().socket.mySelf.getVariable("diamond").value):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_TOP10_THIS_WEEK_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.rankingListThisWeek=[],this.posThisWeek=new iR,Bn.handleRankingList(e.params,this.rankingListThisWeek,this.posThisWeek,function(){Bn.handleTime(e.params,function(e){t.rankingThisWeek(e)})})):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_TOP10_LAST_WEEK_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.rankingListLastWeek=[],this.posLastWeek=new iR,Bn.handleRankingList(e.params,this.rankingListLastWeek,this.posLastWeek,function(){t.rankingLastWeek()})):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_NEXT_QUESTION_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.handlePracticeQuestions(e.params,function(){t.checkWhatReward()})}},{key:"handlePracticeQuestions",value:function(e,t){for(var n=e.getSFSArray("questions"),i=[],o=0;o<n.size();o++){var a=n.getSFSObject(o),s=a.getUtfString("question_type"),r=a.getUtfString("answer1"),l=a.getUtfString("answer2"),h=a.getUtfString("answer3"),c=a.getUtfString("answer4"),u=a.getInt("correct_answer"),d=a.getUtfString("file_path"),f=a.getUtfString("file_path"),p=a.getSFSObject("song"),g=p.getUtfString("title"),y=p.getLong("id"),m=p.getUtfString("title"),v=p.getUtfString("author"),w=p.getSFSObject("singer").getUtfString("name");i.push({questionType:s,answers:[r,l,h,c],correctAnswer:u,songEntity:{song:g,fileName:m,author:v,singer:w,listenLink:f,id:y,fileUrl:d}})}for(var b=0;b<i.length;b++)this.questions.push(i[b]);t()}},{key:"doneSoloModeGoHome",value:function(){this.stopAudio(),this.event.backToHome.dispatch()}},{key:"doneSoloModeGetRank",value:function(){this.stopAudio(),this.getRanking()}},{key:"rankingThisWeek",value:function(e){this.RankingScreen.setRankingThisWeek(this.rankingListThisWeek,e,this.posThisWeek)}},{key:"rankingLastWeek",value:function(){this.RankingScreen.setRankingLastWeek(this.rankingListLastWeek,this.posLastWeek)}},{key:"sendSoloModeFinishRequest",value:function(e,t){var n=new SFS2X.SFSObject;n.putInt("playlist_id",t),n.putInt("number_of_correct",e),mZ.instance().sendData(Et.SOLO_MODE_FINISH_REQUEST,n)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.loadAudioSource.remove(),Dl.instance().removeAllSound();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&wR(n.prototype,i),o&&wR(n,o),t}();function CR(e){return(CR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function PR(e,t){return!t||"object"!==CR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OR(e,t,n){return(OR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=RR(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function RR(e){return(RR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xR(e,t){return(xR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var TR=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=PR(this,RR(t).call(this))).screenPickAlbum=null,e.screenPlay=null,e.event={pickAlbumBack:new Phaser.Signal,playGoHome:new Phaser.Signal},e.screen=n,e.arrResource=[{type:"text",link:"img/config/positionPracticeScreenConfig.json",key:"positionPracticeScreenConfig"},{type:"text",link:"img/config/positionPracticePopupConfig.json",key:"positionPracticePopupConfig"},{type:"text",link:"img/config/positionRankingConfig.json",key:"positionRankingConfig"},{type:"spritesheet",link:"img/assetss/Animation/Timeout/TimeoutSoloMode.png",key:"timeout_practice",width:158,height:195,countFrame:24},{type:"spritesheet",link:"img/assetss/Practice/Wrong338x338.png",key:"wrong_practice",width:210,height:210,countFrame:23},{type:"spritesheet",link:"img/animations/RewardSoloMode/reward.png",key:"rewardSoloMode",width:250,height:250,countFrame:54},{type:"spritesheet",link:"img/animations/RewardSoloMode/ticketReward.png",key:"rewardTicketSoloMode",width:250,height:250,countFrame:54},{type:"spritesheet",link:"img/animations/RewardSoloMode/sptReward.png",key:"rewardSptSoloMode",width:250,height:250,countFrame:54},{type:"atlas",link:"img/atlas/soloMode.png",key:"practiceMenuSprites",linkJson:"img/atlas/soloMode.json"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xR(e,t)}(t,Kp),n=t,o=[{key:"PICK_ALBUM",get:function(){return"screen_pick_album"}},{key:"PLAY",get:function(){return"screen_play"}}],(i=[{key:"onLoadFileComplete",value:function(){this.afterInit()}},{key:"afterInit",value:function(){this.addEventExtension(),this.defineData(),this.screen==t.PICK_ALBUM&&this.sendSoloModePlaylistsRequest()}},{key:"defineData",value:function(){this.playlist={name:"",id:0},this.questions=[],this.rewardPractice=[],this.archived={}}},{key:"sendSoloModePlaylistsRequest",value:function(){qe.instance().showLoading(),this.checkRequestSocketSoloModePlaylist(),0==z.instance().isSoloModePlaylistRequest.checking?(z.instance().soloModePlaylists=[],mZ.instance().sendData(Et.SOLO_MODE_PLAYLISTS_REQUEST,null),z.instance().isSoloModePlaylistRequest.checking=!0,z.instance().isSoloModePlaylistRequest.updated=Date.now()):this.doneSoloModePlaylistResponse()}},{key:"checkRequestSocketSoloModePlaylist",value:function(){1==z.instance().isSoloModePlaylistRequest.checking?0==z.instance().soloModePlaylists.length?z.instance().isSoloModePlaylistRequest.checking=!1:z.instance().isSoloModePlaylistRequest.checking=!0:z.instance().isSoloModePlaylistRequest.checking=!1}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"doneSoloModePlaylistResponse",value:function(){this.addScreenPickAlbum(),qe.instance().hideLoading()}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.SOLO_MODE_PLAYLISTS_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleSoloModePlaylistsResponse(e.params,function(){t.doneSoloModePlaylistResponse()}):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_QUESTION_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleSoloModeSelectedPlaylistsResponse(e.params,function(){t.removeScreenPickAlbum(),t.updateSoloModePlaylists(z.instance().soloModePlaylists),t.addScreenPlay(),qe.instance().hideLoading()}):"WARNING"==e.params.getUtfString("status")?(iC.instance().addPopupNotEnoughResource(AE.HEART),qe.instance().hideLoading()):qe.instance().hideLoading())}},{key:"updateSoloModePlaylists",value:function(e){var t=this,n=(new Date).getTime();e.forEach(function(i,o){i.id===t.playlist.id&&(e[o].user_playlist_mapping.updated=n)})}},{key:"addScreenPickAlbum",value:function(){this.removeScreenPickAlbum(),this.screenPickAlbum=new hR,this.screenPickAlbum.addPlaylists(z.instance().soloModePlaylists),this.screenPickAlbum.addEventInputX(this.onClickPracticeBtnX,this),this.screenPickAlbum.event.pickAlbum.add(this.onChoosedAlbum,this),this.screenPickAlbum.event.refreshPickAlbum.add(this.refreshPickAlbum,this),this.addChild(this.screenPickAlbum)}},{key:"removeScreenPickAlbum",value:function(){null!==this.screenPickAlbum&&(this.removeChild(this.screenPickAlbum),this.screenPickAlbum.destroy(),this.screenPickAlbum=null)}},{key:"onClickPracticeBtnX",value:function(){this.removeScreenPickAlbum(),WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"onChoosedAlbum",value:function(e){this.playlist={name:e.name,id:e.id},this.sendSelectedPlaylistSoloMode(this.playlist.id)}},{key:"refreshPickAlbum",value:function(){this.removeScreenPickAlbum(),this.defineData(),this.sendSoloModePlaylistsRequest()}},{key:"addScreenPlay",value:function(){this.removeScreenPlay(),this.screenPlay=new ER,this.screenPlay.setData(this.questions,this.archived,this.rewardPractice,this.playlist,this.highest_number_of_correct),this.screenPlay.afterInit(),this.screenPlay.event.backToHome.add(this.screenPlayBackHome,this),this.screenPlay.event.playAgain.add(this.screenPlayPlayAgain,this),this.addChild(this.screenPlay)}},{key:"removeScreenPlay",value:function(){null!==this.screenPlay&&(this.removeChild(this.screenPlay),this.screenPlay.destroy(),this.screenPlay=null)}},{key:"screenPlayBackHome",value:function(){this.removeScreenPlay(),WF.instance().changeScreen(Ce.SOLO_MODE,t.PICK_ALBUM)}},{key:"screenPlayPlayAgain",value:function(e){this.sendSelectedPlaylistSoloMode(e.id)}},{key:"handleSoloModePlaylistsResponse",value:function(e,t){for(var n=e.getSFSArray("general_playlists"),i=0;i<n.size();i++){var o,a=n.getSFSObject(i),s=a.getUtfString("thumb"),r=a.getInt("price"),l=a.getUtfString("name"),h=a.getInt("is_general"),c=a.getInt("id"),u=a.getInt("is_owner");if(a.containsKey("user_playlist_mapping")){var d=a.getSFSObject("user_playlist_mapping");o={user_id:d.getInt("user_id"),level:d.getInt("level"),playlist_id:d.getInt("playlist_id"),created:d.getLong("created"),exp_score:d.getInt("exp_score"),active:d.getInt("active"),id:d.getLong("id"),current_level_score:d.getInt("current_level_score"),next_level_score:d.getInt("next_level_score"),updated:d.getLong("updated")}}z.instance().soloModePlaylists.push({thumb:s,price:r,name:l,is_general:h,id:c,is_owner:u,user_playlist_mapping:o})}t()}},{key:"sendSelectedPlaylistSoloMode",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),mZ.instance().sendData(Et.SOLO_MODE_QUESTION_REQUEST,t),qe.instance().showLoading()}},{key:"handleSoloModeSelectedPlaylistsResponse",value:function(e,t){var n=e.getSFSArray("solo_mode_rewards"),i=e.getSFSArray("questions"),o=e.getSFSObject("solo_mode_archived"),a=e.getInt("highest_number_of_correct");this.handleSoloModeRewards(n),this.handlePracticeQuestions(i),this.handleSoloModeArchived(o),this.highest_number_of_correct=a,t()}},{key:"handleSoloModeArchived",value:function(e){var t=e.getInt("user_id"),n=e.getInt("playlist_id"),i=e.getInt("achieved"),o=e.getLong("id");this.archived={user_id:t,playlist_id:n,achieved:i,id:o}}},{key:"handleSoloModeRewards",value:function(e){for(var t=[],n=0;n<e.size();n++){var i=e.getSFSObject(n),o=i.getInt("id"),a=i.getInt("number_question"),s=i.getInt("reward"),r=i.getUtfString("reward_type");t.push({id:o,number_question:a,reward:s,reward_type:r})}this.rewardPractice=t}},{key:"handlePracticeQuestions",value:function(e){for(var t=[],n=0;n<e.size();n++){var i=e.getSFSObject(n),o=i.getUtfString("question_type"),a=i.getUtfString("answer1"),s=i.getUtfString("answer2"),r=i.getUtfString("answer3"),l=i.getUtfString("answer4"),h=i.getInt("correct_answer"),c=i.getUtfString("file_path"),u=i.getUtfString("file_path"),d=i.getSFSObject("song"),f=d.getUtfString("title"),p=d.getLong("id"),g=d.getUtfString("title"),y=d.getUtfString("author"),m=d.getSFSObject("singer").getUtfString("name");t.push({questionType:o,answers:[a,s,r,l],correctAnswer:h,songEntity:{song:f,fileName:g,author:y,singer:m,listenLink:u,id:p,fileUrl:c}})}this.questions=t}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this),OR(RR(t.prototype),"destroy",this).call(this)}}])&&kR(n.prototype,i),o&&kR(n,o),t}();function IR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var AR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"daily_reward_settings",get:function(){return"daily_reward_settings"}},{key:"reward",get:function(){return"reward"}},{key:"reward_type",get:function(){return"reward_type"}},{key:"id",get:function(){return"id"}},{key:"day",get:function(){return"day"}}],(n=null)&&IR(t.prototype,n),i&&IR(t,i),e}();var LR=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reward=0,this.reward_type="",this.id=0,this.day=0};function GR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var DR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"daily_reward_log",get:function(){return"daily_reward_log"}},{key:"user_id",get:function(){return"user_id"}},{key:"created",get:function(){return"created"}},{key:"state",get:function(){return"state"}},{key:"day",get:function(){return"day"}},{key:"updated",get:function(){return"updated"}}],(n=null)&&GR(t.prototype,n),i&&GR(t,i),e}();var MR=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.created=0,this.state="",this.day=0,this.updated=0};function NR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var BR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){for(var n=e.getSFSArray(AR.daily_reward_settings),i=[],o=0;o<n.size();o++){var a=n.getSFSObject(o),s=new LR;s.reward=a.getInt(AR.reward),s.reward_type=a.getUtfString(AR.reward_type),s.id=a.getInt(AR.id),s.day=a.getInt(AR.day),i.push(s)}var r=e.getSFSObject(DR.daily_reward_log),l=new MR;l.user_id=r.getInt(DR.user_id),l.created=r.getLong(DR.created),l.state=r.getUtfString(DR.state),l.day=r.getInt(DR.day),l.updated=r.getLong(DR.updated),t(i,l)}}],(n=null)&&NR(t.prototype,n),i&&NR(t,i),e}();function jR(e){return(jR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function FR(e,t){return!t||"object"!==jR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZR(e){return(ZR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HR(e,t){return(HR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var QR=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=FR(this,ZR(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={goToShop:new Phaser.Signal,refreshMenu:new Phaser.Signal},e.inputEnabled=!0,e.outSize=!0,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HR(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.animCircleScale,this.animButtonInOut,this.addBtn(),this.addAnimButtonInOut(),this.runAnim()}},{key:"addBtn",value:function(){this.btn=new Phaser.Sprite(game,this.positionMenuConfig.btnShop.x*window.GameConfig.RESIZE,this.positionMenuConfig.btnShop.y*window.GameConfig.RESIZE,this.positionMenuConfig.btnShop.nameAtlas,this.positionMenuConfig.btnShop.nameSprite),this.btn.anchor.set(.5),this.btn.inputEnabled=!0,this.btn.events.onInputUp.add(this.onClickBtn,this),this.txtBtn=new Phaser.Text(game,this.positionMenuConfig.txt_shop.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_shop.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_shop.text,this.positionMenuConfig.txt_shop.configs),this.txtBtn.anchor.set(.5),this.btn.addChild(this.txtBtn),this.addChild(this.btn)}},{key:"onClickBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.goToShop.dispatch()}},{key:"addAnimCircleScale",value:function(){this.animCircleScale=new Phaser.Sprite(game,0,0,"CircleScale"),this.animCircleScale.anchor.set(.5),this.btn.addChild(this.animCircleScale)}},{key:"addAnimButtonInOut",value:function(){this.animButtonInOut=new Phaser.Sprite(game,0,0,"ButtonShop"),this.animButtonInOut.anchor.set(.5),this.btn.addChild(this.animButtonInOut)}},{key:"runAnim",value:function(){this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",25,!0)}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){}},{key:"scrollChange",value:function(){this.txtBtn.kill(),game.add.tween(this.btn).to({y:65},150,"Linear",!0).start(),1==this.isGift&&this.animCircleScale.animations.stop("run_scale_circle",!0)}},{key:"scrollDefault",value:function(){this.txtBtn.revive(),game.add.tween(this.btn).to({y:this.positionMenuConfig.btnGift.y*window.GameConfig.RESIZE},150,"Linear",!0).start(),1==this.isGift&&this.animCircleScale.animations.play("run_scale_circle",30,!0)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&UR(n.prototype,i),o&&UR(n,o),t}();function VR(e){return(VR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qR(e,t){return!t||"object"!==VR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KR(e){return(KR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zR(e,t){return(zR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var YR=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=qR(this,KR(t).call(this,game))).btnShop=null,e.btnEvent=null,e.btnQuest=null,e.btnRanking=null,e.btnFindGame=null,e.btnPractice=null,e.btnParty=null,e.userProfile=null,e.scrollList=null,e.navBar=null,e.timeoutLoading=null,e.event={goToFindGame:new Phaser.Signal,goToTurnBasePlay:new Phaser.Signal,goToParty:new Phaser.Signal,goToSoloMode:new Phaser.Signal,goToGift:new Phaser.Signal,goToEvent:new Phaser.Signal,refreshMenu:new Phaser.Signal},e.playScript=JSON.parse(game.cache.getText("playScript")),e.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),e.addChild(e.bg),e.afterInit(),e}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zR(e,t)}(t,Phaser.Group),n=t,(o=[{key:"afterInit",value:function(){qe.instance().showLoading(),Le.instance().logEvent(Le.Main_menu),this.addEventExtension(),this.user={avatar:mZ.instance().dataMySeft.avatar,user_name:mZ.instance().dataMySeft.user_name},this.layoutMenu=new Phaser.Group(game),this.addChild(this.layoutMenu),this.bgFake=new gC("bg_scrollMenu"),this.layoutMenu.addChild(this.bgFake),this.layoutMain=new Phaser.Group(game),this.layoutMenu.addChild(this.layoutMain),this.layoutNavBar=new Phaser.Group(game),this.addChild(this.layoutNavBar),this.addBtnFindGame(),this.addBtnPractice(),this.addBtnParty(),this.setAnimButtonModeGame(),this.addBtnGift(),this.addBtnQuest(),this.addBtnEvent(),this.addBtnRanking(),this.addUserProfile(),this.addNavBar(),this.addScollList(),this.sendRequestMenuChallenges(),this.bgFake.event.refreshMenu.add(this.refreshMenu,this),this.bgFake.event.scrollChange.add(this.scrollChange,this),this.bgFake.event.scrollDefault.add(this.scrollDefault,this),this.bgFake.event.scrollList.add(this.scrollListEvent,this)}},{key:"checkShowInvite",value:function(e){null!==this.navBar&&2!==this.navBar.typeNew&&!1===Gc.instance().getUserBlock(e.getInt("inviter_id"))&&iC.instance().addDialogInviteFriend(e,!0)}},{key:"scrollListEvent",value:function(e){this.scrollList&&this.scrollList.scrollEventResponse(e)}},{key:"refreshMenu",value:function(){WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"scrollChange",value:function(){this.btnShop.scrollChange(),this.btnQuest.scrollChange(),this.btnEvent.scrollChange(),this.btnRanking.scrollChange(),this.btnFindGame.setPosY(225),this.btnParty.setPosY(225),this.btnPractice.setPosY(225),this.layoutMain.addChild(this.btnFindGame),this.layoutMain.addChild(this.btnParty),this.layoutMain.addChild(this.btnPractice),this.userProfile.scrollChange(),this.timeoutLoading=setTimeout(function(){qe.instance().hideLoading()},1e3)}},{key:"scrollDefault",value:function(){this.btnShop.scrollDefault(),this.btnQuest.scrollDefault(),this.btnEvent.scrollDefault(),this.btnRanking.scrollDefault(),this.btnFindGame.setPosYDefault(this.positionMenuConfig.btn_findgame.y*window.GameConfig.RESIZE),this.btnParty.setPosYDefault(this.positionMenuConfig.btn_party.y*window.GameConfig.RESIZE),this.btnPractice.setPosYDefault(this.positionMenuConfig.btn_practice.y*window.GameConfig.RESIZE),this.bgFake.addChild(this.btnParty),this.bgFake.addChild(this.btnPractice),this.bgFake.addChild(this.btnFindGame),this.userProfile.scrollDefault(),this.timeoutLoading=setTimeout(function(){qe.instance().hideLoading()},1e3)}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),mZ.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),mZ.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this),this.bgFake.event.refreshMenu.remove(this.refreshMenu,this),this.bgFake.event.scrollChange.remove(this.scrollChange,this),this.bgFake.event.scrollDefault.remove(this.scrollDefault,this)}},{key:"sendRequestMenuChallenges",value:function(){null==z.instance().menuLoadResponses?mZ.instance().sendDataGetMenu(Et.MAIN_MENU_LOAD_REQUEST,"MAIN_MENU_LOAD_REQUEST"):(this.checkRequestSocketMainMenuCheck(),0==z.instance().isRefreshMenu.checking?(mZ.instance().sendData(Et.MAIN_MENU_CHECK_UPDATE_REQUEST,null),this.scrollList.displayListChallenge(),this.bgFake.addChildren(this.scrollList),this.refreshButNotRefresh(),z.instance().isRefreshMenu.checking=!0,z.instance().isRefreshMenu.updated=Date.now()):(this.scrollList.displayListChallenge(),this.bgFake.addChildren(this.scrollList),this.refreshButNotRefresh()),1==z.instance().isScrollChange?this.scrollChange():this.scrollDefault())}},{key:"checkRequestSocketMainMenuCheck",value:function(){1==z.instance().isRefreshMenu.checking?Date.now()-z.instance().isRefreshMenu.updated<6e3?z.instance().isRefreshMenu.checking=!0:z.instance().isRefreshMenu.checking=!1:z.instance().isRefreshMenu.checking=!1}},{key:"setAnimButtonModeGame",value:function(){var e=this,t=1;this.timeLoopAnim=game.time.create(!0),this.timeLoopAnim.loop(8*Phaser.Timer.SECOND,function(){1==t?e.btnFindGame.startAnim():2==t?e.btnParty.startAnim():3==t&&e.btnPractice.startAnim(),4==++t&&(t=1)},this),this.timeLoopAnim.start()}},{key:"addBtnEvent",value:function(){this.removeBtnEvent(),this.btnEvent=new gk,this.btnEvent.event.gotToEvent.add(this.onClickEventMode,this),this.layoutMain.addChild(this.btnEvent)}},{key:"onClickEventMode",value:function(){WF.instance().changeScreen(Ce.EVENT_MODE)}},{key:"removeBtnEvent",value:function(){null!==this.btnEvent&&(this.removeChild(this.btnEvent),this.btnEvent.destroy(),this.btnEvent=null)}},{key:"addBtnRanking",value:function(){this.removeBtnRanking(),this.btnRanking=new hk,this.btnRanking.btn.events.onInputUp.add(this.onClickRanking,this),this.layoutMain.addChild(this.btnRanking)}},{key:"onClickRanking",value:function(){ce.instance().playSound(ce.buttonclick),WF.instance().changeScreen(Ce.RANKING_ALL)}},{key:"removeBtnRanking",value:function(){null!==this.btnRanking&&(this.removeChild(this.btnRanking),this.btnRanking.destroy(),this.btnRanking=null)}},{key:"addBtnFindGame",value:function(){this.removeBtnFindGame(),this.btnFindGame=new SC,this.btnFindGame.event.onClickFindGame.add(this.onClickFindGame,this),this.addChild(this.btnFindGame)}},{key:"onClickFindGame",value:function(){WF.instance().changeScreen(Ce.TURN_BASE)}},{key:"removeBtnFindGame",value:function(){null!==this.btnFindGame&&(this.removeChild(this.btnFindGame),this.btnFindGame.destroy(),this.btnFindGame=null)}},{key:"addBtnGift",value:function(){this.removeBtnGift(),this.btnShop=new QR,this.btnShop.event.goToShop.add(this.onShopBtnInput,this),this.btnShop.event.refreshMenu.add(this.refreshMenu,this),this.layoutMain.addChild(this.btnShop)}},{key:"removeBtnGift",value:function(){null!==this.btnShop&&(this.removeChild(this.btnShop),this.btnShop.destroy(),this.btnShop=null)}},{key:"onGiftBtnInput",value:function(e){this.hours_reward_setting=e,this.userProfile.claimHourReward(this.hours_reward_setting)}},{key:"onShopBtnInput",value:function(){iC.instance().addShop(0)}},{key:"onShared",value:function(e){e.hasOwnProperty(error_code)||this.sendShareResult()}},{key:"sendShareResult",value:function(){mZ.instance().sendData(Et.FB_USER_SHARED_RESULT_REQUEST,null)}},{key:"addBtnParty",value:function(){this.removeBtnParty(),this.btnParty=new LC,this.btnParty.event.goToParty.add(this.goToParty,this),this.addChild(this.btnParty)}},{key:"removeBtnParty",value:function(){null!==this.btnParty&&(this.removeChild(this.btnParty),this.btnParty.destroy(),this.btnParty=null)}},{key:"goToParty",value:function(){WF.instance().changeScreen(Ce.ONLINE_MODE)}},{key:"addBtnPractice",value:function(){this.removeBtnPractice(),this.btnPractice=new OC,this.btnPractice.event.onClickPractice.add(this.onClickPracticeBtn,this),this.addChild(this.btnPractice)}},{key:"removeBtnPractice",value:function(){null!==this.btnPractice&&(this.removeChild(this.btnPractice),this.btnPractice.destroy(),this.btnPractice=null)}},{key:"onClickPracticeBtn",value:function(){WF.instance().changeScreen(Ce.SOLO_MODE,TR.PICK_ALBUM)}},{key:"addBtnQuest",value:function(){this.removeBtnQuest(),this.btnQuest=new ik,this.btnQuest.btn.events.onInputUp.add(this.onClickQAndA,this),this.layoutMain.addChild(this.btnQuest)}},{key:"onClickQAndA",value:function(){ce.instance().playSound(ce.buttonclick),WF.instance().changeScreen(Ce.QUEST_ACHIEVEMENT,2)}},{key:"removeBtnQuest",value:function(){null!==this.btnQuest&&(this.removeChild(this.btnQuest),this.btnQuest.destroy(),this.btnQuest=null)}},{key:"addNavBar",value:function(){this.removeNavBar(),this.navBar=new lO,this.navBar.createButtonOnNavigation(),this.navBar.event.backMenu.add(this.backMenu,this),this.navBar.event.changeOtherScreen.add(this.changeOtherScreen,this),this.layoutNavBar.addChild(this.navBar)}},{key:"backMenu",value:function(){WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"changeOtherScreen",value:function(){if(this.layoutMenu.x!==-game.width-300){var e=game.add.tween(this.layoutMenu).to({x:-game.width-300},500,"Linear",!0);e.start(),e.onComplete.add(function(){},this)}}},{key:"removeNavBar",value:function(){null!==this.navBar&&(this.removeChild(this.navBar),this.navBar.destroy(),this.navBar=null)}},{key:"addUserProfile",value:function(){this.removeUserProfile(),this.userProfile=new Sk,this.userProfile.event.claimHourRewardDone.add(this.claimHourRewardDone,this),this.layoutMain.addChild(this.userProfile)}},{key:"claimHourRewardDone",value:function(){this.userProfile.event.claimHourRewardDone.remove(this.claimHourRewardDone,this),WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"removeUserProfile",value:function(){null!==this.userProfile&&(this.layoutMain.removeChild(this.userProfile),this.userProfile.destroy(),this.userProfile=null)}},{key:"addScollList",value:function(){this.removeScrollList(),this.scrollList=new JC,this.scrollList.event.playGame.add(this.onPlayGameScrollList,this),this.scrollList.event.nudgeFriend.add(this.nudgeFriend,this),this.scrollList.event.deleteChallenge.add(this.deleteChallenge,this)}},{key:"removeScrollList",value:function(){null!==this.scrollList&&(this.removeChild(this.scrollList),this.scrollList.destroy(),this.scrollList=null)}},{key:"onPlayGameScrollList",value:function(e){WF.instance().changeScreen(Ce.TURN_BASE,e)}},{key:"nudgeFriend",value:function(e){var t=new SFS2X.SFSObject;t.putInt("opponent_id",e.opponentEntity.id),mZ.instance().sendData(Et.POKE_USER_REQUEST,t)}},{key:"deleteChallenge",value:function(e){if(e.length>0){var t=new SFS2X.SFSArray;for(i=0;i<e.length;i++)t.addInt(e[i]);var n=new Wc("Bạn có muốn xóa lời thách đấu này không?");n.event.CANCLE.add(function(){n.destroy()},this),n.event.OK.add(function(){n.destroy(),qe.instance().showLoading();var e=new SFS2X.SFSObject;e.putSFSArray("opponent_ids",t),mZ.instance().sendData(Et.TURNBASE_DELETE_GAME_REQUEST,e)},this),iC.instance().addChild(n)}}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.MAIN_MENU_LOAD_RESPONSE&&(this.scrollList.handleMainMenuLoadResponse(e.params,1,function(e,n,i,o,a,s){z.instance().menuLoadResponses=e,t.scrollList.displayListChallenge(),t.bgFake.addChildren(t.scrollList),t.bgFake.addChild(t.btnParty),t.bgFake.addChild(t.btnPractice),t.bgFake.addChild(t.btnFindGame),1==z.instance().isScrollChange?t.scrollChange():t.scrollDefault(),z.instance().new_friend_request_count=i,z.instance().started_event_count=o,z.instance().hoursReward=a,z.instance().playScript=s,z.instance().init_quests_count=n,t.btnQuest.addDotNoti(z.instance().init_quests_count),t.btnEvent.addDotNoti(z.instance().started_event_count),t.navBar.addFriendRequest(z.instance().new_friend_request_count),z.instance().playScript.playing_guide==en.INIT&&WF.instance().changeScreen(Ce.TURN_BASE,{opponent:t.playScript.demoData.opponent,type:ng.TUTORIAL}),z.instance().playScript.playing_guide==en.DONE_TURNBASE&&t.addChild(en.instance()),z.instance().playScript.playing_guide==en.DONE_GET_QUEST&&(t.PlayScriptScreen=new en,t.PlayScriptScreen.afterInit(),t.PlayScriptScreen.addStep8AcceptChallenge(),t.PlayScriptScreen.event.step8.add(t.acceptChallenge,t),t.addChild(t.PlayScriptScreen))}),mZ.instance().sendRequestDataMessages(),mZ.instance().sendRequestSystemMessages()),e.cmd==Et.DAILY_REWARD_NOTIFICATION&&BR.begin(e.params,function(e,t){LogConsole.log(e),LogConsole.log(t),setTimeout(function(){iC.instance().changeScreen(Ce.DAILY_REWARD,{dailyRewardSettings:e,dailyRewardLog:t})},500)}),e.cmd==Et.POKE_USER_RESPONSE&&"OK"==e.params.getUtfString("status")&&WF.instance().changeScreen(Ce.MAIN_MENU),e.cmd==Et.TURNBASE_DELETE_GAME_RESPONSE&&"OK"==e.params.getUtfString("status")&&WF.instance().changeScreen(Ce.MAIN_MENU),e.cmd==Et.PLAY_SCRIPT_DONE_ALL_RESPONSE&&"OK"==e.params.getUtfString("status")&&(z.instance().playScript.playing_guide=en.DONE_ALL,en.instance().destroy(),WF.instance().changeScreen(Ce.MAIN_MENU)),e.cmd==Et.MAIN_MENU_CHECK_UPDATE_RESPONSE&&"OK"==e.params.getUtfString("status")&&(Bn.handleCheckUpdateMainMenu(e.params,function(e,n,i,o,a){z.instance().init_quests_count=e,z.instance().new_friend_request_count=n,z.instance().started_event_count=i,z.instance().hoursReward=o,z.instance().playScript=a,t.refreshButNotRefresh()}),1==z.instance().isScrollChange?this.scrollChange():this.scrollDefault())}},{key:"refreshButNotRefresh",value:function(){this.btnQuest.addDotNoti(z.instance().init_quests_count),this.btnEvent.addDotNoti(z.instance().started_event_count),this.navBar.addFriendRequest(z.instance().new_friend_request_count),z.instance().playScript.playing_guide==en.INIT&&WF.instance().changeScreen(Ce.TURN_BASE,{opponent:this.playScript.demoData.opponent,type:ng.TUTORIAL}),z.instance().playScript.playing_guide==en.DONE_TURNBASE&&this.addChild(en.instance()),z.instance().playScript.playing_guide==en.DONE_GET_QUEST&&(this.PlayScriptScreen=new en,this.PlayScriptScreen.afterInit(),this.PlayScriptScreen.addStep8AcceptChallenge(),this.PlayScriptScreen.event.step8.add(this.acceptChallenge,this),this.addChild(this.PlayScriptScreen))}},{key:"acceptChallenge",value:function(){this.scrollList.acceptChallengeBot()}},{key:"onUpdateUserVars",value:function(){this.user.avatar!==mZ.instance().dataMySeft.avatar&&(this.user.avatar=mZ.instance().dataMySeft.avatar,this.addUserProfile()),this.user.user_name!==mZ.instance().dataMySeft.user_name&&(this.user.user_name=mZ.instance().dataMySeft.user_name,this.userProfile.updateValue(Sk.UPDATE_NAME))}},{key:"removeAllChild",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"destroy",value:function(){for(null!==this.timeoutLoading&&clearTimeout(this.timeoutLoading),this.removeEventExtension(),this.timeLoopAnim.stop(),this.timeLoopAnim.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&WR(n.prototype,o),a&&WR(n,a),t}();function JR(e){return(JR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $R(e,t,n){return($R="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ex(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ex(e){return(ex=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tx(e,t){return(tx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ix=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=ex(t).call(this,game,null))||"object"!==JR(i)&&"function"!=typeof i?nx(n):i).event={back:new Phaser.Signal,search:new Phaser.Signal},e.bg=new rt(e.mainData.positionCreateRoom.bg_header),e.addChild(e.bg),e.btnBack=new pt(e.mainData.positionCreateRoom.button_back,e.chooseBack,nx(nx(e))),e.addChild(e.btnBack),e.txtTitle=null,e.btnDiamond=null,e.txtIdPhong=null,e.txtNguoiTao=null,e.btnSearch=null,e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tx(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBackButton,this),mZ.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this)}},{key:"removeEvent",value:function(){LogConsole.log("removeEvent HEADER"),De.instance().event.backButton.remove(this.chooseBackButton,this),mZ.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this)}},{key:"onUserVarsUpdate",value:function(e){null!==this.btnDiamond&&this.btnDiamond.setText(mZ.instance().dataMySeft.diamond)}},{key:"chooseBackButton",value:function(){this.chooseBack(!0)}},{key:"setHideBtnBack",value:function(){this.btnBack.visible=!1}},{key:"setShowBtnBack",value:function(){this.btnBack.visible=!0}},{key:"chooseBack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.btnBack.inputEnabled=!1,LogConsole.log("chooseBack header"),this.event.back.dispatch(e)}},{key:"chooseSearch",value:function(){this.event.search.dispatch()}},{key:"setSearchButton",value:function(){this.btnSearch=new pt(this.mainData.positionCreateRoom.button_search,this.chooseSearch,this),this.addChild(this.btnSearch)}},{key:"setTitle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CHƠI NHÓM";this.txtTitle=new St(this.mainData.positionCreateRoom.txt_title_header,e),this.txtTitle.setTextBounds(0,0,game.width,this.bg.height*z.instance().scale),this.addChild(this.txtTitle)}},{key:"setDiamond",value:function(){this.btnDiamond=new ln(this.mainData.positionCreateRoom.btn_diamond_header,mZ.instance().dataMySeft.diamond),this.addChild(this.btnDiamond)}},{key:"setWaittingRoom",value:function(){this.txtIdPhong=new St(this.mainData.positionCreateRoom.waitting_txt_idphong,"Phòng chơi: sadfdsfds"),this.txtIdPhong.setTextBounds(0,0,game.width,44*z.instance().scale),this.addChild(this.txtIdPhong),this.txtNguoiTao=new St(this.mainData.positionCreateRoom.waitting_txt_nguoitao,"Người tạo: hahahah"),this.txtNguoiTao.setTextBounds(0,0,game.width,28*z.instance().scale),this.addChild(this.txtNguoiTao)}},{key:"setIdPhong",value:function(e){null!==this.txtIdPhong&&(this.txtIdPhong.text="Phòng chơi: "+e)}},{key:"setNguoiTao",value:function(e){null!==this.txtNguoiTao&&(this.txtNguoiTao.text="Người tạo: "+e,this.txtNguoiTao.addColor("#FFA339",10))}},{key:"setStyleTitle",value:function(e){null!==this.txtTitle&&this.txtTitle.changeStyle(e)}},{key:"destroy",value:function(){this.removeEvent(),$R(ex(t.prototype),"destroy",this).call(this)}}])&&XR(n.prototype,i),o&&XR(n,o),t}();function ox(e){return(ox="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ax(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sx(e,t){return!t||"object"!==ox(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rx(e,t,n){return(rx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lx(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function lx(e){return(lx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hx(e,t){return(hx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),sx(this,lx(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hx(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={close:new Phaser.Signal,create_room:new Phaser.Signal,quick_play:new Phaser.Signal},this.positionCreateRoom=JSON.parse(game.cache.getText("positionCreateRoom")),this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg),this.header=new ix,this.header.setTitle(),this.header.event.back.add(this.chooseBack,this),this.addChild(this.header),this.txtTimPhong=new St(this.mainData.positionCreateRoom.choose_game_text_timphong,"Tìm phòng"),this.addChild(this.txtTimPhong),this.btnInputText=new ya(this.mainData.positionCreateRoom.choose_game_bg_input_text,"Nhập id phòng...",this.chooseInputText,this),this.addChild(this.btnInputText),this.btnThamgia=new ln(this.mainData.positionCreateRoom.choose_game_btn_thamgia,"THAM GIA",this.chooseThamGia,this),this.addChild(this.btnThamgia),this.line=new rt(this.mainData.positionCreateRoom.choose_game_bg_line),this.addChild(this.line),this.btnChoiNgay=new ln(this.mainData.positionCreateRoom.choose_game_btn_choingay,"CHƠI NHANH",this.chooseQuickPlay,this),this.addChild(this.btnChoiNgay),this.btnTaoPhong=new ln(this.mainData.positionCreateRoom.choose_game_btn_taophong,"TẠO PHÒNG",this.chooseCreateRoom,this),this.addChild(this.btnTaoPhong),Le.instance().logEvent(Le.Party_online_mode),qe.instance().hideLoading(),!1===li.instance().showInterstitialCreateRoom()&&!1===li.instance().showInterstitialQuickPlay()&&li.instance().showBanerPartyModeScreen(),this.addEvent()}},{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this)}},{key:"chooseBack",value:function(){LogConsole.log("chooseCreateRoom--------"),this.onCancel(),z.instance().state="",this.event.close.dispatch()}},{key:"chooseQuickPlay",value:function(){LogConsole.log("chooseCreateRoom--------"),this.onCancel(),this.event.quick_play.dispatch()}},{key:"chooseCreateRoom",value:function(){LogConsole.log("chooseCreateRoom--------"),this.onCancel(),this.event.create_room.dispatch()}},{key:"chooseThamGia",value:function(){""===rl.instance().getValue()?(iC.instance().addDialog("Chưa nhập id phòng"),this.onCancel()):this.enterKeyBoard()}},{key:"chooseInputText",value:function(){var e={maxLength:"",showTransparent:!0,placeholder:"Nhập id phòng",isSearch:!1,typeInputText:"input",configText:{width:this.btnInputText.width,height:this.btnInputText.height,x:this.btnInputText.x,y:this.btnInputText.y},inputType:"number"};rl.instance().show(e),rl.instance().event.change.add(this.changeKeyBoard,this),rl.instance().event.hideKeyboard.add(this.hideKeyboard,this),rl.instance().event.enter.add(this.enterKeyBoard,this),rl.instance().event.submit.add(this.enterKeyBoard,this),rl.instance().event.cancle.add(this.onCancel,this)}},{key:"hideKeyboard",value:function(){rl.instance().hide()}},{key:"onCancel",value:function(){this.btnInputText.visible=!0,rl.instance().event.change.remove(this.changeKeyBoard,this),rl.instance().event.hideKeyboard.remove(this.hideKeyboard,this),rl.instance().event.enter.remove(this.enterKeyBoard,this),rl.instance().event.submit.remove(this.enterKeyBoard,this),rl.instance().event.cancle.remove(this.onCancel,this),rl.instance().hide()}},{key:"changeKeyBoard",value:function(){LogConsole.log("changeKeyBoard")}},{key:"enterKeyBoard",value:function(){var e=parseInt(rl.instance().getValue());""!==e?isNaN(e)?iC.instance().addDialog("Id phòng không hợp lệ"):mZ.instance().sendData(R_.ONLINE_MODE_ROOM_QUICK_JOIN_REQUEST,P_.begin(parseInt(e))):iC.instance().addDialog("Id phòng không hợp lệ"),this.onCancel()}},{key:"destroy",value:function(){this.removeEvent(),this.header.destroy(),this.onCancel(),li.instance().hideBanner(),rx(lx(t.prototype),"destroy",this).call(this)}}])&&ax(n.prototype,i),o&&ax(n,o),t}();function ux(e){return(ux="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fx(e,t){return!t||"object"!==ux(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function px(e){return(px=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gx(e,t){return(gx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fx(this,px(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gx(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={choose_bet:new Phaser.Signal},this.data=null,this.positionCreateRoom=this.mainData.positionCreateRoom,this.bg=new rt(this.positionCreateRoom.choose_bet_bg_item_bet),this.addChild(this.bg),this.iconGem=new rt(this.positionCreateRoom.choose_bet_icon_gem_item_bet),this.addChild(this.iconGem),this.txtMoneyBet=new St(this.positionCreateRoom.choose_bet_txtmoney_item_bet,"0"),this.txtMoneyBet.setTextBounds(0,0,104*z.instance().scale,32*z.instance().scale),this.addChild(this.txtMoneyBet),this.txtMuccuoc=new St(this.positionCreateRoom.choose_bet_label_mucuoc_item_bet,"Mức cược"),this.txtMuccuoc.setTextBounds(0,0,150*z.instance().scale,35*z.instance().scale),this.addChild(this.txtMuccuoc),this.btnChoose=new ln(this.positionCreateRoom.choose_bet_btnchon_item_bet,"CHỌN",this.chooseBet,this),this.addChild(this.btnChoose)}},{key:"chooseBet",value:function(){LogConsole.log("chooseBet-OnlineModeChooseBetItem"),mZ.instance().dataMySeft.diamond<this.data.bet_place?iC.instance().addDialog("Bạn không đủ Diamond."):(this.btnChoose.inputEnabled=!1,this.event.choose_bet.dispatch(this.data))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e,t){this.data=e,this.txtMoneyBet.text=this.data.bet_place,this.x=game.width,game.add.tween(this).to({x:0},200,Phaser.Easing.Power1,!0,100+150*(t+1))}},{key:"width",get:function(){return this.game.width}},{key:"height",get:function(){return this.bg.height}}])&&dx(n.prototype,i),o&&dx(n,o),t}();function mx(e){return(mx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wx(e,t){return!t||"object"!==mx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bx(e,t,n){return(bx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sx(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Sx(e){return(Sx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _x(e,t){return(_x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ex=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),wx(this,Sx(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_x(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={back:new Phaser.Signal,choose_bet:new Phaser.Signal},qe.instance().showLoading(),this.arrBet=[],this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg),this.txtChonMucCuoc=new St(this.mainData.positionCreateRoom.choose_bet_label_chonmucuoc,"CHỌN MỨC CƯỢC"),this.txtChonMucCuoc.setTextBounds(0,0,game.width,72*z.instance().scale),this.addChild(this.txtChonMucCuoc);var e=new Phaser.Group(game,0,0,null);this.listBet=new Jo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-235*z.instance().scale),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),e.x=0,e.y=230*z.instance().scale,this.addChild(e),this.header=new ix,this.header.setDiamond(),this.header.event.back.add(this.chooseBack,this),this.addChild(this.header)}},{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),mZ.instance().events.onExtensionResponse.add(this.getData,this),Kr.instance().event.load_online_mode_room_bet_complete.add(this.buildDataRoomBet,this),!0===Kr.instance().ktLoadOnlineModeRoomBet?this.buildDataRoomBet():Kr.instance().sendGetOnlineModeRoomBet(),li.instance().showBanerChooseBettingCreateRoomScreen()}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),mZ.instance().events.onExtensionResponse.remove(this.getData,this),Kr.instance().event.load_online_mode_room_bet_complete.remove(this.buildDataRoomBet,this)}},{key:"buildDataRoomBet",value:function(){this.arrBet=Kr.instance().createroom_bet_setting,this.addListBet(),qe.instance().hideLoading()}},{key:"getData",value:function(e){switch(e.cmd){case R_.ONLINE_MODE_ROOM_LOAD_BET_RESPONSE:}}},{key:"addListBet",value:function(){this.listBet.removeAll(),this.listBet.reset();for(var e=0;e<this.arrBet.length;e++){var t=new yx;t.event.choose_bet.add(this.chooseBet,this),t.setData(this.arrBet[e],e),this.listBet.add(t)}}},{key:"chooseBet",value:function(e){LogConsole.log("choose_bet"),mZ.instance().dataMySeft.diamond<this.betMoney?iC.instance().addDialogConfirnMoney("Bạn không đủ kim cương tạo phòng, bạn có muốn nạp thêm?"):this.event.choose_bet.dispatch(e.id,e.bet_place)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listBet.removeAll(),this.listBet.destroy(),li.instance().hideBanner(),bx(Sx(t.prototype),"destroy",this).call(this)}}])&&vx(n.prototype,i),o&&vx(n,o),t}();function Cx(e){return(Cx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Px(e,t){return!t||"object"!==Cx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ox(e){return(Ox=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rx(e,t){return(Rx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Px(this,Ox(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rx(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={buy:new Phaser.Signal,select:new Phaser.Signal},this.data=null,this.positionCreateRoom=this.mainData.positionCreateRoom,this.ava=new Ch,this.ava.x=33*z.instance().scale,this.ava.y=16*z.instance().scale,this.ava.setSize(107*z.instance().scale,107*z.instance().scale),this.addChild(this.ava),this.txtName=new St(this.positionCreateRoom.choose_playlist_itemplaylist_txtname,""),this.txtName.setTextBounds(0,0,305*z.instance().scale,66*z.instance().scale),this.addChild(this.txtName),this.txtVip=new St(this.positionCreateRoom.choose_playlist_itemplaylist_vip,""),this.txtVip.setTextBounds(0,0,305*z.instance().scale,28*z.instance().scale),this.level=new Mh,this.level.x=this.positionCreateRoom.choose_playlist_itemplaylist_vip.x*z.instance().scale,this.level.y=this.positionCreateRoom.choose_playlist_itemplaylist_vip.y*z.instance().scale,this.addChild(this.level),this.btnBuy=null,this.line=new rt(this.positionCreateRoom.choose_playlist_itemplaylist_line),this.addChild(this.line)}},{key:"setButtonBuy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.removeBtnBuy(),this.btnBuy=new ln(this.positionCreateRoom.choose_playlist_itemplaylist_btnBuy,e,this.chooseBuy,this),this.addChild(this.btnBuy),this.line.visible=!1}},{key:"removeBtnBuy",value:function(){null!==this.btnBuy&&(this.removeChild(this.btnBuy),this.btnBuy.destroy(),this.btnBuy=null)}},{key:"setButtonChoose",value:function(){this.removeBtnBuy(),this.btnBuy=new ln(this.positionCreateRoom.choose_playlist_itemplaylist_select,"Chọn",this.chooseSelect,this),this.addChild(this.btnBuy)}},{key:"setDataQuickPlay",value:function(e,t){this.data=e,this.ava.beginLoad(this.data.thumb,t),this.txtName.text=this.data.name,1==this.data.is_owner?this.setButtonChoose():this.setButtonBuy(this.data.price),this.level.visible=!0,this.level.setData(this.data.user),t<8?(this.x=game.width,game.add.tween(this).to({x:0},200,Phaser.Easing.Power1,!0,250+50*(t+1))):this.x=0}},{key:"setData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.data=e,this.ava.beginLoad(this.data.thumb,t),this.txtName.text=this.data.name,!1===n?(this.level.visible=!0,this.level.setData(this.data.user),t<8?(this.x=game.width,game.add.tween(this).to({x:0},200,Phaser.Easing.Power1,!0,250+50*(t+1))):this.x=0):this.level.visible=!1}},{key:"chooseBuy",value:function(){LogConsole.log("chooseBuy"),null!=this.data&&iC.instance().addPopupBuy(this.data)}},{key:"chooseSelect",value:function(){LogConsole.log("chooseSelect"),this.btnBuy.inputEnabled=!1,Kr.instance().playlist.setUpdateTimePlaylistById(this.data.id),this.event.select.dispatch(this.data)}},{key:"width",get:function(){return 640*z.instance().scale}},{key:"height",get:function(){return 145*z.instance().scale}}])&&kx(n.prototype,i),o&&kx(n,o),t}();function Tx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ix=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("playlist_id",e),LogConsole.log(t.getDump()),t}}],(n=null)&&Tx(t.prototype,n),i&&Tx(t,i),e}();function Ax(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Lx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){var n=new SFS2X.SFSObject;return n.putInt("playlist_id",e),n.putInt("bet_id",t),n}}],(n=null)&&Ax(t.prototype,n),i&&Ax(t,i),e}();function Gx(e){return(Gx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Mx(e){return(Mx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nx(e,t){return(Nx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bx(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var jx=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=Mx(t).call(this,game,null))||"object"!==Gx(a)&&"function"!=typeof a?Bx(o):a).event={close:new Phaser.Signal},i.positionCreateRoom=i.mainData.positionCreateRoom,i.bg=new pt(i.positionCreateRoom.chat_waitting_friend_chat_bg),i.addChild(i.bg),i.ava=new Pc,i.ava.setSize(68,68),i.ava.setAvatar(n,0),i.ava.x=18,i.ava.y=17,i.addChild(i.ava),i.txtChat=new St(i.positionCreateRoom.chat_waitting_friend_chat_text,e),i.txtChat.y=(i.bg.height-i.txtChat.height)/2,i.addChild(i.txtChat),i.close=new pt(i.positionCreateRoom.chat_waitting_friend_chat_close,i.chooseClose,Bx(Bx(i))),i.addChild(i.close),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nx(e,t)}(t,Mt),n=t,(i=[{key:"setIcon",value:function(e){this.create(this.txtChat.x+this.txtChat.width+10,20,"createroom",e)}},{key:"chooseClose",value:function(){this.event.close.dispatch()}}])&&Dx(n.prototype,i),o&&Dx(n,o),t}();function Ux(e){return(Ux="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zx(e,t){return!t||"object"!==Ux(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hx(e,t,n){return(Hx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Qx(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Qx(e){return(Qx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vx(e,t){return(Vx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Zx(this,Qx(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vx(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){qe.instance().showLoading(),this.shopPlayList=null,this.isMaster=!1,this.betId=-1,this.betMoney=0,this.chatPlayer=null,this.idx=0,this.countItem=0,this.ktBuild=!0,this.idDelay=null,this.positionCreateRoom=this.mainData.positionCreateRoom,this.event={back:new Phaser.Signal,create_room:new Phaser.Signal},this.arrPlayList=[],this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new Phaser.Group(game,0,0,null);this.listPlayerlist=new Jo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-395*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),this.listPlayerlist.events.changeIndex.add(this.changeIndex,this),e.x=0,e.y=240*z.instance().scale,this.addChild(e),this.header=new ix,this.header.setTitle("CHỌN PLAYLIST"),this.header.event.back.add(this.chooseBack,this),this.addChild(this.header),this.bgSuggestPlayList=new Zt(this.positionCreateRoom.choose_playlist_itemplaylist_bg),this.addChild(this.bgSuggestPlayList),this.bgSuggestPlayList.x=game.width,this.playlistSuggest=new xx,this.playlistSuggest.setButtonBuy(200),this.playlistSuggest.y=this.positionCreateRoom.choose_playlist_itemplaylist_bg.y*z.instance().scale,this.addChild(this.playlistSuggest),this.playlistSuggest.x=game.width,this.btnBuyMore=new ln(this.positionCreateRoom.choose_playlist_btn_muathemplaylist,"MUA THÊM PLAYLIST",this.chooseBuyMore,this),this.btnBuyMore.y=game.height-120*z.instance().scale,this.btnBuyMore.x=(game.width-this.btnBuyMore.width)/2,this.addChild(this.btnBuyMore),this.btnBuyMore.y=game.height,game.add.tween(this.btnBuyMore).to({y:game.height-120*z.instance().scale},150,Phaser.Easing.Power1,!0,300)}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),Kr.instance().event.buy_playlist.add(this.playListData,this),Kr.instance().event.load_playlist_complete.add(this.playListData,this),li.instance().showBanerChoosePlaylistCreateRoomScreen(),!0===Kr.instance().ktLoadPlaylist?this.playListData():Kr.instance().sendGetDataShop()}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),mZ.instance().events.onExtensionResponse.remove(this.getData,this),Kr.instance().event.buy_playlist.remove(this.playListData,this),Kr.instance().event.load_playlist_complete.remove(this.playListData,this)}},{key:"getData",value:function(e){switch(e.cmd){case R_.ONLINE_MODE_ROOM_LOAD_PLAYLIST_RESPONSE:case Js.SHOP_BUY_PLAYLIST_RESPONSE:}}},{key:"addChatRoom",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.removeChatRoom(),this.chatPlayer=new jx(e,t),""!==n&&this.chatPlayer.setIcon(n),this.chatPlayer.y=-102,this.chatPlayer.event.close.add(this.removeChatRoom,this),this.addChild(this.chatPlayer),game.add.tween(this.chatPlayer).to({y:1},300,Phaser.Easing.Power1,!0)}},{key:"removeChatRoom",value:function(){null!==this.chatPlayer&&(this.removeChild(this.chatPlayer),this.chatPlayer.destroy(),this.chatPlayer=null)}},{key:"setBetMoney",value:function(e){this.betMoney=e}},{key:"setBetId",value:function(e,t){this.betId=e,this.betMoney=t}},{key:"setIsMaster",value:function(e){this.isMaster=e,!1===this.isMaster?this.header.setHideBtnBack():(this.header.setShowBtnBack(),De.instance().event.backButton.add(this.chooseBack,this))}},{key:"playListData",value:function(){var e=Kr.instance().playlist.getSuggestPlaylist();this.playlistSuggest.setData(e,0,!0),this.playlistSuggest.setButtonBuy(e.price),this.arrPlayList=Kr.instance().playlist.getArrMe(),this.buildListPlaylist(),qe.instance().hideLoading()}},{key:"buildListPlaylist",value:function(){game.add.tween(this.bgSuggestPlayList).to({x:this.positionCreateRoom.choose_playlist_itemplaylist_bg.x},150,Phaser.Easing.Power1,!0,300),game.add.tween(this.playlistSuggest).to({x:0},150,Phaser.Easing.Power1,!0,300),this.listPlayerlist.removeAll(),this.listPlayerlist.reset(),this.arrPlayList.sort(this.compareUserPlaylistMappingUpdate),this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(){var e=this.listPlayerlist.getIdx();this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrPlayList.length;e++){var t=new xx;if(t.setData(this.arrPlayList[e],e),t.event.buy.add(this.chooseBuyPlaylist,this),t.event.select.add(this.chooseSelectPlaylist,this),t.setButtonChoose(),this.listPlayerlist.add(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrPlayList.length){this.ktBuild=!1;break}this.idx===this.arrPlayList.length&&(this.ktBuild=!1)}}},{key:"chooseBuyPlaylist",value:function(){LogConsole.log("chooseBuyPlaylist")}},{key:"chooseSelectPlaylist",value:function(e){var t=e.id;LogConsole.log("chooseSelectPlaylist : "+t),this.isMaster?mZ.instance().dataMySeft.diamond<this.betMoney?iC.instance().addDialogConfirnMoney("Bạn không đủ kim cương tạo phòng, bạn có muốn nạp thêm?"):(qe.instance().showLoading(),mZ.instance().sendData(R_.ONLINE_MODE_ROOM_CREATE_REQUEST,Lx.begin(t,this.betId))):mZ.instance().dataMySeft.diamond<this.betMoney?iC.instance().addDialogConfirnMoney("Bạn không đủ kim cương để chơi, bạn có muốn nạp thêm?","chooseCanclePopupMoney"):(qe.instance().showLoading(),mZ.instance().sendData(R_.ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_REQUEST,Ix.begin(t)))}},{key:"chooseBuyMore",value:function(){LogConsole.log("chooseBuyMore"),iC.instance().addShop(0)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.removeAllItem(),this.removeEvent(),this.removeDelayBuild(),this.listPlayerlist.removeAll(),this.listPlayerlist.destroy(),li.instance().hideBanner(),qe.instance().hideLoading(),Hx(Qx(t.prototype),"destroy",this).call(this)}}])&&Fx(n.prototype,i),o&&Fx(n,o),t}();function qx(e){return(qx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zx(e,t){return!t||"object"!==qx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yx(e){return(Yx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jx(e,t){return(Jx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),zx(this,Yx(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jx(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.mainData.modeplay=this.mainData.MODEPLAY.createroom,this.event={back:new Phaser.Signal,create_room:new Phaser.Signal},this.chooseBetScreen=null,this.choosePlaylistScreen=null,this.addChooseBetScreen(),Le.instance().logEvent(Le.Party_online_mode_Creatroom),this.addEvent()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case R_.ONLINE_MODE_ROOM_CREATE_RESPONSE:}}},{key:"addChooseBetScreen",value:function(){this.removeChooseBetScreen(),this.chooseBetScreen=new Ex,this.chooseBetScreen.event.choose_bet.add(this.chooseBetComplete,this),this.chooseBetScreen.event.back.add(this.chooseBack,this),this.addChild(this.chooseBetScreen),null!==this.choosePlaylistScreen?(zc.instance().beginSwitch(this.choosePlaylistScreen,this.chooseBetScreen,!0),zc.instance().event.tweenComplete.add(this.tweenChooseBetComplete,this)):this.chooseBetScreen.addEvent()}},{key:"chooseBetComplete",value:function(e,t){this.addChoosePlaylistScreen(e,t)}},{key:"removeChooseBetScreen",value:function(){null!==this.chooseBetScreen&&(this.removeChild(this.chooseBetScreen),this.chooseBetScreen.destroy(),this.chooseBetScreen=null)}},{key:"tweenChooseBetComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenChooseBetComplete,this),this.removeChoosePlaylistScreen(),null!==this.chooseBetScreen&&this.chooseBetScreen.addEvent()}},{key:"addChoosePlaylistScreen",value:function(e,t){LogConsole.log("addChoosePlaylistScreen"),this.removeChoosePlaylistScreen(),this.choosePlaylistScreen=new Wx,this.choosePlaylistScreen.setBetId(e,t),this.choosePlaylistScreen.setIsMaster(!0),this.choosePlaylistScreen.event.create_room.add(this.callCreateRoom,this),this.choosePlaylistScreen.event.back.add(this.addChooseBetScreen,this),this.addChild(this.choosePlaylistScreen),null!==this.chooseBetScreen?(zc.instance().beginSwitch(this.chooseBetScreen,this.choosePlaylistScreen,!1),zc.instance().event.tweenComplete.add(this.tweenChoosePlayListComplete,this)):this.choosePlaylistScreen.addEvent()}},{key:"removeChoosePlaylistScreen",value:function(){null!==this.choosePlaylistScreen&&(this.removeChild(this.choosePlaylistScreen),this.choosePlaylistScreen.destroy(),this.choosePlaylistScreen=null)}},{key:"callCreateRoom",value:function(){mZ.instance().sendData(R_.ONLINE_MODE_ROOM_CREATE_REQUEST,SendOnlineModeCRRoomCreate.begin(1,1))}},{key:"tweenChoosePlayListComplete",value:function(){this.removeChooseBetScreen(),zc.instance().event.tweenComplete.remove(this.tweenChoosePlayListComplete,this),null!==this.choosePlaylistScreen&&this.choosePlaylistScreen.addEvent()}},{key:"chooseBack",value:function(){this.event.back.dispatch()}}])&&Kx(n.prototype,i),o&&Kx(n,o),t}();var $x=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.user_name="",this.avatar="",this.gender="",this.experience_score=0,this.heart=0,this.diamond=0,this.ticket=0,this.weekly_high_score=0,this.all_time_high_score=0,this.level=0,this.online_mode_genre=0,this.online_mode_room_ready=!1,this.online_mode_loaded=0,this.is_playing_game=!1,this.isMaster=!1,this.score=0,this.diamond_change=0,this.exp_score=0};function eT(e){return(eT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nT(e,t){return!t||"object"!==eT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iT(e,t,n){return(iT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oT(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oT(e){return(oT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aT(e,t){return(aT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sT=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nT(this,oT(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aT(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.positionCreateRoom=this.mainData.positionCreateRoom,this.spriteLoading=new rt(this.positionCreateRoom.waitting_user_loading_ava),this.spriteLoading.anchor.x=.5,this.spriteLoading.anchor.y=.5,this.addChild(this.spriteLoading),this.spriteLoading.x=this.spriteLoading.width/2,this.spriteLoading.y=this.spriteLoading.height/2,LogConsole.log(this.spriteLoading.x),LogConsole.log(this.spriteLoading.y),this.timerToCountTime=null,this.timerEvent=null}},{key:"beginLoad",value:function(){this.removetimer(),this.timerToCountTime=this.game.time.create(!0),this.timerEvent=this.timerToCountTime.loop(50,this.onTimerToCountTime,this),this.timerToCountTime.start()}},{key:"onTimerToCountTime",value:function(){LogConsole.log("onTimerToCountTime"),this.spriteLoading.rotation+=.1}},{key:"removetimer",value:function(){null!==this.timerToCountTime&&(game.time.events.remove(this.timerEvent),this.timerEvent=null,this.timerToCountTime.stop(),this.timerToCountTime.destroy(),this.timerToCountTime=null)}},{key:"destroy",value:function(){this.removetimer(),iT(oT(t.prototype),"destroy",this).call(this)}}])&&tT(n.prototype,i),o&&tT(n,o),t}();function rT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var lT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("kick_user_id",e),t}}],(n=null)&&rT(t.prototype,n),i&&rT(t,i),e}();function hT(e){return(hT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function uT(e,t){return!t||"object"!==hT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dT(e,t,n){return(dT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fT(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fT(e){return(fT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pT(e,t){return(pT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gT=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),uT(this,fT(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pT(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={kick:new Phaser.Signal,click_avatar:new Phaser.Signal,choose_invite:new Phaser.Signal},this.data=new $x,this.ktEmpty=!0,this.idMaster=-1,this.idx=0,this.tween=null,this.ktShowKich=!1,this.ktShowLoading=!1,this.btnWin=null,this.ktDisConnect=!1,this.ktPlay=!1,this.iconChat=null,this.positionCreateRoom=this.mainData.positionCreateRoom,this.bg=new pt({x:0,y:0,nameAtlas:"createroom",nameSprite:"bg_header_playlist_suggest"},this.choosePlayer,this),this.bg.alpha=0,this.addChild(this.bg),this.txtName=new St(this.positionCreateRoom.waitting_user_txt_name,"Viet PV"),this.txtName.setTextBounds(0,0,155*z.instance().scale,34*z.instance().scale),this.addChild(this.txtName),this.btnKick=new ln(this.positionCreateRoom.waitting_user_btn_kick_trai,"KÍCH",this.chooseKick,this),this.btnKick.visible=!1,this.btnKick.x=130*z.instance().scale,this.btnKick.y=(this.positionCreateRoom.waitting_user_btn_kick_trai.y-28)*z.instance().scale,this.addChild(this.btnKick),this.btnProfile=new ln(this.positionCreateRoom.waitting_user_btn_kick_trai,"XEM",this.chooseProfile,this),this.btnProfile.visible=!1,this.btnProfile.x=130*z.instance().scale,this.btnProfile.y=(this.positionCreateRoom.waitting_user_btn_kick_trai.y+28)*z.instance().scale,this.addChild(this.btnProfile),this.btnKickPhai=new ln(this.positionCreateRoom.waitting_user_btn_kick_phai,"KÍCH",this.chooseKick,this),this.btnKickPhai.visible=!1,this.btnKickPhai.x=-78*z.instance().scale,this.btnKickPhai.y=(this.positionCreateRoom.waitting_user_btn_kick_phai.y-28)*z.instance().scale,this.addChild(this.btnKickPhai),this.btnProfilePhai=new ln(this.positionCreateRoom.waitting_user_btn_kick_phai,"XEM",this.chooseProfile,this),this.btnProfilePhai.visible=!1,this.btnProfilePhai.x=-78*z.instance().scale,this.btnProfilePhai.y=(this.positionCreateRoom.waitting_user_btn_kick_phai.y+28)*z.instance().scale,this.addChild(this.btnProfilePhai),this.ava=new Pc,this.ava.setSize(150*z.instance().scale,150*z.instance().scale),this.ava.x=2.5*z.instance().scale,this.ava.y=51.5*z.instance().scale,this.addChild(this.ava),this.bg.width=this.ava.width,this.bg.height=this.ava.height,this.bg.x=this.ava.x,this.bg.y=this.ava.y,this.btnWaitting=new pt(this.positionCreateRoom.waitting_user_bg_player_waiting,this.chooseWaitting,this),this.btnWaitting.visible=!1,this.addChild(this.btnWaitting),this.khungAva=new rt(this.positionCreateRoom.waitting_user_khungava),this.addChild(this.khungAva),this.loading=new sT,this.loading.y=49*z.instance().scale,this.loading.visible=!1,this.addChild(this.loading),this.txtSanSang=new St(this.positionCreateRoom.waitting_user_txt_sansang,""),this.txtSanSang.setTextBounds(0,0,155*z.instance().scale,29*z.instance().scale),this.addChild(this.txtSanSang),this.trueFailAnswer=new Bd,this.trueFailAnswer.setSize(330*z.instance().scale,330*z.instance().scale),this.trueFailAnswer.x=-87*z.instance().scale,this.trueFailAnswer.y=-35*z.instance().scale,this.addChild(this.trueFailAnswer),this.addEvent()}},{key:"addEvent",value:function(){mZ.instance().events.onPublicMessage.add(this.onPublicMessage,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onPublicMessage.remove(this.onPublicMessage,this)}},{key:"onPublicMessage",value:function(e){LogConsole.log("onPublicMessage"),LogConsole.log(e);var t=e.message;if(console.log("command : "+t),t===Pe.CHAT_ONLINE_MODE){var n=e.sender,i=parseInt(n.name);console.log("aaaaaaaaaaaaaaaa"),e.data.containsKey("typeicon")&&this.data.user_id===i&&(this.removeIconChat(),this.iconChat=new M_(e.data.getUtfString("typeicon")),this.iconChat.event.call_remove.add(this.removeIconChat,this),this.iconChat.anchor.x=.5,this.iconChat.anchor.y=.5,this.iconChat.x=this.ava.x+this.ava.width/2,this.iconChat.y=this.ava.y+this.ava.height/2,game.add.tween(this.iconChat.scale).to({x:1.5,y:1.5},50,"Linear",!0),this.addChild(this.iconChat))}}},{key:"removeIconChat",value:function(){null!==this.iconChat&&(this.removeChild(this.iconChat),this.iconChat.destroy(),this.iconChat=null)}},{key:"setDisConnect",value:function(){this.ktDisConnect=!0}},{key:"setPlay",value:function(e){this.ktPlay=e,this.ktPlay&&(this.idx%2==0?this.onCompleteHideTween():this.onCompleteHideTweenPhai())}},{key:"setDefaultUser",value:function(){this.txtName.changeStyle({fontSize:25}),this.txtSanSang.changeStyle({fontSize:21,font:"Gilroy",fill:"#7B7788"}),this.txtName.y=this.positionCreateRoom.waitting_user_txt_name.y*this.mainData.scale,this.txtSanSang.y=this.positionCreateRoom.waitting_user_txt_sansang.y*this.mainData.scale,this.removeButtonWin()}},{key:"setButtonWin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.removeButtonWin(),this.setGameOver(),!0===e?(this.btnWin=new ln(this.positionCreateRoom.result_btn_money_ava_result,"+"+(this.data.diamond_change+t)),this.btnWin.scale.x=1.3,this.btnWin.scale.y=1.3,this.btnWinExp=new ln(this.positionCreateRoom.result_btn_exp_ava_result_win,"+"+this.data.exp_score),this.btnWinExp.scale.x=1.3,this.btnWinExp.scale.y=1.3,this.addChild(this.btnWinExp)):(this.btnWin=new ln(this.positionCreateRoom.result_btn_exp_ava_result_lose,"+"+this.data.exp_score),this.btnWin.scale.x=1.3,this.btnWin.scale.y=1.3),this.addChild(this.btnWin),this.txtName.y=-30*z.instance().scale,this.txtSanSang.y=12*z.instance().scale}},{key:"removeButtonWin",value:function(){null!==this.btnWin&&(this.removeChild(this.btnWin),this.btnWin.destroy(),this.btnWin=null),null!==this.btnWinExp&&this.removeChild(this.btnWinExp)}},{key:"setScore",value:function(e){this.setTextSanSang(e)}},{key:"setTrueAnswer",value:function(){this.trueFailAnswer.setTrueAnswer()}},{key:"setFailtAnswer",value:function(){this.trueFailAnswer.setFailtAnswer()}},{key:"hideKhungAvatar",value:function(){this.khungAva.visible=!1}},{key:"showKhungAvatar",value:function(){this.khungAva.visible=!1}},{key:"setLoading",value:function(e){!1===this.ktShowLoading&&this.showLoading(),100===e&&(this.setTextSanSang("Sẵn Sàng"),this.hideLoading())}},{key:"showLoading",value:function(){!1===this.ktShowLoading&&(LogConsole.log("showLoading----------"),this.ktShowLoading=!0,this.loading.visible=!0,this.loading.beginLoad(),this.hideKhungAvatar(),this.setTextSanSang("Đang tải..."))}},{key:"hideLoading",value:function(){LogConsole.log("hideLoading----------"),this.ktShowLoading=!1,this.loading.visible=!1,this.loading.removetimer()}},{key:"setMaster",value:function(e){this.idMaster=e,this.setTextMaster()}},{key:"setData",value:function(e,t){this.data=Object.assign({},this.data,e),this.ktEmpty=!1,this.ava.visible=!0,this.khungAva.visible=!0,this.txtName.text=this.data.user_name,this.ava.setAvatar(this.data.avatar,t),!0===this.data.isMaster?this.setTextSanSang(""):this.data.online_mode_room_ready?this.setTextSanSang("Sẵn sàng"):this.setTextSanSang("Chưa sẵn sàng"),this.btnWaitting.visible=!1}},{key:"setGameOver",value:function(){this.txtName.changeStyle({fontSize:33}),this.txtSanSang.changeStyle({fontSize:32,font:"GilroyBold",fill:"#ffffff"})}},{key:"setUserPlayGame",value:function(){this.txtSanSang.changeStyle({fontSize:32,font:"GilroyBold",fill:"#ffffff"}),this.txtSanSang.y=(this.positionCreateRoom.waitting_user_txt_sansang.y-4)*this.mainData.scale}},{key:"setDataQuickPlay",value:function(e,t){this.data=Object.assign({},this.data,e),this.ktEmpty=!1,this.ava.visible=!0,this.khungAva.visible=!0,this.txtName.text=this.data.user_name,this.ava.setAvatar(this.data.avatar,t),this.btnWaitting.visible=!1,this.setTextSanSang("")}},{key:"setTextMaster",value:function(){!0===this.data.isMaster?this.setTextSanSang(""):this.data.online_mode_room_ready?this.setTextSanSang("Sẵn sàng"):this.setTextSanSang("Chưa sẵn sàng")}},{key:"setCurrentData",value:function(e){this.data=Object.assign({},this.data,e)}},{key:"getData",value:function(){return this.data}},{key:"setEmpty",value:function(){this.ktEmpty=!0,this.btnWaitting.visible=!0,this.ava.visible=!1,this.txtName.text="",this.btnKick.visible=!1,this.btnKick.inputEnabled=!1,this.btnKickPhai.visible=!1,this.btnKickPhai.inputEnabled=!1,this.btnProfile.visible=!1,this.btnProfile.inputEnabled=!1,this.btnProfilePhai.visible=!1,this.btnProfilePhai.inputEnabled=!1,this.ktDisConnect=!1,this.ktPlay=!1,this.ktShowKich=!1,this.ktShowLoading=!1,this.setTextSanSang("Đợi người chơi"),this.hideKhungAvatar(),this.hideLoading(),this.idx%2==0?this.onCompleteHideTween():this.onCompleteHideTweenPhai()}},{key:"setTextSanSang",value:function(e){this.txtSanSang.text=e}},{key:"setIdx",value:function(e){this.idx=e}},{key:"getIdx",value:function(){return this.idx}},{key:"choosePlayer",value:function(){LogConsole.log("choosePlayer : "+this.ktPlay),!1===this.ktPlay&&(mZ.instance().dataMySeft.user_id===this.data.user_id?iC.instance().addUserProfile(this.data.user_id):(console.log("SocketController.instance().dataMySeft.user_id : "+mZ.instance().dataMySeft.user_id),console.log("this.idMaster : "+this.idMaster),mZ.instance().dataMySeft.user_id===this.idMaster?(this.ktShowKich=!this.ktShowKich,this.event.click_avatar.dispatch(this.idx),this.ktShowKich?this.idx%2==0?this.setShowKichTween():this.setShowKichTweenPhai():this.idx%2==0?this.setHideKichTween():this.setHideKichTweenPhai()):iC.instance().addUserProfile(this.data.user_id)))}},{key:"setCheckHideKichTween",value:function(){!0===this.ktShowKich&&(this.idx%2==0?this.setHideKichTween():this.setHideKichTweenPhai())}},{key:"setShowKichTween",value:function(){this.removeTween();var e;this.btnKick.x=57*z.instance().scale,this.btnKick.visible=!0,this.btnKick.inputEnabled=!1,e=130*z.instance().scale,this.ktShowKich=!0,this.btnProfile.x=57*z.instance().scale,this.btnProfile.visible=!0,this.btnProfile.inputEnabled=!1,this.tween=game.add.tween(this.btnKick).to({x:e},200,Phaser.Easing.Power1,!0),this.tween=game.add.tween(this.btnProfile).to({x:e},200,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.onCompleteShowTween,this)}},{key:"setHideKichTween",value:function(){this.removeTween();var e;this.btnKick.x=130*z.instance().scale,this.btnKick.visible=!0,this.btnKick.inputEnabled=!1,this.btnProfile.x=130*z.instance().scale,this.btnProfile.visible=!0,this.btnProfile.inputEnabled=!1,e=57*z.instance().scale,this.ktShowKich=!1,this.tween=game.add.tween(this.btnKick).to({x:e},200,Phaser.Easing.Power1,!0),this.tween=game.add.tween(this.btnProfile).to({x:e},200,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.onCompleteHideTween,this)}},{key:"setShowKichTweenPhai",value:function(){this.removeTween();var e;this.btnKickPhai.x=2*z.instance().scale,this.btnKickPhai.visible=!0,this.btnKickPhai.inputEnabled=!1,this.btnProfilePhai.x=2*z.instance().scale,this.btnProfilePhai.visible=!0,this.btnProfilePhai.inputEnabled=!1,e=-78*z.instance().scale,this.ktShowKich=!0,this.tween=game.add.tween(this.btnKickPhai).to({x:e},200,Phaser.Easing.Power1,!0),this.tween=game.add.tween(this.btnProfilePhai).to({x:e},200,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.onCompleteShowTweenPhai,this)}},{key:"setHideKichTweenPhai",value:function(){this.removeTween();this.btnKickPhai.x=-78*z.instance().scale,this.btnKickPhai.visible=!0,this.btnKickPhai.inputEnabled=!1,this.btnProfilePhai.x=-78*z.instance().scale,this.btnProfilePhai.visible=!0,this.btnProfilePhai.inputEnabled=!1,this.ktShowKich=!1,this.tween=game.add.tween(this.btnKickPhai).to({x:2},200,Phaser.Easing.Power1,!0),this.tween=game.add.tween(this.btnProfilePhai).to({x:2},200,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.onCompleteHideTweenPhai,this)}},{key:"onCompleteShowTweenPhai",value:function(){this.btnKickPhai.visible=!0,this.btnKickPhai.inputEnabled=!0,this.btnProfilePhai.visible=!0,this.btnProfilePhai.inputEnabled=!0}},{key:"onCompleteHideTweenPhai",value:function(){this.ktShowKich=!1,this.btnKickPhai.visible=!1,this.btnKickPhai.inputEnabled=!1,this.btnProfilePhai.visible=!1,this.btnProfilePhai.inputEnabled=!1}},{key:"onCompleteShowTween",value:function(){this.btnKick.visible=!0,this.btnKick.inputEnabled=!0,this.btnProfile.visible=!0,this.btnProfile.inputEnabled=!0}},{key:"onCompleteHideTween",value:function(){this.ktShowKich=!1,this.btnKick.visible=!1,this.btnKick.inputEnabled=!1,this.btnProfile.visible=!1,this.btnProfile.inputEnabled=!1}},{key:"removeTween",value:function(){null!==this.tween&&(this.tween.stop(),game.tweens.remove(this.tween),this.tween=null)}},{key:"chooseWaitting",value:function(){this.event.choose_invite.dispatch()}},{key:"chooseKick",value:function(){LogConsole.log("chooseKick"),mZ.instance().dataMySeft.user_id===this.idMaster&&(this.idx%2==0?this.onCompleteHideTween():this.onCompleteHideTweenPhai(),this.btnKick.inputEnabled=!1,this.btnKickPhai.inputEnabled=!1,mZ.instance().sendData(R_.ONLINE_MODE_ROOM_KICK_USER_REQUEST,lT.begin(this.data.user_id)))}},{key:"chooseProfile",value:function(){mZ.instance().dataMySeft.user_id===this.idMaster&&(this.idx%2==0?this.onCompleteHideTween():this.onCompleteHideTweenPhai(),iC.instance().addUserProfile(this.data.user_id))}},{key:"destroy",value:function(){this.removeEvent(),dT(fT(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&cT(n.prototype,i),o&&cT(n,o),t}();var yT=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.file_path="",this.question_type="",this.arrAnser=[],this.correct_answer=0,this.playerChoose={idx:0,correct_answer:!1,time:0},this.song=new ec,this.user_choose="",this.playlist_id=0};function mT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var vT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Dl.instance().event.loadComplete.add(this.loadSourceComplete,this)}var t,n,i;return t=e,(n=[{key:"loadSourceComplete",value:function(){mZ.instance().sendLoading(100)}},{key:"beginLoad",value:function(e){this.dataSource=e;for(var t=[],n=0;n<e.length;n++)"audio"==e[n].type&&t.push(e[n].url);Dl.instance().loadSoundArray(t)}},{key:"loadStart",value:function(){LogConsole.log("loadStart----------")}},{key:"onFileComplete",value:function(e,t,n,i,o){LogConsole.log("progress "+e),LogConsole.log("key "+t),LogConsole.log("error "+n),LogConsole.log("loadedFileCount "+i),LogConsole.log("totalFileCount "+o),mZ.instance().sendLoading(e)}},{key:"loadComplete",value:function(){LogConsole.log("loadComplete---------- : ")}},{key:"update",value:function(){}}])&&mT(t.prototype,n),i&&mT(t,i),e}();function wT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var bT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=[],n=[],i=e.getSFSArray(nc.questions),o=0;o<i.size();o++){var a=i.getSFSObject(o),s=new yT;if(s.file_path=a.getUtfString(nc.file_path),s.question_type=a.getUtfString(nc.question_type),s.correct_answer=a.getInt(nc.correct_answer),s.arrAnser.push(a.getUtfString(nc.answer1)),s.arrAnser.push(a.getUtfString(nc.answer2)),s.arrAnser.push(a.getUtfString(nc.answer3)),s.arrAnser.push(a.getUtfString(nc.answer4)),a.containsKey(nc.user)&&!a.isNull(nc.user)){var r=a.getSFSObject(nc.user);s.user_choose=r?r.getUtfString(nc.user_name):""}else s.user_choose="";var l=a.getSFSObject(nc.song);if(s.song=oc.getSongDetail(l),s.song.listenLink=s.file_path,a.containsKey("playlist"))if(a.isNull("playlist"));else{var h=a.getSFSObject("playlist");h.containsKey("playlist_name")&&(s.song.playlist_name=h.getUtfString("playlist_name")),h.containsKey("playlist_id")&&(s.playlist_id=h.getInt("playlist_id"))}t.push(s);var c={type:"audio"};c.url=s.file_path,n.push(c)}return(new vT).beginLoad(n),t}}],(n=null)&&wT(t.prototype,n),i&&wT(t,i),e}();function ST(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(t){for(var n=[],i=mZ.instance().socket.buddyManager.getBuddyList(),o=0;o<i.length;o++){var a=i[o];if(""===t||-1!==e.xoa_dau(a.getVariable("$"+wa.userName).value).toUpperCase().indexOf(e.xoa_dau(t).toUpperCase())){var s=new ma;LogConsole.log(a),s.avatar=a.getVariable("$"+wa.avatar).value,s.diamond=a.getVariable("$"+wa.diamond).value,s.isOnline=a[wa.isOnline],s.userId=a.getVariable("$"+wa.userId).value,s.userName=a.getVariable("$"+wa.userName).value,n.push(s)}}return n=n.sort(e.compareOnline)}},{key:"xoa_dau",value:function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a")).replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e")).replace(/ì|í|ị|ỉ|ĩ/g,"i")).replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o")).replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u")).replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y")).replace(/đ/g,"d")).replace(/À|Á|Ạ|Ả|Ã|Â|Ầ|Ấ|Ậ|Ẩ|Ẫ|Ă|Ằ|Ắ|Ặ|Ẳ|Ẵ/g,"A")).replace(/È|É|Ẹ|Ẻ|Ẽ|Ê|Ề|Ế|Ệ|Ể|Ễ/g,"E")).replace(/Ì|Í|Ị|Ỉ|Ĩ/g,"I")).replace(/Ò|Ó|Ọ|Ỏ|Õ|Ô|Ồ|Ố|Ộ|Ổ|Ỗ|Ơ|Ờ|Ớ|Ợ|Ở|Ỡ/g,"O")).replace(/Ù|Ú|Ụ|Ủ|Ũ|Ư|Ừ|Ứ|Ự|Ử|Ữ/g,"U")).replace(/Ỳ|Ý|Ỵ|Ỷ|Ỹ/g,"Y")).replace(/Đ/g,"D")}},{key:"compareOnline",value:function(e){return 1==e.isOnline?-1:1}}],(n=null)&&ST(t.prototype,n),i&&ST(t,i),e}();function ET(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var CT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putUtfString("envitee_id",e+""),t}}],(n=null)&&ET(t.prototype,n),i&&ET(t,i),e}();function kT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var PT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){for(var n=[],i=e.getSFSArray(wa.friends),o=0;o<i.size();o++){var a=i.getSFSObject(o);if(""===t||-1!==_T.xoa_dau(a.getUtfString(wa.user_name)).toUpperCase().indexOf(_T.xoa_dau(t).toUpperCase())){var s=new ma;s.userId=a.getInt(wa.id),s.userName=a.getUtfString(wa.user_name),s.isOnline=a.getBool(wa.is_online),s.avatar=a.getUtfString(wa.avatar),n.push(s)}}return n=n.sort(_T.compareOnline)}}],(n=null)&&kT(t.prototype,n),i&&kT(t,i),e}();function OT(e){return(OT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xT(e,t){return!t||"object"!==OT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TT(e){return(TT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IT(e,t){return(IT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var AT=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=xT(this,TT(t).call(this,game,null))).positionOnlineMode=i.mainData.positionCreateRoom,i.bg=new rt(i.positionOnlineMode.friend_detail_room_bg),i.addChild(i.bg),i.idPhong=new St(i.positionOnlineMode.friend_detail_room_id,"Phòng Chơi: "+e),i.idPhong.addColor("#ffa33a",11),i.addChild(i.idPhong),i.iconCount=new rt(i.positionOnlineMode.friend_detail_room_icon_count),i.addChild(i.iconCount),i.countPlayer=new St(i.positionOnlineMode.friend_detail_room_count_player,"3/4"),i.updateCountPlayer(n),i.addChild(i.countPlayer),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IT(e,t)}(t,Mt),n=t,(i=[{key:"updateCountPlayer",value:function(e){this.countPlayer.text=e+"/4"}}])&&RT(n.prototype,i),o&&RT(n,o),t}();function LT(e){return(LT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function DT(e,t,n){return(DT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MT(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MT(e){return(MT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NT(e,t){return(NT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var jT=function(e){function t(e,n){var i,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,i=!(a=MT(t).call(this,game,null))||"object"!==LT(a)&&"function"!=typeof a?BT(o):a,qe.instance().showLoading(),i.event={back:new Phaser.Signal,random:new Phaser.Signal},i.data=null,i.currentSearch="",i.positionCreateRoom=i.mainData.positionCreateRoom,i.bg=new Phaser.Button(game,0,0,"bg_create_room"),i.addChild(i.bg);var s=new Phaser.Group(game,0,0,null);return i.listFriends=new Jo(game,s,new Phaser.Rectangle(0,0,game.width,game.height-380*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),s.x=0,s.y=226*z.instance().scale,i.addChild(s),i.header=new ix,i.header.setTitle("DANH SÁCH BẠN"),i.header.setHideBtnBack(),i.header.setSearchButton(),i.header.event.back.add(i.chooseBack,BT(BT(i))),i.header.event.search.add(i.chooseSearch,BT(BT(i))),i.addChild(i.header),i.detailRoom=new AT(e,n),i.detailRoom.y=100,i.addChild(i.detailRoom),i.txtSearch=new St(i.positionCreateRoom.listfriend_txt_current_search,"Tất cả bạn"),i.txtSearch.setTextBounds(0,0,game.width-120*z.instance().scale,100*z.instance().scale),i.addChild(i.txtSearch),i.btnCloseTextSearch=new pt(i.positionCreateRoom.listfriend_btn_close_search,i.chooseCloseTextSearch,BT(BT(i))),i.addChild(i.btnCloseTextSearch),i.btnCloseTextSearch.visible=!1,i.btnRandom=new ln(i.positionCreateRoom.listfriend_btn_random,"NGẪU NHIÊN",i.chooseRandom,BT(BT(i))),i.addChild(i.btnRandom),i.btnRandom.y=game.height,game.add.tween(i.btnRandom).to({y:game.height-115*z.instance().scale},150,Phaser.Easing.Power1,!0,300),i.btnXong=new ln(i.positionCreateRoom.listfriend_btnXong,"XONG",i.chooseXong,BT(BT(i))),i.addChild(i.btnXong),i.btnXong.y=game.height,game.add.tween(i.btnXong).to({y:game.height-115*z.instance().scale},150,Phaser.Easing.Power1,!0,300),i.addEvent(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NT(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){}},{key:"updateCountPlayer",value:function(e){this.detailRoom.updateCountPlayer(e)}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().sendData(R_.USER_FRIEND_LIST_LOAD_REQUEST,null)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case R_.ONLINE_MODE_ROOM_ONLINE_USERS_LIST_RESPONSE:break;case R_.USER_FRIEND_LIST_LOAD_RESPONSE:this.data=e.params,this.buildListFriends()}}},{key:"chooseCloseTextSearch",value:function(){this.txtSearch.text="Tất cả bạn",this.currentSearch="",this.btnCloseTextSearch.visible=!1,this.buildListFriends()}},{key:"buildListFriends",value:function(){this.listFriends.removeAll(),this.listFriends.reset();for(var e=PT.begin(this.data,this.currentSearch),t=0;t<e.length;t++){var n=new Vy;n.setData(e[t],t),n.event.invite.add(this.chooseInvite,this),this.listFriends.add(n)}qe.instance().hideLoading()}},{key:"chooseInvite",value:function(e){mZ.instance().sendData(R_.ONLINE_MODE_ROOM_INVITE_REQUEST,CT.begin(e.userId))}},{key:"chooseSearch",value:function(){LogConsole.log("chooseSearch");rl.instance().show({maxLength:"",showTransparent:!0,placeholder:"Nhập tên người mời",isSearch:!0}),rl.instance().event.change.add(this.changeKeyBoard,this),rl.instance().event.hideKeyboard.add(this.hideKeyboard,this),rl.instance().event.enter.add(this.onSubmit,this),rl.instance().event.submit.add(this.onSubmit,this),rl.instance().event.cancle.add(this.onCancel,this)}},{key:"changeKeyBoard",value:function(){var e=rl.instance().getValue();e===this.currentSearch||(this.currentSearch=e,""===this.currentSearch?this.chooseCloseTextSearch():(this.btnCloseTextSearch.visible=!0,this.txtSearch.text=this.currentSearch,this.buildListFriends()))}},{key:"onSubmit",value:function(){this.changeKeyBoard(),this.onCancel()}},{key:"hideKeyboard",value:function(){rl.instance().hide()}},{key:"onCancel",value:function(){rl.instance().event.change.remove(this.changeKeyBoard,this),rl.instance().event.hideKeyboard.remove(this.hideKeyboard,this),rl.instance().event.enter.remove(this.onSubmit,this),rl.instance().event.submit.remove(this.onSubmit,this),rl.instance().event.cancle.remove(this.onCancel,this),rl.instance().hide()}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"chooseXong",value:function(){this.chooseBack()}},{key:"chooseRandom",value:function(){LogConsole.log("chooseRandom"),this.event.random.dispatch()}},{key:"destroy",value:function(){this.onCancel(),this.listFriends.removeAll(),this.listFriends.destroy(),this.removeEvent(),this.removeAllItem(),DT(MT(t.prototype),"destroy",this).call(this)}}])&&GT(n.prototype,i),o&&GT(n,o),t}();function UT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var FT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){LogConsole.log(e.getDump());var t=[],n=e.getSFSArray(wa.users);if(LogConsole.log(n),null!==n)for(var i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new ma;a.avatar=o.getUtfString(wa.avatar),a.isOnline=!0,a.userId=o.getInt(wa.id),a.userName=o.getUtfString(wa.user_name),t.push(a)}return LogConsole.log(t),t}}],(n=null)&&UT(t.prototype,n),i&&UT(t,i),e}();function ZT(e){return(ZT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QT(e,t,n){return(QT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VT(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function VT(e){return(VT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WT(e,t){return(WT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var KT=function(e){function t(e,n){var i,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,i=!(a=VT(t).call(this,game,null))||"object"!==ZT(a)&&"function"!=typeof a?qT(o):a,qe.instance().showLoading(),i.event={back:new Phaser.Signal,changeToBanBe:new Phaser.Signal},i.currentSearch="",i.positionCreateRoom=i.mainData.positionCreateRoom,i.bg=new Phaser.Button(game,0,0,"bg_create_room"),i.addChild(i.bg);var s=new Phaser.Group(game,0,0,null);return i.listFriends=new Jo(game,s,new Phaser.Rectangle(0,0,game.width,game.height-300*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),s.x=0,s.y=176*z.instance().scale,i.addChild(s),i.header=new ix,i.header.setHideBtnBack(),i.header.setTitle("DANH SÁCH RANDOM"),i.header.event.back.add(i.chooseBack,qT(qT(i))),i.addChild(i.header),i.detailRoom=new AT(e,n),i.detailRoom.y=100,i.addChild(i.detailRoom),i.btnRandom=new ln(i.positionCreateRoom.listfriend_btn_random,"BẠN BÈ",i.chooseBanBe,qT(qT(i))),i.addChild(i.btnRandom),i.btnRandom.y=game.height,game.add.tween(i.btnRandom).to({y:game.height-115*z.instance().scale},150,Phaser.Easing.Power1,!0,300),i.btnXong=new ln(i.positionCreateRoom.listfriend_btnXong,"XONG",i.chooseXong,qT(qT(i))),i.addChild(i.btnXong),i.btnXong.y=game.height,game.add.tween(i.btnXong).to({y:game.height-115*z.instance().scale},150,Phaser.Easing.Power1,!0,300),i.addEvent(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WT(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){}},{key:"updateCountPlayer",value:function(e){this.detailRoom.updateCountPlayer(e)}},{key:"chooseBanBe",value:function(){this.event.changeToBanBe.dispatch()}},{key:"chooseXong",value:function(){this.chooseBack()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().sendData(R_.ONLINE_MODE_ROOM_ONLINE_USERS_LIST_REQUEST,null),li.instance().showBanerInviteOtherUserWaitingScreen()}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case R_.ONLINE_MODE_ROOM_ONLINE_USERS_LIST_RESPONSE:this.arrPlayer=FT.begin(e.params),this.buildListPlayerRandom(),qe.instance().hideLoading()}}},{key:"buildListPlayerRandom",value:function(){this.listFriends.removeAll(),this.listFriends.reset();for(var e=0;e<this.arrPlayer.length;e++){var t=new Vy;t.setData(this.arrPlayer[e],e),t.event.invite.add(this.chooseInvite,this),this.listFriends.add(t)}}},{key:"chooseInvite",value:function(e){mZ.instance().sendData(R_.ONLINE_MODE_ROOM_INVITE_REQUEST,CT.begin(e.userId))}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listFriends.removeAll(),this.listFriends.destroy(),li.instance().hideBanner(),QT(VT(t.prototype),"destroy",this).call(this)}}])&&HT(n.prototype,i),o&&HT(n,o),t}();function zT(e){return(zT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function JT(e,t){return!t||"object"!==zT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XT(e,t,n){return(XT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$T(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $T(e){return($T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eI(e,t){return(eI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tI=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=JT(this,$T(t).call(this,game,null))).idRoom=e,i.count=n,i.event={back:new Phaser.Signal},i.layoutContent=new Phaser.Sprite(game,0,0,""),i.addChild(i.layoutContent),i.listFriends=null,i.listRandom=null,i.chatPlayer=null,i.addEvent(),i.addListFriends(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eI(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onUserEnterRoom.add(this.userEnterRoom,this),mZ.instance().events.onUserExitRoom.add(this.userExitRoom,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onUserEnterRoom.remove(this.userEnterRoom,this),mZ.instance().events.onUserExitRoom.remove(this.userExitRoom,this)}},{key:"userEnterRoom",value:function(){this.count++,this.updateCountPlayer()}},{key:"userExitRoom",value:function(){this.count--,this.updateCountPlayer()}},{key:"updateCountPlayer",value:function(){null!==this.listFriends&&this.listFriends.updateCountPlayer(this.count),null!==this.listRandom&&this.listRandom.updateCountPlayer(this.count)}},{key:"addListFriends",value:function(){this.removeListFriends(),this.listFriends=new jT(this.idRoom,this.count),this.listFriends.event.back.add(this.chooseBack,this),this.listFriends.event.random.add(this.addListRandom,this),this.layoutContent.addChild(this.listFriends),null!==this.listRandom?(zc.instance().beginSwitch(this.listRandom,this.listFriends,!1),zc.instance().event.tweenComplete.add(this.tweenListRandomComplete,this)):zc.instance().beginSwitch(null,this.listFriends,!1)}},{key:"tweenListRandomComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenListRandomComplete,this),this.removeListRandom()}},{key:"removeListFriends",value:function(){null!==this.listFriends&&(this.layoutContent.removeChild(this.listFriends),this.listFriends.destroy(),this.listFriends=null)}},{key:"addListRandom",value:function(){this.removeListRandom(),this.listRandom=new KT(this.idRoom,this.count),this.listRandom.event.back.add(this.chooseBack,this),this.listRandom.event.changeToBanBe.add(this.addListFriends,this),this.layoutContent.addChild(this.listRandom),null!==this.listFriends&&(zc.instance().beginSwitch(this.listFriends,this.listRandom,!1),zc.instance().event.tweenComplete.add(this.tweenListFriendsComplete,this))}},{key:"tweenListFriendsComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenListFriendsComplete,this),this.removeListFriends()}},{key:"removeListRandom",value:function(){null!==this.listRandom&&(this.layoutContent.removeChild(this.listRandom),this.listRandom.destroy(),this.listRandom=null)}},{key:"addChatRoom",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.removeChatRoom(),this.chatPlayer=new jx(e,t),""!==n&&this.chatPlayer.setIcon(n),this.chatPlayer.y=-102,this.chatPlayer.event.close.add(this.removeChatRoom,this),this.addChild(this.chatPlayer),game.add.tween(this.chatPlayer).to({y:1},300,Phaser.Easing.Power1,!0)}},{key:"removeChatRoom",value:function(){null!==this.chatPlayer&&(this.removeChild(this.chatPlayer),this.chatPlayer.destroy(),this.chatPlayer=null)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){qe.instance().hideLoading(),this.removeEvent(),XT($T(t.prototype),"destroy",this).call(this)}}])&&YT(n.prototype,i),o&&YT(n,o),t}();function nI(e){return(nI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oI(e,t){return!t||"object"!==nI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aI(e){return(aI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sI(e,t){return(sI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rI=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=oI(this,aI(t).call(this,game,null))).chart=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sI(e,t)}(t,Mt),n=t,(i=[{key:"addChart",value:function(e){this.removeChart();var t={x:0,y:0,nameAtlas:"createroom",nameSprite:e?"Light_You":"Light_Other"};this.chart=new rt(t),this.addChild(this.chart)}},{key:"removeChart",value:function(){null!==this.chart&&(this.removeChild(this.chart),this.chart.destroy(),this.chart=null)}},{key:"height",set:function(e){this.chart.height=e}}])&&iI(n.prototype,i),o&&iI(n,o),t}();function lI(e){return(lI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cI(e,t){return!t||"object"!==lI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uI(e,t,n){return(uI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dI(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dI(e){return(dI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fI(e,t){return(fI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pI=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cI(this,dI(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fI(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.timeCount=1e4,this.eventLoadingComplete=new Phaser.Signal,this.positionOnlineMode=this.mainData.positionCreateRoom,this.loaderPerc=0,this.beginLoad=!1,this.maxLoading=100,this.constLoading=.5,this.bg=new rt(this.positionOnlineMode.bg_loading_answer_me),this.addChild(this.bg),this.bgLoading=new rt(this.positionOnlineMode.bg_sansang_answer_me),this.addChild(this.bgLoading),this.maskLoading=new Phaser.Graphics(game,this.bgLoading.width/2,this.bgLoading.height/2),this.maskLoading.anchor.setTo(.5,.5),this.addChild(this.maskLoading),this.bgLoading.mask=this.maskLoading,this.drawMask(),this.timerToCountTime=this.game.time.create(!0),this.timerToCountTime.loop(50,this.onTimerToCountTime,this)}},{key:"addEventLoadingComplete",value:function(e,t){this.eventLoadingComplete.add(e,t)}},{key:"removeEventLoadingComplete",value:function(e,t){this.eventLoadingComplete.remove(e,t)}},{key:"dispatchEventLoadingComplete",value:function(){this.timerToCountTime.destroy(),this.eventLoadingComplete.dispatch()}},{key:"onTimerToCountTime",value:function(){this.drawMask()}},{key:"drawMask",value:function(){this.beginLoad&&this.loaderPerc<100&&(this.loaderPerc+=this.constLoading,this.loaderPerc>this.maxLoading&&(this.loaderPerc=this.maxLoading,this.loaderPerc),this.maskLoading.clear(),this.maskLoading.beginFill(16777215),this.maskLoading.rotation+=.1,100===this.loaderPerc?this.maskLoading.arc(0,0,this.bgLoading.width/2+4*this.mainData.scale,this.game.math.degToRad(0),this.game.math.degToRad(360),!0):this.maskLoading.arc(0,0,this.bgLoading.width/2+4*this.mainData.scale,this.game.math.degToRad(270),this.game.math.degToRad(270-3.6*this.loaderPerc),!0),this.maskLoading.endFill())}},{key:"setMaxLoading",value:function(e){this.maxLoading=e}},{key:"setBeginLoad",value:function(){this.timerToCountTime.start(),this.beginLoad=!0}},{key:"destroy",value:function(){this.maskLoading.clear(),this.timerToCountTime.stop(),this.timerToCountTime.destroy(),uI(dI(t.prototype),"destroy",this).call(this)}}])&&hI(n.prototype,i),o&&hI(n,o),t}();function gI(e){return(gI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mI(e,t){return!t||"object"!==gI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vI(e){return(vI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wI(e,t){return(wI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bI=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),mI(this,vI(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wI(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.positionOnlineMode=this.mainData.positionCreateRoom,this.bg=new rt(this.positionOnlineMode.bg_me_answer1),this.bg.anchor.setTo(.5,.5),this.bg.x=this.bg.width/2,this.bg.y=this.bg.height/2,this.addChild(this.bg),this.bgWin=new rt(this.positionOnlineMode.bg_win_me_answer1),this.bgWin.anchor.setTo(.5,.5),this.bgWin.x=this.bgWin.width/2,this.bgWin.y=this.bgWin.height/2,this.addChild(this.bgWin),this.loading=new pI,this.loading.visible=!1,this.addChild(this.loading),this.fail=new rt(this.positionOnlineMode.bg_me_fail),this.fail.x=(this.bgWin.width-this.fail.width)/2,this.fail.y=(this.bgWin.height-this.fail.height)/2,this.addChild(this.fail),this.txtTime=new St(this.positionOnlineMode.bg_me_txt_time,""),this.addChild(this.txtTime),this.setDefault()}},{key:"setBeginLoad",value:function(){this.loading.visible=!0,this.loading.setBeginLoad()}},{key:"setDefault",value:function(){this.bg.visible=!0,this.bgWin.visible=!1,this.fail.visible=!1,this.txtTime.text=""}},{key:"setData",value:function(e){this.bg.visible=!1,this.bgWin.visible=!0,this.loading.visible=!1,e.correct_answer?(this.txtTime.text=this.financial(e.time),this.txtTime.x=(this.bgWin.width-this.txtTime.width)/2,this.txtTime.y=(this.bgWin.height-this.txtTime.height)/2+3*this.mainData.scale):this.fail.visible=!0}},{key:"alpha",set:function(e){if(this.children)for(var t=0;t<this.children.length;t++)this.children[t].alpha=e}}])&&yI(n.prototype,i),o&&yI(n,o),t}();function SI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _I=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"ONLINE_MODE_GENRES_REQUEST",get:function(){return"ONLINE_MODE_GENRES_REQUEST"}},{key:"ONLINE_MODE_GENRES_RESPONSE",get:function(){return"ONLINE_MODE_GENRES_RESPONSE"}},{key:"ONLINE_MODE_BETS_REQUEST",get:function(){return"ONLINE_MODE_BETS_REQUEST"}},{key:"ONLINE_MODE_BETS_RESPONSE",get:function(){return"ONLINE_MODE_BETS_RESPONSE"}},{key:"ONLINE_MODE_PLAYLISTS_REQUEST",get:function(){return"ONLINE_MODE_PLAYLISTS_REQUEST"}},{key:"ONLINE_MODE_PLAYLISTS_RESPONSE",get:function(){return"ONLINE_MODE_PLAYLISTS_LIST_RESPONSE"}},{key:"ONLINE_MODE_FIND_GAME_REQUEST",get:function(){return"ONLINE_MODE_FIND_GAME_REQUEST"}},{key:"ONLINE_MODE_FIND_GAME_RESPONSE",get:function(){return"ONLINE_MODE_FIND_GAME_RESPONSE"}},{key:"JOIN_ROOM",get:function(){return"JOIN_ROOM"}},{key:"USER_EXIT_ROOM",get:function(){return"USER_EXIT_ROOM"}},{key:"USER_ENTER_ROOM",get:function(){return"USER_ENTER_ROOM"}},{key:"ONLINE_MODE_USER_COUNT_BROADCAST",get:function(){return"ONLINE_MODE_USER_COUNT_BROADCAST"}},{key:"ONLINE_MODE_SERVER_QUESTIONS_SEND",get:function(){return"ONLINE_MODE_SERVER_QUESTIONS_SEND"}},{key:"ONLINE_MODE_GAME_START",get:function(){return"ONLINE_MODE_GAME_START"}},{key:"ONLINE_MODE_USER_SELECTED_ANSWER_REQUEST",get:function(){return"ONLINE_MODE_USER_SELECTED_ANSWER_REQUEST"}},{key:"ONLINE_MODE_USER_SELECTED_ANSWER_RESPONSE",get:function(){return"ONLINE_MODE_USER_SELECTED_ANSWER_RESPONSE"}},{key:"ONLINE_MODE_MOVE_TO_NEXT_QUESTION",get:function(){return"ONLINE_MODE_MOVE_TO_NEXT_QUESTION"}},{key:"ONLINE_MODE_GAME_RESULT",get:function(){return"ONLINE_MODE_GAME_RESULT"}},{key:"ONLINE_MODE_ROOM_GAME_RESULT",get:function(){return"ONLINE_MODE_ROOM_GAME_RESULT"}},{key:"ONLINE_MODE_GAME_FINISH",get:function(){return"ONLINE_MODE_GAME_FINISH"}},{key:"ONLINE_GAME_START_WAITING_PLAYER_COUNTDOWN",get:function(){return"ONLINE_GAME_START_WAITING_PLAYER_COUNTDOWN"}},{key:"ONLINE_GAME_STOP_WAITING_PLAYER_COUNTDOWN",get:function(){return"ONLINE_GAME_STOP_WAITING_PLAYER_COUNTDOWN"}},{key:"ONLINE_MODE_COUNT_USER_ONLINE_REQUEST",get:function(){return"ONLINE_MODE_COUNT_USER_ONLINE_REQUEST"}},{key:"ONLINE_MODE_COUNT_USER_ONLINE_RESPONSE",get:function(){return"ONLINE_MODE_COUNT_USER_ONLINE_RESPONSE"}}],(n=null)&&SI(t.prototype,n),i&&SI(t,i),e}();function EI(e){return(EI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kI(e,t){return!t||"object"!==EI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function PI(e,t,n){return(PI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=OI(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function OI(e){return(OI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RI(e,t){return(RI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xI=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=kI(this,OI(t).call(this,game,0,0,null,e,n))).idx=-1,i.afterCreate(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RI(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterCreate",value:function(){this.ktSetAva=!0,this.positionOnlineMode=z.instance().positionDefaultSource,this.noChoose=!1,this.bg=new Zt(this.positionOnlineMode.bg_answer_question),this.addChild(this.bg),this.bgNoChoose=new Zt(this.positionOnlineMode.bg_answer_question_nochoose),this.bgNoChoose.visible=!1,this.addChild(this.bgNoChoose),this.txtAnswer=new St(this.positionOnlineMode.text_answer_question),this.addChild(this.txtAnswer),this.ava=new Pc,this.ava.setSize(36*z.instance().scale,36*z.instance().scale),this.ava.x=9*z.instance().scale,this.ava.y=(this.bg.height-this.ava.height)/2,this.addChild(this.ava),this.setAva(mZ.instance().dataMySeft.avatar)}},{key:"setNoChoose",value:function(){this.noChoose=!0}},{key:"setAva",value:function(e){this.ktSetAva&&(this.ktSetAva=!1,this.ava.setAvatar(e,1))}},{key:"setTextNoChoose",value:function(){LogConsole.log("setTextNoChoose : "+this.idx),this.bgNoChoose.visible=!0,this.bg.visible=!1,this.txtAnswer.changeStyle({fill:"#807d8d"})}},{key:"setDefaultText",value:function(){LogConsole.log("setDefaultText"+this.idx),this.bgNoChoose.visible=!1,this.bg.visible=!0,this.ava.visible=!1,this.txtAnswer.changeStyle({fill:"black"})}},{key:"setTrueText",value:function(){LogConsole.log("setTrueText"+this.idx),this.bgNoChoose.visible=!1,this.bg.visible=!0,this.txtAnswer.changeStyle({fill:"#30FF77"})}},{key:"setFailText",value:function(){LogConsole.log("setFailText"+this.idx),this.bgNoChoose.visible=!1,this.bg.visible=!0,this.txtAnswer.changeStyle({fill:"#ff0000"})}},{key:"setChooseAnswer",value:function(){this.ava.visible=!0}},{key:"setConstX",value:function(e){this.constX=e}},{key:"setData",value:function(e,t){this.noChoose=!1,this.idx=t,this.txtAnswer.setText(e),this.txtAnswer.x=(this.bg.width-this.txtAnswer.width)/2,this.txtAnswer.y=(this.bg.height-this.txtAnswer.height)/2,this.setDefaultText(),this.x=game.width,game.add.tween(this).to({x:this.constX},300,Phaser.Easing.Power1,!0,500+200*t)}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),PI(OI(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"getIdx",value:function(){return this.idx}},{key:"hideAnswer",value:function(e){this.x=this.constX,game.add.tween(this).to({x:-this.width-100},300,Phaser.Easing.Power1,!0,100*e)}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&CI(n.prototype,i),o&&CI(n,o),t}();function TI(e){return(TI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function II(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AI(e,t){return!t||"object"!==TI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function LI(e){return(LI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function GI(e,t){return(GI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var DI=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),AI(this,LI(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GI(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.eventCompleteTime=new Phaser.Signal,this.timerToCountTime=null,this.bg=new Phaser.Image(game,0,0,null),this.bg.x=0,this.bg.y=0,this.addChild(this.bg),this.style={font:"40px Arial",fill:"white"},this.txtClock=new Phaser.Text(game,0,0,"",this.style),this.txtClock.x=0,this.txtClock.y=0,this.addChild(this.txtClock)}},{key:"addEventCompleteTime",value:function(e,t){this.eventCompleteTime.add(e,t)}},{key:"addEventCompleteTime",value:function(e,t){this.eventCompleteTime.remove(e,t)}},{key:"dispatchEventCompleteTime",value:function(){this.eventCompleteTime.dispatch()}},{key:"setTextTimer",value:function(){var e="00",t=parseInt(this.countNumber/10);e=t<10?"0"+t:t,this.txtClock.text=e}},{key:"countTimer",value:function(e){this.countNumber=10*e,this.setTextTimer(),this.stopCountTime(),this.timerToCountTime=this.game.time.create(!0),this.timerToCountTime.loop(100,this.onTimerToCountTime,this),this.timerToCountTime.start()}},{key:"onTimerToCountTime",value:function(){this.countNumber--,this.countNumber<0&&(this.countNumber=0),0===this.countNumber&&(this.dispatchEventCompleteTime(),this.stopCountTime()),this.setTextTimer()}},{key:"getTime",value:function(){return this.countNumber/10}},{key:"stopCountTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy(),this.timerToCountTime=null)}},{key:"destroy",value:function(){this.txtClock.destroy(),this.timerToCountTime&&this.timerToCountTime.destroy()}}])&&II(n.prototype,i),o&&II(n,o),t}();function MI(e){return(MI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BI(e,t){return!t||"object"!==MI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jI(e,t,n){return(jI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=UI(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function UI(e){return(UI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FI(e,t){return(FI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ZI=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=BI(this,UI(t).call(this,e,n,i))).positionCreateRoom=z.instance().positionCreateRoom,o.countTicket=new ln(o.positionCreateRoom.question_button_bodapan_count_mic,mZ.instance().dataMySeft.support_item),o.addChild(o.countTicket),o.iconMic=new rt(o.positionCreateRoom.question_button_bodapan_mic),o.addChild(o.iconMic),o.labelMoney=new St(o.positionCreateRoom.question_button_bodapan_txt_money,"-1"),o.labelMoney.setTextBounds(0,0,100*z.instance().scale,40*z.instance().scale),o.addChild(o.labelMoney),o.lbBo2dapan=new St(o.positionCreateRoom.question_button_bodapan_txt_bo2dapan,"BỎ 2 ĐÁP ÁN"),o.lbBo2dapan.setTextBounds(0,0,205*z.instance().scale,46*z.instance().scale),o.addChild(o.lbBo2dapan),o.addEvent(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FI(e,t)}(t,pt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this)}},{key:"userVarsUpdate",value:function(){this.countTicket.setText(mZ.instance().dataMySeft.support_item)}},{key:"destroy",value:function(){this.removeEvent(),jI(UI(t.prototype),"destroy",this).call(this)}}])&&NI(n.prototype,i),o&&NI(n,o),t}();function HI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var QI=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t,n,i){var o=new SFS2X.SFSObject;return o.putInt("answer_index",t),o.putInt("correct_answer",n),o.putFloat("answer_time",i),o.putInt("question_index",e),o}}],(n=null)&&HI(t.prototype,n),i&&HI(t,i),e}();function VI(e){return(VI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qI(e,t){return!t||"object"!==VI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KI(e){return(KI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zI(e,t){return(zI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var YI=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qI(this,KI(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zI(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.positionCreateRoom=this.mainData.positionCreateRoom,this.txtQuestion=new St(this.positionCreateRoom.text_question_playroom,""),this.txtQuestion.x=0,this.txtQuestion.y=3*z.instance().scale,this.txtQuestion.setTextBounds(0,0,game.width,33*z.instance().scale),this.addChild(this.txtQuestion),this.playerChoose=new St(this.positionCreateRoom.text_question_playroom,""),this.playerChoose.x=0,this.playerChoose.y=30*z.instance().scale,this.playerChoose.setTextBounds(0,0,game.width,33*z.instance().scale),this.addChild(this.playerChoose)}},{key:"setText",value:function(e){var t="";"SONG"==e&&(t="Tìm tên bài hát"),"SINGER"==e&&(t="Tìm tên ca sĩ"),LogConsole.log("strQuestion :"+t),this.txtQuestion.setText(t)}},{key:"setPlayerChoose",value:function(e){""===e?(this.playerChoose.clearColors(),this.playerChoose.text="Được chọn bởi hệ thống"):(this.playerChoose.addColor("#FFA238",9),this.playerChoose.text="Chọn bởi "+e)}},{key:"destroy",value:function(){this.txtQuestion.destroy()}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this.txtQuestion.height}},{key:"alpha",set:function(e){if(this.children)for(var t=0;t<this.children.length;t++)this.children[t].alpha=e}}])&&WI(n.prototype,i),o&&WI(n,o),t}();function JI(e){return(JI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $I(e,t){return!t||"object"!==JI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eA(e,t,n){return(eA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tA(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function tA(e){return(tA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nA(e,t){return(nA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iA=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=$I(this,tA(t).call(this,game,null))).event={close:new Phaser.Signal},i.idxNextQuestion=null,i.ktSendChoose=!1,i.eventChooseAnswer=new Phaser.Signal,i.eventShowQuestion=new Phaser.Signal,i.idx=n,i.arrQuestion=e,i.ktChooseHelp=!1,i.answerSelect=-1,i.buildQuestionByIndex(),i.tween=null,i.addEvent(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nA(e,t)}(t,Mt),n=t,(i=[{key:"addEventChooseAnswer",value:function(e,t){this.eventChooseAnswer.add(e,t)}},{key:"removeEventChooseAnswer",value:function(e,t){this.eventChooseAnswer.remove(e,t)}},{key:"dispatchEventChooseAnswer",value:function(e){this.eventChooseAnswer.dispatch(e)}},{key:"addEventShowQuestion",value:function(e,t){this.eventShowQuestion.add(e,t)}},{key:"removeEventShowQuestion",value:function(e,t){this.eventShowQuestion.add(e,t)}},{key:"dispatchEventShowQuestion",value:function(){this.eventShowQuestion.dispatch(this.idx)}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().events.onPublicMessage.add(this.onPublicMessage,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),mZ.instance().events.onPublicMessage.remove(this.onPublicMessage,this)}},{key:"onPublicMessage",value:function(e){var t=this;e.message===Et.CHAT_ONLINE_MODE&&(e.sender.isItMe&&(this.btnChat.inputEnabled=!1,setTimeout(function(){t.btnChat.parent&&(t.btnChat.inputEnabled=!0)},3e3)))}},{key:"getData",value:function(e){var t;switch(e.cmd){case _I.ONLINE_MODE_MOVE_TO_NEXT_QUESTION:case R_.ONLINE_MODE_ROOM_MOVE_TO_NEXT_QUESTION:!1===this.ktSend&&(this.ktSend=!0);for(var n=0;n<this.arrAnswer.length;n++)this.arrAnswer[n].setTextNoChoose();t=this.arrQuestion[this.idx].correct_answer,this.arrAnswer[t-1].setTrueText(),-1!==this.answerSelect&&this.answerSelect!==t&&this.arrAnswer[this.answerSelect-1].setFailText(),this.removeNextQuestion(),this.idxNextQuestion=game.time.events.add(2*Phaser.Timer.SECOND,this.buildNextQuestion,this,e.params.getInt(nc.question_index));break;case _I.ONLINE_MODE_GAME_RESULT:case _I.ONLINE_MODE_ROOM_GAME_RESULT:for(var i=0;i<this.arrAnswer.length;i++)this.arrAnswer[i].setTextNoChoose();t=this.arrQuestion[this.idx].correct_answer,this.arrAnswer[t-1].setTrueText(),-1!==this.answerSelect&&this.answerSelect!==t&&this.arrAnswer[this.answerSelect-1].setFailText(),this.buildEndGame();break;case R_.SUPPORT_RESPONSE:break;case _I.ONLINE_MODE_USER_SELECTED_ANSWER_RESPONSE:case R_.ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_RESPONSE:var o=e.params.getBool(wa.is_correct_answer),a=e.params.getInt(wa.user_id),s=e.params.getInt(wa.streak);!0===o&&a===mZ.instance().dataMySeft.user_id&&s>1&&this.showStreakAnswer(s,this.arrQuestion[this.idx].correct_answer)}}},{key:"buildEndGame",value:function(){if(!1===this.ktSendChoose){var e={idx:this.idx,correct_answer:!1,time:10};this.arrQuestion[this.idx].playerChoose=e,this.dispatchEventChooseAnswer(e)}else this.ktSendChoose=!1;Dl.instance().removeSound()}},{key:"removeNextQuestion",value:function(){null!==this.idxNextQuestion&&game.time.events.remove(this.idxNextQuestion)}},{key:"buildNextQuestion",value:function(e){if(LogConsole.log("buildNextQuestion : "+e),this.streakAnswer.setDefault(),this.idx<this.arrQuestion.length)if(!1===this.ktSendChoose){var t={idx:this.idx,correct_answer:!1,time:10};this.arrQuestion[this.idx].playerChoose=t,this.dispatchEventChooseAnswer(t)}else this.ktSendChoose=!1;this.idx=e-1,this.idx>this.arrQuestion.length-1?this.ktSend=!0:(this.buildQuestionByIndex(),this.dispatchEventShowQuestion())}},{key:"buildHelpAnswer",value:function(){var e=[],t=0;for(t=1;t<5;t++)t===this.arrQuestion[this.idx].correct_answer||e.push(t);for(LogConsole.log("correct_answer "+this.arrQuestion[this.idx].correct_answer),LogConsole.log(e),e.splice(game.rnd.integerInRange(0,2),1),LogConsole.log(e),t=0;t<e.length;t++)LogConsole.log("arrAnswerFail[i] : "+e[t]),this.arrAnswer[e[t]-1].setTextNoChoose(),this.arrAnswer[e[t]-1].setNoChoose()}},{key:"afterCreate",value:function(){this.positionCreateRoom=JSON.parse(game.cache.getText("positionCreateRoom")),this.streakAnswer=null,this.txtQuestion=new YI,this.txtQuestion.x=0,this.txtQuestion.y=0,this.addChild(this.txtQuestion);var e=new Phaser.Group(game,0,0,null);this.listAnswer=new Jo(game,e,new Phaser.Rectangle(0,0,game.width,500*z.instance().scale),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),e.x=0,e.y=75*z.instance().scale,this.addChild(e),this.arrAnswer=[],this.listAnswer.removeAll(),this.listAnswer.reset();for(var t=0;t<4;t++){var n=new xI(this.chooseAnswer,this),i=(game.width-n.width)/2;n.x=i,n.setConstX(i),this.listAnswer.add(n),this.arrAnswer.push(n)}this.clock=new DI,this.clock.addEventCompleteTime(this.timeComplete,this),this.clock.x=game.width-100,this.clock.y=-20,this.btnBo2DapAn=new ZI(this.positionCreateRoom.question_button_bodapan_bg,this.chooseBo2Dapan,this),this.addChild(this.btnBo2DapAn),this.btnChat=new pt(this.positionCreateRoom.question_button_chat,this.chooseChat,this),this.addChild(this.btnChat),this.buildStreakAnswer()}},{key:"chooseChat",value:function(){iC.instance().addChatOnlineMode()}},{key:"chooseBo2Dapan",value:function(){LogConsole.log("chooseBo2Dapan"),mZ.instance().dataMySeft.support_item>0?!1===this.ktChooseHelp&&!1===this.ktSend&&(this.ktChooseHelp=!0,mZ.instance().dataMySeft.support_item=mZ.instance().dataMySeft.support_item-1,mZ.instance().dataMySeft.support_item<0&&(mZ.instance().dataMySeft.support_item=0),this.buildHelpAnswer(),mZ.instance().sendData(R_.SUPPORT_REQUEST,null)):iC.instance().addDialog("Bạn không đủ Míc")}},{key:"timeComplete",value:function(){}},{key:"buildQuestionByIndex",value:function(){LogConsole.log("buildQuestionByIndex - "+this.idx),this.answerSelect=-1,this.clock.countTimer(10.5),this.ktSend=!1,this.ktChooseHelp=!1,Dl.instance().playsound(this.arrQuestion[this.idx].file_path),this.txtQuestion.setText(this.arrQuestion[this.idx].question_type),this.txtQuestion.setPlayerChoose(this.arrQuestion[this.idx].user_choose);for(var e=0;e<this.arrQuestion[this.idx].arrAnser.length;e++)this.arrAnswer[e].setData(this.arrQuestion[this.idx].arrAnser[e],e)}},{key:"hideQuestion",value:function(){for(var e=0;e<this.arrQuestion[this.idx].arrAnser.length;e++)this.arrAnswer[e].hideAnswer(e);this.txtQuestion.setText(""),this.tween=game.add.tween(this).to({y:this.y},500,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.handleComplete,this)}},{key:"handleComplete",value:function(){this.event.close.dispatch()}},{key:"chooseAnswer",value:function(e){if(LogConsole.log("chooseAnswer"),LogConsole.log(e),0==this.ktSend)if(e.noChoose);else{var t=this.clock.getTime();if(this.ktSend=!0,t>0){for(var n=0;n<this.arrAnswer.length;n++)this.arrAnswer[n].setTextNoChoose();e.setChooseAnswer();var i={idx:this.idx,correct_answer:!1,time:0};this.answerSelect=e.getIdx()+1;var o=10.5-t-.5;o>10&&(o=10),o<.1&&(o=.1);var a=this.arrQuestion[this.idx].correct_answer;LogConsole.log("this.answerSelect : "+this.answerSelect),LogConsole.log("correct_answer : "+a),i.time=o,this.answerSelect==a?(LogConsole.log("dung-----------"),e.setTrueText(),i.correct_answer=!0,Kr.instance().playlist.setExpPlaylistById(this.arrQuestion[this.idx].playlist_id)):(LogConsole.log("sai-----------"),e.setFailText()),this.arrQuestion[this.idx].playerChoose=i,this.dispatchEventChooseAnswer(i),this.ktSendChoose=!0;var s="";s=this.mainData.modeplay===this.mainData.MODEPLAY.OnlineMode?_I.ONLINE_MODE_USER_SELECTED_ANSWER_REQUEST:R_.ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_REQUEST,mZ.instance().sendData(s,QI.begin(this.idx+1,this.answerSelect,a,o))}else LogConsole.log("het thoi gian tra loi cau hoi")}}},{key:"buildStreakAnswer",value:function(){this.removeStreakAnswer(),this.streakAnswer=new Vd,this.streakAnswer.x=(this.game.width-this.streakAnswer.width)/2,this.addChild(this.streakAnswer),this.hideStreakAnswer()}},{key:"hideStreakAnswer",value:function(){this.streakAnswer.visible=!1}},{key:"showStreakAnswer",value:function(e,t){this.streakAnswer.visible=!0,this.streakAnswer.setStreak(e),console.log("showStreakAnswer : "+t),2===t?this.streakAnswer.y=280:3===t?this.streakAnswer.y=50:1===t?this.streakAnswer.y=235:4===t&&(this.streakAnswer.y=105)}},{key:"removeStreakAnswer",value:function(){console.log(this.streakAnswer),null!==this.streakAnswer&&(this.removeChild(this.streakAnswer),this.streakAnswer.destroy(),this.streakAnswer=null)}},{key:"getArrQuestion",value:function(){return this.arrQuestion}},{key:"destroy",value:function(){Dl.instance().removeAllSound(),iC.instance().removeChatOnlineMode(),this.removeEvent(),this.eventChooseAnswer.dispose(),this.txtQuestion.destroy(),this.listAnswer.removeAll(),this.listAnswer.destroy(),this.clock.destroy(),null!==this.tween&&(this.tween.stop(),game.tweens.remove(this.tween),this.tween=null),eA(tA(t.prototype),"destroy",this).call(this)}}])&&XI(n.prototype,i),o&&XI(n,o),t}();function oA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var aA=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){for(var n=e.getSFSArray(wa.players),i=0;i<n.size();i++)for(var o=n.getSFSObject(i),a=0;a<t.length;a++){var s=t[a].getData();if(null!=s&&s.user_id==o.getInt(wa.user_id)){s.score=o.getInt(wa.score),s.diamond_change=o.getInt(wa.diamond_change),s.exp_score=o.getInt(wa.exp_score),t[a].setCurrentData(s);break}}}}],(n=null)&&oA(t.prototype,n),i&&oA(t,i),e}();function sA(e){return(sA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lA(e){return(lA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hA(e,t){return(hA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var uA=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=lA(t).call(this,game,null))||"object"!==sA(a)&&"function"!=typeof a?cA(o):a).event={play:new Phaser.Signal},i.idx=n,i.data=new ec,i.data=Object.assign({},i.data,e),i.ktPlay=!1,i.songListen=null,i.btnPlaySound=null,i.positionOnlineMode=i.mainData.positionCreateRoom,i.bg=new Phaser.Button(game,0,0,"bg-playlist",i.chooseChitiet,cA(cA(i))),i.bg.alpha=0,i.bg.width=i.width-180*z.instance().scale,i.bg.height=i.height,i.bg.x=180*z.instance().scale,i.addChild(i.bg),e.playerChoose.correct_answer?i.icon_true=new rt(i.positionOnlineMode.icon_true_result):i.icon_true=new rt(i.positionOnlineMode.icon_fail_result),i.addChild(i.icon_true),i.txtTime=new St(i.positionOnlineMode.text_time_player_list_result,i.financial(e.playerChoose.time)+"s"),e.playerChoose.correct_answer?i.txtTime.changeStyle({fill:"green"}):i.txtTime.changeStyle({fill:"red"}),i.txtTime.x=i.icon_true.x+(i.icon_true.width-i.txtTime.width)/2,i.addChild(i.txtTime),i.ava=new Ch,i.ava.setSize(84*i.mainData.scale,84*i.mainData.scale),i.ava.x=90*i.mainData.scale,i.ava.y=27*i.mainData.scale,i.ava.beginLoad(i.data.song.thumb,i.idx),i.addChild(i.ava),i.btnPlaySound=new pt(i.positionOnlineMode.button_play_sound_player_list_result,i.choosePlaySound,cA(cA(i))),i.addChild(i.btnPlaySound),i.txtNameSong=new St(i.positionOnlineMode.text_name_song_player_list_result,i.formatName(i.data.song.song,22,!0)),i.txtNameSong.setTextBounds(0,0,375*z.instance().scale,31*z.instance().scale),i.addChild(i.txtNameSong),i.txtNameCasi=new St(i.positionOnlineMode.text_name_casi_player_list_result,i.data.song.singer),i.addChild(i.txtNameCasi),i.line=new rt(i.positionOnlineMode.line_item_player_list),i.line.width=i.width-60*i.mainData.scale,i.line.x=35*z.instance().scale,i.line.y=i.height,i.addChild(i.line),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hA(e,t)}(t,Mt),n=t,(i=[{key:"stopAudio",value:function(){this.removeBtnPlay(),this.btnPlaySound=new pt(this.positionOnlineMode.button_play_sound_player_list_result,this.choosePlaySound,this),this.addChild(this.btnPlaySound)}},{key:"chooseChitiet",value:function(){LogConsole.log("chooseChitiet"),iC.instance().addDetailSong(this.data.song)}},{key:"choosePlaySound",value:function(){this.event.play.dispatch(this.data.song.id)}},{key:"playSound",value:function(){LogConsole.log("playSound"),!1===this.ktPlay?(this.ktPlay=!0,Dl.instance().playsound(this.data.song.listenLink)):Dl.instance().resumeSound(),this.removeBtnPlay(),this.btnPlaySound=new pt(this.positionOnlineMode.button_pause_sound_player_list_result,this.choosePauseSound,this),this.addChild(this.btnPlaySound)}},{key:"removeBtnPlay",value:function(){null!==this.btnPlaySound&&(this.removeChild(this.btnPlaySound),this.btnPlaySound.destroy(),this.btnPlaySound=null)}},{key:"choosePauseSound",value:function(){this.pauseSound()}},{key:"pauseSoundOut",value:function(){this.ktPlay=!1,this.stopAudio()}},{key:"pauseSound",value:function(){this.ktPlay&&Dl.instance().pauseSound(),this.stopAudio()}},{key:"width",get:function(){return 570*z.instance().scale}},{key:"height",get:function(){return 140*z.instance().scale}}])&&rA(n.prototype,i),o&&rA(n,o),t}();function dA(e){return(dA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pA(e,t){return!t||"object"!==dA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gA(e,t,n){return(gA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yA(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yA(e){return(yA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mA(e,t){return(mA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vA=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=pA(this,yA(t).call(this,game,e.x,e.y,e.nameAtlas,i,o,null,e.nameSprite))).lbChoiLai=new St(e.button_reset_lb_choilai_player_list_result,"CHƠI LẠI"),a.addChild(a.lbChoiLai),""!=n?(a.iconKimCuong=new rt(e.button_reset_icon_KimCuong_player_list_result),a.addChild(a.iconKimCuong),a.lbMoney=new St(e.button_reset_lb_money_player_list_result,"-"+n),a.lbMoney.x=a.iconKimCuong.x-a.lbMoney.width-10,a.addChild(a.lbMoney)):a.lbChoiLai.x=(a.width-a.lbChoiLai.width)/2,a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mA(e,t)}(t,Phaser.Button),n=t,(i=[{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),gA(yA(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"destroy",value:function(){this.iconKimCuong&&this.iconKimCuong.destroy(),this.lbChoiLai.destroy(),this.lbMoney&&this.lbMoney.destroy(),gA(yA(t.prototype),"destroy",this).call(this)}}])&&fA(n.prototype,i),o&&fA(n,o),t}();function wA(e){return(wA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SA(e,t,n){return(SA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_A(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _A(e){return(_A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EA(e,t){return(EA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function CA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var kA=function(e){function t(e,n){var i,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=_A(t).call(this,game,null))||"object"!==wA(a)&&"function"!=typeof a?CA(o):a).roomBet=n,i.event={replay:new Phaser.Signal,close:new Phaser.Signal,exit:new Phaser.Signal},i.tween=null,i.ktReplay=!1,i.positionOnlineMode=i.mainData.positionCreateRoom,i.bgPlayerList=new Zt(i.positionOnlineMode.bg_player_list_result),i.bgPlayerList.x=35*z.instance().scale,i.bgPlayerList.y=620*z.instance().scale,i.bgPlayerList.width=570*z.instance().scale,i.bgPlayerList.height=485*z.instance().scale,i.addChild(i.bgPlayerList);var s=new Phaser.Group(game,0,0,null);i.listPlayer=new Jo(game,s,new Phaser.Rectangle(0,0,i.bgPlayerList.width,i.bgPlayerList.height-100*i.mainData.scale),{direction:"y",padding:5*z.instance().scale,searchForClicks:!0}),i.bgPlayerList.addChild(s);for(var r=0;r<e.length;r++){var l=new uA(e[r],r);l.event.play.add(i.playSound,CA(CA(i))),i.listPlayer.add(l)}return i.btnHome=new pt(i.positionOnlineMode.button_home_player_list_result,i.chooseExit,CA(CA(i))),i.btnHome.x=35*z.instance().scale,i.btnHome.y=400*z.instance().scale,i.addChild(i.btnHome),i.btnChoiLai=new vA(i.positionOnlineMode.button_reset_bg_player_list_result,i.roomBet,i.chooseChoiLai,CA(CA(i))),i.btnChoiLai.x=140*z.instance().scale,i.btnChoiLai.y=400*z.instance().scale,i.addChild(i.btnChoiLai),i.tween=game.add.tween(i.bgPlayerList).to({y:0},500,Phaser.Easing.Power1,!0,300),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EA(e,t)}(t,Mt),n=t,(i=[{key:"playSound",value:function(e){for(var t=0;t<this.listPlayer.grp.children.length;t++){var n=this.listPlayer.grp.children[t];n.data.song.id!==e?n.pauseSoundOut():n.playSound()}}},{key:"tweenHide",value:function(){this.tween=game.add.tween(this).to({y:game.height+100*z.instance().scale},500,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.handleComplete,this)}},{key:"handleComplete",value:function(){this.event.close.dispatch()}},{key:"chooseExit",value:function(){LogConsole.log("chooseExit"),this.btnHome.inputEnabled=!1,this.event.exit.dispatch()}},{key:"chooseChoiLai",value:function(){LogConsole.log("chooseChoiLai : "+this.ktReplay),!0===this.ktReplay&&(LogConsole.log("SocketController.instance().dataMySeft.diamond : "+mZ.instance().dataMySeft.diamond),LogConsole.log("roomBet : "+this.roomBet),mZ.instance().dataMySeft.diamond<this.roomBet?(this.event.exit.dispatch(),iC.instance().addDialog("Bạn không đủ Kim Cương để tiếp tục chơi.")):(this.btnHome.inputEnabled=!1,this.tweenHide(),this.event.replay.dispatch()))}},{key:"destroy",value:function(){this.listPlayer.removeAll(),this.listPlayer.destroy(),null!==this.tween&&(this.tween.stop(),game.tweens.remove(this.tween),this.tween=null),SA(_A(t.prototype),"destroy",this).call(this)}}])&&bA(n.prototype,i),o&&bA(n,o),t}();function PA(e){return(PA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function RA(e,t){return!t||"object"!==PA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xA(e,t,n){return(xA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=TA(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function TA(e){return(TA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IA(e,t){return(IA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var AA=function(e){function t(e,n,i){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=RA(this,TA(t).call(this,game,null))).event={destroy:new Phaser.Signal},o.objData=i,o.iconArrow=null;var a="#000000";o.positionCreateRoom=o.mainData.positionCreateRoom,o.objData.hasOwnProperty("atlas")?(o.bg=new Zt(o.positionCreateRoom.chat_waitting_bg_chat),o.bg.width=250,o.bg.height=85):e?(a="#ffffff",o.bg=new Zt(n?o.positionCreateRoom.chat_me_left:o.positionCreateRoom.chat_me_right)):o.bg=new Zt(n?o.positionCreateRoom.chat_user_left:o.positionCreateRoom.chat_user_right),o.addChild(o.bg);var s={x:0,y:0,style:{fontSize:20,fill:a}};o.txtContent=new St(s,i.label),o.txtContent.y=(o.height-o.txtContent.height)/2,o.addChild(o.txtContent);var r="popup";o.objData.hasOwnProperty("atlas")&&""===(r=o.objData.atlas)&&(r="popup");var l={x:0,y:0,nameAtlas:r,nameSprite:i.sprite};if(o.icon=new rt(l),o.addChild(o.icon),o.objData.hasOwnProperty("atlas"))o.txtContent.x=(250-(o.txtContent.width+10+o.icon.width))/2,o.txtContent.y=30,o.icon.x=o.txtContent.x+o.txtContent.width+10,o.icon.y=15,o.iconArrow=new rt(o.positionCreateRoom.chat_waitting_icon_arrow),o.iconArrow.x=(o.bg.width-o.iconArrow.width)/2+5,o.iconArrow.y=o.bg.height,o.addChild(o.iconArrow);else{var h=18*z.instance().scale;o.txtContent.x=h,o.icon.x=o.txtContent.x+o.txtContent.width+h,o.icon.y=(o.height-o.icon.height)/2,o.bg.width=o.txtContent.x+o.txtContent.width+h+o.icon.width+h}return o.idtimeout=setTimeout(function(){o.event.destroy.dispatch(o.objData.id)},3500),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IA(e,t)}(t,Mt),n=t,(i=[{key:"destroy",value:function(){clearTimeout(this.idtimeout),xA(TA(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.objData.hasOwnProperty("atlas")?100:51*z.instance().scale}}])&&OA(n.prototype,i),o&&OA(n,o),t}();function LA(e){return(LA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function DA(e,t){return!t||"object"!==LA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MA(e,t,n){return(MA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=NA(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function NA(e){return(NA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BA(e,t){return(BA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jA=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=DA(this,NA(t).call(this,game,null))).id=n,i.event={destroy:new Phaser.Signal},i.positionCreateRoom=i.mainData.positionCreateRoom,i.bgChat=new Zt(i.positionCreateRoom.chat_waitting_bg_chat),i.lbChat=new St(i.positionCreateRoom.chat_waitting_text_chat,e),console.log("this.lbChat.width : "+i.lbChat.width),console.log("this.lbChat.height : "+i.lbChat.height),i.lbChat.height<47?i.bgChat.height=67:i.bgChat.height=i.lbChat.height+20,i.lbChat.width<35?i.bgChat.width=65:i.bgChat.width=i.lbChat.width+30,i.addChild(i.bgChat),i.lbChat.x=(i.bgChat.width-i.lbChat.width)/2,i.lbChat.y=(i.bgChat.height-i.lbChat.height)/2,i.addChild(i.lbChat),i.iconArrow=new rt(i.positionCreateRoom.chat_waitting_icon_arrow),i.iconArrow.x=(i.bgChat.width-i.iconArrow.width)/2+5,i.iconArrow.y=i.bgChat.height,i.addChild(i.iconArrow),i.idtimeout=setTimeout(function(){i.event.destroy.dispatch(i.id)},3500),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BA(e,t)}(t,Mt),n=t,(i=[{key:"destroy",value:function(){clearTimeout(this.idtimeout),MA(NA(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.bgChat.width}},{key:"height",get:function(){return this.bgChat.height+this.iconArrow.height}}])&&GA(n.prototype,i),o&&GA(n,o),t}();function UA(e){return(UA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZA(e){return(ZA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HA(e,t){return(HA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var VA=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=ZA(t).call(this,game,null))||"object"!==UA(i)&&"function"!=typeof i?QA(n):i).event={choose_item:new Phaser.Signal},e.label=o,e.icon=a,e.textChat=game.add.text(0,0,o,{fill:"#333333",font:"Gilroy",fontSize:23},QA(QA(e))),e.addChild(e.textChat),e.iconChat=e.create(0,0,"createroom",e.icon),e.textChat.x=(320-(e.textChat.width+10+e.iconChat.width))/2,e.textChat.y=30,e.iconChat.x=e.textChat.x+e.textChat.width+10,e.iconChat.y=15,e.btnChoose=game.make.button(0,0,"",e.chooseItem,QA(QA(e))),e.btnChoose.width=320,e.btnChoose.height=85,e.addChild(e.btnChoose),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HA(e,t)}(t,Mt),n=t,(i=[{key:"chooseItem",value:function(){this.event.choose_item.dispatch(this.label,this.icon)}}])&&FA(n.prototype,i),o&&FA(n,o),t}();function WA(e){return(WA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function KA(e){return(KA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zA(e,t){return(zA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var JA=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=KA(t).call(this,game,null))||"object"!==WA(i)&&"function"!=typeof i?YA(n):i).event={close:new Phaser.Signal,show_chat:new Phaser.Signal},e.bg=e.create(0,0,"createroom","White_Tab"),e.bg.width=game.width,e.bg.height=545,e.bgSearch=e.create(0,0,"createroom","Tab_Chat"),e.bgBoxChat=game.make.button(21,20,"createroom",e.chooseChat,YA(YA(e)),"Box_Chat","Box_Chat","Box_Chat","Box_Chat"),e.addChild(e.bgBoxChat),e.textChat=game.add.text(32,50,"Chạm để nhập text",{fill:"#333333",font:"Gilroy",fontSize:23},YA(YA(e))),e.addChild(e.textChat),e.btnClose=game.make.button(0,20,"createroom",e.chooseClose,YA(YA(e)),"chatquickX","chatquickX","chatquickX","chatquickX"),e.btnClose.x=game.width-e.btnClose.width-20,e.addChild(e.btnClose),e.btnChatText=game.make.button(0,30,"createroom",e.chooseChat,YA(YA(e)),"chatquickButton_Text","chatquickButton_Text","chatquickButton_Text","chatquickButton_Text"),e.btnChatText.x=e.btnClose.x-e.btnChatText.width-30,e.addChild(e.btnChatText);for(var o=[{label:"Hi",icon:"chatquick1"},{label:"Zô đi",icon:"chatquick2"},{label:"Chơi nào",icon:"chatquick3"},{label:"Chờ mình chút",icon:"chatquick4"},{label:"Nhanh lên bạn",icon:"chatquick5"},{label:"Lại nha",icon:"chatquick6"},{label:"Làm quen nha",icon:"chatquick7"},{label:"Kết bạn nha",icon:"chatquick8"},{label:"Bye bye",icon:"chatquick9"},{label:"I love you",icon:"chatquick10"}],a=0,s=120,r=0,l=0;l<o.length;l++){r++;var h=new VA(o[l].label,o[l].icon);h.event.choose_item.add(e.sendText,YA(YA(e))),h.x=a,h.y=s,r%2==0?(a=0,s+=85,e.create(a,s,"createroom","chatquickLine_01")):(a+=320,e.create(a,s+20,"createroom","chatquickLine_02")),e.addChild(h)}return e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zA(e,t)}(t,Mt),n=t,(i=[{key:"sendText",value:function(e,t){console.log("label : "+e),console.log("icon : "+t);var n=new SFS2X.SFSObject;n.putUtfString("label",e),n.putUtfString("sprite",t),n.putUtfString("atlas","createroom"),mZ.instance().sendPublicChat(Pe.CHAT_ONLINE_MODE,n),this.chooseClose()}},{key:"chooseClose",value:function(){this.event.close.dispatch()}},{key:"chooseChat",value:function(){this.event.show_chat.dispatch()}}])&&qA(n.prototype,i),o&&qA(n,o),t}();function XA(e){return(XA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $A(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eL(e,t){return!t||"object"!==XA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tL(e,t,n){return(tL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function nL(e){return(nL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iL(e,t){return(iL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),eL(this,nL(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iL(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={back:new Phaser.Signal},this.listSongResult=null,this.choosePlayList=null,this.listFriend=null,this.quickChat=null,this.idTimeOutShowPlayList=null,this.ktPlay=!1,this.ktStart=!1,this.arrQuestion=[],this.timecount=0,this.ktCountDownPlay=!1,this.timeTween=null,this.timerCountDown=null,this.totalPlayerPlay=0,this.arrMeAnswer=[],this.addMeAnswer=new Phaser.Sprite(game,0,0,null),this.addListChart=new Phaser.Sprite(game,0,0,null),this.addChatWaitting=new Phaser.Sprite(game,0,0,null),this.idxQuestion=0,this.arrScore=[],this.arrChart={},this.arrPlayer=[],this.idMaster=-1,this.roomBet=0,this.idRoom="",this.currentBet=0,this.nameMaster="",this.idShowResult=null,this.ktReplay=!1,this.objChat={},this.startTime=0,this.endTime=0,this.ktshowBadConnection=!1,this.checkSendExit=!1,this.objChatWaitting={},this.arrLocal=[{x:100*z.instance().scale,y:385*z.instance().scale},{x:385*z.instance().scale,y:385*z.instance().scale},{x:100*z.instance().scale,y:690*z.instance().scale},{x:385*z.instance().scale,y:690*z.instance().scale}],this.arrLocalPlay2=[{x:206*z.instance().scale,y:223*z.instance().scale},{x:354*z.instance().scale,y:223*z.instance().scale}],this.arrLocalPlay3=[{x:114*z.instance().scale,y:223*z.instance().scale},{x:276*z.instance().scale,y:223*z.instance().scale},{x:438*z.instance().scale,y:223*z.instance().scale}],this.arrLocalPlay4=[{x:59*z.instance().scale,y:223*z.instance().scale},{x:206*z.instance().scale,y:223*z.instance().scale},{x:354*z.instance().scale,y:223*z.instance().scale},{x:495*z.instance().scale,y:223*z.instance().scale}],this.arrLocalResultWin={x:260*z.instance().scale,y:140*z.instance().scale},this.arrLocalResult2=[{x:275*z.instance().scale,y:420*z.instance().scale}],this.arrLocalResult3=[{x:185*z.instance().scale,y:420*z.instance().scale},{x:365*z.instance().scale,y:420*z.instance().scale}],this.arrLocalResult4=[{x:117*z.instance().scale,y:420*z.instance().scale},{x:275*z.instance().scale,y:420*z.instance().scale},{x:431*z.instance().scale,y:420*z.instance().scale}],this.arrLocalResultAllLose2=[{x:211*z.instance().scale,y:260*z.instance().scale},{x:355*z.instance().scale,y:260*z.instance().scale}],this.arrLocalResultAllLose3=[{x:117*z.instance().scale,y:260*z.instance().scale},{x:275*z.instance().scale,y:260*z.instance().scale},{x:431*z.instance().scale,y:260*z.instance().scale}],this.arrLocalResultAllLose4=[{x:60*z.instance().scale,y:260*z.instance().scale},{x:211*z.instance().scale,y:260*z.instance().scale},{x:355*z.instance().scale,y:260*z.instance().scale},{x:490*z.instance().scale,y:260*z.instance().scale}],this.positionCreateRoom=this.mainData.positionCreateRoom,this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg),this.header=new ix,this.header.setWaittingRoom(),this.header.setIdPhong("dfdsf"),this.header.setNguoiTao("Viet Pv"),this.header.event.back.add(this.chooseBack,this),this.addChild(this.header),this.addChild(this.addListChart),this.buildListPlayer(),this.btnMoiBan=new ln(this.positionCreateRoom.waitting_btn_moiban,"MỜI BẠN",this.chooseMoiBan,this),this.btnMoiBan.y=game.height,this.addChild(this.btnMoiBan),this.btnChoi=new ln(this.positionCreateRoom.waitting_btn_choi,"CHƠI",this.chooseChoi,this),this.btnChoi.y=game.height,this.addChild(this.btnChoi),this.btnChatWaitting=new pt(this.positionCreateRoom.chat_waitting_icon_chat,this.addQuickChat,this),this.btnChatWaitting.y=game.height-223,this.addChild(this.btnChatWaitting),this.addChild(this.addChatWaitting),this.txtCounDown=new St(this.positionCreateRoom.waitting_txt_countdown,""),this.txtCounDown.anchor.set(.5),this.txtCounDown.x=game.width/2,this.addChild(this.txtCounDown),this.txtTrick=new St(this.positionCreateRoom.waitting_txt_trick,"Hãy chọn nơi có đường truyền tốt  Để tải dữ liệu"),this.txtTrick.visible=!1,this.txtTrick.addColor("#FFA339",33),this.txtTrick.setTextBounds(0,0,game.width,95*this.mainData.scale),this.txtTrick.y=game.height-95*this.mainData.scale,this.addChild(this.txtTrick),this.hideButtonChoi(),this.hideButtonMoiBan(),this.btnMucCuoc=new ln(this.positionCreateRoom.button_muccuoc_room,"10"),this.addChild(this.btnMucCuoc),this.labelMuccuoc=new St(this.positionCreateRoom.text_muccuoc_room,"Mức cược"),this.labelMuccuoc.x=(game.width-this.labelMuccuoc.width)/2,this.addChild(this.labelMuccuoc),this.lineWin=new rt(this.positionCreateRoom.result_line_win),this.lineWin.visible=!1,this.addChild(this.lineWin),this.txtWin=new St(this.positionCreateRoom.result_txtWin_win,"Người chiến thắng !!!"),this.txtWin.setTextBounds(0,0,game.width,47*z.instance().scale),this.txtWin.visible=!1,this.addChild(this.txtWin),this.button_share=new pt(this.positionCreateRoom.button_share,this.chooseShare,this),this.button_share.visible=!1,this.addChild(this.button_share,this),this.buildUserJoinRoom(),this.addEvent()}},{key:"chooseShare",value:function(){ui.instance().share()}},{key:"showBetRoom",value:function(){this.btnMucCuoc.visible=!0,this.labelMuccuoc.visible=!0}},{key:"hideBetRoom",value:function(){this.btnMucCuoc.visible=!1,this.labelMuccuoc.visible=!1}},{key:"resetArrayScore",value:function(){this.arrScore=[{idx:0,score:0},{idx:1,score:0},{idx:2,score:0},{idx:3,score:0}]}},{key:"hideButtonMoiBan",value:function(){this.btnMoiBan.inputEnabled=!1}},{key:"showButtonMoiBan",value:function(){this.btnMoiBan.inputEnabled=!0}},{key:"hideButtonChoi",value:function(){this.btnChoi.inputEnabled=!1}},{key:"showButtonChoi",value:function(){this.btnChoi.inputEnabled=!0}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().events.onUserEnterRoom.add(this.userEnterRoom,this),mZ.instance().events.onUserExitRoom.add(this.userExitRoom,this),mZ.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this),mZ.instance().events.onRoomVarsUpdate.add(this.onRoomVarsUpdate,this),mZ.instance().events.onPublicMessage.add(this.onPublicMessage,this),De.instance().event.bad_connection.add(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.add(this.chooseExitBadConnection,this),De.instance().event.chooseNoPopupConfirm.add(this.chooseNoPopupConfirm,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),mZ.instance().events.onUserEnterRoom.remove(this.userEnterRoom,this),mZ.instance().events.onUserExitRoom.remove(this.userExitRoom,this),mZ.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this),mZ.instance().events.onRoomVarsUpdate.remove(this.onRoomVarsUpdate,this),mZ.instance().events.onPublicMessage.remove(this.onPublicMessage,this),De.instance().event.bad_connection.remove(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.remove(this.chooseExitBadConnection,this),De.instance().event.chooseNoPopupConfirm.remove(this.chooseNoPopupConfirm,this)}},{key:"chooseNoPopupConfirm",value:function(e){"chooseCanclePopupMoney"===e&&this.chooseBack()}},{key:"checkBadConnection",value:function(){!1===this.ktPlay&&!1===this.ktshowBadConnection&&(this.ktshowBadConnection=!0,iC.instance().addBadConnection())}},{key:"chooseExitBadConnection",value:function(){this.chooseExit()}},{key:"onPublicMessage",value:function(e){if(LogConsole.log("onPublicMessage"),LogConsole.log(e),e.message===Et.CHAT_ONLINE_MODE){var t=e.sender,n=t.isItMe,i=parseInt(t.name);if(e.data.containsKey("label")&&e.data.containsKey("sprite")){var o={label:e.data.getUtfString("label"),sprite:e.data.getUtfString("sprite")};e.data.containsKey("atlas")&&(o.atlas=e.data.getUtfString("atlas"));for(var a=0,s=0;s<this.arrPlayer.length;s++)if(!1===this.arrPlayer[s].ktEmpty&&(a++,this.arrPlayer[s].getData().user_id===i)){var r=!1;r=o.hasOwnProperty("atlas")?this.arrPlayer[s].getData().idx%2==0:2===this.totalPlayerPlay?1!==a:1!==a&&2!==a,o.id=i,this.removeItemChatWaitting(i);var l=new AA(n,r,o);l.event.destroy.add(this.removeItemChatWaitting,this),this.addChatWaitting.addChild(l),o.hasOwnProperty("atlas")?(l.x=this.arrPlayer[s].x+(155-l.width)/2,l.y=this.arrPlayer[s].y+48-l.height,null!==this.listFriend&&this.listFriend.addChatRoom(o.label,t.getVariable("avatar").value,o.sprite),null!==this.choosePlayList&&this.choosePlayList.addChatRoom(o.label,t.getVariable("avatar").value,o.sprite)):r?(l.x=this.arrPlayer[s].x+130*z.instance().scale-l.width,l.x<0&&(l.x=0),l.y=this.arrPlayer[s].y-15*z.instance().scale):(l.x=this.arrPlayer[s].x+55*z.instance().scale,l.y=this.arrPlayer[s].y-15*z.instance().scale),this.objChatWaitting[i]=l;break}}if(e.data.containsKey("chatWaitting"))for(var h=0;h<this.arrPlayer.length;h++)if(!1===this.arrPlayer[h].ktEmpty&&this.arrPlayer[h].getData().user_id===i){this.removeItemChatWaitting(i);var c=new jA(e.data.getUtfString("chatWaitting"),i);c.event.destroy.add(this.removeItemChatWaitting,this),c.x=this.arrPlayer[h].x+(155-c.width)/2,c.y=this.arrPlayer[h].y+48-c.height,this.addChatWaitting.addChild(c),this.objChatWaitting[i]=c,null!==this.listFriend&&this.listFriend.addChatRoom(e.data.getUtfString("chatWaitting"),t.getVariable("avatar").value),null!==this.choosePlayList&&this.choosePlayList.addChatRoom(e.data.getUtfString("chatWaitting"),t.getVariable("avatar").value);break}}}},{key:"removeItemChatWaitting",value:function(e){this.objChatWaitting.hasOwnProperty(e)&&(this.addChatWaitting.removeChild(this.objChatWaitting[e]),this.objChatWaitting[e].destroy(),this.objChatWaitting[e]=null,delete this.objChatWaitting[e])}},{key:"removeItemChat",value:function(e){e&&(this.addChatWaitting.removeChild(e),e.destroy(),e=null)}},{key:"buildUserJoinRoom",value:function(){var e=this;LogConsole.log("buildUserJoinRoom"),LogConsole.log(this.mainData.dataJoinRoom.room);var t=this.mainData.dataJoinRoom.room.getUserList();this.idRoom=this.mainData.dataJoinRoom.room.id,this.mainData.modeplay=this.mainData.dataJoinRoom.room.getVariable("mode").value,this.idMaster=this.mainData.dataJoinRoom.room.getVariable(wa.room_master).value,this.roomBet=this.mainData.dataJoinRoom.room.getVariable(wa.bet_place).value,LogConsole.log(" this.roomBet : "+this.roomBet),this.btnMucCuoc.setText(this.roomBet);for(var n=0;n<t.length;n++){var i=t[n],o=this.getDataPlayer(i);this.arrPlayer[n].setData(o,n),this.arrPlayer[n].setMaster(this.idMaster),o.user_id===this.idMaster&&(this.nameMaster=o.user_name),this.totalPlayerPlay++}this.header.setIdPhong(this.idRoom),this.header.setNguoiTao(this.nameMaster),this.checkShowMaster(),mZ.instance().dataMySeft.user_id!==this.idMaster&&(this.removeTimeoutShowChoosePlayList(),this.idTimeOutShowPlayList=setTimeout(function(){e.addChoosePlayList()},800)),this.checkShowInviteFriend(),this.checkShowButtonChoi(),this.showButtonWaittingChat(),this.mainData.dataJoinRoom=null,qe.instance().hideLoading()}},{key:"showButtonWaittingChat",value:function(){!1===this.ktPlay&&(this.btnChatWaitting.visible=!0,mZ.instance().dataMySeft.user_id===this.idMaster?this.btnChatWaitting.y=game.height-223:this.btnChatWaitting.y=game.height-116)}},{key:"hideButtonWaittingChat",value:function(){this.btnChatWaitting.visible=!1,this.btnChatWaitting.y=game.height}},{key:"showPlayGame",value:function(){var e=this;this.hideTextTrick(),LogConsole.log("showPlayGame");var t=[];2===this.totalPlayerPlay?t=this.arrLocalPlay2:3===this.totalPlayerPlay?t=this.arrLocalPlay3:4===this.totalPlayerPlay&&(t=this.arrLocalPlay4);var n=-1;this.arrChart={};for(var i=0;i<this.arrPlayer.length;i++)if(!1===this.arrPlayer[i].ktEmpty)n++,this.arrPlayer[i].hideLoading(),this.arrPlayer[i].setTextSanSang(""),this.arrPlayer[i].setScore(0),this.arrPlayer[i].setUserPlayGame(),game.add.tween(this.arrPlayer[i]).to({x:t[n].x,y:t[n].y},400,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[i].scale).to({x:.62,y:.62},400,Phaser.Easing.Power1,!0),game.time.events.add(.4*Phaser.Timer.SECOND,this.buidlChartUser,this,this.arrPlayer[i].getData().user_id,n,i,t);else{var o=0;o=i%2==0?-this.arrPlayer[i].width-200*z.instance().scale:game.width+200*z.instance().scale,game.add.tween(this.arrPlayer[i]).to({x:o},200,Phaser.Easing.Power1,!0)}setTimeout(function(){e.buildListMeAnswer(),e.addShowQuestion(e.idxQuestion)},600)}},{key:"buidlChartUser",value:function(e,t,n,i){var o=new rI;mZ.instance().dataMySeft.user_id===e?o.addChart(!0):o.addChart(!1),o.x=i[t].x+2*z.instance().scale,o.y=i[t].y+72*z.instance().scale,o.height=0,this.addListChart.addChild(o),this.arrChart[n]=o,this.setChart(0,n)}},{key:"hideChart",value:function(){for(;this.addListChart.children.length>0;){var e=this.addListChart.children[0];this.addListChart.removeChild(e),e.destroy(),e=null}}},{key:"setChart",value:function(e,t){if(this.arrChart[t]){var n=55*z.instance().scale+200*z.instance().scale*e,i=223*z.instance().scale-200*z.instance().scale*e,o=i+72;game.add.tween(this.arrChart[t]).to({y:o,height:n},500,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[t]).to({y:i},500,Phaser.Easing.Power1,!0),this.objChat[this.arrPlayer[t].getData().user_id]&&null!=this.objChat[this.arrPlayer[t].getData().user_id]&&game.add.tween(this.objChat[this.arrPlayer[t].getData().user_id]).to({y:i-92*z.instance().scale},500,Phaser.Easing.Power1,!0)}}},{key:"buildListMeAnswer",value:function(){for(;this.addMeAnswer.children.length>0;){var e=this.addMeAnswer.children[0];this.addMeAnswer.removeChild(e),e.destroy(),e=null}var t=0,n=25*z.instance().scale;this.arrMeAnswer=[];for(var i=0;i<this.arrQuestion.length;i++){var o=new bI;o.x=t,o.y=n,this.addMeAnswer.addChild(o),t+=54*z.instance().scale,game.add.tween(o).to({y:0},400,Phaser.Easing.Elastic.Out,!0,30*i,1),this.arrMeAnswer.push(o)}this.addMeAnswer.y=385*z.instance().scale,this.addChild(this.addMeAnswer),this.addMeAnswer.x=(game.width-t)/2}},{key:"hideAnswerMe",value:function(){for(var e=0;e<this.arrMeAnswer.length;e++)game.add.tween(this.arrMeAnswer[e]).to({alpha:0},200,Phaser.Easing.Elastic.Out,!0)}},{key:"setMeAnswer",value:function(e){this.arrMeAnswer[e.idx].setData(e)}},{key:"setShowMeAnswerCurrent",value:function(e){this.arrMeAnswer[e].setBeginLoad()}},{key:"addShowQuestion",value:function(e){LogConsole.log("addShowQuestion"),this.removeShowQuestion(),this.setShowMeAnswerCurrent(e),this.showQuestion=new iA(this.arrQuestion,e),this.showQuestion.addEventChooseAnswer(this.setMeAnswer,this),this.showQuestion.addEventShowQuestion(this.setShowMeAnswerCurrent,this),this.showQuestion.event.close.add(this.removeShowQuestion,this),this.showQuestion.x=0,this.showQuestion.y=game.height-700*z.instance().scale,this.addChild(this.showQuestion)}},{key:"removeShowQuestion",value:function(){null!=this.showQuestion&&(this.removeChild(this.showQuestion),this.showQuestion.destroy(),this.showQuestion=null)}},{key:"addListSongResult",value:function(){this.removeListSongResult(),this.listSongResult=new kA(this.arrQuestion,this.roomBet),this.listSongResult.event.replay.add(this.showReplayGame,this),this.listSongResult.event.exit.add(this.chooseExit,this),this.listSongResult.event.close.add(this.removeListSongResult,this),this.listSongResult.y=game.height-515*z.instance().scale,this.addChild(this.listSongResult)}},{key:"removeListSongResult",value:function(){null!==this.listSongResult&&(this.removeChild(this.listSongResult),this.listSongResult.destroy(),this.listSongResult=null)}},{key:"chooseExit",value:function(){qe.instance().showLoading(),mZ.instance().sendData(R_.ONLINE_MODE_ROOM_GAME_FINISH,null)}},{key:"showTimeCountDown",value:function(e){this.removeTimeCountDown(),this.timecount=e,this.setTextCountDown(),this.timerCountDown=this.game.time.create(!0),this.timerEventCountDown=this.timerCountDown.loop(1e3,this.onTimerCountDown,this),this.timerCountDown.start()}},{key:"onTimerCountDown",value:function(){this.timecount--,this.setTextCountDown()}},{key:"setTextCountDown",value:function(){this.timecount>-1?(this.timecount<6&&(game.sound.stopAll(),game.sound.play("beep_audio")),this.ktCountDownPlay&&0===this.timecount?this.txtCounDown.text="Bắt đầu":this.txtCounDown.text=this.timecount,this.txtCounDown.y=this.positionCreateRoom.waitting_txt_countdown.y*z.instance().scale+80*z.instance().scale,game.add.tween(this.txtCounDown).to({y:this.positionCreateRoom.waitting_txt_countdown.y*z.instance().scale},200,Phaser.Easing.Elastic.Out,!0)):(this.ktCountDownPlay&&this.showPlayGame(),this.removeTimeCountDown())}},{key:"removeTimeCountDown",value:function(){null!==this.timerCountDown&&(game.time.events.remove(this.timerEventCountDown),this.timerEventCountDown=null,this.timerCountDown.stop(),this.timerCountDown.destroy(),this.timerCountDown=null),this.txtCounDown.text=""}},{key:"hideHeader",value:function(){this.header.setHideBtnBack(),this.header.y=0,game.add.tween(this.header).to({y:-180*z.instance().scale},300,Phaser.Easing.Power1,!0)}},{key:"showHeader",value:function(){this.header.setShowBtnBack(),this.header.y=-180*z.instance().scale,game.add.tween(this.header).to({y:0},300,Phaser.Easing.Power1,!0)}},{key:"showTextTrick",value:function(){this.txtTrick.visible=!0}},{key:"hideTextTrick",value:function(){this.txtTrick.visible=!1}},{key:"checkShowMaster",value:function(){LogConsole.log("checkShowMaster : "+mZ.instance().dataMySeft.user_id),!1===this.ktPlay&&(mZ.instance().dataMySeft.user_id===this.idMaster?(this.btnMoiBan.visible=!0,this.btnMoiBan.y=game.height,game.add.tween(this.btnMoiBan).to({y:game.height-123*this.mainData.scale},300,Phaser.Easing.Power1,!0,100),this.btnChoi.visible=!0,this.btnChoi.inputEnabled=!0,this.btnChoi.y=game.height,game.add.tween(this.btnChoi).to({y:game.height-123*this.mainData.scale},300,Phaser.Easing.Power1,!0,100)):(this.btnMoiBan.visible=!1,this.btnChoi.visible=!1))}},{key:"hideButtonMaster",value:function(){!0===this.ktPlay&&mZ.instance().dataMySeft.user_id===this.idMaster&&(this.btnMoiBan.visible=!0,this.btnMoiBan.y=game.height-123*this.mainData.scale,game.add.tween(this.btnMoiBan).to({y:game.height},300,Phaser.Easing.Power1,!0,100),this.btnChoi.visible=!0,this.btnChoi.y=game.height-123*this.mainData.scale,game.add.tween(this.btnChoi).to({y:game.height},300,Phaser.Easing.Power1,!0,100))}},{key:"checkShowInviteFriend",value:function(){if(!1===this.ktPlay&&mZ.instance().dataMySeft.user_id===this.idMaster){for(var e=0,t=0;t<this.arrPlayer.length;t++)!1===this.arrPlayer[t].ktEmpty&&e++;e<4?this.showButtonMoiBan():(this.hideButtonMoiBan(),this.removeListFriend())}}},{key:"checkShowButtonChoi",value:function(){if(!1===this.ktPlay&&mZ.instance().dataMySeft.user_id===this.idMaster){LogConsole.log("checkShowButtonChoi");for(var e=0,t=0,n=0;n<this.arrPlayer.length;n++)!1===this.arrPlayer[n].ktEmpty&&(e++,!0===this.arrPlayer[n].getData().online_mode_room_ready?t++:!0===this.arrPlayer[n].getData().isMaster&&t++);LogConsole.log("countReady : "+t),LogConsole.log("countPlayer : "+e),1===e?this.hideButtonChoi():t===e?this.showButtonChoi():this.hideButtonChoi()}}},{key:"getDataPlayer",value:function(e){var t=new $x;return t.user_id=e.getVariable(wa.user_id).value,t.user_name=e.getVariable(wa.user_name).value,t.avatar=e.getVariable(wa.avatar).value,t.online_mode_room_ready=e.getVariable(wa.online_mode_room_ready).value,t.user_id===this.idMaster?t.isMaster=!0:t.isMaster=!1,t}},{key:"getData",value:function(e){switch(e.cmd){case R_.ONLINE_MODE_ROOM_PLAYLIST_RESPONSE:break;case R_.ONLINE_MODE_ROOM_SERVER_QUESTIONS_RESPONSE:if(!1===this.ktPlay){this.hideBetRoom(),this.ktStart=!1,this.resetArrayScore(),this.ktCountDownPlay=!1,this.ktPlay=!0,mZ.instance().sendLoading(1),this.hideButtonMaster(),this.hideHeader(),this.showTextTrick();for(var t=0;t<this.arrPlayer.length;t++)this.arrPlayer[t].setPlay(!0);this.arrQuestion=bT.begin(e.params)}break;case R_.ONLINE_MODE_ROOM_GAME_START:this.hideButtonWaittingChat(),this.hideKeyBoard(),li.instance().playCreateRoom(),this.hideButtonMoiBan(),this.hideButtonChoi(),this.startTime=this.getTime(),Le.instance().logEvent(Le.pro_quiz_start_createroom),this.ktStart=!0,this.ktCountDownPlay=!0,this.idxQuestion=e.params.getInt(nc.question_index)-1,this.showTimeCountDown(3),iC.instance().removeUserProfile();break;case R_.ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_RESPONSE:this.setScorePlayer(e.params);break;case R_.ONLINE_MODE_ROOM_GAME_RESULT:this.endTime=this.getTime();var n=parseInt((this.endTime-this.startTime)/1e3);Le.instance().logEvent(Le.play_time,n),Le.instance().logEvent(Le.pro_quiz_end_createroom),this.removeShowResult(),this.idShowResult=game.time.events.add(2*Phaser.Timer.SECOND,this.showResult,this,e.params);break;case R_.ONLINE_MODE_ROOM_QUICK_JOIN_RESPONSE:}}},{key:"removeShowResult",value:function(){null!==this.idShowResult&&(game.time.events.remove(this.idShowResult),this.idShowResult=null)}},{key:"showReplayGame",value:function(){var e=this;if(!0===this.ktReplay){this.lineWin.visible=!1,this.txtWin.visible=!1,this.showHeader(),this.checkShowMaster(),this.removeEffectWin(),this.hideButtonChoi(),this.hideButtonMoiBan(),this.showBetRoom(),this.button_share.visible=!1;for(var t=0;t<this.arrPlayer.length;t++)this.arrPlayer[t].setDefaultUser(),!1===this.arrPlayer[t].ktEmpty&&this.arrPlayer[t].setTextMaster(),game.add.tween(this.arrPlayer[t]).to({x:this.arrLocal[t].x,y:this.arrLocal[t].y},300,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[t].scale).to({x:1,y:1},300,Phaser.Easing.Power1,!0);this.removeTimeoutShowChoosePlayList(),this.idTimeOutShowPlayList=setTimeout(function(){e.addChoosePlayList()},800)}}},{key:"showResult",value:function(e){game.sound.stopAll(),this.ktReplay=!1,this.lineWin.visible=!0,this.txtWin.visible=!0,this.ktPlay=!1,aA.begin(e,this.arrPlayer);var t=[];this.arrScore[0].score>0?2===this.totalPlayerPlay?t=this.arrLocalResult2:3===this.totalPlayerPlay?t=this.arrLocalResult3:4===this.totalPlayerPlay&&(t=this.arrLocalResult4):2===this.totalPlayerPlay?t=this.arrLocalResultAllLose2:3===this.totalPlayerPlay?t=this.arrLocalResultAllLose3:4===this.totalPlayerPlay&&(t=this.arrLocalResultAllLose4);var n=-1,i=0,o=0,a=0;this.button_share.visible=!0,this.showQuestion.hideQuestion(),this.hideAnswerMe(),this.hideChart(),this.addListSongResult();for(var s=0;s<this.arrScore.length;s++)!1===this.arrPlayer[this.arrScore[s].idx].ktEmpty&&(0===s?this.arrScore[0].score>0?(i=this.arrLocalResultWin.x,o=this.arrLocalResultWin.y,a=.76,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!0,this.roomBet),this.removeShowResult(),this.idShowResult=game.time.events.add(.8*Phaser.Timer.SECOND,this.addEffectUserWin,this,this.arrPlayer[this.arrScore[s].idx]),this.arrPlayer[this.arrScore[s].idx].getData().user_id===mZ.instance().dataMySeft.user_id&&ce.instance().playSound(ce.winturnbasepartymode)):(i=t[++n].x,o=t[n].y,a=.61,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!1),this.ktReplay=!0,this.listSongResult.ktReplay=!0):(i=t[++n].x,o=t[n].y,a=.61,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!1),this.arrPlayer[this.arrScore[s].idx].getData().user_id===mZ.instance().dataMySeft.user_id&&ce.instance().playSound(ce.loseturnbasepartymode)),game.add.tween(this.arrPlayer[this.arrScore[s].idx]).to({x:i,y:o},500,Phaser.Easing.Power1,!0,200),game.add.tween(this.arrPlayer[this.arrScore[s].idx].scale).to({x:a,y:a},500,Phaser.Easing.Power1,!0,200));for(var r=0;r<this.arrPlayer.length;r++)this.arrPlayer[r].setPlay(!1),!0===this.arrPlayer[r].ktDisConnect&&(this.arrPlayer[r].setEmpty(),this.totalPlayerPlay--)}},{key:"addEffectUserWin",value:function(e){this.removeEffectWin(),this.rotationWin=new rt(this.positionCreateRoom.light_rotation_list_result),this.rotationWin.anchor.set(.5),this.addListChart.addChild(this.rotationWin),this.rotationWin.x=e.x+60*z.instance().scale,this.rotationWin.y=e.y+100*z.instance().scale,this.tweenRotationwin=game.add.tween(this.rotationWin).to({rotation:360},2e3,Phaser.Easing.Power1,!0),this.tweenRotationwin.repeat(99999,250),this.firework=new Phaser.Sprite(game,0,0,"firework"),this.firework.width=430*z.instance().scale,this.firework.height=228*z.instance().scale,this.firework.x=103*z.instance().scale,this.firework.y=106*z.instance().scale,this.firework.animations.add("playfirework"),this.firework.animations.play("playfirework",30,!0),this.addListChart.addChild(this.firework),this.ktReplay=!0,this.listSongResult.ktReplay=!0}},{key:"removeEffectWin",value:function(){if(this.addListChart.children)for(;this.addListChart.children.length>0;){var e=this.addListChart.children[0];this.addListChart.removeChild(e),e.destroy(),e=null}}},{key:"setScorePlayer",value:function(e){if(LogConsole.log("setScorePlayer : "+e.getDump()),"OK"===e.getUtfString(wa.status)){LogConsole.log(1);for(var t=0;t<this.arrPlayer.length;t++)if(!1===this.arrPlayer[t].ktEmpty){LogConsole.log(2);var n=this.arrPlayer[t].getData(),i=e.getInt(wa.user_id);if(n.user_id===i){var o=e.getInt(wa.score),a=e.getBool(wa.is_correct_answer);this.arrPlayer[t].setScore(o),!0===a?this.arrPlayer[t].setTrueAnswer():this.arrPlayer[t].setFailtAnswer();for(var s=0;s<this.arrScore.length;s++)if(this.arrScore[s].idx==t){this.arrScore[s].score=o;break}break}}}this.arrScore.sort(this.compare);var r=this.arrScore[0].score;if(r>0){this.setChart(1,this.arrScore[0].idx);for(var l=1;l<this.arrScore.length;l++)!1===this.arrPlayer[this.arrScore[l].idx].ktEmpty&&this.setChart(this.arrScore[l].score/r,this.arrScore[l].idx)}}},{key:"addChoosePlayList",value:function(){this.removeChoosePlayList(),this.choosePlayList=new Wx,this.choosePlayList.setBetMoney(this.roomBet),this.choosePlayList.setIsMaster(!1),this.choosePlayList.addEvent(),this.choosePlayList.event.back.add(this.removeChoosePlayList,this),this.addChild(this.choosePlayList),this.checkShowButtonChoi(),this.checkShowInviteFriend(),this.showButtonWaittingChat()}},{key:"removeChoosePlayList",value:function(){null!==this.choosePlayList&&(this.removeChild(this.choosePlayList),this.choosePlayList.destroy(),this.choosePlayList=null)}},{key:"onRoomVarsUpdate",value:function(e){if(LogConsole.log("onRoomVarsUpdate"),-1!=e.changedVars.indexOf("room_master")){this.idMaster=e.room.getVariable("room_master").value,mZ.instance().dataMySeft.user_id===this.idMaster&&(this.isMaster=!0,!1===this.ktPlay&&iC.instance().addDialog("Bạn được chuyển làm chủ phòng.")),LogConsole.log("isMaster : "+this.idMaster),null===this.listSongResult&&(this.checkShowMaster(),this.checkShowInviteFriend(),this.checkShowButtonChoi(),this.showButtonWaittingChat());for(var t=0;t<this.arrPlayer.length;t++)!1===this.arrPlayer[t].ktEmpty&&(this.arrPlayer[t].idMaster=this.idMaster,this.arrPlayer[t].getData().user_id===this.idMaster?(this.arrPlayer[t].getData().isMaster=!0,this.nameMaster=this.arrPlayer[t].getData().user_name,this.arrPlayer[t].setCurrentData(this.arrPlayer[t].getData())):(this.arrPlayer[t].getData().isMaster=!1,this.arrPlayer[t].setCurrentData(this.arrPlayer[t].getData())),null===this.listSongResult&&!1===this.ktPlay&&this.arrPlayer[t].setTextMaster());this.header.setNguoiTao(this.nameMaster)}}},{key:"userVarsUpdate",value:function(e){var t=e.user,n=this.getDataPlayer(t);if(-1!==e.changedVars.indexOf(wa.online_mode_loaded)&&!0===this.ktPlay)for(var i=t.getVariable(wa.online_mode_loaded).value,o=0;o<this.arrPlayer.length;o++){var a=this.arrPlayer[o];!1===a.ktEmpty&&a.getData().user_id===n.user_id&&i>0&&a.setLoading(i)}!0===t.isItMe&&!0===n.online_mode_room_ready&&null!==this.choosePlayList&&this.removeChoosePlayList();for(var s=0;s<this.arrPlayer.length;s++){var r=this.arrPlayer[s];if(!1===r.ktEmpty)if(r.getData().user_id==n.user_id){this.arrPlayer[s].setCurrentData(n),!1===this.ktPlay&&r.setTextMaster();break}}this.checkShowButtonChoi()}},{key:"userEnterRoom",value:function(e){if(LogConsole.log("userEnterRoom------"),e.room.isGame){var t=e.user;LogConsole.log(t);for(var n=this.getDataPlayer(t),i=0;i<this.arrPlayer.length;i++)if(!0===this.arrPlayer[i].ktEmpty){this.arrPlayer[i].setMaster(this.idMaster),this.arrPlayer[i].setData(n,i),this.totalPlayerPlay++;break}}this.checkShowButtonChoi(),this.checkShowInviteFriend()}},{key:"userExitRoom",value:function(e){if(LogConsole.log("userExitRoom------ : "+e.user.isItMe),LogConsole.log(e.user),e.room.isGame)if(e.user.isItMe)this.event.back.dispatch();else{var t=e.user;LogConsole.log(t);for(var n=t.getVariable(wa.user_id).value,i=0;i<this.arrPlayer.length;i++)if(!1===this.arrPlayer[i].ktEmpty){var o=this.arrPlayer[i].getData();if(o.user_id===n){this.ktPlay?(this.ktStart,o.user_id=-1,this.arrPlayer[i].setCurrentData(o),this.arrPlayer[i].setDisConnect()):(this.arrPlayer[i].setEmpty(),this.totalPlayerPlay--);break}}this.checkShowButtonChoi(),this.checkShowInviteFriend()}}},{key:"buildListPlayer",value:function(){this.arrPlayer=[];for(var e=0;e<this.arrLocal.length;e++){var t=new gT;t.setEmpty(),t.setIdx(e),t.event.click_avatar.add(this.click_avatar,this),t.event.choose_invite.add(this.addListFriend,this),t.x=e%2==0?-t.width-200*z.instance().scale:game.width+200*z.instance().scale,t.y=this.arrLocal[e].y,game.add.tween(t).to({x:this.arrLocal[e].x},250,Phaser.Easing.Power1,!0,400),this.addChild(t),this.arrPlayer.push(t)}}},{key:"click_avatar",value:function(e){for(var t=0;t<this.arrPlayer.length;t++)this.arrPlayer[t].getIdx()===e||this.arrPlayer[t].setCheckHideKichTween()}},{key:"addListFriend",value:function(){mZ.instance().dataMySeft.user_id===this.idMaster&&!1===this.ktPlay&&(this.removeListFriend(),this.listFriend=new tI(this.idRoom,this.totalPlayerPlay),this.listFriend.event.back.add(this.backListFriend,this),this.addChild(this.listFriend))}},{key:"backListFriend",value:function(){zc.instance().beginSwitch(this.listFriend,null,!1),zc.instance().event.tweenComplete.add(this.tweenListFriendComplete,this)}},{key:"tweenListFriendComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenListFriendComplete,this),this.removeListFriend()}},{key:"removeListFriend",value:function(){null!==this.listFriend&&(this.removeChild(this.listFriend),this.listFriend.destroy(),this.listFriend=null)}},{key:"addQuickChat",value:function(){this.removeQuickChat(),this.quickChat=new JA,this.quickChat.event.close.add(this.removeQuickChat,this),this.quickChat.event.show_chat.add(this.chooseChatWatting,this),this.quickChat.y=game.height-this.quickChat.height,this.addChild(this.quickChat)}},{key:"removeQuickChat",value:function(){null!==this.quickChat&&(this.removeChild(this.quickChat),this.quickChat.destroy(),this.quickChat=null)}},{key:"chooseChatWatting",value:function(){this.removeQuickChat();rl.instance().show({maxLength:"",showTransparent:!0,placeholder:"Chat",isSearch:!1}),rl.instance().event.enter.add(this.onSubmit,this),rl.instance().event.submit.add(this.onSubmit,this),rl.instance().event.cancle.add(this.onCancel,this)}},{key:"hideKeyBoard",value:function(){rl.instance().hide(),rl.instance().event.enter.remove(this.onSubmit,this),rl.instance().event.submit.remove(this.onSubmit,this),rl.instance().event.cancle.remove(this.onCancel,this)}},{key:"onSubmit",value:function(){var e=rl.instance().getValue();if(""!==e){var t=new SFS2X.SFSObject;t.putUtfString("chatWaitting",e),mZ.instance().sendPublicChat(Et.CHAT_ONLINE_MODE,t)}this.onCancel()}},{key:"onCancel",value:function(){this.hideKeyBoard()}},{key:"chooseChoi",value:function(){LogConsole.log("chooseChoi"),mZ.instance().dataMySeft.diamond<this.roomBet?iC.instance().addDialogConfirnMoney("Bạn không đủ kim cương để chơi, bạn có muốn nạp thêm?","chooseCanclePopupMoney"):(this.btnChoi.inputEnabled=!1,mZ.instance().sendData(R_.ONLINE_MODE_ROOM_START_GAME_REQUEST,null))}},{key:"chooseMoiBan",value:function(){LogConsole.log("chooseMoiBan"),this.addListFriend()}},{key:"chooseBack",value:function(){!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&null!==this.listFriend||!1===this.ktPlay&&!1===this.checkSendExit&&(this.checkSendExit=!0,qe.instance().showLoading(),mZ.instance().sendExitRoom())}},{key:"removeTimeoutShowChoosePlayList",value:function(){null!==this.idTimeOutShowPlayList&&clearTimeout(this.idTimeOutShowPlayList)}},{key:"destroy",value:function(){this.removeShowResult(),Dl.instance().removeAllSound(),this.removeTimeoutShowChoosePlayList(),this.removeEvent(),this.removeAllItem(),this.hideKeyBoard(),tL(nL(t.prototype),"destroy",this).call(this)}}])&&$A(n.prototype,i),o&&$A(n,o),t}();function aL(e){return(aL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rL(e,t){return!t||"object"!==aL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lL(e,t,n){return(lL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=hL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function hL(e){return(hL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cL(e,t){return(cL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var uL=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=rL(this,hL(t).call(this,game,null))).event={back:new Phaser.Signal,quickplay:new Phaser.Signal},n.ktBack=e,n.nameState="",n.screenChooseMode=null,n.screenCreateRoom=null,n.screenPlaying=null,n.checkDataRoom(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cL(e,t)}(t,Mt),n=t,(i=[{key:"checkShowInvite",value:function(e){console.log("checkShowInvite onlinemode "),"choosemode"===this.nameState&&!1===Gc.instance().getUserBlock(e.getInt("inviter_id"))&&iC.instance().addDialogInviteFriend(e,!0)}},{key:"checkDataRoom",value:function(){LogConsole.log("checkDataRoom--------------"),LogConsole.log(this.mainData.dataJoinRoom),null!==this.mainData.dataJoinRoom?this.addScreenPlayRoom():this.addScreenChooseMode()}},{key:"addScreenChooseMode",value:function(){this.removeScreenChooseMode(),this.nameState="choosemode",this.screenChooseMode=new cx,this.screenChooseMode.event.create_room.add(this.addScreenCreateRoom,this),this.screenChooseMode.event.close.add(this.backToMainMenu,this),this.screenChooseMode.event.quick_play.add(this.addScreenQuickPlay,this),this.addChild(this.screenChooseMode),null!==this.screenCreateRoom?this.removeScreenCreateRoom():null!==this.screenPlaying?this.removeScreenPlayRoom():0==this.ktBack&&zc.instance().beginSwitch(null,this.screenChooseMode,!1)}},{key:"removeScreenChooseMode",value:function(){null!==this.screenChooseMode&&(this.removeChild(this.screenChooseMode),this.screenChooseMode.destroy(),this.screenChooseMode=null)}},{key:"addScreenCreateRoom",value:function(){this.removeScreenCreateRoom(),this.nameState="createroom",this.screenCreateRoom=new Xx,this.screenCreateRoom.event.back.add(this.addScreenChooseMode,this),this.addChild(this.screenCreateRoom),null!==this.screenChooseMode&&this.removeScreenChooseMode(),null!==this.screenPlaying&&this.removeScreenPlayRoom()}},{key:"removeScreenCreateRoom",value:function(){null!==this.screenCreateRoom&&(this.removeChild(this.screenCreateRoom),this.screenCreateRoom.destroy(),this.screenCreateRoom=null)}},{key:"addScreenQuickPlay",value:function(){LogConsole.log("addScreenQuickPlay"),this.event.quickplay.dispatch()}},{key:"addScreenPlayRoom",value:function(){this.removeScreenPlayRoom(),this.nameState="playroom",this.screenPlaying=new oL,this.screenPlaying.event.back.add(this.addScreenChooseMode,this),this.addChild(this.screenPlaying),null!==this.screenCreateRoom&&(zc.instance().beginSwitch(this.screenCreateRoom,this.screenPlaying,!1),zc.instance().event.tweenComplete.add(this.onCompleteTweenScreenCreateRoom,this)),null!==this.screenChooseMode&&this.removeScreenChooseMode()}},{key:"removeScreenPlayRoom",value:function(){null!==this.screenPlaying&&(this.removeChild(this.screenPlaying),this.screenPlaying.destroy(),this.screenPlaying=null)}},{key:"onCompleteTweenScreenCreateRoom",value:function(){zc.instance().event.tweenComplete.remove(this.onCompleteTweenScreenCreateRoom,this),this.removeScreenCreateRoom()}},{key:"onCompleteTweenScreenChooseMode",value:function(){zc.instance().event.tweenComplete.remove(this.onCompleteTweenScreenChooseMode,this),this.removeScreenChooseMode()}},{key:"onCompleteTweenScreenPlaying",value:function(){zc.instance().event.tweenComplete.remove(this.onCompleteTweenScreenPlaying,this),this.removeScreenPlayRoom()}},{key:"backToMainMenu",value:function(){this.removeAllItem(),lL(hL(t.prototype),"destroy",this).call(this),WF.instance().changeScreen(Ce.MAIN_MENU,{})}}])&&sL(n.prototype,i),o&&sL(n,o),t}();function dL(e){return(dL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pL(e,t){return!t||"object"!==dL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gL(e,t,n){return(gL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function yL(e){return(yL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mL(e,t){return(mL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vL=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=pL(this,yL(t).call(this,game,0,0,null,n,i))).positionCreateRoom=z.instance().positionCreateRoom,o.defaultBg=new Zt(o.positionCreateRoom.quickplay_tab_btn_default),o.addChild(o.defaultBg),o.activeBg=new Zt(o.positionCreateRoom.quickplay_tab_btn_active),o.addChild(o.activeBg),o.lineActive=new rt(o.positionCreateRoom.quickplay_tab_line),o.addChild(o.lineActive),o.lb=new St(o.positionCreateRoom.quickplay_tab_btn_label,e),o.lb.setTextBounds(0,0,o.defaultBg.width,o.defaultBg.height),o.addChild(o.lb),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mL(e,t)}(t,Phaser.Button),n=t,(i=[{key:"setActiveBet",value:function(){this.activeBg.width=game.width,this.activeBg.height=100*z.instance().scale,this.lb.setTextBounds(0,0,this.activeBg.width,this.activeBg.height),this.lineActive.width=this.activeBg.targetWidth,this.activeBg.visible=!0,this.lineActive.visible=!0,this.defaultBg.visible=!1}},{key:"setActive",value:function(){this.activeBg.visible=!0,this.lineActive.visible=!0,this.defaultBg.visible=!1}},{key:"setDefault",value:function(){this.activeBg.visible=!1,this.lineActive.visible=!1,this.defaultBg.visible=!0}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),gL(yL(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"width",get:function(){return this.activeBg.width}},{key:"height",get:function(){return this.activeBg.height}}])&&fL(n.prototype,i),o&&fL(n,o),t}();function wL(e){return(wL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SL(e,t){return!t||"object"!==wL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _L(e){return(_L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EL(e,t){return(EL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),SL(this,_L(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EL(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={choose:new Phaser.Signal},this.type=this.mainData.typeMenuGenes,this.btnVN=new vL(nv.getNameRegion(nv.Local),this.clickVN,this),this.addChild(this.btnVN),this.btnQuocTe=new vL(nv.getNameRegion(nv.International),this.clickQuocTe,this),this.btnQuocTe.x=this.btnVN.width,this.addChild(this.btnQuocTe),this.type==nv.Local?(this.btnVN.setActive(),this.btnQuocTe.setDefault()):(this.btnVN.setDefault(),this.btnQuocTe.setActive())}},{key:"clickVN",value:function(e){this.type==nv.International&&(this.type=nv.Local,this.btnQuocTe.setDefault(),this.btnVN.setActive(),this.event.choose.dispatch(this.type))}},{key:"clickQuocTe",value:function(e){this.type==nv.Local&&(this.type=nv.International,this.btnVN.setDefault(),this.btnQuocTe.setActive(),this.event.choose.dispatch(this.type))}}])&&bL(n.prototype,i),o&&bL(n,o),t}();function kL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var PL=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){for(var n=t.getSFSArray(nc.genres_user_count),i=0;i<n.size();i++)for(var o=n.getSFSObject(i),a=0;a<e.length;a++)if(e[a].id===o.getInt(nc.genre_id)){e[a].number_player=o.getInt(nc.number_player);break}return e}}],(n=null)&&kL(t.prototype,n),i&&kL(t,i),e}();function OL(e){return(OL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xL(e,t){return!t||"object"!==OL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TL(e,t,n){return(TL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=IL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function IL(e){return(IL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AL(e,t){return(AL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LL=function(e){function t(e,n,i,o){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=xL(this,IL(t).call(this,game,0,0,null,i,o))).idx=n,a.data=e,LogConsole.log(e),a.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),a.positionCreateRoom=z.instance().positionCreateRoom,a.objSprite=a.positionIsNewUserConfig.chooseMain.genres;var s=a.objSprite.nhac_tre;a.objSprite.hasOwnProperty(e.code)&&(s=a.objSprite[e.code]),LogConsole.log(s),a.bgGenres=new rt(s),a.addChild(a.bgGenres),e.hasOwnProperty("number_player")?a.countPlayer=new ln(a.positionCreateRoom.quickplay_bg_count_player,e.number_player):a.countPlayer=new ln(a.positionCreateRoom.quickplay_bg_count_player,"0"),a.addChild(a.countPlayer);return a.idx%2==0?(a.x=-a.width-118*z.instance().scale,35*z.instance().scale):(a.x=2*a.width+179*z.instance().scale,a.width+61*z.instance().scale),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AL(e,t)}(t,Phaser.Button),n=t,(i=[{key:"setEffect",value:function(){LogConsole.log("setEffect"+this.idx);var e=0;this.idx%2==0?(this.x=-this.width-118*z.instance().scale,e=35*z.instance().scale):(this.x=2*this.width+179*z.instance().scale,e=this.width+61*z.instance().scale),game.add.tween(this).to({x:e},200,Phaser.Easing.Power1,!0,150+50*(this.idx+1))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){this.data=e,this.countPlayer.setText(e.number_player)}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),TL(IL(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"width",get:function(){return this.bgGenres.width}},{key:"height",get:function(){return this.bgGenres.height}}])&&RL(n.prototype,i),o&&RL(n,o),t}();function GL(e){return(GL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ML(e,t){return!t||"object"!==GL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NL(e,t,n){return(NL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BL(e){return(BL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jL(e,t){return(jL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var UL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ML(this,BL(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jL(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){qe.instance().showLoading(),this.event={back:new Phaser.Signal,next_bet:new Phaser.Signal},this.typeMenu=this.mainData.typeMenuGenes,this.arrItem=[],this.positionCreateRoom=this.mainData.positionCreateRoom,this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg),this.parenItem=new Phaser.Sprite(game,0,0,null);var e={column:2,width:game.width,height:game.height-235*this.mainData.scale,rowHeight:160*this.mainData.scale,leftDistance:27*this.mainData.scale,direction:"y",distanceBetweenColumns:36*this.mainData.scale,distanceBetweenRows:36*this.mainData.scale};this.scroll=new Sy(e),this.scroll.y=240*this.mainData.scale,this.addChild(this.scroll),this.header=new ix,this.header.event.back.add(this.chooseBack,this),this.header.setDiamond(),this.addChild(this.header),this.menu=new CL,this.menu.event.choose.add(this.chooseGenres,this),this.menu.y=100*this.mainData.scale,this.addChild(this.menu)}},{key:"chooseGenres",value:function(e){this.typeMenu=e,this.mainData.typeMenuGenes=this.typeMenu,this.buildListGenres()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),Kr.instance().event.load_playlist_complete.add(this.buildDataGenres,this),!0===Kr.instance().ktLoadPlaylist?this.buildDataGenres():Kr.instance().sendGetDataShop(),li.instance().showBanerQuickPlayModeRoomScreen()}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),Kr.instance().event.load_playlist_complete.remove(this.buildDataGenres,this)}},{key:"buildDataGenres",value:function(){this.buildListGenres(),qe.instance().hideLoading()}},{key:"getData",value:function(e){switch(e.cmd){case _I.ONLINE_MODE_GENRES_RESPONSE:case _I.ONLINE_MODE_USER_COUNT_BROADCAST:break;case _I.ONLINE_MODE_COUNT_USER_ONLINE_RESPONSE:this.dataGenres=PL.begin(this.dataGenres,e.params),this.buildListGenresUpdate()}}},{key:"buildListGenres",value:function(){this.arrItem=[];var e=-1;this.dataGenres=Kr.instance().genres.getDataGenresByLocal(this.typeMenu);for(var t=0;t<this.dataGenres.length;t++){var n=this.dataGenres[t],i=new LL(n,++e,this.chooseItem,this);this.arrItem.push(i)}this.scroll.viewList=this.arrItem;for(var o=0;o<this.arrItem.length;o++){this.arrItem[o].setEffect()}mZ.instance().sendData(_I.ONLINE_MODE_COUNT_USER_ONLINE_REQUEST,null)}},{key:"chooseItem",value:function(e){LogConsole.log("chooseItem ------ ");var t=e.getData();this.event.next_bet.dispatch(t)}},{key:"buildListGenresUpdate",value:function(){LogConsole.log(this.dataGenres);for(var e=0;e<this.arrItem.length;e++)for(var t=this.arrItem[e],n=t.getData(),i=0;i<this.dataGenres.length;i++){var o=this.dataGenres[i];if(o.id===n.id){t.setData(o);break}}}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"removeAllParentItem",value:function(){if(this.parenItem.children)for(;this.parenItem.children.length>0;){var e=this.parenItem.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"destroy",value:function(){this.removeEvent(),this.removeAllParentItem(),this.removeAllItem(),this.scroll.destroy(),li.instance().hideBanner(),NL(BL(t.prototype),"destroy",this).call(this)}}])&&DL(n.prototype,i),o&&DL(n,o),t}();function FL(e){return(FL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZL(e){return(ZL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QL(e,t,n){return t&&HL(e.prototype,t),n&&HL(e,n),e}function VL(e,t){return(VL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function WL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var qL=function(e){function t(e){var n,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=ZL(t).call(this,game,null))||"object"!==FL(o)&&"function"!=typeof o?WL(i):o).event={backBet:new Phaser.Signal,backGenres:new Phaser.Signal},n.positionCreateRoom=n.mainData.positionCreateRoom,n.bgTree=new vL(""),n.bgTree.setActiveBet(),n.addChild(n.bgTree),n.lbBackGennes=new St(n.positionCreateRoom.quickplay_txt_button_back_menu_visilbe,a),n.lbBackGennes.x=33*n.mainData.scale,n.lbBackGennes.y=39*n.mainData.scale,n.lbBackGennes.setButton(n.backToGenres,WL(WL(n))),n.addChild(n.lbBackGennes),n.iconArraow=new rt(n.positionCreateRoom.quickplay_arrow_back_menu),n.iconArraow.x=n.lbBackGennes.x+n.lbBackGennes.width+12*n.mainData.scale,n.iconArraow.y=n.lbBackGennes.y+(n.lbBackGennes.height-n.iconArraow.height)/2,n.addChild(n.iconArraow),e===t.TREE_BET?n.lbGennes=new St(n.positionCreateRoom.quickplay_txt_button_back_menu,s):(n.lbGennes=new St(n.positionCreateRoom.quickplay_txt_button_back_menu_visilbe,s),n.lbGennes.setButton(n.backToBets,WL(WL(n)))),n.lbGennes.y=n.lbBackGennes.y,n.lbGennes.x=n.iconArraow.x+n.iconArraow.width+12*n.mainData.scale,n.addChild(n.lbGennes),e===t.TREE_PLAYLIST&&(n.iconArraow1=new rt(n.positionCreateRoom.quickplay_arrow_back_menu),n.iconArraow1.x=n.lbGennes.x+n.lbGennes.width+12*n.mainData.scale,n.iconArraow1.y=n.lbGennes.y+(n.lbGennes.height-n.iconArraow1.height)/2,n.addChild(n.iconArraow1),n.lbPlayerList=new St(n.positionCreateRoom.quickplay_txt_button_back_menu,"Play List"),n.lbPlayerList.y=n.lbBackGennes.y,n.lbPlayerList.x=n.iconArraow1.x+n.iconArraow1.width+12*n.mainData.scale,n.addChild(n.lbPlayerList)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VL(e,t)}(t,Mt),QL(t,null,[{key:"TREE_BET",value:function(){return"TREE_BET"}},{key:"TREE_PLAYLIST",value:function(){return"TREE_PLAYLIST"}}]),QL(t,[{key:"backToGenres",value:function(){this.event.backGenres.dispatch()}},{key:"backToBets",value:function(){LogConsole.log("backToBets"),this.event.backBet.dispatch()}}]),t}();function KL(e){return(KL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function YL(e,t,n){return(YL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=JL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function JL(e){return(JL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XL(e,t){return(XL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var eG=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,n=!(o=JL(t).call(this,game,null))||"object"!==KL(o)&&"function"!=typeof o?$L(i):o,qe.instance().showLoading(),n.dataGennes=e,n.event={back:new Phaser.Signal,backGenres:new Phaser.Signal,choose_bet:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg),n.tabTree=new qL(qL.TREE_BET,nv.getNameRegion(n.dataGennes.region),n.dataGennes.genre),n.tabTree.event.backGenres.add(n.chooseBackToGenres,$L($L(n))),n.tabTree.y=100*n.mainData.scale,n.addChild(n.tabTree);var a=new Phaser.Group(game,0,0,null);return n.listBet=new Jo(game,a,new Phaser.Rectangle(0,0,game.width,game.height-270*n.mainData.scale),{direction:"y",padding:18*n.mainData.scale,searchForClicks:!0}),a.x=0,a.y=270*n.mainData.scale,n.addChild(a),n.header=new ix,n.header.event.back.add(n.chooseBack,$L($L(n))),n.header.setDiamond(),n.addChild(n.header),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XL(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),Kr.instance().event.load_online_mode_bet_complete.add(this.buildDataRoomBet,this),!0===Kr.instance().ktLoadOnlineModeBet?this.buildDataRoomBet():Kr.instance().sendGetOnlineModeBet(),li.instance().showBanerChooseBettingQuickPlayScreen()}},{key:"buildDataRoomBet",value:function(){this.buidlListBet(),qe.instance().hideLoading()}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),Kr.instance().event.load_online_mode_bet_complete.remove(this.buildDataRoomBet,this)}},{key:"getData",value:function(e){switch(e.cmd){case _I.ONLINE_MODE_BETS_RESPONSE:}}},{key:"buidlListBet",value:function(){for(var e=Kr.instance().quickplay_bet_setting,t=0;t<e.length;t++)if(mZ.instance().dataMySeft.level>=e[t].user_level_required){var n=new yx;n.event.choose_bet.add(this.chooseBet,this),e[t].genre=this.dataGennes.genre,n.setData(e[t],t),this.listBet.add(n)}}},{key:"chooseBet",value:function(e){LogConsole.log("choose_bet"),e.dataGennes=this.dataGennes,this.mainData.dataPlayOnlineMode.bet_place=e.bet_place,mZ.instance().dataMySeft.diamond<e.bet_place?iC.instance().addDialogConfirnMoney("Bạn không đủ Kim Cương vào phòng, bạn có muốn nạp thêm?"):this.event.choose_bet.dispatch(e)}},{key:"chooseBackToGenres",value:function(){this.event.backGenres.dispatch()}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listBet.removeAll(),this.listBet.destroy(),li.instance().hideBanner(),this.removeEvent(),YL(JL(t.prototype),"destroy",this).call(this)}}])&&zL(n.prototype,i),o&&zL(n,o),t}();function tG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var nG=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t,n){var i=new SFS2X.SFSObject;return i.putInt("playlist_id",e),i.putInt("genre_id",t),i.putInt("bet_id",n),i}}],(n=null)&&tG(t.prototype,n),i&&tG(t,i),e}();function iG(e){return(iG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aG(e,t,n){return(aG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sG(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sG(e){return(sG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rG(e,t){return(rG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lG(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var hG=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,n=!(o=sG(t).call(this,game,null))||"object"!==iG(o)&&"function"!=typeof o?lG(i):o,qe.instance().showLoading(),LogConsole.log("OnlineModeListPlaylist----------------------------"),n.event={back:new Phaser.Signal,backBet:new Phaser.Signal,backGenres:new Phaser.Signal},n.positionCreateRoom=n.mainData.positionCreateRoom,n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg),n.dataBet=e,n.idDelay=null,n.idx=0,n.countItem=0,n.arrPlayerList=[],n.ktBuild=!1,n.tabTree=new qL(qL.TREE_PLAYLIST,nv.getNameRegion(n.dataBet.dataGennes.region),n.dataBet.dataGennes.genre),n.tabTree.event.backBet.add(n.chooseBackToBet,lG(lG(n))),n.tabTree.event.backGenres.add(n.chooseBackToGenres,lG(lG(n))),n.tabTree.y=100*n.mainData.scale,n.addChild(n.tabTree);var a=new Phaser.Group(game,0,0,null);return n.listPlayerlist=new Jo(game,a,new Phaser.Rectangle(0,0,game.width,game.height-205*n.mainData.scale),{direction:"y",padding:0,searchForClicks:!0}),n.listPlayerlist.events.changeIndex.add(n.changeIndex,lG(lG(n))),a.x=0,a.y=205*n.mainData.scale,n.addChild(a),n.header=new ix,n.header.event.back.add(n.chooseBack,lG(lG(n))),n.header.setDiamond(),n.addChild(n.header),n.bgSuggestPlayList=new Zt(n.positionCreateRoom.choose_playlist_itemplaylist_bg),n.bgSuggestPlayList.y=205*n.mainData.scale,n.addChild(n.bgSuggestPlayList),n.bgSuggestPlayList.x=game.width,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rG(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),Kr.instance().event.buy_playlist.add(this.buildPlayerList,this),Kr.instance().event.load_playlist_complete.add(this.buildDataPlaylist,this),!0===Kr.instance().ktLoadPlaylist?this.buildDataPlaylist():Kr.instance().sendGetDataShop(),li.instance().showBanerChoosePlaylistquickPlayScreen()}},{key:"removeEvent",value:function(){Kr.instance().event.buy_playlist.remove(this.buildPlayerList,this),mZ.instance().events.onExtensionResponse.remove(this.getData,this),Kr.instance().event.load_playlist_complete.remove(this.buildDataPlaylist,this)}},{key:"buildDataPlaylist",value:function(){this.buildPlayerList(),qe.instance().hideLoading()}},{key:"getData",value:function(e){switch(e.cmd){case _I.ONLINE_MODE_PLAYLISTS_RESPONSE:case Js.SHOP_BUY_PLAYLIST_RESPONSE:}}},{key:"buildPlayerList",value:function(){this.arrPlayerList=Kr.instance().playlist.getArrByGenresId(this.dataBet.dataGennes.id),this.arrPlayerList=this.arrPlayerList.sort(this.compareOwner),this.listPlayerlist.removeAll(),this.listPlayerlist.reset(),this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(){var e=this.listPlayerlist.getIdx();this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrPlayerList.length;e++){var t=new xx;if(t.event.buy.add(this.chooseBuy,this),t.event.select.add(this.chooseSelect,this),t.setDataQuickPlay(this.arrPlayerList[e],e),this.listPlayerlist.add(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrPlayerList.length){this.ktBuild=!1;break}this.idx===this.arrPlayerList.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"chooseBuyMore",value:function(){LogConsole.log("chooseBuyMore"),iC.instance().addShop(0)}},{key:"chooseBuy",value:function(e){iC.instance().addPopupBuy(e)}},{key:"chooseSelect",value:function(e){console.log(e),this.mainData.dataPlayOnlineMode.id=e.id,this.mainData.dataPlayOnlineMode.genre_id=this.dataBet.dataGennes.id,this.mainData.dataPlayOnlineMode.bet_id=this.dataBet.id,qe.instance().showLoading(),mZ.instance().sendData(_I.ONLINE_MODE_FIND_GAME_REQUEST,nG.begin(e.id,this.dataBet.dataGennes.id,this.dataBet.id))}},{key:"getGenres",value:function(){return this.dataBet.dataGennes}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack playlist"),this.event.back.dispatch()}},{key:"chooseBackToBet",value:function(){var e=this.dataBet.dataGennes;this.event.backBet.dispatch(e)}},{key:"chooseBackToGenres",value:function(){this.event.backGenres.dispatch()}},{key:"destroy",value:function(){this.removeDelayBuild(),this.listPlayerlist.removeAll(),this.listPlayerlist.destroy(),this.removeEvent(),this.removeAllItem(),li.instance().hideBanner(),aG(sG(t.prototype),"destroy",this).call(this)}}])&&oG(n.prototype,i),o&&oG(n,o),t}();var cG=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=0,this.code="",this.genre="",this.number_player=0,this.id=0,this.priority=0,this.region=""};function uG(e){return(uG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fG(e,t,n){return(fG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pG(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pG(e){return(pG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gG(e,t){return(gG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yG(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var mG=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=pG(t).call(this,game,null))||"object"!==uG(a)&&"function"!=typeof a?yG(o):a).event={back:new Phaser.Signal,play_again:new Phaser.Signal},i.dataJoin=e,i.dataGennes=n,i.arrPlayer=[],i.idRoom=0,i.roomBet=0,i.totalPlayerPlay=0,i.ktPlay=!1,i.ktshowBadConnection=!1,i.ktStart=!1,i.idxQuestion=0,i.arrScore=[],i.arrChart={},i.arrQuestion=[],i.timecount=0,i.ktCountDownPlay=!1,i.timeTween=null,i.timerCountDown=null,i.listSongResult=null,i.showQuestion=null,i.ktReplay=!1,i.objChat={},i.startTime=0,i.endTime=0,i.addMeAnswer=new Phaser.Sprite(game,0,0,null),i.addListChart=new Phaser.Sprite(game,0,0,null),i.checkSendExit=!1,i.arrLocal=[{x:100*z.instance().scale,y:385*z.instance().scale},{x:385*z.instance().scale,y:385*z.instance().scale},{x:100*z.instance().scale,y:690*z.instance().scale},{x:385*z.instance().scale,y:690*z.instance().scale}],i.arrLocalPlay2=[{x:206*z.instance().scale,y:223*z.instance().scale},{x:354*z.instance().scale,y:223*z.instance().scale}],i.arrLocalPlay3=[{x:114*z.instance().scale,y:223*z.instance().scale},{x:276*z.instance().scale,y:223*z.instance().scale},{x:438*z.instance().scale,y:223*z.instance().scale}],i.arrLocalPlay4=[{x:59*z.instance().scale,y:223*z.instance().scale},{x:206*z.instance().scale,y:223*z.instance().scale},{x:354*z.instance().scale,y:223*z.instance().scale},{x:495*z.instance().scale,y:223*z.instance().scale}],i.arrLocalResultWin={x:260*z.instance().scale,y:140*z.instance().scale},i.arrLocalResult2=[{x:275*z.instance().scale,y:420*z.instance().scale}],i.arrLocalResult3=[{x:185*z.instance().scale,y:420*z.instance().scale},{x:365*z.instance().scale,y:420*z.instance().scale}],i.arrLocalResult4=[{x:117*z.instance().scale,y:420*z.instance().scale},{x:275*z.instance().scale,y:420*z.instance().scale},{x:431*z.instance().scale,y:420*z.instance().scale}],i.arrLocalResultAllLose2=[{x:211*z.instance().scale,y:260*z.instance().scale},{x:355*z.instance().scale,y:260*z.instance().scale}],i.arrLocalResultAllLose3=[{x:117*z.instance().scale,y:260*z.instance().scale},{x:275*z.instance().scale,y:260*z.instance().scale},{x:431*z.instance().scale,y:260*z.instance().scale}],i.arrLocalResultAllLose4=[{x:60*z.instance().scale,y:260*z.instance().scale},{x:211*z.instance().scale,y:260*z.instance().scale},{x:355*z.instance().scale,y:260*z.instance().scale},{x:490*z.instance().scale,y:260*z.instance().scale}],i.positionCreateRoom=i.mainData.positionCreateRoom,i.bg=new Phaser.Button(game,0,0,"bg_create_room"),i.addChild(i.bg),i.header=new ix,i.header.setTitle(i.dataGennes.genre),i.header.event.back.add(i.chooseBack,yG(yG(i))),i.addChild(i.header),i.addChild(i.addListChart),i.buildListPlayer(),i.txtCounDown=new St(i.positionCreateRoom.waitting_txt_countdown,""),i.txtCounDown.anchor.set(.5),i.txtCounDown.x=game.width/2,i.addChild(i.txtCounDown),i.txtTrick=new St(i.positionCreateRoom.waitting_txt_trick,"Hãy chọn nơi có đường truyền tốt  Để tải dữ liệu"),i.txtTrick.visible=!1,i.txtTrick.addColor("#FFA339",33),i.txtTrick.setTextBounds(0,0,game.width,95*i.mainData.scale),i.txtTrick.y=game.height-95*i.mainData.scale,i.addChild(i.txtTrick),i.lbWaittinngPlayer=new St(i.positionCreateRoom.quickplay_text_player_waitting,""),i.addChild(i.lbWaittinngPlayer),i.btnMucCuoc=new ln(i.positionCreateRoom.button_muccuoc_room,"10"),i.addChild(i.btnMucCuoc),i.labelMuccuoc=new St(i.positionCreateRoom.text_muccuoc_room,"Mức cược"),i.labelMuccuoc.x=(game.width-i.labelMuccuoc.width)/2,i.addChild(i.labelMuccuoc),i.lineWin=new rt(i.positionCreateRoom.result_line_win),i.lineWin.visible=!1,i.addChild(i.lineWin),i.txtWin=new St(i.positionCreateRoom.result_txtWin_win,"Người chiến thắng !!!"),i.txtWin.setTextBounds(0,0,game.width,47*z.instance().scale),i.txtWin.visible=!1,i.addChild(i.txtWin),i.button_share=new pt(i.positionCreateRoom.button_share,i.chooseShare,yG(yG(i))),i.button_share.visible=!1,i.addChild(i.button_share,yG(yG(i))),i.buildUserJoinRoom(),i.addEvent(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gG(e,t)}(t,Mt),n=t,(i=[{key:"chooseShare",value:function(){ui.instance().share()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().events.onUserEnterRoom.add(this.userEnterRoom,this),mZ.instance().events.onUserExitRoom.add(this.userExitRoom,this),mZ.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this),mZ.instance().events.onRoomVarsUpdate.add(this.onRoomVarsUpdate,this),mZ.instance().events.onPublicMessage.add(this.onPublicMessage,this),De.instance().event.bad_connection.add(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.add(this.chooseExitBadConnection,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),mZ.instance().events.onUserEnterRoom.remove(this.userEnterRoom,this),mZ.instance().events.onUserExitRoom.remove(this.userExitRoom,this),mZ.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this),mZ.instance().events.onRoomVarsUpdate.remove(this.onRoomVarsUpdate,this),mZ.instance().events.onPublicMessage.remove(this.onPublicMessage,this),De.instance().event.bad_connection.remove(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.remove(this.chooseExitBadConnection,this)}},{key:"showBetRoom",value:function(){this.btnMucCuoc.visible=!0,this.labelMuccuoc.visible=!0}},{key:"hideBetRoom",value:function(){this.btnMucCuoc.visible=!1,this.labelMuccuoc.visible=!1}},{key:"checkBadConnection",value:function(){!1===this.ktPlay&&!1===this.ktshowBadConnection&&(this.ktshowBadConnection=!0,iC.instance().addBadConnection())}},{key:"chooseExitBadConnection",value:function(){this.chooseExit()}},{key:"onPublicMessage",value:function(e){if(LogConsole.log("onPublicMessage"),LogConsole.log(e),e.message===Et.CHAT_ONLINE_MODE){var t=e.sender,n=t.isItMe,i=parseInt(t.name);if(e.data.containsKey("label")&&e.data.containsKey("sprite"))for(var o={label:e.data.getUtfString("label"),sprite:e.data.getUtfString("sprite")},a=0,s=0;s<this.arrPlayer.length;s++)if(!1===this.arrPlayer[s].ktEmpty&&(a++,this.arrPlayer[s].getData().user_id===i)){var r=!1;r=2===this.totalPlayerPlay?1!==a:1!==a&&2!==a;var l=new AA(n,r,o);l.event.destroy.add(this.removeItemChat,this),this.addChild(l),r?(l.x=this.arrPlayer[s].x+130*z.instance().scale-l.width,l.x<0&&(l.x=0),l.y=this.arrPlayer[s].y-15*z.instance().scale):(l.x=this.arrPlayer[s].x+55*z.instance().scale,l.y=this.arrPlayer[s].y-15*z.instance().scale),this.objChat[i]=l;break}}}},{key:"removeItemChat",value:function(e){e&&(this.removeChild(e),e.destroy(),e=null)}},{key:"getData",value:function(e){switch(e.cmd){case _I.ONLINE_MODE_SERVER_QUESTIONS_SEND:if(!1===this.ktPlay){this.hideBetRoom(),this.ktStart=!1,this.resetArrayScore(),this.ktCountDownPlay=!1,this.ktPlay=!0,mZ.instance().sendLoading(1),this.hideHeader(),this.showTextTrick();for(var t=0;t<this.arrPlayer.length;t++)this.arrPlayer[t].setPlay(!0);this.arrQuestion=bT.begin(e.params)}break;case _I.ONLINE_MODE_GAME_START:li.instance().playQuickPlay(),this.startTime=this.getTime(),Le.instance().logEvent(Le.pro_quiz_start_quickplay),this.ktStart=!0,this.ktCountDownPlay=!0,this.idxQuestion=e.params.getInt(nc.question_index)-1,this.showTimeCountDown(3),iC.instance().removeUserProfile();break;case _I.ONLINE_MODE_USER_SELECTED_ANSWER_RESPONSE:this.setScorePlayer(e.params);break;case _I.ONLINE_MODE_GAME_RESULT:this.endTime=this.getTime();var n=parseInt((this.endTime-this.startTime)/1e3);Le.instance().logEvent(Le.play_time,n),Le.instance().logEvent(Le.pro_quiz_end_quickplay),this.removeShowResult(),this.idShowResult=game.time.events.add(2*Phaser.Timer.SECOND,this.showResult,this,e.params);break;case R_.ONLINE_MODE_ROOM_QUICK_JOIN_RESPONSE:}}},{key:"userEnterRoom",value:function(e){if(LogConsole.log("userEnterRoom------"),e.room.isGame){var t=e.user;LogConsole.log(t);for(var n=this.getDataPlayer(t),i=0;i<this.arrPlayer.length;i++)if(!0===this.arrPlayer[i].ktEmpty){this.arrPlayer[i].setDataQuickPlay(n,i),this.totalPlayerPlay++;break}}this.checkWaittingPlayer()}},{key:"userExitRoom",value:function(e){if(LogConsole.log("userExitRoom------ : "+e.user.isItMe),LogConsole.log(e.user),e.room.isGame)if(LogConsole.log("data.user.isItMe : "+e.user.isItMe),e.user.isItMe)this.mainData.ktPlayAgainOnlineMode?this.event.play_again.dispatch(this.dataJoin):this.event.back.dispatch();else if(null!==this.listSongResult);else{for(var t=e.user.getVariable(wa.user_id).value,n=0;n<this.arrPlayer.length;n++)if(!1===this.arrPlayer[n].ktEmpty){var i=this.arrPlayer[n].getData();if(i.user_id===t){this.ktPlay?(this.ktStart,i.user_id=-1,this.arrPlayer[n].setCurrentData(i),this.arrPlayer[n].setDisConnect()):(this.arrPlayer[n].setEmpty(),this.totalPlayerPlay--);break}}this.checkWaittingPlayer()}}},{key:"userVarsUpdate",value:function(e){var t=e.user,n=this.getDataPlayer(t);if(-1!==e.changedVars.indexOf(wa.online_mode_loaded)&&!0===this.ktPlay){var i=t.getVariable(wa.online_mode_loaded).value;LogConsole.log("perLoad : "+i);for(var o=0;o<this.arrPlayer.length;o++){var a=this.arrPlayer[o];!1===a.ktEmpty&&a.getData().user_id===n.user_id&&i>0&&a.setLoading(i)}}for(var s=0;s<this.arrPlayer.length;s++){var r=this.arrPlayer[s];if(!1===r.ktEmpty)if(r.getData().user_id==n.user_id){this.arrPlayer[s].setCurrentData(n);break}}}},{key:"onRoomVarsUpdate",value:function(){}},{key:"buildUserJoinRoom",value:function(){LogConsole.log("buildUserJoinRoom"),LogConsole.log(this.dataGennes),LogConsole.log(this.dataJoin.room);var e=this.dataJoin.room.getUserList();this.idRoom=this.dataJoin.room.id,this.mainData.modeplay=this.dataJoin.room.getVariable("mode").value,this.roomBet=this.mainData.dataPlayOnlineMode.bet_place,this.btnMucCuoc.setText(this.roomBet);for(var t=0;t<e.length;t++){var n=e[t],i=this.getDataPlayer(n);this.arrPlayer[t].setDataQuickPlay(i,t),this.totalPlayerPlay++}this.checkWaittingPlayer(),qe.instance().hideLoading()}},{key:"showResult",value:function(e){game.sound.stopAll(),this.ktReplay=!1,this.lineWin.visible=!0,this.txtWin.visible=!0,this.ktPlay=!1,aA.begin(e,this.arrPlayer);var t=[];this.arrScore[0].score>0?2===this.totalPlayerPlay?t=this.arrLocalResult2:3===this.totalPlayerPlay?t=this.arrLocalResult3:4===this.totalPlayerPlay&&(t=this.arrLocalResult4):2===this.totalPlayerPlay?t=this.arrLocalResultAllLose2:3===this.totalPlayerPlay?t=this.arrLocalResultAllLose3:4===this.totalPlayerPlay&&(t=this.arrLocalResultAllLose4);for(var n=-1,i=0,o=0,a=0,s=0;s<this.arrScore.length;s++)!1===this.arrPlayer[this.arrScore[s].idx].ktEmpty&&(0===s?this.arrScore[0].score>0?(i=this.arrLocalResultWin.x,o=this.arrLocalResultWin.y,a=.76,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!0,this.roomBet),this.removeShowResult(),this.idShowResult=game.time.events.add(.8*Phaser.Timer.SECOND,this.addEffectUserWin,this,this.arrPlayer[this.arrScore[s].idx]),this.arrPlayer[this.arrScore[s].idx].getData().user_id===mZ.instance().dataMySeft.user_id&&ce.instance().playSound(ce.winturnbasepartymode)):(i=t[++n].x,o=t[n].y,a=.61,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!1)):(i=t[++n].x,o=t[n].y,a=.61,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!1),this.arrPlayer[this.arrScore[s].idx].getData().user_id===mZ.instance().dataMySeft.user_id&&ce.instance().playSound(ce.loseturnbasepartymode)),game.add.tween(this.arrPlayer[this.arrScore[s].idx]).to({x:i,y:o},500,Phaser.Easing.Power1,!0,200),game.add.tween(this.arrPlayer[this.arrScore[s].idx].scale).to({x:a,y:a},500,Phaser.Easing.Power1,!0,200));for(var r=0;r<this.arrPlayer.length;r++)this.arrPlayer[r].setPlay(!1),!0===this.arrPlayer[r].ktDisConnect&&(this.arrPlayer[r].setEmpty(),this.totalPlayerPlay--);this.button_share.visible=!0,this.showQuestion.hideQuestion(),this.hideAnswerMe(),this.hideChart(),this.addListSongResult()}},{key:"addEffectUserWin",value:function(e){this.removeEffectWin(),this.rotationWin=new rt(this.positionCreateRoom.light_rotation_list_result),this.rotationWin.anchor.set(.5),this.addListChart.addChild(this.rotationWin),this.rotationWin.x=e.x+60*z.instance().scale,this.rotationWin.y=e.y+100*z.instance().scale,this.tweenRotationwin=game.add.tween(this.rotationWin).to({rotation:360},2e3,Phaser.Easing.Power1,!0),this.tweenRotationwin.repeat(99999,250),this.firework=new Phaser.Sprite(game,0,0,"firework"),this.firework.width=430*z.instance().scale,this.firework.height=228*z.instance().scale,this.firework.x=103*z.instance().scale,this.firework.y=106*z.instance().scale,this.firework.animations.add("playfirework"),this.firework.animations.play("playfirework",30,!0),this.addListChart.addChild(this.firework),this.ktReplay=!0,this.listSongResult.ktReplay=!0}},{key:"removeEffectWin",value:function(){if(this.addListChart.children)for(;this.addListChart.children.length>0;){var e=this.addListChart.children[0];this.addListChart.removeChild(e),e.destroy(),e=null}}},{key:"resetArrayScore",value:function(){this.arrScore=[{idx:0,score:0},{idx:1,score:0},{idx:2,score:0},{idx:3,score:0}]}},{key:"showPlayGame",value:function(){var e=this;this.hideTextTrick(),LogConsole.log("showPlayGame");var t=[];2===this.totalPlayerPlay?t=this.arrLocalPlay2:3===this.totalPlayerPlay?t=this.arrLocalPlay3:4===this.totalPlayerPlay&&(t=this.arrLocalPlay4);var n=-1;this.arrChart={};for(var i=0;i<this.arrPlayer.length;i++)if(!1===this.arrPlayer[i].ktEmpty)n++,this.arrPlayer[i].hideLoading(),this.arrPlayer[i].setTextSanSang(""),this.arrPlayer[i].setScore(0),this.arrPlayer[i].setUserPlayGame(),game.add.tween(this.arrPlayer[i]).to({x:t[n].x,y:t[n].y},400,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[i].scale).to({x:.62,y:.62},400,Phaser.Easing.Power1,!0),game.time.events.add(.4*Phaser.Timer.SECOND,this.buidlChartUser,this,this.arrPlayer[i].getData().user_id,n,i,t);else{var o=0;o=i%2==0?-this.arrPlayer[i].width-200*z.instance().scale:game.width+200*z.instance().scale,game.add.tween(this.arrPlayer[i]).to({x:o},200,Phaser.Easing.Power1,!0)}setTimeout(function(){e.buildListMeAnswer(),e.addShowQuestion(e.idxQuestion)},600)}},{key:"buidlChartUser",value:function(e,t,n,i){var o=new rI;mZ.instance().dataMySeft.user_id===e?o.addChart(!0):o.addChart(!1),o.x=i[t].x+2*z.instance().scale,o.y=i[t].y+72*z.instance().scale,o.height=0,this.addListChart.addChild(o),this.arrChart[n]=o,this.setChart(0,n)}},{key:"hideChart",value:function(){for(;this.addListChart.children.length>0;){var e=this.addListChart.children[0];this.addListChart.removeChild(e),e.destroy(),e=null}}},{key:"setChart",value:function(e,t){if(this.arrChart[t]){var n=55*z.instance().scale+200*z.instance().scale*e,i=223*z.instance().scale-200*z.instance().scale*e,o=i+72;game.add.tween(this.arrChart[t]).to({y:o,height:n},500,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[t]).to({y:i},500,Phaser.Easing.Power1,!0),this.objChat[this.arrPlayer[t].getData().user_id]&&null!=this.objChat[this.arrPlayer[t].getData().user_id]&&game.add.tween(this.objChat[this.arrPlayer[t].getData().user_id]).to({y:i-92*z.instance().scale},500,Phaser.Easing.Power1,!0)}}},{key:"setScorePlayer",value:function(e){if(LogConsole.log("setScorePlayer : "+e.getDump()),"OK"===e.getUtfString(wa.status)){LogConsole.log(1);for(var t=0;t<this.arrPlayer.length;t++)if(!1===this.arrPlayer[t].ktEmpty){LogConsole.log(2);var n=this.arrPlayer[t].getData(),i=e.getInt(wa.user_id);if(n.user_id===i){var o=e.getInt(wa.score),a=e.getBool(wa.is_correct_answer);this.arrPlayer[t].setScore(o),!0===a?this.arrPlayer[t].setTrueAnswer():this.arrPlayer[t].setFailtAnswer();for(var s=0;s<this.arrScore.length;s++)if(this.arrScore[s].idx==t){this.arrScore[s].score=o;break}break}}}this.arrScore.sort(this.compare);var r=this.arrScore[0].score;if(r>0){this.setChart(1,this.arrScore[0].idx);for(var l=1;l<this.arrScore.length;l++)!1===this.arrPlayer[this.arrScore[l].idx].ktEmpty&&this.setChart(this.arrScore[l].score/r,this.arrScore[l].idx)}}},{key:"buildListMeAnswer",value:function(){for(;this.addMeAnswer.children.length>0;){var e=this.addMeAnswer.children[0];this.addMeAnswer.removeChild(e),e.destroy(),e=null}var t=0,n=25*z.instance().scale;this.arrMeAnswer=[];for(var i=0;i<this.arrQuestion.length;i++){var o=new bI;o.x=t,o.y=n,this.addMeAnswer.addChild(o),t+=54*z.instance().scale,game.add.tween(o).to({y:0},400,Phaser.Easing.Elastic.Out,!0,30*i,1),this.arrMeAnswer.push(o)}this.addMeAnswer.y=385*z.instance().scale,this.addChild(this.addMeAnswer),this.addMeAnswer.x=(game.width-t)/2}},{key:"hideAnswerMe",value:function(){for(var e=0;e<this.arrMeAnswer.length;e++)game.add.tween(this.arrMeAnswer[e]).to({alpha:0},200,Phaser.Easing.Elastic.Out,!0)}},{key:"setMeAnswer",value:function(e){this.arrMeAnswer[e.idx].setData(e)}},{key:"setShowMeAnswerCurrent",value:function(e){this.arrMeAnswer[e].setBeginLoad()}},{key:"addShowQuestion",value:function(e){LogConsole.log("addShowQuestion"),this.removeShowQuestion(),this.setShowMeAnswerCurrent(e),this.showQuestion=new iA(this.arrQuestion,e),this.showQuestion.addEventChooseAnswer(this.setMeAnswer,this),this.showQuestion.addEventShowQuestion(this.setShowMeAnswerCurrent,this),this.showQuestion.event.close.add(this.removeShowQuestion,this),this.showQuestion.x=0,this.showQuestion.y=game.height-700*z.instance().scale,this.addChild(this.showQuestion)}},{key:"removeShowQuestion",value:function(){null!=this.showQuestion&&(this.removeChild(this.showQuestion),this.showQuestion.destroy(),this.showQuestion=null)}},{key:"addListSongResult",value:function(){this.removeListSongResult(),this.listSongResult=new kA(this.arrQuestion,this.roomBet),this.listSongResult.ktReplay=!0,this.listSongResult.event.replay.add(this.showReplayGame,this),this.listSongResult.event.close.add(this.removeListSongResult,this),this.listSongResult.event.exit.add(this.chooseExit,this),this.listSongResult.y=game.height-515*z.instance().scale,this.addChild(this.listSongResult)}},{key:"removeListSongResult",value:function(){null!==this.listSongResult&&(this.removeChild(this.listSongResult),this.listSongResult.destroy(),this.listSongResult=null)}},{key:"chooseExit",value:function(){this.mainData.ktPlayAgainOnlineMode=!1,qe.instance().showLoading(),mZ.instance().sendData(_I.ONLINE_MODE_GAME_FINISH,null)}},{key:"showReplayGame",value:function(){LogConsole.log("showReplayGame---------"),this.lineWin.visible=!1,this.txtWin.visible=!1,this.mainData.ktPlayAgainOnlineMode=!0,qe.instance().showLoading(),mZ.instance().sendData(_I.ONLINE_MODE_GAME_FINISH,null)}},{key:"showTimeCountDown",value:function(e){this.lbWaittinngPlayer.text="",this.removeTimeCountDown(),this.timecount=e,this.setTextCountDown(),this.timerCountDown=this.game.time.create(!0),this.timerEventCountDown=this.timerCountDown.loop(1e3,this.onTimerCountDown,this),this.timerCountDown.start()}},{key:"onTimerCountDown",value:function(){this.timecount--,this.setTextCountDown()}},{key:"setTextCountDown",value:function(){this.timecount>-1?(this.timecount<6&&(game.sound.stopAll(),game.sound.play("beep_audio")),this.ktCountDownPlay&&0===this.timecount?this.txtCounDown.text="Bắt đầu":this.txtCounDown.text=this.timecount,this.txtCounDown.y=this.positionCreateRoom.waitting_txt_countdown.y*z.instance().scale+80*z.instance().scale,game.add.tween(this.txtCounDown).to({y:this.positionCreateRoom.waitting_txt_countdown.y*z.instance().scale},200,Phaser.Easing.Elastic.Out,!0)):(this.ktCountDownPlay&&this.showPlayGame(),this.removeTimeCountDown())}},{key:"removeTimeCountDown",value:function(){null!==this.timerCountDown&&(game.time.events.remove(this.timerEventCountDown),this.timerEventCountDown=null,this.timerCountDown.stop(),this.timerCountDown.destroy(),this.timerCountDown=null),this.txtCounDown.text=""}},{key:"hideHeader",value:function(){this.header.setHideBtnBack(),this.header.y=0,game.add.tween(this.header).to({y:-180*z.instance().scale},300,Phaser.Easing.Power1,!0)}},{key:"showHeader",value:function(){this.header.setShowBtnBack(),this.header.y=-180*z.instance().scale,game.add.tween(this.header).to({y:0},300,Phaser.Easing.Power1,!0)}},{key:"showTextTrick",value:function(){this.txtTrick.visible=!0}},{key:"hideTextTrick",value:function(){this.txtTrick.visible=!1}},{key:"buildListPlayer",value:function(){this.arrPlayer=[];for(var e=0;e<this.arrLocal.length;e++){var t=new gT;t.setEmpty(),t.setIdx(e),t.x=e%2==0?-t.width-200*z.instance().scale:game.width+200*z.instance().scale,t.y=this.arrLocal[e].y,game.add.tween(t).to({x:this.arrLocal[e].x},250,Phaser.Easing.Power1,!0,400),this.addChild(t),this.arrPlayer.push(t)}}},{key:"getDataPlayer",value:function(e){var t=new $x;return t.user_id=e.getVariable(wa.user_id).value,t.user_name=e.getVariable(wa.user_name).value,t.avatar=e.getVariable(wa.avatar).value,t}},{key:"checkWaittingPlayer",value:function(){if(!1===this.ktPlay&&null===this.listSongResult){for(var e=4,t=0;t<this.arrPlayer.length;t++)!1===this.arrPlayer[t].ktEmpty&&e--;e>0?(this.lbWaittinngPlayer.text="Đang đợi "+e+" người chơi nữa...",this.lbWaittinngPlayer.x=(game.width-this.lbWaittinngPlayer.width)/2):(this.lbWaittinngPlayer.text="Đang tải dữ liệu...",this.lbWaittinngPlayer.x=(game.width-this.lbWaittinngPlayer.width)/2)}}},{key:"removeShowResult",value:function(){null!==this.idShowResult&&game.time.events.remove(this.idShowResult)}},{key:"chooseBack",value:function(){!1===this.ktPlay&&!1===this.checkSendExit&&(this.checkSendExit=!0,this.mainData.ktPlayAgainOnlineMode=!1,qe.instance().showLoading(),mZ.instance().sendExitRoom())}},{key:"destroy",value:function(){Dl.instance().removeAllSound(),this.removeShowResult(),this.removeEvent(),this.removeAllItem(),fG(pG(t.prototype),"destroy",this).call(this)}}])&&dG(n.prototype,i),o&&dG(n,o),t}();function vG(e){return(vG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bG(e,t){return!t||"object"!==vG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SG(e,t,n){return(SG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_G(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _G(e){return(_G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EG(e,t){return(EG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CG=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),bG(this,_G(t).call(this,game,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EG(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.chooseGenes=null,this.chooseBet=null,this.choosePlaylist=null,this.playGame=null,this.event={back:new Phaser.Signal},this.bg=new Phaser.Sprite(game,0,0,"bg-playlist"),this.addChild(this.bg),this.addChooseGenes(),Le.instance().logEvent(Le.Party_online_mode_quickplay),this.addEvent()}},{key:"getData",value:function(e){switch(e.cmd){case _I.ONLINE_MODE_FIND_GAME_RESPONSE:"FAILED"===e.params.getUtfString("status")&&this.chooseBack()}}},{key:"addEventAll",value:function(){null!==this.chooseGenes&&this.chooseGenes.addEvent(),null!==this.chooseBet&&this.chooseBet.addEvent(),null!==this.choosePlaylist&&this.choosePlaylist.addEvent()}},{key:"addChooseGenes",value:function(){this.removeChooseGenes(),this.chooseGenes=new UL,this.chooseGenes.event.back.add(this.chooseBack,this),this.chooseGenes.event.next_bet.add(this.addChooseBet,this),this.addChild(this.chooseGenes),null!==this.chooseBet?(zc.instance().beginSwitch(this.chooseBet,this.chooseGenes,!0),zc.instance().event.tweenComplete.add(this.tweenChooseBetComplete,this)):null!==this.choosePlaylist?(zc.instance().beginSwitch(this.choosePlaylist,this.chooseGenes,!0),zc.instance().event.tweenComplete.add(this.tweenChoosePlaylistComplete,this)):null!==this.playGame?(zc.instance().beginSwitch(this.playGame,this.chooseGenes,!0),zc.instance().event.tweenComplete.add(this.tweenplayGameComplete,this)):this.addEventAll()}},{key:"tweenChooseBetComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenChooseBetComplete,this),this.removeChooseBet(),this.addEventAll()}},{key:"tweenChoosePlaylistComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenChoosePlaylistComplete,this),this.removeChoosePlaylist(),this.addEventAll()}},{key:"tweenChooseGenesComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenChooseGenesComplete,this),this.removeChooseGenes(),this.addEventAll()}},{key:"tweenplayGameComplete",value:function(){zc.instance().event.tweenComplete.remove(this.tweenplayGameComplete,this),this.removePlayGame(),this.addEventAll()}},{key:"removeChooseGenes",value:function(){null!==this.chooseGenes&&(this.removeChild(this.chooseGenes),this.chooseGenes.destroy(),this.chooseGenes=null)}},{key:"addChooseBet",value:function(e){this.removeChooseBet(),this.chooseBet=new eG(e),this.chooseBet.event.back.add(this.chooseBack,this),this.chooseBet.event.choose_bet.add(this.addChoosePlaylist,this),this.chooseBet.event.backGenres.add(this.addChooseGenes,this),this.addChild(this.chooseBet),null!==this.chooseGenes?(zc.instance().beginSwitch(this.chooseGenes,this.chooseBet,!1),zc.instance().event.tweenComplete.add(this.tweenChooseGenesComplete,this)):null!==this.choosePlaylist?(zc.instance().beginSwitch(this.choosePlaylist,this.chooseBet,!0),zc.instance().event.tweenComplete.add(this.tweenChoosePlaylistComplete,this)):this.addEventAll()}},{key:"removeChooseBet",value:function(){null!==this.chooseBet&&(this.removeChild(this.chooseBet),this.chooseBet.destroy(),this.chooseBet=null)}},{key:"addChoosePlaylist",value:function(e){this.removeChoosePlaylist(),this.choosePlaylist=new hG(e),this.choosePlaylist.event.back.add(this.chooseBack,this),this.choosePlaylist.event.backGenres.add(this.addChooseGenes,this),this.choosePlaylist.event.backBet.add(this.addChooseBet,this),this.addChild(this.choosePlaylist),null!==this.chooseBet?(zc.instance().beginSwitch(this.chooseBet,this.choosePlaylist,!1),zc.instance().event.tweenComplete.add(this.tweenChooseBetComplete,this)):this.addEventAll()}},{key:"removeChoosePlaylist",value:function(){null!==this.choosePlaylist&&(this.removeChild(this.choosePlaylist),this.choosePlaylist.destroy(),this.choosePlaylist=null)}},{key:"addPlayGame",value:function(e){this.removePlayGame();var t=new cG;null!==this.choosePlaylist?(t=this.choosePlaylist.getGenres(),this.mainData.dataGennes=t):t=this.mainData.dataGennes,this.playGame=new mG(e,t),this.playGame.event.back.add(this.chooseBack,this),this.playGame.event.play_again.add(this.playAgain,this),this.addChild(this.playGame),null!==this.choosePlaylist&&(zc.instance().beginSwitch(this.choosePlaylist,this.playGame,!1),zc.instance().event.tweenComplete.add(this.tweenChoosePlaylistComplete,this)),null!==this.chooseBet&&this.removeChooseBet(),null!==this.chooseGenes&&this.removeChooseGenes()}},{key:"playAgain",value:function(){mZ.instance().sendData(_I.ONLINE_MODE_FIND_GAME_REQUEST,nG.begin(this.mainData.dataPlayOnlineMode.id,this.mainData.dataPlayOnlineMode.genre_id,this.mainData.dataPlayOnlineMode.bet_id))}},{key:"removePlayGame",value:function(){null!==this.playGame&&(this.removeChild(this.playGame),this.playGame.destroy(),this.playGame=null)}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack-quicplay"),this.event.back.dispatch()}},{key:"destroy",value:function(){this.removeEvent(),SG(_G(t.prototype),"destroy",this).call(this)}}])&&wG(n.prototype,i),o&&wG(n,o),t}();function kG(e){return(kG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OG(e,t){return!t||"object"!==kG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RG(e,t,n){return(RG="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xG(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xG(e){return(xG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TG(e,t){return(TG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var IG=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=OG(this,xG(t).call(this,game,null))).onlineModeCreateRoom=null,e.onlineModeQuikPlay=null,e.arrResource=[{type:"text",link:"img/config/positionCreateRoom.json",key:"positionCreateRoom"},{type:"atlas",link:"img/atlas/createroom.png",key:"createroom",linkJson:"img/atlas/createroom.json"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TG(e,t)}(t,pm),n=t,(i=[{key:"checkShowInvite",value:function(e){null!==this.onlineModeCreateRoom&&this.onlineModeCreateRoom.checkShowInvite(e)}},{key:"loadFileComplete",value:function(){RG(xG(t.prototype),"loadFileComplete",this).call(this),this.addEvent(),this.addOnlineModeCreateRoom()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().events.onRoomJoin.add(this.joinRoom,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),mZ.instance().events.onRoomJoin.remove(this.joinRoom,this)}},{key:"addQuickPlayGame",value:function(){this.removeQuickPlayGame(),this.onlineModeQuikPlay=new CG,this.onlineModeQuikPlay.event.back.add(this.quickPlayBackToCreateRoom,this),this.addChild(this.onlineModeQuikPlay),null!==this.onlineModeCreateRoom&&(zc.instance().beginSwitch(this.onlineModeCreateRoom,this.onlineModeQuikPlay,!1),zc.instance().event.tweenComplete.add(this.tweenCompleteCreateRoom,this))}},{key:"tweenCompleteCreateRoom",value:function(){zc.instance().event.tweenComplete.remove(this.tweenCompleteCreateRoom,this),this.removeOnlineModeCreateRoom()}},{key:"removeQuickPlayGame",value:function(){null!==this.onlineModeQuikPlay&&(this.removeChild(this.onlineModeQuikPlay),this.onlineModeQuikPlay.destroy(),this.onlineModeQuikPlay=null)}},{key:"quickPlayBackToCreateRoom",value:function(){this.addOnlineModeCreateRoom(!0)}},{key:"addOnlineModeCreateRoom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.removeOnlineModeCreateRoom(),this.onlineModeCreateRoom=new uL(e),this.onlineModeCreateRoom.event.quickplay.add(this.addQuickPlayGame,this),this.addChild(this.onlineModeCreateRoom),null!==this.onlineModeQuikPlay&&(zc.instance().beginSwitch(this.onlineModeQuikPlay,this.onlineModeCreateRoom,!0),zc.instance().event.tweenComplete.add(this.tweenCompleteQuickPlay,this))}},{key:"tweenCompleteQuickPlay",value:function(){zc.instance().event.tweenComplete.remove(this.tweenCompleteQuickPlay,this),this.removeQuickPlayGame()}},{key:"removeOnlineModeCreateRoom",value:function(){null!==this.onlineModeCreateRoom&&(this.removeChild(this.onlineModeCreateRoom),this.onlineModeCreateRoom.destroy(),this.onlineModeCreateRoom=null)}},{key:"getData",value:function(e){}},{key:"joinRoom",value:function(e){if(LogConsole.log("joinRoom"),LogConsole.log(e),e.room.isGame){var t=e.room.getVariable("mode").value;"OnlineMode"===t?null!==this.onlineModeQuikPlay?this.onlineModeQuikPlay.addPlayGame(e):(this.addQuickPlayGame(),this.onlineModeQuikPlay.addPlayGame(e)):"OnlineModeRoom"===t&&(this.mainData.dataJoinRoom=e,null!==this.onlineModeCreateRoom?this.onlineModeCreateRoom.checkDataRoom():null!==this.onlineModeQuikPlay?this.addOnlineModeCreateRoom(!0):this.addOnlineModeCreateRoom())}}},{key:"destroy",value:function(){this.removeEvent(),this.mainData.positionCreateRoomData=null,Dl.instance().removeAllSound(),RG(xG(t.prototype),"destroy",this).call(this)}}])&&PG(n.prototype,i),o&&PG(n,o),t}();function AG(e){return(AG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GG(e,t){return!t||"object"!==AG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DG(e){return(DG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MG(e,t){return(MG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var NG=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=GG(this,DG(t).call(this,game,0,0,"otherSprites","tab-friend"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward}},{key:"addRequireAndReward",value:function(e){this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.require_done.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.require_done.y*window.GameConfig.RESIZE,e.quest,this.positionQAndAConfig.scroll.require_done.configs),this.required.anchor.set(0,.5),this.addChild(this.required);var t=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.doneIcon.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.doneIcon.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.doneIcon.nameAtlas,this.positionQAndAConfig.scroll.doneIcon.nameSprite);t.anchor.set(1,0),this.addChild(t);var n=new rt(this.positionQAndAConfig.line_under);this.addChild(n)}}])&&LG(n.prototype,i),o&&LG(n,o),t}();function BG(e){return(BG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function UG(e,t){return!t||"object"!==BG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FG(e){return(FG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ZG(e,t){return(ZG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var HG=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=UG(this,FG(t).call(this,game,0,0,"otherSprites","tab-friend"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward}},{key:"addRequireAndReward",value:function(e){var t;this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.requireInitDaily.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.requireInitDaily.y*window.GameConfig.RESIZE,"".concat(e.quest," (").concat(e.achieved,"/").concat(e.required,")"),this.positionQAndAConfig.scroll.requireInitDaily.configs),this.required.anchor.set(0,.5),this.addChild(this.required),this.reward=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardDoingDaily.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoingDaily.y*window.GameConfig.RESIZE,null),"DIAMOND"==e.reward_type?t="Gem":"TICKET"==e.reward_type?t="Ticket":"SUPPORT_ITEM"==e.reward_type&&(t="Mic");var n=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardDoingDaily.diamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoingDaily.diamond.y*window.GameConfig.RESIZE,"questAndAchieveSprites",t);this.reward.addChild(n);var i=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnRewardDoingDaily.txtDiamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoingDaily.txtDiamond.y*window.GameConfig.RESIZE,e.reward,this.positionQAndAConfig.scroll.btnRewardDoingDaily.txtDiamond.configs);this.reward.addChild(i),this.addChild(this.reward);var o=new rt(this.positionQAndAConfig.line_under);this.addChild(o)}}])&&jG(n.prototype,i),o&&jG(n,o),t}();function QG(e){return(QG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function WG(e,t){return!t||"object"!==QG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qG(e){return(qG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function KG(e,t){return(KG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zG=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=WG(this,qG(t).call(this,game,0,102*window.GameConfig.RESIZE,null))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.headerScroll,e.listScroll,e.event={claimReward:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addHeaderScroll();var e=new Phaser.Group(game);e.x=0,e.y=95*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-386)*window.GameConfig.RESIZE);this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}},{key:"addHeaderScroll",value:function(){this.headerScroll=new Phaser.Sprite(game,0,0,"otherSprites","tab-list"),this.addChildInHeaderScroll(this.positionQAndAConfig.scroll.daily.header),this.addChild(this.headerScroll)}},{key:"addChildInHeaderScroll",value:function(e){var t=new Phaser.Text(game,e.txt_request.x*window.GameConfig.RESIZE,e.txt_request.y*window.GameConfig.RESIZE,e.txt_request.text,e.txt_request.configs);this.headerScroll.addChild(t);var n=new Phaser.Text(game,e.txt_reward.x*window.GameConfig.RESIZE,e.txt_reward.y*window.GameConfig.RESIZE,e.txt_reward.text,e.txt_reward.configs);n.anchor.set(1,0),this.headerScroll.addChild(n);var i=new Phaser.Sprite(game,e.line.x*window.GameConfig.RESIZE,e.line.y*window.GameConfig.RESIZE,e.line.nameAtlas,e.line.nameSprite);this.headerScroll.addChild(i)}},{key:"setQuestsAndQuestLogs",value:function(e){this.quests=e,this.addListScroll()}},{key:"addListScroll",value:function(){for(var e=0;e<this.quests.length;e++)if(LogConsole.log(this.quests[e]),this.quests[e].achieved<this.quests[e].required){var t=new HG;t.addRequireAndReward(this.quests[e]),this.listView.add(t)}else{var n=new NG;n.addRequireAndReward(this.quests[e]),this.listView.add(n)}}},{key:"destroy",value:function(){for(this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&VG(n.prototype,i),o&&VG(n,o),t}();function YG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var JG=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reward=0,this.reward_type="",this.achieved=0,this.id=0,this.quest="",this.required=0,this.quest_type=0}var t,n,i;return t=e,i=[{key:"get_daily_quest",get:function(){return"daily_quest"}}],(n=null)&&YG(t.prototype,n),i&&YG(t,i),e}();function XG(e){return(XG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $G(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eD(e,t){return!t||"object"!==XG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tD(e){return(tD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nD(e,t){return(nD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iD=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=eD(this,tD(t).call(this,game,e,n,null))).type=1,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),o.scrollScreenOnTab=null,o.signalInput=new Phaser.Signal,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"addScrollScreen",value:function(){this.scrollScreenOnTab=new zG,this.addChild(this.scrollScreenOnTab)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.DAILY_QUEST_LOAD_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleDailyQuest(e.params,function(){t.doneDailyQuestResponse()}):console.warn(e.params.getUtfString("message")))}},{key:"doneDailyQuestResponse",value:function(){this.addScrollScreen(),this.scrollScreenOnTab.setQuestsAndQuestLogs(z.instance().dailyQuestLists),Le.instance().logEvent(Le.Quest_Daily),qe.instance().hideLoading()}},{key:"show",value:function(){qe.instance().showLoading(),this.checkDailyQuestLoadRequest(),0==z.instance().isDailyQuestLoad.checking?(mZ.instance().sendData(Et.DAILY_QUEST_LOAD_REQUEST,null),z.instance().isDailyQuestLoad.checking=!0,z.instance().isDailyQuestLoad.updated=Date.now()):this.doneDailyQuestResponse(),game.add.tween(this).to({x:0},150,"Linear",!0),Le.instance().logEvent(Le.Quest_Daily)}},{key:"checkDailyQuestLoadRequest",value:function(){1==z.instance().isDailyQuestLoad.checking?Date.now()-z.instance().isDailyQuestLoad.updated<6e3?z.instance().isDailyQuestLoad.checking=!0:z.instance().isDailyQuestLoad.checking=!1:z.instance().isDailyQuestLoad.checking=!1}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300*window.GameConfig.RESIZE},150,"Linear",!0);i.start(),i.onComplete.add(function(){t.destroy()},this)}}},{key:"handleDailyQuest",value:function(e,t){z.instance().dailyQuestLists=[];for(var n=e.getSFSArray("daily_quest"),i=0;i<n.size();i++){var o=new JG,a=n.getSFSObject(i);o.reward=a.getInt("reward"),o.reward_type=a.getUtfString("reward_type"),o.achieved=a.getInt("achieved"),o.id=a.getInt("id"),o.quest=a.getUtfString("quest"),o.required=a.getInt("required"),o.quest_type=a.getInt("quest_type"),z.instance().dailyQuestLists.push(o)}t()}},{key:"destroy",value:function(){for(mZ.instance().removeEventExtension(this.onExtensionResponse,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&$G(n.prototype,i),o&&$G(n,o),t}();function oD(e){return(oD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sD(e,t){return!t||"object"!==oD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rD(e){return(rD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lD(e,t){return(lD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hD=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=sD(this,rD(t).call(this,game,0,0,"otherSprites","tab-friend"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward}},{key:"addRequireAndReward",value:function(e){var t;this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.require.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.require.y*window.GameConfig.RESIZE,e.quest,this.positionQAndAConfig.scroll.require.configs),this.required.anchor.set(0,.5),this.addChild(this.required),this.reward=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnReward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnReward.y*window.GameConfig.RESIZE,null),"DIAMOND"==e.reward_type?t="Gem":"TICKET"==e.reward_type?t="Ticket":"SUPPORT_ITEM"==e.reward_type&&(t="Mic");var n=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnReward.diamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnReward.diamond.y*window.GameConfig.RESIZE,"questAndAchieveSprites",t);this.reward.addChild(n);var i=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnReward.txtDiamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnReward.txtDiamond.y*window.GameConfig.RESIZE,e.reward,this.positionQAndAConfig.scroll.btnReward.txtDiamond.configs);this.reward.addChild(i),this.addChild(this.reward);var o=new rt(this.positionQAndAConfig.line_under);this.addChild(o)}}])&&aD(n.prototype,i),o&&aD(n,o),t}();function cD(e){return(cD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dD(e,t){return!t||"object"!==cD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fD(e){return(fD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pD(e,t){return(pD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gD=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=dD(this,fD(t).call(this,game,0,0,"questAndAchieveSprites","Tab_Quest_Dang_Lam"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward}},{key:"addRequireAndReward",value:function(e,t){var n;this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.requireInit.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.requireInit.y*window.GameConfig.RESIZE,"".concat(e.quest," (").concat(t.next_quest_archieved,"/").concat(e.required,")"),this.positionQAndAConfig.scroll.requireInit.configs),this.required.anchor.set(0,.5),this.addChild(this.required),this.reward=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardDoing.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoing.y*window.GameConfig.RESIZE,null),"DIAMOND"==e.reward_type?n="Gem":"TICKET"==e.reward_type?n="Ticket":"SUPPORT_ITEM"==e.reward_type&&(n="Mic");var i=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardDoing.diamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoing.diamond.y*window.GameConfig.RESIZE,"questAndAchieveSprites",n);this.reward.addChild(i);var o=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnRewardDoing.txtDiamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoing.txtDiamond.y*window.GameConfig.RESIZE,e.reward,this.positionQAndAConfig.scroll.btnRewardDoing.txtDiamond.configs);this.reward.addChild(o),this.addChild(this.reward)}}])&&uD(n.prototype,i),o&&uD(n,o),t}();function yD(e){return(yD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vD(e,t){return!t||"object"!==yD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wD(e){return(wD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bD(e,t){return(bD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var SD=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=vD(this,wD(t).call(this,game,0,102*window.GameConfig.RESIZE,null))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.headerScroll,e.listScroll,e.quests,e.questLogs,e.nextQuest,e.listView,e.event={claimReward:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addHeaderScroll();var e=new Phaser.Group(game);e.x=0,e.y=95*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-386)*window.GameConfig.RESIZE);this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}},{key:"addHeaderScroll",value:function(){this.headerScroll=new Phaser.Sprite(game,0,0,"otherSprites","tab-list"),this.addChildInHeaderScroll(this.positionQAndAConfig.scroll.main.header),this.addChild(this.headerScroll)}},{key:"addChildInHeaderScroll",value:function(e){var t=new Phaser.Text(game,e.txt_request.x*window.GameConfig.RESIZE,e.txt_request.y*window.GameConfig.RESIZE,e.txt_request.text,e.txt_request.configs);this.headerScroll.addChild(t);var n=new Phaser.Text(game,e.txt_reward.x*window.GameConfig.RESIZE,e.txt_reward.y*window.GameConfig.RESIZE,e.txt_reward.text,e.txt_reward.configs);n.anchor.set(1,0),this.headerScroll.addChild(n);var i=new Phaser.Sprite(game,e.line.x*window.GameConfig.RESIZE,e.line.y*window.GameConfig.RESIZE,e.line.nameAtlas,e.line.nameSprite);this.headerScroll.addChild(i)}},{key:"setQuestsAndQuestLogs",value:function(e,t,n){this.quests=e,this.questLogs=t,this.nextQuest=n,this.addListScroll()}},{key:"addListScroll",value:function(){this.listView.removeAll(),this.listView.reset();for(var e=0,t=0;t<this.quests.length;t++){for(var n=!1,i=0;i<this.questLogs.length;i++)if(this.questLogs[i].quest_id==this.quests[t].id){if(n=!0,"INIT"==this.questLogs[i].state){var o=new xt;o.addRequireAndReward(this.quests[t],this.questLogs[i].id),o.event.claimReward.add(this.claimReward,this),this.listView.add(o)}else if("REWARDED"==this.questLogs[i].state){e+=1;var a=new NG;a.addRequireAndReward(this.quests[t]),this.listView.add(a)}break}if(!1===n)if(this.quests[t].id==this.nextQuest.next_quest_id){var s=new gD;s.addRequireAndReward(this.quests[t],this.nextQuest),this.listView.add(s)}else{var r=new hD;r.addRequireAndReward(this.quests[t]),this.listView.add(r)}}e==this.listView.grp.children.length?this.listView.tweenToItem(e-1):this.listView.tweenToItem(e)}},{key:"claimReward",value:function(e,t){this.destroy(),this.event.claimReward.dispatch(e,t)}},{key:"destroy",value:function(){for(this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&mD(n.prototype,i),o&&mD(n,o),t}();function _D(e){return(_D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ED(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function CD(e,t){return!t||"object"!==_D(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kD(e){return(kD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PD(e,t){return(PD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var OD=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=CD(this,kD(t).call(this,game,e,n,null))).type=2,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),o.scrollScreenOnTab=null,o.signalInput=new Phaser.Signal,o.event={claimReward:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),mZ.instance().addEventExtension(this.onExtensionResponse,this),Kr.instance().event.load_main_quest_complete.add(this.loadMainQuestComplete,this)}},{key:"loadMainQuestComplete",value:function(){this.handleQuestMain(),this.doneQuestLoadResponse()}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"addScrollScreen",value:function(){this.removeScrollScreen(),this.scrollScreenOnTab=new SD,this.scrollScreenOnTab.event.claimReward.add(this.claimReward,this),this.addChild(this.scrollScreenOnTab)}},{key:"removeScrollScreen",value:function(){null!==this.scrollScreenOnTab&&(game.world.remove(this.scrollScreenOnTab),this.scrollScreenOnTab.destroy(),this.scrollScreenOnTab=null)}},{key:"claimReward",value:function(e,t){this.quest=e,this.quest_log_id=t,this.destroy(),this.event.claimReward.dispatch(e,t)}},{key:"show",value:function(){qe.instance().showLoading(),this.checkQuestLoadRequest(),0==z.instance().isMainQuestLoad.checking?(mZ.instance().sendData(Et.QUEST_CHECK_ACHIEVED_REQUEST,null),z.instance().isMainQuestLoad.updated=Date.now(),z.instance().isMainQuestLoad.checking=!0):(z.instance().mainQuestLists=Kr.instance().quests,z.instance().mainQuestLogLists=Kr.instance().quest_logs,mZ.instance().sendData(Et.QUEST_CHECK_ACHIEVED_REQUEST,null)),game.add.tween(this).to({x:0},150,"Linear",!0)}},{key:"checkQuestLoadRequest",value:function(){1==z.instance().isMainQuestLoad.checking?Date.now()-z.instance().isMainQuestLoad.updated<6e3?z.instance().isMainQuestLoad.checking=!0:z.instance().isMainQuestLoad.checking=!1:z.instance().isMainQuestLoad.checking=!1}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){mZ.instance().removeEventExtension(t.onExtensionResponse,t),t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300*window.GameConfig.RESIZE},150,"Linear",!0);i.start(),i.onComplete.add(function(){mZ.instance().removeEventExtension(t.onExtensionResponse,t),t.destroy()},this)}}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.QUEST_CLAIM_REWARD_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.scrollScreenOnTab.destroy(),this.scrollScreenOnTab=null):console.warn(e.params.getUtfString("message"))),e.cmd==Et.QUEST_LOAD_RESPONSE&&("OK"==e.params.getUtfString("status")||console.warn(e.params.getUtfString("message"))),e.cmd==Et.QUEST_CHECK_ACHIEVED_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleQuestLoadResponse(e.params):console.warn(e.params.getUtfString("message")))}},{key:"doneQuestLoadResponse",value:function(){this.addScrollScreen(),this.scrollScreenOnTab.setQuestsAndQuestLogs(z.instance().mainQuestLists,z.instance().mainQuestLogLists,z.instance().mainNextQuest),Le.instance().logEvent(Le.Quest_main),qe.instance().hideLoading()}},{key:"handleQuestLoadResponse",value:function(e,t){z.instance().mainQuestLists=[],z.instance().mainQuestLogLists=[],z.instance().mainNextQuest=null;var n=e.getSFSObject("next_quest");z.instance().mainNextQuest={next_quest_id:n.getInt("next_quest_id"),next_quest_archieved:n.getInt("next_quest_archieved")},1==Kr.instance().ktloadMainQuestComplete?this.loadMainQuestComplete():Kr.instance().sendGetMainQuest()}},{key:"handleQuestMain",value:function(){z.instance().mainQuestLists=Kr.instance().quests,z.instance().mainQuestLogLists=Kr.instance().quest_logs}},{key:"destroy",value:function(){for(mZ.instance().removeEventExtension(this.onExtensionResponse,this),Kr.instance().event.load_main_quest_complete.remove(this.loadMainQuestComplete,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&ED(n.prototype,i),o&&ED(n,o),t}();function RD(e){return(RD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function TD(e,t){return!t||"object"!==RD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ID(e){return(ID=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AD(e,t){return(AD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LD=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=TD(this,ID(t).call(this,game))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),i.configs=e,i.index=n,i.event={claimReward:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AD(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.medal,this.title,this.condition,this.tick,this.box,this.addMedal(this.positionQAndAConfig.achievement.medal),this.addTitle(this.positionQAndAConfig.achievement.title),this.addCondition(this.positionQAndAConfig.achievement.condition),this.paddingTitleAndCondition(),1==this.configs.is_done?"INIT"==this.configs.achievement_log.state?(this.title.setText("".concat(this.configs.title," ").concat(this.configs.current_level," (").concat(this.configs.achieved,"/").concat(this.configs.required,")")),this.addBoxClaim()):this.addTick():5==this.configs.current_level?this.addTick():this.addBox(),this.addLine(),this.checkIsDone(),this.addStar()}},{key:"addMedal",value:function(e){this.medal=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.medal.scale.set(window.GameConfig.SCALE_MEDAL*window.GameConfig.RESIZE),this.loadMedal(this.configs.medal),this.addChild(this.medal)}},{key:"loadMedal",value:function(e){if(this.medalUrl=e,game.cache.checkImageKey(this.medalUrl))this.onLoadMedalComplete();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadComplete.add(this.onLoadMedalComplete,this),t.image(this.medalUrl,this.medalUrl),t.start()}}},{key:"onLoadMedalComplete",value:function(){var e=this;game.cache.checkImageKey(this.medalUrl)&&setTimeout(function(){try{game.cache.checkImageKey(e.medalUrl)&&e&&e.medal.loadTexture(e.medalUrl)}catch(e){}},50*this.index)}},{key:"addTitle",value:function(e){this.title=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,"".concat(this.configs.title," ").concat(this.configs.current_level+1," (").concat(this.configs.achieved,"/").concat(this.configs.required,")"),e.configs),5==this.configs.current_level&&this.title.setText("".concat(this.configs.title," ").concat(this.configs.current_level," (").concat(this.configs.achieved,"/").concat(this.configs.required,")")),this.addChild(this.title)}},{key:"addCondition",value:function(e){this.condition=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.configs.condition,e.configs),this.addChild(this.condition)}},{key:"paddingTitleAndCondition",value:function(){var e=this.title.height+this.condition.height;this.title.y=(164*window.GameConfig.RESIZE-e)/2-5*window.GameConfig.RESIZE,this.condition.y=(164*window.GameConfig.RESIZE-e)/2+this.title.height+5*window.GameConfig.RESIZE}},{key:"addTick",value:function(){var e=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.tick.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.tick.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.tick.nameAtlas,this.positionQAndAConfig.achievement.tick.nameSprite);e.anchor.set(.5),this.addChild(e)}},{key:"addBox",value:function(){this.box=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.box.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box.nameAtlas,this.positionQAndAConfig.achievement.box.nameSprite),this.box.anchor.set(.5),this.box.alpha=.5,this.addIconAndTxtReward(),this.addChild(this.box)}},{key:"addIconAndTxtReward",value:function(){var e=this.addIcon(),t=this.addReward(),n=e.width+t.width;t.x=(this.box.width-n)/2-5*window.GameConfig.RESIZE-this.box.width/2,e.x=(this.box.width-n)/2+t.width+5*window.GameConfig.RESIZE-this.box.width/2,this.box.addChild(e),this.box.addChild(t)}},{key:"addIcon",value:function(){var e;return"DIAMOND"==this.configs.reward_type?e="Gem":"TICKET"==this.configs.reward_type?e="Ticket-tiny":"SUPPORT_ITEM"==this.configs.reward_type&&(e="Mic_tiny"),new Phaser.Sprite(game,0,-8*window.GameConfig.RESIZE,"defaultSource",e)}},{key:"addReward",value:function(){return new Phaser.Text(game,0,-8*window.GameConfig.RESIZE,this.configs.reward,{font:"GilroyBold",fill:"#ffffff",fontSize:18})}},{key:"addBoxClaim",value:function(){this.box=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.box_claim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box_claim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box_claim.nameAtlas,this.positionQAndAConfig.achievement.box_claim.nameSprite),this.box.anchor.set(.5),this.box.inputEnabled=!0,this.box.events.onInputUp.add(this.onClaimReward,this),this.addIconAndTxtBoxClaim(),this.addChild(this.box)}},{key:"addIconAndTxtBoxClaim",value:function(){var e=new Phaser.Text(game,this.positionQAndAConfig.achievement.box_claim.txt.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box_claim.txt.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box_claim.txt.text,this.positionQAndAConfig.achievement.box_claim.txt.configs);e.anchor.set(.5),this.box.addChild(e);var t=this.addIcon();t.y=14*window.GameConfig.RESIZE;var n=this.addReward();n.y=14*window.GameConfig.RESIZE;var i=t.width+n.width;n.x=(this.box.width-i)/2-5*window.GameConfig.RESIZE-this.box.width/2,t.x=(this.box.width-i)/2+n.width+5*window.GameConfig.RESIZE-this.box.width/2,this.box.addChild(t),this.box.addChild(n)}},{key:"onClaimReward",value:function(){this.box.inputEnabled=!1,ce.instance().playSound(ce.buttonclick),this.event.claimReward.dispatch(this.configs)}},{key:"addLine",value:function(){var e=new Phaser.Sprite(game,35*window.GameConfig.RESIZE,162*window.GameConfig.RESIZE,"defaultSource","Line");this.addChild(e)}},{key:"addStar",value:function(){"INIT"==this.configs.achievement_log.state?(this.stars=new ao(80,22,this.configs.current_level,.5),this.addChild(this.stars)):(this.stars=new ao(80,22,this.configs.current_level+1,.5),this.addChild(this.stars)),1==this.configs.current_level||2==this.configs.current_level||3==this.configs.current_level||4==this.configs.current_level||this.configs.current_level}},{key:"checkIsDone",value:function(){1==this.configs.is_done?this.alpha=1:0==this.configs.current_level?this.alpha=.4:this.alpha=1}},{key:"height",get:function(){return 164*window.GameConfig.RESIZE}}])&&xD(n.prototype,i),o&&xD(n,o),t}();function GD(e){return(GD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function MD(e,t){return!t||"object"!==GD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ND(e){return(ND=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BD(e,t){return(BD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jD=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=MD(this,ND(t).call(this,game))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.event={claimReward:new Phaser.Signal},e.listScroll,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BD(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.sendLoadAchievementRequest(),this.addEventExtension()}},{key:"addListScroll",value:function(){var e=new Phaser.Group(game);e.x=0,e.y=95*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,10,640*window.GameConfig.RESIZE,(game.height-286)*window.GameConfig.RESIZE);this.listView=new Jo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var n=0;n<z.instance().achievements.length;n++){var i=new LD(z.instance().achievements[n],n);i.event.claimReward.add(this.claimReward,this),this.listView.add(i)}}},{key:"claimReward",value:function(e){this.listView.destroy(),this.destroy(),this.event.claimReward.dispatch(e)}},{key:"sendLoadAchievementRequest",value:function(){qe.instance().showLoading(),this.checkAchievementLoadRequest(),mZ.instance().sendData(Et.ACHIEVEMENT_LOAD_REQUEST,null),z.instance().isAchievementLoad.checking=!0,z.instance().isAchievementLoad.updated=Date.now()}},{key:"checkAchievementLoadRequest",value:function(){1==z.instance().isAchievementLoad.checking?Date.now()-z.instance().isAchievementLoad.updated<6e3?z.instance().isAchievementLoad.checking=!0:z.instance().isAchievementLoad.checking=!1:z.instance().isAchievementLoad.checking=!1}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.ACHIEVEMENT_LOAD_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleAchievementResponse(e.params,function(){t.sortAchievement(function(){t.doneAchievementResponse()})}):console.warn(e.params.getUtfString("message")))}},{key:"sortAchievement",value:function(e){z.instance().achievements.sort(function(e){return"INIT"==e.achievement_log.state?-1:0}),e()}},{key:"doneAchievementResponse",value:function(){this.addListScroll(),qe.instance().hideLoading()}},{key:"handleAchievementResponse",value:function(e,t){z.instance().achievements=[];for(var n=[],i=e.getSFSArray("achievements"),o=0;o<i.size();o++){var a=i.getSFSObject(o),s=a.getInt("reward"),r=a.getUtfString("condition"),l=!1;a.containsKey("achievement_log")&&(l=!0);var h={user_id:0,achievement_id:0,created:0,id:0,state:"UNKNOWN",updated:0,level:0};if(1==l){var c=a.getSFSObject("achievement_log");h.user_id=c.getInt("user_id"),h.achievement_id=c.getInt("achievement_id"),h.created=c.getLong("created"),h.id=c.getLong("id"),h.state=c.getUtfString("state"),h.updated=c.getLong("updated"),h.level=c.getInt("level")}var u=a.getUtfString("reward_type"),d=a.getUtfString("medal"),f=a.getInt("achieved"),p=a.getInt("id"),g=a.getUtfString("title"),y=a.getInt("required"),m=a.getInt("current_level");n.push({reward:s,condition:r,is_done:l,reward_type:u,medal:d,achieved:f,id:p,title:g,required:y,achievement_log:h,current_level:m})}z.instance().achievements=n,t()}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this),this.listView.destroy()}}])&&DD(n.prototype,i),o&&DD(n,o),t}();function UD(e){return(UD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZD(e,t){return!t||"object"!==UD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HD(e){return(HD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QD(e,t){return(QD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var VD=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=ZD(this,HD(t).call(this,game,e,n,null))).type=3,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),o.scrollScreenOnTab=null,o.signalInput=new Phaser.Signal,o.event={claimReward:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addScrollScreen()}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"addScrollScreen",value:function(){this.scrollScreenOnTab=new jD,this.scrollScreenOnTab.event.claimReward.add(this.claimReward,this),this.addChild(this.scrollScreenOnTab),Le.instance().logEvent(Le.Quest_Achievement)}},{key:"claimReward",value:function(e){this.event.claimReward.dispatch(e)}},{key:"show",value:function(){game.add.tween(this).to({x:0},150,"Linear",!0)}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300*window.GameConfig.RESIZE},150,"Linear",!0);i.start(),i.onComplete.add(function(){t.destroy()},this)}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&FD(n.prototype,i),o&&FD(n,o),t}();function WD(e){return(WD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function KD(e,t){return!t||"object"!==WD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zD(e){return(zD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function YD(e,t){return(YD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var JD=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=KD(this,zD(t).call(this,game,0,175*window.GameConfig.RESIZE,null))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.tabDaily,e.tabMain,e.tabAchievement,e.lineDoc,e.event={claimReward:new Phaser.Signal,claimRewardQuest:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.typeNew,this.typeOld,this.mainQuests,this.mainQuestLogs,this.mainNextQuest,this.addBtnNavBar(),this.addLineDoc(this.positionQAndAConfig.tabUnderHeader.line_doc)}},{key:"addBtnNavBar",value:function(){this.addDailyBtn(),this.addActiveDailyBtn(),this.addMainBtn(),this.addActiveMainBtn(),this.addAchievementBtn(),this.addActiveAchievementBtn(),this.buildBtnArray()}},{key:"setMainQuestsAndQuestLogs",value:function(e,t,n){this.mainQuests=e,this.mainQuestLogs=t,this.mainNextQuest=n}},{key:"addDailyBtn",value:function(){this.dailyBtn=new Phaser.Button(game,0,0,"questAndAchieveSprites",this.onClickDailyBtn,this,null,"Tab_Menu"),this.addIcon(this.dailyBtn,this.positionQAndAConfig.tabUnderHeader.daily.disactive.icon),this.addTxt(this.dailyBtn,this.positionQAndAConfig.tabUnderHeader.daily.disactive.txt),this.addChild(this.dailyBtn)}},{key:"onClickDailyBtn",value:function(){Le.instance().logEvent(Le.Quest_Daily_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.dailyBtn,this.dailyActiveBtn),this.typeNew=1,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=1}},{key:"addActiveDailyBtn",value:function(){this.dailyActiveBtn=new Phaser.Button(game,0,0,"questAndAchieveSprites",function(){},this,null,"Tab_Menu"),this.addIcon(this.dailyActiveBtn,this.positionQAndAConfig.tabUnderHeader.daily.active.icon),this.addTxt(this.dailyActiveBtn,this.positionQAndAConfig.tabUnderHeader.daily.active.txt),this.addLineUnder(this.dailyActiveBtn,this.positionQAndAConfig.tabUnderHeader.daily.active.line),this.addChild(this.dailyActiveBtn)}},{key:"addMainBtn",value:function(){this.mainBtn=new Phaser.Button(game,215*window.GameConfig.RESIZE,0,"questAndAchieveSprites",this.onClickMainBtn,this,null,"Tab_Menu"),this.addIcon(this.mainBtn,this.positionQAndAConfig.tabUnderHeader.main.disactive.icon),this.addTxt(this.mainBtn,this.positionQAndAConfig.tabUnderHeader.main.disactive.txt),this.addChild(this.mainBtn)}},{key:"onClickMainBtn",value:function(){Le.instance().logEvent(Le.Quest_main_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.mainBtn,this.mainActiveBtn),this.typeNew=2,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=2}},{key:"addActiveMainBtn",value:function(){this.mainActiveBtn=new Phaser.Button(game,215*window.GameConfig.RESIZE,0,"questAndAchieveSprites",function(){},this,null,"Tab_Menu"),this.addIcon(this.mainActiveBtn,this.positionQAndAConfig.tabUnderHeader.main.active.icon),this.addTxt(this.mainActiveBtn,this.positionQAndAConfig.tabUnderHeader.main.active.txt),this.addLineUnder(this.mainActiveBtn,this.positionQAndAConfig.tabUnderHeader.main.active.line),this.addChild(this.mainActiveBtn)}},{key:"addAchievementBtn",value:function(){this.achievementBtn=new Phaser.Button(game,427*window.GameConfig.RESIZE,0,"questAndAchieveSprites",this.onClickAchievementBtn,this,null,"Tab_Menu"),this.addIcon(this.achievementBtn,this.positionQAndAConfig.tabUnderHeader.achievement.disactive.icon),this.addTxt(this.achievementBtn,this.positionQAndAConfig.tabUnderHeader.achievement.disactive.txt),this.addChild(this.achievementBtn)}},{key:"onClickAchievementBtn",value:function(){Le.instance().logEvent(Le.Quest_Achievement_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.achievementBtn,this.achievementActiveBtn),this.typeNew=3,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=3}},{key:"addActiveAchievementBtn",value:function(){this.achievementActiveBtn=new Phaser.Button(game,427*window.GameConfig.RESIZE,0,"questAndAchieveSprites",function(){},this,null,"Tab_Menu"),this.addIcon(this.achievementActiveBtn,this.positionQAndAConfig.tabUnderHeader.achievement.active.icon),this.addTxt(this.achievementActiveBtn,this.positionQAndAConfig.tabUnderHeader.achievement.active.txt),this.addLineUnder(this.achievementActiveBtn,this.positionQAndAConfig.tabUnderHeader.achievement.active.line),this.addChild(this.achievementActiveBtn)}},{key:"addIcon",value:function(e,t){var n=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);e.addChild(n)}},{key:"addTxt",value:function(e,t){var n=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.text,t.configs);e.addChild(n)}},{key:"addLineUnder",value:function(e,t){var n=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);e.addChild(n)}},{key:"buildBtnArray",value:function(){this.activeBtnArray=[this.dailyActiveBtn,this.mainActiveBtn,this.achievementActiveBtn],this.btnArray=[this.dailyBtn,this.mainBtn,this.achievementBtn]}},{key:"changeScreen",value:function(e,t){1==e?(Bn.switchButton(this.btnArray,this.activeBtnArray,this.dailyBtn,this.dailyActiveBtn),this.tabDaily=new iD(0,0,t),this.addChild(this.tabDaily),this.tabDaily.show(),this.hideScreen(e,t),null==t&&(this.typeOld=e)):2==e?(Bn.switchButton(this.btnArray,this.activeBtnArray,this.mainBtn,this.mainActiveBtn),this.tabMain=new OD(0,0,t),this.tabMain.addScrollScreen(this.mainQuests,this.mainQuestLogs,this.mainNextQuest),this.tabMain.event.claimReward.add(this.claimRewardQuest,this),this.addChild(this.tabMain),this.tabMain.show(),this.hideScreen(e,t),null==t&&(this.typeOld=e)):3==e&&(Bn.switchButton(this.btnArray,this.activeBtnArray,this.achievementBtn,this.achievementActiveBtn),this.tabAchievement=new VD(0,0,t),this.tabAchievement.event.claimReward.add(this.claimReward,this),this.addChild(this.tabAchievement),this.tabAchievement.show(),this.hideScreen(e,t),null==t&&(this.typeOld=e))}},{key:"claimRewardQuest",value:function(e,t){this.event.claimRewardQuest.dispatch(e,t)}},{key:"claimReward",value:function(e){this.event.claimReward.dispatch(e)}},{key:"hideScreen",value:function(e,t){1==t?this.tabDaily.hide(e):2==t?this.tabMain.hide(e):3==t&&this.tabAchievement.hide(e)}},{key:"addLineDoc",value:function(e){for(var t=1;t<3;t++){var n=new Phaser.Sprite(game,e.x*t*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite);this.addChild(n)}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&qD(n.prototype,i),o&&qD(n,o),t}();function XD(e){return(XD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $D(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eM(e,t){return!t||"object"!==XD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tM(e){return(tM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nM(e,t){return(nM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iM=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=eM(this,tM(t).call(this,game))).type=e,n.header,n.tabsUnderHeader,n.scrollGroup,n.quests=[],n.questLogs=[],n.nextQuest,n.achievementClaim,n.typeClaim=0,n.signalBack=new Phaser.Signal,n.arrResource=[{type:"text",link:"img/config/questAndAchieveConfig.json",key:"positionQAndAConfig"}],n.loadResource(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nM(e,t)}(t,Kp),n=t,(i=[{key:"onLoadFileComplete",value:function(){this.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),this.afterInit(),this.setQuestAndQuestLogs()}},{key:"afterInit",value:function(){this.addEventExtension(),this.addHeaderTab(this.positionQAndAConfig.header),this.addHeaderResources(this.positionQAndAConfig.header),qe.instance().hideLoading(),li.instance().showBanerQuestScreen()}},{key:"addHeaderResources",value:function(e){this.headerResource=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerResource),this.txtQuest,this.btnBack,this.addTxtQuest(this.positionQAndAConfig.header.txt_quest),this.addButtonBack(e.btn_back),this.txtGem,this.txtTicket,this.txtMic,this.tabGemHeader,this.tabTicketHeader,this.tabMicHeader,this.addTabGemHeader(this.positionQAndAConfig.header),this.addTabTicketHeader(this.positionQAndAConfig.header),this.addTabMicHeader(this.positionQAndAConfig.header)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.positionQAndAConfig.header.gem);this.txtGem=this.addTxtGem(this.positionQAndAConfig.header.txtResource);var n=t.width+this.txtGem.width;this.txtGem.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtGem.width+5*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(this.txtGem),this.headerResource.addChild(this.tabGemHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addTabTicketHeader",value:function(e){this.tabTicketHeader=new Phaser.Sprite(game,e.tabTicket.x*window.GameConfig.RESIZE,e.tabTicket.y*window.GameConfig.RESIZE,e.tabTicket.nameAtlas,e.tabTicket.nameSprite);var t=this.addTicket(this.positionQAndAConfig.header.ticket);this.txtTicket=this.addTxtTicket(this.positionQAndAConfig.header.txtResource);var n=t.width+this.txtTicket.width;this.txtTicket.x=(this.tabTicketHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabTicketHeader.width-n)/2+this.txtTicket.width+5*window.GameConfig.RESIZE,this.tabTicketHeader.addChild(t),this.tabTicketHeader.addChild(this.txtTicket),this.headerResource.addChild(this.tabTicketHeader)}},{key:"addTicket",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtTicket",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("ticket").value,e.configs)}},{key:"addTabMicHeader",value:function(e){this.tabMicHeader=new Phaser.Sprite(game,e.tabMic.x*window.GameConfig.RESIZE,e.tabMic.y*window.GameConfig.RESIZE,e.tabMic.nameAtlas,e.tabMic.nameSprite);var t=this.addMic(this.positionQAndAConfig.header.micro);this.txtMic=this.addTxtMic(this.positionQAndAConfig.header.txtResource);var n=t.width+this.txtMic.width;this.txtMic.x=(this.tabMicHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabMicHeader.width-n)/2+this.txtMic.width+5*window.GameConfig.RESIZE,this.tabMicHeader.addChild(t),this.tabMicHeader.addChild(this.txtMic),this.headerResource.addChild(this.tabMicHeader)}},{key:"addMic",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtMic",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,mZ.instance().socket.mySelf.getVariable("support_item").value,e.configs)}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_quest.x*window.GameConfig.RESIZE,e.tab_quest.y*window.GameConfig.RESIZE,e.tab_quest.nameAtlas,e.tab_quest.nameSprite),this.addChild(this.headerTab)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerResource.addChild(this.btnBack)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),this.removeAllChild(),WF.instance().changeScreen(Ce.MAIN_MENU),this.destroy()}},{key:"setQuestAndQuestLogs",value:function(){this.addTabsUnderHeader(this.type)}},{key:"addTxtQuest",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addTabsUnderHeader",value:function(e){this.tabsUnderHeader=new JD,this.tabsUnderHeader.changeScreen(e),this.tabsUnderHeader.event.claimReward.add(this.claimReward,this),this.tabsUnderHeader.event.claimRewardQuest.add(this.claimRewardQuest,this),this.addChild(this.tabsUnderHeader),z.instance().playScript.playing_guide==en.DONE_TURNBASE&&(this.playScript=new en,this.playScript.afterInit(),this.playScript.removeAllTut(),this.playScript.addStep6BtnReceiveInQAndA(),this.playScript.onSkipPS(),this.addChild(this.playScript))}},{key:"claimRewardQuest",value:function(e,t){this.questClaim=e,this.questClaimId=t,this.sendRequestClaimQuest()}},{key:"claimReward",value:function(e){this.achievementClaim=e,this.sendRequestClaimAchievement()}},{key:"updateVariableResource",value:function(e){var t=this;if("DIAMOND"==e.reward_type){this.txtGem.setText(mZ.instance().socket.mySelf.getVariable("diamond").value-e.reward);var n=game.add.tween(this.txtGem).to({text:mZ.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.txtGem.text=parseInt(t.txtGem.text)},this),n.onComplete.add(function(){t.checkAds()},this)}else if("TICKET"==e.reward_type){this.txtTicket.setText(mZ.instance().socket.mySelf.getVariable("ticket").value-e.reward);var i=game.add.tween(this.txtTicket).to({text:mZ.instance().socket.mySelf.getVariable("ticket").value},300,"Linear",!1);i.start(),i.onUpdateCallback(function(){t.txtTicket.text=parseInt(t.txtTicket.text)},this),i.onComplete.add(function(){t.checkAds()},this)}else if("SUPPORT_ITEM"==e.reward_type){this.txtMic.setText(mZ.instance().socket.mySelf.getVariable("support_item").value-e.reward);var o=game.add.tween(this.txtMic).to({text:mZ.instance().socket.mySelf.getVariable("support_item").value},300,"Linear",!1);o.start(),o.onUpdateCallback(function(){t.txtMic.text=parseInt(t.txtMic.text)},this),o.onComplete.add(function(){t.checkAds()},this)}}},{key:"checkAds",value:function(){z.instance().playScript.playing_guide==en.DONE_ALL&&(1==this.typeClaim?(li.instance().questTakeReward(),li.instance().showInterstitialQuestTakereward()):2==this.typeClaim&&(li.instance().achievementTakeReward(),li.instance().showInterstitialachievementTakeReward()))}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.ACHIEVEMENT_CLAIM_REWARD_RESPONSE&&"OK"==e.params.getUtfString("status")&&(this.typeClaim=2,this.tabsUnderHeader.changeScreen(3),iC.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:this.achievementClaim.reward_type,reward:this.achievementClaim.reward}),this.timeUpdateAchievement=game.time.events.add(2*Phaser.Timer.SECOND,function(){t.updateVariableResource(t.achievementClaim)},this),qe.instance().hideLoading()),e.cmd==Et.QUEST_CLAIM_REWARD_RESPONSE&&"OK"==e.params.getUtfString("status")&&(this.typeClaim=1,this.tabsUnderHeader.changeScreen(2),iC.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:this.questClaim.reward_type,reward:this.questClaim.reward}),this.timeUpdateQuest=game.time.events.add(2*Phaser.Timer.SECOND,function(){t.updateVariableResource(t.questClaim)},this),qe.instance().hideLoading(),this.timeUpdatePlayScript=game.time.events.add(3.2*Phaser.Timer.SECOND,function(){z.instance().playScript.playing_guide==en.DONE_TURNBASE&&mZ.instance().sendData(Et.PLAY_SCRIPT_DONE_GET_QUEST_REQUEST,null)}),Bn.changeQuestLogsOnClaim(this.questClaimId,Kr.instance().quest_logs),this.questClaimId=null,mZ.instance().sendData(Et.QUEST_CHECK_ACHIEVED_REQUEST,null)),e.cmd==Et.PLAY_SCRIPT_DONE_GET_QUEST_RESPONSE&&"OK"==e.params.getUtfString("status")&&(this.playScript=new en,this.playScript.afterInit(),this.playScript.addStep7CloseQAndA(),this.playScript.event.step7.add(this.cancleQuestTut,this),this.addChild(this.playScript)),e.cmd==Et.PLAY_SCRIPT_DONE_ALL_RESPONSE&&"OK"==e.params.getUtfString("status")&&(z.instance().playScript.playing_guide=en.DONE_ALL,this.playScript.destroy())}},{key:"cancleQuestTut",value:function(){ce.instance().playSound(ce.buttonclick),this.removeAllChild(),WF.instance().changeScreen(Ce.MAIN_MENU),this.destroy()}},{key:"sendRequestClaimQuest",value:function(){LogConsole.log(this.questClaim);var e=new SFS2X.SFSObject;e.putLong("quest_log_id",this.questClaimId),mZ.instance().sendData(Et.QUEST_CLAIM_REWARD_REQUEST,e),qe.instance().showLoading()}},{key:"sendRequestClaimAchievement",value:function(){LogConsole.log(this.achievementClaim);var e=new SFS2X.SFSObject;e.putLong("achievement_log_id",this.achievementClaim.achievement_log.id),mZ.instance().sendData(Et.ACHIEVEMENT_CLAIM_REWARD_REQUEST,e),qe.instance().showLoading()}},{key:"removeAllChild",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"destroy",value:function(){for(this.removeEventExtension(),li.instance().hideBanner(),game.time.events.remove(this.timeUpdateAchievement),game.time.events.remove(this.timeUpdateQuest),game.time.events.remove(this.timeUpdatePlayScript);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&$D(n.prototype,i),o&&$D(n,o),t}(),oM="Bạn được tặng 6 Playlist Mới",aM="Hãy chọn",sM="thể loại nhạc mà bạn yêu thích";function rM(e){return(rM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hM(e,t){return!t||"object"!==rM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cM(e){return(cM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uM(e,t){return(uM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dM=function(e){function t(e,n,i,o,a,s){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=hM(this,cM(t).call(this,game,0,n,i.nameAtlas,i.nameSprite))).configs=o,r.childrenGenre=a,r.index=s,r.posX=e,r.posY=n,r.choosed=o.choosed,0==r.index?r.x=-296*window.GameConfig.RESIZE:r.index%2==1?r.x=936*window.GameConfig.RESIZE:r.x=-296*window.GameConfig.RESIZE,r.signalInput=new Phaser.Signal,r.afterInit(),r}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uM(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.inputEnabled=!0,this.events.onInputUp.add(this.onClickSprite,this),this.addTicked(),this.makeTweenGenre()}},{key:"makeTweenGenre",value:function(){var e=game.add.tween(this).to({x:this.posX},500,Phaser.Easing.Back.Out,!1);setTimeout(function(){e.start()},100*this.index)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.childrenGenre.length>0?this.signalInput.dispatch({cmd:"HAS_CHILD",childrenGenre:this.childrenGenre,nameParent:this.configs.genre}):1==this.choosed?(this.destroyTicked(),this.signalInput.dispatch({cmd:"DISCHOOSED",id:this.configs.id}),this.choosed=!1):0==this.choosed&&(this.showTicked(),this.signalInput.dispatch({cmd:"CHOOSED",id:this.configs.id}),this.choosed=!0)}},{key:"addTicked",value:function(){this.tick=new Phaser.Sprite(game,223*window.GameConfig.RESIZE,103*window.GameConfig.RESIZE,"isNewUserSprites","Button_Active"),this.frameAcitve=new Phaser.Sprite(game,0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,"isNewUserSprites","Khung_Active"),1==this.choosed||(this.frameAcitve.kill(),this.tick.kill()),this.addChild(this.frameAcitve),this.addChild(this.tick)}},{key:"destroyTicked",value:function(){this.frameAcitve.kill(),this.tick.kill()}},{key:"showTicked",value:function(){this.frameAcitve.revive(),this.tick.revive()}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}}])&&lM(n.prototype,i),o&&lM(n,o),t}();function fM(e){return(fM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gM(e,t){return!t||"object"!==fM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yM(e){return(yM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mM(e,t){return(mM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vM=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gM(this,yM(t).call(this,game,e,n,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mM(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"add",value:function(e){this.addChild(e)}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&pM(n.prototype,i),o&&pM(n,o),t}();function wM(e){return(wM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SM(e,t){return!t||"object"!==wM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _M(e){return(_M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EM(e,t){return(EM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CM=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=SM(this,_M(t).call(this,game,0,249*window.GameConfig.RESIZE,null))).arrGenres=e,n.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),n.afterInit(),n.signalEvent=new Phaser.Signal,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EM(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.listViewMain,this.chooseChildrenGenre,this.fatherParentGenres=this.arrGenres.filter(function(e){return 0==e.parent}),this.addParentGenres()}},{key:"addParentGenres",value:function(){var e=this,t=new vM(0,0),n=new Phaser.Group(game,this);n.x=0,n.y=0,this.addChild(n);var i=new Phaser.Rectangle(35*window.GameConfig.RESIZE,0,570*window.GameConfig.RESIZE,(game.height-141)*window.GameConfig.RESIZE);this.listViewMain=new Jo(game,n,i,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var o=0,a=0,s=function(n){n%2==0&&n>0?(o=0,a+=window.GameConfig.CONFIGS_GENRE.y*window.GameConfig.RESIZE,t.height+=window.GameConfig.CONFIGS_GENRE.y*window.GameConfig.RESIZE):0==n?o=0:o+=window.GameConfig.CONFIGS_GENRE.x*window.GameConfig.RESIZE;var i=e.arrGenres.filter(function(t){return t.parent==e.fatherParentGenres[n].id}),s=new dM(o,a,e.positionIsNewUserConfig.chooseMain.genres[e.fatherParentGenres[n].code],e.fatherParentGenres[n],i,n);s.addEventInput(e.onClickGenreSprite,e),t.add(s)},r=0;r<this.fatherParentGenres.length;r++)s(r);this.listViewMain.add(t)}},{key:"onClickGenreSprite",value:function(e){"CHOOSED"==e.cmd?this.signalEvent.dispatch({cmd:"CHOOSED",id:e.id}):"HAS_CHILD"==e.cmd?(this.kill(),this.signalEvent.dispatch({cmd:"HAS_CHILD",childrenGenre:e.childrenGenre,nameParent:e.nameParent})):"DISCHOOSED"==e.cmd&&this.signalEvent.dispatch({cmd:"DISCHOOSED",id:e.id})}},{key:"addEvent",value:function(e,t){this.signalEvent.add(e,t)}},{key:"removeEvent",value:function(e,t){this.signalEvent.remove(e,t)}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&bM(n.prototype,i),o&&bM(n,o),t}();function kM(e){return(kM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OM(e,t){return!t||"object"!==kM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RM(e){return(RM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xM(e,t){return(xM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var TM=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=OM(this,RM(t).call(this,game))).arrGenres=e,i.genreParent=n,i.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),i.afterInit(),i.signalEvent=new Phaser.Signal,i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xM(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.listView,this.btnBack,this.txtParentGenre,this.addBtnBack(this.positionIsNewUserConfig.chooseUS_UK.btn_back),this.addTxtParentGenre(this.positionIsNewUserConfig.chooseUS_UK.txt_parent),this.addGenres()}},{key:"addBtnBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.addChild(this.btnBack)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),this.signalEvent.dispatch({type:"BACK"}),this.destroy()}},{key:"addTxtParentGenre",value:function(e){this.txtParentGenre=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.genreParent,e.configs),this.txtParentGenre.anchor.set(.5,0),this.addChild(this.txtParentGenre)}},{key:"addGenres",value:function(){var e=this,t=new vM(0,0),n=new Phaser.Group(game,this);n.x=0,n.y=0,this.addChild(n);var i=new Phaser.Rectangle(35*window.GameConfig.RESIZE,248*window.GameConfig.RESIZE,570*window.GameConfig.RESIZE,(game.height-141)*window.GameConfig.RESIZE);this.listView=new Jo(game,n,i,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var o=0,a=0,s=function(n){n%2==0&&n>0?(o=0,a+=window.GameConfig.CONFIGS_GENRE.y*window.GameConfig.RESIZE,t.height+=window.GameConfig.CONFIGS_GENRE.y*window.GameConfig.RESIZE):0==n?o=0:o+=window.GameConfig.CONFIGS_GENRE.x*window.GameConfig.RESIZE;var i=e.arrGenres.filter(function(t){return t.parent==e.arrGenres[n].id}),s=new dM(o,a,e.positionIsNewUserConfig.chooseUS_UK.genres[e.arrGenres[n].code],e.arrGenres[n],i,n);s.addEventInput(e.onClickGenreSprite,e),t.add(s)},r=0;r<this.arrGenres.length;r++)s(r);this.listView.add(t)}},{key:"onClickGenreSprite",value:function(e){"CHOOSED"==e.cmd?this.signalEvent.dispatch({cmd:"CHOOSED",id:e.id}):"HAS_CHILD"==e.cmd?(this.kill(),this.signalEvent.dispatch({cmd:"HAS_CHILD",childrenGenre:e.childrenGenre,nameParent:e.nameParent})):"DISCHOOSED"==e.cmd&&this.signalEvent.dispatch({cmd:"DISCHOOSED",id:e.id})}},{key:"addEvent",value:function(e,t){this.signalEvent.add(e,t)}},{key:"removeEvent",value:function(e,t){this.signalEvent.remove(e,t)}}])&&PM(n.prototype,i),o&&PM(n,o),t}();var IM=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.thumb="",this.name=""};function AM(e){return(AM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GM(e,t){return!t||"object"!==AM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DM(e){return(DM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MM(e,t){return(MM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var NM=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=GM(this,DM(t).call(this,game,e,n,null))).positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),a.indexSprite=o,a.genre=new IM,a.genre=Object.assign({},a.genre,i),a.thumb,a.name,a.afterInit(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MM(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addThumb(),this.addName(this.positionIsNewUserConfig.received.txt_playlist)}},{key:"addThumb",value:function(){this.thumb=new Phaser.Sprite(game,0,0,"otherSprites","Nhactre"),this.thumb.scale.set(1*window.GameConfig.RESIZE);var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawRoundedRect(0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,165*window.GameConfig.RESIZE,165*window.GameConfig.RESIZE,10),e.anchor.set(.5),this.thumb.addChild(e),this.thumb.mask=e,this.key,this.addChild(this.thumb),this.beginLoad(this.genre.thumb)}},{key:"beginLoad",value:function(e){if(e&&(this.key=e),game.cache.checkImageKey(this.key))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadComplete.add(this.onLoad,this),t.image(this.key,this.key),t.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){e.thumb.loadTexture(e.key)},100*this.indexSprite)}},{key:"addName",value:function(e){this.name=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.genre.name,e.configs),this.addChild(this.name)}}])&&LM(n.prototype,i),o&&LM(n,o),t}();function BM(e){return(BM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function UM(e,t){return!t||"object"!==BM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FM(e){return(FM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ZM(e,t){return(ZM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var HM=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=UM(this,FM(t).call(this,game))).positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),n.arrBeGiven=e,n.listView,n.btnReceive,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZM(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addListView(),this.addBtnReceive(this.positionIsNewUserConfig.received.btn_receive)}},{key:"addListView",value:function(){var e=new vM(0,0),t=new Phaser.Group(game,this);t.x=0,t.y=0,this.addChild(t);var n=new Phaser.Rectangle(35*window.GameConfig.RESIZE,249*window.GameConfig.RESIZE,569*window.GameConfig.RESIZE,(game.height-324)*window.GameConfig.RESIZE);this.listView=new Jo(game,t,n,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var i=0,o=0,a=0;a<this.arrBeGiven.length;a++){if(a%3==0&&a>0){i=0,o+=window.GameConfig.CONFIGS_PLAYLIST_RECEIVED.y*window.GameConfig.RESIZE,e.height+=window.GameConfig.CONFIGS_PLAYLIST_RECEIVED.y*window.GameConfig.RESIZE;var s=new Phaser.Sprite(game,0*window.GameConfig.RESIZE,(window.GameConfig.CONFIGS_PLAYLIST_RECEIVED.y-40)*window.GameConfig.RESIZE,"defaultSource","Line");e.addChild(s)}else 0==a?i=0:i+=window.GameConfig.CONFIGS_PLAYLIST_RECEIVED.x*window.GameConfig.RESIZE;var r=new NM(i,o,this.arrBeGiven[a],a);e.add(r)}this.listView.add(e)}},{key:"addBtnReceive",value:function(e){this.btn_receive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.btn.y)*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btn_receive.inputEnabled=!0,this.btn_receive.events.onInputUp.add(this.onClickReceived,this),this.txt_rececive,this.addTxtBtn(e),this.addChild(this.btn_receive)}},{key:"onClickReceived",value:function(){ce.instance().playSound(ce.buttonclick),this.destroy(),WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"addTxtBtn",value:function(e){this.txt_rececive=new Phaser.Text(game,this.btn_receive.width/2,this.btn_receive.height/2,e.txt_receive.text,e.txt_receive.configs),this.txt_rececive.anchor.set(.5),this.btn_receive.addChild(this.txt_rececive)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&jM(n.prototype,i),o&&jM(n,o),t}();function QM(e){return(QM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function WM(e,t){return!t||"object"!==QM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qM(e){return(qM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function KM(e,t){return(KM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zM=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=WM(this,qM(t).call(this,game))).state=e,i.positionBootConfig=n,i.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),i.countChoice=3,i.listChoicedFavorites=[],i.arrGenres=[],i.arrBeGiven=[],i.stateParams={waitingGames:[],doneGames:[],challengeGames:[]},i.chooseMain,i.chooseUS_UK,i.receivedList,i.addEventExtension(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KM(e,t)}(t,Phaser.Group),n=t,(i=[{key:"preload",value:function(){this.addBackGround(this.positionIsNewUserConfig.chooseMain),this.addTextChoose(this.positionIsNewUserConfig.chooseMain.txt_choose),this.callNewUserGenresListRequest()}},{key:"addGroupFavoriteList",value:function(e){this.arrGenres=e,this.chooseMain=new CM(this.arrGenres),this.chooseMain.addEvent(this.onEventChoosePlaylist,this),this.addChild(this.chooseMain)}},{key:"onEventChoosePlaylist",value:function(e){if("CHOOSED"==e.cmd)Le.instance().logEvent(Le.Choose_genre_Buttons),this.listChoicedFavorites.push(e.id),this.countChoice--,this.txtChoose.setText("".concat(aM," ").concat(this.countChoice," ").concat(sM)),3==this.listChoicedFavorites.length&&(this.chooseMain.destroy(),this.sendUserSelectedGenres());else if("HAS_CHILD"==e.cmd){for(var t=0;t<e.childrenGenre.length;t++){e.childrenGenre[t].choosed=!1;for(var n=0;n<this.listChoicedFavorites.length;n++)if(this.listChoicedFavorites[n]==e.childrenGenre[t].id){e.childrenGenre[t].choosed=!0;break}}this.chooseUS_UK=new TM(e.childrenGenre,e.nameParent),this.chooseUS_UK.addEvent(this.onEventChildren,this),this.addChild(this.chooseUS_UK)}else"DISCHOOSED"==e.cmd&&(this.listChoicedFavorites=this.listChoicedFavorites.filter(function(t){return t!==e.id}),this.countChoice++,this.txtChoose.setText("".concat(aM," ").concat(this.countChoice," ").concat(sM)))}},{key:"onEventChildren",value:function(e){"BACK"==e.type&&this.chooseMain.revive(),"CHOOSED"==e.cmd?(this.listChoicedFavorites.push(e.id),this.countChoice--,this.txtChoose.setText("".concat(aM," ").concat(this.countChoice," ").concat(sM)),3==this.listChoicedFavorites.length&&(this.chooseUS_UK.destroy(),this.chooseMain.destroy(),this.sendUserSelectedGenres())):"HAS_CHILD"==e.cmd?(this.chooseUS_UK=new TM(e.childrenGenre,e.nameParent),this.chooseUS_UK.addEvent(this.onEventChildren,this),this.addChild(this.chooseUS_UK)):"DISCHOOSED"==e.cmd&&(this.listChoicedFavorites=this.listChoicedFavorites.filter(function(t){return t!==e.id}),LogConsole.log(this.listChoicedFavorites),this.countChoice++,this.txtChoose.setText("".concat(aM," ").concat(this.countChoice," ").concat(sM)))}},{key:"checkIfTabHasChild",value:function(e,t){var n=this.arrGenres.filter(function(t){return t.parent==e});t(n.length>0,n)}},{key:"onClickTextGenreBeFixedByDesign",value:function(){this.tabFavoriteChild.kill(),this.grapFavoriteList.revive()}},{key:"sendUserSelectedGenres",value:function(){var e=new SFS2X.SFSObject,t=new SFS2X.SFSArray;t.addInt(this.listChoicedFavorites[0]),t.addInt(this.listChoicedFavorites[1]),t.addInt(this.listChoicedFavorites[2]),e.putSFSArray("genreIds",t),mZ.instance().sendData(Et.NEW_USER_SELECTED_GENRES_REQUEST,e),qe.instance().showLoading()}},{key:"callNewUserGenresListRequest",value:function(){this.handleParamsOnNewUserGenres()}},{key:"handleParamsOnSelectedPlaylist",value:function(e){var t=e.getSFSArray("response");if("OK"==e.getUtfString("status"))for(var n=0;n<t.size();n++){var i=t.getSFSObject(n),o=i.getUtfString("thumb"),a=i.getUtfString("name"),s=i.getInt("is_solo_mode"),r=i.getInt("id");this.arrBeGiven.push({thumb:o,name:a}),0==s&&Kr.instance().getNewPlaylist(r)}else console.warn("Response NEW_USER_SELECTED_GENRES_RESPONSE error: ".concat(e.getUtfString("message")))}},{key:"handleParamsOnNewUserGenres",value:function(){1==Kr.instance().ktLoadPlaylist?this.loadPlaylistComplete():Kr.instance().sendGetDataShop()}},{key:"addEventExtension",value:function(){Kr.instance().event.load_playlist_complete.add(this.loadPlaylistComplete,this)}},{key:"removeEventExtension",value:function(){Kr.instance().event.load_playlist_complete.remove(this.loadPlaylistComplete,this)}},{key:"loadPlaylistComplete",value:function(){this.arrGenres=Kr.instance().genres.getAll(),this.addGroupFavoriteList(this.arrGenres),qe.instance().hideLoading()}},{key:"ifHasChild",value:function(e,t){this.addTextGenreBeFixedByDesignAfter(t.id,t.valueFavorite),this.grapFavoriteList.kill(),this.addTabFavoriteChild(e)}},{key:"addBackGround",value:function(e){var t=game.add.sprite(e.bg.x*window.GameConfig.RESIZE,e.bg.y*window.GameConfig.RESIZE,e.bg.nameSprite),n=new Phaser.Sprite(game,e.line_top.x*window.GameConfig.RESIZE,e.line_top.y*window.GameConfig.RESIZE,e.line_top.nameAtlas,e.line_top.nameSprite);t.addChild(n),this.addChild(t)}},{key:"addTextChoose",value:function(e){this.txtChoose=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,"".concat(e.userChooseGenresLeft," ").concat(this.countChoice," ").concat(e.userChooseGenresRight),e.configs),this.txtChoose.anchor.set(.5,0),this.addChild(this.txtChoose)}},{key:"createListPlaylistBeChoosed",value:function(){this.txtChoose.setText(oM),this.receivedList=new HM(this.arrBeGiven),this.addChild(this.receivedList)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&VM(n.prototype,i),o&&VM(n,o),t}();function YM(e){return(YM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function XM(e,t){return!t||"object"!==YM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $M(e){return($M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eN(e,t){return(eN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tN=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=XM(this,$M(t).call(this,game))).positionBootConfig=JSON.parse(game.cache.getText("positionBootConfig")),e.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eN(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.NewUserModule=new zM(this,this.positionBootConfig),this.NewUserModule.preload(),this.addChild(this.NewUserModule)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.NEW_USER_SELECTED_GENRES_RESPONSE&&(this.NewUserModule.handleParamsOnSelectedPlaylist(e.params),this.NewUserModule.createListPlaylistBeChoosed(),qe.instance().hideLoading())}},{key:"addEventExtension",value:function(){mZ.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){mZ.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&JM(n.prototype,i),o&&JM(n,o),t}();function nN(e){return(nN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oN(e){return(oN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aN(e,t){return(aN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var rN=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=oN(t).call(this,game,null))||"object"!==nN(i)&&"function"!=typeof i?sN(n):i).event={back:new Phaser.Signal,trophy:new Phaser.Signal},e.positionEventMode=e.mainData.positionEventMode,e.bg=new pt(e.positionEventMode.header_bg_queue),e.addChild(e.bg),e.iconTrophy=new pt(e.positionEventMode.header_icon_trophy,e.chooseTrophy,sN(sN(e))),e.addChild(e.iconTrophy);var o=new Phaser.Sprite(game,0,0,"btnRankAnim");return o.width=51,o.height=50,o.x=-12,o.y=-10,o.animations.add("run_rank"),o.animations.play("run_rank",26,!0),e.iconTrophy.addChild(o),e.btnBack=new pt(e.positionEventMode.header_buttom_back,e.chooseBack,sN(sN(e))),e.btnBack.width=50*z.instance().scale,e.btnBack.height=50*z.instance().scale,e.btnBack.x=10*z.instance().scale,e.btnBack.y=10*z.instance().scale,e.addChild(e.btnBack),e.txtTitle=new St(e.positionEventMode.header_queue_text_title,""),e.txtTitle.setTextBounds(0,0,e.bg.width,e.bg.height),e.addChild(e.txtTitle),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aN(e,t)}(t,Mt),n=t,(i=[{key:"setTitle",value:function(e){this.txtTitle.text=e}},{key:"setHideBack",value:function(){this.btnBack.visible=!1}},{key:"setHideTrophy",value:function(){this.iconTrophy.visible=!1}},{key:"chooseTrophy",value:function(){LogConsole.log("chooseTrophy"),rl.instance().hide(),this.btnBack.inputEnabled=!1,this.event.trophy.dispatch()}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack"),rl.instance().hide(),this.btnBack.inputEnabled=!1,this.event.back.dispatch()}}])&&iN(n.prototype,i),o&&iN(n,o),t}();function lN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var hN=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"EVENT_MODE_LOAD_LIST_REQUEST",get:function(){return"EVENT_MODE_LOAD_LIST_REQUEST"}},{key:"EVENT_MODE_LOAD_LIST_RESPONSE",get:function(){return"EVENT_MODE_LOAD_LIST_RESPONSE"}},{key:"EVENT_MODE_JOIN_REQUEST",get:function(){return"EVENT_MODE_JOIN_REQUEST"}},{key:"EVENT_MODE_JOIN_RESPONSE",get:function(){return"EVENT_MODE_JOIN_RESPONSE"}},{key:"EVENT_MODE_PLAY_GAME_REQUEST",get:function(){return"EVENT_MODE_PLAY_GAME_REQUEST"}},{key:"EVENT_MODE_PLAY_GAME_RESPONSE",get:function(){return"EVENT_MODE_PLAY_GAME_RESPONSE"}},{key:"EVENT_MODE_QUESTION_RESPONSE",get:function(){return"EVENT_MODE_QUESTION_RESPONSE"}},{key:"EVENT_MODE_USER_READY_REQUEST",get:function(){return"EVENT_MODE_USER_READY_REQUEST"}},{key:"EVENT_MODE_USER_READY_RESPONSE",get:function(){return"EVENT_MODE_USER_READY_RESPONSE"}},{key:"EVENT_MODE_START_GAME",get:function(){return"EVENT_MODE_START_GAME"}},{key:"EVENT_MODE_START_RESPONSE",get:function(){return"EVENT_MODE_START_RESPONSE"}},{key:"EVENT_MODE_USER_SELECTED_ANSWER_REQUEST",get:function(){return"EVENT_MODE_USER_SELECTED_ANSWER_REQUEST"}},{key:"EVENT_MODE_USER_SELECTED_ANSWER_RESPONSE",get:function(){return"EVENT_MODE_USER_SELECTED_ANSWER_RESPONSE"}},{key:"EVENT_MODE_MOVE_TO_NEXT_QUESTION",get:function(){return"EVENT_MODE_MOVE_TO_NEXT_QUESTION"}},{key:"EVENT_MODE_FINISH_GAME",get:function(){return"EVENT_MODE_FINISH_GAME"}},{key:"EVENT_MODE_DONE_GAME",get:function(){return"EVENT_MODE_DONE_GAME"}},{key:"EVENT_MODE_LOAD_DISPLAY_PLAYERS",get:function(){return"EVENT_MODE_LOAD_DISPLAY_PLAYERS"}},{key:"EVENT_MODE_RANKING_REQUEST",get:function(){return"EVENT_MODE_RANKING_REQUEST"}},{key:"EVENT_MODE_RANKING_RESPONSE",get:function(){return"EVENT_MODE_RANKING_RESPONSE"}},{key:"EVENT_MODE_REWARD_NOTIFICATION",get:function(){return"EVENT_MODE_REWARD_NOTIFICATION"}},{key:"EVENT_MODE_EVENT_ENDED",get:function(){return"EVENT_MODE_EVENT_ENDED"}},{key:"EVENT_MODE_CLAIM_REWARD_REQUEST",get:function(){return"EVENT_MODE_CLAIM_REWARD_REQUEST"}},{key:"EVENT_MODE_CLAIM_REWARD_RESPONSE",get:function(){return"EVENT_MODE_CLAIM_REWARD_RESPONSE"}},{key:"EVENT_MODE_EVENT_START_BROADCAST",get:function(){return"EVENT_MODE_EVENT_START_BROADCAST"}},{key:"EVENT_MODE_NEXT_QUESTION_REQUEST",get:function(){return"EVENT_MODE_NEXT_QUESTION_REQUEST"}},{key:"EVENT_MODE_HIGHEST_ACHIEVED",get:function(){return"EVENT_MODE_HIGHEST_ACHIEVED"}},{key:"EVENT_MODE_USER_DONE_GAME_REQUEST",get:function(){return"EVENT_MODE_USER_DONE_GAME_REQUEST"}},{key:"EVENT_MODE_USER_DONE_GAME_RESPONSE",get:function(){return"EVENT_MODE_USER_DONE_GAME_RESPONSE"}},{key:"EVENT_MODE_LOAD_REQUEST",get:function(){return"EVENT_MODE_LOAD_REQUEST"}},{key:"EVENT_MODE_LOAD_RESPONSE",get:function(){return"EVENT_MODE_LOAD_RESPONSE"}}],(n=null)&&lN(t.prototype,n),i&&lN(t,i),e}();function cN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var uN=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putLong("event_id",e),t}}],(n=null)&&cN(t.prototype,n),i&&cN(t,i),e}();function dN(e){return(dN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pN(e,t){return!t||"object"!==dN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gN(e){return(gN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yN(e,t){return(yN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mN=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=pN(this,gN(t).call(this,game,null))).arrCircle=[],e.positionEventMode=e.mainData.positionEventMode,e.circleFist=new rt(e.positionEventMode.queueroom_map_circle),e.circleFist.y=85*z.instance().scale,e.lineDocFist=new rt(e.positionEventMode.queueroom_map_line_doc),e.lineDocFist.x=(e.circleFist.width-e.lineDocFist.width)/2,e.addChild(e.lineDocFist);var n=new rt(e.positionEventMode.queueroom_map_line_ngang);n.x=e.circleFist.width/2,n.y=e.circleFist.y+(e.circleFist.height-n.height)/2,e.addChild(n),e.addChild(e.circleFist),e.circleEnd=new rt(e.positionEventMode.queueroom_map_circle),e.circleEnd.x=n.x+n.width-e.circleEnd.width/2,e.circleEnd.y=e.circleFist.y,e.lineDocEnd=new rt(e.positionEventMode.queueroom_map_line_doc),e.lineDocEnd.x=e.circleEnd.x+(e.circleFist.width-e.lineDocEnd.width)/2,e.addChild(e.lineDocEnd),e.addChild(e.circleEnd);for(var i=n.width/5,o=0;o<4;o++){var a=new rt(e.positionEventMode.queueroom_map_circle_small);a.x=i*(o+1),a.y=e.circleFist.y+(e.circleFist.height-a.height)/2,e.addChild(a),e.arrCircle.push(a)}return e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yN(e,t)}(t,Mt),n=t,(i=[{key:"addLineRanking",value:function(){this.cup=new rt(this.positionEventMode.queueroom_trophy_big),this.addChild(this.cup);for(var e=0;e<this.arrCircle.length;e++)this.arrCircle[e].visible=!1;this.circleFist.visible=!1}},{key:"setIdxBegin",value:function(e){this.idx=e,e<2?this.setIdx(e):this.setHideLine()}},{key:"setLine",value:function(){this.setIdx(this.idx)}},{key:"setHideLine",value:function(){this.lineDocEnd.visible=!1,this.lineDocFist.visible=!1}},{key:"setIdx",value:function(e){this.idx=e,e%2==0?(this.lineDocEnd.visible=!0,this.lineDocFist.visible=!1):(this.lineDocEnd.visible=!1,this.lineDocFist.visible=!0)}}])&&fN(n.prototype,i),o&&fN(n,o),t}();var vN=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.question_index=0,this.user_id=0,this.user_name="",this.avatar="",this.is_dead=0};var wN=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event_id=0,this.user_id=0,this.created=0,this.user_name="",this.position=0,this.achieved=0,this.id=0,this.avatar="",this.updated=0};function bN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var SN=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t={arrUser:[],topThree:[]},n=e.getSFSArray(jr.display_players),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new vN;a.question_index=o.getInt(jr.question_index),a.user_id=o.getInt(jr.user_id),a.user_name=o.getUtfString(jr.user_name),a.avatar=o.getUtfString(jr.avatar),a.is_dead=o.getInt(jr.is_dead),t.arrUser.push(a)}for(var s=e.getSFSArray(jr.top_three),r=0;r<s.size();r++){var l=s.getSFSObject(r),h=new wN;h.user_id=l.getInt(jr.user_id),h.user_name=l.getUtfString(jr.user_name),h.achieved=l.getInt(jr.rank),h.avatar=l.getUtfString(jr.avatar),t.topThree.push(h)}return t}}],(n=null)&&bN(t.prototype,n),i&&bN(t,i),e}();function _N(e){return(_N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function CN(e,t){return!t||"object"!==_N(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kN(e){return(kN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PN(e,t){return(PN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ON=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=CN(this,kN(t).call(this,game,null))).data=null,e.positionEventMode=e.mainData.positionEventMode,e.txtUserName=new St(e.positionEventMode.queueroom_txt_username,""),e.txtUserName.setTextBounds(0,0,89*z.instance().scale,25*z.instance().scale),e.addChild(e.txtUserName),e.txtScore=new St(e.positionEventMode.queueroom_txt_score,""),e.txtScore.setTextBounds(0,0,89*z.instance().scale,25*z.instance().scale),e.addChild(e.txtScore),e.ava=new Pc,e.ava.setSize(45*z.instance().scale,45*z.instance().scale),e.ava.x=22*z.instance().scale,e.ava.y=28*z.instance().scale,e.addChild(e.ava),e.bgTopAvatar=null,e.bgTopAvataDie=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PN(e,t)}(t,Mt),n=t,(i=[{key:"setTopAvatar",value:function(e){this.bgTopAvatar=new rt(0===e?this.positionEventMode.queueroom_icon_rank1:1===e?this.positionEventMode.queueroom_icon_rank2:2===e?this.positionEventMode.queueroom_icon_rank3:this.positionEventMode.queueroom_icon_rankn),this.addChild(this.bgTopAvatar)}},{key:"setTopAvatarMe",value:function(){this.bgTopAvatar=new rt(this.positionEventMode.queueroom_icon_rankme),this.addChild(this.bgTopAvatar)}},{key:"setTopAvatarDie",value:function(){null===this.bgTopAvataDie?(this.bgTopAvatar=new rt(this.positionEventMode.queueroom_icon_maskdie),this.addChild(this.bgTopAvatar)):this.showTopAvatarDie()}},{key:"showTopAvatarDie",value:function(){this.bgTopAvatar.visible=!0}},{key:"hideTopAvatarDie",value:function(){this.bgTopAvatar.visible=!1}},{key:"hideName",value:function(){this.txtUserName.visible=!1}},{key:"showName",value:function(){this.txtUserName.visible=!0}},{key:"getData",value:function(){return this.data}},{key:"setDataRank",value:function(e,t){null===this.data?(this.ava.setAvatar(e.avatar,t),this.txtUserName.text=this.formatName(e.user_name,10),this.txtScore.text=e.achieved):(this.data.user_id!==e.user_id&&this.ava.setAvatar(e.avatar,t),this.data.user_name!==e.user_name&&(this.txtUserName.text=this.formatName(e.user_name,10)),this.data.achieved!==e.achieved&&(this.txtScore.text=e.achieved)),this.data=e}},{key:"setData",value:function(e,t){this.data=e,this.txtUserName.text=this.formatName(this.data.user_name,10),this.ava.setAvatar(e.avatar,t)}},{key:"updateData",value:function(e){this.data=e}},{key:"setNameTop",value:function(){this.txtUserName.y=0}},{key:"setNameBot",value:function(){this.txtUserName.y=79*z.instance().scale}}])&&EN(n.prototype,i),o&&EN(n,o),t}();function RN(e){return(RN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function TN(e,t){return!t||"object"!==RN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function IN(e){return(IN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AN(e,t){return(AN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LN=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=TN(this,IN(t).call(this,game,null))).positionEventMode=e.mainData.positionEventMode,e.icon=new rt(e.positionEventMode.queueroom_count_user_map),e.addChild(e.icon),e.txtCount=new St(e.positionEventMode.queueroom_count_user_text,"(99)"),e.txtCount.setTextBounds(0,0,e.constWidth,e.constHeigth),e.addChild(e.txtCount),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AN(e,t)}(t,Mt),n=t,(i=[{key:"setLeft",value:function(e){this.txtCount.changeStyle({align:"right",boundsAlignH:"right",boundsAlignV:"middle"}),this.txtCount.x=-this.constWidth-3*this.mainData.scale,this.txtCount.y=(this.icon.height-this.constHeigth)/2+3*this.mainData.scale,this.txtCount.text="("+e+")"}},{key:"setRight",value:function(e){this.txtCount.changeStyle({align:"left",boundsAlignH:"left",boundsAlignV:"middle"}),this.txtCount.x=this.icon.width+3,this.txtCount.y=(this.icon.height-this.constHeigth)/2+3*this.mainData.scale,this.txtCount.text="("+e+")"}},{key:"setTop",value:function(e){this.txtCount.changeStyle({align:"center",boundsAlignH:"center",boundsAlignV:"middle"}),this.txtCount.x=(this.icon.width-this.constWidth)/2,this.txtCount.y=-this.constHeigth,this.txtCount.text="("+e+")"}},{key:"setBottom",value:function(e){this.txtCount.changeStyle({align:"center",boundsAlignH:"center",boundsAlignV:"middle"}),this.txtCount.x=(this.icon.width-this.constWidth)/2,this.txtCount.y=this.icon.height+3,this.txtCount.text="("+e+")"}},{key:"constWidth",get:function(){return 35*z.instance().scale}},{key:"constHeigth",get:function(){return 22*z.instance().scale}}])&&xN(n.prototype,i),o&&xN(n,o),t}();function GN(e){return(GN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DN(e,t){return!t||"object"!==GN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function MN(e){return(MN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BN(e,t,n){return t&&NN(e.prototype,t),n&&NN(e,n),e}function jN(e,t){return(jN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var UN=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=DN(this,MN(t).call(this,game,null))).dataEvent=Object.assign({},new or,n),e.arrMap=[],e.arrUser=[],e.arrTop3=[],e.objUser={};var i=e.constBeginX,o=e.constBeginY,a=e.constKc;e.idxTween=2,e.idxLine=0,e.localXFinish=0,e.localYFinish=0,e.tweenMap=null,e.layoutAddMap=new Phaser.Sprite(game,0,0,null),e.layoutAddMap.y=154*z.instance().scale,e.addChild(e.layoutAddMap),e.layoutMap=new Phaser.Sprite(game,0,0,null),e.layoutMap.y=0,e.layoutAddMap.addChild(e.layoutMap),e.layoutCountPlayer=new Phaser.Sprite(game,0,0,null),e.layoutMap.addChild(e.layoutCountPlayer);for(var s=0;s<4;s++){var r=new mN;r.setIdxBegin(s),r.x=i,r.y=o,o-=a,e.layoutMap.addChild(r),e.arrMap.push(r)}e.flagIcon=new rt(e.mainData.positionEventMode.queueroom_icon_flag),e.flagIcon.visible=!1,e.layoutMap.addChild(e.flagIcon),e.lineWin=new mN,e.lineWin.addLineRanking(),e.lineWin.setHideLine(),e.lineWin.x=e.constBeginX,e.lineWin.y=0,e.addChild(e.lineWin),e.buildTop3();var l=game.add.graphics(0,0);return l.alpha=.3,l.beginFill(16724736),l.drawRect(0,0,1080*z.instance().scale,445*z.instance().scale),l.endFill(),l.y=-41*z.instance().scale,e.layoutAddMap.addChild(l),e.layoutAddMap.mask=l,e.addMe(),e.dataEvent.finish_at>0&&(e.clock=new cr,e.clock.x=18*z.instance().scale,e.clock.y=35*z.instance().scale,e.clock.setTimer(e.dataEvent.finish_at),e.addChild(e.clock)),e.countUser=new ln(e.mainData.positionEventMode.count_playing_user,"0"),e.addChild(e.countUser),e.addEvent(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jN(e,t)}(t,Mt),BN(t,[{key:"constBeginY",get:function(){return 183*z.instance().scale}},{key:"constBeginX",get:function(){return 58*z.instance().scale}},{key:"constWidthLine",get:function(){return 480*z.instance().scale}},{key:"constKc",get:function(){return 115*z.instance().scale}}]),BN(t,[{key:"getTime",value:function(){return this.clock?this.clock.getTime():0}},{key:"addMe",value:function(){this.meUser=new ON,this.meUser.setTopAvatarMe();var e=new vN;e.avatar=mZ.instance().dataMySeft.avatar,e.question_index=0,e.user_id=mZ.instance().dataMySeft.user_id,e.user_name=mZ.instance().dataMySeft.user_name,this.meUser.setData(e),this.changeLocalMe(0)}},{key:"buildHighestLocalMe",value:function(){if(this.mainData.idxHighest>0){this.flagIcon.visible=!0;var e=this.getLocalObject(this.mainData.idxHighest);this.flagIcon.x=e.x+41,this.flagIcon.y=e.y+14}else this.flagIcon.visible=!1}},{key:"changeLocalMe",value:function(e){var t=this;this.meUser.getData().question_index=e,e>1&&this.mainData.idxHighest<e-1&&(this.mainData.idxHighest=e-1),e===this.mainData.idxHighest&&(this.flagIcon.visible=!1);var n=this.getLocalObject(e);0===e?(this.meUser.x=n.x,this.meUser.y=n.y):(this.meUser.x!=this.localXFinish&&(this.meUser.x=this.localXFinish),this.meUser.y!=this.localYFinish&&(this.meUser.y=this.localYFinish)),this.localXFinish=n.x,this.localYFinish=n.y,this.layoutMap.addChild(this.meUser),game.add.tween(this.meUser).to({x:n.x,y:n.y},1e3,Phaser.Easing.Power1,!0),n.local%2!=0?this.meUser.setNameBot():this.meUser.setNameTop();var i=parseInt(e/6);this.idxLine<i&&(this.idxLine=i,this.idxLine>1&&setTimeout(function(){t.beginTween()},1200))}},{key:"buildTop3",value:function(){this.arrTop3=[];for(var e=0;e<3;e++){var t=new ON;t.setTopAvatar(e),t.setNameBot(),t.visible=!1,t.x=this.constBeginX-26+this.constWidthLine/4*(e+1),t.y=this.lineWin.y+50*z.instance().scale,this.addChild(t),this.arrTop3.push(t)}}},{key:"beginTween",value:function(){LogConsole.log("beginTween ----------------------------"),this.arrMap[this.idxTween].setLine();var e=6+6*(this.idxLine+2),t=e-7;for(var n in this.objUser)this.objUser[n].getData().question_index>t&&this.objUser[n].getData().question_index<e&&(this.objUser[n].visible=!0);LogConsole.log("this.idxLine : "+this.idxLine);var i=this.idxTween-2;i<0&&(i=this.arrMap.length+i),this.tweenMap=game.add.tween(this.layoutMap).to({y:this.constKc*(this.idxLine-1)},2e3,Phaser.Easing.Power1,!0),this.tweenMap.onComplete.add(this.onCompleteTweenMap,this),game.add.tween(this.arrMap[i]).to({alpha:0},1500,Phaser.Easing.Power1,!0)}},{key:"onCompleteTweenMap",value:function(){LogConsole.log("onCompleteTweenMap"+this.idxLine);var e=this.idxTween-2;e<0&&(e=this.arrMap.length+e),this.arrMap[e].y=this.constBeginY-(this.idxLine+2)*this.constKc,this.arrMap[e].alpha=1,this.arrMap[e].setHideLine(),this.idxTween++,this.idxTween===this.arrMap.length&&(this.idxTween=0);var t=6+6*(this.idxLine-1);for(var n in this.objUser)this.objUser[n].getData().question_index<t&&(this.objUser[n].visible=!1)}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),-1===this.mainData.idxHighest||this.buildHighestLocalMe()}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case hN.EVENT_MODE_LOAD_DISPLAY_PLAYERS:var t=SN.begin(e.params);this.arrUser=t.arrUser,this.topThree=t.topThree,this.countUser.setText(e.params.getInt("number_user")),this.buildArrUser();break;case hN.EVENT_MODE_START_GAME:case hN.EVENT_MODE_MOVE_TO_NEXT_QUESTION:this.changeLocalMe(e.params.getInt(jr.question_index));break;case hN.EVENT_MODE_HIGHEST_ACHIEVED:this.mainData.idxHighest=e.params.getInt(jr.highest_achieved),this.buildHighestLocalMe()}}},{key:"getLocalObject",value:function(e){var t={local:0,x:0,y:0,vc:0};t.vc=parseInt(e/6),t.local=e%6;var n=this.constWidthLine/5;return t.vc%2==0?t.x=this.constBeginX-30*z.instance().scale+n*t.local:t.x=this.constBeginX-30*z.instance().scale+this.constWidthLine-n*t.local,this.line=parseInt(e/6),t.y=this.constBeginY+6*z.instance().scale-this.constKc*t.vc+42*z.instance().scale,t}},{key:"buildArrUser",value:function(){LogConsole.log("buildArrUser----------");for(var e=0;e<this.topThree.length;e++)this.arrTop3[e]&&(null===this.arrTop3[e].getData()&&(this.arrTop3[e].visible=!0),this.arrTop3[e].setDataRank(this.topThree[e],e));var t=6+6*(this.idxLine+1),n=6+6*(this.idxLine-2)-1;for(var i in LogConsole.log("beginLocal : "+n),LogConsole.log("endLocal : "+t),LogConsole.log(this.arrUser),this.objUser){var o=this.objUser[i];1===o.getData().is_dead&&(this.layoutMap.removeChild(o),o.destroy(),o=null,delete this.objUser[i])}for(var a={},s=0,r=null,l=0,h=0;h<this.arrUser.length;h++){if(this.objUser.hasOwnProperty(this.arrUser[h].user_id)){s=this.objUser[this.arrUser[h].user_id].getData().question_index;var c=this.arrUser[h].question_index;if(LogConsole.log("user_id : "+this.arrUser[h].user_id),LogConsole.log("question_obj_user : "+s),LogConsole.log("question_index_to : "+c),s<c){r=this.objUser[this.arrUser[h].user_id];var u=c-s;LogConsole.log("lengthQuestion : "+u);for(var d=0;d<u;d++){var f=2e3/u;game.time.events.add(f*d,this.buildLocalTween,this,r,s+d+1,f)}r.updateData(this.arrUser[h])}else{var p=this.getLocalObject(s);(r=this.objUser[this.arrUser[h].user_id]).x=p.x,r.y=p.y,p.local%2!=0?r.setNameBot():r.setNameTop(),LogConsole.log("this.arrUser[i].is_dead : "+this.arrUser[h].is_dead),1===this.arrUser[h].is_dead&&r.setTopAvatarDie(),r.updateData(this.arrUser[h])}}else{l++,this.objUser[this.arrUser[h].user_id]=new ON,(r=this.objUser[this.arrUser[h].user_id]).setTopAvatar(4),r.setData(this.arrUser[h],l);var g=this.arrUser[h].question_index,y=this.getLocalObject(g);r.x=y.x,r.y=y.y,y.local%2!=0?r.setNameBot():r.setNameTop(),this.layoutMap.addChild(r),r.visible=!1,r.setData(this.arrUser[h])}s=(r=this.objUser[this.arrUser[h].user_id]).getData().question_index,this.idxLine<2?r.visible=!(s>17):r.visible=s<t&&s>n,a[s]?(a[s]+=1,r.hideName()):(a[s]=1,this.meUser.getData().question_index===s?r.hideName():r.showName())}for(a[this.meUser.getData().question_index]?a[this.meUser.getData().question_index]+=1:a[this.meUser.getData().question_index]=1;this.layoutCountPlayer.children.length>0;){var m=this.layoutCountPlayer.children[0];this.layoutCountPlayer.removeChild(m),m.destroy(),m=null}for(var v in LogConsole.log(a),a){LogConsole.log("q_index : "+v);var w=!0;if(this.idxLine<2?v>17&&(w=!1):v<t&&v>n||(w=!1),LogConsole.log("ktShow : "+w),w&&a[v]>1){var b=this.getLocalObject(v),S=new LN;LogConsole.log("objLocal[q_index] : "+a[v]),S.x=b.x,S.y=b.y,b.vc%2==0?0===b.local?(S.setBottom(a[v]),S.x=b.x-15*z.instance().scale,S.y=b.y+35*z.instance().scale):5===b.local?(S.setBottom(a[v]),S.y=b.y+35*z.instance().scale,S.x=b.x+77*z.instance().scale):(S.setRight(a[v]),S.x=b.x+18*z.instance().scale,b.local%2!=0?S.y=b.y+6*z.instance().scale:S.y=b.y+80*z.instance().scale):0===b.local?(S.setBottom(a[v]),S.y=b.y+35*z.instance().scale,S.x=b.x+77*z.instance().scale):5===b.local?(S.setBottom(a[v]),S.x=b.x-15*z.instance().scale,S.y=b.y+35*z.instance().scale):(S.setRight(a[v]),S.x=b.x+18*z.instance().scale,b.local%2!=0?S.y=b.y+6*z.instance().scale:S.y=b.y+80*z.instance().scale),this.layoutCountPlayer.addChild(S)}}this.layoutMap.addChild(this.meUser)}},{key:"buildLocalTween",value:function(e,t,n){var i=this.getLocalObject(t);game.add.tween(e).to({x:i.x,y:i.y},n,Phaser.Easing.Power1,!0),i.local%2!=0?e.setNameBot():e.setNameTop()}},{key:"destroy",value:function(){this.removeEvent(),this.removeAllItem()}}]),t}();function FN(e){return(FN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function HN(e,t){return!t||"object"!==FN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function QN(e,t,n){return(QN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=VN(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function VN(e){return(VN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WN(e,t){return(WN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qN=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=HN(this,VN(t).call(this,e,n,i))).positionEventMode=z.instance().positionEventMode,o.iconTicket=new rt(o.positionEventMode.queueroom_button_play_icon_ticket),o.addChild(o.iconTicket),o.lbPlay=new St(o.positionEventMode.queueroom_button_play_text_play,"CHƠI"),o.lbPlay.setTextBounds(0,0,570*z.instance().scale,43*z.instance().scale),o.addChild(o.lbPlay),o.txtCount=new St(o.positionEventMode.queueroom_button_play_count_ticket,"-1("+mZ.instance().dataMySeft.ticket+")"),o.txtCount.setTextBounds(0,0,85*z.instance().scale,43*z.instance().scale),o.addChild(o.txtCount),o.addEvent(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WN(e,t)}(t,pt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this)}},{key:"userVarsUpdate",value:function(){this.txtCount.text="-1("+mZ.instance().dataMySeft.ticket+")"}},{key:"destroy",value:function(){this.removeEvent(),QN(VN(t.prototype),"destroy",this).call(this)}}])&&ZN(n.prototype,i),o&&ZN(n,o),t}();function KN(e){return(KN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function YN(e){return(YN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function JN(e,t){return(JN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var $N=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=YN(t).call(this,game,null))||"object"!==KN(i)&&"function"!=typeof i?XN(n):i).data=null,e.positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),e.ava=new Pc,e.ava.setSize(47*z.instance().scale,47*z.instance().scale),e.ava.x=35*z.instance().scale,e.ava.y=6*z.instance().scale,e.addChild(e.ava),e.btnMaskAva=new Phaser.Button(game,e.ava.x,e.ava.y,null,e.chooseAva,XN(XN(e))),e.btnMaskAva.width=e.ava.width,e.btnMaskAva.height=e.ava.height,e.addChild(e.btnMaskAva),e.txtChat=new St(e.positionEventMode.queueroom_text_chat,"aaaaaaaaaaaaaaaaaaaa"),e.txtChat.setTextBounds(0,0,450*z.instance().scale,55*z.instance().scale),e.addChild(e.txtChat),e.txtTime=new St(e.positionEventMode.queueroom_text_chat_time,""),e.txtTime.setTextBounds(0,0,518*z.instance().scale,55*z.instance().scale),e.addChild(e.txtTime),e.line=new rt(e.positionEventMode.item_ranking_line_space),e.line.y=69*z.instance().scale,e.addChild(e.line),e.silentchat=e.mainData.silentchat,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JN(e,t)}(t,Mt),n=t,(i=[{key:"chooseAva",value:function(){console.log("clickAva"),rl.instance().hide(),iC.instance().addUserProfile(this.data.user_id)}},{key:"setData",value:function(e,t){this.data=e,console.log(e),this.ava.setAvatar(e.avatar,t);for(var n=e.message,i=0;i<this.silentchat.length;i++)n.indexOf(this.silentchat[i])>-1&&(console.log("--------------------"),n=n.replace(this.silentchat[i],"***"));this.txtChat.text=e.user_name+": "+n,this.txtChat.addColor("#ffa33a",0),this.txtChat.addColor("#ffffff",e.user_name.length);var o=new Date(e.sent_at),a=o.getHours(),s=o.getMinutes(),r="00",l="00";r=a>9?a:"0"+a,l=s>9?s:"0"+s,this.txtTime.text=r+":"+l}},{key:"height",get:function(){return 71*z.instance().scale}}])&&zN(n.prototype,i),o&&zN(n,o),t}();function eB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var tB=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){var n=new SFS2X.SFSObject;return n.putLong("event_id",e),n.putLong("time",t),n}}],(n=null)&&eB(t.prototype,n),i&&eB(t,i),e}();function nB(e){return(nB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iB(e,t,n){return(iB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oB(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oB(e){return(oB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sB(e,t,n){return t&&aB(e.prototype,t),n&&aB(e,n),e}function rB(e,t){return(rB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var hB=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=oB(t).call(this,game,null))||"object"!==nB(o)&&"function"!=typeof o?lB(i):o).arrChat=[],n.ktShowAll=!1,n.positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),n.loading=null,n.event_id=e,n.listChat=null,n.config={debug:!1,host:"yan.gamezoka.com",port:8460,useSSL:!0,zone:"MusicChat"},null!==n.mainData.response&&n.mainData.response.hasOwnProperty("sfs_chat_info")&&(n.config.debug=n.mainData.response.sfs_chat_info.sfs_chat_debug,n.config.host=n.mainData.response.sfs_chat_info.sfs_chat_host,n.config.port=n.mainData.response.sfs_chat_info.sfs_chat_port,n.config.useSSL=n.mainData.response.sfs_chat_info.sfs_chat_ssl,n.config.zone=n.mainData.response.sfs_chat_info.sfs_chat_zone),n.bg=new Zt(n.positionEventMode.queueroom_bg_chat),n.addChild(n.bg),n.btnShowChat=new pt(n.positionEventMode.queueroom_button_showchat,n.chooseShowchat,lB(lB(n))),n.btnShowChat.anchor.x=.5,n.btnShowChat.anchor.y=.5,n.addChild(n.btnShowChat),n.buildSortChat(),n.btnInputText=new ln(n.positionEventMode.queueroom_button_input_chat,"Bình luận...",n.chooseChat,lB(lB(n))),n.btnInputText.y=game.height-226*n.mainData.scale,n.addChild(n.btnInputText),n.btnSend=new pt(n.positionEventMode.queueroom_button_send_chat,n.chooseSend,lB(lB(n))),n.btnSend.y=game.height-226*n.mainData.scale,n.addChild(n.btnSend),n.socket=new SFS2X.SmartFox(n.config),n.connect(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rB(e,t)}(t,Mt),sB(t,null,[{key:"EVENT_JOIN_CHAT",get:function(){return"EVENT_JOIN_CHAT"}},{key:"EVENT_USER_LOAD_MESSAGE",get:function(){return"EVENT_USER_LOAD_MESSAGE"}},{key:"EVENT_USER_SEND_MESSAGE",get:function(){return"EVENT_USER_SEND_MESSAGE"}},{key:"EVENT_CHAT_MESSAGE_BROADCAST",get:function(){return"EVENT_CHAT_MESSAGE_BROADCAST"}},{key:"USER_JOIN_CHAT_ROOM_SUCCESS",get:function(){return"USER_JOIN_CHAT_ROOM_SUCCESS"}}]),sB(t,[{key:"chooseChat",value:function(){this.addKeyBoard()}},{key:"chooseSend",value:function(){this.onSubmit()}},{key:"addKeyBoard",value:function(){console.log("addKeyBoard--------");var e={maxLength:"",showTransparent:!0,placeholder:"Bình luận...",isSearch:!1,typeInputText:"input",configText:{width:this.btnInputText.width,height:this.btnInputText.height,x:this.btnInputText.x,y:this.btnInputText.y}};rl.instance().show(e)}},{key:"onSubmit",value:function(){var e=rl.instance().getValue();if(""!=e){var n=new SFS2X.SFSObject;n.putUtfString("message",e),n.putLong("event_id",this.event_id),this.sendData(t.EVENT_USER_SEND_MESSAGE,n)}rl.instance().setValue("")}},{key:"onCancel",value:function(){console.log("onCancel -----------------"),rl.instance().hide(),this.btnInputText.visible=!0}},{key:"hideKeyboard",value:function(){console.log("hideKeyboard ----------------------"),rl.instance().hide(),this.ktShowAll?this.buildMaxChat():this.buildSortChat()}},{key:"changeHeightKeyBoard",value:function(e){this.removeListView(),this.btnShowChat.visible=!1;var t={maxLength:"",showTransparent:!0,placeholder:"Bình luận...",isSearch:!1,typeInputText:"chat",configText:{width:this.btnInputText.width,height:this.btnInputText.height,x:this.btnInputText.x,y:this.btnInputText.y}};rl.instance().show(t),this.bg.y=61,this.bg.height=game.height-61,this.btnShowChat.scale.y=1,this.btnShowChat.x=this.bg.width/2,this.btnShowChat.y=this.bg.y+18*z.instance().scale;var n=new Phaser.Group(game,0,0,null);this.listChat=new Jo(game,n,new Phaser.Rectangle(0,0,game.width,game.height-e-61),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),n.x=0,n.y=61,this.addChild(n);for(var i=0;i<this.arrChat.length;i++)this.addItemChat(this.arrChat[i],i);this.arrChat.length>4&&this.listChat.tweenToItem(this.arrChat.length-1)}},{key:"changeKeyBoard",value:function(){}},{key:"removeListView",value:function(){null!==this.listChat&&(this.removeChild(this.listChat),this.listChat.removeAll(),this.listChat.destroy(),this.listChat=null)}},{key:"chooseShowchat",value:function(){this.ktShowAll?this.buildSortChat():this.buildMaxChat()}},{key:"buildSortChat",value:function(){this.ktShowAll=!1,this.removeListView(),this.btnShowChat.visible=!0,this.bg.y=this.positionEventMode.queueroom_bg_chat.y*z.instance().scale,this.bg.height=game.height-535*z.instance().scale,this.btnShowChat.scale.y=1,this.btnShowChat.x=this.bg.width/2,this.btnShowChat.y=this.bg.y+18*z.instance().scale;var e=new Phaser.Group(game,0,0,null);this.listChat=new Jo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-822*z.instance().scale),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),e.x=0,e.y=580*z.instance().scale,this.addChild(e);for(var t=0;t<this.arrChat.length;t++)this.addItemChat(this.arrChat[t],t);this.arrChat.length>4&&this.listChat.tweenToItem(this.arrChat.length-1)}},{key:"buildMaxChat",value:function(){this.removeListView(),this.btnShowChat.visible=!0,this.ktShowAll=!0,this.bg.y=61*z.instance().scale,this.bg.height=game.height,this.btnShowChat.scale.y=-1,this.btnShowChat.x=this.bg.width/2,this.btnShowChat.y=this.bg.y+18*z.instance().scale;var e=new Phaser.Group(game,0,0,null);this.listChat=new Jo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-365*z.instance().scale),{direction:"y",padding:18*z.instance().scale,searchForClicks:!1}),e.x=0,e.y=120*z.instance().scale,this.addChild(e);for(var t=0;t<this.arrChat.length;t++)this.addItemChat(this.arrChat[t],t);this.arrChat.length>9&&this.listChat.tweenToItem(this.arrChat.length-1)}},{key:"addLoading",value:function(){this.removeLoading(),this.loading=new Fe,this.addChild(this.loading)}},{key:"removeLoading",value:function(){null!==this.loading&&(this.removeChild(this.loading),this.loading.destroy(),this.loading=null)}},{key:"connect",value:function(){this.addLoading(),this.addEvent(),this.socket.connect()}},{key:"addEvent",value:function(){this.removeEvent(),this.socket.addEventListener(SFS2X.SFSEvent.CONNECTION,this.onConnectionCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLostCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponseCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinErrorCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoinCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginErrorCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.LOGIN,this.onLoginCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessageCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVarsUpdate,this),rl.instance().event.change.add(this.changeKeyBoard,this),rl.instance().event.changeHeight.add(this.changeHeightKeyBoard,this),rl.instance().event.hideKeyboard.add(this.hideKeyboard,this),rl.instance().event.enter.add(this.onSubmit,this),rl.instance().event.submit.add(this.onSubmit,this),rl.instance().event.cancle.add(this.onCancel,this)}},{key:"removeEvent",value:function(){console.log("removeEvent -------"),this.socket.removeEventListener(SFS2X.SFSEvent.CONNECTION,this.onConnectionCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLostCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponseCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinErrorCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoinCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginErrorCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.LOGIN,this.onLoginCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessageCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVarsUpdate,this),rl.instance().event.change.remove(this.changeKeyBoard,this),rl.instance().event.changeHeight.remove(this.changeHeightKeyBoard,this),rl.instance().event.hideKeyboard.remove(this.hideKeyboard,this),rl.instance().event.enter.remove(this.onSubmit,this),rl.instance().event.submit.remove(this.onSubmit,this),rl.instance().event.cancle.remove(this.onCancel,this)}},{key:"onUserVarsUpdate",value:function(e){}},{key:"onPublicMessageCallback",value:function(e){if(LogConsole.log("onPublicMessageCallback"),LogConsole.log(e),e.message===Pe.CHAT_EVENT_MODE){var t=e.sender,n=(t.isItMe,e.room._userManager._usersByName.get(t.name)),i={user_id:n.getVariable("user_id").value,user_name:n.getVariable("user_name").value,avatar:n.getVariable("avatar").value,vip:n.getVariable("vip").value,message:e.data.getUtfString("message"),sent_at:data.getLong("sent_at")};this.buildItemChat(i)}}},{key:"buildItemChat",value:function(e){this.addItemChat(e),this.arrChat.push(e)}},{key:"buildHistoryChat",value:function(e){var t=[];this.listChat.removeAll(),this.listChat.reset(),this.arrChat=[];for(var n=0;n<e.size();n++){var i=e.getSFSObject(n),o={user_id:i.getInt("user_id"),user_name:i.getUtfString("user_name"),avatar:i.getUtfString("avatar"),vip:i.getUtfString("vip"),message:i.getUtfString("message"),sent_at:i.getLong("sent_at")};t.push(o)}t=t.sort(this.sortChat);for(var a=0;a<t.length;a++)this.buildItemChat(t[a]);this.ktShowAll?this.arrChat.length>9&&this.listChat.tweenToItem(this.arrChat.length-1):this.arrChat.length>4&&this.listChat.tweenToItem(this.arrChat.length-1)}},{key:"sortChat",value:function(e,t){return e.sent_at>t.sent_at?1:e.sent_at<t.sent_at?-1:0}},{key:"addItemChat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;LogConsole.log("addItemChat----"),LogConsole.log(e);var n=new $N;n.setData(e,t),this.listChat.add(n)}},{key:"onExtensionResponseCallback",value:function(e){switch(LogConsole.log("onExtensionResponseCallback--------------"),LogConsole.log("cmd : "+e.cmd),LogConsole.log("data : "+e.params.getDump()),e.cmd){case t.EVENT_JOIN_CHAT:break;case t.EVENT_USER_LOAD_MESSAGE:this.removeLoading(),"OK"===e.params.getUtfString("status")&&this.buildHistoryChat(e.params.getSFSArray("messages"));break;case t.USER_JOIN_CHAT_ROOM_SUCCESS:break;case t.EVENT_CHAT_MESSAGE_BROADCAST:var n=e.params,i={user_id:n.getInt("user_id"),user_name:n.getUtfString("user_name"),avatar:n.getUtfString("avatar"),vip:n.getUtfString("vip"),message:n.getUtfString("message"),sent_at:n.getLong("sent_at")};this.buildItemChat(i),this.arrChat.length>0&&this.listChat.tweenToItem(this.arrChat.length-1)}}},{key:"onLoginCallback",value:function(e){LogConsole.log("onLoginCallback"),LogConsole.log(e);var n=[];n.push(new SFS2X.SFSUserVariable("user_id",mZ.instance().dataMySeft.user_id)),n.push(new SFS2X.SFSUserVariable("user_name",mZ.instance().dataMySeft.user_name)),n.push(new SFS2X.SFSUserVariable("avatar",mZ.instance().dataMySeft.avatar)),n.push(new SFS2X.SFSUserVariable("vip",mZ.instance().dataMySeft.vip)),this.socket.send(new SFS2X.SetUserVariablesRequest(n));var i=new SFS2X.SFSObject;i.putLong("event_id",this.event_id),this.sendData(t.EVENT_JOIN_CHAT,i)}},{key:"onLoginErrorCallback",value:function(e){LogConsole.log("onLoginErrorCallback"),LogConsole.log(e)}},{key:"onRoomJoinCallback",value:function(e){LogConsole.log("onRoomJoinCallback"),LogConsole.log(e),this.listChat.removeAll(),this.listChat.reset(),this.sendData(t.EVENT_USER_LOAD_MESSAGE,tB.begin(this.event_id,this.getTime()))}},{key:"onRoomJoinErrorCallback",value:function(e){LogConsole.log("onRoomJoinErrorCallback"),LogConsole.log(e)}},{key:"onConnectionCallback",value:function(e){if(LogConsole.log("onConnectionCallback"),LogConsole.log(e),!0===e.success){var t=new SFS2X.SFSObject;t.putUtfString("token","heheh"),this.socket.send(new SFS2X.LoginRequest(mZ.instance().dataMySeft.user_id+"","",t,this.config.zone))}else LogConsole.log("loi roi"),this.connect()}},{key:"onConnectionLostCallback",value:function(e){LogConsole.log("onConnectionLostCallback"),LogConsole.log(e),null!==mZ.instance().roomLobby&&this.connect()}},{key:"sendData",value:function(e,t){LogConsole.log("sendData"),LogConsole.log("type : "+e),null!=t&&LogConsole.log("data : "+t.getDump()),this.socket.send(new SFS2X.ExtensionRequest(e,t,this.socket.lastJoinedRoom))}},{key:"sendPublicChat",value:function(e,t){this.socket.send(new SFS2X.PublicMessageRequest(e,t,this.socket.lastJoinedRoom))}},{key:"destroy",value:function(){this.onCancel(),this.socket.disconnect(),this.removeEvent(),this.removeAllItem(),this.removeListView(),iB(oB(t.prototype),"destroy",this).call(this)}}]),t}();function cB(e){return(cB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dB(e,t,n){return(dB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fB(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fB(e){return(fB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pB(e,t){return(pB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var yB=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,e=!(i=fB(t).call(this,game,null))||"object"!==cB(i)&&"function"!=typeof i?gB(n):i,qe.instance().showLoading(),e.dataEvent=Object.assign({},new or,o),e.event={back:new Phaser.Signal,ranking:new Phaser.Signal,play_room:new Phaser.Signal},e.positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),e.map=new UN(e.dataEvent),e.map.y=50*z.instance().scale,e.addChild(e.map),e.chat=new hB(e.dataEvent.id),e.addChild(e.chat),e.header=new rN,e.header.event.trophy.add(e.chooseTrophy,gB(gB(e))),e.header.event.back.add(e.chooseBack,gB(gB(e))),e.header.setTitle(e.dataEvent.name),e.addChild(e.header),e.btnPlay=new qN(e.positionEventMode.queueroom_bg_button_play,e.choosePlay,gB(gB(e))),e.btnPlay.y=game.height-138*e.mainData.scale,e.addChild(e.btnPlay),Le.instance().logEvent(Le.Event_mode_join_room),li.instance().showInterstitialEventMode(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pB(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(e){ce.instance().playSound(ce.joineventmode),De.instance().event.backButton.add(this.chooseBack,this),mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().events.onUserExitRoom.add(this.userExitRoom,this),this.dataEvent.id>0?!1===e?mZ.instance().sendData(hN.EVENT_MODE_JOIN_REQUEST,uN.begin(this.dataEvent.id)):qe.instance().hideLoading():this.event.back.dispatch()}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),mZ.instance().events.onExtensionResponse.remove(this.getData,this),mZ.instance().events.onUserExitRoom.remove(this.userExitRoom,this)}},{key:"userExitRoom",value:function(e){e.room.isGame&&e.user.isItMe&&this.event.back.dispatch()}},{key:"getData",value:function(e){switch(e.cmd){case hN.EVENT_MODE_JOIN_RESPONSE:"FAILED"===e.params.getUtfString("status")&&this.event.back.dispatch(),qe.instance().hideLoading()}}},{key:"choosePlay",value:function(){LogConsole.log("choosePlay"),rl.instance().hide(),Le.instance().logEvent(Le.Event_mode_play_button),this.map.getTime()>5?mZ.instance().dataMySeft.ticket<1?iC.instance().addDialogConfirnTicket("Bạn không đủ vé để tham giá sự kiện. Bạn có muốn mua thêm vé?"):(ce.instance().playSound(ce.clickbuttonplayeventmode),this.btnPlay.inputEnabled=!1,this.event.play_room.dispatch()):iC.instance().addDialog("Sự kiện đã kết thúc.")}},{key:"chooseTrophy",value:function(){this.event.ranking.dispatch(this.dataEvent.id)}},{key:"chooseBack",value:function(){ce.instance().removeSound(),mZ.instance().sendExitRoom()}},{key:"destroy",value:function(){ce.instance().removeSound(),this.chat.destroy(),this.map.destroy(),dB(fB(t.prototype),"destroy",this).call(this)}}])&&uB(n.prototype,i),o&&uB(n,o),t}();function mB(e){return(mB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wB(e,t,n){return(wB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=bB(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function bB(e){return(bB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SB(e,t){return(SB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _B(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var EB=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=bB(t).call(this,game,null))||"object"!==mB(i)&&"function"!=typeof i?_B(n):i).event={back:new Phaser.Signal},e.score=0,e.popupHelp=null,e.positionEventMode=e.mainData.positionEventMode,e.bg=new pt(e.positionEventMode.header_bg),e.addChild(e.bg),e.btnBack=new pt(e.positionEventMode.header_buttom_back,e.chooseBack,_B(_B(e))),e.addChild(e.btnBack),e.score=mZ.instance().dataMySeft.ticket,e.btnTicket=new ln(e.positionEventMode.header_buttom_ticket,mZ.instance().dataMySeft.ticket),e.addChild(e.btnTicket),e.txtTitle=new St(e.positionEventMode.header_text_title,""),e.txtTitle.setTextBounds(0,0,e.bg.width,e.bg.height),e.addChild(e.txtTitle),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SB(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this)}},{key:"userVarsUpdate",value:function(){var e=this,t={score:this.score};this.score=mZ.instance().dataMySeft.ticket;var n=game.add.tween(t).to({score:mZ.instance().dataMySeft.ticket},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){e.btnTicket&&e.btnTicket.setText(parseInt(t.score))},this)}},{key:"setHelp",value:function(){this.ktAddHelp=!1,this.popupHelp=null,this.btnHelp=new pt(this.mainData.positionPopup.header_button_help,this.chooseHelp,this),this.addChild(this.btnHelp)}},{key:"chooseHelp",value:function(){console.log("chooseHelp : "+this.ktAddHelp),this.ktAddHelp=!this.ktAddHelp,!0===this.ktAddHelp?this.addPopupHelp():this.removePopupHelp()}},{key:"addPopupHelp",value:function(){this.removePopupHelp(),this.popupHelp=new Kt("TOP 100 người trả lời đúng nhiều câu hỏi nhất (cập nhật sau 30 giây)"),this.popupHelp.y=83*z.instance().scale,this.popupHelp.x=game.width-this.popupHelp.width-71*z.instance().scale,game.world.add(this.popupHelp)}},{key:"removePopupHelp",value:function(){null!==this.popupHelp&&(game.world.remove(this.popupHelp),this.popupHelp.destroy(),this.popupHelp=null)}},{key:"setTitle",value:function(e){this.txtTitle.text=e}},{key:"addSelectRoom",value:function(){this.countTicket=new ln(this.positionEventMode.header_buttom_ticket,mZ.instance().dataMySeft.ticket),this.addChild(this.countTicket)}},{key:"chooseBack",value:function(){this.btnBack.inputEnabled=!1,this.event.back.dispatch()}},{key:"destroy",value:function(){this.removeEvent(),this.removePopupHelp(),iC.instance().removeAnimClaimReward(),wB(bB(t.prototype),"destroy",this).call(this)}}])&&vB(n.prototype,i),o&&vB(n,o),t}();function CB(e){return(CB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function PB(e,t){return!t||"object"!==CB(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OB(e){return(OB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RB(e,t){return(RB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xB=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=PB(this,OB(t).call(this,game,null))).title=e,n.positionEventMode=n.mainData.positionEventMode,n.txtDes=new St(n.positionEventMode.queueroom_txt_title_event,e),n.addChild(n.txtDes),n.line=new rt(n.positionEventMode.queueroom_line_select_event),n.addChild(n.line),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RB(e,t)}(t,Mt),n=t,(i=[{key:"setCount",value:function(e){this.txtDes.text=this.title+" ("+e+")"}},{key:"height",get:function(){return 53*z.instance().scale}},{key:"width",get:function(){return game.width}}])&&kB(n.prototype,i),o&&kB(n,o),t}();function TB(e){return(TB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AB(e,t,n){return(AB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=LB(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function LB(e){return(LB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function GB(e,t){return(GB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function DB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var MB=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,e=!(i=LB(t).call(this,game,null))||"object"!==TB(i)&&"function"!=typeof i?DB(n):i,qe.instance().showLoading(),e.event={back:new Phaser.Signal,choose_event:new Phaser.Signal,view_history:new Phaser.Signal},e.objStart={},e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg);var o=new Phaser.Group(game,0,0,null);return e.listRoom=new Jo(game,o,new Phaser.Rectangle(0,0,game.width,game.height-142*z.instance().scale),{direction:"y",padding:38*z.instance().scale,searchForClicks:!0}),o.x=0,o.y=142*z.instance().scale,e.addChild(o),e.header=new EB,e.header.event.back.add(e.chooseBack,DB(DB(e))),e.addChild(e.header),Le.instance().logEvent(Le.Event_mode),li.instance().showBanerEventRoomScreen(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GB(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),mZ.instance().events.onExtensionResponse.add(this.getData,this),Kr.instance().event.event_update.add(this.addListRoom,this),Kr.instance().event.load_event_list_complete.add(this.buildDataRoomEvent,this),!0===Kr.instance().ktLoadEventList?this.buildDataRoomEvent():Kr.instance().sendGetEventList()}},{key:"buildDataRoomEvent",value:function(){this.addListRoom(),mZ.instance().sendData(hN.EVENT_MODE_LOAD_REQUEST,null),qe.instance().hideLoading()}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),mZ.instance().events.onExtensionResponse.remove(this.getData,this),Kr.instance().event.event_update.remove(this.addListRoom,this),Kr.instance().event.load_event_list_complete.remove(this.buildDataRoomEvent,this)}},{key:"getData",value:function(e){switch(e.cmd){case hN.EVENT_MODE_LOAD_LIST_RESPONSE:break;case hN.EVENT_MODE_LOAD_RESPONSE:if("OK"===e.params.getUtfString("status"))for(var t=e.params.getSFSArray("event_ccu"),n=0;n<t.size();n++){var i=t.getSFSObject(n);this.objStart[i.getLong("event_id")]&&this.objStart[i.getLong("event_id")].setCuu(i.getInt("number_user"))}}}},{key:"addListRoom",value:function(){this.listRoom.removeAll(),this.listRoom.reset();var e=0,t=-1;this.objStart={};var n=new xB("Đang diễn ra");this.listRoom.add(n);var i=Kr.instance().roomEvent.getStartRoom();for(e=0;e<i.length;e++){t++;var o=new Dr(i[e],t);o.event.choose_item.add(this.chooseItem,this),o.x=35*z.instance().scale,this.listRoom.add(o),this.objStart[i[e].id]=o}n.setCount(i.length);var a=new xB("Sắp diễn ra");this.listRoom.add(a);var s=Kr.instance().roomEvent.getWaittingRoom();for(e=0;e<s.length;e++){t++;var r=new Dr(s[e],t);r.event.choose_item.add(this.chooseItem,this),r.x=35*z.instance().scale,this.listRoom.add(r)}a.setCount(s.length);var l=new xB("Kết thúc");this.listRoom.add(l);var h=Kr.instance().roomEvent.getEndRoom();for(e=0;e<h.length;e++){t++;var c=new Dr(h[e],t);c.event.choose_item.add(this.chooseItem,this),c.event.view_history.add(this.viewHistory,this),c.x=35*z.instance().scale,this.listRoom.add(c)}l.setCount(h.length)}},{key:"viewHistory",value:function(e){this.event.view_history.dispatch(e)}},{key:"chooseItem",value:function(e){Le.instance().logEvent(Le.Event_mode_join_room_button),this.event.choose_event.dispatch(e)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listRoom.removeAll(),this.listRoom.destroy(),li.instance().hideBanner(),AB(LB(t.prototype),"destroy",this).call(this)}}])&&IB(n.prototype,i),o&&IB(n,o),t}();function NB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var BB=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putLong("event_id",e),t}}],(n=null)&&NB(t.prototype,n),i&&NB(t,i),e}();var jB=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diamond=0,this.event_id=0,this.ticket=0,this.created=0,this.event_ranking="",this.updated=0,this.support_item=0};function UB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ZB=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t={arrRanking:[],rankMe:new wN,arrReward:[]};if(e.containsKey(jr.event_ranking))for(var n=e.getSFSArray(jr.event_ranking),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new wN;a.event_id=o.getLong(jr.event_id),a.user_id=o.getInt(jr.user_id),a.created=o.getLong(jr.created),a.user_name=o.getUtfString(jr.user_name),a.position=o.getInt(jr.position),a.achieved=o.getInt(jr.achieved),a.id=o.getLong(jr.id),a.avatar=o.getUtfString(jr.avatar),a.updated=o.getLong(jr.updated),t.arrRanking.push(a)}if(e.containsKey(jr.your_rank)){var s=e.getSFSObject(jr.your_rank);t.rankMe.event_id=s.getLong(jr.event_id),t.rankMe.user_id=s.getInt(jr.user_id),t.rankMe.created=s.getLong(jr.created),t.rankMe.user_name=s.getUtfString(jr.user_name),t.rankMe.position=s.getInt(jr.position),t.rankMe.achieved=s.getInt(jr.achieved),t.rankMe.id=s.getLong(jr.id),t.rankMe.avatar=s.getUtfString(jr.avatar),t.rankMe.updated=s.getLong(jr.updated)}if(e.containsKey(jr.event_reward))for(var r=e.getSFSArray(jr.event_reward),l=0;l<r.size();l++){var h=r.getSFSObject(l),c=new jB;c.diamond=h.getInt(jr.diamond),c.event_id=h.getLong(jr.event_id),c.ticket=h.getInt(jr.ticket),c.created=h.getLong(jr.created),c.event_ranking=h.getUtfString(jr.event_ranking),c.updated=h.getLong(jr.updated),c.support_item=h.getInt(jr.support_item),t.arrReward.push(c)}return t}}],(n=null)&&UB(t.prototype,n),i&&UB(t,i),e}();function HB(e){return(HB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function VB(e){return(VB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WB(e,t){return(WB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var KB=function(e){function t(e,n){var i,o,a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=VB(t).call(this,game,null))||"object"!==HB(a)&&"function"!=typeof a?qB(o):a).idx=n,i.data=e,i.isMe=r,i._width=140*z.instance().scale,i.positionEventMode=i.mainData.positionEventMode,i.ava=new Pc,i.ava.setSize(63*z.instance().scale,63*z.instance().scale),i.ava.x=137*z.instance().scale,i.ava.y=41*z.instance().scale,i.addChild(i.ava),i.btnMaskAva=new Phaser.Button(game,i.ava.x,i.ava.y,null,i.chooseAva,qB(qB(i))),i.btnMaskAva.width=i.ava.width,i.btnMaskAva.height=i.ava.height,i.addChild(i.btnMaskAva),i.line=new rt(i.positionEventMode.item_ranking_line_space),i.addChild(i.line),0===n?i.bgTopAvata=new rt(i.positionEventMode.item_ranking_avatar_top1):1===n?i.bgTopAvata=new rt(i.positionEventMode.item_ranking_avatar_top2):2===n?i.bgTopAvata=new rt(i.positionEventMode.item_ranking_avatar_top3):(i.ava.x=137*z.instance().scale,i.ava.y=26*z.instance().scale,i.bgTopAvata=new rt(i.positionEventMode.item_ranking_avatar_top4),i._width=130*z.instance().scale,i.line.y=i._width-2),i.addChild(i.bgTopAvata),i.iconTrophy=new rt(i.positionEventMode.item_ranking_trophy_item),i.addChild(i.iconTrophy),n<3?(i.txtStt=new St(i.positionEventMode.item_ranking_text_top123,n+1),i.txtStt.setTextBounds(0,0,28*z.instance().scale,27*z.instance().scale),i.txtUserName=new St(i.positionEventMode.item_ranking_text_user_name123,i.formatName(e.user_name,15)),i.txtScore=new St(i.positionEventMode.item_ranking_text_score123,e.achieved)):(i.iconTrophy.y=43,i.txtStt=new St(i.positionEventMode.item_ranking_text_top4,n+1),i.txtUserName=new St(i.positionEventMode.item_ranking_text_user_name4,i.formatName(e.user_name,15)),i.txtScore=new ln(i.positionEventMode.item_ranking_text_score4,e.achieved)),i.addChild(i.txtScore),i.addChild(i.txtStt),i.addChild(i.txtUserName),r?i.ava.setAvatar(e.avatar,0):i.ava.setAvatar(e.avatar,n),null===s||(i.dataWin=new Rr(s,!0),i.dataWin.x=i.width-i.dataWin.width-12*z.instance().scale,i.dataWin.y=(i.height-i.dataWin.height)/2,i.addChild(i.dataWin)),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WB(e,t)}(t,Mt),n=t,(i=[{key:"chooseAva",value:function(){console.log("clickAva"),console.log(this.data),iC.instance().addUserProfile(this.data.user_id)}},{key:"hideLine",value:function(){this.line.visible=!1}},{key:"beginTween",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!0===this.isMe?this.x=0:e<8?(this.x=game.width,game.add.tween(this).to({x:0},150,Phaser.Easing.Power1,!0,80*(this.idx+1))):this.x=0}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this._width}}])&&QB(n.prototype,i),o&&QB(n,o),t}();function zB(e){return(zB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function JB(e,t){return!t||"object"!==zB(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XB(e){return(XB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $B(e,t){return($B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ej=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=JB(this,XB(t).call(this,game,null))).positionEventMode=n.mainData.positionEventMode,n.bg=new Zt(n.positionEventMode.ranking_bg_title),n.addChild(n.bg);var o=new rt(n.positionEventMode.ranking_trophy410);return n.addChild(o),n.txtTitle=new St(n.positionEventMode.ranking_text_title,e),n.addChild(n.txtTitle),null===i||(n.dataWin=new Rr(i,!0),n.dataWin.hideBg(),n.dataWin.x=n.bg.width-n.dataWin.width-35*z.instance().scale,n.dataWin.y=(n.bg.height-n.dataWin.height)/2,n.addChild(n.dataWin)),n.line=new rt(n.positionEventMode.queueroom_line_select_event),n.line.y=72*z.instance().scale,n.addChild(n.line),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$B(e,t)}(t,Mt),n=t,(i=[{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&YB(n.prototype,i),o&&YB(n,o),t}();function tj(e){return(tj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ij(e,t,n){return(ij="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oj(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oj(e){return(oj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aj(e,t){return(aj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var rj=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=oj(t).call(this,game,null))||"object"!==tj(o)&&"function"!=typeof o?sj(i):o).positionEventMode=n.mainData.positionEventMode,qe.instance().showLoading(),n.event_id=e,n.event={back:new Phaser.Signal},n.arrRanking=[],n.objRankMe={},n.arrReward=[],n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg);var a=new Phaser.Group(game,0,0,null);return n.listRanking=new Jo(game,a,new Phaser.Rectangle(0,0,game.width,game.height-212*n.mainData.scale),{direction:"y",padding:0,searchForClicks:!0}),a.x=0,a.y=102*n.mainData.scale,n.addChild(a),n.bgMe=new rt(n.positionEventMode.ranking_bg_me),n.bgMe.y=game.height-108*n.mainData.scale,n.addChild(n.bgMe),n.txtError=new St(n.positionEventMode.item_ranking_txt_error,"Bạn chưa có xếp hạng"),n.txtError.setTextBounds(0,0,game.width,38*n.mainData.scale),n.txtError.y=game.height-76*n.mainData.scale,n.addChild(n.txtError),n.txtError.visible=!1,n.rankMe=null,n.header=new EB,n.header.setHelp(),n.header.event.back.add(n.chooseBack,sj(sj(n))),n.addChild(n.header),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aj(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),mZ.instance().events.onExtensionResponse.add(this.getData,this),this.event_id>0?mZ.instance().sendData(hN.EVENT_MODE_RANKING_REQUEST,BB.begin(this.event_id)):(qe.instance().hideLoading(),this.chooseBack())}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case hN.EVENT_MODE_RANKING_RESPONSE:var t=ZB.begin(e.params);this.arrRanking=t.arrRanking,this.objRankMe=t.rankMe,this.arrReward=t.arrReward,this.buildRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildRanking",value:function(){var e,t,n,i=3,o=0;this.arrRanking.length<3&&(i=this.arrRanking.length);for(var a=0;a<i;a++){var s=void 0;(s=this.arrReward[a]?new KB(this.arrRanking[a],a,this.arrReward[a]):new KB(this.arrRanking[a],a)).beginTween(o),this.listRanking.add(s),a==i-1&&s.hideLine(),o++}if(e=this.arrReward[3]?new ej("4-10",this.arrReward[3]):new ej("4-10"),this.listRanking.add(e),this.arrRanking.length>3){var r=10;this.arrRanking.length<10&&(r=this.arrRanking.length);for(var l=3;l<r;l++){var h=new KB(this.arrRanking[l],l);h.beginTween(o),this.listRanking.add(h),l==r-1&&h.hideLine(),o++}}if(t=this.arrReward[4]?new ej("11-50",this.arrReward[4]):new ej("11-50"),this.listRanking.add(t),this.arrRanking.length>10){var c=50;this.arrRanking.length<50&&(c=this.arrRanking.length);for(var u=10;u<c;u++){var d=new KB(this.arrRanking[u],u);d.beginTween(o),this.listRanking.add(d),u==c-1&&d.hideLine(),o++}}if(n=this.arrReward[5]?new ej("51-100",this.arrReward[5]):new ej("51-100"),this.listRanking.add(n),this.arrRanking.length>50){var f=100;this.arrRanking.length<100&&(f=this.arrRanking.length);for(var p=50;p<f;p++){var g=new KB(this.arrRanking[p],p);g.beginTween(),this.listRanking.add(g),p==f-1&&g.hideLine()}}this.objRankMe.position>0?(this.removeRankMe(),this.objRankMe.user_name=mZ.instance().dataMySeft.user_name,this.objRankMe.avatar=mZ.instance().dataMySeft.avatar,this.objRankMe.position<4&&this.arrReward[this.objRankMe.position-1]?this.rankMe=new KB(this.objRankMe,this.objRankMe.position-1,this.arrReward[this.objRankMe.position-1],!0):this.rankMe=new KB(this.objRankMe,this.objRankMe.position-1,null,!0),this.rankMe.x=0,this.rankMe.y=game.height-112*this.mainData.scale,this.addChild(this.rankMe)):this.txtError.visible=!0}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listRanking.removeAll(),this.listRanking.destroy(),ij(oj(t.prototype),"destroy",this).call(this)}}])&&nj(n.prototype,i),o&&nj(n,o),t}();function lj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var hj=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t,n,i,o,a){console.log("answer_time : "+o);var s=new SFS2X.SFSObject;return s.putInt("answer_index",e),s.putInt("correct_answer",t),s.putInt("question_index",n),s.putBool("is_loaded_next_question",i),s.putFloat("answer_time",o),s.putBool("is_correct_answer",a),s}}],(n=null)&&lj(t.prototype,n),i&&lj(t,i),e}();function cj(e){return(cj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dj(e,t){return!t||"object"!==cj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fj(e){return(fj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pj(e,t){return(pj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var gj=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=dj(this,fj(t).call(this,game,null))).event={complete:new Phaser.Signal},e.tweenSpriteTime=null,e.positionEventMode=e.mainData.positionEventMode,e.loading=new rt(e.positionEventMode.playroom_loading_time_question),e.loading.width=0,e.addChild(e.loading),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pj(e,t)}(t,Mt),n=t,(i=[{key:"addTween",value:function(){this.loading.width=0,this.stopTween(),this.tweenSpriteTime=game.add.tween(this.loading).to({width:570*z.instance().scale},1e4,"Linear"),this.tweenSpriteTime.onComplete.add(this.onComplete,this),this.tweenSpriteTime.start()}},{key:"onComplete",value:function(){this.event.complete.dispatch()}},{key:"getTime",value:function(){return console.log("getTime----------"),console.log(this.tweenSpriteTime),console.log(this.tweenSpriteTime.timeline[0].dt),null!==this.tweenSpriteTime?this.tweenSpriteTime.timeline[0].dt/1e3:0}},{key:"stopTween",value:function(){null!==this.tweenSpriteTime&&(this.tweenSpriteTime.stop(),this.tweenSpriteTime.onComplete.remove(this.onComplete,this))}}])&&uj(n.prototype,i),o&&uj(n,o),t}();function yj(e){return(yj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vj(e){return(vj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wj(e,t){return(wj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Sj=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=vj(t).call(this,game,null))||"object"!==yj(i)&&"function"!=typeof i?bj(n):i).event={show_loading:new Phaser.Signal,hide_loading:new Phaser.Signal,next_question:new Phaser.Signal,fail_question:new Phaser.Signal},e.data=null,e.idx=0,e.idxLoad=0,e.ktSend=!0,e.ktSendNexQuestion=!1,e.positionEventMode=e.mainData.positionEventMode,e.txtNumber=new St(e.positionEventMode.playroom_text_number_question,""),e.txtNumber.setTextBounds(0,0,game.width,31*z.instance().scale),e.addChild(e.txtNumber),e.txtDes=new St(e.positionEventMode.playroom_text_des_question,""),e.txtDes.setTextBounds(0,0,game.width,30*z.instance().scale),e.addChild(e.txtDes);var o=new Phaser.Group(game,0,0,null);e.listAnswer=new Jo(game,o,new Phaser.Rectangle(0,0,game.width,500*z.instance().scale),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),o.y=89*z.instance().scale,e.addChild(o),e.arrAnswer=[],e.listAnswer.removeAll(),e.listAnswer.reset(),LogConsole.log("answr----------------------------------");for(var a=0;a<4;a++){var s=new xI(e.chooseAnswer,bj(bj(e)));s.inputEnabled=!1;var r=(game.width-s.width)/2;s.x=r,s.setConstX(r),s.visible=!1,e.arrAnswer.push(s)}return LogConsole.log("end----------------------------------"),e.loadingQuestion=new gj,e.loadingQuestion.event.complete.add(e.timeCompelte,bj(bj(e))),e.loadingQuestion.x=35*z.instance().scale,e.loadingQuestion.y=80*z.instance().scale,e.addChild(e.loadingQuestion),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wj(e,t)}(t,Mt),n=t,(i=[{key:"setIdxLoad",value:function(e){this.idxLoad=e,console.log("setIdxLoad ----------- : "+this.idxLoad),console.log("this.ktSendNexQuestion : "+this.ktSendNexQuestion),!0===this.ktSendNexQuestion&&(this.ktSendNexQuestion=!1,this.event.next_question.dispatch())}},{key:"timeCompelte",value:function(){if(!1===this.ktSend){this.ktSend=!0;for(var e=0;e<this.arrAnswer.length;e++)this.arrAnswer[e].setTextNoChoose();var t=this.data.correct_answer;this.arrAnswer[t-1].setTrueText();mZ.instance().sendData(hN.EVENT_MODE_USER_SELECTED_ANSWER_REQUEST,hj.begin(0,t,this.idx+1,!0,10,!1)),this.event.fail_question.dispatch()}}},{key:"showQuestion",value:function(){for(var e=0;e<this.arrAnswer.length;e++)this.arrAnswer[e].visible=!0,this.arrAnswer[e].inputEnabled=!0,this.listAnswer.add(this.arrAnswer[e])}},{key:"chooseAnswer",value:function(e){if(!1===this.ktSend){this.ktSend=!0;var t=this.loadingQuestion.getTime();console.log("answer_time : "+t);var n=!1;this.loadingQuestion.stopTween();for(var i=0;i<this.arrAnswer.length;i++)this.arrAnswer[i].setTextNoChoose();var o=this.data.correct_answer,a=e.getIdx()+1;a==o?(e.setTrueText(),n=!0,ce.instance().playSound(ce.streakanswer)):(e.setFailText(),n=!1,this.arrAnswer[o-1].setTrueText());var s=!1;this.ktSendNexQuestion=!0,this.idx+1<this.idxLoad&&(s=!0,this.ktSendNexQuestion=!1),mZ.instance().sendData(hN.EVENT_MODE_USER_SELECTED_ANSWER_REQUEST,hj.begin(a,o,this.idx+1,s,t,n)),!0===n?this.event.next_question.dispatch():this.event.fail_question.dispatch()}}},{key:"buildQuestionByIndex",value:function(e,t){this.ktSendNexQuestion=!1,LogConsole.log("buildQuestionByIndex - "+e),LogConsole.log(t),this.idx=e,this.data=t,this.ktSend=!1,this.loadingQuestion.addTween(),Dl.instance().playsound(this.data.file_path),this.txtNumber.text="Câu "+(e+1);var n="";"SONG"==t.question_type?n="Tìm tên bài hát":"SINGER"==t.question_type&&(n="Tìm tên ca sĩ"),this.txtDes.text=n;for(var i=0;i<this.data.arrAnser.length;i++)this.arrAnswer[i].setData(this.data.arrAnser[i],i)}},{key:"destroy",value:function(){this.loadingQuestion.event.complete.remove(this.timeCompelte,this),Dl.instance().removeSound(),this.removeAllItem()}}])&&mj(n.prototype,i),o&&mj(n,o),t}();function _j(e){return(_j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ej(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cj(e){return(Cj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kj(e,t){return(kj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Oj=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Cj(t).call(this,game,null))||"object"!==_j(i)&&"function"!=typeof i?Pj(n):i).event={change_local_me:new Phaser.Signal,fail_question:new Phaser.Signal,done_game:new Phaser.Signal,cancle_bad_connect:new Phaser.Signal},e.arrQuestion=[],e.idxLoad=0,e.ktLoad=!1,e.ktFist=!0,e.ktEvendEnd=!1,e.idxNextQuestion=null,e.idBadConnect=null,e.idxQuestion=0,e.loading=null,e.badConnect=null,e.remaining_question_number=0,e.question=new Sj,e.question.event.next_question.add(e.buildNextQuestionUser,Pj(Pj(e))),e.question.event.fail_question.add(e.buildFailQuestionUser,Pj(Pj(e))),e.question.event.show_loading.add(e.addLoading,Pj(Pj(e))),e.question.event.hide_loading.add(e.removeLoading,Pj(Pj(e))),e.question.y=game.height-591*z.instance().scale,e.addChild(e.question),Dl.instance().removeAllSound(),e.addLoading(),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kj(e,t)}(t,Mt),n=t,(i=[{key:"addLoading",value:function(){this.removeLoading(),this.loading=new Fe,this.addChild(this.loading)}},{key:"removeLoading",value:function(){null!==this.loading&&(this.removeChild(this.loading),this.loading.destroy(),this.loading=null)}},{key:"loadStart",value:function(){LogConsole.log("loadStart----------")}},{key:"onFileComplete",value:function(e,t,n,i,o){LogConsole.log("onFileComplete ----------")}},{key:"loadComplete",value:function(){LogConsole.log("loadComplete---------- : "+this.idxLoad),this.idxLoad++,this.idxLoad<this.arrQuestion.length?(this.beginLoad(),!0===this.ktFist&&(li.instance().playEventMode(),this.ktFist=!1,this.removeIdBadConnect(),this.idxQuestion=0,this.question.showQuestion(),this.buildNextQuestion(),this.removeLoading())):this.ktLoad=!1}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),Dl.instance().event.loadComplete.add(this.loadComplete,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),Dl.instance().event.loadComplete.remove(this.loadComplete,this),this.question.event.next_question.remove(this.buildNextQuestionUser,this),this.question.event.fail_question.remove(this.buildFailQuestionUser,this),this.question.event.show_loading.remove(this.addLoading,this),this.question.event.hide_loading.remove(this.removeLoading,this)}},{key:"getData",value:function(e){switch(e.cmd){case hN.EVENT_MODE_QUESTION_RESPONSE:this.addDataQuestion(e.params);break;case hN.EVENT_MODE_START_GAME:this.idxQuestion=e.params.getInt(jr.question_index)-1,this.question.showQuestion(),this.buildNextQuestion();break;case hN.EVENT_MODE_MOVE_TO_NEXT_QUESTION:this.removeLoading(),this.idxQuestion=e.params.getInt(jr.question_index)-1,this.removeNextQuestion(),this.idxNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.buildNextQuestion,this);break;case hN.EVENT_MODE_EVENT_ENDED:this.ktEvendEnd=!0}}},{key:"removeNextQuestion",value:function(){null!==this.idxNextQuestion&&game.time.events.remove(this.idxNextQuestion)}},{key:"buildFailQuestionUser",value:function(){!1===this.ktEvendEnd&&this.event.fail_question.dispatch(this.idxQuestion)}},{key:"removeIdBadConnect",value:function(){null!==this.idBadConnect&&game.time.events.remove(this.idBadConnect)}},{key:"addShowBadConnect",value:function(){this.removeShowBadConnect(),this.badConnect=new LS,this.badConnect.setTextOk("CHƠI TIẾP"),this.badConnect.setTextCancle("QUAY LẠI"),this.badConnect.event.OK.add(this.chooseOkBadConnect,this),this.badConnect.event.CANCLE.add(this.chooseCancleBadConnect,this),this.badConnect.setTextConfirm("Bạn có muốn chơi tiếp không?"),this.addChild(this.badConnect)}},{key:"chooseOkBadConnect",value:function(){this.removeShowBadConnect(),this.removeIdBadConnect(),this.idBadConnect=game.time.events.add(10*Phaser.Timer.SECOND,this.addShowBadConnect,this)}},{key:"chooseCancleBadConnect",value:function(){mZ.instance().sendData(hN.EVENT_MODE_USER_DONE_GAME_REQUEST,null),this.event.cancle_bad_connect.dispatch()}},{key:"removeShowBadConnect",value:function(){null!==this.badConnect&&(this.removeChild(this.badConnect),this.badConnect.destroy(),this.badConnect=null)}},{key:"buildNextQuestionUser",value:function(){this.idxQuestion++,console.log("buildNextQuestionUser : "+this.idxQuestion),console.log("idxLoad : "+this.idxLoad),0===this.remaining_question_number&&this.idxQuestion===this.arrQuestion.length?(mZ.instance().sendData(hN.EVENT_MODE_USER_DONE_GAME_REQUEST,null),this.event.done_game.dispatch()):this.idxQuestion<this.idxLoad?(this.removeLoading(),this.removeIdBadConnect(),this.removeNextQuestion(),this.removeShowBadConnect(),this.idxNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.buildNextQuestion,this)):(this.idxQuestion--,this.addLoading(),this.removeIdBadConnect(),this.idBadConnect=game.time.events.add(10*Phaser.Timer.SECOND,this.addShowBadConnect,this))}},{key:"buildNextQuestion",value:function(){if(this.arrQuestion[this.idxQuestion]){var e=this.idxQuestion-4;e>-1&&Dl.instance().removeSoundFromUrl(this.arrQuestion[e].file_path),this.event.change_local_me.dispatch(this.idxQuestion+1),this.question.buildQuestionByIndex(this.idxQuestion,this.arrQuestion[this.idxQuestion])}else iC.instance().addDialog("Vượt quá câu hỏi nhận được")}},{key:"addDataQuestion",value:function(e){var t=e.getSFSArray(nc.questions);this.remaining_question_number=e.getInt("remaining_question_number");for(var n=0;n<t.size();n++){var i=t.getSFSObject(n),o=new yT;o.file_path=i.getUtfString(nc.file_path),o.question_type=i.getUtfString(nc.question_type),o.correct_answer=i.getInt(nc.correct_answer),o.arrAnser.push(i.getUtfString(nc.answer1)),o.arrAnser.push(i.getUtfString(nc.answer2)),o.arrAnser.push(i.getUtfString(nc.answer3)),o.arrAnser.push(i.getUtfString(nc.answer4));var a=i.getSFSObject(nc.song);o.song=oc.getSongDetail(a),o.song.listenLink=o.file_path,this.arrQuestion.push(o)}!1===this.ktLoad&&this.beginLoad()}},{key:"beginLoad",value:function(){LogConsole.log("this.idxLoad : "+this.idxLoad),LogConsole.log("arrQuestion : "+this.arrQuestion.length),this.ktLoad=!0,this.question.setIdxLoad(this.idxLoad),Dl.instance().loadSound(this.arrQuestion[this.idxLoad].file_path),!0===this.ktFist&&(this.removeIdBadConnect(),this.idBadConnect=game.time.events.add(10*Phaser.Timer.SECOND,this.addShowBadConnect,this))}},{key:"destroy",value:function(){this.removeEvent(),this.removeAllItem(),this.removeIdBadConnect(),this.removeNextQuestion(),Dl.instance().removeAllSound()}}])&&Ej(n.prototype,i),o&&Ej(n,o),t}();function Rj(e){return(Rj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Tj(e,t,n){return(Tj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ij(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ij(e){return(Ij=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Aj(e,t){return(Aj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Gj=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Ij(t).call(this,game,null))||"object"!==Rj(i)&&"function"!=typeof i?Lj(n):i).event={backToSelect:new Phaser.Signal,end_game:new Phaser.Signal,done_game:new Phaser.Signal,cancle_bad_connect:new Phaser.Signal},e.dataEvent=Object.assign({},new or,o),e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),e.header=new rN,e.header.setTitle(e.dataEvent.name),e.header.setHideBack(),e.header.setHideTrophy(),e.addChild(e.header),e.map=new UN(e.dataEvent),game.height>1136?e.map.y=50*z.instance().scale+(game.height-1136)/2:e.map.y=50*z.instance().scale,e.addChild(e.map),e.question=new Oj,e.question.event.cancle_bad_connect.add(e.cancleBadConnect,Lj(Lj(e))),e.question.event.fail_question.add(e.failQuestion,Lj(Lj(e))),e.question.event.done_game.add(e.doneQuestion,Lj(Lj(e))),e.question.event.change_local_me.add(e.changeLocalMe,Lj(Lj(e))),e.addChild(e.question),Le.instance().logEvent(Le.Event_mode_play),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Aj(e,t)}(t,Mt),n=t,(i=[{key:"doneQuestion",value:function(){this.event.done_game.dispatch()}},{key:"failQuestion",value:function(e){this.event.end_game.dispatch(e)}},{key:"changeLocalMe",value:function(e){this.map.changeLocalMe(e)}},{key:"cancleBadConnect",value:function(){this.event.cancle_bad_connect.dispatch()}},{key:"chooseTrophy",value:function(){}},{key:"chooseBack",value:function(){}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().events.onUserExitRoom.add(this.userExitRoom,this),mZ.instance().sendData(hN.EVENT_MODE_PLAY_GAME_REQUEST,null)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),mZ.instance().events.onUserExitRoom.remove(this.userExitRoom,this),this.question.event.cancle_bad_connect.remove(this.cancleBadConnect,this),this.question.event.fail_question.remove(this.failQuestion,this),this.question.event.done_game.remove(this.doneQuestion,this),this.question.event.change_local_me.remove(this.changeLocalMe,this)}},{key:"getData",value:function(e){switch(e.cmd){case hN.EVENT_MODE_START_GAME:li.instance().playEventMode(),Le.instance().logEvent(Le.pro_quiz_start_eventmode),li.instance().playEventMode(),this.question.removeLoading()}}},{key:"userExitRoom",value:function(e){e.room.isGame&&e.user.isItMe&&this.event.backToSelect.dispatch()}},{key:"destroy",value:function(){Dl.instance().removeAllSound(),this.removeEvent(),this.removeAllItem(),Tj(Ij(t.prototype),"destroy",this).call(this)}}])&&xj(n.prototype,i),o&&xj(n,o),t}();function Dj(e){return(Dj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nj(e){return(Nj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bj(e,t){return(Bj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Uj=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Nj(t).call(this,game,null))||"object"!==Dj(i)&&"function"!=typeof i?jj(n):i).event={exit:new Phaser.Signal,continute:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.popup=new $i,e.popup.setHeight(350*z.instance().scale),e.popup.x=0,e.popup.y=89*z.instance().scale,e.addChild(e.popup),e.icon=new rt(e.positionPopup.popup_icon_emo_win),e.icon.x=e.popup.x+(e.popup.width-e.icon.width)/2,e.icon.y=0,e.addChild(e.icon),e.txtChucMung=new St(e.positionPopup.popup_win_event_text_chucmung,"CHÚC MỪNG BẠN!!!"),e.txtChucMung.setTextBounds(0,0,e.popup.width,57*z.instance().scale),e.addChild(e.txtChucMung),e.txtCountQuestion=new St(e.positionPopup.popup_win_event_text_count_question,"Bạn đã trả lời được "+o+" câu hỏi"),e.txtCountQuestion.addColor("#ffa33a",20),e.txtCountQuestion.addColor("#000000",20+o.toString().length),e.txtCountQuestion.setTextBounds(0,0,e.popup.width,34*z.instance().scale),e.addChild(e.txtCountQuestion),e.btnExit=new ln(e.positionPopup.popup_win_event_button_exit,"THOÁT",e.chooseExit,jj(jj(e))),e.addChild(e.btnExit),e.btnContinute=new ln(e.positionPopup.popup_win_event_button_continute,"CHƠI TIẾP  -1",e.chooseContinute,jj(jj(e))),e.addChild(e.btnContinute),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bj(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch()}},{key:"chooseContinute",value:function(){mZ.instance().dataMySeft.ticket<1?(iC.instance().addDialogConfirnTicket("Bạn không đủ vé để tham giá sự kiện. Bạn có muốn mua thêm vé?"),this.chooseExit()):this.event.continute.dispatch()}}])&&Mj(n.prototype,i),o&&Mj(n,o),t}();function Fj(e){return(Fj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hj(e){return(Hj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qj(e,t){return(Qj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Wj=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=Hj(t).call(this,game,null))||"object"!==Fj(a)&&"function"!=typeof a?Vj(o):a).event={exit:new Phaser.Signal,continute:new Phaser.Signal},i.positionPopup=i.mainData.positionPopup,i.bg=new Phaser.Button(game,0,0,"screen-dim"),i.addChild(i.bg),i.popupWin=new Uj(e),i.popupWin.event.exit.add(i.chooseExit,Vj(Vj(i))),i.popupWin.event.continute.add(i.chooseContinute,Vj(Vj(i))),i.popupWin.x=35*z.instance().scale,i.popupWin.y=game.height-853*z.instance().scale,i.addChild(i.popupWin),i.time=new cr,i.time.setTimer(n.finish_at),i.time.x=284*z.instance().scale,i.time.y=118*z.instance().scale,i.addChild(i.time),i.countTicket=new ln(i.positionPopup.popup_win_event_count_ticket,mZ.instance().dataMySeft.ticket),i.addChild(i.countTicket),ce.instance().playSound(ce.gameovereventmode),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qj(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){LogConsole.log("chooseExit"),this.event.exit.dispatch()}},{key:"chooseContinute",value:function(){LogConsole.log("chooseContinute"),this.event.continute.dispatch()}}])&&Zj(n.prototype,i),o&&Zj(n,o),t}();function qj(e){return(qj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zj(e){return(zj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yj(e,t){return(Yj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Jj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Xj=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=zj(t).call(this,game,null))||"object"!==qj(i)&&"function"!=typeof i?Jj(n):i).event={exit:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.popup=new $i,e.popup.setHeight(350*z.instance().scale),e.popup.x=0,e.popup.y=89*z.instance().scale,e.addChild(e.popup),e.icon=new rt(e.positionPopup.popup_icon_emo_done),e.icon.x=e.popup.x+(e.popup.width-e.icon.width)/2,e.icon.y=-67*z.instance().scale,e.addChild(e.icon),e.txtChucMung=new St(e.positionPopup.popup_win_event_text_chucmung,"BẠN THẬT BÁ ĐẠO"),e.txtChucMung.setTextBounds(0,0,e.popup.width,57*z.instance().scale),e.addChild(e.txtChucMung),e.txtCountQuestion=new St(e.positionPopup.popup_win_event_text_done,"Chúc mừng bạn đã trả lời được tất cả các câu hỏi"),e.txtCountQuestion.setTextBounds(0,0,474*z.instance().scale,34*z.instance().scale),e.addChild(e.txtCountQuestion),e.btnExit=new ln(e.positionPopup.popup_done_event_button_exit,"THOÁT",e.chooseExit,Jj(Jj(e))),e.addChild(e.btnExit),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yj(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch()}}])&&Kj(n.prototype,i),o&&Kj(n,o),t}();function $j(e){return($j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tU(e){return(tU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nU(e,t){return(nU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var oU=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=tU(t).call(this,game,null))||"object"!==$j(o)&&"function"!=typeof o?iU(i):o).event={exit:new Phaser.Signal},n.positionPopup=n.mainData.positionPopup,n.bg=new Phaser.Button(game,0,0,"screen-dim"),n.addChild(n.bg),n.popupWin=new Xj,n.popupWin.event.exit.add(n.chooseExit,iU(iU(n))),n.popupWin.x=35*z.instance().scale,n.popupWin.y=game.height-853*z.instance().scale,n.addChild(n.popupWin),n.time=new cr,n.time.setTimer(e.finish_at),n.time.x=266*z.instance().scale,n.time.y=118*z.instance().scale,n.addChild(n.time),n.countTicket=new ln(n.positionPopup.popup_win_event_count_ticket,mZ.instance().dataMySeft.ticket),n.addChild(n.countTicket),ce.instance().playSound(ce.popupeventmodeend),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nU(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch(),ce.instance().removeSound()}}])&&eU(n.prototype,i),o&&eU(n,o),t}();function aU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var sU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t={event_top_rank_log:{},event:{},event_reward:{}};if(e.containsKey(jr.event_top_rank_log)){var n=e.getSFSObject(jr.event_top_rank_log);t.event_top_rank_log.event_id=n.getLong(jr.event_id),t.event_top_rank_log.top=n.getInt(jr.top),t.event_top_rank_log.user_id=n.getInt(jr.user_id),t.event_top_rank_log.created=n.getLong(jr.created),t.event_top_rank_log.achieved=n.getInt(jr.achieved),t.event_top_rank_log.id=n.getLong(jr.id),t.event_top_rank_log.state=n.getUtfString(jr.state),t.event_top_rank_log.updated=n.getLong(jr.updated)}if(e.containsKey(jr.event)){var i=e.getSFSObject(jr.event);t.event.finish_at=i.getLong(jr.finish_at),t.event.created=i.getLong(jr.created),t.event.description=i.getUtfString(jr.description),t.event.banner=i.getUtfString(jr.banner),t.event.active=i.getInt(jr.active),t.event.start_at=i.getLong(jr.start_at),t.event.event_type=i.getUtfString(jr.event_type),t.event.name=i.getUtfString(jr.name),t.event.medal=i.getUtfString(jr.medal),t.event.id=i.getLong(jr.id),t.event.state=i.getUtfString(jr.state),t.event.updated=i.getLong(jr.updated)}if(e.containsKey(jr.event_reward)){var o=e.getSFSObject(jr.event_reward);t.event_reward.diamond=o.getInt(jr.diamond),t.event_reward.event_id=o.getLong(jr.event_id),t.event_reward.ticket=o.getInt(jr.ticket),t.event_reward.event_ranking=o.getUtfString(jr.event_ranking),t.event_reward.updated=o.getLong(jr.updated),t.event_reward.support_item=o.getInt(jr.support_item)}return t}}],(n=null)&&aU(t.prototype,n),i&&aU(t,i),e}();function rU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var lU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putLong("event_top_rank_log_id",e),t}}],(n=null)&&rU(t.prototype,n),i&&rU(t,i),e}();function hU(e){return(hU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function uU(e){return(uU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dU(e,t){return(dU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var pU=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=uU(t).call(this,game,null))||"object"!==hU(o)&&"function"!=typeof o?fU(i):o).dataEvent=e,n.event={accept_gift:new Phaser.Signal,view_result:new Phaser.Signal,exit:new Phaser.Signal},n.positionEventMode=n.mainData.positionEventMode,n.positionPopup=n.mainData.positionPopup,n.bg=new $i,n.bg.y=198*z.instance().scale,n.bg.setHeight(612*z.instance().scale),n.addChild(n.bg),n.iconTrophy=new Phaser.Sprite(game,0,0,"iconpopupwinevent"),n.iconTrophy.animations.add("iconpopupwinevent"),n.iconTrophy.animations.play("iconpopupwinevent",30,!0),n.iconTrophy.width=526,n.iconTrophy.height=320,n.iconTrophy.x=(n.bg.width-n.iconTrophy.width)/2,n.iconTrophy.y=-50,n.addChild(n.iconTrophy),n.lbKetThuc=new St(n.positionEventMode.popup_win_text_ketthucsukien,"Kết thúc sự kiện"),n.lbKetThuc.setTextBounds(0,0,n.bg.width,30*z.instance().scale),n.addChild(n.lbKetThuc),n.lbNameEvent=new St(n.positionEventMode.popup_win_text_name,e.event.name),n.lbNameEvent.setTextBounds(0,0,n.bg.width,46*z.instance().scale),n.addChild(n.lbNameEvent),n.lbChucMung=new St(n.positionEventMode.popup_win_text_chucmung,"Chúc mừng bạn đã đạt thứ hạng"),n.lbChucMung.setTextBounds(0,0,n.bg.width,30*z.instance().scale),n.addChild(n.lbChucMung),n.lbSTT=new St(n.positionEventMode.popup_win_text_stt,e.event_top_rank_log.top),n.lbSTT.setTextBounds(0,0,n.bg.width,46*z.instance().scale),n.addChild(n.lbSTT),n.lbPhanThuong=new St(n.positionEventMode.popup_win_text_phanthuong,"PHẦN THƯỞNG"),n.lbPhanThuong.setTextBounds(0,0,n.bg.width,30*z.instance().scale),n.addChild(n.lbPhanThuong),n.gift=new Rr(e.event_reward,!0),n.gift.x=(n.bg.width-n.gift.width)/2,n.gift.y=518*z.instance().scale,n.addChild(n.gift),n.btnClose=new pt(n.positionPopup.popup_close_btn_exit,n.chooseClose,fU(fU(n))),n.btnClose.x=n.bg.width-n.btnClose.width/2,n.btnClose.y=n.bg.y-n.btnClose.height/3,n.addChild(n.btnClose),n.btnXemKetQua=new ln(n.positionPopup.popup_confirm_button_ok,"XEM KẾT QUẢ",n.chooseCancle,fU(fU(n))),n.btnXemKetQua.x=35,n.btnXemKetQua.y=610*z.instance().scale,n.addChild(n.btnXemKetQua),n.btnShare=new ln(n.positionPopup.popup_confirm_button_share,"CHIA SẺ",n.chooseShare,fU(fU(n))),n.btnShare.y=610*z.instance().scale,n.addChild(n.btnShare),n.btnNhanthuong=new ln(n.positionPopup.popup_confirm_button_ok_full,"NHẬN THƯỞNG",n.chooseOK,fU(fU(n))),n.btnNhanthuong.x=35,n.btnNhanthuong.y=715*z.instance().scale,n.addChild(n.btnNhanthuong),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dU(e,t)}(t,Mt),n=t,(i=[{key:"chooseShare",value:function(){ui.instance().share()}},{key:"chooseOK",value:function(){this.btnNhanthuong.inputEnabled=!1,this.event.accept_gift.dispatch(),mZ.instance().sendData(hN.EVENT_MODE_CLAIM_REWARD_REQUEST,lU.begin(this.dataEvent.event_top_rank_log.id))}},{key:"chooseCancle",value:function(){this.event.view_result.dispatch(this.dataEvent.event.id)}},{key:"chooseClose",value:function(){this.event.exit.dispatch()}}])&&cU(n.prototype,i),o&&cU(n,o),t}();function gU(e){return(gU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mU(e,t){return!t||"object"!==gU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vU(e,t,n){return(vU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wU(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function wU(e){return(wU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bU(e,t){return(bU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var SU=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=mU(this,wU(t).call(this,game,null))).data=e,n.event={accept_gift:new Phaser.Signal,view_result:new Phaser.Signal,exit:new Phaser.Signal},n.idxGet=0,n.idShowResult=null,n.positionPopup=n.mainData.positionPopup,n.bg=new Phaser.Button(game,0,0,"screen-dim"),n.addChild(n.bg),n.arrResource=[{type:"spritesheet",link:"img/atlas/IconEventModeWin.png",key:"iconpopupwinevent",width:400,height:243,countFrame:23}],n.loadResource(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bU(e,t)}(t,pm),n=t,(i=[{key:"loadFileComplete",value:function(){vU(wU(t.prototype),"loadFileComplete",this).call(this),this.popupWin=new pU(this.data),this.popupWin.event.exit.add(this.chooseExit,this),this.popupWin.event.accept_gift.add(this.chooseAceptGift,this),this.popupWin.event.view_result.add(this.chooseViewResult,this),this.popupWin.x=35*z.instance().scale,this.popupWin.y=game.height-964*z.instance().scale,this.addChild(this.popupWin),this.scoreDiamond=mZ.instance().dataMySeft.diamond,this.btnDiamond=new ln(this.positionPopup.tn_header_item_gem,this.scoreDiamond),this.addChild(this.btnDiamond),this.scoreTicket=mZ.instance().dataMySeft.ticket,this.btnTicket=new ln(this.positionPopup.tn_header_item_ticket,this.scoreTicket),this.addChild(this.btnTicket),this.scoreSupportItem=mZ.instance().dataMySeft.support_item,this.btnSupportItem=new ln(this.positionPopup.tn_header_item_mic,this.scoreSupportItem),this.addChild(this.btnSupportItem),this.addEvent()}},{key:"addEvent",value:function(){mZ.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this)}},{key:"onUserVarsUpdate",value:function(){var e,t=this,n={score:0};this.scoreDiamond<mZ.instance().dataMySeft.diamond?(game.tweens.removeFrom(this.btnDiamond),n.score=this.scoreDiamond,this.scoreDiamond=mZ.instance().dataMySeft.diamond,console.log("scoreDiamond : "+this.scoreDiamond),(e=game.add.tween(n).to({score:mZ.instance().dataMySeft.diamond},500,"Linear",!0,1e3)).start(),e.onUpdateCallback(function(){t.btnDiamond&&t.btnDiamond.setText(parseInt(n.score))},this),e.onComplete.add(function(){t.btnDiamond&&t.btnDiamond.setText(parseInt(t.scoreDiamond))},this),this.addCheckTweenMoney()):this.scoreTicket<mZ.instance().dataMySeft.ticket?(game.tweens.removeFrom(this.btnTicket),n.score=this.scoreTicket,this.scoreTicket=mZ.instance().dataMySeft.ticket,console.log("scoreTicket : "+this.scoreTicket),(e=game.add.tween(n).to({score:mZ.instance().dataMySeft.ticket},500,"Linear",!0,1e3)).start(),e.onUpdateCallback(function(){t.btnTicket&&t.btnTicket.setText(parseInt(n.score))},this),e.onComplete.add(function(){t.btnTicket&&t.btnTicket.setText(parseInt(t.scoreTicket))},this),this.addCheckTweenMoney()):this.scoreSupportItem<mZ.instance().dataMySeft.support_item&&(game.tweens.removeFrom(this.btnSupportItem),n.score=this.scoreSupportItem,this.scoreSupportItem=mZ.instance().dataMySeft.support_item,console.log("scoreSupportItem : "+this.scoreSupportItem),(e=game.add.tween(n).to({score:mZ.instance().dataMySeft.support_item},500,"Linear",!0,1e3)).start(),e.onUpdateCallback(function(){t.btnSupportItem&&t.btnSupportItem.setText(parseInt(n.score))},this),e.onComplete.add(function(){t.btnSupportItem&&t.btnSupportItem.setText(parseInt(t.scoreSupportItem))},this))}},{key:"chooseExit",value:function(){this.event.exit.dispatch(),iC.instance().removeAnimClaimReward(),this.removeShowResult(),this.removeCheckTweenMoney()}},{key:"chooseAceptGift",value:function(){this.idxGet++;var e={resourceType:"SUPPORT_ITEM",reward:0};1===this.idxGet?this.data.event_reward.diamond>0?(e.resourceType="DIAMOND",e.reward=this.data.event_reward.diamond,this.showGetMoney(e)):this.chooseAceptGift():2===this.idxGet?this.data.event_reward.ticket>0?(e.resourceType="TICKET",e.reward=this.data.event_reward.ticket,this.showGetMoney(e)):this.chooseAceptGift():3===this.idxGet?this.data.event_reward.support_item>0?(e.resourceType="SUPPORT_ITEM",e.reward=this.data.event_reward.support_item,this.showGetMoney(e)):this.chooseAceptGift():this.chooseExit()}},{key:"showGetMoney",value:function(e){var t=470*this.mainData.scale,n=45*this.mainData.scale,i="SUPPORT_ITEM";"DIAMOND"===e.resourceType?(i="DIAMOND",t=110*this.mainData.scale,n=45*this.mainData.scale):"TICKET"===e.resourceType?(i="TICKET",t=286*this.mainData.scale,n=45*this.mainData.scale):"SUPPORT_ITEM"===e.resourceType&&(i="SUPPORT_ITEM",t=500*this.mainData.scale,n=45*this.mainData.scale);var o={type:i,reward:e.reward,finishPoint:{x:t,y:n}};iC.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,o),this.removeShowResult(),this.idShowResult=game.time.events.add(2*Phaser.Timer.SECOND,this.chooseAceptGift,this)}},{key:"removeShowResult",value:function(){null!==this.idShowResult&&(game.time.events.remove(this.idShowResult),this.idShowResult=null)}},{key:"addCheckTweenMoney",value:function(){this.removeCheckTweenMoney(),this.idTweenMoney=game.time.events.add(2*Phaser.Timer.SECOND,this.onUserVarsUpdate,this)}},{key:"removeCheckTweenMoney",value:function(){null!==this.idTweenMoney&&(game.time.events.remove(this.idTweenMoney),this.idTweenMoney=null)}},{key:"chooseViewResult",value:function(e){this.event.view_result.dispatch(e),iC.instance().removeAnimClaimReward(),this.removeShowResult(),this.removeCheckTweenMoney()}},{key:"destroy",value:function(){this.removeShowResult(),this.removeCheckTweenMoney(),iC.instance().removeAnimClaimReward(),vU(wU(t.prototype),"destroy",this).call(this)}}])&&yU(n.prototype,i),o&&yU(n,o),t}();function _U(e){return(_U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function EU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function CU(e,t){return!t||"object"!==_U(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kU(e,t,n){return(kU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=PU(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function PU(e){return(PU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function OU(e,t){return(OU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var RU=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=CU(this,PU(t).call(this,game,null))).event={back:new Phaser.Signal},e.startTime=0,e.endTime=0,e.ktshowBadConnection=!1,e.dataEventRoom=new or,e.queueScreen=null,e.selectRoomScreen=null,e.rankingScreen=null,e.playRoomScreen=null,e.dialogWin=null,e.screenBegin="",e.popupTop100=null,e.checkJoinRoom=!1,e.ktPlay=!1,e.arrResource=[{type:"atlas",link:"img/atlas/eventmode.png",key:"eventmode",linkJson:"img/atlas/eventmode.json"},{type:"text",link:"img/config/positionEventMode.json",key:"positionEventMode"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OU(e,t)}(t,pm),n=t,(i=[{key:"loadFileComplete",value:function(){kU(PU(t.prototype),"loadFileComplete",this).call(this),this.addSelectRoomScreen(),this.addEvent()}},{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),mZ.instance().events.onRoomJoin.add(this.joinRoom,this),De.instance().event.bad_connection.add(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.add(this.chooseExitBadConnection,this)}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this),mZ.instance().events.onRoomJoin.remove(this.joinRoom,this),De.instance().event.bad_connection.remove(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.remove(this.chooseExitBadConnection,this)}},{key:"checkBadConnection",value:function(){!1===this.ktPlay&&!1===this.ktshowBadConnection&&null!==this.queueScreen&&(this.ktshowBadConnection=!0,iC.instance().addBadConnection())}},{key:"chooseExitBadConnection",value:function(){null!==this.queueScreen?this.queueScreen.chooseBack():this.chooseBack()}},{key:"getData",value:function(e){var t=0;switch(e.cmd){case hN.EVENT_MODE_START_GAME:this.ktPlay=!0,this.startTime=this.getTime();break;case hN.EVENT_MODE_QUESTION_RESPONSE:this.ktPlay=!0;break;case hN.EVENT_MODE_FINISH_GAME:this.ktPlay=!1,this.endTime=this.getTime(),t=parseInt((this.endTime-this.startTime)/1e3),Le.instance().logEvent(Le.play_time,t),Le.instance().logEvent(Le.pro_quiz_end_eventmode),Dl.instance().removeSound(),game.time.events.add(2*Phaser.Timer.SECOND,this.addDialogFinishGame,this,e.params.getInt(jr.question_index));break;case hN.EVENT_MODE_DONE_GAME:this.endTime=this.getTime(),t=parseInt((this.endTime-this.startTime)/1e3),Le.instance().logEvent(Le.play_time,t),Le.instance().logEvent(Le.pro_quiz_end_eventmode),game.time.events.add(2*Phaser.Timer.SECOND,this.addDialogDoneGame,this),Dl.instance().removeSound();break;case hN.EVENT_MODE_REWARD_NOTIFICATION:Dl.instance().removeSound(),game.time.events.add(.2*Phaser.Timer.SECOND,this.addDialogTop100,this,sU.begin(e.params));break;case hN.EVENT_MODE_EVENT_ENDED:Dl.instance().removeSound(),game.time.events.add(.4*Phaser.Timer.SECOND,this.addDialogEndGame,this)}}},{key:"joinRoom",value:function(e){LogConsole.log("data.room.isGame : "+e.room.isGame),e.room.isGame?this.checkJoinRoom=!0:this.addSelectRoomScreen()}},{key:"addEventScreen",value:function(){null!==this.rankingScreen&&this.rankingScreen.addEvent(),null!==this.playRoomScreen&&this.playRoomScreen.addEvent(),null!==this.selectRoomScreen&&this.selectRoomScreen.addEvent(),null!==this.queueScreen&&this.queueScreen.addEvent(this.checkJoinRoom)}},{key:"tweenCompleteQueueScreen",value:function(){zc.instance().event.tweenComplete.remove(this.tweenCompleteQueueScreen,this),this.removeQueueScreen(),this.addEventScreen()}},{key:"tweenCompleteSelectRoomScreen",value:function(){zc.instance().event.tweenComplete.remove(this.tweenCompleteSelectRoomScreen,this),this.removeSelectRoomScreen(),this.addEventScreen()}},{key:"tweenCompleteRankingScreen",value:function(){zc.instance().event.tweenComplete.remove(this.tweenCompleteRankingScreen,this),this.removeRankingScreen(),this.addEventScreen()}},{key:"addSelectRoomScreen",value:function(){this.screenBegin="selectroom",this.removeSelectRoomScreen(),this.checkJoinRoom=!1,this.selectRoomScreen=new MB,this.selectRoomScreen.event.view_history.add(this.addRankingScreen,this),this.selectRoomScreen.event.choose_event.add(this.addQueueScreen,this),this.selectRoomScreen.event.back.add(this.chooseBack,this),this.addChild(this.selectRoomScreen),LogConsole.log("this.queueScreen : "+this.queueScreen),null!==this.queueScreen?(zc.instance().beginSwitch(this.queueScreen,this.selectRoomScreen,!0),zc.instance().event.tweenComplete.add(this.tweenCompleteQueueScreen,this)):null!==this.rankingScreen?(this.removeRankingScreen(),this.selectRoomScreen.addEvent()):this.selectRoomScreen.addEvent()}},{key:"removeSelectRoomScreen",value:function(){null!==this.selectRoomScreen&&(this.removeChild(this.selectRoomScreen),this.selectRoomScreen.destroy(),this.selectRoomScreen=null)}},{key:"addQueueScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.screenBegin="queue",this.dataEventRoom=Object.assign({},this.dataEventRoom,e),this.removeQueueScreen(),this.queueScreen=new yB(this.dataEventRoom),this.queueScreen.event.ranking.add(this.addRankingScreen,this),this.queueScreen.event.back.add(this.addSelectRoomScreen,this),this.queueScreen.event.play_room.add(this.addPlayRoomScreen,this),this.addChild(this.queueScreen),null!==this.selectRoomScreen?(zc.instance().beginSwitch(this.selectRoomScreen,this.queueScreen,!1),zc.instance().event.tweenComplete.add(this.tweenCompleteSelectRoomScreen,this)):null!==this.rankingScreen?(zc.instance().beginSwitch(this.rankingScreen,this.queueScreen,!0),zc.instance().event.tweenComplete.add(this.tweenCompleteRankingScreen,this)):null!==this.playRoomScreen?(this.removePlayRoomScreen(),this.queueScreen.addEvent(this.checkJoinRoom)):this.queueScreen.addEvent(this.checkJoinRoom)}},{key:"joinRoomQueue",value:function(){this.checkJoinRoom=!0}},{key:"removeQueueScreen",value:function(){null!==this.queueScreen&&(this.removeChild(this.queueScreen),this.queueScreen.destroy(),this.queueScreen=null)}},{key:"addRankingScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e>0&&(this.event_id=e),this.removeRankingScreen(),this.rankingScreen=new rj(this.event_id),this.rankingScreen.event.back.add(this.chooseBackTop,this),this.addChild(this.rankingScreen),null!==this.queueScreen?(zc.instance().beginSwitch(this.queueScreen,this.rankingScreen,!1),zc.instance().event.tweenComplete.add(this.tweenCompleteQueueScreen,this)):null!==this.selectRoomScreen?(this.removeSelectRoomScreen(),this.rankingScreen.addEvent()):null!==this.playRoomScreen?(this.removePlayRoomScreen(),this.rankingScreen.addEvent()):this.rankingScreen.addEvent()}},{key:"chooseBackTop",value:function(){"selectroom"===this.screenBegin?this.addSelectRoomScreen():"queue"===this.screenBegin?this.addQueueScreen():"play"===this.screenBegin&&this.addPlayRoomScreen()}},{key:"removeRankingScreen",value:function(){null!==this.rankingScreen&&(this.removeChild(this.rankingScreen),this.rankingScreen.destroy(),this.rankingScreen=null)}},{key:"addPlayRoomScreen",value:function(){this.screenBegin="play",this.removePlayRoomScreen(),this.playRoomScreen=new Gj(this.dataEventRoom),this.playRoomScreen.event.backToSelect.add(this.addSelectRoomScreen,this),this.playRoomScreen.event.end_game.add(this.addDialogFinishGameUser,this),this.playRoomScreen.event.done_game.add(this.addDialogDoneGameUser,this),this.playRoomScreen.event.cancle_bad_connect.add(this.addQueueScreen,this),this.addChild(this.playRoomScreen),null!==this.queueScreen?(zc.instance().beginSwitch(this.queueScreen,this.playRoomScreen,!1),zc.instance().event.tweenComplete.add(this.tweenCompleteQueueScreen,this)):this.playRoomScreen.addEvent()}},{key:"addDialogFinishGameUser",value:function(e){this.ktPlay=!1,this.endTime=this.getTime();var t=parseInt((this.endTime-this.startTime)/1e3);Le.instance().logEvent(Le.play_time,t),Le.instance().logEvent(Le.pro_quiz_end_eventmode),Dl.instance().removeSound(),game.time.events.add(2*Phaser.Timer.SECOND,this.addDialogFinishGame,this,e)}},{key:"addDialogDoneGameUser",value:function(){this.endTime=this.getTime();var e=parseInt((this.endTime-this.startTime)/1e3);Le.instance().logEvent(Le.play_time,e),Le.instance().logEvent(Le.pro_quiz_end_eventmode),game.time.events.add(2*Phaser.Timer.SECOND,this.addDialogDoneGame,this),Dl.instance().removeSound()}},{key:"removePlayRoomScreen",value:function(){null!==this.playRoomScreen&&(this.removeChild(this.playRoomScreen),this.playRoomScreen.destroy(),this.playRoomScreen=null)}},{key:"addDialogDoneGame",value:function(){this.removePlayRoomScreen(),this.removeDialogFinishGame(),this.dialogWin=new oU(this.dataEventRoom),this.dialogWin.event.exit.add(this.chooseExitDialog,this),this.addChild(this.dialogWin)}},{key:"removeDialogDoneGame",value:function(){}},{key:"addDialogFinishGame",value:function(e){this.removePlayRoomScreen(),this.removeDialogFinishGame(),this.dialogWin=new Wj(e,this.dataEventRoom),this.dialogWin.event.exit.add(this.chooseExitDialog,this),this.dialogWin.event.continute.add(this.chooseContinuteDialog,this),this.addChild(this.dialogWin)}},{key:"chooseExitDialog",value:function(){LogConsole.log("chooseExitDialog"),this.removeDialogFinishGame(),this.addQueueScreen()}},{key:"chooseContinuteDialog",value:function(){LogConsole.log("chooseContinuteDialog"),this.removeDialogFinishGame(),this.addPlayRoomScreen()}},{key:"removeDialogFinishGame",value:function(){null!==this.dialogWin&&(this.removeChild(this.dialogWin),this.dialogWin.destroy(),this.dialogWin=null)}},{key:"addDialogTop100",value:function(e){this.removeDialogTop100(),this.popupTop100=new SU(e),this.popupTop100.event.exit.add(this.removeDialogTop100,this),this.popupTop100.event.view_result.add(this.addRankingScreen,this),this.popupTop100.event.accept_gift.add(this.removeDialogTop100,this),this.addChild(this.popupTop100)}},{key:"removeDialogTop100",value:function(){null!==this.popupTop100&&(this.removeChild(this.popupTop100),this.popupTop100.destroy(),this.popupTop100=null)}},{key:"addDialogEndGame",value:function(){this.removeDialogFinishGame(),this.addSelectRoomScreen(),iC.instance().addDialog("Sự kiện đã kết thúc")}},{key:"chooseBack",value:function(){WF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"destroy",value:function(){this.mainData.positionEventModeData=null,this.removeEvent(),kU(PU(t.prototype),"destroy",this).call(this)}}])&&EU(n.prototype,i),o&&EU(n,o),t}();function xU(e){return(xU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function TU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function IU(e,t,n){return(IU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=AU(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function AU(e){return(AU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function LU(e,t){return(LU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var DU=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=AU(t).call(this,game,null))||"object"!==xU(i)&&"function"!=typeof i?GU(n):i).event={back:new Phaser.Signal,help:new Phaser.Signal},e.positionRanking=e.mainData.positionRanking,e.bg=new rt(e.positionRanking.header_bg),e.addChild(e.bg),e.txtTitle=new St(e.positionRanking.header_text_title,"BẢNG XẾP HẠNG"),e.txtTitle.setTextBounds(0,0,game.width,31*z.instance().scale),e.addChild(e.txtTitle),e.btnBack=new pt(e.positionRanking.header_button_back,e.chooseBack,GU(GU(e))),e.addChild(e.btnBack),e.btnHelp=new pt(e.positionRanking.header_button_help,e.chooseHelp,GU(GU(e))),e.addChild(e.btnHelp),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LU(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this)}},{key:"chooseBack",value:function(){this.btnBack.inputEnabled=!1,this.event.back.dispatch()}},{key:"chooseHelp",value:function(){this.event.help.dispatch()}},{key:"destroy",value:function(){this.removeEvent(),IU(AU(t.prototype),"destroy",this).call(this)}}])&&TU(n.prototype,i),o&&TU(n,o),t}();function MU(e){return(MU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BU(e){return(BU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jU(e,t){return(jU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var FU=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=BU(t).call(this,game,null))||"object"!==MU(a)&&"function"!=typeof a?UU(o):a).event={choose_item:new Phaser.Signal},i.idx=n,i.positionRanking=i.mainData.positionRanking,i.bg=new pt(i.positionRanking.menu_item_active,i.chooseButton,UU(UU(i))),i.bg.x=0,i.bg.y=0,i.bg.alpha=0,i.bg.height=100*z.instance().scale,i.addChild(i.bg),i.txtContent=new St(i.positionRanking.menu_item_text_content,e),i.bg.width=i.txtContent.width+71*z.instance().scale,i.txtContent.x=(i.bg.width-i.txtContent.width)/2,i.txtContent.y=(i.bg.height-i.txtContent.height)/2,i.addChild(i.txtContent),i.lineActive=new rt(i.positionRanking.menu_item_active),i.lineActive.width=i.bg.width,i.addChild(i.lineActive),i.lineDoc=new rt(i.positionRanking.menu_item_line_doc),i.lineDoc.x=i.bg.width-i.lineDoc.width,i.lineDoc.y=(i.bg.height-i.lineDoc.height)/2,i.addChild(i.lineDoc),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jU(e,t)}(t,Mt),n=t,(i=[{key:"hideLineDoc",value:function(){this.lineDoc.visible=!1}},{key:"active",value:function(){this.lineActive.visible=!0,this.txtContent.changeStyle({fill:"#ffffff"})}},{key:"deactive",value:function(){this.lineActive.visible=!1,this.txtContent.changeStyle({fill:"#695782"})}},{key:"chooseButton",value:function(){this.event.choose_item.dispatch(this.idx)}},{key:"getIdx",value:function(){return this.idx}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&NU(n.prototype,i),o&&NU(n,o),t}();function ZU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var HU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"RANKING_LEVEL_LOAD_REQUEST",get:function(){return"RANKING_LEVEL_LOAD_REQUEST"}},{key:"RANKING_LEVEL_LOAD_RESPONSE",get:function(){return"RANKING_LEVEL_LOAD_RESPONSE"}},{key:"RANKING_DIAMOND_LOAD_REQUEST",get:function(){return"RANKING_DIAMOND_LOAD_REQUEST"}},{key:"RANKING_DIAMOND_LOAD_RESPONSE",get:function(){return"RANKING_DIAMOND_LOAD_RESPONSE"}},{key:"RANKING_TURNBASE_LOAD_REQUEST",get:function(){return"RANKING_TURNBASE_LOAD_REQUEST"}},{key:"RANKING_TURNBASE_LOAD_RESPONSE",get:function(){return"RANKING_TURNBASE_LOAD_RESPONSE"}},{key:"RANKING_ONLINE_LOAD_REQUEST",get:function(){return"RANKING_ONLINE_LOAD_REQUEST"}},{key:"RANKING_ONLINE_LOAD_RESPONSE",get:function(){return"RANKING_ONLINE_LOAD_RESPONSE"}},{key:"RANKING_PLAYLIST_COLLECTION_REQUEST",get:function(){return"RANKING_PLAYLIST_COLLECTION_REQUEST"}},{key:"RANKING_PLAYLIST_COLLECTION_RESPONSE",get:function(){return"RANKING_PLAYLIST_COLLECTION_RESPONSE"}}],(n=null)&&ZU(t.prototype,n),i&&ZU(t,i),e}();function QU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var VU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"position",get:function(){return"position"}},{key:"top_users",get:function(){return"top_users"}},{key:"diamond",get:function(){return"diamond"}},{key:"user_name",get:function(){return"user_name"}},{key:"created",get:function(){return"created"}},{key:"active",get:function(){return"active"}},{key:"id",get:function(){return"id"}},{key:"avatar",get:function(){return"avatar"}},{key:"updated",get:function(){return"updated"}},{key:"status",get:function(){return"status"}},{key:"level",get:function(){return"level"}},{key:"experience_score",get:function(){return"experience_score"}},{key:"gender",get:function(){return"gender"}},{key:"all_time_high_score",get:function(){return"all_time_high_score"}},{key:"last_login",get:function(){return"last_login"}},{key:"weekly_high_score",get:function(){return"weekly_high_score"}},{key:"count_win",get:function(){return"count_win"}},{key:"rank",get:function(){return"rank"}},{key:"playlist_number",get:function(){return"playlist_number"}}],(n=null)&&QU(t.prototype,n),i&&QU(t,i),e}();var WU=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diamond=0,this.user_name="",this.created=0,this.active=0,this.id=0,this.avatar="",this.updated=0,this.level=0,this.experience_score=0,this.playlist_number=0};function qU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var KU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t={position:-1,top_users:[]},n=e.getSFSArray(VU.top_users),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new WU;a.user_name=o.getUtfString(VU.user_name),a.created=o.getLong(VU.created),a.active=o.getInt(VU.active),a.id=o.getInt(VU.id),a.avatar=o.getUtfString(VU.avatar),a.updated=o.getLong(VU.updated),o.containsKey(VU.diamond)&&(a.diamond=o.getInt(VU.diamond)),o.containsKey(VU.level)&&(a.level=o.getInt(VU.level)),o.containsKey(VU.experience_score)&&(a.experience_score=o.getInt(VU.experience_score)),t.top_users.push(a)}return t.position=e.getLong(VU.position),t}}],(n=null)&&qU(t.prototype,n),i&&qU(t,i),e}();function zU(e){return(zU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YU(e,t,n){return(YU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=JU(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function JU(e){return(JU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $U(e,t,n){return t&&XU(e.prototype,t),n&&XU(e,n),e}function eF(e,t){return(eF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tF(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var nF=function(e){function t(e,n,i){var o,a,s,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=JU(t).call(this,game,null))||"object"!==zU(s)&&"function"!=typeof s?tF(a):s).data=e,o.positionRanking=JSON.parse(game.cache.getText("positionRanking"));var l=0;if(l=i===UF.TOP_DIAMOND?t.DIAMOND:t.LEVEL,o.tween=null,o.idx=n,o.ava=new Pc,o.ava.setSize(65*z.instance().scale,65*z.instance().scale),o.ava.x=149*z.instance().scale,o.ava.y=32*z.instance().scale,o.btnMaskAva=new Phaser.Button(game,o.ava.x,o.ava.y,null,o.chooseAva,tF(tF(o))),o.btnMaskAva.width=o.ava.width,o.btnMaskAva.height=o.ava.height,o.addChild(o.btnMaskAva),0===n?(o.bg=new rt(o.positionRanking.item_ranking_bg_top1),o.addChild(o.bg),o.addChild(o.ava),o.bgTopAvata=new rt(o.positionRanking.item_ranking_avatar_top1)):1===n?(o.bg=new rt(o.positionRanking.item_ranking_bg_top2),o.addChild(o.bg),o.addChild(o.ava),o.bgTopAvata=new rt(o.positionRanking.item_ranking_avatar_top2)):2===n?(o.bg=new rt(o.positionRanking.item_ranking_bg_top3),o.addChild(o.bg),o.addChild(o.ava),o.bgTopAvata=new rt(o.positionRanking.item_ranking_avatar_top3)):(o.addChild(o.ava),o.ava.x=137*z.instance().scale,o.ava.y=27*z.instance().scale,o.bgTopAvata=new rt(o.positionRanking.item_ranking_avatar_top4),o.line=new rt(o.positionRanking.item_ranking_line_space),o.addChild(o.line)),o.addChild(o.bgTopAvata),n<3?(o.txtStt=new St(o.positionRanking.item_ranking_text_top123,n+1),o.txtStt.setTextBounds(0,0,28*z.instance().scale,27*z.instance().scale),o.txtUserName=new St(o.positionRanking.item_ranking_text_user_name123,o.formatName(e.user_name,15))):(o.txtStt=new St(o.positionRanking.item_ranking_text_top4,n+1),o.txtUserName=new St(o.positionRanking.item_ranking_text_user_name4,o.formatName(e.user_name,15))),l===t.DIAMOND)o.btnDiamond=new ln(n<3?o.positionRanking.item_ranking_btn_level_top:o.positionRanking.item_ranking_btn_level_top4,e.playlist_number),o.addChild(o.btnDiamond),o.txtUserName.setTextBounds(0,0,219*z.instance().scale,60*z.instance().scale);else{var h="";i===UF.TOP_LEVEL&&(h=e.level),i!==UF.TOP_TURNBASE&&i!==UF.TOP_ONLINEMODE||(h=e.count_win),o.btnLevel=new ln(n<3?o.positionRanking.item_ranking_btn_level_top:o.positionRanking.item_ranking_btn_level_top4,h),o.addChild(o.btnLevel),o.txtUserName.setTextBounds(0,0,284*z.instance().scale,60*z.instance().scale)}return o.addChild(o.txtStt),o.addChild(o.txtUserName),r?o.ava.setAvatar(e.avatar,0):o.ava.setAvatar(e.avatar,n),!0===r||(n<8?(o.x=game.width,o.tween=game.add.tween(tF(tF(o))).to({x:0},250,Phaser.Easing.Power1,!0,80*(n+1))):o.x=0),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eF(e,t)}(t,Mt),$U(t,null,[{key:"DIAMOND",get:function(){return 0}},{key:"LEVEL",get:function(){return 1}}]),$U(t,[{key:"chooseAva",value:function(){console.log("clickAva"),iC.instance().addUserProfile(this.data.id)}},{key:"removeTween",value:function(){null!==this.tween&&(this.tween.stop(),game.tweens.remove(this.tween),this.tween=null)}},{key:"destroy",value:function(){this.removeTween(),YU(JU(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this.idx<3?145*z.instance().scale:127*z.instance().scale}}]),t}();function iF(e){return(iF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aF(e,t){return!t||"object"!==iF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sF(e,t,n){return(sF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rF(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function rF(e){return(rF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lF(e,t){return(lF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hF=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=aF(this,rF(t).call(this,game,null)),qe.instance().showLoading(),e.event={add_item:new Phaser.Signal},e.ktBuild=!1,e.dataRanking={},e.positionRanking=JSON.parse(game.cache.getText("positionRanking")),e.bgRankMe=new rt(e.positionRanking.item_ranking_bg_rank_me),e.bgRankMe.y=game.height-110*e.mainData.scale,e.addChild(e.bgRankMe),e.txtError=new St(e.positionRanking.item_ranking_txt_error,"Bạn chưa có xếp hạng"),e.txtError.setTextBounds(0,0,game.width,38*z.instance().scale),e.txtError.y=game.height-76*e.mainData.scale,e.addChild(e.txtError),e.txtError.visible=!1,e.rankMe=null,e.arrRanking=[],e.idDelay=null,e.idx=0,e.countItem=0,Le.instance().logEvent(Le.Ranking_level),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lF(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataServer.dataRankingLevel?mZ.instance().sendData(HU.RANKING_LEVEL_LOAD_REQUEST,null):(this.dataRanking=this.mainData.dataServer.dataRankingLevel,this.buildListRanking(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case HU.RANKING_LEVEL_LOAD_RESPONSE:this.dataRanking=KU.begin(e.params),this.mainData.dataServer.dataRankingLevel=this.dataRanking,this.buildListRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildListRanking",value:function(){this.arrRanking=this.dataRanking.top_users;var e=this.dataRanking.position;if(e>-1){this.txtError.visible=!1,this.removeRankMe();var t=new WU;t.id=mZ.instance().dataMySeft.id,t.user_name=mZ.instance().dataMySeft.user_name,t.avatar=mZ.instance().dataMySeft.avatar,t.diamond=mZ.instance().dataMySeft.diamond,t.level=mZ.instance().dataMySeft.level,this.rankMe=new nF(t,e-1,UF.TOP_LEVEL,!0),this.rankMe.x=0,this.rankMe.y=game.height-108*z.instance().scale,this.addChild(this.rankMe)}else this.txtError.visible=!0;this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrRanking.length;e++){var t=new nF(this.arrRanking[e],e,UF.TOP_LEVEL);if(this.event.add_item.dispatch(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrRanking.length){this.ktBuild=!1;break}this.idx===this.arrRanking.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),sF(rF(t.prototype),"destroy",this).call(this)}}])&&oF(n.prototype,i),o&&oF(n,o),t}();var cF=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gender="",this.level=0,this.user_name="",this.all_time_high_score=0,this.last_login=0,this.weekly_high_score=0,this.id=0,this.avatar="",this.count_win=0,this.playlist_number=0};function uF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var dF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t={position:{rank:-1,count_win:0,playlist_number:0},top_users:[]},n=e.getSFSArray(VU.top_users),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new cF;a.gender=o.getUtfString(VU.gender),a.level=o.getInt(VU.level),a.user_name=o.getUtfString(VU.user_name),a.all_time_high_score=o.getInt(VU.all_time_high_score),a.last_login=o.getLong(VU.last_login),a.weekly_high_score=o.getInt(VU.weekly_high_score),a.id=o.getInt(VU.id),a.avatar=o.getUtfString(VU.avatar),a.count_win=o.getLong(VU.count_win),o.containsKey(VU.playlist_number)&&(a.playlist_number=o.getLong(VU.playlist_number)),t.top_users.push(a)}var s=e.getSFSObject(VU.position);return s.containsKey(VU.rank)&&(t.position.rank=s.getInt(VU.rank),s.containsKey(VU.playlist_number)?t.position.playlist_number=s.getLong(VU.playlist_number):t.position.count_win=s.getLong(VU.count_win)),t}},{key:"compareCountWin",value:function(e,t){return e.count_win>t.count_win?-1:e.count_win<t.count_win?1:0}}],(n=null)&&uF(t.prototype,n),i&&uF(t,i),e}();function fF(e){return(fF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gF(e,t){return!t||"object"!==fF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yF(e,t,n){return(yF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mF(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function mF(e){return(mF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vF(e,t){return(vF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wF=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=gF(this,mF(t).call(this,game,null)),qe.instance().showLoading(),e.event={add_item:new Phaser.Signal},e.ktBuild=!1,e.positionRanking=e.mainData.positionRanking,e.dataRanking={},e.arrRanking=[],e.idDelay=null,e.idx=0,e.countItem=0,e.bgRankMe=new rt(e.positionRanking.item_ranking_bg_rank_me),e.bgRankMe.y=game.height-110*e.mainData.scale,e.addChild(e.bgRankMe),e.txtError=new St(e.positionRanking.item_ranking_txt_error,"Bạn chưa có xếp hạng"),e.txtError.setTextBounds(0,0,game.width,38*z.instance().scale),e.txtError.y=game.height-76*e.mainData.scale,e.addChild(e.txtError),e.txtError.visible=!1,e.rankMe=null,Le.instance().logEvent(Le.Ranking_diamond),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vF(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataServer.dataRankingDiamond?mZ.instance().sendData(HU.RANKING_PLAYLIST_COLLECTION_REQUEST,null):(this.dataRanking=this.mainData.dataServer.dataRankingDiamond,this.buildListRanking(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case HU.RANKING_PLAYLIST_COLLECTION_RESPONSE:this.dataRanking=dF.begin(e.params),this.mainData.dataServer.dataRankingDiamond=this.dataRanking,this.buildListRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildListRanking",value:function(){this.arrRanking=this.dataRanking.top_users;var e=this.dataRanking.position.rank,t=this.dataRanking.position.playlist_number;if(e>-1){this.txtError.visible=!1,this.removeRankMe();var n=new WU;n.id=mZ.instance().dataMySeft.id,n.user_name=mZ.instance().dataMySeft.user_name,n.avatar=mZ.instance().dataMySeft.avatar,n.playlist_number=t,this.rankMe=new nF(n,e-1,UF.TOP_DIAMOND,!0),this.rankMe.x=0,this.rankMe.y=game.height-108*z.instance().scale,this.addChild(this.rankMe)}else this.txtError.visible=!0;this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrRanking.length;e++){var t=new nF(this.arrRanking[e],e,UF.TOP_DIAMOND);if(this.event.add_item.dispatch(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrRanking.length){this.ktBuild=!1;break}this.idx===this.arrRanking.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),yF(mF(t.prototype),"destroy",this).call(this)}}])&&pF(n.prototype,i),o&&pF(n,o),t}();function bF(e){return(bF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _F(e,t){return!t||"object"!==bF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function EF(e,t,n){return(EF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CF(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CF(e){return(CF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kF(e,t){return(kF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var PF=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=_F(this,CF(t).call(this,game,null)),qe.instance().showLoading(),e.event={add_item:new Phaser.Signal},e.ktBuild=!1,e.dataRanking={},e.positionRanking=JSON.parse(game.cache.getText("positionRanking")),e.bgRankMe=new rt(e.positionRanking.item_ranking_bg_rank_me),e.bgRankMe.y=game.height-110*e.mainData.scale,e.addChild(e.bgRankMe),e.txtError=new St(e.positionRanking.item_ranking_txt_error,"Bạn chưa có xếp hạng"),e.txtError.setTextBounds(0,0,game.width,38*z.instance().scale),e.txtError.y=game.height-76*e.mainData.scale,e.addChild(e.txtError),e.txtError.visible=!1,console.log(2),e.rankMe=null,e.arrRanking=[],e.idDelay=null,e.idx=0,e.countItem=0,Le.instance().logEvent(Le.Ranking_turnbase),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kF(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){LogConsole.log("addEvent---------"),mZ.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataServer.dataRankingTurnBase?mZ.instance().sendData(HU.RANKING_TURNBASE_LOAD_REQUEST,null):(this.dataRanking=this.mainData.dataServer.dataRankingTurnBase,this.buildListRanking(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case HU.RANKING_TURNBASE_LOAD_RESPONSE:console.log("aaa"),this.dataRanking=dF.begin(e.params),this.mainData.dataServer.dataRankingTurnBase=this.dataRanking,this.buildListRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildListRanking",value:function(){this.arrRanking=this.dataRanking.top_users;var e=this.dataRanking.position;if(LogConsole.log(e),e.rank>-1){this.txtError.visible=!1,this.removeRankMe();var t=new cF;t.id=mZ.instance().dataMySeft.id,t.avatar=mZ.instance().dataMySeft.avatar,t.user_name=mZ.instance().dataMySeft.user_name,t.count_win=e.count_win,this.rankMe=new nF(t,e.rank-1,UF.TOP_TURNBASE,!0),this.rankMe.x=0,this.rankMe.y=game.height-108*z.instance().scale,this.addChild(this.rankMe)}else this.txtError.visible=!0;this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrRanking.length;e++){var t=new nF(this.arrRanking[e],e,UF.TOP_TURNBASE);if(this.event.add_item.dispatch(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrRanking.length){this.ktBuild=!1;break}this.idx===this.arrRanking.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),EF(CF(t.prototype),"destroy",this).call(this)}}])&&SF(n.prototype,i),o&&SF(n,o),t}();function OF(e){return(OF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xF(e,t){return!t||"object"!==OF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TF(e,t,n){return(TF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=IF(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function IF(e){return(IF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AF(e,t){return(AF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LF=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=xF(this,IF(t).call(this,game,null)),qe.instance().showLoading(),e.event={add_item:new Phaser.Signal},e.ktBuild=!1,e.dataRanking={},e.positionRanking=JSON.parse(game.cache.getText("positionRanking")),e.bgRankMe=new rt(e.positionRanking.item_ranking_bg_rank_me),e.bgRankMe.y=game.height-110*e.mainData.scale,e.addChild(e.bgRankMe),e.txtError=new St(e.positionRanking.item_ranking_txt_error,"Bạn chưa có xếp hạng"),e.txtError.setTextBounds(0,0,game.width,38*z.instance().scale),e.txtError.y=game.height-76*e.mainData.scale,e.addChild(e.txtError),e.txtError.visible=!1,e.rankMe=null,e.arrRanking=[],e.idDelay=null,e.idx=0,e.countItem=0,Le.instance().logEvent(Le.Ranking_online),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AF(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){mZ.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataServer.dataRankingOnlineMode?mZ.instance().sendData(HU.RANKING_ONLINE_LOAD_REQUEST,null):(this.dataRanking=this.mainData.dataServer.dataRankingOnlineMode,this.buildListRanking(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){mZ.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case HU.RANKING_ONLINE_LOAD_RESPONSE:this.dataRanking=dF.begin(e.params),this.mainData.dataServer.dataRankingOnlineMode=this.dataRanking,this.buildListRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildListRanking",value:function(){this.arrRanking=this.dataRanking.top_users;var e=this.dataRanking.position;if(LogConsole.log(e),e.rank>-1){this.txtError.visible=!1,this.removeRankMe();var t=new cF;t.id=mZ.instance().dataMySeft.id,t.avatar=mZ.instance().dataMySeft.avatar,t.user_name=mZ.instance().dataMySeft.user_name,t.count_win=e.count_win,this.rankMe=new nF(t,e.rank-1,UF.TOP_ONLINEMODE,!0),this.rankMe.x=0,this.rankMe.y=game.height-108*z.instance().scale,this.addChild(this.rankMe)}else this.txtError.visible=!0;this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrRanking.length;e++){var t=new nF(this.arrRanking[e],e,UF.TOP_ONLINEMODE);if(this.event.add_item.dispatch(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrRanking.length){this.ktBuild=!1;break}this.idx===this.arrRanking.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),TF(IF(t.prototype),"destroy",this).call(this)}}])&&RF(n.prototype,i),o&&RF(n,o),t}();function GF(e){return(GF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function MF(e,t){return!t||"object"!==GF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NF(e,t,n){return(NF="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=BF(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function BF(e){return(BF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jF(e,t){return(jF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var UF=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=MF(this,BF(t).call(this,game,null))).event={back:new Phaser.Signal},e.idEvent=null,e.topLevel=null,e.topDiamond=null,e.topTurnBase=null,e.topOnlineMode=null,e.idEventCanClick,e.tabIdx=n,e.arrTabMenu=[],e.ktAddHelp=!1,e.arrStringTab=["Top Level","Top Playlist","Top Chiến Thắng","Top Vô Địch"],e.arrHelp=["Top 100 người có LEVEL cao nhất (cập nhật sau 10 phút)","Top 100 người có số lượng PLAYLIST nhiều nhất (cập nhật sau 10 phút)","Top 100 người có số trận thắng nhiều trong tuần nhất ở thể loại THÁCH ĐẤU (cập nhật sau 10 phút)","Top 100 người có số trận thắng nhiều nhất trong tuần ở thể loại CHƠI NHANH (cập nhật sau 10 phút)"],e.arrResource=[{type:"text",link:"img/config/positionRanking.json",key:"positionRanking"},{type:"atlas",link:"img/atlas/ranking.png",key:"ranking",linkJson:"img/atlas/ranking.json"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jF(e,t)}(t,pm),n=t,o=[{key:"TOP_LEVEL",get:function(){return 0}},{key:"TOP_DIAMOND",get:function(){return 1}},{key:"TOP_TURNBASE",get:function(){return 2}},{key:"TOP_ONLINEMODE",get:function(){return 3}}],(i=[{key:"loadFileComplete",value:function(){NF(BF(t.prototype),"loadFileComplete",this).call(this),this.positionRanking=this.mainData.positionRanking,this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new Phaser.Group(game,0,0,null);this.listRanking=new Jo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-310*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),this.listRanking.events.changeIndex.add(this.changeIndex,this),e.x=0,e.y=200*z.instance().scale,this.addChild(e),this.header=new DU,this.header.event.back.add(this.backHeader,this),this.header.event.help.add(this.chooseHelp,this),this.addChild(this.header),this.popupHelp=null,this.bgTabMenu=new Zt(this.positionRanking.menu_bg_all),this.addChild(this.bgTabMenu);var n=new Phaser.Group(game,0,0,null);this.listMenu=new Jo(game,n,new Phaser.Rectangle(0,0,game.width,100*z.instance().scale),{direction:"x",padding:0,searchForClicks:!0}),n.x=0,n.y=100*z.instance().scale,this.addChild(n);for(var i=0;i<this.arrStringTab.length;i++){var o=new FU(this.arrStringTab[i],i);o.event.choose_item.add(this.chooseTabMenu,this),i===this.tabIdx?o.active():o.deactive(),i===this.arrStringTab.length-1&&o.hideLineDoc(),this.listMenu.add(o),this.arrTabMenu.push(o)}this.listMenu.tweenToItem(this.tabIdx),this.buildListTop(),ce.instance().playSound(ce.showranking)}},{key:"chooseHelp",value:function(){this.ktAddHelp=!this.ktAddHelp,!0===this.ktAddHelp?this.addPopupHelp():this.removePopupHelp()}},{key:"addPopupHelp",value:function(){this.removePopupHelp(),this.popupHelp=new Kt(this.arrHelp[this.tabIdx]),this.popupHelp.y=83*z.instance().scale,this.popupHelp.x=game.width-this.popupHelp.width-71*z.instance().scale,game.world.add(this.popupHelp)}},{key:"removePopupHelp",value:function(){null!==this.popupHelp&&(game.world.remove(this.popupHelp),this.popupHelp.destroy(),this.popupHelp=null)}},{key:"chooseTabMenu",value:function(e){if(e===this.tabIdx);else{for(var t=0;t<this.arrTabMenu.length;t++){var n=this.arrTabMenu[t];n.getIdx()===e?n.active():n.deactive()}if(e<this.tabIdx){var i=e-1;i<0&&(i=0),this.listMenu.tweenToItem(i)}else{var o=e+1;o>this.arrTabMenu.length-1&&(o=this.arrTabMenu.length-1),this.listMenu.tweenToItem(o)}this.tabIdx=e,this.buildListTop()}}},{key:"buildListTop",value:function(){switch(this.removePopupHelp(),this.ktAddHelp=!1,this.listRanking.removeAll(),this.listRanking.reset(),this.tabIdx){case t.TOP_LEVEL:Le.instance().logEvent(Le.Ranking_level_button),this.addTopLevel();break;case t.TOP_DIAMOND:Le.instance().logEvent(Le.Ranking_diamond_button),this.addTopDiamond();break;case t.TOP_TURNBASE:Le.instance().logEvent(Le.Ranking_turnbase_button),this.addTopTurnBase();break;case t.TOP_ONLINEMODE:Le.instance().logEvent(Le.Ranking_online_button),this.addTopOnlineMode()}this.removeAddEvent(),this.idEvent=game.time.events.add(.2*Phaser.Timer.SECOND,this.addEventAll,this)}},{key:"removeAddEvent",value:function(){null!==this.idEvent&&game.time.events.remove(this.idEvent)}},{key:"removeAll",value:function(){this.removeTopDiamond(),this.removeTopLevel(),this.removeTopOnlineMode(),this.removeTopTurnBase()}},{key:"addEventAll",value:function(){null!==this.topLevel&&this.topLevel.addEvent(),null!==this.topDiamond&&this.topDiamond.addEvent(),null!==this.topTurnBase&&this.topTurnBase.addEvent(),null!==this.topOnlineMode&&this.topOnlineMode.addEvent()}},{key:"addTopLevel",value:function(){this.removeAll(),this.topLevel=new hF,this.topLevel.event.add_item.add(this.addItemRank,this),this.addChild(this.topLevel),this.addChild(this.header)}},{key:"removeTopLevel",value:function(){null!==this.topLevel&&(this.removeChild(this.topLevel),this.topLevel.event.add_item.remove(this.addItemRank,this),this.topLevel.destroy(),this.topLevel=null)}},{key:"addTopDiamond",value:function(){this.removeAll(),this.topDiamond=new wF,this.topDiamond.event.add_item.add(this.addItemRank,this),this.addChild(this.topDiamond),this.addChild(this.header)}},{key:"removeTopDiamond",value:function(){null!==this.topDiamond&&(this.topDiamond.event.add_item.remove(this.addItemRank,this),this.removeChild(this.topDiamond),this.topDiamond.destroy(),this.topDiamond=null)}},{key:"addTopTurnBase",value:function(){this.removeAll(),this.topTurnBase=new PF,this.topTurnBase.event.add_item.add(this.addItemRank,this),this.addChild(this.topTurnBase),this.addChild(this.header)}},{key:"removeTopTurnBase",value:function(){null!==this.topTurnBase&&(this.removeChild(this.topTurnBase),this.topTurnBase.event.add_item.remove(this.addItemRank,this),this.topTurnBase.destroy(),this.topTurnBase=null)}},{key:"addTopOnlineMode",value:function(){this.removeAll(),this.topOnlineMode=new LF,this.topOnlineMode.event.add_item.add(this.addItemRank,this),this.addChild(this.topOnlineMode),this.addChild(this.header)}},{key:"removeTopOnlineMode",value:function(){null!==this.topOnlineMode&&(this.removeChild(this.topOnlineMode),this.topOnlineMode.event.add_item.remove(this.addItemRank,this),this.topOnlineMode.destroy(),this.topOnlineMode=null)}},{key:"changeIndex",value:function(){var e=this.listRanking.getIdx();null!==this.topLevel&&this.topLevel.changeIndex(e),null!==this.topDiamond&&this.topDiamond.changeIndex(e),null!==this.topTurnBase&&this.topTurnBase.changeIndex(e),null!==this.topOnlineMode&&this.topOnlineMode.changeIndex(e)}},{key:"addItemRank",value:function(e){this.listRanking.add(e)}},{key:"backHeader",value:function(){WF.instance().changeScreen(Ce.MAIN_MENU,{})}},{key:"destroy",value:function(){this.mainData.positionRankingData=null,this.listRanking.events.changeIndex.remove(this.changeIndex,this),this.removePopupHelp(),this.removeAddEvent(),this.removeEvent(),this.removeAll(),this.listRanking.removeAll(),this.listRanking.destroy(),NF(BF(t.prototype),"destroy",this).call(this)}}])&&DF(n.prototype,i),o&&DF(n,o),t}();function FF(e){return(FF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function HF(e,t){return!t||"object"!==FF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function QF(e){return(QF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VF(e,t){return(VF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var WF=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=HF(this,QF(t).call(this,game))).screen=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VF(e,t)}(t,Phaser.Group),n=t,o=[{key:"instance",value:function(){return this.controllScreen||(this.controllScreen=new t),this.controllScreen}}],(i=[{key:"removeScreen",value:function(){null!==this.screen&&(this.removeChild(this.screen),this.screen.destroy(),this.screen=null)}},{key:"changeScreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(this.removeScreen(),LogConsole.log(e),z.instance().state=e,qe.instance().showLoading(),iC.instance().removeTextScroll(),e){case Ce.LOGIN:this.screen=new hC;break;case Ce.MAIN_MENU:this.screen=new YR;break;case Ce.ONLINE_MODE:this.screen=new IG,iC.instance().removeAllItem();break;case Ce.QUEST_ACHIEVEMENT:this.screen=new iM(t);break;case Ce.TURN_BASE:this.screen=null!==t?new ng(t.opponent,t.type,t):new ng(t,t);break;case Ce.SOLO_MODE:this.screen=new TR(t);break;case Ce.NEW_USER:this.screen=new tN;break;case Ce.EVENT_MODE:this.screen=new RU;break;case Ce.RANKING_ALL:this.screen=new UF}this.addChild(this.screen)}}])&&ZF(n.prototype,i),o&&ZF(n,o),t}();function qF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var KF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.user_name="",this.avatar="",this.gender="",this.experience_score=0,this.heart=0,this.diamond=0,this.ticket=0,this.weekly_high_score=0,this.all_time_high_score=0,this.online_mode_genre=0,this.level=1,this.vip=0,this.is_playing_game=!1,this.support_item=0,this.lag_value=0,this.current_level_score=0,this.next_level_score=0,this.description="",this.level_title="",this.vip_expired=0}var t,n,i;return t=e,(n=[{key:"setUserName",value:function(e){this.user_name=e,mZ.instance().events.onUserVarsUpdate.dispatch()}},{key:"setGender",value:function(e){this.gender=e,mZ.instance().events.onUserVarsUpdate.dispatch()}},{key:"setDescription",value:function(e){this.description=e,mZ.instance().events.onUserVarsUpdate.dispatch()}},{key:"setAvatar",value:function(e){this.avatar=e,mZ.instance().events.onUserVarsUpdate.dispatch()}}])&&qF(t.prototype,n),i&&qF(t,i),e}();function zF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var YF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"gender",get:function(){return"gender"}},{key:"experience_score",get:function(){return"experience_score"}},{key:"heart",get:function(){return"heart"}},{key:"diamond",get:function(){return"diamond"}},{key:"ticket",get:function(){return"ticket"}},{key:"weekly_high_score",get:function(){return"weekly_high_score"}},{key:"all_time_high_score",get:function(){return"all_time_high_score"}},{key:"online_mode_genre",get:function(){return"online_mode_genre"}},{key:"level",get:function(){return"level"}},{key:"level_up_to",get:function(){return"level_up_to"}},{key:"is_playing_game",get:function(){return"is_playing_game"}},{key:"message",get:function(){return"message"}},{key:"status",get:function(){return"status"}},{key:"support_item",get:function(){return"support_item"}},{key:"lag_value",get:function(){return"lag_value"}},{key:"current_level_score",get:function(){return"current_level_score"}},{key:"next_level_score",get:function(){return"next_level_score"}},{key:"description",get:function(){return"description"}},{key:"level_title",get:function(){return"level_title"}},{key:"vip_expired",get:function(){return"vip_expired"}}],(n=null)&&zF(t.prototype,n),i&&zF(t,i),e}();function JF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var XF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new KF;return t.user_id=e.getVariable(YF.user_id).value,t.user_name=e.getVariable(YF.user_name).value,e.getVariable(YF.avatar)&&(t.avatar=e.getVariable(YF.avatar).value),e.getVariable(YF.gender)&&(t.gender=e.getVariable(YF.gender).value),e.getVariable(YF.experience_score)&&(t.experience_score=e.getVariable(YF.experience_score).value),e.getVariable(YF.heart)&&(t.heart=e.getVariable(YF.heart).value),e.getVariable(YF.diamond)&&(t.diamond=e.getVariable(YF.diamond).value),e.getVariable(YF.ticket)&&(t.ticket=e.getVariable(YF.ticket).value),e.getVariable(YF.weekly_high_score)&&(t.weekly_high_score=e.getVariable(YF.weekly_high_score).value),e.getVariable(YF.all_time_high_score)&&(t.all_time_high_score=e.getVariable(YF.all_time_high_score).value),e.getVariable(YF.online_mode_genre)&&(t.online_mode_genre=e.getVariable(YF.online_mode_genre).value),e.getVariable(YF.level)&&(t.level=e.getVariable(YF.level).value),e.getVariable(YF.is_playing_game)&&(t.is_playing_game=e.getVariable(YF.is_playing_game).value),e.getVariable(YF.support_item)&&(t.support_item=e.getVariable(YF.support_item).value),e.getVariable(YF.lag_value)&&(t.lag_value=e.getVariable(YF.lag_value).value),e.getVariable(YF.description)&&(t.description=e.getVariable(YF.description).value),e.getVariable(YF.level_title)&&(t.level_title=e.getVariable(YF.level_title).value),e.getVariable(YF.vip_expired)&&(t.vip_expired=e.getVariable(YF.vip_expired).value),t}}],(n=null)&&JF(t.prototype,n),i&&JF(t,i),e}();function $F(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var eZ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"handle",value:function(e){var t=new Fr;if(e.containsKey(Fr.get_quest)){var n=e.getSFSObject("quest");t.reward=n.getInt("reward"),t.id=n.getInt("id"),t.quest=n.getUtfString("quest"),t.required=n.getInt("required"),t.quest_type=n.getInt("quest_type"),t.order=n.getInt("order"),t.reward_type=n.getUtfString("reward_type")}return t}}],(n=null)&&$F(t.prototype,n),i&&$F(t,i),e}();function tZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var nZ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"achievement",get:function(){return"achievement"}},{key:"reward",get:function(){return"reward"}},{key:"condition",get:function(){return"condition"}},{key:"achievement_type_id",get:function(){return"achievement_type_id"}},{key:"is_done",get:function(){return"is_done"}},{key:"reward_type",get:function(){return"reward_type"}},{key:"medal",get:function(){return"medal"}},{key:"achieved",get:function(){return"achieved"}},{key:"id",get:function(){return"id"}},{key:"title",get:function(){return"title"}},{key:"required",get:function(){return"required"}},{key:"new_level",get:function(){return"new_level"}}],(n=null)&&tZ(t.prototype,n),i&&tZ(t,i),e}();function iZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var oZ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"handle",value:function(e){var t={reward:0,reward_type:"",medal:"",title:"",new_level:0};if(e.containsKey(nZ.achievement)){var n=e.getSFSObject(nZ.achievement);t.reward=n.getInt(nZ.reward),t.reward_type=n.getUtfString(nZ.reward_type),t.medal=n.getUtfString(nZ.medal),t.title=n.getUtfString(nZ.title),t.new_level=n.getInt(nZ.new_level)}return t}}],(n=null)&&iZ(t.prototype,n),i&&iZ(t,i),e}();function aZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var sZ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"handle",value:function(e){var t=new JG;if(e.containsKey(JG.get_daily_quest)){var n=e.getSFSObject("daily_quest");t.reward=n.getInt("reward"),t.reward_type=n.getUtfString("reward_type"),t.id=n.getInt("id"),t.quest=n.getUtfString("quest"),t.required=n.getInt("required"),t.quest_type=n.getInt("quest_type")}return t}}],(n=null)&&aZ(t.prototype,n),i&&aZ(t,i),e}();function rZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var lZ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.arrNotify=[],this.isShow=!1,this.textScroll=null,this.idDelayTime=null}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllTextScroller||(this.controllTextScroller=new e),this.controllTextScroller}}],(n=[{key:"addNotify",value:function(e){var t={message:"",show_times:0,pending_time_in_second:0};t.message=e.getUtfString("message"),t.show_times=e.getInt("show_times"),t.pending_time_in_second=e.getInt("pending_time_in_second"),this.arrNotify.push(t),!1===this.isShow&&this.showNotify()}},{key:"showNotify",value:function(){this.arrNotify.length>0&&this.addTextScroll(this.arrNotify[0].message)}},{key:"checkShowNotify",value:function(){this.arrNotify.length>0?(this.arrNotify[0].show_times=this.arrNotify[0].show_times-1,this.arrNotify[0].show_times<1?(this.arrNotify.shift(),this.arrNotify.length>0?this.showNotify():(this.removeTextScroll(),this.isShow=!1)):(this.removeTextScroll(),this.removeDelaytime(),this.idDelayTime=game.time.events.add(Phaser.Timer.SECOND*this.arrNotify[0].pending_time_in_second,this.showNotify,this))):(this.removeTextScroll(),this.isShow=!1)}},{key:"removeDelaytime",value:function(){null!==this.idDelayTime&&(game.time.events.remove(this.idDelayTime),this.idDelayTime=null)}},{key:"addTextScroll",value:function(e){this.isShow=!0,this.removeTextScroll(),this.textScroll=new jb(e),this.textScroll.event.complete.add(this.checkShowNotify,this),Gn.instance().addChild(this.textScroll)}},{key:"removeTextScroll",value:function(){null!==this.textScroll&&(Gn.instance().removeChild(this.textScroll),this.textScroll.destroy(),this.textScroll=null)}}])&&rZ(t.prototype,n),i&&rZ(t,i),e}();function hZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var cZ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.request=null}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllTurnbaseRequestUpdate||(this.controllTurnbaseRequestUpdate=new e),this.controllTurnbaseRequestUpdate}}],(n=[{key:"getUpdate",value:function(e){var t=e.getInt(Mn.user_id),n=e.getUtfString(Mn.user_name),i=e.getUtfString(Mn.avatar),o=e.getSFSObject(Mn.weekly_result),a=o.getInt(Mn.user_won),s=o.getInt(Mn.opponent_won),r=e.getUtfString(Mn.status),l=e.getLong(Mn.updated),h=Bn.formatChallengeGameUpdated(l),c=e.getUtfString(Mn.challenge_msg),u=null,d=0,f=0;"THEIR_TURN"==r?e.containsKey(Mn.can_be_poked)&&(u=e.getInt(Mn.can_be_poked)):"YOUR_TURN"==r&&e.containsKey(Mn.poked)&&(d=e.getInt(Mn.poked),f=e.getLong(Mn.poked_at));var p=e.getInt(Mn.turn_count);return{opponentEntity:{id:t,userName:n,avatar:i,is_online:e.getBool(Mn.is_online)},weeklyResult:{userWon:a,opponentWon:s},turnCount:p,status:r,can_be_poked:u,poked:d,poked_at:f,updated:h,base_updated:l,challenge_request_id:e.getLong(Mn.challenge_request_id),challenge_msg:c}}}])&&hZ(t.prototype,n),i&&hZ(t,i),e}();function uZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var dZ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.quest_log=null}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllQuestLogUpdate||(this.controllQuestLogUpdate=new e),this.controllQuestLogUpdate}}],(n=[{key:"getUpdate",value:function(e){var t={};if(e.containsKey("quest_log")){var n=e.getSFSObject("quest_log");t.user_id=n.getInt("user_id"),t.created=n.getLong("created"),t.quest_id=n.getInt("quest_id"),t.id=n.getLong("id"),t.state=n.getUtfString("state"),t.updated=n.getLong("updated")}return t}}])&&uZ(t.prototype,n),i&&uZ(t,i),e}();function fZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var pZ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.checkLoadMessages=!1}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllMessages||(this.controllMessages=new e),this.controllMessages}},{key:"begin",value:function(e){var t=[];if(e.containsKey("user_messages")){for(var n=e.getSFSArray("user_messages"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getInt("is_read"),s=o.getLong("created"),r=o.getInt("from"),l=o.getLong("id"),h=o.getInt("to"),c=o.getUtfString("state"),u=o.getUtfString("message"),d=o.getLong("updated");t.push({is_read:a,created:s,from:r,id:l,to:h,state:c,message:u,updated:d})}t.sort(function(e,t){return e.id-t.id})}return t}},{key:"getUsers",value:function(e){var t=[];if(e.containsKey("users"))for(var n=e.getSFSArray("users"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getInt("level"),s=o.getUtfString("user_name"),r=o.getInt("id"),l=o.getUtfString("avatar");t.push({level:a,user_name:s,id:r,avatar:l})}return t}},{key:"getSystemMessages",value:function(e){var t=[];if(e.containsKey("system_messages"))for(var n=e.getSFSArray("system_messages"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getInt("is_read"),s=o.getLong("created"),r=o.getLong("message_content_id"),l=o.getUtfString("control"),h=o.getUtfString("title"),c=o.getUtfString("message");t.push({is_read:a,created:s,message_content_id:r,control:l,title:h,message:c})}return t.sort(function(e,t){return e.message_content_id-t.message_content_id}),t}}],(n=null)&&fZ(t.prototype,n),i&&fZ(t,i),e}();function gZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yZ(e,t,n){return t&&gZ(e.prototype,t),n&&gZ(e,n),e}var mZ=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.socket=null,this.ktLogin=!1,this.timeBegin=0,this.idPing=null,this.events={onConnection:new Phaser.Signal,onConnectionLost:new Phaser.Signal,onLoginError:new Phaser.Signal,onLogin:new Phaser.Signal,onRoomJoinError:new Phaser.Signal,onRoomJoin:new Phaser.Signal,onPublicMessage:new Phaser.Signal,onPrivateMessage:new Phaser.Signal,onUserEnterRoom:new Phaser.Signal,onUserExitRoom:new Phaser.Signal,onUserCountChange:new Phaser.Signal,onRoomRemove:new Phaser.Signal,onRoomAdd:new Phaser.Signal,onExtensionResponse:new Phaser.Signal,onRoomCreationError:new Phaser.Signal,onRoomVarsUpdate:new Phaser.Signal,onSpectatorToPlayer:new Phaser.Signal,onSpectatorToPlayerError:new Phaser.Signal,onPlayerToSpectator:new Phaser.Signal,onPlayerToSpectatorError:new Phaser.Signal,onUserVarsUpdate:new Phaser.Signal,onGroupSubscribed:new Phaser.Signal,onGroupSubscribedError:new Phaser.Signal,onGroupUnsubscribed:new Phaser.Signal,onGroupUnsubscribedError:new Phaser.Signal,onInvitation:new Phaser.Signal,onInvitationReply:new Phaser.Signal,onInvitationReplyError:new Phaser.Signal,onRoomFindResult:new Phaser.Signal,onAdminMessage:new Phaser.Signal,onModeratorMessage:new Phaser.Signal},this.roomLobby=null,this.ktPlay=!1,this.idxPing=null,this.dataMySeft=null}return yZ(e,null,[{key:"instance",value:function(){return this.socketController||(this.socketController=new e),this.socketController}}]),yZ(e,[{key:"initListenerSfs",value:function(e){LogConsole.log("initListenerSfs"),this.removeAllEvent(),this.socket=null,this.socket=new SFS2X.SmartFox(e),this.addEvent(SFS2X.SFSEvent.CONNECTION,this.onConnectionCallback),this.addEvent(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLostCallback),this.addEvent(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginErrorCallback),this.addEvent(SFS2X.SFSEvent.LOGIN,this.onLoginCallback),this.addEvent(SFS2X.SFSEvent.LOGOUT,this.onLogoutCallback),this.addEvent(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinErrorCallback),this.addEvent(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoinCallback),this.addEvent(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessageCallback),this.addEvent(SFS2X.SFSEvent.USER_ENTER_ROOM,this.onUserEnterRoomCallback),this.addEvent(SFS2X.SFSEvent.USER_EXIT_ROOM,this.onUserExitRoomCallback),this.addEvent(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponseCallback),this.addEvent(SFS2X.SFSEvent.ROOM_VARIABLES_UPDATE,this.onRoomVarsUpdateCallback),this.addEvent(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVarsUpdateCallback),this.addEvent(SFS2X.SFSEvent.INVITATION,this.onInvitationCallback),this.addEvent(SFS2X.SFSEvent.INVITATION_REPLY,this.onInvitationReplyCallback),this.addEvent(SFS2X.SFSEvent.INVITATION_REPLY_ERROR,this.onInvitationReplyErrorCallback),this.addEvent(SFS2X.SFSEvent.PING_PONG,this.onPingPong),this.callPingServer()}},{key:"removeAllEvent",value:function(){this.removeEvent(SFS2X.SFSEvent.CONNECTION,this.onConnectionCallback),this.removeEvent(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLostCallback),this.removeEvent(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginErrorCallback),this.removeEvent(SFS2X.SFSEvent.LOGIN,this.onLoginCallback),this.removeEvent(SFS2X.SFSEvent.LOGOUT,this.onLogoutCallback),this.removeEvent(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinErrorCallback),this.removeEvent(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoinCallback),this.removeEvent(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessageCallback),this.removeEvent(SFS2X.SFSEvent.USER_ENTER_ROOM,this.onUserEnterRoomCallback),this.removeEvent(SFS2X.SFSEvent.USER_EXIT_ROOM,this.onUserExitRoomCallback),this.removeEvent(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponseCallback),this.removeEvent(SFS2X.SFSEvent.ROOM_VARIABLES_UPDATE,this.onRoomVarsUpdateCallback),this.removeEvent(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVarsUpdateCallback),this.removeEvent(SFS2X.SFSEvent.INVITATION,this.onInvitationCallback),this.removeEvent(SFS2X.SFSEvent.INVITATION_REPLY,this.onInvitationReplyCallback),this.removeEvent(SFS2X.SFSEvent.INVITATION_REPLY_ERROR,this.onInvitationReplyErrorCallback),this.removeEvent(SFS2X.SFSEvent.PING_PONG,this.onPingPong)}},{key:"getTime",value:function(){return(new Date).getTime()}},{key:"callPingServer",value:function(){this.timeBegin=this.getTime(),$.ajax({type:"GET",url:"https://cdn.gamezoka.com/storage/mp3/ping/pong.txt?time="+this.getTime(),data:{},dataType:"json",success:this.successPing.bind(this),error:this.errorPing.bind(this)})}},{key:"successPing",value:function(){this.checkPingServer()}},{key:"errorPing",value:function(){this.checkPingServer()}},{key:"checkPingServer",value:function(){var e=((64e3/((this.getTime()-this.timeBegin)/1e3)).toFixed(2)/1024).toFixed(2),t=((e/1024).toFixed(2),e);null!==this.dataMySeft&&(this.dataMySeft.lag_value=t),this.removeIdBadConnect(),this.idPing=game.time.events.add(2*Phaser.Timer.SECOND,this.callPingServer,this)}},{key:"removeIdBadConnect",value:function(){null!==this.idPing&&game.time.events.remove(this.idPing)}},{key:"onPingPong",value:function(e){}},{key:"onPublicMessageCallback",value:function(e){this.events.onPublicMessage.dispatch(e)}},{key:"onInvitationCallback",value:function(e){LogConsole.log("onInvitation : "+this.dataMySeft.is_playing_game),LogConsole.log(e),LogConsole.log("playScript.playing_guide : "+z.instance().playScript.playing_guide),!0===this.dataMySeft.is_playing_game||z.instance().playScript.playing_guide!==en.DONE_ALL||iC.instance().addDialogInviteFriend(e.invitation),this.events.onInvitation.dispatch(e)}},{key:"onInvitationReplyCallback",value:function(e){this.events.onInvitationReply.dispatch(e)}},{key:"onInvitationReplyErrorCallback",value:function(e){LogConsole.log("onInvitationReplyError"),LogConsole.log(e),LogConsole.log(e.errorMessage),iC.instance().addDialog(e.errorMessage),this.events.onInvitationReplyError.dispatch(e)}},{key:"onRoomVarsUpdateCallback",value:function(e){this.events.onRoomVarsUpdate.dispatch(e)}},{key:"onUserVarsUpdateCallback",value:function(e){e.user.isItMe&&this.updateMySeft(),this.events.onUserVarsUpdate.dispatch(e)}},{key:"onUserEnterRoomCallback",value:function(e){this.events.onUserEnterRoom.dispatch(e)}},{key:"onUserExitRoomCallback",value:function(e){e.room.isGame&&e.user.isItMe&&(this.ktPlay=!1),this.events.onUserExitRoom.dispatch(e)}},{key:"connect",value:function(){LogConsole.log("connect sv"),qe.instance().showLoading(),this.socket.connect()}},{key:"addEvent",value:function(e,t){this.socket.addEventListener(e,t,this)}},{key:"removeEvent",value:function(e,t){null!==this.socket&&this.socket.removeEventListener(e,t,this)}},{key:"onConnectionCallback",value:function(e){this.events.onConnection.dispatch(e),De.instance().event.onConnectServer.dispatch()}},{key:"onConnectionLostCallback",value:function(e){this.roomLobby=null,1==z.instance().LOGED_IN&&(iC.instance().removeAllItem(),Gn.instance().addPopupDisconnect()),this.removeReplayPing(),rl.instance().hide(),this.events.onConnectionLost.dispatch(e)}},{key:"onLoginErrorCallback",value:function(e){LogConsole.log("onLoginErrorCallback-------------------"),LogConsole.log(e),this.events.onLoginError.dispatch(e)}},{key:"onLoginCallback",value:function(e){LogConsole.log("onLoginCallback-------------------"),z.instance().LOGED_IN=!0,LogConsole.log(e),this.socket.enableLagMonitor(!0),this.events.onLogin.dispatch(e)}},{key:"onLogoutCallback",value:function(e){LogConsole.log("onLogoutCallback-------------------"),LogConsole.log(e),z.instance().LOGED_IN=!1,iC.instance().removeAllItem(),qe.instance().showLoading(),Gn.instance().removeAllItem(),z.instance().dataServer.resetDataServer(),Kr.instance().resetData(),this.removeReplayPing(),WF.instance().changeScreen(Ce.LOGIN)}},{key:"updateMySeft",value:function(){null!==this.socket.mySelf&&(this.dataMySeft=XF.begin(this.socket.mySelf))}},{key:"onRoomJoinErrorCallback",value:function(e){LogConsole.log("onRoomJoinErrorCallback-------------------"),LogConsole.log(e),this.events.onRoomJoinError.dispatch(e)}},{key:"onRoomJoinCallback",value:function(e){if(LogConsole.log("onRoomJoinCallback-------------------"),LogConsole.log(e),this.ktLogin=!1,null===this.roomLobby){this.roomLobby=this.socket.lastJoinedRoom,Kr.instance().beginLoadData();var t=new Date,n=t.getDate()+""+(t.getMonth()+1)+t.getFullYear(),i=Qr.instance().getItem(n);if("error"===i||null===i||"null"===i){i=1;var o=new Date;o.setDate(o.getDate()-1);var a=o.getDate()+""+(o.getMonth()+1)+o.getFullYear(),s=Qr.instance().getItem(a);if("error"===s||null===s||"null"===s);else{Wr.instance().clearPush({id:1}),Qr.instance().removeItem(a)}}else i=parseInt(i)+1;if(i>0){var r="Daily"+n,l=Qr.instance().getItem(r);if("error"===l||null===l||"null"===l){var h=new Date;h.setHours(Un.instance().randomNumber(8,20));var c=new Date(h.getTime());c.setDate(t.getDate()+1);var u={id:1,title:"[Wazzat]Phần thường hằng ngày đã sẵn sàng",text:"Hãy nhanh tay nhận phần thưởng",trigger:{at:c}};Wr.instance().setLocalPush(u),Wr.instance().ktPush&&Le.instance().logEvent("LocalDailyPush"),Qr.instance().setItem(r,!0)}}Qr.instance().setItem(n,i)}var d=e.room;d.isGame?(this.ktPlay=!0,"OnlineMode"===d.getVariable("mode").value||"OnlineModeRoom"===d.getVariable("mode").value?(LogConsole.log("MainData.instance().state :"+z.instance().state),z.instance().state===Ce.ONLINE_MODE?this.events.onRoomJoin.dispatch(e):(z.instance().dataJoinRoom=e,WF.instance().changeScreen(Ce.ONLINE_MODE))):this.events.onRoomJoin.dispatch(e)):(this.ktPlay=!1,this.events.onRoomJoin.dispatch(e))}},{key:"onExtensionResponseCallback",value:function(e){if("EVENT_MODE_LOAD_DISPLAY_PLAYERS"===e.cmd||"USER_PING"===e.cmd||(LogConsole.log("event.cmd : "+e.cmd),LogConsole.log(e.params.getDump())),"FAILED"===e.params.getUtfString(YF.status))e.cmd===R_.ONLINE_MODE_ROOM_INVITE_RESPONSE||iC.instance().addDialog(e.params.getUtfString(YF.message)),this.events.onExtensionResponse.dispatch(e);else if("WARNING"===e.params.getUtfString(YF.status))e.cmd===Et.CHALLENGE_GAME_GET_PLAYLISTS_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd===Et.CHALLENGE_GAME_FINISH_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd==Et.SOLO_MODE_PLAYLIST_SELECTED_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd==Et.CHALLENGE_GAME_QUESTIONS_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd===R_.ONLINE_MODE_ROOM_INVITE_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd===Et.SOLO_MODE_QUESTION_RESPONSE&&"User has no heart to play practice mode."==e.params.getUtfString(YF.message)?this.events.onExtensionResponse.dispatch(e):(iC.instance().addDialog(e.params.getUtfString(YF.message)),this.events.onExtensionResponse.dispatch(e));else{if(this.events.onExtensionResponse.dispatch(e),e.cmd==Et.QUEST_ACHIEVED_NOTIFICATION&&(LogConsole.log("QUEST_ACHIEVED_NOTIFICATION"),!0!==this.dataMySeft.is_playing_game&&setTimeout(function(){iC.instance().changeScreen(Ce.QUEST_CLAIM_POPUP,eZ.handle(e.params))},1e3)),e.cmd==Et.DAILY_QUEST_NOTIFICATION&&!0!==this.dataMySeft.is_playing_game&&iC.instance().addDailyRewardPopup(sZ.handle(e.params)),e.cmd===Et.ACHIEVEMENT_ACHIEVED_NOTIFICATION&&!0!==this.dataMySeft.is_playing_game&&iC.instance().changeScreen(Ce.ACHIEVEMENT_CLAIM_POPUP,oZ.handle(e.params)),e.cmd===Et.ONLINE_ROOM_INVITATION&&(z.instance().state!==Ce.MAIN_MENU&&z.instance().state!==Ce.ONLINE_MODE||WF.instance().screen.checkShowInvite(e.params)),e.cmd===Et.LEVEL_UP_NOTIFICATION?iC.instance().addLevelUp(e.params.getInt(YF.level_up_to)):e.cmd===Js.SHOP_BUY_PLAYLIST_RESPONSE?iC.instance().addPopupBuyDone(e.params.getInt(tr.playlist_id)):e.cmd===R_.ONLINE_MODE_ROOM_INVITE_RESPONSE||(e.cmd===R_.ONLINE_MODE_ROOM_BE_KICKED?iC.instance().addDialog("Bạn đã bị kích khỏi phòng chơi."):e.cmd===hN.EVENT_MODE_EVENT_START_BROADCAST&&iC.instance().addTextScroll("Sự kiên "+e.params.getSFSObject(jr.event).getUtfString(jr.name)+" đã bắt đầu mời các bạn tham gia.")),e.cmd===Et.BROADCASH_NOTIFICATION&&lZ.instance().addNotify(e.params),e.cmd===Et.USER_NOTIFICATION&&iC.instance().addDialog(e.params.getUtfString("message")),e.cmd==Et.TURNBASE_CHALLENGE_REQUEST_UPDATE){var t=cZ.instance().getUpdate(e.params);if(null!==z.instance().menuOpponentsResponse){var n=z.instance().menuOpponentsResponse.findIndex(function(e){return e.challenge_request_id==t.challenge_request_id});-1==n?z.instance().menuOpponentsResponse.push(t):z.instance().menuOpponentsResponse[n]=t,Bn.filterResponseGames()}}if(e.cmd==Et.USER_MESSAGE_LOAD_RESPONSE&&function(){for(var t=pZ.begin(e.params),n=pZ.getUsers(e.params),i=0;i<t.length;i++)z.instance().dataMessagesLocal.dataMessages.push(t[i]);for(var o=function(e){var t=z.instance().dataMessagesLocal.users.findIndex(function(t){return t.id==n[e].id});-1!==t?z.instance().dataMessagesLocal.users[t]=n[e]:z.instance().dataMessagesLocal.users.push(n[e])},a=0;a<n.length;a++)o(a);Qr.instance().removeItem("data_messages"),Qr.instance().setItem("data_messages",JSON.stringify(z.instance().dataMessagesLocal)),pZ.instance().checkLoadMessages=!1,1==De.instance().callMessageFromChatScreen&&(De.instance().event.newMessage.dispatch(),De.instance().callMessageFromChatScreen=!0),De.instance().event.loadMessagesDone.dispatch()}(),e.cmd==Et.USER_MESSAGE_RECEIVE&&this.sendRequestDataMessages(),e.cmd==Et.SYSTEM_MESSAGE_LOAD_RESPONSE){for(var i=pZ.getSystemMessages(e.params),o=0;o<i.length;o++)z.instance().systemMessagesLocal.dataMessages.push(i[o]);Qr.instance().removeItem("system_messages"),Qr.instance().setItem("system_messages",JSON.stringify(z.instance().systemMessagesLocal))}if(e.cmd,Et.USER_MESSAGE_MARK_AS_READ_RESPONSE,e.cmd==Et.QUEST_LOG_UPDATE){var a=dZ.instance().getUpdate(e.params);Bn.setQuestLogs(a,Kr.instance().quest_logs)}De.instance().event.loadSystemMessagesDone.dispatch()}}},{key:"addEventExtension",value:function(e,t){this.events.onExtensionResponse.add(e,t)}},{key:"removeEventExtension",value:function(e,t){this.events.onExtensionResponse.remove(e,t)}},{key:"sendPingServer",value:function(){this.removeReplayPing(),this.idxPing=game.time.events.add(10*Phaser.Timer.SECOND,this.sendPingServer,this),this.sendData("USER_PING",null)}},{key:"removeReplayPing",value:function(){null!==this.idxPing&&game.time.events.remove(this.idxPing)}},{key:"sendDataOneSignal",value:function(e,t){this.socket.send(new SFS2X.ExtensionRequest(e,t,this.roomLobby))}},{key:"sendData",value:function(e,t){LogConsole.log("sendData"),LogConsole.log("cmd : ---- "+e),LogConsole.log("this.ktPlay : ---- "+this.ktPlay),null!=t&&LogConsole.log("data : "+t.getDump()),this.ktPlay?this.socket.send(new SFS2X.ExtensionRequest(e,t,this.socket.lastJoinedRoom)):this.socket.send(new SFS2X.ExtensionRequest(e,t,this.roomLobby))}},{key:"sendDataGetMenu",value:function(e,t){qe.instance().showLoading(),null!==t&&LogConsole.log("data : "+t),this.ktPlay?this.socket.send(new SFS2X.ExtensionRequest(e,null,this.socket.lastJoinedRoom)):this.socket.send(new SFS2X.ExtensionRequest(e,null,this.roomLobby))}},{key:"sendLoading",value:function(e){LogConsole.log("sendLoading "+e);var t=[];t.push(new SFS2X.SFSUserVariable(nc.online_mode_loaded,e)),this.socket.send(new SFS2X.SetUserVariablesRequest(t))}},{key:"sendInvitationReply",value:function(e,t){this.socket.send(new SFS2X.InvitationReplyRequest(e,t))}},{key:"sendPublicChat",value:function(e,t){this.socket.send(new SFS2X.PublicMessageRequest(e,t,this.socket.lastJoinedRoom))}},{key:"sendExitRoom",value:function(){LogConsole.log("sendExitRoom"),this.socket.send(new SFS2X.LeaveRoomRequest)}},{key:"sendLogout",value:function(){LogConsole.log("logout sfs"),this.socket.send(new SFS2X.LogoutRequest)}},{key:"loginSFSByDevice",value:function(e){if(0==this.ktLogin){var t={deviceId:"",device:ze.getNamePlatform(),referrer:z.instance().referrer,userOneSingal:z.instance().userOneSingal,tokenOneSignal:z.instance().tokenOneSignal};if(!1===window.isTest){var n=prompt("Get UUID:");t.deviceId=n}else if(window.cordova&&"undefined"!=typeof device)t.deviceId=z.instance().udid;else{var i=prompt("Get UUID:");t.deviceId=i}LogConsole.log("postData"),LogConsole.log(t),qe.instance().showLoading(),this.ajaxGetServerInfoByUUID(t,function(t){e(t)})}}},{key:"loginSFSByYanAccount",value:function(e){var t={token:"",device:ze.getNamePlatform()};t.token=z.instance().tokenYanAccount,qe.instance().showLoading(),this.ajaxGetServerInfoByYanAccount(t,function(t){e(t)})}},{key:"ajaxGetServerInfoByUUID",value:function(e,t){$.ajax({type:"POST",url:window.RESOURCE.login_deviceId,data:e,dataType:"json",success:function(e){t(e)},error:function(e,n,i){console.error("Error get server infomation"),console.error(i),console.error(e.status),console.error(e.responseJSON),t({status:"ERROR_LOGIN"})}})}},{key:"ajaxGetServerInfoByYanAccount",value:function(e,t){$.ajax({type:"POST",url:window.RESOURCE.login_yan,data:e,dataType:"json",success:function(e){t(e)},error:function(e,n,i){console.error("Error get server infomation"),console.error(i),console.error(e.status),console.error(e.responseJSON),t({status:"ERROR_LOGIN"})}})}},{key:"loginSFS",value:function(e,t){if(0==this.ktLogin){this.ktLogin=!0,this.roomLobby=null;var n=new SFS2X.SFSObject;if(1==window.isTest?n.putUtfString("token",t):n.putUtfString("token","xipat!@#2019"),void 0!==e)this.socket.send(new SFS2X.LoginRequest(e.toString(),"",n,"MusicQuiz"));else{var i=prompt("Get user id:");null==i&&(i=2),this.socket.send(new SFS2X.LoginRequest(i.toString(),"",n,"MusicQuiz"))}}}},{key:"sendRequestDataMessages",value:function(){var t=new SFS2X.SFSObject;if(null===z.instance().dataMessagesLocal){var n=Qr.instance().getItem("data_messages");if(null===n||"error"===n||"null"===n)z.instance().dataMessagesLocal={user_id:e.instance().dataMySeft.user_id,dataMessages:[],users:[]},t.putLong("last_user_message_id",0),e.instance().sendData(Et.USER_MESSAGE_LOAD_REQUEST,t),pZ.instance().checkLoadMessages=!0;else{var i=JSON.parse(n);null===i||"error"===i||"null"===i?(z.instance().dataMessagesLocal={user_id:e.instance().dataMySeft.user_id,dataMessages:[],users:[]},t.putLong("last_user_message_id",0),e.instance().sendData(Et.USER_MESSAGE_LOAD_REQUEST,t),pZ.instance().checkLoadMessages=!0):i.user_id==e.instance().dataMySeft.user_id?(z.instance().dataMessagesLocal={user_id:e.instance().dataMySeft.user_id,dataMessages:i.dataMessages,users:i.users},z.instance().dataMessagesLocal.dataMessages.length>0?t.putLong("last_user_message_id",z.instance().dataMessagesLocal.dataMessages[z.instance().dataMessagesLocal.dataMessages.length-1].id):t.putLong("last_user_message_id",0),e.instance().sendData(Et.USER_MESSAGE_LOAD_REQUEST,t),pZ.instance().checkLoadMessages=!0):(z.instance().dataMessagesLocal={user_id:e.instance().dataMySeft.user_id,dataMessages:[],users:[]},t.putLong("last_user_message_id",0),e.instance().sendData(Et.USER_MESSAGE_LOAD_REQUEST,t),pZ.instance().checkLoadMessages=!0)}}else t.putLong("last_user_message_id",z.instance().dataMessagesLocal.dataMessages[z.instance().dataMessagesLocal.dataMessages.length-1].id),e.instance().sendData(Et.USER_MESSAGE_LOAD_REQUEST,t)}},{key:"sendRequestSystemMessages",value:function(){var t=new SFS2X.SFSObject,n=Qr.instance().getItem("system_messages");if(null===n||"error"===n||"null"===n)z.instance().systemMessagesLocal={user_id:e.instance().dataMySeft.user_id,dataMessages:[]},t.putLong("last_message_content_id",0),e.instance().sendData(Et.SYSTEM_MESSAGE_LOAD_REQUEST,t);else{var i=JSON.parse(n);null===i||"error"===i||"null"===i?(z.instance().systemMessagesLocal={user_id:e.instance().dataMySeft.user_id,dataMessages:[]},t.putLong("last_message_content_id",0),e.instance().sendData(Et.SYSTEM_MESSAGE_LOAD_REQUEST,t)):i.user_id==e.instance().dataMySeft.user_id?(z.instance().systemMessagesLocal={user_id:e.instance().dataMySeft.user_id,dataMessages:i.dataMessages},z.instance().systemMessagesLocal.dataMessages.length>0?t.putLong("last_message_content_id",z.instance().systemMessagesLocal.dataMessages[z.instance().systemMessagesLocal.dataMessages.length-1].message_content_id):t.putLong("last_message_content_id",0),e.instance().sendData(Et.SYSTEM_MESSAGE_LOAD_REQUEST,t)):(z.instance().systemMessagesLocal={user_id:e.instance().dataMySeft.user_id,dataMessages:[]},t.putLong("last_message_content_id",0),e.instance().sendData(Et.SYSTEM_MESSAGE_LOAD_REQUEST,t))}}}]),e}();function vZ(e){return(vZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bZ(e,t){return!t||"object"!==vZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SZ(e){return(SZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _Z(e,t){return(_Z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var EZ=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),bZ(this,SZ(t).call(this))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_Z(e,t)}(t,Phaser.State),n=t,(i=[{key:"init",value:function(e){this.loadModule=new _e(this)}},{key:"preload",value:function(){this.loadModule.preloadForLoad(),this.loadModule.createSpritesForLoadState(),Q()}},{key:"create",value:function(){game.state.start("MainGame",!0,!1,{})}},{key:"update",value:function(){}},{key:"render",value:function(){}},{key:"initServer",value:function(){var e={host:"103.9.77.122",port:8096,useSSL:!1,zone:"MusicQuiz",debug:!1};this.sfsInfo&&(e.host=this.sfsInfo.sfs_host,e.port=this.sfsInfo.sfs_port,e.useSSL=this.sfsInfo.sfs_ssl,e.zone=this.sfsInfo.sfs_zone,e.debug=this.sfsInfo.sfs_debug),mZ.instance().initListenerSfs(e),mZ.instance().connect()}}])&&wZ(n.prototype,i),o&&wZ(n,o),t}();function CZ(e){return(CZ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function PZ(e,t){return!t||"object"!==CZ(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OZ(e){return(OZ=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RZ(e,t){return(RZ=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xZ=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),PZ(this,OZ(t).call(this))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RZ(e,t)}(t,Phaser.State),n=t,(i=[{key:"init",value:function(e){}},{key:"preload",value:function(){game.scale.pageAlignHorizontally=!0,game.time.advancedTiming=!0,game.stage.disableVisibilityChange=!0}},{key:"create",value:function(){var e=WF.instance();this.add.existing(e);var t=iC.instance();this.add.existing(t);var n=qe.instance();this.add.existing(n);var i=Gn.instance();this.add.existing(i),WF.instance().changeScreen(Ce.LOGIN)}},{key:"update",value:function(){}},{key:"render",value:function(){}}])&&kZ(n.prototype,i),o&&kZ(n,o),t}();function TZ(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var IZ=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),window.plugins&&window.plugins.OneSignal){console.log("OneSignalPush------------------");window.plugins.OneSignal.startInit("4cb998ce-7a56-4eb5-90f5-06f2834da6fc").handleNotificationOpened(function(e){console.log("notificationOpenedCallback: "+JSON.stringify(e))}).endInit(),window.plugins.OneSignal.getIds(function(e){if(console.log("notifyId: "+JSON.stringify(e)),z.instance().userOneSingal=e.userId,z.instance().tokenOneSignal=e.pushToken,console.log("userOneSingal : "+z.instance().userOneSingal),console.log("tokenOneSignal : "+z.instance().tokenOneSignal),null!==mZ.instance().roomLobby){var t=new SFS2X.SFSObject;t.putUtfString("user_one_signal",z.instance().userOneSingal),t.putUtfString("token_one_signal",z.instance().tokenOneSignal),mZ.instance().sendDataOneSignal(Pe.ONE_SIGNAL_UPDATE_REQUEST,t)}})}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.onesignal||(this.onesignal=new e),this.onesignal}}],(n=null)&&TZ(t.prototype,n),i&&TZ(t,i),e}();window.onload=function(){(window.onhashchange=function(){},Howler.mobileAutoEnable=!1,Howler.autoSuspend=!1,li.instance(),Wr.instance(),window.cordova&&"undefined"!=typeof device)?("undefined"!=typeof StatusBar&&StatusBar.hide(),window.navigationbar&&(window.navigationbar.setUp(!1),window.navigationbar.hideNavigationBar()),device.hasOwnProperty("platform")&&null!==device.platform&&("android"===device.platform.toLowerCase()||"amazon-fireos"===device.platform.toLowerCase()?(z.instance().platform="and",z.instance().udid=udid.getUdid(),z.instance().referrer=udid.getReferrer(),setTimeout(function(){screen.orientation.lock("portrait")},2e3)):"ios"===device.platform.toLowerCase()&&(z.instance().platform="ios",z.instance().udid=device.uuid)),"ios"===z.instance().platform?jv.instance():"and"===z.instance().platform&&Fv.instance(),window.plugins&&(window.plugins.insomnia&&window.plugins.insomnia.keepAwake(),window.powerManagement&&window.powerManagement.acquire(),window.plugins.uniqueDeviceID&&window.plugins.uniqueDeviceID.get(function(e){z.instance().udid=e,z.instance().platform="ios"})),cordova.plugins&&cordova.plugins.VolumeControl&&cordova.plugins.VolumeControl.setVolume(.7)):z.instance().platform="web";game=new Phaser.Game(window.GameConfig.GAME_WIDTH,window.GameConfig.GAME_HEIGHT,Phaser.CANVAS,"game",null,!1,!0),game.state.add("Boot",ne),game.state.add("Load",EZ),game.state.add("MainGame",xZ),game.state.start("Boot"),document.body.addEventListener("touchend",function(){"ctx"in Howler&&null!==Howler.ctx&&("suspended"!==Howler.ctx.state&&"interrupted"!==Howler.ctx.state||(Howler.ctx.resume(),Howler._autoResume()))}),document.addEventListener("backbutton",function(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1===z.instance().isShowLoading&&De.instance().event.backButton.dispatch()},!1),document.addEventListener("deviceready",function(){IZ.instance()},!1),document.addEventListener("pause",function(){null!==game&&(game.paused=!0)},!1),document.addEventListener("resume",function(){null!==game&&(game.paused=!1)},!1)}}]);