!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.r(t);var h=function(e){function t(e,n,i){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);(o=s(this,r(t).call(this,game,e,n,i))).animations.add("run_anim"+i);return o.anchor.set(.5),o.animations.play("run_anim"+i,32,!0),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"tweenPosX",value:function(e,t){game.add.tween(this).to({x:e},t,"Linear",!0).start()}}])&&a(n.prototype,i),o&&a(n,o),t}();function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function d(e,t,n){return(d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=f(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var y=function(e){function t(e,n){var i,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,a=f(t).call(this,game,e,n,"loadStar");(i=!a||"object"!==c(a)&&"function"!=typeof a?g(o):a).animations.add("run_anim");i.anchor.set(.5),i.kill();var s=.5+3*Math.random();return i.timeTween=game.time.events.add(Phaser.Timer.SECOND*s,function(){i.revive(),i.animations.play("run_anim",22,!0)},g(g(i))),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"destroy",value:function(){game.time.events.remove(this.timeTween),d(f(t.prototype),"destroy",this).call(this)}}])&&u(n.prototype,i),o&&u(n,o),t}();function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function w(e,t){return!t||"object"!==m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e,t,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=w(this,_(t).call(this,game,game.rnd.between(100,game.width-100),game.height+100,"loadingNewSprites",e))).arrBubble=["Circle","Circle_White"],i.anchor.set(.5),i.scale.set(.1*game.rnd.between(5,10)),i.index=n,i.addBezier(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addBezier",value:function(){var e=this,t=[{x:this.position.x,y:this.position.y},{x:game.rnd.between(100,game.width-100),y:game.height-1136+900},{x:game.rnd.between(100,game.width-100),y:game.height-1136+700},{x:game.rnd.between(100,game.width-100),y:game.height-1136+550}];this.timeTweenBezier=game.time.events.add(Phaser.Timer.SECOND*(.45*this.index),function(){e.timeTweenAlpha=game.time.events.add(1.9*Phaser.Timer.SECOND,function(){game.add.tween(e).to({alpha:.1},1e3,"Linear",!1).start()});var n=game.add.tween(e).to({x:[t[0].x,t[1].x,t[2].x,t[3].x],y:[t[0].y,t[1].y,t[2].y,t[3].y]},3e3,Phaser.Easing.Linear.In,!1,0,0).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});n.start(),n.onComplete.add(function(){e.position.x=game.rnd.between(100,game.width-100),e.position.y=game.height+100,e.alpha=1,e.scale.set(.1*game.rnd.between(5,10)),e.loadTexture("loadingNewSprites",e.arrBubble[Math.floor(Math.random()*e.arrBubble.length)]),e.addBezier()})})}},{key:"destroy",value:function(){game.time.events.remove(this.timeTweenBezier),game.time.events.remove(this.timeTweenAlpha),b(_(t.prototype),"destroy",this).call(this)}}])&&v(n.prototype,i),o&&v(n,o),t}();function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function P(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var x=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=P(this,O(t).call(this,game,e,n,"loadingNewSprites",i))).addAnim(o),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addAnim",value:function(e){game.add.tween(this).to({y:this.position.y+e},300,"Linear",!0,0,-1).yoyo(!0,0)}}])&&k(n.prototype,i),o&&k(n,o),t}();function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function A(e,t){return!t||"object"!==T(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=A(this,L(t).call(this,game,e,n,"loadingNewSprites",i))).anchor.set(.5,1),a.angle=o,a.addShake(o),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addShake",value:function(e){game.add.tween(this).to({angle:-e},400,"Linear",!0,0,-1).yoyo(!0,0)}}])&&I(n.prototype,i),o&&I(n,o),t}();function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function B(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var F=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=B(this,j(t).call(this,game))).positionBootConfig=JSON.parse(game.cache.getText("positionBootConfig")),e.STANDARD_HEIGHT=1136,e.yep=n,e.afterInit(),e}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(t,Phaser.Group),n=t,(o=[{key:"afterInit",value:function(){this.addStage(),this.addRedGirl(),this.addBlackGirl(),this.addWhiteGirl(),this.addStar(),this.addBezierBubble(),this.addBg(),this.addHead(),this.addArm()}},{key:"addStage",value:function(){this.stage=new Phaser.Sprite(game,this.positionBootConfig.loadingScreen.stage.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.stage.y,this.positionBootConfig.loadingScreen.stage.nameAtlas,this.positionBootConfig.loadingScreen.stage.nameSprite),this.stage.anchor.set(.5,1),this.addChild(this.stage)}},{key:"addBg",value:function(){this.bg=new Phaser.Sprite(game,this.positionBootConfig.loadingScreen.bg.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.bg.y,this.positionBootConfig.loadingScreen.bg.nameAtlas,this.positionBootConfig.loadingScreen.bg.nameSprite),this.bg.anchor.set(.5,1),this.addChild(this.bg)}},{key:"addWhiteGirl",value:function(){this.whiteGirl=new h(this.positionBootConfig.loadingScreen.whiteGirl.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.whiteGirl.y,this.positionBootConfig.loadingScreen.whiteGirl.nameSprite),this.addChild(this.whiteGirl)}},{key:"addRedGirl",value:function(){0==this.yep?(this.redGirl=new h(game.width+300,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.redGirl.y,this.positionBootConfig.loadingScreen.redGirl.nameSprite),this.redGirl.tweenPosX(this.positionBootConfig.loadingScreen.redGirl.x,800),this.addChild(this.redGirl)):(this.redGirl=new h(this.positionBootConfig.loadingScreen.redGirl.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.redGirl.y,this.positionBootConfig.loadingScreen.redGirl.nameSprite),this.redGirl.tweenPosX(this.positionBootConfig.loadingScreen.redGirl.x,800),this.addChild(this.redGirl))}},{key:"addBlackGirl",value:function(){0==this.yep?(this.blackGirl=new h(-300,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.blackGirl.y,this.positionBootConfig.loadingScreen.blackGirl.nameSprite),this.blackGirl.tweenPosX(this.positionBootConfig.loadingScreen.blackGirl.x,700),this.addChild(this.blackGirl)):(this.blackGirl=new h(this.positionBootConfig.loadingScreen.blackGirl.x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.blackGirl.y,this.positionBootConfig.loadingScreen.blackGirl.nameSprite),this.blackGirl.tweenPosX(this.positionBootConfig.loadingScreen.blackGirl.x,700),this.addChild(this.blackGirl))}},{key:"addStar",value:function(){for(i=0;i<this.positionBootConfig.loadingScreen.stars.length;i++){var e=new y(this.positionBootConfig.loadingScreen.stars[i].x,game.height-this.STANDARD_HEIGHT+this.positionBootConfig.loadingScreen.stars[i].y);this.addChild(e)}}},{key:"addBezierBubble",value:function(){for(var e=["Circle","Circle_White"],t=0;t<4;t++){var n=e[Math.floor(Math.random()*e.length)],i=new E(n,t);this.addChild(i)}}},{key:"addArm",value:function(){this.arm1=new x(0,game.height-1136+850,"Arm_01",-10),this.addChild(this.arm1),this.arm2=new x(80,game.height-1136+940,"Arm_02",10),this.addChild(this.arm2),this.arm3=new x(220,game.height-1136+1e3,"Arm_03",-10),this.addChild(this.arm3),this.arm4=new x(280,game.height-1136+1035,"Arm_04",10),this.addChild(this.arm4),this.arm5=new x(445,game.height-1136+975,"Arm_05",-10),this.addChild(this.arm5),this.arm6=new x(475,game.height-1136+880,"Arm_06",10),this.addChild(this.arm6),this.arm7=new x(540,game.height-1136+900,"Arm_07",-10),this.addChild(this.arm7)}},{key:"addHead",value:function(){this.head1=new D(-20,game.height-1136+1080,"Head_01",0),this.addChild(this.head1),this.head2=new D(170,game.height-1136+1150,"Head_02",5),this.addChild(this.head2),this.head3=new D(380,game.height-1136+1135,"Head_03",-5),this.addChild(this.head3),this.head4=new D(580,game.height-1136+1120,"Head_04",3),this.addChild(this.head4),this.head5=new D(660,game.height-1136+1080,"Head_05",6),this.addChild(this.head5)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&N(n.prototype,o),a&&N(n,a),t}();function Z(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var H=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.state=t}var t,n,i;return t=e,(n=[{key:"preload",value:function(){game.load.atlas("loadingSprites","./img/atlas/loadingScreen.png"+"?v=".concat(window.VersionClient),"img/atlas/loadingScreen.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("loadingNewSprites","img/atlas/loadingNewScreen.png"+"?v=".concat(window.VersionClient),"img/atlas/loadingNewScreen.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.image("bg_create_room","img/background/BG.png"+"?v=".concat(window.VersionClient)),game.load.text("positionBootConfig","./img/config/positionBootConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionLoadConfig","./img/config/positionLoadConfig.json"+"?v=".concat(window.VersionClient)),game.load.spritesheet("loadingPlay","img/animations/Loading/sprites.png"+"?v=".concat(window.VersionClient),134,137,32),game.load.text("positionPlayConfig","img/config/positionPlayConfig.json"+"?v=".concat(window.VersionClient)),game.load.spritesheet("loadBlackGirl","img/animations/NewLoading/BlackGirl.png"+"?v=".concat(window.VersionClient),193,330,18),game.load.spritesheet("loadWhiteGirl","img/animations/NewLoading/WhiteGirl.png"+"?v=".concat(window.VersionClient),125,380,14),game.load.spritesheet("loadRedGirl","img/animations/NewLoading/RedGirl.png"+"?v=".concat(window.VersionClient),160,330,22),game.load.spritesheet("loadStar","img/animations/NewLoading/Star.png"+"?v=".concat(window.VersionClient),29,30,11),game.load.image("screen-dim","img/assetss/Practice/reward/screen-dim.png"+"?v=".concat(window.VersionClient)),game.load.image("screen-dim1","img/assetss/Practice/reward/screen-dim1.png"+"?v=".concat(window.VersionClient)),game.load.image("screen-dim2","img/assetss/Practice/reward/screen-dim2.png"+"?v=".concat(window.VersionClient)),game.load.spritesheet("firework","img/atlas/firework.png"+"?v=".concat(window.VersionClient),400,212,40),game.load.spritesheet("fireworktet","img/atlas/fireworktet.png"+"?v=".concat(window.VersionClient),435,231,32)}},{key:"createSprites",value:function(){this.positionBootConfig=this.getpositionBootConfig(),this.addBackgroundSprite(),this.addLogoSprite(),this.addDance(),this.addTermText()}},{key:"getpositionBootConfig",value:function(){return JSON.parse(this.state.cache.getText("positionBootConfig"))}},{key:"addDance",value:function(){var e=new F;this.state.add.existing(e)}},{key:"addBackgroundSprite",value:function(){game.stage.background=game.add.sprite(this.positionBootConfig.bg_load.x*window.GameConfig.RESIZE,this.positionBootConfig.bg_load.y*window.GameConfig.RESIZE,"bg_create_room")}},{key:"addLogoSprite",value:function(){var e=game.add.sprite(this.positionBootConfig.logo.x*window.GameConfig.RESIZE,this.positionBootConfig.logo.y*window.GameConfig.RESIZE,"".concat(this.positionBootConfig.logo.nameAtlas),"".concat(this.positionBootConfig.logo.nameSprite));return e.anchor.set(.5),e}},{key:"addTermText",value:function(){var e=game.add.text(this.positionBootConfig.txt_term.x*window.GameConfig.RESIZE,(game.height-26)*window.GameConfig.RESIZE,this.positionBootConfig.txt_term.text,this.positionBootConfig.txt_term.configs);return e.anchor.set(.5),e.addColor("#ffa33a",37),e}}])&&Z(t.prototype,n),i&&Z(t,i),e}();function Q(){window.MQ.achievementPractice=[{answer:2,reward:10},{answer:5,reward:15},{answer:8,reward:20},{answer:12,reward:30},{answer:18,reward:50},{answer:25,reward:100},{answer:33,reward:150},{answer:45,reward:200},{answer:56,reward:500}],window.MQ.posCirclePractice=[{num:2,x:147,y:300},{num:5,x:320,y:300},{num:8,x:493,y:300},{num:12,x:493,y:419},{num:18,x:320,y:419},{num:25,x:147,y:419},{num:33,x:147,y:536},{num:45,x:320,y:536},{num:56,x:493,y:536}],window.MQ.posDotPractice=[{num:1,x:-15,y:-15},{num:2,x:-15,y:-15},{num:3,x:204,y:299.5},{num:4,x:262,y:299.5},{num:5,x:-15,y:-15},{num:6,x:378,y:299.5},{num:7,x:436,y:299.5},{num:8,x:-15,y:-15},{num:9,x:493,y:330},{num:10,x:493,y:360},{num:11,x:493,y:390},{num:12,x:-15,y:-15},{num:13,x:464,y:419},{num:14,x:435,y:419},{num:15,x:406,y:419},{num:16,x:377,y:419},{num:17,x:348,y:419},{num:18,x:-15,y:-15},{num:19,x:295,y:419},{num:20,x:270,y:419},{num:21,x:245,y:419},{num:22,x:220,y:419},{num:23,x:195,y:419},{num:24,x:170,y:419},{num:25,x:-15,y:-15},{num:26,x:146,y:434},{num:27,x:146,y:449},{num:28,x:146,y:461},{num:29,x:146,y:473},{num:30,x:146,y:485},{num:31,x:146,y:497},{num:32,x:146,y:509},{num:33,x:-15,y:-15},{num:34,x:173,y:535},{num:35,x:185,y:535},{num:36,x:197,y:535},{num:37,x:209,y:535},{num:38,x:221,y:535},{num:39,x:233,y:535},{num:40,x:245,y:535},{num:41,x:257,y:535},{num:42,x:269,y:535},{num:43,x:281,y:535},{num:44,x:293,y:535},{num:45,x:-15,y:-15},{num:46,x:350,y:535},{num:47,x:362,y:535},{num:48,x:374,y:535},{num:49,x:386,y:535},{num:50,x:398,y:535},{num:51,x:410,y:535},{num:52,x:424,y:535},{num:53,x:436,y:535},{num:54,x:448,y:535},{num:55,x:460,y:535},{num:56,x:-15,y:-15}],window.MQ.posAchievementPractice=[{diamondPosX:145,diamondPosY:261,answerPosX:145,answerPosY:335},{diamondPosX:320,diamondPosY:261,answerPosX:320,answerPosY:335},{diamondPosX:492,diamondPosY:261,answerPosX:477,answerPosY:335},{diamondPosX:456,diamondPosY:379,answerPosX:492,answerPosY:455},{diamondPosX:320,diamondPosY:379,answerPosX:320,answerPosY:455},{diamondPosX:146,diamondPosY:379,answerPosX:175,answerPosY:455},{diamondPosX:204,diamondPosY:500,answerPosX:145,answerPosY:572},{diamondPosX:320,diamondPosY:500,answerPosX:320,answerPosY:572},{diamondPosX:492,diamondPosY:500,answerPosX:492,answerPosY:572}]}function V(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var W=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._dataBetCreateRoom=null,this.idbetCreateRoom=null,this._dataPlaylistCreateRoom=null,this.idPlaylistCreateRoom=null,this._dataGenresQuickPlay=null,this.idGenresQuickPlay=null,this._dataListRoomEventMode=null,this.idListRoomEventMode=null,this._dataRankingEventmode=null,this.idRankingEventMode=null,this._dataRankingDiamond=null,this.idRankingDiamond=null,this._dataRankingLevel=null,this.idRankingLevel=null,this._dataRankingOnlineMode=null,this.idRankingOnlineMode=null,this._dataRankingTurnBase=null,this.idRankingTurnBase=null}var t,n,i;return t=e,(n=[{key:"removeIdBetCreateRoom",value:function(){null!==this.idbetCreateRoom&&(game.time.events.remove(this.idbetCreateRoom),this.idbetCreateRoom=null)}},{key:"callResetDataBetCreateRoom",value:function(){this.removeIdBetCreateRoom(),this.idbetCreateRoom=game.time.events.add(30*Phaser.Timer.SECOND,this.resetDataBetCreateRoom,this)}},{key:"resetDataBetCreateRoom",value:function(){this._dataBetCreateRoom=null}},{key:"removeIdPlaylistCreateRoom",value:function(){null!==this.idPlaylistCreateRoom&&(game.time.events.remove(this.idPlaylistCreateRoom),this.idPlaylistCreateRoom=null)}},{key:"callResetDataPlaylistCreateRoom",value:function(){this.removeIdPlaylistCreateRoom(),this.idPlaylistCreateRoom=game.time.events.add(30*Phaser.Timer.SECOND,this.resetDataPlaylistCreateRoom,this)}},{key:"resetDataPlaylistCreateRoom",value:function(){this._dataPlaylistCreateRoom=null}},{key:"removeIdGenresQuickPlay",value:function(){null!==this.idGenresQuickPlay&&(game.time.events.remove(this.idGenresQuickPlay),this.idGenresQuickPlay=null)}},{key:"callResetDataGenresQuickPlay",value:function(){this.removeIdGenresQuickPlay(),this.idGenresQuickPlay=game.time.events.add(30*Phaser.Timer.SECOND,this.resetDataGenresQuickPlay,this)}},{key:"resetDataGenresQuickPlay",value:function(){this._dataGenresQuickPlay=null}},{key:"removeIdListRoomEventMode",value:function(){null!==this.idListRoomEventMode&&(game.time.events.remove(this.idListRoomEventMode),this.idListRoomEventMode=null)}},{key:"callResetListRoomEventMode",value:function(){this.removeIdListRoomEventMode(),this.idListRoomEventMode=game.time.events.add(30*Phaser.Timer.SECOND,this.resetDataListRoomEventMode,this)}},{key:"resetDataListRoomEventMode",value:function(){this._dataListRoomEventMode=null}},{key:"removeIdRankingEventmode",value:function(){null!==this.idRankingEventMode&&(game.time.events.remove(this.idRankingEventMode),this.idRankingEventMode=null)}},{key:"callResetRankingEventmode",value:function(){this.removeIdRankingEventmode(),this.idRankingEventMode=game.time.events.add(5*Phaser.Timer.SECOND,this.resetDataRankingEventmode,this)}},{key:"resetDataRankingEventmode",value:function(){this._dataRankingEventmode=null}},{key:"removeIdRankingDiamond",value:function(){null!==this.idRankingDiamond&&(game.time.events.remove(this.idRankingDiamond),this.idRankingDiamond=null)}},{key:"callResetRankingDiamond",value:function(){this.removeIdRankingDiamond(),this.idRankingDiamond=game.time.events.add(60*Phaser.Timer.SECOND,this.resetDataRankingDiamond,this)}},{key:"resetDataRankingDiamond",value:function(){this._dataRankingDiamond=null}},{key:"removeIdRankingLevel",value:function(){null!==this.idRankingLevel&&(game.time.events.remove(this.idRankingLevel),this.idRankingLevel=null)}},{key:"callResetRankingLevel",value:function(){this.removeIdRankingLevel(),this.idRankingLevel=game.time.events.add(60*Phaser.Timer.SECOND,this.resetDataRankingLevel,this)}},{key:"resetDataRankingLevel",value:function(){this._dataRankingLevel=null}},{key:"removeIdRankingOnlineMode",value:function(){null!==this.idRankingOnlineMode&&(game.time.events.remove(this.idRankingOnlineMode),this.idRankingOnlineMode=null)}},{key:"callResetRankingOnlineMode",value:function(){this.removeIdRankingOnlineMode(),this.idRankingOnlineMode=game.time.events.add(60*Phaser.Timer.SECOND,this.resetDataRankingOnlineMode,this)}},{key:"resetDataRankingOnlineMode",value:function(){this._dataRankingOnlineMode=null}},{key:"removeIdRankingTurnBase",value:function(){null!==this.idRankingTurnBase&&(game.time.events.remove(this.idRankingTurnBase),this.idRankingTurnBase=null)}},{key:"callResetRankingTurnBase",value:function(){this.removeIdRankingTurnBase(),this.idRankingTurnBase=game.time.events.add(60*Phaser.Timer.SECOND,this.resetDataRankingTurnBase,this)}},{key:"resetDataRankingTurnBase",value:function(){this._dataRankingTurnBase=null}},{key:"resetDataServer",value:function(){this.removeIdBetCreateRoom(),this._dataBetCreateRoom=null,this.removeIdPlaylistCreateRoom(),this._dataPlaylistCreateRoom=null,this.removeIdGenresQuickPlay(),this._dataGenresQuickPlay=null,this.removeIdListRoomEventMode(),this._dataListRoomEventMode=null,this.removeIdRankingEventmode(),this._dataRankingEventmode=null,this.removeIdRankingDiamond(),this._dataRankingDiamond=null,this.removeIdRankingLevel(),this._dataRankingLevel=null,this.removeIdRankingOnlineMode(),this._dataRankingOnlineMode=null,this.removeIdRankingTurnBase(),this._dataRankingTurnBase=null}},{key:"dataBetCreateRoom",get:function(){return this._dataBetCreateRoom},set:function(e){this._dataBetCreateRoom=e}},{key:"dataPlaylistCreateRoom",get:function(){return this._dataPlaylistCreateRoom},set:function(e){this._dataPlaylistCreateRoom=e,this.callResetDataPlaylistCreateRoom()}},{key:"dataGenresQuickPlay",get:function(){return this._dataGenresQuickPlay},set:function(e){this._dataGenresQuickPlay=e}},{key:"dataListRoomEventMode",get:function(){return this._dataListRoomEventMode},set:function(e){this._dataListRoomEventMode=e,this.callResetListRoomEventMode()}},{key:"dataRankingEventmode",get:function(){return this._dataRankingEventmode},set:function(e){this._dataRankingEventmode=e,this.callResetRankingEventmode()}},{key:"dataRankingDiamond",get:function(){return this._dataRankingDiamond},set:function(e){this._dataRankingDiamond=e,this.callResetRankingDiamond()}},{key:"dataRankingLevel",get:function(){return this._dataRankingLevel},set:function(e){this._dataRankingLevel=e,this.callResetRankingLevel()}},{key:"dataRankingOnlineMode",get:function(){return this._dataRankingOnlineMode},set:function(e){this._dataRankingOnlineMode=e,this.callResetRankingOnlineMode()}},{key:"dataRankingTurnBase",get:function(){return this._dataRankingTurnBase},set:function(e){this._dataRankingTurnBase=e,this.callResetRankingTurnBase()}}])&&V(t.prototype,n),i&&V(t,i),e}();function q(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function K(e,t,n){return t&&q(e.prototype,t),n&&q(e,n),e}var z=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.positionCreateRoomData=null,this.positionDefaultResourceData=null,this.positionPopupData=null,this.positionEventModeData=null,this.positionRankingData=null,this.positionShopData=null,this.positionUserProfileData=null,this.positionDetailPlaylistData=null,this.silentchatData=null,this.udid="",this.referrer="",this.dataShop=null,this.dataPackage=null,this.ktUpdate=!1,this.isShowLoading=!1,this.MODEPLAY={OnlineMode:"OnlineMode",OnlineModeRoom:"OnlineModeRoom"},this.platform="",this.response=null,this.ktPlayAgainOnlineMode=!1,this.state="",this.modeplay="OnlineMode",this.dataPlayOnlineMode={id:0,genre_id:0,bet_id:0,bet_place:0},this.scale=1,this.dataJoinRoom=null,this.dataGennes={},this.typeMenuGenes="Local",this.playScript={playing_guide:"",play_script_questions:[]},this.botChallenge={value:0,gameLogId:0,requestId:0,opponentEntity:{},mode:"isChallengeGame",can_be_poked:0,weeklyResult:{userWon:0,opponentWon:0}},this.SIZE_AVA_UPLOAD=2097152,this.STANDARD_HEIGHT=1136,this.LOGED_IN=!1,this.LOG_IN_BY_FB=!1,this.userDescription="",this.isGetUserProfileSearch=!1,this.android_storage_link="market://details?id=com.wazzat.musicgame",this.ios_storage_link="itms-apps://itunes.apple.com/app/1440442421",this.idxHighest=-1,this.isScrollChange=!1,this.tokenYanAccount="",this.menuLoadResponses=null,this.menuOpponentsResponse=null,this.init_quests_count=0,this.new_friend_request_count=0,this.started_event_count=0,this.hoursReward=null,this.isRefreshMenu={checking:!1,updated:0},this.userOneSingal="",this.tokenOneSignal="",this.dataServer=new W,this.isChallengeGameFindOpponents={checking:!1,updated:0},this.friendLists=[],this.suggestion_users=[],this.random_user=null,this.isMainQuestLoad={checking:!1,updated:0},this.mainQuestLists=[],this.mainQuestLogLists=[],this.mainNextQuest=null,this.isSoloModePlaylistRequest={checking:!1,updated:0},this.soloModePlaylists=[],this.isDailyQuestLoad={checking:!1,updated:0},this.dailyQuestLists=[],this.isAchievementLoad={checking:!1,updated:0},this.achievements=[],this.messageTurnbases=["Làm ván đi em eeii!","Chơi với em đi hihi","Khó quắc à, anh chơi đi!","Goddd damn it!"],this.checkLoadMail=0,this.checkLoadMessage=0,this.mailData=null,this.messageData=null}return K(e,null,[{key:"instance",value:function(){return this.mainData||(this.mainData=new e),this.mainData}},{key:"VERSION_AND",get:function(){return"0.0.7"}},{key:"VERSION_IOS",get:function(){return"0.0.3"}}]),K(e,[{key:"positionCreateRoom",get:function(){return null===this.positionCreateRoomData&&(this.positionCreateRoomData=JSON.parse(game.cache.getText("positionCreateRoom"))),this.positionCreateRoomData}},{key:"positionDefaultSource",get:function(){return null===this.positionDefaultResourceData&&(this.positionDefaultResourceData=JSON.parse(game.cache.getText("positionDefaultSource"))),this.positionDefaultResourceData}},{key:"positionPopup",get:function(){return null===this.positionPopupData&&(this.positionPopupData=JSON.parse(game.cache.getText("positionPopup"))),this.positionPopupData}},{key:"positionEventMode",get:function(){return null===this.positionEventModeData&&(this.positionEventModeData=JSON.parse(game.cache.getText("positionEventMode"))),this.positionEventModeData}},{key:"positionRanking",get:function(){return null===this.positionRankingData&&(this.positionRankingData=JSON.parse(game.cache.getText("positionRanking"))),this.positionRankingData}},{key:"positionShop",get:function(){return null===this.positionShopData&&(this.positionShopData=JSON.parse(game.cache.getText("positionShop"))),this.positionShopData}},{key:"positionUserProfile",get:function(){return null===this.positionUserProfileData&&(this.positionUserProfileData=JSON.parse(game.cache.getText("positionUserProfile"))),this.positionUserProfileData}},{key:"positionDetailPlaylist",get:function(){return null===this.positionDetailPlaylistData&&(this.positionDetailPlaylistData=JSON.parse(game.cache.getText("positionDetailPlaylist"))),this.positionDetailPlaylistData}},{key:"silentchat",get:function(){if(null===this.silentchatData){this.silentchatData=game.cache.getText("silentchat").split(",");for(var e=0;e<this.silentchatData.length;e++)this.silentchatData[e]=this.silentchatData[e].trim();this.silentchatData.sort(function(e,t){return t.length-e.length})}return this.silentchatData}},{key:"language",get:function(){return null==this._language&&(this._language=JSON.parse(game.cache.getText("languageGame"))),this._language}}]),e}();function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function X(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ne=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),X(this,ee(t).call(this))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(t,Phaser.State),n=t,(i=[{key:"init",value:function(){game.stage.backgroundColor="#1e0e46";var e=0;e="web"===z.instance().platform?window.innerWidth/window.innerHeight:screen.width/screen.height;var t=window.GameConfig.GAME_WIDTH/window.GameConfig.GAME_HEIGHT;if(e>t);else if(e<t){var n=Math.ceil(window.GameConfig.GAME_WIDTH/e);game.scale.setGameSize(window.GameConfig.GAME_WIDTH,n),window.distanceHeight=n-window.GameConfig.GAME_HEIGHT,window.GameConfig.GAME_HEIGHT=n}game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,game.scale.pageAlignHorizontally=!0,game.time.advancedTiming=!0,game.stage.disableVisibilityChange=!0,game.sound.context.resume(),this.bootModule=new H(this)}},{key:"preload",value:function(){this.bootModule.preload()}},{key:"create",value:function(){Q(),game.state.start("Load",!0,!1,{}),$("#dangtai").remove()}},{key:"update",value:function(){}},{key:"render",value:function(){}}])&&J(n.prototype,i),o&&J(n,o),t}();function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ae(e,t){return!t||"object"!==ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function se(e){return(se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var le=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ae(this,se(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addAnim(),this.addTextLoading()}},{key:"addTextLoading",value:function(){this.txtLoading=new Phaser.Text(game,this.positionPlayConfig.txtLoading.x*window.GameConfig.RESIZE,this.positionPlayConfig.txtLoading.y*window.GameConfig.RESIZE,this.positionPlayConfig.txtLoading.text,this.positionPlayConfig.txtLoading.configs),this.txtLoading.anchor.set(.5),this.addChild(this.txtLoading)}},{key:"addAnim",value:function(){this.animLoad=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,460*window.GameConfig.RESIZE,"loadingPlay");this.animLoad.animations.add("run_anim_load");this.animLoad.anchor.set(.5),this.animLoad.animations.play("run_anim_load",32,!0),this.addChild(this.animLoad)}},{key:"moveTxtLoading",value:function(){this.txtLoading.y=(this.positionPlayConfig.txtLoading.y+500)*window.GameConfig.RESIZE}},{key:"deleteTxtLoading",value:function(){this.txtLoading.destroy()}}])&&oe(n.prototype,i),o&&oe(n,o),t}();function he(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sound=null,this.playId=null,this.currentLoad=null,this.dic={},this.arrSrc=[],this.idxLoad=0,this.isLoading=!1,this.arrsSoundFx=[e.buttonclick,e.dailyreward,e.clickbuttonplayeventmode,e.getrewardsolomode,e.joineventmode,e.losesolomode,e.popupeventmodeend,e.popupfinishachievement,e.popupfinishquest,e.popupinviteroom,e.popuplevelup,e.showranking,e.takereward,e.winturnbase,e.winturnbasepartymode,e.loseturnbasepartymode,e.gameovereventmode,e.streakanswer]}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllSound||(this.controllSound=new e),this.controllSound}},{key:"buttonclick",get:function(){return"img/sound/soundfx/buttonclick.mp3"}},{key:"dailyreward",get:function(){return"img/sound/soundfx/dailyreward.mp3"}},{key:"clickbuttonplayeventmode",get:function(){return"img/sound/soundfx/clickbuttonplayeventmode.mp3"}},{key:"getrewardsolomode",get:function(){return"img/sound/soundfx/getrewardsolomode.mp3"}},{key:"joineventmode",get:function(){return"img/sound/soundfx/joineventmode.mp3"}},{key:"losesolomode",get:function(){return"img/sound/soundfx/losesolomode.mp3"}},{key:"popupeventmodeend",get:function(){return"img/sound/soundfx/popupeventmodeend.mp3"}},{key:"loseturnbase",get:function(){return"img/sound/soundfx/loseturnbasepartymode.mp3"}},{key:"popupfinishachievement",get:function(){return"img/sound/soundfx/popupfinishachievement.mp3"}},{key:"popupfinishquest",get:function(){return"img/sound/soundfx/popupfinishquest.mp3"}},{key:"popupinviteroom",get:function(){return"img/sound/soundfx/popupinviteroom.mp3"}},{key:"popuplevelup",get:function(){return"img/sound/soundfx/popuplevelup.mp3"}},{key:"showranking",get:function(){return"img/sound/soundfx/showranking.mp3"}},{key:"takereward",get:function(){return"img/sound/soundfx/takereward.mp3"}},{key:"winturnbase",get:function(){return"img/sound/soundfx/winturnbase.mp3"}},{key:"winturnbasepartymode",get:function(){return"img/sound/soundfx/winturnbasepartymode.mp3"}},{key:"loseturnbasepartymode",get:function(){return"img/sound/soundfx/loseturnbasepartymode.mp3"}},{key:"gameovereventmode",get:function(){return"img/sound/soundfx/gameovereventmode.mp3"}},{key:"streakanswer",get:function(){return"img/sound/soundfx/streakanswer.mp3"}}],(n=[{key:"loadSoundArray",value:function(e){!1===this.isLoading&&(this.arrSrc=e,this.isLoading=!0,this.idxLoad=0,this.loadItemInArray(this.arrSrc[this.idxLoad]))}},{key:"loadItemInArray",value:function(e){var t=this;this.dic[e]?this.checkLoadContinuteArray():(this.dic[e]=new Howl({src:[e]}),this.dic[e].on("load",function(){t.checkLoadContinuteArray()}),this.dic[e].on("loaderror",function(){t.checkLoadContinuteArray()}))}},{key:"checkLoadContinuteArray",value:function(){this.idxLoad++,this.idxLoad<this.arrSrc.length?this.loadItemInArray(this.arrSrc[this.idxLoad]):this.isLoading=!1,this.removeSound()}},{key:"beginLoad",value:function(){LogConsole.log("beginLoad sound -------------------"),this.loadSoundArray(this.arrsSoundFx)}},{key:"playSound",value:function(e){!1===game.paused&&1==window.GameConfig.SOUND_FX&&(this.removeSound(),"ctx"in Howler&&null!==Howler.ctx&&("suspended"!==Howler.ctx.state&&"interrupted"!==Howler.ctx.state||Howler.ctx.resume()),this.src=e,this.dic[e]?(this.sound=this.dic[e],this.playId=this.sound.play()):(this.sound=new Howl({src:[e]}),this.sound.on("end",function(){}),this.playId=this.sound.play()),this.sound.volume(1))}},{key:"removeSound",value:function(){null!==this.sound&&null!==this.playId&&(this.sound.stop(this.playId),this.sound=null)}}])&&he(t.prototype,n),i&&he(t,i),e}();function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fe(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ge(e,t){return(ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ye=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=fe(this,pe(t).call(this,game))).positionBootConfig=JSON.parse(game.cache.getText("positionBootConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ge(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addFireWork(),this.addFlower1(),this.addFlower2()}},{key:"addFireWork",value:function(){this.fireWork=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,180*window.GameConfig.RESIZE,"firework"),this.fireWork.anchor.set(.5),this.fireWork.scale.set(1.3),this.addChild(this.fireWork);this.fireWork.animations.add("run_firework");this.fireWork.animations.play("run_firework",30,!0)}},{key:"addFlower1",value:function(){this.flower1=new Phaser.Sprite(game,this.positionBootConfig.tet_theme.flower1.x,this.positionBootConfig.tet_theme.flower1.y,this.positionBootConfig.tet_theme.flower1.nameAtlas,this.positionBootConfig.tet_theme.flower1.nameSprite),this.flower1.angle=4,this.addChild(this.flower1),game.add.tween(this.flower1).to({angle:0},1500,Phaser.Easing.Linear.None,!0,0,-1).yoyo(!0,0)}},{key:"addFlower2",value:function(){this.flower2=new Phaser.Sprite(game,this.positionBootConfig.tet_theme.flower2.x,this.positionBootConfig.tet_theme.flower2.y,this.positionBootConfig.tet_theme.flower2.nameAtlas,this.positionBootConfig.tet_theme.flower2.nameSprite),this.flower2.angle=5,this.addChild(this.flower2),game.add.tween(this.flower2).to({angle:0},2e3,Phaser.Easing.Linear.None,!0,0,-1).yoyo(!0,0)}}])&&de(n.prototype,i),o&&de(n,o),t}();function me(e){return(me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ve(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function we(e,t){return!t||"object"!==me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _e(e,t){return(_e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Se=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=we(this,be(t).call(this,e))).isLoadAfterComplete=!1,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(t,H),n=t,(i=[{key:"preloadForLoad",value:function(){ce.instance().beginLoad(),game.load.text("positionDefaultSource","img/config/positionDefaultSource.json"+"?v=".concat(window.VersionClient)),game.load.text("positionIsNewUserConfig","img/config/positionIsNewUserConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionPopup","img/config/positionPopup.json"+"?v=".concat(window.VersionClient)),game.load.text("playScript","img/config/playScript.json"+"?v=".concat(window.VersionClient)),this.loadXML(),game.load.text("positionMenuConfig","img/config/positionMenuConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("dailyRewardConfig","img/config/dailyRewardConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("languageGame","img/config/languageGame.json"+"?v=".concat(window.VersionClient)),game.load.text("positionSetting","img/config/positionSetting.json"+"?v=".concat(window.VersionClient)),game.load.text("songDetailScreenConfig","img/config/songDetailScreenConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionDisconnectConfig","img/config/positionDisconnectConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionIsNewUserConfig","img/config/positionIsNewUserConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionChatScreenConfig","img/config/positionChatScreenConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("positionFriendRequestConfig","img/config/positionFriendRequestConfig.json"+"?v=".concat(window.VersionClient)),game.load.text("silentchat","img/config/silentchat.txt"+"?v=".concat(window.VersionClient)),game.load.text("positionUserProfile","img/config/positionUserProfile.json"+"?v=".concat(window.VersionClient)),game.load.text("positionQAndAConfig","img/config/questAndAchieveConfig.json"+"?v=".concat(window.VersionClient)),game.load.spritesheet("disconnect","img/assetss/Animation/Disconnect/sprites.png"+"?v=".concat(window.VersionClient),210,200.5,9),game.load.spritesheet("btnRankAnim","img/assetss/Animation/Fireworks_Squence/buttonRankAnim.png"+"?v=".concat(window.VersionClient),64,62,26),game.load.spritesheet("CircleScale","img/animations/CircleScale/sprites.png"+"?v=".concat(window.VersionClient),215.25,215.25,30),game.load.spritesheet("ButtonEvent","img/animations/EventBtn/sprites.png"+"?v=".concat(window.VersionClient),89,89,10),game.load.spritesheet("ButtonGift","img/animations/GiftBtn/sprites.png"+"?v=".concat(window.VersionClient),89,89,12),game.load.spritesheet("ButtonQuest","img/animations/QuestBtn/sprites.png"+"?v=".concat(window.VersionClient),89,89,12),game.load.spritesheet("ButtonRank","img/animations/RankBtn/sprites.png"+"?v=".concat(window.VersionClient),89,89,18),game.load.spritesheet("FindGameButton","img/animations/FindGameBtn/sprites.png"+"?v=".concat(window.VersionClient),177,115,18),game.load.spritesheet("PracticeButton","img/animations/PracticeBtn/sprites.png"+"?v=".concat(window.VersionClient),177,115,14),game.load.spritesheet("PartyButton","img/animations/PartyBtn/sprites.png"+"?v=".concat(window.VersionClient),177,115,18),game.load.spritesheet("56Questions","img/assetss/Animation/56Questions/sprites.png"+"?v=".concat(window.VersionClient),125,125,30),game.load.spritesheet("ButtonShop","img/animations/ShopBtn/shopBtn.png"+"?v=".concat(window.VersionClient),90,90,12),game.load.image("bg-playlist","img/background/bg-playlist.png"+"?v=".concat(window.VersionClient)),game.load.image("bg_scrollMenu","img/assetss/playlist/bg_scrollMenu.png"+"?v=".concat(window.VersionClient)),game.load.image("BG_Opacity","img/background/BG_Opacity.png"+"?v=".concat(window.VersionClient)),game.load.image("BG_Opacity_100","img/background/BG_Opacity_100.png"+"?v=".concat(window.VersionClient)),game.load.onFileComplete.add(this.fileComplete,this)}},{key:"fileComplete",value:function(e,t,n,i,o){var a=e;this.loadingTxt.setText("Đang tải... ".concat(a," %")),100==e&&(game.load.onFileComplete.removeAll(),game.load.onLoadComplete.add(this.onLoadAfterComplete),game.load.start())}},{key:"onLoadAfterComplete",value:function(){LogConsole.log("on load complete")}},{key:"loadXML",value:function(){game.load.atlas("defaultSource","img/atlas/defaultSource.png"+"?v=".concat(window.VersionClient),"img/atlas/defaultSource.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("popup","img/atlas/popup.png"+"?v=".concat(window.VersionClient),"img/atlas/popup.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.spritesheet("trueanswer","img/atlas/TrueAnswer.png"+"?v=".concat(window.VersionClient),180,180,19),game.load.spritesheet("failanswer","img/atlas/FailAnswer.png"+"?v=".concat(window.VersionClient),180,180,19),game.load.atlas("limitTurn","img/atlas/limitTurn.png"+"?v=".concat(window.VersionClient),"img/atlas/limitTurn.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("playlistSprites","img/atlas/choosePlaylist.png"+"?v=".concat(window.VersionClient),"img/atlas/choosePlaylist.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("otherSprites","img/atlas/OtherSprites.png"+"?v=".concat(window.VersionClient),"img/atlas/OtherSprites.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.spritesheet("actionphaseanswer1","img/atlas/ActionPhaseAnswer1.png"+"?v=".concat(window.VersionClient),350,350,24),game.load.spritesheet("actionphaseanswer2","img/atlas/ActionPhaseAnswer2.png"+"?v=".concat(window.VersionClient),336,317,24),game.load.spritesheet("actionphaseanswer3","img/atlas/ActionPhaseAnswer3.png"+"?v=".concat(window.VersionClient),382,320,23),game.load.atlas("dailyRewardSprites","img/atlas/dailyReward.png"+"?v=".concat(window.VersionClient),"img/atlas/dailyReward.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("mainMenuSprites","img/atlas/mainMenu.png"+"?v=".concat(window.VersionClient),"img/atlas/mainMenu.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("songDetailSprites","img/atlas/songDetail.png"+"?v=".concat(window.VersionClient),"img/atlas/songDetail.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.spritesheet("EffectAchiment","img/atlas/EffectAchiment.png"+"?v=".concat(window.VersionClient),112*z.instance().scale,114*z.instance().scale,20),game.load.spritesheet("SoloModeStar","img/animations/SoloModeStar/SoloModeStar.png"+"?v=".concat(window.VersionClient),125*z.instance().scale,125*z.instance().scale,26),game.load.atlas("questAndAchieveSprites","img/atlas/questAchievement.png"+"?v=".concat(window.VersionClient),"img/atlas/questAchievement.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("IconChatOnlineMode","img/atlas/IconChatGame.png"+"?v=".concat(window.VersionClient),"img/atlas/IconChatGame.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("disconnectSprites","img/atlas/disconnect.png"+"?v=".concat(window.VersionClient),"img/atlas/disconnect.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("isNewUserSprites","img/atlas/newUser.png"+"?v=".concat(window.VersionClient),"img/atlas/newUser.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("practicePopupSprites","img/assetss/Practice/Ingame/sprites.png"+"?v=".concat(window.VersionClient),"img/assetss/Practice/Ingame/sprites.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("mailSprites","img/atlas/mail.png"+"?v=".concat(window.VersionClient),"img/atlas/mail.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("friendRequestSprites","img/atlas/friendRequest.png"+"?v=".concat(window.VersionClient),"img/atlas/friendRequest.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.atlas("settingSprites","img/atlas/setting.png"+"?v=".concat(window.VersionClient),"img/atlas/setting.json"+"?v=".concat(window.VersionClient),Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),game.load.audio("beep_audio","img/assetss/sound/PipCountDown.mp3"+"?v=".concat(window.VersionClient)),game.load.image("ava_bot","img/ava_bot.jpg")}},{key:"createSpritesForLoadState",value:function(){this.positionBootConfig=this.getpositionBootConfig(),this.addBackgroundSprite(),this.addLogoSprite(),this.addAnimLoading(),this.addLoadingProgressTxt(),this.addTermText(),this.addDance()}},{key:"addLoadingProgressTxt",value:function(){this.loadingTxt=game.add.text(this.positionBootConfig.txt_loading.x*window.GameConfig.RESIZE,this.positionBootConfig.txt_loading.y*window.GameConfig.RESIZE,this.positionBootConfig.txt_loading.text,this.positionBootConfig.txt_loading.configs),this.loadingTxt.anchor.set(.5)}},{key:"addAnimLoading",value:function(){var e=new le;this.state.add.existing(e),e.deleteTxtLoading()}},{key:"addThemeTET",value:function(){var e=new ye;this.state.add.existing(e)}}])&&ve(n.prototype,i),o&&ve(n,o),t}();function Ee(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ce=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"LOGIN",get:function(){return"screen_login"}},{key:"MAIN_MENU",get:function(){return"screen_main_menu"}},{key:"QUEST_ACHIEVEMENT",get:function(){return"screen_quest_achievement"}},{key:"EVENT_MODE",get:function(){return"screen_event_mode"}},{key:"QUICK_PLAY",get:function(){return"screen_quick_play"}},{key:"RANKING_ALL",get:function(){return"screen_ranking_all"}},{key:"SOLO_MODE",get:function(){return"screen_solo_mode"}},{key:"ONLINE_MODE",get:function(){return"screen_online_mode"}},{key:"MAIL",get:function(){return"screen_mail"}},{key:"ADD_FRIEND",get:function(){return"screen_add_friend"}},{key:"NEW_USER",get:function(){return"screen_new_user"}},{key:"TURN_BASE",get:function(){return"screen_turn_base"}},{key:"POPUP_ILLEGAL_TURN",get:function(){return"screen_popup_illegal_turn"}},{key:"DAILY_REWARD",get:function(){return"screen_daily_reward"}},{key:"SOLOMODE_TIMEOUT",get:function(){return"popup_solomode_timeout"}},{key:"SOLOMODE_LOSE_POPUP",get:function(){return"popup_solomode_lose"}},{key:"SOLOMODE_REWARD",get:function(){return"popup_solomode_reward"}},{key:"SOLOMODE_NOT_REWARD",get:function(){return"popup_solomode_not_reward"}},{key:"SOLOMODE_DONE",get:function(){return"popup_solomode_done"}},{key:"ANIM_CLAIM_REWARD",get:function(){return"anim_claim_reward"}},{key:"QUEST_CLAIM_POPUP",get:function(){return"popup_claim_quest"}},{key:"ACHIEVEMENT_CLAIM_POPUP",get:function(){return"popup_claim_achievement"}},{key:"CHAT_SCREEN",get:function(){return"chat_screen"}},{key:"SETTING_GAME",get:function(){return"screen_setting"}}],(n=null)&&Ee(t.prototype,n),i&&Ee(t,i),e}();function ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Pe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"LEVEL_UP_NOTIFICATION",get:function(){return"LEVEL_UP_NOTIFICATION"}},{key:"CHAT_ONLINE_MODE",get:function(){return"CHAT_ONLINE_MODE"}},{key:"CHAT_EVENT_MODE",get:function(){return"CHAT_EVENT_MODE"}},{key:"FB_USER_INVITE_FRIEND_REQUEST",get:function(){return"FB_USER_INVITE_FRIEND_REQUEST"}},{key:"FB_USER_INVITE_FRIEND_RESPONSE",get:function(){return"FB_USER_INVITE_FRIEND_RESPONSE"}},{key:"FB_USER_SHARED_RESULT_REQUEST",get:function(){return"FB_USER_SHARED_RESULT_REQUEST"}},{key:"FB_USER_SHARED_RESULT_RESPONSE",get:function(){return"FB_USER_SHARED_RESULT_RESPONSE"}},{key:"BROADCASH_NOTIFICATION",get:function(){return"BROADCASH_NOTIFICATION"}},{key:"INIT_CLIENT_GAME_DATA_REQUEST",get:function(){return"INIT_CLIENT_GAME_DATA_REQUEST"}},{key:"INIT_CLIENT_GAME_DATA_RESPONSE",get:function(){return"INIT_CLIENT_GAME_DATA_RESPONSE"}},{key:"TURNBASE_RELOAD_RANDOM_OPPONENT_REQUEST",get:function(){return"TURNBASE_RELOAD_RANDOM_OPPONENT_REQUEST"}},{key:"TURNBASE_RELOAD_RANDOM_OPPONENT_RESPONSE",get:function(){return"TURNBASE_RELOAD_RANDOM_OPPONENT_RESPONSE"}},{key:"INIT_ONLINE_MODE_BET_REQUEST",get:function(){return"INIT_ONLINE_MODE_BET_REQUEST"}},{key:"INIT_ONLINE_MODE_BET_RESPONSE",get:function(){return"INIT_ONLINE_MODE_BET_RESPONSE"}},{key:"INIT_ONLINE_MODE_ROOM_BET_REQUEST",get:function(){return"INIT_ONLINE_MODE_ROOM_BET_REQUEST"}},{key:"INIT_ONLINE_MODE_ROOM_BET_RESPONSE",get:function(){return"INIT_ONLINE_MODE_ROOM_BET_RESPONSE"}},{key:"INIT_EVENT_LIST_REQUEST",get:function(){return"INIT_EVENT_LIST_REQUEST"}},{key:"INIT_EVENT_LIST_RESPONSE",get:function(){return"INIT_EVENT_LIST_RESPONSE"}},{key:"INIT_SUGGESTION_OPPONENT_REQUEST",get:function(){return"INIT_SUGGESTION_OPPONENT_REQUEST"}},{key:"INIT_SUGGESTION_OPPONENT_RESPONSE",get:function(){return"INIT_SUGGESTION_OPPONENT_RESPONSE"}},{key:"INIT_PLAYLIST_LEVEL_SETTING_REQUEST",get:function(){return"INIT_PLAYLIST_LEVEL_SETTING_REQUEST"}},{key:"INIT_PLAYLIST_LEVEL_SETTING_RESPONSE",get:function(){return"INIT_PLAYLIST_LEVEL_SETTING_RESPONSE"}},{key:"INIT_MAIN_QUEST_DATA_REQUEST",get:function(){return"INIT_MAIN_QUEST_DATA_REQUEST"}},{key:"INIT_MAIN_QUEST_DATA_RESPONSE",get:function(){return"INIT_MAIN_QUEST_DATA_RESPONSE"}},{key:"INIT_SHOP_PLAYLIST_REQUEST",get:function(){return"INIT_SHOP_PLAYLIST_REQUEST"}},{key:"INIT_SHOP_PLAYLIST_RESPONSE",get:function(){return"INIT_SHOP_PLAYLIST_RESPONSE"}},{key:"INIT_USER_PLAYLIST_MAPPING_REQUEST",get:function(){return"INIT_USER_PLAYLIST_MAPPING_REQUEST"}},{key:"INIT_USER_PLAYLIST_MAPPING_RESPONSE",get:function(){return"INIT_USER_PLAYLIST_MAPPING_RESPONSE"}},{key:"EVENT_UPDATE",get:function(){return"EVENT_UPDATE"}}],(n=null)&&ke(t.prototype,n),i&&ke(t,i),e}();function Oe(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Re=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){LogConsole.log("SendFbUserInvite : ");for(var n=new SFS2X.SFSArray,i=0;i<t.length;i++)LogConsole.log(t[i]),n.addUtfString(t[i]);var o=new SFS2X.SFSObject;return o.putUtfString("invite_id",e),o.putSFSArray("fb_ids",n),o}}],(n=null)&&Oe(t.prototype,n),i&&Oe(t,i),e}();function xe(e){return(xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Te(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ie=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event={loginComplete:new Phaser.Signal,loginError:new Phaser.Signal,logoutDone:new Phaser.Signal,logoutErr:new Phaser.Signal,loginStatusUnknown:new Phaser.Signal}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.fbMobile||(this.fbMobile=new e),this.fbMobile}}],(n=[{key:"init",value:function(){facebookConnectPlugin.getLoginStatus(this.getLoginStatusSuccess.bind(this),this.getLoginStatusFail.bind(this))}},{key:"getLoginStatusSuccess",value:function(e){console.log("getLoginStatus succeed, statua written in log"),console.log(e),"connected"===e.status?(z.instance().LOG_IN_BY_FB=!0,this.onLoginSuccess(e)):"unknown"===e.status&&this.event.loginStatusUnknown.dispatch()}},{key:"login",value:function(){facebookConnectPlugin.login(["public_profile","email","user_gender","user_friends"],this.onLoginSuccess.bind(this),this.onLoginError.bind(this))}},{key:"logout",value:function(e){facebookConnectPlugin.logout(function(t){z.instance().LOG_IN_BY_FB=!1;var n="";"OK"==t&&(n="unknown"),e({status:n})},function(t){console.log("logout fail!"),console.log(t),e(t)})}},{key:"getLoginStatusFail",value:function(e){console.log("getLoginStatus fail, error written in log"),console.log(e)}},{key:"onLoginSuccess",value:function(e){console.log("login succeed, userData written in log"),console.log(e),this.event.loginComplete.dispatch(e.authResponse)}},{key:"onLoginError",value:function(e){console.log("login fail, error written in log"),console.log(e),this.event.loginError.dispatch()}},{key:"logEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;facebookConnectPlugin.logEvent(z.instance().platform+"_"+e,{},t,this.onLogEventSuccess.bind(this),this.onLogEventError.bind(this))}},{key:"onLogEventSuccess",value:function(e){console.log("onLogEventSuccess"),console.log(e)}},{key:"onLogEventError",value:function(e){console.log("onLogEventError"),console.log(e)}},{key:"share",value:function(){var e=game.canvas.toDataURL("image/png");console.log("data image------------"),console.log(e);var t={message:"Wazzat so tài âm nhạc",subject:"Wazzat",files:[e]};window.plugins.socialsharing.shareWithOptions(t,function(e){console.log("share ok"),console.log(e),TF.instance().sendData(Pe.FB_USER_SHARED_RESULT_REQUEST,null)},function(e){console.log("share fail"),console.log(e)})}},{key:"dataURItoBlob",value:function(e){for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),i=new Uint8Array(n),o=0;o<t.length;o++)i[o]=t.charCodeAt(o);return new Blob([n],{type:"image/png"})}},{key:"shareSuccess",value:function(e){console.log("showDialog success, data written in log"),console.log(e),TF.instance().sendData(Pe.FB_USER_SHARED_RESULT_REQUEST,null)}},{key:"shareError",value:function(e){console.log("showDialog fail, error written in log"),console.log(e)}},{key:"invite",value:function(){console.log("invite");facebookConnectPlugin.showDialog({method:"apprequests",message:"So Tài Âm Nhạc",data:{},title:"So Tài Âm Nhạc",actionType:"askfor",filters:"app_non_users"},this.inviteSuccess.bind(this),this.inviteError.bind(this))}},{key:"inviteSuccess",value:function(e){console.log("inviteSuccess success, data written in log"),console.log(e),"object"===xe(e)&&e.hasOwnProperty("requestId")&&TF.instance().sendData(Pe.FB_USER_INVITE_FRIEND_REQUEST,Re.begin(e.requestId,e.recipientsIds))}},{key:"inviteError",value:function(e){console.log("inviteError fail, error written in log"),console.log(e)}}])&&Te(t.prototype,n),i&&Te(t,i),e}();function Ae(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Le=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.fbChecking||(this.fbChecking=new e),this.fbChecking}},{key:"Login_buttons",get:function(){return"Button_Login"}},{key:"Choose_genre_Buttons",get:function(){return"Button_Choose_genre"}},{key:"Find_Game_turnbase_mode_button",get:function(){return"Button_turnbase_mode"}},{key:"Find_Game_turbase_random_opponent_button",get:function(){return"Button_turbase_random_opponent"}},{key:"Find_Game_Suggestion_Opponent_profile_button",get:function(){return"Button_Suggestion_Opponent_profile"}},{key:"Party_online_mode_button",get:function(){return"Button_Party_online_mode"}},{key:"Party_online_mode_quickplay_button",get:function(){return"Button_quickplay"}},{key:"Party_online_mode_Creatroom_button",get:function(){return"Button_Creatroom"}},{key:"Solo_mode_button",get:function(){return"Button_Solo_mode"}},{key:"Solo_mode_quiz_play_button",get:function(){return"Button_Solo_mode_quiz_play"}},{key:"Solo_mode_ranking_button",get:function(){return"Button_Solo_mode_ranking"}},{key:"Event_mode_button",get:function(){return"Button_Event_mode"}},{key:"Event_mode_join_room_button",get:function(){return"Button_Event_mode_join_room"}},{key:"Event_mode_play_button",get:function(){return"Button_Event_mode_play"}},{key:"Ranking_level_button",get:function(){return"Button_Ranking_level"}},{key:"Ranking_diamond_button",get:function(){return"Button_Ranking_diamond"}},{key:"Ranking_turnbase_button",get:function(){return"Button_Ranking_turnbase"}},{key:"Ranking_online_button",get:function(){return"Button_Ranking_online"}},{key:"Quest_main_button",get:function(){return"Button_Quest_main"}},{key:"Quest_Achievement_button",get:function(){return"Button_Quest_Achievement"}},{key:"Quest_Daily_button",get:function(){return"Button_Quest_Daily"}},{key:"Mail_button",get:function(){return"Button_Mail"}},{key:"Shop_playlist_button",get:function(){return"Button_Shop_playlist"}},{key:"Shop_resource_button",get:function(){return"Button_Shop_resource"}},{key:"Shop_items_support_butotn",get:function(){return"Button_Shop_items_support_butotn"}},{key:"Shop_Vip_button",get:function(){return"Button_Shop_Vip"}},{key:"Friend_add_button",get:function(){return"Button_Friend_add"}},{key:"Loading",get:function(){return"Sreen_Loading"}},{key:"LoginScreen",get:function(){return"Sreen_LoginScreen"}},{key:"Mainmenu",get:function(){return"Sreen_Mainmenu"}},{key:"Choose_genre",get:function(){return"Sreen_Choose_genre"}},{key:"Main_menu",get:function(){return"Sreen_Main_menu"}},{key:"Daily_reward",get:function(){return"Sreen_Daily_reward"}},{key:"Find_Game_turnbase_mode",get:function(){return"Sreen_Find_Game_turnbase_mode"}},{key:"Find_Game_turbase_random_opponent",get:function(){return"Sreen_turbase_random_opponent"}},{key:"Find_Game_Suggestion_Opponent_profile",get:function(){return"Sreen_Suggestion_Opponent_profile"}},{key:"Party_online_mode",get:function(){return"Sreen_Party_online_mode"}},{key:"Party_online_mode_quickplay",get:function(){return"Sreen_Party_online_mode_quickplay"}},{key:"Party_online_mode_Creatroom",get:function(){return"Sreen_Party_online_mode_Creatroom"}},{key:"Solo_mode",get:function(){return"Sreen_Solo_mode"}},{key:"Solo_mode_quiz_play",get:function(){return"Sreen_Solo_mode_quiz_play"}},{key:"Solo_mode_ranking",get:function(){return"Sreen_Solo_mode_ranking"}},{key:"Event_mode",get:function(){return"Sreen_Event_mode"}},{key:"Event_mode_join_room",get:function(){return"Sreen_Event_mode_join_room"}},{key:"Event_mode_play",get:function(){return"Sreen_Event_mode_play"}},{key:"Ranking_level",get:function(){return"Sreen_Ranking_level"}},{key:"Ranking_diamond",get:function(){return"Sreen_Ranking_diamond"}},{key:"Ranking_turnbase",get:function(){return"Sreen_Ranking_turnbase"}},{key:"Ranking_online",get:function(){return"Sreen_Ranking_online"}},{key:"Quest_main",get:function(){return"Sreen_Quest_main"}},{key:"Quest_Achievement",get:function(){return"Sreen_Quest_Achievement"}},{key:"Quest_Daily",get:function(){return"Sreen_Quest_Daily"}},{key:"Mail",get:function(){return"Sreen_Mail"}},{key:"Shop_playlist",get:function(){return"Sreen_Shop_playlist"}},{key:"Shop_resource",get:function(){return"Sreen_Shop_resource"}},{key:"Shop_items_support",get:function(){return"Sreen_Shop_items_support"}},{key:"Shop_Vip",get:function(){return"Sreen_Shop_Vip"}},{key:"Friend_add",get:function(){return"Sreen_Friend_add"}},{key:"Popup_Quest",get:function(){return"Sreen_Popup_Quest"}},{key:"Popup_Achievement",get:function(){return"Sreen_Popup_Achievement"}},{key:"Popup_invite_online_room",get:function(){return"Sreen_Popup_invite_online_room"}},{key:"Screen_Play_Script",get:function(){return"screen_play_script"}},{key:"Screen_Play_Script_Skip",get:function(){return"screen_play_script_skip"}},{key:"total_time",get:function(){return"total_time"}},{key:"play_time",get:function(){return"play_time"}},{key:"pro_bad_imp",get:function(){return"pro_bad_imp"}},{key:"pro_bad_click",get:function(){return"pro_bad_click"}},{key:"pro_fad_imp",get:function(){return"pro_fad_imp"}},{key:"pro_fad_click",get:function(){return"pro_fad_click"}},{key:"pro_rad_imp",get:function(){return"pro_rad_imp"}},{key:"pro_quiz_start_createroom",get:function(){return"pro_quiz_start_createroom"}},{key:"pro_quiz_end_createroom",get:function(){return"pro_quiz_end_createroom"}},{key:"pro_quiz_start_quickplay",get:function(){return"pro_quiz_start_quickplay"}},{key:"pro_quiz_end_quickplay",get:function(){return"pro_quiz_end_quickplay"}},{key:"pro_quiz_start_turnbase",get:function(){return"pro_quiz_start_turnbase"}},{key:"pro_quiz_end_turnbase",get:function(){return"pro_quiz_end_turnbase"}},{key:"pro_quiz_start_solomode",get:function(){return"pro_quiz_start_solomode"}},{key:"pro_quiz_end_solomode",get:function(){return"pro_quiz_end_solomode"}},{key:"pro_quiz_start_eventmode",get:function(){return"pro_quiz_start_eventmode"}},{key:"pro_quiz_end_eventmode",get:function(){return"pro_quiz_end_eventmode"}},{key:"InterstitialTurnBase",get:function(){return"InterstitialTurnBase"}},{key:"InterstitialQuickPlay",get:function(){return"InterstitialQuickPlay"}},{key:"InterstitialCreateRoom",get:function(){return"InterstitialCreateRoom"}},{key:"InterstitialSoloModeWin",get:function(){return"InterstitialSoloModeWin"}},{key:"InterstitialSoloModeGameOver",get:function(){return"InterstitialSoloModeGameOver"}},{key:"InterstitialQuest",get:function(){return"InterstitialQuest"}},{key:"InterstitialAchievement",get:function(){return"InterstitialAchievement"}},{key:"InterstitialDoneSoloMode",get:function(){return"InterstitialDoneSoloMode"}},{key:"InterstitialEventMode",get:function(){return"InterstitialEventMode"}},{key:"RewardVideoInappDiamond",get:function(){return"RewardVideoInappDiamond"}},{key:"RewardVideoInappTicket",get:function(){return"RewardVideoInappTicket"}},{key:"RewardVideoInappHeart",get:function(){return"RewardVideoInappHeart"}},{key:"RewardVideoInappSupportItem",get:function(){return"RewardVideoInappSupportItem"}},{key:"RewardVideoX2DailyReward",get:function(){return"RewardVideoX2DailyReward"}},{key:"RewardVideoGetHeartInSoloMode",get:function(){return"RewardVideoGetHeartInSoloMode"}},{key:"RewardVideoX2DiamondButtonSoloMode",get:function(){return"RewardVideoX2DiamondButtonSoloMode"}},{key:"RewardVideoLuckyWheel",get:function(){return"RewardVideoLuckyWheel"}},{key:"BannerQuest",get:function(){return"BannerQuest"}},{key:"BannerEventRoom",get:function(){return"BannerEventRoom"}},{key:"BannerUserProfile",get:function(){return"BannerUserProfile"}},{key:"BannerViewAllFriend",get:function(){return"BannerViewAllFriend"}},{key:"BannerInfoSong",get:function(){return"BannerInfoSong"}},{key:"BannerPartyMode",get:function(){return"BannerPartyMode"}},{key:"BannerQuickPlayModeRoom",get:function(){return"BannerQuickPlayModeRoom"}},{key:"BannerChooseBettingQuickPlay",get:function(){return"BannerChooseBettingQuickPlay"}},{key:"BannerWaitingRoomQuickPlayScreen",get:function(){return"BannerWaitingRoomQuickPlayScreen"}},{key:"BannerChoosePlayListQuickPlay",get:function(){return"BannerChoosePlayListQuickPlay"}},{key:"BannerChooseBettingCreateRoom",get:function(){return"BannerChooseBettingCreateRoom"}},{key:"BannerInviteOtherFriend",get:function(){return"BannerInviteOtherFriend"}},{key:"SuggetRatingShow",get:function(){return"SuggetRatingShow"}},{key:"SuggetRatingVoteSau",get:function(){return"SuggetRatingVoteSau"}},{key:"SuggetRatingVoteNgay",get:function(){return"SuggetRatingVoteNgay"}},{key:"SuggetRatingClose",get:function(){return"SuggetRatingClose"}}],(n=[{key:"logEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;!0===window.isTest&&(window.cordova&&"undefined"!=typeof device?Ie.instance().logEvent(e,t):FB.AppEvents.logEvent(z.instance().platform+"_"+e,t))}}])&&Ae(t.prototype,n),i&&Ae(t,i),e}();function Ge(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var De=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event={updateGemPlayer:new Phaser.Signal,tweenAllClaimDailyQuestDone:new Phaser.Signal,onConnectServer:new Phaser.Signal,chooseExitBadConnection:new Phaser.Signal,bad_connection:new Phaser.Signal,updateDescription:new Phaser.Signal,clickOKDialog:new Phaser.Signal,searchFriendBackUserProfile:new Phaser.Signal,backButton:new Phaser.Signal,chooseNoPopupConfirm:new Phaser.Signal,turnBaseUpdate:new Phaser.Signal,backChat:new Phaser.Signal,backSystemChat:new Phaser.Signal,backLastWeek:new Phaser.Signal}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.eventgame||(this.eventgame=new e),this.eventgame}}],(n=null)&&Ge(t.prototype,n),i&&Ge(t,i),e}();function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Be(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ue(e,t){return(Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fe=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Be(this,je(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ue(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addAnim(),this.addTextLoading()}},{key:"addTextLoading",value:function(){this.txtLoading=new Phaser.Text(game,this.positionPlayConfig.txtLoading.x*window.GameConfig.RESIZE,this.positionPlayConfig.txtLoading.y*window.GameConfig.RESIZE,this.positionPlayConfig.txtLoading.text,this.positionPlayConfig.txtLoading.configs),this.txtLoading.anchor.set(.5),this.addChild(this.txtLoading)}},{key:"addAnim",value:function(){this.animLoad=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,600*window.GameConfig.RESIZE,"loadingPlay");this.animLoad.animations.add("run_anim_load");this.animLoad.anchor.set(.5),this.animLoad.animations.play("run_anim_load",32,!0),this.addChild(this.animLoad)}},{key:"moveTxtLoading",value:function(){this.txtLoading.y=-200*window.GameConfig.RESIZE}}])&&Ne(n.prototype,i),o&&Ne(n,o),t}();function Ze(e){return(Ze="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function He(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qe(e,t){return!t||"object"!==Ze(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qe=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Qe(this,Ve(t).call(this,game))).idShowResult=null,e.bg=new Phaser.Button(game,0,0,"screen-dim2"),e.bg.visible=!1,e.addChild(e.bg),e.loading=new Fe,e.loading.visible=!1,e.addChild(e.loading),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&We(e,t)}(t,Phaser.Group),n=t,o=[{key:"instance",value:function(){return this.controllLoading||(this.controllLoading=new t),this.controllLoading}}],(i=[{key:"showLoading",value:function(){this.loading.visible=!0,this.bg.visible=!0,z.instance().isShowLoading=!0,this.removeShowResult(),this.idShowResult=game.time.events.add(90*Phaser.Timer.SECOND,this.hideLoading,this)}},{key:"removeShowResult",value:function(){null!==this.idShowResult&&(game.time.events.remove(this.idShowResult),this.idShowResult=null)}},{key:"hideLoading",value:function(){z.instance().isShowLoading=!1,this.removeShowResult(),this.loading.visible=!1,this.bg.visible=!1}},{key:"removeAllItem",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&He(n.prototype,i),o&&He(n,o),t}();function Ke(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ze=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"getNamePlatform",value:function(){return"and"===z.instance().platform?e.ANDROID:"ios"===z.instance().platform?e.IOS:e.WEB}},{key:"ANDROID",get:function(){return"ANDROID"}},{key:"IOS",get:function(){return"IOS"}},{key:"WEB",get:function(){return"WEB"}},{key:"UNKNOWN",get:function(){return"UNKNOWN"}}],(n=null)&&Ke(t.prototype,n),i&&Ke(t,i),e}();function Ye(e){return(Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Je(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xe(e,t){return!t||"object"!==Ye(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $e(e){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Xe(this,$e(t).call(this,game,0,0,"screen-dim"))).input.useHandCursor=!1,e.positionDisconnectConfig=JSON.parse(game.cache.getText("positionDisconnectConfig")),e.popup,e.signalInput=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addPopup(this.positionDisconnectConfig.popup)}},{key:"addPopup",value:function(e){this.popup=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.y)*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.animDisc,this.btn,this.txtDisconnect,this.addChild(this.popup),this.addAnim(),this.addBtn(this.positionDisconnectConfig.btn),this.addTxtDisconnect(this.positionDisconnectConfig.txtDis)}},{key:"addAnim",value:function(){this.animDisc=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,60*window.GameConfig.RESIZE,"disconnect"),this.animDisc.anchor.set(.5,0);this.animDisc.animations.add("run_anim_dis");this.animDisc.animations.play("run_anim_dis",20,!0),this.popup.addChild(this.animDisc)}},{key:"addBtn",value:function(e){this.btn=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btn.inputEnabled=!0,this.btn.events.onInputUp.addOnce(this.onClickRetry,this),this.popup.addChild(this.btn),this.txtBtn,this.addTxtBtn(this.positionDisconnectConfig.txtBtn)}},{key:"onClickRetry",value:function(){this.btn.inputEnabled=!1,LogConsole.log("Retry"),this.onConnectServer()}},{key:"onConnectServer",value:function(){rF.instance().changeScreen(Ce.LOGIN),this.destroy()}},{key:"addTxtDisconnect",value:function(e){this.txtDisconnect=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtDisconnect.anchor.set(.5,0),this.popup.addChild(this.txtDisconnect)}},{key:"addTxtBtn",value:function(e){this.txtBtn=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtBtn.anchor.set(.5,0),this.btn.addChild(this.txtBtn)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Je(n.prototype,i),o&&Je(n,o),t}();function nt(e){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ot(e,t){return!t||"object"!==nt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function at(e){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function st(e,t){return(st=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=ot(this,at(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,e.nameAtlas,e.nameSprite)),e.hasOwnProperty("tint")&&(n.tint=e.tint),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&st(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"setSize",value:function(e,t){this.width=e,this.height=t}}])&&it(n.prototype,i),o&&it(n,o),t}();function lt(e){return(lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ht(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ct(e,t){return!t||"object"!==lt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ut(e,t,n){return(ut="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dt(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dt(e){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ft(e,t){return(ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pt=function(e){function t(e,n,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ct(this,dt(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,e.nameAtlas,n,i,null,e.nameSprite))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ft(e,t)}(t,Phaser.Button),n=t,(i=[{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),ut(dt(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}}])&&ht(n.prototype,i),o&&ht(n,o),t}();function gt(e){return(gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mt(e,t){return!t||"object"!==gt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vt(e){return(vt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wt(e,t){return(wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bt={font:"Gilroy",fontSize:40*z.instance().scale,fill:"white",align:"center",boundsAlignH:"center",boundsAlignV:"middle"},_t=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=mt(this,vt(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,n,Object.assign({},bt,e.style)))).changeStyle(e.style),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wt(e,t)}(t,Phaser.Text),n=t,(i=[{key:"setButton",value:function(e,t){this.onInputUp=new Phaser.Signal,this.onInputUp.add(e,t),this.inputEnabled=!0,this.events.onInputOver.add(this.over,this),this.events.onInputOut.add(this.out,this),this.events.onInputDown.add(this.down,this),this.events.onInputUp.add(this.up,this)}},{key:"over",value:function(e){LogConsole.log("over text button")}},{key:"out",value:function(e){LogConsole.log("out text button")}},{key:"down",value:function(e){LogConsole.log("down text button")}},{key:"up",value:function(e){LogConsole.log("up text button"),ce.instance().playSound(ce.buttonclick),this.onInputUp.dispatch(e)}},{key:"changeStyle",value:function(e){var t={};for(var n in e)"maxLines"===n||(Number.isFinite(e[n])?t[n]=e[n]*z.instance().scale:t[n]=e[n]);t=Object.assign({},this.style,t),this.setStyle(t)}}])&&yt(n.prototype,i),o&&yt(n,o),t}();function St(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Et=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"BECHALLENGED_GAME_PLAY_HISTORY_RESPONSE",get:function(){return"BECHALLENGED_GAME_PLAY_HISTORY_RESPONSE"}},{key:"MAIN_MENU_LOAD_RESPONSE",get:function(){return"MAIN_MENU_LOAD_RESPONSE"}},{key:"CHALLENGE_GAME_QUESTIONS_RESPONSE",get:function(){return"CHALLENGE_GAME_QUESTIONS_RESPONSE"}},{key:"CHALLENGE_GAME_FIND_OPPONENTS_RESPONSE",get:function(){return"CHALLENGE_GAME_FIND_OPPONENTS_RESPONSE"}},{key:"CHALLENGE_GAME_GET_PLAYLISTS_RESPONSE",get:function(){return"CHALLENGE_GAME_GET_PLAYLISTS_RESPONSE"}},{key:"BECHALLENGED_GAME_OPPONENT_GAME_LOG_RESPONSE",get:function(){return"BECHALLENGED_GAME_OPPONENT_GAME_LOG_RESPONSE"}},{key:"NEW_USER_SELECTED_GENRES_RESPONSE",get:function(){return"NEW_USER_SELECTED_GENRES_RESPONSE"}},{key:"NEW_USER_GENRES_LIST_RESPONSE",get:function(){return"NEW_USER_GENRES_LIST_RESPONSE"}},{key:"SOLO_MODE_PLAYLISTS_RESPONSE",get:function(){return"SOLO_MODE_PLAYLISTS_RESPONSE"}},{key:"SOLO_MODE_PLAYLIST_SELECTED_RESPONSE",get:function(){return"SOLO_MODE_PLAYLIST_SELECTED_RESPONSE"}},{key:"CHALLENGE_GAME_FINISH_RESPONSE",get:function(){return"CHALLENGE_GAME_FINISH_RESPONSE"}},{key:"BECHALLENGED_GAME_FINISH_RESPONSE",get:function(){return"BECHALLENGED_GAME_FINISH_RESPONSE"}},{key:"SOLO_MODE_FINISH_RESPONSE",get:function(){return"SOLO_MODE_FINISH_RESPONSE"}},{key:"SOLO_MODE_GOT_REWARD_RESPONSE",get:function(){return"SOLO_MODE_GOT_REWARD_RESPONSE"}},{key:"SOLO_MODE_TOP10_THIS_WEEK_RESPONSE",get:function(){return"SOLO_MODE_TOP10_THIS_WEEK_RESPONSE"}},{key:"SOLO_MODE_TOP10_LAST_WEEK_RESPONSE",get:function(){return"SOLO_MODE_TOP10_LAST_WEEK_RESPONSE"}},{key:"SHOP_BUY_PLAYLIST_RESPONSE",get:function(){return"SHOP_BUY_PLAYLIST_RESPONSE"}},{key:"QUEST_LOAD_RESPONSE",get:function(){return"QUEST_LOAD_RESPONSE"}},{key:"QUEST_CLAIM_REWARD_RESPONSE",get:function(){return"QUEST_CLAIM_REWARD_RESPONSE"}},{key:"QUEST_ACHIEVED_NOTIFICATION",get:function(){return"QUEST_ACHIEVED_NOTIFICATION"}},{key:"ACHIEVEMENT_LOAD_RESPONSE",get:function(){return"ACHIEVEMENT_LOAD_RESPONSE"}},{key:"USER_PROFILE_LOAD_RESPONSE",get:function(){return"USER_PROFILE_LOAD_RESPONSE"}},{key:"LEVEL_UP_NOTIFICATION",get:function(){return"LEVEL_UP_NOTIFICATION"}},{key:"CHAT_ONLINE_MODE",get:function(){return"CHAT_ONLINE_MODE"}},{key:"ACHIEVEMENT_ACHIEVED_NOTIFICATION",get:function(){return"ACHIEVEMENT_ACHIEVED_NOTIFICATION"}},{key:"ACHIEVEMENT_CLAIM_REWARD_RESPONSE",get:function(){return"ACHIEVEMENT_CLAIM_REWARD_RESPONSE"}},{key:"FRIEND_REQUEST_LOAD_RESPONSE",get:function(){return"FRIEND_REQUEST_LOAD_RESPONSE"}},{key:"FRIEND_REQUEST_LOAD_REQUEST",get:function(){return"FRIEND_REQUEST_LOAD_REQUEST"}},{key:"USER_PROFILE_LOAD_REQUEST",get:function(){return"USER_PROFILE_LOAD_REQUEST"}},{key:"MAIN_MENU_LOAD_REQUEST",get:function(){return"MAIN_MENU_LOAD_REQUEST"}},{key:"QUEST_CLAIM_REWARD_REQUEST",get:function(){return"QUEST_CLAIM_REWARD_REQUEST"}},{key:"NEW_USER_SELECTED_GENRES_REQUEST",get:function(){return"NEW_USER_SELECTED_GENRES_REQUEST"}},{key:"NEW_USER_GENRES_LIST_REQUEST",get:function(){return"NEW_USER_GENRES_LIST_REQUEST"}},{key:"SOLO_MODE_PLAYLISTS_REQUEST",get:function(){return"SOLO_MODE_PLAYLISTS_REQUEST"}},{key:"BECHALLENGED_GAME_PLAY_HISTORY_REQUEST",get:function(){return"BECHALLENGED_GAME_PLAY_HISTORY_REQUEST"}},{key:"BECHALLENGED_GAME_OPPONENT_GAME_LOG_REQUEST",get:function(){return"BECHALLENGED_GAME_OPPONENT_GAME_LOG_REQUEST"}},{key:"SOLO_MODE_PLAYLIST_SELECTED_REQUEST",get:function(){return"SOLO_MODE_PLAYLIST_SELECTED_REQUEST"}},{key:"CHALLENGE_GAME_GET_PLAYLISTS_REQUEST",get:function(){return"CHALLENGE_GAME_GET_PLAYLISTS_REQUEST"}},{key:"CHALLENGE_GAME_FIND_OPPONENTS_REQUEST",get:function(){return"CHALLENGE_GAME_FIND_OPPONENTS_REQUEST"}},{key:"CHALLENGE_GAME_FINISH_REQUEST",get:function(){return"CHALLENGE_GAME_FINISH_REQUEST"}},{key:"BECHALLENGED_GAME_FINISH_REQUEST",get:function(){return"BECHALLENGED_GAME_FINISH_REQUEST"}},{key:"CHALLENGE_GAME_QUESTIONS_REQUEST",get:function(){return"CHALLENGE_GAME_QUESTIONS_REQUEST"}},{key:"SOLO_MODE_FINISH_REQUEST",get:function(){return"SOLO_MODE_FINISH_REQUEST"}},{key:"SOLO_MODE_GOT_REWARD_REQUEST",get:function(){return"SOLO_MODE_GOT_REWARD_REQUEST"}},{key:"SOLO_MODE_TOP10_THIS_WEEK_REQUEST",get:function(){return"SOLO_MODE_TOP10_THIS_WEEK_REQUEST"}},{key:"SOLO_MODE_TOP10_LAST_WEEK_REQUEST",get:function(){return"SOLO_MODE_TOP10_LAST_WEEK_REQUEST"}},{key:"SHOP_BUY_PLAYLIST_REQUEST",get:function(){return"SHOP_BUY_PLAYLIST_REQUEST"}},{key:"QUEST_LOAD_REQUEST",get:function(){return"QUEST_LOAD_REQUEST"}},{key:"ACHIEVEMENT_LOAD_REQUEST",get:function(){return"ACHIEVEMENT_LOAD_REQUEST"}},{key:"ACHIEVEMENT_CLAIM_REWARD_REQUEST",get:function(){return"ACHIEVEMENT_CLAIM_REWARD_REQUEST"}},{key:"USER_FRIEND_REQUEST",get:function(){return"USER_FRIEND_REQUEST"}},{key:"USER_FRIEND_RESPONSE",get:function(){return"USER_FRIEND_RESPONSE"}},{key:"FB_USER_SHARED_RESULT_REQUEST",get:function(){return"FB_USER_SHARED_RESULT_REQUEST"}},{key:"FB_USER_SHARED_RESULT_RESPONSE",get:function(){return"FB_USER_SHARED_RESULT_RESPONSE"}},{key:"USER_SHORT_PROFILE_LOAD_REQUEST",get:function(){return"USER_SHORT_PROFILE_LOAD_REQUEST"}},{key:"USER_SHORT_PROFILE_LOAD_RESPONSE",get:function(){return"USER_SHORT_PROFILE_LOAD_RESPONSE"}},{key:"SUPPORT_REQUEST",get:function(){return"SUPPORT_REQUEST"}},{key:"SUPPORT_RESPONSE",get:function(){return"SUPPORT_RESPONSE"}},{key:"DAILY_REWARD_NOTIFICATION",get:function(){return"DAILY_REWARD_NOTIFICATION"}},{key:"DAILY_REWARD_CLAIM_REQUEST",get:function(){return"DAILY_REWARD_CLAIM_REQUEST"}},{key:"DAILY_REWARD_CLAIM_RESPONSE",get:function(){return"DAILY_REWARD_CLAIM_RESPONSE"}},{key:"DAILY_QUEST_NOTIFICATION",get:function(){return"DAILY_QUEST_NOTIFICATION"}},{key:"DAILY_QUEST_LOAD_REQUEST",get:function(){return"DAILY_QUEST_LOAD_REQUEST"}},{key:"DAILY_QUEST_LOAD_RESPONSE",get:function(){return"DAILY_QUEST_LOAD_RESPONSE"}},{key:"HOURS_REWARD_CLAIM_REQUEST",get:function(){return"HOURS_REWARD_CLAIM_REQUEST"}},{key:"HOURS_REWARD_CLAIM_RESPONSE",get:function(){return"HOURS_REWARD_CLAIM_RESPONSE"}},{key:"POKE_USER_REQUEST",get:function(){return"POKE_USER_REQUEST"}},{key:"PLAY_SCRIPT_DONE_TURNBASE_REQUEST",get:function(){return"PLAY_SCRIPT_DONE_TURNBASE_REQUEST"}},{key:"PLAY_SCRIPT_DONE_TURNBASE_RESPONSE",get:function(){return"PLAY_SCRIPT_DONE_TURNBASE_RESPONSE"}},{key:"PLAY_SCRIPT_DONE_GET_QUEST_REQUEST",get:function(){return"PLAY_SCRIPT_DONE_GET_QUEST_REQUEST"}},{key:"PLAY_SCRIPT_DONE_GET_QUEST_RESPONSE",get:function(){return"PLAY_SCRIPT_DONE_GET_QUEST_RESPONSE"}},{key:"POKE_USER_RESPONSE",get:function(){return"POKE_USER_RESPONSE"}},{key:"PLAY_SCRIPT_DONE_ALL_REQUEST",get:function(){return"PLAY_SCRIPT_DONE_ALL_REQUEST"}},{key:"PLAY_SCRIPT_DONE_ALL_RESPONSE",get:function(){return"PLAY_SCRIPT_DONE_ALL_RESPONSE"}},{key:"SEARCH_USER_BY_ID_REQUEST",get:function(){return"SEARCH_USER_BY_ID_REQUEST"}},{key:"SEARCH_USER_BY_NAME_REQUEST",get:function(){return"SEARCH_USER_BY_NAME_REQUEST"}},{key:"SEARCH_USER_BY_ID_RESPONSE",get:function(){return"SEARCH_USER_BY_ID_RESPONSE"}},{key:"SEARCH_USER_BY_NAME_RESPONSE",get:function(){return"SEARCH_USER_BY_NAME_RESPONSE"}},{key:"GIFT_CODE_CLAIM_REQUEST",get:function(){return"GIFT_CODE_CLAIM_REQUEST"}},{key:"GIFT_CODE_CLAIM_RESPONSE",get:function(){return"GIFT_CODE_CLAIM_RESPONSE"}},{key:"TURNBASE_DELETE_GAME_REQUEST",get:function(){return"TURNBASE_DELETE_GAME_REQUEST"}},{key:"TURNBASE_DELETE_GAME_RESPONSE",get:function(){return"TURNBASE_DELETE_GAME_RESPONSE"}},{key:"ONLINE_ROOM_INVITATION",get:function(){return"ONLINE_ROOM_INVITATION"}},{key:"BROADCASH_NOTIFICATION",get:function(){return"BROADCASH_NOTIFICATION"}},{key:"USER_NOTIFICATION",get:function(){return"USER_NOTIFICATION"}},{key:"ONLINE_MODE_ROOM_FRIEND_LIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_FRIEND_LIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_FRIEND_LIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_FRIEND_LIST_RESPONSE"}},{key:"TURNBASE_CHALLENGE_REQUEST_UPDATE",get:function(){return"TURNBASE_CHALLENGE_REQUEST_UPDATE"}},{key:"MAIN_MENU_CHECK_UPDATE_REQUEST",get:function(){return"MAIN_MENU_CHECK_UPDATE_REQUEST"}},{key:"MAIN_MENU_CHECK_UPDATE_RESPONSE",get:function(){return"MAIN_MENU_CHECK_UPDATE_RESPONSE"}},{key:"INIT_SUGGESTION_OPPONENT_REQUEST",get:function(){return"INIT_SUGGESTION_OPPONENT_REQUEST"}},{key:"INIT_SUGGESTION_OPPONENT_RESPONSE",get:function(){return"INIT_SUGGESTION_OPPONENT_RESPONSE"}},{key:"TURNBASE_FIND_OPPONENT_REQUEST",get:function(){return"TURNBASE_FIND_OPPONENT_REQUEST"}},{key:"TURNBASE_FIND_OPPONENT_RESPONSE",get:function(){return"TURNBASE_FIND_OPPONENT_RESPONSE"}},{key:"INIT_CLIENT_GAME_DATA_REQUEST",get:function(){return"INIT_CLIENT_GAME_DATA_REQUEST"}},{key:"INIT_CLIENT_GAME_DATA_RESPONSE",get:function(){return"INIT_CLIENT_GAME_DATA_RESPONSE"}},{key:"QUEST_CHECK_ACHIEVED_REQUEST",get:function(){return"QUEST_CHECK_ACHIEVED_REQUEST"}},{key:"QUEST_CHECK_ACHIEVED_RESPONSE",get:function(){return"QUEST_CHECK_ACHIEVED_RESPONSE"}},{key:"QUEST_LOG_UPDATE",get:function(){return"QUEST_LOG_UPDATE"}},{key:"USER_FRIEND_LIST_LOAD_REQUEST",get:function(){return"USER_FRIEND_LIST_LOAD_REQUEST"}},{key:"USER_FRIEND_LIST_LOAD_RESPONSE",get:function(){return"USER_FRIEND_LIST_LOAD_RESPONSE"}},{key:"SOLO_MODE_QUESTION_REQUEST",get:function(){return"SOLO_MODE_QUESTION_REQUEST"}},{key:"SOLO_MODE_QUESTION_RESPONSE",get:function(){return"SOLO_MODE_QUESTION_RESPONSE"}},{key:"SOLO_MODE_NEXT_QUESTION_REQUEST",get:function(){return"SOLO_MODE_NEXT_QUESTION_REQUEST"}},{key:"SOLO_MODE_NEXT_QUESTION_RESPONSE",get:function(){return"SOLO_MODE_NEXT_QUESTION_RESPONSE"}},{key:"CHALLENGE_GAME_HISTORY_REQUEST",get:function(){return"CHALLENGE_GAME_HISTORY_REQUEST"}},{key:"CHALLENGE_GAME_HISTORY_RESPONSE",get:function(){return"CHALLENGE_GAME_HISTORY_RESPONSE"}},{key:"CHALLENGE_GAME_UPDATE_MESSAGE_REQUEST",get:function(){return"CHALLENGE_GAME_UPDATE_MESSAGE_REQUEST"}},{key:"CHALLENGE_GAME_UPDATE_MESSAGE_RESPONSE",get:function(){return"CHALLENGE_GAME_UPDATE_MESSAGE_RESPONSE"}},{key:"TURNBASE_LAST_WEEK_RESULT_REQUEST",get:function(){return"TURNBASE_LAST_WEEK_RESULT_REQUEST"}},{key:"TURNBASE_LAST_WEEK_RESULT_RESPONSE",get:function(){return"TURNBASE_LAST_WEEK_RESULT_RESPONSE"}}],(n=null)&&St(t.prototype,n),i&&St(t,i),e}();function Ct(e){return(Ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pt(e,t){return!t||"object"!==Ct(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ot(e){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rt(e,t){return(Rt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xt=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Pt(this,Ot(t).call(this,game,0,0,"otherSprites","tab-friend"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.signalClaim=new Phaser.Signal,e.type=n,e.event={claimReward:new Phaser.Signal,claimPlayScript:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rt(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward,this.btnClaim}},{key:"onStep6Claim",value:function(){this.event.claimReward.dispatch(this.quest,this.quest_log_id)}},{key:"addRequireAndReward",value:function(e,t){var n;this.quest=e,this.quest_log_id=t,en.instance().event.step6.add(this.onStep6Claim,this),this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.requireInit.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.requireInit.y*window.GameConfig.RESIZE,e.quest,this.positionQAndAConfig.scroll.requireInit.configs),this.required.anchor.set(0,.5),this.addChild(this.required),this.reward=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardInit.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardInit.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardInit.nameAtlas,this.positionQAndAConfig.scroll.btnRewardInit.nameSprite),"DIAMOND"==e.reward_type?n="Gem":"TICKET"==e.reward_type?n="Ticket":"SUPPORT_ITEM"==e.reward_type&&(n="Mic");var i=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardInit.diamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardInit.diamond.y*window.GameConfig.RESIZE,"questAndAchieveSprites",n);this.reward.addChild(i);var o=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnRewardInit.txtDiamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardInit.txtDiamond.y*window.GameConfig.RESIZE,e.reward,this.positionQAndAConfig.scroll.btnRewardInit.txtDiamond.configs);this.reward.addChild(o),this.addChild(this.reward),this.reward.inputEnabled=!0,this.btnClaim=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnClaimReward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnClaimReward.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnClaimReward.nameAtlas,this.positionQAndAConfig.scroll.btnClaimReward.nameSprite),this.btnClaim.inputEnabled=!0,this.btnClaim.idQuest=t;var a=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnClaimReward.txt.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnClaimReward.txt.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnClaimReward.txt.text,this.positionQAndAConfig.scroll.btnClaimReward.txt.configs);this.btnClaim.addChild(a),this.addChild(this.btnClaim),this.btnClaim.events.onInputUp.add(this.onClaim,this);var s=new rt(this.positionQAndAConfig.line_under);this.addChild(s)}},{key:"onClaim",value:function(){ce.instance().playSound(ce.buttonclick),this.btnClaim.inputEnabled=!1,0==this.type?this.event.claimReward.dispatch(this.quest,this.btnClaim.idQuest):this.event.claimPlayScript.dispatch()}},{key:"onReceiveReward",value:function(){en.instance().event.step6.remove(this.onStep6Claim,this),this.reward.destroy(),this.loadTexture("otherSprites","tab-friend");var e=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.doneIcon.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.doneIcon.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.doneIcon.nameAtlas,this.positionQAndAConfig.scroll.doneIcon.nameSprite);e.anchor.set(1,0),this.addChild(e)}}])&&kt(n.prototype,i),o&&kt(n,o),t}();function Tt(e){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function It(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function At(e,t){return!t||"object"!==Tt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lt(e,t,n){return(Lt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gt(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Gt(e){return(Gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dt(e,t){return(Dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mt=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=At(this,Gt(t).call(this,game,0,0,null,null))).mainData=z.instance(),e.afterCreate(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dt(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterCreate",value:function(){}},{key:"formatName",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.length>t){var i=e.substring(0,t);return!1===n?i:i.trim()+"..."}return e}},{key:"swap",value:function(e,t,n){var i=e[n];e[n]=e[t],e[t]=i}},{key:"financial",value:function(e){return Number.parseFloat(e).toFixed(1)}},{key:"compare",value:function(e,t){return e.score<t.score?1:e.score>t.score?-1:0}},{key:"compareOwner",value:function(e,t){return e.is_owner<t.is_owner?1:e.is_owner>t.is_owner?-1:0}},{key:"compareUserPlaylistMappingUpdate",value:function(e,t){if(e.hasOwnProperty("user")&&t.hasOwnProperty("user"))return e.user.updated<t.user.updated?1:e.user.updated>t.user.updated?-1:0}},{key:"sortAZ",value:function(e,t){var n=e.name.toUpperCase(),i=t.name.toUpperCase();return n<i?-1:n>i?1:0}},{key:"sortNewPlayList",value:function(e,t){var n=e.created,i=t.created;return n<i?1:n>i?-1:0}},{key:"sortPhoBien",value:function(e,t){var n=e.purchased_count,i=t.purchased_count;return n<i?1:n>i?-1:0}},{key:"getTime",value:function(){return(new Date).getTime()}},{key:"xoa_dau",value:function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a")).replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e")).replace(/ì|í|ị|ỉ|ĩ/g,"i")).replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o")).replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u")).replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y")).replace(/đ/g,"d")).replace(/À|Á|Ạ|Ả|Ã|Â|Ầ|Ấ|Ậ|Ẩ|Ẫ|Ă|Ằ|Ắ|Ặ|Ẳ|Ẵ/g,"A")).replace(/È|É|Ẹ|Ẻ|Ẽ|Ê|Ề|Ế|Ệ|Ể|Ễ/g,"E")).replace(/Ì|Í|Ị|Ỉ|Ĩ/g,"I")).replace(/Ò|Ó|Ọ|Ỏ|Õ|Ô|Ồ|Ố|Ộ|Ổ|Ỗ|Ơ|Ờ|Ớ|Ợ|Ở|Ỡ/g,"O")).replace(/Ù|Ú|Ụ|Ủ|Ũ|Ư|Ừ|Ứ|Ự|Ử|Ữ/g,"U")).replace(/Ỳ|Ý|Ỵ|Ỷ|Ỹ/g,"Y")).replace(/Đ/g,"D")}},{key:"tweenItemPopup",value:function(e,t){game.add.tween(e).to({y:t},400,Phaser.Easing.Exponential.In,!0)}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){}},{key:"destroy",value:function(){this.removeEvent(),this.removeAllItem(),Lt(Gt(t.prototype),"destroy",this).call(this)}},{key:"removeAllItem",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&It(n.prototype,i),o&&It(n,o),t}();function Nt(e){return(Nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jt(e,t){return!t||"object"!==Nt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ut(e){return(Ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ft(e,t){return(Ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Zt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=jt(this,Ut(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,null)),game.cache.addNinePatch(e.name,e.nameAtlas,e.nameSprite,e.left*z.instance().scale,e.right*z.instance().scale,e.top*z.instance().scale,e.bot*z.instance().scale),n.bg=new Phaser.NinePatchImage(game,0,0,e.name),n.bg.targetWidth=e.width*z.instance().scale,n.bg.targetHeight=e.height*z.instance().scale,n.bg.UpdateImageSizes(),n.addChild(n.bg),n.addChild(n.bg),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ft(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"tint",set:function(e){if(this.bg)for(var t=0;t<this.bg.children.length;t++)this.bg.children[t].tint=e}},{key:"alpha",set:function(e){if(this.bg)for(var t=0;t<this.bg.children.length;t++)this.bg.children[t].alpha=e}},{key:"width",get:function(){return this.bg.targetWidth},set:function(e){this.bg.targetWidth=e,this.bg.UpdateImageSizes()}},{key:"height",get:function(){return this.bg.targetHeight},set:function(e){this.bg.targetHeight=e,this.bg.UpdateImageSizes()}}])&&Bt(n.prototype,i),o&&Bt(n,o),t}();function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Vt(e,t){return!t||"object"!==Ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wt(e){return(Wt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qt(e,t){return(qt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Kt=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Vt(this,Wt(t).call(this,game,0,0,null))).positionRanking=n.mainData.positionPopup,n.bg=new Zt(n.positionRanking.ranking_bg_help),n.addChild(n.bg),n.txtContent=new _t(n.positionRanking.ranking_text_help,e),n.txtContent.x=35*z.instance().scale,n.addChild(n.txtContent),n.bg.width=n.txtContent.x+n.txtContent.width+24*z.instance().scale,n.bg.height=n.txtContent.y+n.txtContent.height+25*z.instance().scale,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qt(e,t)}(t,Mt),n=t,(i=[{key:"setWidthHeight",value:function(){this.bg.width=this.txtContent.x+this.txtContent.width+24*z.instance().scale,this.bg.height=this.txtContent.y+this.txtContent.height+25*z.instance().scale}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&Qt(n.prototype,i),o&&Qt(n,o),t}();function zt(e){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jt(e,t){return!t||"object"!==zt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xt(e){return(Xt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $t(e,t){return($t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var en=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Jt(this,Xt(t).call(this,game))).playScript=JSON.parse(game.cache.getText("playScript")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.type=n,e.event={step1:new Phaser.Signal,step2:new Phaser.Signal,step3:new Phaser.Signal,step4:new Phaser.Signal,step5:new Phaser.Signal,step6:new Phaser.Signal,step7:new Phaser.Signal,step8:new Phaser.Signal},e.stepVal=0,e.indexOfAnswer=5,e.bg,e.button,e.hand,e.arrTutorial=["Bạn hãy lắng nghe và chọn đáp án đúng!","Wow! Trả lời đúng càng nhanh, điểm càng cao!","Hãy lắng nghe và khám phá ngay những giai điệu gây nghiện nào!","Mic là vật phẩm trợ giúp 50:50 cực kỳ đắc lực cho bạn","Oh Yeah! Chúc mừng bạn. Nhận thưởng và chơi ngay thôi nào.","Hệ thống nhiệm vụ Wazzat vô cùng hấp dẫn. Thực hiện ngay nhận quà liền tay!","Bạn có 1 lời mời thách đấu từ người chơi khác. Chơi ngay nào!","Tuyệt vời! Bây giờ là lúc bạn thể hiện trình độ âm nhạc của mình!"],e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$t(e,t)}(t,Phaser.Group),n=t,o=[{key:"instance",value:function(){return this.playScriptScreen||(this.playScriptScreen=new t),this.playScriptScreen}},{key:"STEP1",get:function(){return"step1"}},{key:"STEP2",get:function(){return"step2"}},{key:"STEP3",get:function(){return"step3"}},{key:"STEP4",get:function(){return"step8"}},{key:"STEP5",get:function(){return"step5"}},{key:"STEP6",get:function(){return"step6"}},{key:"STEP7",get:function(){return"step7"}},{key:"STEP8",get:function(){return"step4"}},{key:"STEP9",get:function(){return"step9"}},{key:"INIT",get:function(){return"INIT"}},{key:"DONE_TURNBASE",get:function(){return"DONE_TURNBASE"}},{key:"DONE_GET_QUEST",get:function(){return"DONE_GET_QUEST"}},{key:"DONE_ALL",get:function(){return"DONE_ALL"}}],(i=[{key:"afterInit",value:function(){this.bg=new Phaser.Sprite(game,0,0,"BG_Opacity"),this.addChild(this.bg),this.addButtonSkip(),this.addEventExtension()}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.PLAY_SCRIPT_DONE_GET_QUEST_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.destroy()}},{key:"addButtonSkip",value:function(){this.btnSkip=new pt(this.playScript.play_script_btn_skip,this.onSkipPS,this),this.btnSkip.y=game.height-z.instance().STANDARD_HEIGHT+this.playScript.play_script_btn_skip.y,this.btnSkip.anchor.set(.5);var e=new _t(this.playScript.play_script_btn_skip.text,this.playScript.play_script_btn_skip.text.text);e.anchor.set(.5),this.btnSkip.addChild(e),this.btnSkip.kill(),this.addChild(this.btnSkip)}},{key:"onSkipPS",value:function(){Le.instance().logEvent(Le.Screen_Play_Script_Skip+"_"+this.stepVal),ce.instance().playSound(ce.buttonclick),TF.instance().sendData(Et.PLAY_SCRIPT_DONE_ALL_REQUEST,null)}},{key:"addHand",value:function(e,t){this.hand=new Phaser.Sprite(game,e,t,this.playScript.play_script_hand.nameAtlas,this.playScript.play_script_hand.nameSprite),game.add.tween(this.hand).to({y:"+30"},200,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(this.hand)}},{key:"addHelperStep1",value:function(){var e=new Kt(this.arrTutorial[0]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=60,this.addChild(e),this.btnSkip.revive()}},{key:"addStep1ChooseAnswerQuest1",value:function(e,n){Le.instance().logEvent(Le.Screen_Play_Script+"_step1"),this.indexOfAnswer=5;var i=e.correctAnswer;this.indexOfAnswer=i-1;var o=e.answers[i-1];this.stepVal=t.STEP1,this.bg.loadTexture("BG_Opacity"),this.countQuiz=n;var a=new pt({x:0,y:0,nameAtlas:"playSprites",nameSprite:"Tab_Dapan_01"},this.onClickTab,this);a.anchor.set(.5),a.position.x=320,a.position.y=1==i?game.height-576:2==i?game.height-576+122:3==i?game.height-576+244:game.height-576+366;var s=new _t({x:0,y:0,text:"",style:{font:"GilroyMedium",fill:"black",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:400}},o);s.anchor.set(.5),a.addChild(s),game.add.tween(a.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(a),this.addHand(a.x+150,a.y)}},{key:"addHelperStep2",value:function(){var e=new Kt(this.arrTutorial[1]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=90,this.addChild(e),this.btnSkip.revive()}},{key:"addStep2ChooseAnswerQuest2",value:function(e,n){Le.instance().logEvent(Le.Screen_Play_Script+"_step2"),this.indexOfAnswer=5;var i=e.correctAnswer;this.indexOfAnswer=i-1;var o=e.answers[i-1];this.stepVal=t.STEP2,this.bg.loadTexture("BG_Opacity"),this.countQuiz=n;var a=new pt({x:0,y:0,nameAtlas:"playSprites",nameSprite:"Tab_Dapan_01"},this.onClickTab,this);a.anchor.set(.5),a.position.x=320,a.position.y=1==i?game.height-576:2==i?game.height-576+122:3==i?game.height-576+244:game.height-576+366;var s=new _t({x:0,y:0,text:"",style:{font:"GilroyMedium",fill:"black",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:400}},o);s.anchor.set(.5),a.addChild(s),game.add.tween(a.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(a),this.addHand(a.x+150,a.y)}},{key:"addHelperStep3",value:function(){var e=new Kt(this.arrTutorial[2]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=90,this.addChild(e),this.btnSkip.revive()}},{key:"addStep3ChooseAnswerQuest3",value:function(e,n){Le.instance().logEvent(Le.Screen_Play_Script+"_step3"),this.indexOfAnswer=5;var i=e.correctAnswer;this.indexOfAnswer=i-1;var o=e.answers[i-1];this.stepVal=t.STEP3,this.bg.loadTexture("BG_Opacity"),this.countQuiz=n;var a=new pt({x:0,y:0,nameAtlas:"playSprites",nameSprite:"Tab_Dapan_01"},this.onClickTab,this);a.anchor.set(.5),a.position.x=320,a.position.y=1==i?game.height-576:2==i?game.height-576+122:3==i?game.height-576+244:game.height-576+366;var s=new _t({x:0,y:0,text:"",style:{font:"GilroyMedium",fill:"black",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:400}},o);s.anchor.set(.5),a.addChild(s),game.add.tween(a.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(a),this.addHand(a.x+150,a.y)}},{key:"addHelperStep4",value:function(){var e=new Kt(this.arrTutorial[3]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=650,this.addChild(e)}},{key:"addStep4UseSupportItem",value:function(){Le.instance().logEvent(Le.Screen_Play_Script+"_step8"),this.stepVal=t.STEP4,this.bg.loadTexture("BG_Opacity_100"),this.btn_remove_answer=new Phaser.Button(game,this.positionPlayConfig.btn_remove_answer.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.btn_remove_answer.y)*window.GameConfig.RESIZE,this.positionPlayConfig.btn_remove_answer.nameAtlas,function(){},this,null,this.positionPlayConfig.btn_remove_answer.nameSprite),this.btn_remove_answer.anchor.set(.5);var e=new Phaser.Text(game,this.positionPlayConfig.txt_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.text,this.positionPlayConfig.txt_remove_answer.configs);e.anchor.set(.5);var n=new _t(this.positionPlayConfig.txt_dis_one,this.positionPlayConfig.txt_dis_one.text);n.anchor.set(.5),this.btn_remove_answer.addChild(n);var i=new Phaser.Sprite(game,this.positionPlayConfig.diamond_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.nameAtlas,this.positionPlayConfig.diamond_remove_answer.nameSprite);i.anchor.set(1,.5);var o=new rt(this.positionPlayConfig.mic_so_luong);o.anchor.set(.5),this.countMic=TF.instance().socket.mySelf.getVariable("support_item").value,this.numberOfSptItem=new _t(this.positionPlayConfig.number_mic_so_luong,TF.instance().socket.mySelf.getVariable("support_item").value),this.numberOfSptItem.anchor.set(.5),o.addChild(this.numberOfSptItem),this.btn_remove_answer.addChild(o),this.btn_remove_answer.addChild(i),this.btn_remove_answer.addChild(e),this.btn_remove_answer.events.onInputUp.add(this.inputBtnRemoveAnswer,this),this.addChild(this.btn_remove_answer),game.add.tween(this.btn_remove_answer.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addBtnYellow()}},{key:"inputBtnRemoveAnswer",value:function(){ce.instance().playSound(ce.buttonclick),this.event.step4.dispatch(),this.destroy()}},{key:"addStep5ReceiveFirstReward",value:function(){var e=this;Le.instance().logEvent(Le.Screen_Play_Script+"_step4"),this.btnSkip.revive(),this.stepVal=t.STEP5,this.bg.loadTexture("BG_Opacity");var n=new Kt(this.arrTutorial[4]);n.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),n.setWidthHeight(),n.position.x=(game.width-n.width)/2,n.position.y=90,this.addChild(n),this.btnClaim=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,(game.height-481)*window.GameConfig.RESIZE,"questAndAchieveSprites","Button_Nhan_popup"),this.btnClaim.anchor.set(.5,0);var i=new Phaser.Text(game,0,24*window.GameConfig.RESIZE,"NHẬN",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:30});i.anchor.set(.5,0),this.btnClaim.addChild(i),this.btnClaim.inputEnabled=!0,this.btnClaim.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),e.onClickTab()},this),this.addChild(this.btnClaim),this.addHand(this.btnClaim.x+50,this.btnClaim.y+40)}},{key:"claimReward",value:function(){}},{key:"addStep6BtnReceiveInQAndA",value:function(){Le.instance().logEvent(Le.Screen_Play_Script+"_step5"),this.btnSkip.revive(),this.stepVal=t.STEP6}},{key:"onClaim",value:function(){this.quest.destroy(),this.hand.destroy(),t.instance().event.step6.dispatch()}},{key:"addStep7CloseQAndA",value:function(){Le.instance().logEvent(Le.Screen_Play_Script+"_step6"),this.btnSkip.revive(),this.stepVal=t.STEP7,this.bg.loadTexture("BG_Opacity"),this.btnBack=new Phaser.Sprite(game,this.playScript.btn_back.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.playScript.btn_back.y)*window.GameConfig.RESIZE,this.playScript.btn_back.nameAtlas,this.playScript.btn_back.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.addChild(this.btnBack),this.addHand(this.btnBack.x-25,this.btnBack.y)}},{key:"onBack",value:function(){this.onClickTab()}},{key:"addStep8AcceptChallenge",value:function(){Le.instance().logEvent(Le.Screen_Play_Script+"_step7"),this.btnSkip.revive(),this.stepVal=t.STEP8,this.bg.loadTexture("BG_Opacity");var e=new Kt(this.arrTutorial[6]);e.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),e.setWidthHeight(),e.position.x=(game.width-e.width)/2,e.position.y=90,this.addChild(e),this.btnAccept=new Phaser.Button(game,this.playScript.btn_accept.x*window.GameConfig.RESIZE,this.playScript.btn_accept.y*window.GameConfig.RESIZE,"otherSprites",this.onAccept,this,null,"btnFirstGame"),this.btnAccept.anchor.set(.5),this.addChild(this.btnAccept),game.add.tween(this.btnAccept.scale).to({x:1.1,y:1.1},300,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addHand(this.btnAccept.x,this.btnAccept.y)}},{key:"addBtnYellow",value:function(){var e=new Phaser.Sprite(game,this.playScript.btn_yellow.x,this.playScript.btn_yellow.y,this.playScript.btn_yellow.nameAtlas,this.playScript.btn_yellow.nameSprite);e.anchor.set(.5),game.add.tween(e).to({y:"+30"},500,Phaser.Easing.Linear.None,!0,0,1,!0).loop(!0).start(),this.addChild(e)}},{key:"onAccept",value:function(){this.onClickTab()}},{key:"addStep9GoodLuck",value:function(){var e=this;Le.instance().logEvent(Le.Screen_Play_Script+"_step9"),this.stepVal=t.STEP9,this.bg.destroy();var n=new Kt(this.arrTutorial[7]);n.txtContent.changeStyle({font:"Gilroy",fill:"#333333",fontSize:28,wordWrap:!0,wordWrapWidth:500,align:"center"}),n.setWidthHeight(),n.position.x=(game.width-n.width)/2,n.position.y=90,this.addChild(n),this.tweenDestroy9=game.time.events.add(3*Phaser.Timer.SECOND,function(){var t=game.add.tween(n).to({y:-500},2e3,Phaser.Easing.Back.InOut,!0);t.start(),t.onComplete.add(function(){e.destroy()},e)})}},{key:"onClickTab",value:function(){this.stepVal==t.STEP1&&this.event.step1.dispatch(this.indexOfAnswer),this.stepVal==t.STEP2&&this.event.step2.dispatch(this.indexOfAnswer),this.stepVal==t.STEP3&&this.event.step3.dispatch(this.indexOfAnswer),this.stepVal==t.STEP4&&this.event.step4.dispatch(),this.stepVal==t.STEP5&&(this.event.step5.dispatch(),t.instance().event.step5.dispatch()),this.stepVal==t.STEP6&&t.instance().event.step6.dispatch(),this.stepVal==t.STEP7&&(this.event.step7.dispatch(),t.instance().event.step7.dispatch()),this.stepVal==t.STEP8&&(this.event.step8.dispatch(),t.instance().event.step8.dispatch()),this.destroy()}},{key:"changeBg",value:function(){this.bg.loadTexture("BG_Opacity_100")}},{key:"removeAllTut",value:function(){this.bg.destroy(),this.btnSkip.destroy()}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.tweenDestroy9);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Yt(n.prototype,i),o&&Yt(n,o),t}();function tn(e){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function on(e,t){return!t||"object"!==tn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function an(e,t,n){return(an="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sn(e){return(sn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rn(e,t){return(rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ln=function(e){function t(e,n,i,o){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=on(this,sn(t).call(this,e,i,o))).objConfig=e,a.icon=null,e.icon&&(a.icon=new rt(e.icon),e.icon.width&&(a.icon.width=e.icon.width*z.instance().scale),e.icon.height&&(a.icon.height=e.icon.height*z.instance().scale),a.addChild(a.icon)),a.lbBtn=new _t(e.configText,n);var s=0,r=0,l=0,h=0,c=0,u=0;return e.configText.hasOwnProperty("paddingLeft")&&(l=e.configText.paddingLeft*z.instance().scale),e.configText.hasOwnProperty("paddingRight")&&(h=e.configText.paddingRight*z.instance().scale),e.configText.hasOwnProperty("paddingTop")&&(c=e.configText.paddingTop*z.instance().scale),e.configText.hasOwnProperty("paddingBot")&&(u=e.configText.paddingBot*z.instance().scale),null==a.icon?(s=a.objConfig.configText.width?a.objConfig.configText.width*z.instance().scale-h-l:a.width-h-l,r=a.objConfig.configText.height?a.objConfig.configText.height*z.instance().scale-c-u:a.height-c-u,a.lbBtn.setTextBounds(0,0,s,r),a.lbBtn.x=h>0?a.width-h-s:l>0?l:(a.width-s)/2,a.lbBtn.y=c>0?c:u>0?a.height-u:(a.height-r)/2):(s=a.objConfig.configText.width?a.objConfig.configText.width*z.instance().scale-h-l:"right"==a.objConfig.icon.align?a.width-a.icon.x-6*z.instance().scale-h-l:a.width-a.icon.x-a.icon.width-6*z.instance().scale-h-l,r=a.objConfig.configText.height?a.objConfig.configText.height*z.instance().scale-c-u:a.height-c-u,e.hasOwnProperty("alignAll")?a.setKCTextCenter():(a.lbBtn.setTextBounds(0,0,s,r),"right"==a.objConfig.icon.align?a.lbBtn.x=h>0?a.width-h:l>0?l:a.icon.x-s-6*z.instance().scale:a.lbBtn.x=h>0?a.width-h:l>0?l:a.icon.x+a.icon.width+6*z.instance().scale,a.lbBtn.y=c>0?c:u>0?a.height-u:(a.height-r)/2)),a.addChild(a.lbBtn),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rn(e,t)}(t,pt),n=t,(i=[{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),an(sn(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"setKCTextCenter",value:function(){var e=0,t=0;this.objConfig.configText.hasOwnProperty("paddingTop")&&(e=this.objConfig.configText.paddingTop),this.objConfig.configText.hasOwnProperty("paddingBot")&&(t=this.objConfig.configText.paddingBot);var n=6*z.instance().scale;this.objConfig.hasOwnProperty("kc")&&(n=this.objConfig.hasOwnProperty("kc")),"right"==this.objConfig.icon.align?(this.lbBtn.x=(this.width-(this.lbBtn.width+n+this.icon.width))/2,this.icon.x=this.lbBtn.x+this.lbBtn.width+n):(this.icon.x=(this.width-(this.lbBtn.width+n+this.icon.width))/2,this.lbBtn.x=this.icon.x+this.icon.width+n),this.lbBtn.y=e>0?e:t>0?this.height-t:(this.height-this.lbBtn.height)/2}},{key:"setText",value:function(e){this.lbBtn.text=e,this.objConfig.hasOwnProperty("alignAll")&&this.setKCTextCenter()}}])&&nn(n.prototype,i),o&&nn(n,o),t}();function hn(e){return(hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function un(e,t,n){return(un="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dn(e){return(dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gn=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=dn(t).call(this,game,0,0,null))||"object"!==hn(i)&&"function"!=typeof i?pn(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.topBg=new rt(e.positionPopup.popup_confirm_top_bg),e.addChild(e.topBg),e.bgText=new Zt(e.positionPopup.popup_confirm_bg_text),e.addChild(e.bgText),e.btnOk=new ln(e.positionPopup.popup_confirm_button_ok_full,"ĐỒNG Ý",e.chooseOK,pn(pn(e))),e.addChild(e.btnOk),e.txtContent=new _t(e.positionPopup.popup_confirm_text_content,o),e.txtContent.setTextBounds(0,0,545*e.mainData.scale,278*e.mainData.scale),e.addChild(e.txtContent),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(t,Mt),n=t,(i=[{key:"setHeight",value:function(e){this.bgText.height=e,this.txtContent.setTextBounds(0,0,545*this.mainData.scale,this.bgText.height-168*this.mainData.scale),this.btnOk.y=this.bgText.targetHeight-103*this.mainData.scale}},{key:"chooseOK",value:function(){LogConsole.log("chooseOK"),this.event.OK.dispatch()}},{key:"setTextButton",value:function(e){this.btnOk.setText(e)}},{key:"setContent",value:function(e){this.txtContent.setText(e)}},{key:"destroy",value:function(){this.topBg.destroy(),this.bgText.destroy(),this.txtContent.destroy(),this.btnOk.destroy(),un(dn(t.prototype),"destroy",this).call(this)}}])&&cn(n.prototype,i),o&&cn(n,o),t}();function yn(e){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vn(e){return(vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wn(e,t){return(wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var _n=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=vn(t).call(this,game,0,0,null))||"object"!==yn(i)&&"function"!=typeof i?bn(n):i).url=a,e.event={OK:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.popup=new gn(o),e.popup.x=35*z.instance().scale,e.popup.y=325*z.instance().scale,e.addChild(e.popup),e.popup.event.OK.add(e.chooseOk,bn(bn(e))),e.popup.y=game.height+237*z.instance().scale,e.tweenItemPopup(e.popup,game.height-900*z.instance().scale),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wn(e,t)}(t,Mt),n=t,(i=[{key:"setContentButton",value:function(e){this.popup.setTextButton(e)}},{key:"setContent",value:function(e){this.popup.setContent(e)}},{key:"chooseOk",value:function(){""!==this.url&&("maintaince"==this.url?rF.instance().changeScreen(Ce.LOGIN):window.open(this.url)),De.instance().event.clickOKDialog.dispatch(),this.event.OK.dispatch()}}])&&mn(n.prototype,i),o&&mn(n,o),t}();function Sn(e){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function En(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cn(e,t){return!t||"object"!==Sn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kn(e,t,n){return(kn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pn(e){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function On(e,t){return(On=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Cn(this,Pn(t).call(this,game,0,0,"screen-dim2"))).avaUrl=n,e.event={back:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&On(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.bgBtn,this.avatar,this.addBgBtn(),this.addAva(),this.loadAva()}},{key:"addBgBtn",value:function(){this.bgBtn=new Phaser.Button(game,0,0,"screen-dim2"),this.bgBtn.width=game.width,this.bgBtn.height=game.height,this.bgBtn.events.onInputUp.add(this.onClickBg,this),this.addChild(this.bgBtn)}},{key:"onClickBg",value:function(){this.event.back.dispatch(),this.destroy()}},{key:"addAva",value:function(){this.avatar=new Phaser.Button(game,320,400,"otherSprites",function(){},this,null,"ava-default"),this.avatar.anchor.set(.5),this.addChild(this.avatar)}},{key:"loadAva",value:function(){if(null!==this.avaUrl)if(this.key=this.avaUrl,game.cache.checkImageKey(this.key))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadComplete.add(this.onLoad,this),e.image(this.key,this.key),e.start()}}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onClickBg,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onClickBg,this)}},{key:"onLoad",value:function(){game.cache.checkImageKey(this.key)&&void 0!==this&&(this.avatar.loadTexture(this.key),this.avatar.width=300,this.avatar.height=300)}},{key:"destroy",value:function(){this.removeEventExtension(),kn(Pn(t.prototype),"destroy",this).call(this)}}])&&En(n.prototype,i),o&&En(n,o),t}();function xn(e){return(xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function In(e,t){return!t||"object"!==xn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function An(e){return(An=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ln(e,t){return(Ln=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gn=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=In(this,An(t).call(this,game))).disconnect=null,e.playScript=null,e.dialog=null,e.bigAva=null,e.plsWait=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ln(e,t)}(t,Phaser.Group),n=t,o=[{key:"instance",value:function(){return this.controllDialog||(this.controllDialog=new t),this.controllDialog}}],(i=[{key:"addPopupDisconnect",value:function(){this.removePopupDisconnect(),this.disconnect=new tt,this.addChild(this.disconnect)}},{key:"removePopupDisconnect",value:function(){null!==this.disconnect&&(this.removeChild(this.disconnect),this.disconnect.destroy(),this.disconnect=null)}},{key:"addPlayScript",value:function(){this.removePlayScript(),this.playScript=new en,this.addChild(this.playScript)}},{key:"removePlayScript",value:function(){null!==this.playScript&&(this.removeChild(this.playScript),this.playScript.destroy(),this.playScript=null)}},{key:"addDialog",value:function(e){this.removeDialog(),this.dialog=new _n(e),this.dialog.event.OK.add(this.removeDialog,this),this.addChild(this.dialog)}},{key:"removeDialog",value:function(){null!==this.dialog&&(this.removeChild(this.dialog),this.dialog.destroy(),this.dialog=null)}},{key:"addBigAva",value:function(e){this.removeBigAva(),this.bigAva=new Rn(e),this.addChild(this.bigAva)}},{key:"removeBigAva",value:function(){null!==this.bigAva&&(this.removeChild(this.bigAva),this.bigAva.destroy(),this.bigAva=null)}},{key:"addPlsWait",value:function(){this.removePlsWait(),this.plsWait=new Phaser.Text(game,game.width/2,game.height/2,"Bạn vui lòng chờ một chút\nđể làm mới lại lần tiếp theo  ...",{font:"GilroyMedium",fill:"#ffffff",fontSize:19,align:"center"}),this.plsWait.anchor.set(.5),game.add.tween(this.plsWait).to({alpha:0},1500,"Linear",!0).start(),this.addChild(this.plsWait)}},{key:"removePlsWait",value:function(){null!==this.plsWait&&(this.removeChild(this.plsWait),this.plsWait.destroy(),this.plsWait=null)}},{key:"removeAllItem",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&Tn(n.prototype,i),o&&Tn(n,o),t}();function Dn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Mn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"weekly_result",get:function(){return"weekly_result"}},{key:"user_won",get:function(){return"user_won"}},{key:"opponent_won",get:function(){return"opponent_won"}},{key:"status",get:function(){return"status"}},{key:"turn_count",get:function(){return"turn_count"}},{key:"is_online",get:function(){return"is_online"}},{key:"can_be_poked",get:function(){return"can_be_poked"}},{key:"poked",get:function(){return"poked"}},{key:"poked_at",get:function(){return"poked_at"}},{key:"updated",get:function(){return"updated"}},{key:"challenge_request_id",get:function(){return"challenge_request_id"}},{key:"challenge_msg",get:function(){return"challenge_msg"}}],(n=null)&&Dn(t.prototype,n),i&&Dn(t,i),e}();function Nn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Bn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"switchButton",value:function(e,t,n,i){for(var o=0;o<t.length;o++)t[o].kill();for(var a=0;a<e.length;a++)e[a].revive();n.kill(),i.revive()}},{key:"show",value:function(e){game.add.tween(e).to({x:0},100,"Linear",!0)}},{key:"hide",value:function(e){game.add.tween(e).to({x:game.width},100,"Linear",!0)}},{key:"handleArrsGames",value:function(e,t,n){if(e.size()>0)for(var i=0;i<e.size();i++){var o=e.getSFSObject(i),a=o.getSFSObject("opponent_entity"),s=a.getUtfString("user_name"),r=a.getUtfString("avatar"),l=a.getInt("experience_score"),h=a.getInt("id"),c=o.getInt("turn_count"),u=o.getSFSObject("weekly_result"),d=u.getInt("user_won"),f=u.getInt("opponent_won"),p=o.getLong("user_play_log"),g=o.getLong("id");t.push({opponentEntity:{userName:s,avatar:r,experienceScore:l,id:h},turnCount:c,weeklyResult:{userWon:d,opponentWon:f},id:g,userGameLog:p,mode:n})}}},{key:"handleArrMainMenuLoad",value:function(t,n,i){if(t.size()>0)for(var o=0;o<t.size();o++){var a=t.getSFSObject(o),s=a.getInt(Mn.user_id),r=a.getUtfString(Mn.user_name),l=a.getUtfString(Mn.avatar),h=a.getSFSObject(Mn.weekly_result),c=h.getInt(Mn.user_won),u=h.getInt(Mn.opponent_won),d=a.getUtfString(Mn.status),f=a.getLong(Mn.updated),p=e.formatChallengeGameUpdated(f),g=a.getUtfString(Mn.challenge_msg),y=null,m=0,v=0;"THEIR_TURN"==d?a.containsKey(Mn.can_be_poked)&&(y=a.getInt(Mn.can_be_poked)):"YOUR_TURN"==d&&a.containsKey(Mn.poked)&&(m=a.getInt(Mn.poked),v=a.getLong(Mn.poked_at));var w=a.getInt(Mn.turn_count),b=a.getBool(Mn.is_online),_=a.getLong(Mn.challenge_request_id);n.push({opponentEntity:{id:s,userName:r,avatar:l,is_online:b},weeklyResult:{userWon:c,opponentWon:u},turnCount:w,status:d,can_be_poked:y,poked:m,poked_at:v,updated:p,base_updated:f,challenge_request_id:_,challenge_msg:g})}i()}},{key:"handleCheckUpdateMainMenu",value:function(e,t){var n=e.getInt("init_quests_count"),i=e.getLong("new_friend_request_count"),o=e.getLong("started_event_count"),a={playing_guide:"",play_script_questions:[]};if(e.containsKey("play_script")){var s=e.getSFSObject("play_script");s.containsKey("playing_guide")&&(a.playing_guide=s.getUtfString("playing_guide"))}a.playing_guide==en.DONE_GET_QUEST&&(z.instance().botChallenge={value:0,gameLogId:z.instance().menuLoadResponses.challengeGames[0].userGameLog,requestId:z.instance().menuLoadResponses.challengeGames[0].id,opponentEntity:z.instance().menuLoadResponses.challengeGames[0].opponentEntity,mode:"isChallengeGame",can_be_poked:z.instance().menuLoadResponses.challengeGames[0].can_be_poked,weeklyResult:{userWon:0,opponentWon:0}});var r=e.getSFSObject("hours_reward");t(n,i,o,{hours_reward_id:r.getInt("hours_reward_id"),user_id:r.getInt("user_id"),created:r.getLong("created"),state:r.getUtfString("state"),updated:r.getLong("updated")},a)}},{key:"getGender",value:function(e){return"UNKNOWN"==e.gender?"MALE":"FEMALE"}},{key:"getTwoOfFourAnswer",value:function(e,t,n,i,o){LogConsole.log(o);var a=[],s=[];1==o.correctAnswer?(a.push(e),s.push(t),s.push(n),s.push(i)):2==o.correctAnswer?(a.push(t),s.push(e),s.push(n),s.push(i)):3==o.correctAnswer?(a.push(n),s.push(t),s.push(e),s.push(i)):(a.push(i),s.push(t),s.push(n),s.push(e)),s.splice(Math.floor(Math.random()*s.length),1);for(var r=0;r<s.length;r++)s[r].hide()}},{key:"formatName",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.length>t){var i=e.substring(0,t);return!1===n?i:i.trim()+"..."}return e}},{key:"formatChallengeGameUpdated",value:function(e){var t="",n=Date.now()-e;n=parseInt(n/1e3);var i=parseInt((n/2592e3).toFixed(0));if(i>0)t="".concat(i," tháng trước");else{var o=parseInt(n/604800);if(o>0)t="".concat(o," tuần trước");else{var a=parseInt(n/86400);if(a>0)t="".concat(a," ngày trước");else{var s=parseInt(n/3600);if(s>0)t="".concat(s," giờ trước");else{var r=parseInt(n/60);t=r>0?"".concat(r," phút trước"):"vài giây trước"}}}}return t}},{key:"handleRankingList",value:function(e,t,n,i){if(e.containsKey("solo_mode_top10_last_week"))var o=e.getSFSArray("solo_mode_top10_last_week");else o=e.getSFSArray("solo_mode_top10_this_week");for(var a=0;a<o.size();a++){var s=o.getSFSObject(a),r=s.getInt("user_id"),l=s.getInt("number_of_correct"),h=s.getInt("playlist_id"),c=s.getUtfString("avatar"),u={rank:a+1,user_id:r,playlist_id:h,number_of_correct:l,user_name:s.getUtfString("user_name"),avatar:c};t.push(u)}if(e.containsKey("position")){var d=e.getSFSObject("position");if("[ Empty SFSObject ]"!==d.getDump()){var f=d.getLong("pos"),p=d.getInt("user_id"),g=d.getInt("playlist_id"),y=d.getInt("number_of_correct");n.rank=f,n.user_id=p,n.playlist_id=g,n.number_of_correct=y}}i()}},{key:"handleTime",value:function(e,t){var n=e.getLong("expired_timestamp"),i=Date.now();t(parseInt((n-i)/1e3))}},{key:"setQuestLogs",value:function(e,t){null!==e&&t.push(e)}},{key:"changeQuestLogsOnClaim",value:function(e,t){console.log(t);for(var n=0;n<t.length;n++)t[n].id==e&&(t[n].state="REWARDED")}},{key:"getGame",value:function(e){var t=window.linkResource;$.ajax({type:"GET",url:t,success:function(t){e(t)},error:function(t,n,i){e({status:"ERROR"})}})}},{key:"filterResponseGames",value:function(){z.instance().menuLoadResponses.waitingGames=z.instance().menuOpponentsResponse.filter(function(e){return"THEIR_TURN"==e.status}),z.instance().menuLoadResponses.doneGames=z.instance().menuOpponentsResponse.filter(function(e){return"NO_GAME"==e.status}),z.instance().menuLoadResponses.challengeGames=z.instance().menuOpponentsResponse.filter(function(e){return"YOUR_TURN"==e.status}),z.instance().menuLoadResponses.waitingGames=z.instance().menuLoadResponses.waitingGames.sort(function(e,t){return t.can_be_poked-e.can_be_poked}),z.instance().menuLoadResponses.challengeGames=z.instance().menuLoadResponses.challengeGames.sort(function(e,t){return t.poked-e.poked}),z.instance().menuLoadResponses.challengeGames=z.instance().menuLoadResponses.challengeGames.sort(function(e,t){return t.poked_at-e.poked_at})}},{key:"isEmpty",value:function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}}],(n=null)&&Nn(t.prototype,n),i&&Nn(t,i),e}();function jn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Un=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.playingLogic||(this.playingLogic=new e),this.playingLogic}}],(n=[{key:"randomNumber",value:function(e,t){return Math.floor(Math.random()*(t+1)+e)}},{key:"convertVersionToInt",value:function(e){for(var t=e.split("."),n=0,i=0;i<t.length;i++)n+=parseInt(t[i]);return n}},{key:"genUrlSound",value:function(e){var t=TF.instance().dataMySeft.lag_value;LogConsole.log("ping------------- : "+t);var n=320;return n=t>2048?320:t>1024?192:t>512?128:64,e=(e=e.replace("QUANTITY",n)).replace("quantity",n),LogConsole.log("url------------- : "+e),e}},{key:"format",value:function(e){return e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.")}},{key:"shortenLargeNumber",value:function(e,t){for(var n,i=["k","M","G","T","P","E","Z","Y"],o=i.length-1;o>=0;o--)if(e<=-(n=Math.pow(1e3,o+1))||e>=n)return+(e/n).toFixed(t)+i[o];return e}},{key:"getChangeHeight",value:function(){console.log("innerHeight "+window.innerHeight),console.log("documentElement  "+document.documentElement.clientHeight),console.log("body  "+document.body.clientHeight),console.log("screen  "+screen.height),console.log("game.height "+game.height),console.log("game.scale.scaleFactorInversed.y : "+game.scale.scaleFactorInversed.y);var e=screen.height-window.innerHeight;return e>0&&(e=(e+15)/(1-game.scale.scaleFactorInversed.y)),e}}])&&jn(t.prototype,n),i&&jn(t,i),e}();function Fn(e){return(Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hn(e,t){return!t||"object"!==Fn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qn(e,t,n){return(Qn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Vn(e){return(Vn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wn(e,t){return(Wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qn=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Hn(this,Vn(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.score=e,n.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.signalBtn=new Phaser.Signal,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wn(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.screenDim,this.tabGem,this.tabHeart,this.popup,this.addScreenDim(),this.addGemAndHeart(),this.addEventExtension()}},{key:"addEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this)}},{key:"onUpdateUserVars",value:function(){TF.instance().dataMySeft.heart!==parseInt(this.txtHeart.text)&&(this.txtHeart.text=TF.instance().dataMySeft.heart)}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabGem.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-n)/2+t.width+5*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(t)}},{key:"addHeartDetail",value:function(){var e;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),this.txtHeart=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txt.configs);var t=e.width+this.txtHeart.width;this.txtHeart.x=(this.tabHeart.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-t)/2+this.txtHeart.width+10*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(this.txtHeart)}},{key:"addPopup",value:function(){this.btnRank,this.btnHome,this.btnReplay,this.animTimeout,this.txtLose;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.box_lose_practice.x*window.GameConfig.RESIZE,1136*window.GameConfig.RESIZE,null),this.popup.addChild(e);var t=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.box_lose_practice.nameAtlas,this.positionPracticePopupConfig.box_lose_practice.nameSprite);this.popup.addChild(t),this.addBtnRank(),this.addBtnHome(),this.addBtnReplay(),this.addTxtLose(),this.addAnimTimeOut(),this.addChild(this.popup)}},{key:"addBtnRank",value:function(){this.btnRank=new Phaser.Button(game,this.positionPracticePopupConfig.btn_rank_practice_lose.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_rank_practice_lose.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_rank_practice_lose.nameAtlas,this.onClickRank,this,null,this.positionPracticePopupConfig.btn_rank_practice_lose.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_rank);this.btnRank.addChild(e);var t=new _t(this.positionPracticePopupConfig.txt_icon_rank,this.positionPracticePopupConfig.txt_icon_rank.text);this.btnRank.addChild(t);var n=new Phaser.Sprite(game,80*window.GameConfig.RESIZE,11*window.GameConfig.RESIZE,"btnRankAnim");this.btnRank.addChild(n);n.animations.add("run_rank");n.animations.play("run_rank",26,!0),this.popup.addChild(this.btnRank)}},{key:"onClickRank",value:function(){ce.instance().playSound(ce.buttonclick),this.signalBtn.dispatch({type:"RANK"}),Le.instance().logEvent(Le.Solo_mode_ranking_button)}},{key:"addBtnHome",value:function(){this.btnHome=new Phaser.Button(game,this.positionPracticePopupConfig.btn_home_practice_lose.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice_lose.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice_lose.nameAtlas,this.onClickHome,this,null,this.positionPracticePopupConfig.btn_home_practice_lose.nameSprite),this.popup.addChild(this.btnHome)}},{key:"onClickHome",value:function(){ce.instance().playSound(ce.buttonclick),this.signalBtn.dispatch({type:"HOME"})}},{key:"addBtnReplay",value:function(){this.btnReplay=new Phaser.Button(game,this.positionPracticePopupConfig.btn_replay_practice.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_replay_practice.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_replay_practice.nameAtlas,this.onClickReplay,this,null,this.positionPracticePopupConfig.btn_replay_practice.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_heart);this.btnReplay.addChild(e);var t=new _t(this.positionPracticePopupConfig.txt_icon_heart,this.positionPracticePopupConfig.txt_icon_heart.text);t.addColor("#ffd3b5",9),this.btnReplay.addChild(t),this.popup.addChild(this.btnReplay)}},{key:"onClickReplay",value:function(){this.signalBtn.dispatch({type:"REPLAY"})}},{key:"addTxtLose",value:function(){this.txtLose=new Phaser.Text(game,this.positionPracticePopupConfig.txt_lose_timeout.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_lose_timeout.y*window.GameConfig.RESIZE,"".concat(this.positionPracticePopupConfig.txt_lose_timeout.text," : ").concat(this.score),this.positionPracticePopupConfig.txt_lose_timeout.configs),this.txtLose.anchor.set(.5,0),this.popup.addChild(this.txtLose)}},{key:"addAnimTimeOut",value:function(){this.animTimeout=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,73*window.GameConfig.RESIZE,"timeout_practice"),this.animTimeout.anchor.set(.5,0);this.animTimeout.animations.add("run_load_timeout");this.animTimeout.animations.play("run_load_timeout",24,!0),this.popup.addChild(this.animTimeout)}},{key:"makeTweenPopup",value:function(){ce.instance().playSound(ce.losesolomode),game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.positionPracticePopupConfig.box_lose_practice.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Bounce.Out,!1).start()}},{key:"addEventBtn",value:function(e,t){this.signalBtn.add(e,t)}},{key:"removeEventBtn",value:function(e,t){this.signalBtn.remove(e,t)}},{key:"destroy",value:function(){this.removeEventExtension(),Qn(Vn(t.prototype),"destroy",this).call(this)}}])&&Zn(n.prototype,i),o&&Zn(n,o),t}();function Kn(e){return(Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zn(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yn(e,t){return!t||"object"!==Kn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jn(e,t,n){return(Jn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xn(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Xn(e){return(Xn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $n(e,t){return($n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ei=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Yn(this,Xn(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.score=e,n.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.signalBtn=new Phaser.Signal,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$n(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.screenDim,this.tabGem,this.tabHeart,this.addScreenDim(),this.addGemAndHeart(),this.addEventExtension()}},{key:"addEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this)}},{key:"onUpdateUserVars",value:function(){TF.instance().dataMySeft.heart!==parseInt(this.txtHeart.text)&&(this.txtHeart.text=TF.instance().dataMySeft.heart)}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabGem.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-n)/2+t.width+10*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(t)}},{key:"addHeartDetail",value:function(){var e;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),this.txtHeart=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txt.configs);var t=e.width+this.txtHeart.width;this.txtHeart.x=(this.tabHeart.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-t)/2+this.txtHeart.width+10*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(this.txtHeart)}},{key:"addPopup",value:function(){this.btnRank,this.btnHome,this.btnReplay,this.animLose,this.txtLose;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.box_lose_practice.x*window.GameConfig.RESIZE,1136*window.GameConfig.RESIZE,null),this.popup.addChild(e);var t=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.box_lose_practice.nameAtlas,this.positionPracticePopupConfig.box_lose_practice.nameSprite);this.popup.addChild(t),this.addBtnRank(),this.addBtnHome(),this.addBtnReplay(),this.addTxtLose(),this.addAnimLose(),this.addChild(this.popup)}},{key:"addBtnRank",value:function(){this.btnRank=new Phaser.Button(game,this.positionPracticePopupConfig.btn_rank_practice_lose.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_rank_practice_lose.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_rank_practice_lose.nameAtlas,this.onClickRank,this,null,this.positionPracticePopupConfig.btn_rank_practice_lose.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_rank);this.btnRank.addChild(e);var t=new _t(this.positionPracticePopupConfig.txt_icon_rank,this.positionPracticePopupConfig.txt_icon_rank.text);this.btnRank.addChild(t);var n=new Phaser.Sprite(game,80*window.GameConfig.RESIZE,11*window.GameConfig.RESIZE,"btnRankAnim");this.btnRank.addChild(n);n.animations.add("run_rank");n.animations.play("run_rank",26,!0),this.popup.addChild(this.btnRank)}},{key:"onClickRank",value:function(){ce.instance().playSound(ce.buttonclick),this.signalBtn.dispatch({type:"RANK"}),Le.instance().logEvent(Le.Solo_mode_ranking_button)}},{key:"addBtnHome",value:function(){this.btnHome=new Phaser.Button(game,this.positionPracticePopupConfig.btn_home_practice_lose.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice_lose.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice_lose.nameAtlas,this.onClickHome,this,null,this.positionPracticePopupConfig.btn_home_practice_lose.nameSprite),this.popup.addChild(this.btnHome)}},{key:"onClickHome",value:function(){ce.instance().playSound(ce.buttonclick),this.signalBtn.dispatch({type:"HOME"})}},{key:"addBtnReplay",value:function(){this.btnReplay=new Phaser.Button(game,this.positionPracticePopupConfig.btn_replay_practice.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_replay_practice.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_replay_practice.nameAtlas,this.onClickReplay,this,null,this.positionPracticePopupConfig.btn_replay_practice.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_heart);this.btnReplay.addChild(e);var t=new _t(this.positionPracticePopupConfig.txt_icon_heart,this.positionPracticePopupConfig.txt_icon_heart.text);t.addColor("#ffd3b5",9),this.btnReplay.addChild(t),this.popup.addChild(this.btnReplay)}},{key:"onClickReplay",value:function(){this.signalBtn.dispatch({type:"REPLAY"})}},{key:"addTxtLose",value:function(){this.txtLose=new Phaser.Text(game,this.positionPracticePopupConfig.txt_lose_timeout.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_lose_timeout.y*window.GameConfig.RESIZE,"".concat(this.positionPracticePopupConfig.txt_lose_timeout.text," : ").concat(this.score),this.positionPracticePopupConfig.txt_lose_timeout.configs),this.txtLose.anchor.set(.5,0),this.popup.addChild(this.txtLose)}},{key:"addAnimLose",value:function(){this.animLose=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,73*window.GameConfig.RESIZE,"wrong_practice"),this.animLose.anchor.set(.5,0);this.animLose.animations.add("run_load_wrong");this.popup.addChild(this.animLose)}},{key:"makeTweenPopup",value:function(){var e=this;ce.instance().playSound(ce.losesolomode);var t=game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.positionPracticePopupConfig.box_lose_practice.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Bounce.Out,!1);t.start(),t.onComplete.add(function(){e.animLose.animations.play("run_load_wrong",15,!1)},this)}},{key:"addEventBtn",value:function(e,t){this.signalBtn.add(e,t)}},{key:"removeEventBtn",value:function(e,t){this.signalBtn.remove(e,t)}},{key:"destroy",value:function(){this.removeEventExtension(),Jn(Xn(t.prototype),"destroy",this).call(this)}}])&&zn(n.prototype,i),o&&zn(n,o),t}();function ti(e){return(ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ni(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ii(e,t){return!t||"object"!==ti(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oi(e){return(oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ai(e,t){return(ai=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var si=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ii(this,oi(t).call(this,game))).event={tweenIconPls:new Phaser.Signal,tweenDoneAll:new Phaser.Signal},i.reward=n,i.type=e,i.finishPoint=o,i.definedPosition(),i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ai(e,t)}(t,Phaser.Group),n=t,(i=[{key:"definedPosition",value:function(){this.pointsArrayGem1=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:145*window.GameConfig.RESIZE,y:255*window.GameConfig.RESIZE},{x:459*window.GameConfig.RESIZE,y:118*window.GameConfig.RESIZE},{x:380*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayGem2=[{x:520*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:520*window.GameConfig.RESIZE,y:290*window.GameConfig.RESIZE},{x:459*window.GameConfig.RESIZE,y:118*window.GameConfig.RESIZE},{x:380*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayGem3=[{x:560*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:181*window.GameConfig.RESIZE,y:538*window.GameConfig.RESIZE},{x:384*window.GameConfig.RESIZE,y:208*window.GameConfig.RESIZE},{x:380*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayGem4=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:805*window.GameConfig.RESIZE,y:471*window.GameConfig.RESIZE},{x:339*window.GameConfig.RESIZE,y:302*window.GameConfig.RESIZE},{x:380*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.arrParentGems=[this.pointsArrayGem1,this.pointsArrayGem2,this.pointsArrayGem3,this.pointsArrayGem4],this.pointsArrayMic1=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:396*window.GameConfig.RESIZE,y:313*window.GameConfig.RESIZE},{x:492*window.GameConfig.RESIZE,y:198*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayMic2=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:307*window.GameConfig.RESIZE,y:349*window.GameConfig.RESIZE},{x:258*window.GameConfig.RESIZE,y:243*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayMic3=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:307*window.GameConfig.RESIZE,y:349*window.GameConfig.RESIZE},{x:288*window.GameConfig.RESIZE,y:156*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayMic4=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:136*window.GameConfig.RESIZE,y:417*window.GameConfig.RESIZE},{x:246*window.GameConfig.RESIZE,y:243*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.arrParentMics=[this.pointsArrayMic1,this.pointsArrayMic2,this.pointsArrayMic3,this.pointsArrayMic4],this.pointsArrayTicket1=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:433*window.GameConfig.RESIZE,y:274*window.GameConfig.RESIZE},{x:287*window.GameConfig.RESIZE,y:123*window.GameConfig.RESIZE},{x:556*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayTicket2=[{x:315*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:580*window.GameConfig.RESIZE,y:324*window.GameConfig.RESIZE},{x:548*window.GameConfig.RESIZE,y:210*window.GameConfig.RESIZE},{x:556*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayTicket3=[{x:325*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:441*window.GameConfig.RESIZE,y:197*window.GameConfig.RESIZE},{x:548*window.GameConfig.RESIZE,y:209*window.GameConfig.RESIZE},{x:556*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayTicket4=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:223*window.GameConfig.RESIZE,y:331*window.GameConfig.RESIZE},{x:491*window.GameConfig.RESIZE,y:234*window.GameConfig.RESIZE},{x:556*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.arrParentTickets=[this.pointsArrayTicket1,this.pointsArrayTicket2,this.pointsArrayTicket3,this.pointsArrayTicket4],this.pointsArrayHeart1=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:396*window.GameConfig.RESIZE,y:313*window.GameConfig.RESIZE},{x:492*window.GameConfig.RESIZE,y:198*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayHeart2=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:307*window.GameConfig.RESIZE,y:349*window.GameConfig.RESIZE},{x:258*window.GameConfig.RESIZE,y:243*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayHeart3=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:307*window.GameConfig.RESIZE,y:349*window.GameConfig.RESIZE},{x:288*window.GameConfig.RESIZE,y:156*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.pointsArrayHeart4=[{x:320*window.GameConfig.RESIZE,y:474*window.GameConfig.RESIZE},{x:136*window.GameConfig.RESIZE,y:417*window.GameConfig.RESIZE},{x:246*window.GameConfig.RESIZE,y:243*window.GameConfig.RESIZE},{x:194*window.GameConfig.RESIZE,y:55*window.GameConfig.RESIZE}],this.arrParentHearts=[this.pointsArrayHeart1,this.pointsArrayHeart2,this.pointsArrayHeart3,this.pointsArrayHeart4],null!==this.finishPoint&&("DIAMOND"==this.type?(this.pointsArrayGem1[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayGem2[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayGem3[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayGem4[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE}):"TICKET"==this.type?(this.pointsArrayTicket1[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayTicket2[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayTicket3[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayTicket4[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE}):"SUPPORT_ITEM"==this.type?(this.pointsArrayMic1[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayMic2[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayMic3[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayMic4[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE}):"HEART"==this.type&&(this.pointsArrayHeart1[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayHeart2[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayHeart3[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE},this.pointsArrayHeart4[3]={x:this.finishPoint.x*window.GameConfig.RESIZE,y:this.finishPoint.y*window.GameConfig.RESIZE}))}},{key:"afterInit",value:function(){0!==this.reward&&this.addIcon()}},{key:"addIcon",value:function(){var e=this;ce.instance().playSound(ce.takereward);var t="";"DIAMOND"==this.type?t="Gem_Big":"TICKET"==this.type?t="Ticket_Big":"SUPPORT_ITEM"==this.type?t="Mic_Big":"HEART"==this.type&&(t="Heart_Big"),this.icon_big=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,474*window.GameConfig.RESIZE,"otherSprites",t),this.icon_big.anchor.set(.5),this.icon_big.scale.set(.3),this.txtReward=new Phaser.Text(game,320*window.GameConfig.RESIZE,600*window.GameConfig.RESIZE,"+".concat(this.reward),{font:"GilroyBold",fill:"#3aff78",align:"center",fontSize:40}),this.txtReward.anchor.set(.5),this.txtReward.alpha=.5,this.txtReward.scale.set(.5);var n=game.add.tween(this.txtReward.scale).to({x:1,y:1},700,Phaser.Easing.Linear.In,!1);n.start(),n.onUpdateCallback(function(){e.txtReward.alpha+=.05},this),n.onComplete.add(function(){e.txtReward.destroy()},this),game.add.tween(this.icon_big.scale).to({x:1,y:1},300,Phaser.Easing.Linear.In,!1).start();var i=game.add.tween(this.icon_big).to({alpha:1},1e3,Phaser.Easing.Linear.In,!1);i.start();var o=.1;i.onUpdateCallback(function(){e.icon_big.rotation+=o,e.icon_big.rotation>.2?o=-.07:e.icon_big.rotation<-.2&&(o=.07)},this),i.onComplete.add(function(){e.icon_big.rotation=0;var t=game.add.tween(e.icon_big.scale).to({x:.5,y:.5},300,Phaser.Easing.Linear.In,!1);t.start(),t.onComplete.add(function(){e.icon_big.destroy()},e);var n={resoure:parseInt(e.txtReward.text)},i=game.add.tween(n).to({resoure:0},500,"Linear",!1);i.start(),e.txtReward.destroy(),i.onUpdateCallback(function(){},e),i.onComplete.add(function(){e.event.tweenIconPls.dispatch()},e),e.addIconMoveCurve()},this),this.addStarNim(),this.addChild(this.icon_big),this.addChild(this.txtReward)}},{key:"addStarNim",value:function(){var e=new Phaser.Sprite(game,0,0,"SoloModeStar");e.anchor.set(.5),e.scale.set(1.5);e.animations.add("run_star");e.animations.play("run_star",30,!0),this.icon_big.addChild(e)}},{key:"addIconMoveCurve",value:function(){var e=this,t="",n=[];"DIAMOND"==this.type?(t="Gem_Big",n=this.arrParentGems):"TICKET"==this.type?(t="Ticket_Big",n=this.arrParentTickets):"SUPPORT_ITEM"==this.type?(t="Mic_Big",n=this.arrParentMics):"HEART"==this.type&&(t="Heart_Big",n=this.arrParentHearts);for(var i=function(i){var o=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,474*window.GameConfig.RESIZE,"otherSprites",t);o.scale.set(1),o.anchor.set(.5),e.addChild(o),setTimeout(function(){game.add.tween(o.scale).to({x:.2,y:.2},150,Phaser.Easing.Linear.In,!1).start();var e=game.add.tween(o).to({x:[n[i][0].x,n[i][1].x,n[i][2].x,n[i][3].x],y:[n[i][0].y,n[i][1].y,n[i][2].y,n[i][3].y]},750,Phaser.Easing.Linear.In,!1,0,0).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});e.start(),e.onComplete.add(function(){o.destroy()})},100*i),setTimeout(function(){e.event.tweenDoneAll.dispatch(),De.instance().event.tweenAllClaimDailyQuestDone.dispatch()},300*e.arrParentGems.length)},o=0;o<this.arrParentGems.length;o++)i(o)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&ni(n.prototype,i),o&&ni(n,o),t}();function ri(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var li=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.countPlayTurnBase=0,this.countPlayQuickPlay=0,this.countPlayCreateRoom=0,this.countGameOverSoloMode=0,this.countWinAndTakeRewardSoloMode=0,this.countTakeReward=0,this.countTakeAchievementReward=0,this.countEventMode=0,this.strEvent="",this.ktLoadAds=!1,this.ktHideBanner=!1,this.event={rewardedVideoAvailabilityChanged:new Phaser.Signal,rewardedVideoRewardReceived:new Phaser.Signal,rewardedVideoStarted:new Phaser.Signal,rewardedVideoEnded:new Phaser.Signal,rewardedVideoOpened:new Phaser.Signal,rewardedVideoClosed:new Phaser.Signal,rewardedVideoFailed:new Phaser.Signal,interstitialLoaded:new Phaser.Signal,interstitialShown:new Phaser.Signal,interstitialShowFailed:new Phaser.Signal,interstitialClicked:new Phaser.Signal,interstitialClosed:new Phaser.Signal,interstitialWillOpen:new Phaser.Signal,interstitialFailedToLoad:new Phaser.Signal,bannerDidLoad:new Phaser.Signal,bannerFailedToLoad:new Phaser.Signal,bannerDidClick:new Phaser.Signal,bannerWillPresentScreen:new Phaser.Signal,bannerDidDismissScreen:new Phaser.Signal,bannerWillLeaveApplication:new Phaser.Signal},this.existAds=!1,"undefined"!=typeof IronSourceAds&&(this.existAds=!0),!0===this.existAds&&("android"==device.platform||"Android"==device.platform?IronSourceAds.init({appKey:"85c3adc5"}):IronSourceAds.init({appKey:"7fb0fc95"}),IronSourceAds.validateIntegration()),window.addEventListener("rewardedVideoAvailabilityChanged",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoAvailabilityChanged"),console.log(e),t.event.rewardedVideoAvailabilityChanged.dispatch(),""!==t.strEvent){var n=t.strEvent+"AvailabilityChanged";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoRewardReceived",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoRewardReceived"),console.log(e),t.event.rewardedVideoRewardReceived.dispatch(e),""!==t.strEvent){var n=t.strEvent+"RewardReceived";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoStarted",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoStarted"),t.event.rewardedVideoStarted.dispatch(),""!==t.strEvent){var n=t.strEvent+"Started";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoEnded",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoEnded"),t.event.rewardedVideoEnded.dispatch(),""!==t.strEvent){var n=t.strEvent+"Ended";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoOpened",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoOpened"),t.event.rewardedVideoOpened.dispatch(),""!==t.strEvent){var n=t.strEvent+"Opened";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoClosed",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoClosed"),t.event.rewardedVideoClosed.dispatch(),""!==t.strEvent){var n=t.strEvent+"Closed";Le.instance().logEvent(n)}}),window.addEventListener("rewardedVideoFailed",function(e){if(qe.instance().hideLoading(),console.log("rewardedVideoFailed"),console.log(e),t.event.rewardedVideoFailed.dispatch(),""!==t.strEvent){var n=t.strEvent+"Failed";Le.instance().logEvent(n)}}),window.addEventListener("interstitialLoaded",function(e){if(console.log("interstitialLoaded"),t.ktLoadAds=!0,t.event.interstitialLoaded.dispatch(),""!==t.strEvent){var n=t.strEvent+"Loaded";Le.instance().logEvent(n)}}),window.addEventListener("interstitialShow",function(e){if(console.log("interstitialShow"),console.log(e),t.event.interstitialShow.dispatch(),qe.instance().hideLoading(),""!==t.strEvent){var n=t.strEvent+"Show";Le.instance().logEvent(n)}}),window.addEventListener("interstitialShowFailed",function(e){if(console.log("interstitialShowFailed"),console.log(e),qe.instance().hideLoading(),t.event.interstitialShowFailed.dispatch(),""!==t.strEvent){var n=t.strEvent+"Failed";Le.instance().logEvent(n)}t.ktLoadAds=!1,t.loadInterstitial()}),window.addEventListener("interstitialClicked",function(e){if(console.log("interstitialClicked"),t.event.interstitialClicked.dispatch(),qe.instance().hideLoading(),""!==t.strEvent){var n=t.strEvent+"Clicked";Le.instance().logEvent(n)}}),window.addEventListener("interstitialClosed",function(e){if(console.log("interstitialClosed"),t.event.interstitialClosed.dispatch(),qe.instance().hideLoading(),""!==t.strEvent){var n=t.strEvent+"Closed";Le.instance().logEvent(n)}t.ktLoadAds=!1,t.loadInterstitial()}),window.addEventListener("interstitialWillOpen",function(e){if(console.log("interstitialWillOpen"),qe.instance().hideLoading(),t.event.interstitialWillOpen.dispatch(),""!==t.strEvent){var n=t.strEvent+"WillOpen";Le.instance().logEvent(n)}}),window.addEventListener("interstitialFailedToLoad",function(e){if(console.log("interstitialFailedToLoad"),qe.instance().hideLoading(),""!==t.strEvent){var n=t.strEvent+"FailedToLoad";Le.instance().logEvent(n)}t.ktLoadAds=!1,t.loadInterstitial()}),window.addEventListener("bannerDidLoad",function(e){if(console.log("bannerDidLoad"),console.log(e),!1===t.ktHideBanner&&IronSourceAds.showBanner({position:"bottom",size:"standard",overlap:!0,offsetTopBar:!1,onSuccess:function(e){console.log("available : "+e),console.log("showBanner onSuccess")},onFailure:function(e){console.log("showBanner onFailure"),console.log(e)}}),t.event.bannerDidLoad.dispatch(),""!==t.strEvent){var n=t.strEvent+"DidLoad";Le.instance().logEvent(n)}}),window.addEventListener("bannerFailedToLoad",function(e){if(console.log("bannerFailedToLoad"),console.log(e),t.event.bannerFailedToLoad.dispatch(),""!==t.strEvent){var n=t.strEvent+"FailedToLoad";Le.instance().logEvent(n)}}),window.addEventListener("bannerDidClick",function(e){if(console.log("bannerDidClick"),t.event.bannerDidClick.dispatch(),""!==t.strEvent){var n=t.strEvent+"DidClick";Le.instance().logEvent(n)}}),window.addEventListener("bannerWillPresentScreen",function(e){if(console.log("bannerWillPresentScreen"),t.event.bannerWillPresentScreen.dispatch(),""!==t.strEvent){var n=t.strEvent+"WillPresentScreen";Le.instance().logEvent(n)}}),window.addEventListener("bannerDidDismissScreen",function(e){if(console.log("bannerDidDismissScreen"),t.event.bannerDidDismissScreen.dispatch(),""!==t.strEvent){var n=t.strEvent+"DidDismissScreen";Le.instance().logEvent(n)}}),window.addEventListener("bannerWillLeaveApplication",function(e){if(console.log("bannerWillLeaveApplication"),t.event.bannerWillLeaveApplication.dispatch(),""!==t.strEvent){var n=t.strEvent+"WillLeaveApplication";Le.instance().logEvent(n)}}),!0===this.existAds&&this.loadInterstitial()}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.ironsource||(this.ironsource=new e),this.ironsource}}],(n=[{key:"playTurnBase",value:function(){console.log("playTurnBase"),this.countPlayTurnBase++,console.log(this.countPlayTurnBase)}},{key:"showInterstitialTurnBase",value:function(){return console.log("showInterstitialTurnBase"),this.countPlayTurnBase>2&&(this.countPlayTurnBase=0,this.strEvent=Le.InterstitialTurnBase,this.showInterstitial(),!0)}},{key:"playQuickPlay",value:function(){this.countPlayQuickPlay++}},{key:"showInterstitialQuickPlay",value:function(){return this.countPlayQuickPlay>0&&(this.countPlayQuickPlay=0,this.strEvent=Le.InterstitialQuickPlay,this.showInterstitial(),!0)}},{key:"playCreateRoom",value:function(){this.countPlayCreateRoom++}},{key:"showInterstitialCreateRoom",value:function(){return this.countPlayCreateRoom>0&&(this.countPlayCreateRoom=0,this.strEvent=Le.InterstitialCreateRoom,this.showInterstitial(),!0)}},{key:"playEventMode",value:function(){this.countEventMode++}},{key:"showInterstitialEventMode",value:function(){return this.countEventMode>0&&(this.countEventMode=0,this.strEvent=Le.InterstitialEventMode,this.showInterstitial(),!0)}},{key:"gameoverSoloMode",value:function(){this.countGameOverSoloMode++}},{key:"showInterstitialGameOverSoloMode",value:function(){return this.countGameOverSoloMode>5&&(this.countGameOverSoloMode=0,this.strEvent=Le.InterstitialSoloModeGameOver,this.showInterstitial(),!0)}},{key:"showInterstitialDoneSoloMode",value:function(){this.strEvent=Le.InterstitialDoneSoloMode,this.showInterstitial()}},{key:"winAndTakeRewarkSoloMode",value:function(){this.countWinAndTakeRewardSoloMode++}},{key:"showInterstitialWinTakeRewarkSoloMode",value:function(){return this.countWinAndTakeRewardSoloMode>0&&(this.countWinAndTakeRewardSoloMode=0,this.strEvent=Le.InterstitialSoloModeWin,this.showInterstitial(),!0)}},{key:"questTakeReward",value:function(){this.countTakeReward++}},{key:"showInterstitialQuestTakereward",value:function(){return!1}},{key:"achievementTakeReward",value:function(){this.countTakeAchievementReward++}},{key:"showInterstitialachievementTakeReward",value:function(){return this.countTakeAchievementReward>0&&(this.countTakeAchievementReward=0,this.showInterstitial(),this.strEvent=Le.InterstitialAchievement,!0)}},{key:"showRewardVideoInappPurchase",value:function(e){var t="DefaultRewardedVideo";"HEART"===e?(t="IAP_Heart",this.strEvent=Le.RewardVideoInappHeart):"SUPPORT_ITEM"===e?this.strEvent=Le.RewardVideoInappSupportItem:"DIAMOND"===e?(t="IAP_Diamonds",this.strEvent=Le.RewardVideoInappDiamond):"TICKET"===e&&(t="IAP_Ticket",this.strEvent=Le.RewardVideoInappTicket),this.showRewardVideoAd(t)}},{key:"showRewardVideoX2Daily",value:function(){this.strEvent=Le.RewardVideoX2DailyReward,this.showRewardVideoAd("x2_daily_reward")}},{key:"showRewardVideoTakeHeartSoloMode",value:function(){this.strEvent=Le.RewardVideoGetHeartInSoloMode,this.showRewardVideoAd()}},{key:"showRewardVideoX2DiamondSoloMode",value:function(){this.strEvent=Le.RewardVideoX2DiamondButtonSoloMode,this.showRewardVideoAd("x2_solo_mode_reward")}},{key:"showRewardVideoLuckyWheel",value:function(){this.strEvent=Le.RewardVideoLuckyWheel,this.showRewardVideoAd()}},{key:"showBanerQuestScreen",value:function(){}},{key:"showBanerEventRoomScreen",value:function(){}},{key:"showBanerUserProfileScreen",value:function(){}},{key:"showBanerViewAllFriendScreen",value:function(){}},{key:"showBanerInfoSongScreen",value:function(){}},{key:"showBanerPartyModeScreen",value:function(){this.strEvent=Le.BannerPartyMode,this.showBanner()}},{key:"showBanerQuickPlayModeRoomScreen",value:function(){this.strEvent=Le.BannerQuickPlayModeRoom,this.showBanner()}},{key:"showBanerChooseBettingQuickPlayScreen",value:function(){this.strEvent=Le.BannerChooseBettingQuickPlay,this.showBanner()}},{key:"showBanerWaitingRoomQuickPlayScreen",value:function(){this.strEvent=Le.BannerWaitingRoomQuickPlayScreen,this.showBanner()}},{key:"showBanerChoosePlaylistquickPlayScreen",value:function(){}},{key:"showBanerChooseBettingCreateRoomScreen",value:function(){this.strEvent=Le.BannerChooseBettingCreateRoom,this.showBanner()}},{key:"showBanerChoosePlaylistCreateRoomScreen",value:function(){}},{key:"showBanerInviteOtherUserWaitingScreen",value:function(){}},{key:"loadRewardVideoAd",value:function(){!0===this.existAds&&IronSourceAds.hasRewardedVideo({onSuccess:function(e){console.log("onSuccess : "+e)},onFailure:function(e){console.log("onFailure"),console.log(e)}})}},{key:"showRewardVideoAd",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!0===this.existAds&&(qe.instance().showLoading(),console.log("showRewardVideoAd : "),IronSourceAds.hasRewardedVideo({onSuccess:function(e){console.log("onSuccess : "+e),e?IronSourceAds.showRewardedVideo({onSuccess:function(){console.log("showRewardVideoAd onSuccess")},onFailure:function(e){console.log("showRewardVideoAd onFailure")}}):qe.instance().hideLoading()},onFailure:function(e){console.log("onFailure---"),console.log(e),qe.instance().hideLoading()}}))}},{key:"loadInterstitial",value:function(){var e=this;console.log("loadInterstitial-------------"),!0===this.existAds&&IronSourceAds.hasInterstitial({onSuccess:function(e){console.log("available : "+e),!1===e&&IronSourceAds.loadInterstitial()},onFailure:function(t){e.loadInterstitial()}})}},{key:"showInterstitial",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];!0===this.existAds&&(!0===this.ktLoadAds?(qe.instance().showLoading(),IronSourceAds.showInterstitial({onSuccess:function(){console.log("showInterstitial onSuccess")},onFailure:function(e){console.log("showInterstitial onFailure")}})):this.event.interstitialFailedToLoad.dispatch())}},{key:"showBanner",value:function(){!0===this.existAds&&console.log("showBanner")}},{key:"hideBanner",value:function(){this.existAds}}])&&ri(t.prototype,n),i&&ri(t,i),e}();function hi(e){return(hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ci(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ui=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event={share:new Phaser.Signal}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.fbAction||(this.fbAction=new e),this.fbAction}}],(n=[{key:"share",value:function(){if(LogConsole.log("share------------------------------"),window.cordova&&"undefined"!=typeof device)Ie.instance().share();else{FB.ui({method:"share_open_graph",action_type:"og.shares",action_properties:JSON.stringify({object:{"og:url":"https://wazzat.vn/home/","og:title":"So Tài Âm Nhạc","og:description":"So Tài Âm Nhạc","og:image":"https://cdn.gamezoka.com/storage/assets/icon.png"}})},function(e){e.hasOwnProperty("error_code")||TF.instance().sendData(Pe.FB_USER_SHARED_RESULT_REQUEST,null)})}}},{key:"inviteFriend",value:function(){window.cordova&&"undefined"!=typeof device?Ie.instance().invite():FB.ui({method:"apprequests",message:"Come and play MusicQuiz with me!"},function(e){"object"===hi(e)&&TF.instance().sendData(Pe.FB_USER_INVITE_FRIEND_REQUEST,Re.begin(e.request,e.to))})}},{key:"logout",value:function(e){window.cordova&&"undefined"!=typeof device?Ie.instance().logout(function(t){e(t)}):FB.logout(function(t){e(t)})}}])&&ci(t.prototype,n),i&&ci(t,i),e}();function di(e){return(di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pi(e,t){return!t||"object"!==di(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gi(e){return(gi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yi(e,t){return(yi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mi=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=pi(this,gi(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),o.rewardType=i,o.score=e,o.reward=n,o.isWatchRewardVideo=!1,o.isWatchRewardVideoDone=!1,o.signalNextQuestion=new Phaser.Signal,o.signalStop=new Phaser.Signal,o.signalClaim=new Phaser.Signal,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yi(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.timer=null,this.screenDim,this.tabGem,this.tabHeart,this.addScreenDim(),this.headerResource,this.addHeaderResource()}},{key:"addHeaderResource",value:function(){this.headerResource=new Phaser.Group(game,0,0),this.addChild(this.headerResource),this.txtGem,this.txtTicket,this.txtMic,this.tabGemHeader,this.tabTicketHeader,this.tabMicHeader,this.addTabGemHeader(this.positionPracticePopupConfig.header),this.addTabTicketHeader(this.positionPracticePopupConfig.header),this.addTabMicHeader(this.positionPracticePopupConfig.header)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.positionPracticePopupConfig.header.gem);this.txtGem=this.addTxtGem(this.positionPracticePopupConfig.header.txtResource);var n=t.width+this.txtGem.width;this.txtGem.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtGem.width+10*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(this.txtGem),this.headerResource.addChild(this.tabGemHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addTabTicketHeader",value:function(e){this.tabTicketHeader=new Phaser.Sprite(game,e.tabTicket.x*window.GameConfig.RESIZE,e.tabTicket.y*window.GameConfig.RESIZE,e.tabTicket.nameAtlas,e.tabTicket.nameSprite);var t=this.addTicket(this.positionPracticePopupConfig.header.ticket);this.txtTicket=this.addTxtTicket(this.positionPracticePopupConfig.header.txtResource);var n=t.width+this.txtTicket.width;this.txtTicket.x=(this.tabTicketHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabTicketHeader.width-n)/2+this.txtTicket.width+10*window.GameConfig.RESIZE,this.tabTicketHeader.addChild(t),this.tabTicketHeader.addChild(this.txtTicket),this.headerResource.addChild(this.tabTicketHeader)}},{key:"addTicket",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtTicket",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("ticket").value,e.configs)}},{key:"addTabMicHeader",value:function(e){this.tabMicHeader=new Phaser.Sprite(game,e.tabMic.x*window.GameConfig.RESIZE,e.tabMic.y*window.GameConfig.RESIZE,e.tabMic.nameAtlas,e.tabMic.nameSprite);var t=this.addMic(this.positionPracticePopupConfig.header.micro);this.txtMic=this.addTxtMic(this.positionPracticePopupConfig.header.txtResource);var n=t.width+this.txtMic.width;this.txtMic.x=(this.tabMicHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabMicHeader.width-n)/2+this.txtMic.width+10*window.GameConfig.RESIZE,this.tabMicHeader.addChild(t),this.tabMicHeader.addChild(this.txtMic),this.headerResource.addChild(this.tabMicHeader)}},{key:"addMic",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtMic",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("support_item").value,e.configs)}},{key:"interstitialClosed",value:function(){this.tweenDestroy()}},{key:"interstitialShowFailed",value:function(){this.tweenDestroy()}},{key:"rewardedVideoEnded",value:function(){}},{key:"rewardedVideoClosed",value:function(){}},{key:"rewardedVideoRewardReceived",value:function(){this.isWatchRewardVideoDone=!0,this.signalClaim.dispatch(1)}},{key:"interstitialFailedToLoad",value:function(){this.tweenDestroy()}},{key:"rewardedVideoFailed",value:function(){this.btnWatching.inputEnabled=!0,this.btnContinue.inputEnabled=!0}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addPopup",value:function(){this.congraTxt,this.txtDetailReward,this.btnContinue,this.timeCountDown,this.txtTimeout,this.iconCircle;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.lineRewardPopup.x*window.GameConfig.RESIZE,1140*window.GameConfig.RESIZE,null),this.popup.addChild(e);var t=new Zt({x:0,y:0,nameAtlas:"defaultSource",nameSprite:"bg_nhaptext",left:30,right:30,top:30,bot:30,width:570,height:490,name:"choose_game_bg_input_text"});this.popup.addChild(t);var n=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,this.positionPracticePopupConfig.rewardPopup.nameSprite);this.popup.addChild(n),this.addChild(this.popup),this.addCongraTxt(),this.addTxtDetailReward(),this.addBtnContinue(),this.addIconCircle(),this.addBtnWatch(),this.addBtnShare(),this.checkDevice()}},{key:"checkDevice",value:function(){window.cordova&&"undefined"!=typeof device||(this.btnWatching.inputEnabled=!1)}},{key:"makeTweenPopup",value:function(){var e=this;ce.instance().playSound(ce.getrewardsolomode);var t=game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.positionPracticePopupConfig.lineRewardPopup.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);t.start(),t.onComplete.add(function(){},this),this.timeAnimGem=game.time.events.add(.5*Phaser.Timer.SECOND,function(){e.addAnimGem()},this)}},{key:"addCongraTxt",value:function(){this.congraTxt=new Phaser.Text(game,this.positionPracticePopupConfig.congrat_txt_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_reward.text,this.positionPracticePopupConfig.congrat_txt_reward.configs),this.congraTxt.anchor.set(.5,0),this.popup.addChild(this.congraTxt)}},{key:"addTxtDetailReward",value:function(){this.txtDetailReward=new Phaser.Text(game,this.positionPracticePopupConfig.txt_detail_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_detail_reward.y*window.GameConfig.RESIZE,"".concat(this.positionPracticePopupConfig.txt_detail_reward.text1," ").concat(this.score," ").concat(this.positionPracticePopupConfig.txt_detail_reward.text2),this.positionPracticePopupConfig.txt_detail_reward.configs),this.txtDetailReward.anchor.set(.5,0),this.txtDetailReward.addColor("#ffa33a",19),this.txtDetailReward.addColor("#333333",22),this.popup.addChild(this.txtDetailReward)}},{key:"addBtnContinue",value:function(){this.btnContinue=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_continue_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue_reward.nameAtlas,this.positionPracticePopupConfig.btn_continue_reward.nameSprite),this.btnContinue.anchor.set(.5,0);var e=new Phaser.Text(game,this.positionPracticePopupConfig.txt_btn_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.text,this.positionPracticePopupConfig.txt_btn_continue.configs);e.anchor.set(.5,0),this.btnContinue.inputEnabled=!0,this.btnContinue.events.onInputUp.add(this.onClickContinue,this),this.btnContinue.addChild(e),this.popup.addChild(this.btnContinue)}},{key:"addBtnShare",value:function(){this.btnShare=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_fb_share.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_fb_share.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_fb_share.nameAtlas,this.positionPracticePopupConfig.btn_fb_share.nameSprite),this.btnShare.anchor.set(.5,0),this.btnShare.inputEnabled=!0,this.btnShare.events.onInputUp.add(this.onClickShare,this),this.popup.addChild(this.btnShare)}},{key:"onClickShare",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"onShared",value:function(){}},{key:"addIconCircle",value:function(){this.iconCircle=new Phaser.Sprite(game,this.positionPracticePopupConfig.icon_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.icon_gem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.icon_gem.nameAtlas,this.positionPracticePopupConfig.icon_gem.nameSprite),this.iconCircle.anchor.set(.5);var e=new Phaser.Text(game,this.positionPracticePopupConfig.reward_icon_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.reward_icon_gem.y*window.GameConfig.RESIZE,"+".concat(this.reward),this.positionPracticePopupConfig.reward_icon_gem.configs);e.anchor.set(.5,0),game.time.events.loop(10,this.animationUpdateCircle,this),this.popup.addChild(this.iconCircle),this.popup.addChild(e)}},{key:"animationUpdateCircle",value:function(){this.iconCircle.angle+=3}},{key:"addAnimGem",value:function(){"DIAMOND"==this.rewardType?(this.sSGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.anim_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.nameSprite),this.sSGem.anchor.set(.5),this.animGem=this.sSGem.animations.add("animGemReward"),this.animGem.enableUpdate=!0,this.animGem.onUpdate.add(this.onUpdateGemReward,this),this.animGem.play(35,!1,!1),this.popup.addChild(this.sSGem)):"TICKET"==this.rewardType?(this.sSGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.anim_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.y*window.GameConfig.RESIZE,"rewardTicketSoloMode"),this.sSGem.anchor.set(.5),this.animGem=this.sSGem.animations.add("animTicketReward"),this.animGem.enableUpdate=!0,this.animGem.onUpdate.add(this.onUpdateGemReward,this),this.animGem.play(35,!1,!1),this.popup.addChild(this.sSGem)):"SUPPORT_ITEM"==this.rewardType&&(this.sSGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.anim_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.y*window.GameConfig.RESIZE,"rewardSptSoloMode"),this.sSGem.anchor.set(.5),this.animGem=this.sSGem.animations.add("animSptReward"),this.animGem.enableUpdate=!0,this.animGem.onUpdate.add(this.onUpdateGemReward,this),this.animGem.play(35,!1,!1),this.popup.addChild(this.sSGem))}},{key:"onUpdateGemReward",value:function(e,t){53===t.index&&(e.frame=37)}},{key:"onClickContinue",value:function(){this.isWatchRewardVideo=!1,this.btnWatching.inputEnabled=!1,this.btnContinue.inputEnabled=!1,this.signalStop.dispatch(),this.signalClaim.dispatch(0)}},{key:"makeAnimWhenClaimed",value:function(){var e=this.reward;1==this.isWatchRewardVideo&&(e*=2);var t={x:0,y:0};"DIAMOND"==this.rewardType?(t.x=351,t.y=55):"TICKET"==this.rewardType?(t.x=529,t.y=55):(t.x=164,t.y=55);var n=new si(this.rewardType,e,t);if(this.addChild(n),"DIAMOND"==this.rewardType){var i=game.add.tween(this.txtGem).to({text:TF.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);this.tweenTxtRsr(i,this.txtGem)}else if("TICKET"==this.rewardType){var o=game.add.tween(this.txtTicket).to({text:TF.instance().socket.mySelf.getVariable("ticket").value},300,"Linear",!1);this.tweenTxtRsr(o,this.txtTicket)}else{var a=game.add.tween(this.txtMic).to({text:TF.instance().socket.mySelf.getVariable("support_item").value},300,"Linear",!1);this.tweenTxtRsr(a,this.txtMic)}}},{key:"tweenTxtRsr",value:function(e,t){var n=this;this.timeStartTween=game.time.events.add(2*Phaser.Timer.SECOND,function(){e.start()},this),e.onUpdateCallback(function(){t.text=parseInt(t.text)},this),e.onComplete.add(function(){window.cordova&&"undefined"!=typeof device?(n.isWatchRewardVideo,n.tweenDestroy()):n.tweenDestroy()},this)}},{key:"tweenDestroy",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-1200*window.GameConfig.RESIZE},200,"Linear",!1);this.timeTweenDestroy=game.time.events.add(1*Phaser.Timer.SECOND,function(){t.start()},this),t.onComplete.add(function(){e.signalNextQuestion.dispatch(),e.destroy()},this)}},{key:"addBtnWatch",value:function(){this.btnWatching=new pt(this.positionPracticePopupConfig.btn_watch_video_reward,this.onClickWatching,this),this.btnWatching.anchor.set(.5,0);var e=new rt(this.positionPracticePopupConfig.btn_watch_video_reward.camera);this.btnWatching.addChild(e);var t=new _t(this.positionPracticePopupConfig.btn_watch_video_reward.txt1,this.positionPracticePopupConfig.btn_watch_video_reward.txt1.text),n=new _t(this.positionPracticePopupConfig.btn_watch_video_reward.txt2,this.positionPracticePopupConfig.btn_watch_video_reward.txt2.text);this.btnWatching.addChild(t),this.btnWatching.addChild(n),this.popup.addChild(this.btnWatching)}},{key:"onClickWatching",value:function(){this.isWatchRewardVideo=!0,this.btnWatching.inputEnabled=!1,this.btnContinue.inputEnabled=!1,this.signalStop.dispatch(),li.instance().showRewardVideoX2DiamondSoloMode()}},{key:"addTimeCountDown",value:function(e){this.timeCountDownThisWeekPractice=e,this.timeCounter=new Phaser.Text(game,this.positionRankingConfig.txt_timeCounter.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.text,this.positionRankingConfig.txt_timeCounter.configs),this.timer=game.time.create(!1),this.timer.loop(1e3,this.handleTimer,this),this.timer.start(),this.addChild(this.timeCounter)}},{key:"handleTimer",value:function(){this.timeCountDown>0&&(this.timeCountDown--,this.txtTimeout.setText("( ".concat(this.timeCountDown," )"))),0==this.timeCountDown&&(this.signalNextQuestion.dispatch(),this.destroy())}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialClosed.add(this.interstitialClosed,this),li.instance().event.rewardedVideoEnded.add(this.rewardedVideoEnded,this),li.instance().event.rewardedVideoClosed.add(this.rewardedVideoClosed,this),li.instance().event.interstitialFailedToLoad.add(this.interstitialFailedToLoad,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this),li.instance().event.interstitialShowFailed.add(this.interstitialShowFailed,this),ui.instance().event.share.add(this.onShared,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialClosed.remove(this.interstitialClosed,this),li.instance().event.rewardedVideoEnded.remove(this.rewardedVideoEnded,this),li.instance().event.rewardedVideoClosed.remove(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialFailedToLoad.remove(this.interstitialFailedToLoad,this),li.instance().event.interstitialShowFailed.remove(this.interstitialShowFailed,this),li.instance().event.rewardedVideoFailed.remove(this.rewardedVideoFailed,this),ui.instance().event.share.remove(this.onShared,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SOLO_MODE_GOT_REWARD_RESPONSE&&(LogConsole.log(e.params.getDump()),"OK"==e.params.getUtfString("status")&&this.makeAnimWhenClaimed())}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timeAnimGem),game.time.events.remove(this.timeStartTween),game.time.events.remove(this.timeTweenDestroy),null!==this.timer&&(this.timer.stop(),this.timer.destroy(),this.timer=null);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&fi(n.prototype,i),o&&fi(n,o),t}();function vi(e){return(vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bi(e,t){return!t||"object"!==vi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _i(e){return(_i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Si(e,t){return(Si=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ei=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=bi(this,_i(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),n.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),n.score=e,n.signalNextQuestion=new Phaser.Signal,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Si(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.timer=null,this.screenDim,this.tabGem,this.tabHeart,this.addScreenDim(),this.addGemAndHeart()}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabGem.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-n)/2+t.width+10*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(t)}},{key:"addHeartDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabHeart.width-n)/2-5,e.x=(this.tabHeart.width-n)/2+t.width+10,this.tabHeart.addChild(e),this.tabHeart.addChild(t)}},{key:"addPopup",value:function(){this.congraTxt,this.txtDetailReward,this.btnContinue,this.timeCountDown,this.txtTimeout;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.lineRewardPopup.x*window.GameConfig.RESIZE,1140*window.GameConfig.RESIZE,null),this.popup.addChild(e);var t=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,this.positionPracticePopupConfig.rewardPopup.nameSprite);this.popup.addChild(t),this.addChild(this.popup),this.addCongraTxt(),this.addTxtDetailReward(),this.addBtnContinue()}},{key:"makeTweenPopup",value:function(){game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.positionPracticePopupConfig.lineRewardPopup.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start()}},{key:"addCongraTxt",value:function(){this.congraTxt=new Phaser.Text(game,this.positionPracticePopupConfig.congrat_txt_not_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_not_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_not_reward.text,this.positionPracticePopupConfig.congrat_txt_not_reward.configs),this.congraTxt.anchor.set(.5,0),this.popup.addChild(this.congraTxt)}},{key:"addTxtDetailReward",value:function(){this.txtDetailReward=new Phaser.Text(game,this.positionPracticePopupConfig.txt_detail_not_reward.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_detail_not_reward.y*window.GameConfig.RESIZE,"".concat(this.positionPracticePopupConfig.txt_detail_not_reward.text1," ").concat(this.score," ").concat(this.positionPracticePopupConfig.txt_detail_not_reward.text2),this.positionPracticePopupConfig.txt_detail_not_reward.configs),this.txtDetailReward.anchor.set(.5,0),this.txtDetailReward.addColor("#ffa33a",19),this.txtDetailReward.addColor("#333333",22),this.popup.addChild(this.txtDetailReward)}},{key:"addBtnContinue",value:function(){this.btnContinue=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue.nameAtlas,this.positionPracticePopupConfig.btn_continue.nameSprite),this.btnContinue.anchor.set(.5,0);var e=new Phaser.Text(game,this.positionPracticePopupConfig.txt_btn_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.text,this.positionPracticePopupConfig.txt_btn_continue.configs);e.anchor.set(.5,0),this.btnContinue.inputEnabled=!0,this.btnContinue.events.onInputUp.add(this.onClickContinue,this),this.btnContinue.addChild(e),this.timeCountDown=9,this.txtTimeout=new Phaser.Text(game,this.positionPracticePopupConfig.txt_timeout_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_timeout_continue.y*window.GameConfig.RESIZE,"( ".concat(this.timeCountDown," )"),this.positionPracticePopupConfig.txt_timeout_continue.configs),this.btnContinue.addChild(this.txtTimeout),this.timer=game.time.create(!1),this.timer.loop(1e3,this.handleTimer,this),this.timer.start(),this.popup.addChild(this.btnContinue)}},{key:"onClickContinue",value:function(){var e=this;ce.instance().playSound(ce.buttonclick);var t=game.add.tween(this.popup).to({y:-1200*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.signalNextQuestion.dispatch(),e.destroy()},this)}},{key:"addTimeCountDown",value:function(e){this.timeCountDownThisWeekPractice=e,this.timeCounter=new Phaser.Text(game,this.positionRankingConfig.txt_timeCounter.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.text,this.positionRankingConfig.txt_timeCounter.configs),this.timer=game.time.create(!1),this.timer.loop(1e3,this.handleTimer,this),this.timer.start(),this.addChild(this.timeCounter)}},{key:"handleTimer",value:function(){this.timeCountDown>0&&(this.timeCountDown--,this.txtTimeout.setText("( ".concat(this.timeCountDown," )"))),0==this.timeCountDown&&(this.signalNextQuestion.dispatch(),this.destroy())}},{key:"destroy",value:function(){for(null!==this.timer&&(this.timer.stop(),this.timer.destroy(),this.timer=null);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&wi(n.prototype,i),o&&wi(n,o),t}();function Ci(e){return(Ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ki(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pi(e,t){return!t||"object"!==Ci(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oi(e){return(Oi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ri(e,t){return(Ri=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xi=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Pi(this,Oi(t).call(this,game))).event={tweenGemPls:new Phaser.Signal},n.reward=e,n.definedPosition(),n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ri(e,t)}(t,Phaser.Group),n=t,(i=[{key:"definedPosition",value:function(){this.pointsArrayGem1=[{x:320*window.GameConfig.RESIZE,y:361*window.GameConfig.RESIZE},{x:379*window.GameConfig.RESIZE,y:240*window.GameConfig.RESIZE},{x:619*window.GameConfig.RESIZE,y:192*window.GameConfig.RESIZE},{x:443*window.GameConfig.RESIZE,y:101*window.GameConfig.RESIZE}],this.pointsArrayGem2=[{x:520*window.GameConfig.RESIZE,y:361*window.GameConfig.RESIZE},{x:480*window.GameConfig.RESIZE,y:432*window.GameConfig.RESIZE},{x:321*window.GameConfig.RESIZE,y:352*window.GameConfig.RESIZE},{x:443*window.GameConfig.RESIZE,y:101*window.GameConfig.RESIZE}],this.pointsArrayGem3=[{x:560*window.GameConfig.RESIZE,y:361*window.GameConfig.RESIZE},{x:818*window.GameConfig.RESIZE,y:343*window.GameConfig.RESIZE},{x:321*window.GameConfig.RESIZE,y:352*window.GameConfig.RESIZE},{x:443*window.GameConfig.RESIZE,y:101*window.GameConfig.RESIZE}],this.pointsArrayGem4=[{x:320*window.GameConfig.RESIZE,y:361*window.GameConfig.RESIZE},{x:377*window.GameConfig.RESIZE,y:558*window.GameConfig.RESIZE},{x:83*window.GameConfig.RESIZE,y:395*window.GameConfig.RESIZE},{x:443*window.GameConfig.RESIZE,y:101*window.GameConfig.RESIZE}],this.arrParentGems=[this.pointsArrayGem1,this.pointsArrayGem2,this.pointsArrayGem3,this.pointsArrayGem4]}},{key:"afterInit",value:function(){0!==this.reward&&this.addIconGem()}},{key:"addIconGem",value:function(){var e=this;ce.instance().playSound(ce.takereward),this.gem_big=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,375*window.GameConfig.RESIZE,"otherSprites","Gem_Big"),this.gem_big.anchor.set(.5),this.gem_big.scale.set(.3),this.txtReward=new Phaser.Text(game,320*window.GameConfig.RESIZE,210*window.GameConfig.RESIZE,"+".concat(this.reward),{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:30}),this.txtReward.anchor.set(.5),this.addChild(this.txtReward),game.add.tween(this.gem_big.scale).to({x:1,y:1},300,Phaser.Easing.Linear.In,!1).start();var t=game.add.tween(this.gem_big).to({alpha:1},1e3,Phaser.Easing.Linear.In,!1);t.start();var n=.1;t.onUpdateCallback(function(){e.gem_big.rotation+=n,e.gem_big.rotation>.2?n=-.07:e.gem_big.rotation<-.2&&(n=.07)},this),t.onComplete.add(function(){e.gem_big.rotation=0;var t=game.add.tween(e.gem_big.scale).to({x:.5,y:.5},300,Phaser.Easing.Linear.In,!1);t.start(),t.onComplete.add(function(){e.gem_big.destroy()},e);var n={diamond:parseInt(e.txtReward.text)},i=game.add.tween(n).to({diamond:0},600,"Linear",!1);i.start(),i.onUpdateCallback(function(){e.txtReward.text="+"+parseInt(n.diamond)},e),i.onComplete.add(function(){e.event.tweenGemPls.dispatch(),e.txtReward.destroy()},e),e.addGemMoveCurve()},this),this.addStarNim(),this.addChild(this.gem_big)}},{key:"addStarNim",value:function(){var e=new Phaser.Sprite(game,0,0,"SoloModeStar");e.anchor.set(.5),e.scale.set(1.5);e.animations.add("run_star");e.animations.play("run_star",30,!0),this.gem_big.addChild(e)}},{key:"addGemMoveCurve",value:function(){for(var e=this,t=function(t){var n=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,361*window.GameConfig.RESIZE,"practicePopupSprites","GEM");n.scale.set(2),n.anchor.set(.5),e.addChild(n),setTimeout(function(){game.add.tween(n.scale).to({x:1,y:1},800,Phaser.Easing.Linear.In,!1).start();var i=game.add.tween(n).to({x:[320*window.GameConfig.RESIZE,e.arrParentGems[t][1].x,e.arrParentGems[t][2].x,235*window.GameConfig.RESIZE],y:[361*window.GameConfig.RESIZE,e.arrParentGems[t][1].y,e.arrParentGems[t][2].y,65*window.GameConfig.RESIZE]},800,Phaser.Easing.Linear.In,!1,0,0).interpolation(function(e,t){return Phaser.Math.bezierInterpolation(e,t)});i.start(),i.onComplete.add(function(){n.destroy()})},100*t)},n=0;n<this.arrParentGems.length;n++)t(n)}}])&&ki(n.prototype,i),o&&ki(n,o),t}();function Ti(e){return(Ti="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ii(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ai(e,t){return!t||"object"!==Ti(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Li(e){return(Li=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gi(e,t){return(Gi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Di=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Ai(this,Li(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),o.score=e,o.reward=n,o.playlist=i,o.isWatchRewardVideo=!1,o.isWatchRewardVideoDone=!1,o.event={goHome:new Phaser.Signal,getRank:new Phaser.Signal,claim:new Phaser.Signal,stopSong:new Phaser.Signal},o.targetTween=o.positionPracticePopupConfig.lineRewardPopup.y,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gi(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.timer=null,this.screenDim,this.tabGem,this.tabHeart,this.addScreenDim(),this.addGemAndHeart(),this.addEventExtension()}},{key:"interstitialClosed",value:function(){this.tweenDestroy()}},{key:"interstitialShowFailed",value:function(){this.tweenDestroy()}},{key:"rewardedVideoEnded",value:function(){}},{key:"rewardedVideoClosed",value:function(){}},{key:"rewardedVideoRewardReceived",value:function(){this.isWatchRewardVideoDone=!0,this.event.claim.dispatch(1)}},{key:"interstitialFailedToLoad",value:function(){this.tweenDestroy()}},{key:"rewardedVideoFailed",value:function(){this.btnClaimNotWatch.inputEnabled=!0,this.btnWatching.inputEnabled=!0}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e;this.txtGemReceived,e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),this.txtGemReceived=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txt.configs);var t=e.width+this.txtGemReceived.width;this.txtGemReceived.x=(this.tabGem.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-t)/2+this.txtGemReceived.width+10*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(this.txtGemReceived)}},{key:"addHeartDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txt.configs);var n=e.width+t.width;t.x=(this.tabHeart.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-n)/2+t.width+10*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(t)}},{key:"addPopup",value:function(){this.congraTxt,this.txtDetailReward,this.btnClaimNotWatch,this.timeCountDown,this.txtTimeout,this.iconGem;var e=new Phaser.Sprite(game,this.positionPracticePopupConfig.popup_confirm_top_bg.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.popup_confirm_top_bg.nameAtlas,this.positionPracticePopupConfig.popup_confirm_top_bg.nameSprite);if(this.popup=new Phaser.Sprite(game,this.positionPracticePopupConfig.lineRewardPopup.x*window.GameConfig.RESIZE,1140*window.GameConfig.RESIZE,null),this.popup.addChild(e),0==this.reward){var t=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,this.positionPracticePopupConfig.rewardPopup.nameSprite);this.popup.addChild(t)}else{var n=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,"Box");n.scale.set(1,567/593);var i=new Phaser.Sprite(game,0,0,this.positionPracticePopupConfig.rewardPopup.nameAtlas,this.positionPracticePopupConfig.rewardPopup.nameSprite);this.popup.addChild(n),this.popup.addChild(i)}this.addChild(this.popup),this.addCongraTxt(),this.addTxtDetailReward(),this.addIconCircle(),this.addBtnShare(),this.addBtnHome(),this.addBtnRank(),this.addFireWork(),0!==this.reward?(this.addBtnClaim(),this.addBtnWatch(),this.moveChildOfPopup(),this.checkDevice()):(li.instance().showInterstitialDoneSoloMode(),this.changePosChild())}},{key:"addBtnShare",value:function(){this.btnShare=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_fb_share.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_fb_share.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_fb_share.nameAtlas,this.positionPracticePopupConfig.btn_fb_share.nameSprite),this.btnShare.anchor.set(.5,0),this.btnShare.inputEnabled=!0,this.btnShare.events.onInputUp.add(this.onClickShare,this),this.popup.addChild(this.btnShare)}},{key:"onClickShare",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"onShared",value:function(){}},{key:"checkDevice",value:function(){window.cordova&&"undefined"!=typeof device||(this.btnWatching.inputEnabled=!1)}},{key:"moveChildOfPopup",value:function(){this.targetTween-=70,this.congraTxt.y+=70,this.txtDetailReward.y+=70,this.btnShare.y+=70,this.btnRank.y+=70}},{key:"changePosChild",value:function(){this.btnRank.revive(),this.btnShare.kill(),this.btnHome.revive()}},{key:"makeTweenPopup",value:function(){var e=this;ce.instance().playSound(ce.getrewardsolomode);var t=game.add.tween(this.popup).to({y:(game.height-z.instance().STANDARD_HEIGHT+this.targetTween)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);t.start(),t.onComplete.add(function(){0!==e.reward&&e.addAnimGem()},this)}},{key:"addGemFly",value:function(){this.gemIcon=new xi(this.reward),this.gemIcon.event.tweenGemPls.add(this.tweenGemPls,this),this.addChild(this.gemIcon)}},{key:"addAnimGem",value:function(){this.sSGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.anim_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.anim_gem.nameSprite),this.sSGem.anchor.set(.5),this.animGem=this.sSGem.animations.add("animGemReward"),this.animGem.enableUpdate=!0,this.animGem.onUpdate.add(this.onUpdateGemReward,this),this.animGem.play(35,!1,!1),this.popup.addChild(this.sSGem)}},{key:"onUpdateGemReward",value:function(e,t){58===t.index&&(e.frame=42)}},{key:"tweenGemPls",value:function(){var e=this,t=game.add.tween(this.txtGemReceived).to({text:TF.instance().dataMySeft.diamond},1e3,"Linear",!1);t.start(),t.onUpdateCallback(function(){e.txtGemReceived.text=parseInt(e.txtGemReceived.text)},this),t.onComplete.add(function(){e.event.goHome.dispatch()})}},{key:"addCongraTxt",value:function(){this.congraTxt=new Phaser.Text(game,this.positionPracticePopupConfig.congrat_txt_reward.x*window.GameConfig.RESIZE,70*window.GameConfig.RESIZE,this.positionPracticePopupConfig.congrat_txt_reward.text,this.positionPracticePopupConfig.congrat_txt_reward.configs),this.congraTxt.anchor.set(.5,0),this.popup.addChild(this.congraTxt)}},{key:"addTxtDetailReward",value:function(){this.txtDetailReward=new Phaser.Text(game,this.positionPracticePopupConfig.txt_detail_reward.x*window.GameConfig.RESIZE,135*window.GameConfig.RESIZE,"Bạn đã hoàn thành phần thử thách của playlist ".concat(this.playlist.name),{font:"GilroyMedium",fill:"#333333",align:"center",wordWrap:!0,wordWrapWidth:450,fontSize:24}),this.txtDetailReward.anchor.set(.5,0),this.txtDetailReward.addColor("#ffa33a",45),this.popup.addChild(this.txtDetailReward)}},{key:"addIconCircle",value:function(){if(0!==this.reward){this.iconCircle=new Phaser.Sprite(game,this.positionPracticePopupConfig.icon_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.icon_gem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.icon_gem.nameAtlas,this.positionPracticePopupConfig.icon_gem.nameSprite),this.iconCircle.anchor.set(.5);var e=new Phaser.Text(game,this.positionPracticePopupConfig.reward_icon_gem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.reward_icon_gem.y*window.GameConfig.RESIZE,"+".concat(this.reward),this.positionPracticePopupConfig.reward_icon_gem.configs);e.anchor.set(.5,0),game.time.events.loop(10,this.animationUpdateCircle,this),this.popup.addChild(this.iconCircle),this.popup.addChild(e)}}},{key:"animationUpdateCircle",value:function(){this.iconCircle.angle+=3}},{key:"addBtnHome",value:function(){this.btnHome=new Phaser.Button(game,33*window.GameConfig.RESIZE,265*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_home_practice56.nameAtlas,this.onClickHome,this,null,this.positionPracticePopupConfig.btn_home_practice56.nameSprite),0!==this.reward&&(this.btnHome.inputEnabled=!1,this.btnHome.alpha=.5),this.popup.addChild(this.btnHome),this.btnHome.kill()}},{key:"onClickHome",value:function(){ce.instance().playSound(ce.buttonclick),this.event.goHome.dispatch(),this.destroy()}},{key:"addBtnRank",value:function(){this.btnFoundametal=new Phaser.Sprite(game,149*window.GameConfig.RESIZE,265*window.GameConfig.RESIZE,null),this.btnRank=new Phaser.Button(game,0,0,this.positionPracticePopupConfig.btn_rank_practice56.nameAtlas,this.onClickRank,this,null,this.positionPracticePopupConfig.btn_rank_practice56.nameSprite);var e=new rt(this.positionPracticePopupConfig.icon_rank);this.btnRank.addChild(e);var t=new _t(this.positionPracticePopupConfig.txt_icon_rank,this.positionPracticePopupConfig.txt_icon_rank.text);this.btnRank.addChild(t);var n=new Phaser.Sprite(game,80*window.GameConfig.RESIZE,11*window.GameConfig.RESIZE,"btnRankAnim");this.btnRank.addChild(n);n.animations.add("run_rank");n.animations.play("run_rank",26,!0),this.btnFoundametal.addChild(this.btnRank),this.popup.addChild(this.btnFoundametal),this.btnRank.kill()}},{key:"onClickRank",value:function(){ce.instance().playSound(ce.buttonclick),this.event.getRank.dispatch()}},{key:"addBtnClaim",value:function(){this.btnClaimNotWatch=new Phaser.Sprite(game,this.positionPracticePopupConfig.btn_continue_reward56.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue_reward56.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.btn_continue_reward56.nameAtlas,this.positionPracticePopupConfig.btn_continue_reward56.nameSprite),this.btnClaimNotWatch.anchor.set(.5,0);var e=new Phaser.Text(game,this.positionPracticePopupConfig.txt_btn_continue.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txt_btn_continue.y*window.GameConfig.RESIZE,"NHẬN",this.positionPracticePopupConfig.txt_btn_continue.configs);e.anchor.set(.5,0),this.btnClaimNotWatch.inputEnabled=!0,this.btnClaimNotWatch.events.onInputUp.add(this.onClickClaim,this),this.btnClaimNotWatch.addChild(e),this.popup.addChild(this.btnClaimNotWatch)}},{key:"onClickClaim",value:function(){this.isWatchRewardVideo=!1,this.btnClaimNotWatch.inputEnabled=!1,this.btnWatching.inputEnabled=!1,this.event.stopSong.dispatch(),this.event.claim.dispatch(0)}},{key:"addBtnWatch",value:function(){this.btnWatching=new pt(this.positionPracticePopupConfig.btn_watch_video_reward56,this.onClickWatching,this),this.btnWatching.anchor.set(.5,0);var e=new rt(this.positionPracticePopupConfig.btn_watch_video_reward56.camera);this.btnWatching.addChild(e);var t=new _t(this.positionPracticePopupConfig.btn_watch_video_reward56.txt1,this.positionPracticePopupConfig.btn_watch_video_reward56.txt1.text),n=new _t(this.positionPracticePopupConfig.btn_watch_video_reward56.txt2,this.positionPracticePopupConfig.btn_watch_video_reward56.txt2.text);this.btnWatching.addChild(t),this.btnWatching.addChild(n),this.popup.addChild(this.btnWatching)}},{key:"onClickWatching",value:function(){this.isWatchRewardVideo=!0,this.btnClaimNotWatch.inputEnabled=!1,this.btnWatching.inputEnabled=!1,this.event.stopSong.dispatch(),li.instance().showRewardVideoX2DiamondSoloMode()}},{key:"addFireWork",value:function(){var e=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,350*window.GameConfig.RESIZE,"firework");e.anchor.set(.5),e.scale.set(1),this.addChild(e);e.animations.add("run_win");e.animations.play("run_win",40,!0)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SOLO_MODE_GOT_REWARD_RESPONSE&&(LogConsole.log(e.params.getDump()),"OK"==e.params.getUtfString("status")&&(this.addGemFly(),this.btnClaimNotWatch.alpha=.5,this.btnWatching.alpha=.5,this.btnHome.inputEnabled=!0,this.btnHome.alpha=1))}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialClosed.add(this.interstitialClosed,this),li.instance().event.rewardedVideoEnded.add(this.rewardedVideoEnded,this),li.instance().event.rewardedVideoClosed.add(this.rewardedVideoClosed,this),li.instance().event.interstitialFailedToLoad.add(this.interstitialFailedToLoad,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this),li.instance().event.interstitialShowFailed.add(this.interstitialShowFailed,this),ui.instance().event.share.add(this.onShared,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialClosed.remove(this.interstitialClosed,this),li.instance().event.rewardedVideoEnded.remove(this.rewardedVideoEnded,this),li.instance().event.rewardedVideoClosed.remove(this.rewardedVideoRewardReceived,this),li.instance().event.interstitialFailedToLoad.remove(this.interstitialFailedToLoad,this),li.instance().event.interstitialShowFailed.remove(this.interstitialShowFailed,this),ui.instance().event.share.remove(this.onShared,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),null!==this.timer&&(this.timer.stop(),this.timer.destroy(),this.timer=null);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Ii(n.prototype,i),o&&Ii(n,o),t}();function Mi(e){return(Mi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ni(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bi(e){return(Bi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ji(e,t){return(ji=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ui(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Fi=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Bi(t).call(this,game,0,0,null))||"object"!==Mi(i)&&"function"!=typeof i?Ui(n):i).event={close:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.topBg=new rt(e.positionPopup.popup_confirm_top_bg),e.addChild(e.topBg),e.bgText=new Zt(e.positionPopup.popup_confirm_bg_text),e.addChild(e.bgText),e.txtContent=new _t(e.positionPopup.popup_confirm_text_content,o),e.txtContent.setTextBounds(0,0,920*z.instance().scale,e.bgText.height),e.addChild(e.txtContent),e.btnClose=new pt(e.positionPopup.popup_close_btn_exit,e.chooseClose,Ui(Ui(e))),e.btnClose.x=e.topBg.width-e.btnClose.width/2,e.btnClose.y=-e.btnClose.height/3,e.addChild(e.btnClose),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ji(e,t)}(t,Mt),n=t,(i=[{key:"setHeight",value:function(e){this.bgText.height=e,this.txtContent.setTextBounds(0,0,920*z.instance().scale,this.bgText.height-30*z.instance().scale)}},{key:"chooseClose",value:function(){LogConsole.log("chooseClose"),this.event.close.dispatch()}}])&&Ni(n.prototype,i),o&&Ni(n,o),t}();function Zi(e){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qi(e,t){return!t||"object"!==Zi(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vi(e){return(Vi=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wi(e,t){return(Wi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qi=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Qi(this,Vi(t).call(this,game))).quest=e,n.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),n.eventInput={claim:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wi(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.screenDim,this.popup,this.addScreenDim(),this.addPopup(),this.addEventExtension(),Le.instance().logEvent(Le.Popup_Quest)}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addPopup",value:function(){this.txtPopup,this.rewardClaimed,this.txtQuestReward,this.btnClaim,this.popup=new Fi,this.popup.x=35*window.GameConfig.RESIZE,this.popup.y=1136*window.GameConfig.RESIZE,this.popup.setHeight(400*window.GameConfig.RESIZE),this.popup.event.close.add(this.onClose,this),this.addTxtPopup(),this.addRewardClaimed(),this.addTxtQuestReward(),this.addBtnClaim(),this.addChild(this.popup)}},{key:"addTxtPopup",value:function(){this.txtPopup=new Phaser.Text(game,this.positionQAndAConfig.txtPopupClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.txtPopupClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.txtPopupClaim.text,this.positionQAndAConfig.txtPopupClaim.configs),this.txtPopup.anchor.set(.5,0),this.popup.addChild(this.txtPopup)}},{key:"addRewardClaimed",value:function(){if(this.rewardClaimed=new Phaser.Text(game,this.positionQAndAConfig.rewardClaimed.x*window.GameConfig.RESIZE,this.positionQAndAConfig.rewardClaimed.y*window.GameConfig.RESIZE,this.quest.reward,this.positionQAndAConfig.rewardClaimed.configs),"DIAMOND"==this.quest.reward_type)(e=new Phaser.Sprite(game,this.positionQAndAConfig.gemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.gemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.gemClaim.nameAtlas,this.positionQAndAConfig.gemClaim.nameSprite)).scale.set(1.2);else if("TICKET"==this.quest.reward_type){(e=new Phaser.Sprite(game,this.positionQAndAConfig.ticketClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.ticketClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.ticketClaim.nameAtlas,this.positionQAndAConfig.ticketClaim.nameSprite)).scale.set(1.2)}else{var e;(e=new Phaser.Sprite(game,this.positionQAndAConfig.sptItemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.sptItemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.sptItemClaim.nameAtlas,this.positionQAndAConfig.sptItemClaim.nameSprite)).scale.set(1.2)}var t=this.rewardClaimed.width+e.width;this.rewardClaimed.x=(570*window.GameConfig.RESIZE-t)/2-5*window.GameConfig.RESIZE,e.x=(570*window.GameConfig.RESIZE-t)/2+this.rewardClaimed.width+5*window.GameConfig.RESIZE,this.popup.addChild(this.rewardClaimed),this.popup.addChild(e)}},{key:"addTxtQuestReward",value:function(){this.txtQuestReward=new Phaser.Text(game,this.positionQAndAConfig.questReward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.questReward.y*window.GameConfig.RESIZE,this.quest.quest,this.positionQAndAConfig.questReward.configs),this.txtQuestReward.anchor.set(.5,0),this.popup.addChild(this.txtQuestReward)}},{key:"addBtnClaim",value:function(){var e=this;this.btnClaim=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,295*window.GameConfig.RESIZE,"questAndAchieveSprites","Button_Nhan_popup"),this.btnClaim.anchor.set(.5,0);var t=new Phaser.Text(game,0,27*window.GameConfig.RESIZE,"NHẬN",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:30});t.anchor.set(.5,0),this.btnClaim.addChild(t),this.btnClaim.inputEnabled=!0,this.btnClaim.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick);var t=game.add.tween(e.popup).to({y:-249*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.eventInput.claim.dispatch(),e.destroy()},e)},this),this.popup.addChild(this.btnClaim)}},{key:"makeTweenPopup",value:function(){var e=this;ce.instance().playSound(ce.popupfinishquest);var t=game.add.tween(this.popup).to({y:(game.height-776)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);t.start(),t.onComplete.add(function(){if(z.instance().playScript.playing_guide==en.DONE_TURNBASE){var t=new en;e.addChild(t),t.event.step5.add(e.step5ReceiveFristReward,e),t.addStep5ReceiveFirstReward()}},this)}},{key:"step5ReceiveFristReward",value:function(){this.eventInput.claim.dispatch(),this.destroy()}},{key:"onClose",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-420*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.destroy()},this),this.popup.event.close.remove(this.onClose,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.PLAY_SCRIPT_DONE_ALL_RESPONSE&&"OK"==e.params.getUtfString("status")&&(z.instance().playScript.playing_guide=en.DONE_ALL,this.destroy())}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Hi(n.prototype,i),o&&Hi(n,o),t}();function Ki(e){return(Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yi(e,t){return!t||"object"!==Ki(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ji(e){return(Ji=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xi(e,t){return(Xi=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $i=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Yi(this,Ji(t).call(this,game,0,0,null))).positionPopup=e.mainData.positionPopup,e.topBg=new rt(e.positionPopup.popup_confirm_top_bg),e.addChild(e.topBg),e.bgText=new Zt(e.positionPopup.popup_confirm_bg_text),e.addChild(e.bgText),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xi(e,t)}(t,Mt),n=t,(i=[{key:"setHeight",value:function(e){this.bgText.height=e}},{key:"setWidth",value:function(e){this.bgText.width=e,this.topBg.width=e}},{key:"width",get:function(){return this.topBg.width}}])&&zi(n.prototype,i),o&&zi(n,o),t}();function eo(e){return(eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function to(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function no(e,t){return!t||"object"!==eo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function io(e){return(io=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oo(e,t){return(oo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ao=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=no(this,io(t).call(this,game))).achievement=e,n.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),n.eventInput={claim:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oo(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.screenDim,this.popup,this.addScreenDim(),this.addPopup()}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addPopup",value:function(){this.txtPopup,this.rewardClaimed,this.txtQuestReward,this.btnClaim,this.medal,this.congraTxt,this.popup=new $i,this.popup.x=35*window.GameConfig.RESIZE,this.popup.y=1140*window.GameConfig.RESIZE,this.popup.setHeight(486*window.GameConfig.RESIZE),this.addChild(this.popup),this.addTxtPopup(),this.addCongraTxt(),this.addRewardClaimed(),this.addAchievementTitle(),this.addBtnClaim(),this.addMedal(),this.addFireWork(),this.loadMedal(this.achievement.medal),Le.instance().logEvent(Le.Popup_Achievement)}},{key:"addTxtPopup",value:function(){this.txtPopup=new Phaser.Text(game,this.positionQAndAConfig.achievement.txtPopupClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.txtPopupClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.txtPopupClaim.text,this.positionQAndAConfig.achievement.txtPopupClaim.configs),this.txtPopup.anchor.set(.5,0);var e=new _t(this.positionQAndAConfig.achievement.txt_phan_thuonng,this.positionQAndAConfig.achievement.txt_phan_thuonng.text);e.anchor.set(.5,0),this.popup.addChild(e),this.popup.addChild(this.txtPopup)}},{key:"addCongraTxt",value:function(){this.congraTxt=new Phaser.Text(game,this.positionQAndAConfig.achievement.congrat_txt_reward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.congrat_txt_reward.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.congrat_txt_reward.text,this.positionQAndAConfig.achievement.congrat_txt_reward.configs),this.congraTxt.anchor.set(.5,0),this.popup.addChild(this.congraTxt)}},{key:"addRewardClaimed",value:function(){if(this.rewardClaimed=new Phaser.Text(game,this.positionQAndAConfig.achievement.rewardClaimed.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.rewardClaimed.y*window.GameConfig.RESIZE,this.achievement.reward,this.positionQAndAConfig.achievement.rewardClaimed.configs),"DIAMOND"==this.achievement.reward_type)(e=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.gemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.gemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.gemClaim.nameAtlas,this.positionQAndAConfig.achievement.gemClaim.nameSprite)).scale.set(1.2);else if("TICKET"==this.achievement.reward_type){(e=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.ticketClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.ticketClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.ticketClaim.nameAtlas,this.positionQAndAConfig.achievement.ticketClaim.nameSprite)).scale.set(1.2)}else{var e;(e=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.sptItemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.sptItemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.sptItemClaim.nameAtlas,this.positionQAndAConfig.achievement.sptItemClaim.nameSprite)).scale.set(1.2)}var t=this.rewardClaimed.width+e.width;this.rewardClaimed.x=(570*window.GameConfig.RESIZE-t)/2-5*window.GameConfig.RESIZE,e.x=(570*window.GameConfig.RESIZE-t)/2+this.rewardClaimed.width+5*window.GameConfig.RESIZE,this.popup.addChild(this.rewardClaimed),this.popup.addChild(e)}},{key:"addAchievementTitle",value:function(){this.txtQuestReward=new Phaser.Text(game,this.positionQAndAConfig.achievement.achievement_title.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.achievement_title.y*window.GameConfig.RESIZE,this.achievement.title,this.positionQAndAConfig.achievement.achievement_title.configs),this.txtQuestReward.anchor.set(.5,0),this.popup.addChild(this.txtQuestReward)}},{key:"addBtnClaim",value:function(){var e=this;this.btnClaim=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,385*window.GameConfig.RESIZE,"practicePopupSprites","Button_Tiep_Tuc"),this.btnClaim.anchor.set(.5,0);var t=new Phaser.Text(game,0,21*window.GameConfig.RESIZE,"NHẬN",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:31});t.anchor.set(.5,0),this.btnClaim.addChild(t),this.btnClaim.inputEnabled=!0,this.btnClaim.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick);var t=game.add.tween(e.popup).to({y:-420*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.eventInput.claim.dispatch(),e.destroy()},e)},this),this.popup.addChild(this.btnClaim)}},{key:"addMedal",value:function(){this.medal=new rt(this.positionQAndAConfig.achievement.medal_popup),this.medal.anchor.set(.5),this.medal.scale.set(.6),this.popup.addChild(this.medal)}},{key:"loadMedal",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"onLoad",value:function(){try{this.medal.loadTexture("".concat(this.key))}catch(e){}}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"addFireWork",value:function(){var e=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,355*window.GameConfig.RESIZE,"firework");e.anchor.set(.5),this.addChild(e);e.animations.add("run_win");e.animations.play("run_win",40,!0)}},{key:"makeTweenPopup",value:function(){ce.instance().playSound(ce.popupfinishachievement),game.add.tween(this.popup).to({y:(game.height-781)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start()}},{key:"onClose",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-420*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.destroy()},this),this.popup.event.close.remove(this.onClose,this)}}])&&to(n.prototype,i),o&&to(n,o),t}();function so(e){return(so="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ro(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lo(e,t){return!t||"object"!==so(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ho(e){return(ho=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function co(e,t){return(co=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var uo=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),lo(this,ho(t).call(this,game,e,n,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&co(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"add",value:function(e){this.addChild(e)}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&ro(n.prototype,i),o&&ro(n,o),t}();function fo(e){return(fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function po(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function go(e,t){return!t||"object"!==fo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yo(e){return(yo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mo(e,t){return(mo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vo=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=go(this,yo(t).call(this,game,e,n,null))).dailyRewardConfig=JSON.parse(game.cache.getText("dailyRewardConfig")),a.configs=i,a.state=o,a.afterInit(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mo(e,t)}(t,Phaser.Sprite),n=t,o=[{key:"DIAMOND",get:function(){return"DIAMOND"}},{key:"SUPPORT_ITEM",get:function(){return"SUPPORT_ITEM"}},{key:"TICKET",get:function(){return"TICKET"}},{key:"INIT",get:function(){return"INIT"}},{key:"NOT_INIT",get:function(){return"NOT_INIT"}},{key:"REWARDED",get:function(){return"REWARDED"}}],(i=[{key:"afterInit",value:function(){this.box,this.resourceSprite,this.rewardTxt,this.day,LogConsole.log(this.configs),this.addBox(),this.addResourceSprite(),this.addRewardTxt(),this.addDay()}},{key:"addBox",value:function(){LogConsole.log("addBox"),this.state==t.INIT?(this.box=new rt(this.dailyRewardConfig.daily_reward.box_init),this.addChild(this.box)):(this.box=new rt(this.dailyRewardConfig.daily_reward.box),this.addChild(this.box))}},{key:"addResourceSprite",value:function(){var e=this;if(LogConsole.log("addResourceSprite"),this.configs.reward_type==t.DIAMOND?(this.resourceSprite=new rt(this.dailyRewardConfig.daily_reward.resource.diamond),this.resourceSprite.anchor.set(.5),this.addChild(this.resourceSprite)):this.configs.reward_type==t.SUPPORT_ITEM?(this.resourceSprite=new rt(this.dailyRewardConfig.daily_reward.resource.spt_item),this.resourceSprite.anchor.set(.5),this.addChild(this.resourceSprite)):(this.resourceSprite=new rt(this.dailyRewardConfig.daily_reward.resource.ticket),this.resourceSprite.anchor.set(.5),this.addChild(this.resourceSprite)),this.state==t.INIT){this.tweenParent=game.add.tween(this.resourceSprite).to({alpha:1},1e3,Phaser.Easing.Linear.In,!0),this.tweenParent.loop();var n=.1;this.tweenParent.onUpdateCallback(function(){e.resourceSprite.rotation+=n,e.resourceSprite.rotation>.2?n=-.07:e.resourceSprite.rotation<-.2&&(n=.07)},this)}}},{key:"addRewardTxt",value:function(){LogConsole.log("addRewardTxt"),this.state==t.REWARDED?(this.rewardTxt=new rt(this.dailyRewardConfig.daily_reward.icon_rewarded),this.rewardTxt.anchor.set(.5),this.addChild(this.rewardTxt)):(this.rewardTxt=new Phaser.Text(game,this.dailyRewardConfig.daily_reward.txt_reward.x*window.GameConfig.RESIZE,this.dailyRewardConfig.daily_reward.txt_reward.y*window.GameConfig.RESIZE,this.configs.reward,this.dailyRewardConfig.daily_reward.txt_reward.style),this.rewardTxt.anchor.set(.5,0),this.addChild(this.rewardTxt))}},{key:"addDay",value:function(){LogConsole.log("addDay"),this.day=new Phaser.Text(game,this.dailyRewardConfig.daily_reward.txt_day.x*window.GameConfig.RESIZE,this.dailyRewardConfig.daily_reward.txt_day.y*window.GameConfig.RESIZE,"".concat(this.dailyRewardConfig.daily_reward.txt_day.text).concat(this.configs.day),this.dailyRewardConfig.daily_reward.txt_day.style),this.day.anchor.set(.5,0),this.addChild(this.day)}},{key:"changeRewarded",value:function(){this.tweenParent.stop(),this.resourceSprite.rotation=0,this.rewardTxt.destroy(),this.rewardTxt=null,this.rewardTxt=new rt(this.dailyRewardConfig.daily_reward.icon_rewarded),this.rewardTxt.anchor.set(.5),this.addChild(this.rewardTxt)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&po(n.prototype,i),o&&po(n,o),t}(),wo={AUTO_DETECT_THRESHOLD:8};function bo(e,t){return e["nominal".concat((n=t,n.charAt(0).toUpperCase()+n.slice(1)))]||e[t];var n}function _o(e,t,n){if("onInputUp"!=n||!function(e){var t=Math.abs(e.positionDown.x-e.positionUp.x),n=Math.abs(e.positionDown.y-e.positionUp.y);return e.timeUp,e.timeDown,t>wo.AUTO_DETECT_THRESHOLD||n>wo.AUTO_DETECT_THRESHOLD}(e)){var i=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return!1;for(var o=0;o<t.length;o++){var a=t[o];if(a){if(n.call(i,a))return a;var s=e(a.children,n,i);if(s)return s}}return!1}(t,function(t){var n=t.worldPosition,i=t.anchor,o=t.pivot,a=t.width,s=t.height,r=t.scale,l=n.x-(i?i.x*a:0)-o.x*r.x,h=n.y-(i?i.y*s:0)-o.y*r.y;return t.inputEnabled&&new Phaser.Rectangle(l,h,t.width,t.height).contains(e.x,e.y)});return i&&i.events&&i.events[n]&&i.events[n].dispatch&&i.events[n].dispatch(i,e,!0),i}}function So(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Eo={direction:"y",autocull:!0,padding:10},Co=function(){function e(t,n,i){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.parent=n,this.bounds=i,this.idx=0,this.o=this.options=Object.assign({},Eo,o),this.items=[],"y"==this.o.direction?this.p={xy:"y",wh:"height"}:this.p={xy:"x",wh:"width"},this.grp=this.game.add.group(n),this.grp.position.set(i.x,i.y),this.events={onAdded:new Phaser.Signal,changeIndex:new Phaser.Signal},this.position=0,this.grp.mask=this._addMask(i)}var t,n,i;return t=e,(n=[{key:"add",value:function(e){this.items.push(e);var t=0;if(this.grp.children.length>0){var n=this.grp.getChildAt(this.grp.children.length-1);t=n[this.p.xy]+bo(n,this.p.wh)+this.o.padding}return e[this.p.xy]=t,this.grp.addChild(e),this.length=t+bo(e,this.p.wh),this.events.onAdded.dispatch(this.length-this.bounds[this.p.wh]),e}},{key:"addMultiple",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(this.add,this)}},{key:"remove",value:function(e){LogConsole.log("remove child-listview"),this.grp.removeChild(e);var t=this.items.indexOf(e);if(-1!=t)return this.items.splice(t,1),e}},{key:"destroy",value:function(){LogConsole.log("destroy-listview"),null!=this.events&&(this.events.onAdded.dispose(),this.events=null),null!==this.grp&&(this.grp.destroy(),this.grp=null),this.game=null,this.parent=null,this.items=null}},{key:"removeAll",value:function(){if(null!==this.grp){for(;this.grp.children.length>0;){var e=this.grp.children[0];this.remove(e),e.destroy(),e=null}this.grp.removeAll()}this.items=[]}},{key:"cull",value:function(){for(var e=[],t=0;t<this.items.length;t++){var n=this.items[t];n[this.p.xy]+bo(n,this.p.wh)+this.grp[this.p.xy]<this.bounds[this.p.xy]?n.visible=!1:n[this.p.xy]+this.grp[this.p.xy]>this.bounds[this.p.xy]+this.bounds[this.p.wh]?n.visible=!1:(n.visible=!0,this.idx=t,this.events.changeIndex.dispatch(),e.push(n))}this.scroller.registerClickables(e)}},{key:"getIdx",value:function(){return this.idx}},{key:"getPositionByItemIndex",value:function(e){return-this.items[e][this.p.xy]}},{key:"setPosition",value:function(e){this.moveToPosition(e)}},{key:"moveToPosition",value:function(e){this.scroller.setTo(e)}},{key:"moveToItem",value:function(e){this.scroller.setTo(this.getPositionByItemIndex(e))}},{key:"tweenToPosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.scroller.tweenTo(t,e)}},{key:"tweenToItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.scroller.tweenTo(t,this.getPositionByItemIndex(e))}},{key:"_setPosition",value:function(e){this.position=e,this.grp[this.p.xy]=this.bounds[this.p.xy]+e,this.o.autocull&&this.cull()}},{key:"_addMask",value:function(e){var t=this.game.add.graphics(0,0,this.parent);return t.beginFill(16711680).drawRect(e.x,e.y,e.width,e.height),t.alpha=0,t}}])&&So(t.prototype,n),i&&So(t,i),e}(),ko={nearestMultiple:function(e,t){return Math.round(e/t)*t},scaleBetween:function(e,t,n){return e+(t-e)*n},percentageBetween2:function(e,t,n){return(e-t)/(n-t)}};function Po(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ro=new Phaser.Point,xo={from:0,to:200,direction:"y",momentum:!1,snapping:!1,bouncing:!1,deceleration:.5,overflow:20,snapStep:10,emitMoving:!1,duration:2,speedLimit:3,flickTimeThreshold:100,offsetThreshold:30,acceleration:.5,accelerationT:250,maxAcceleration:4,time:{},multiplier:1,swipeEnabled:!1,swipeThreshold:5,swipeTimeThreshold:250,minDuration:.5,addListeners:!0},To=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.clickObject=n,this.maskLimits=i,this.o=this.options=Object.assign({},xo,o),this._updateMinMax(),this.dispatchValues={step:0,total:0,percent:0},this.addListeners(),this.clickables=[],this.isDown=!1,this.isScrolling=!1,this.scrollObject={},this.init(),this.tweenScroll=this.game.add.tween(this.scrollObject).to({},0,Phaser.Easing.Quartic.Out),this.tweenScroll.onUpdateCallback(this.handleUpdate,this),this.tweenScroll.onComplete.add(this.handleComplete,this)}var t,n,i;return t=e,(n=[{key:"destroy",value:function(){LogConsole.log("destroy"),this.tweenScroll.stop(),this.removeListeners(),this.clickObject.destroy(),this.clickables=null,this.options=this.o=null,this.maskLimits=null,this.enabled=!1,this.game=null,this.dispatchValues=null,this.isDown=null,this.target=null,this.destroyed=!0}},{key:"addListeners",value:function(){this.events={onUpdate:new Phaser.Signal,onInputUp:new Phaser.Signal,onInputDown:new Phaser.Signal,onInputMove:new Phaser.Signal,onComplete:new Phaser.Signal,onSwipe:new Phaser.Signal},this.o.addListeners&&(this.clickObject.inputEnabled=!0,this.clickObject.events.onInputDown.add(this.handleDown,this),this.clickObject.events.onInputUp.add(this.handleUp,this))}},{key:"removeListeners",value:function(){for(var e in this.o.addListeners&&(this.clickObject.events.onInputDown.remove(this.handleDown,this),this.clickObject.events.onInputUp.remove(this.handleUp,this)),this.events)this.events.hasOwnProperty(e)&&this.events[e].dispose()}},{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1}},{key:"init",value:function(){this.scrollObject[this.o.direction]=this.o.from,this.maxOffset=this.maskLimits[this.o.direction]*this.o.speedLimit,this.enable()}},{key:"reset",value:function(){this.tweenScroll.pause(),this.o.multiplier=1,this.init()}},{key:"setFromTo",value:function(e,t){this.o.from=e,this.o.to=t,this._updateMinMax()}},{key:"isTweening",value:function(){return this.tweenScroll.isRunning}},{key:"registerClickables",value:function(e){this.clickables=e}},{key:"handleDown",value:function(e,t){this.enabled&&(this.isDown=!0,this.target=this.requested=this.scrollObject[this.o.direction],this.o.time.down=t.timeDown,this.o.addListeners&&this.game.input.addMoveCallback(this.handleMove,this),this.isTweening()&&this.o.time.down-this.o.time.up<this.o.accelerationT?this.o.multiplier+=this.o.acceleration:this.o.multiplier=1,this.tweenScroll.stop(),this.tweenScroll.pendingDelete=!1,_o(t,this.clickables,"onInputDown"),this.events.onInputDown.dispatch(e,t))}},{key:"handleMove",value:function(e,t,n){this.enabled&&(this.isScrolling=!0,Ro.set(t,n),this.diff=this.old-Ro[this.o.direction],this.diff=this._requestDiff(this.diff,this.target,this.min,this.max,this.o.overflow),this.target-=this.diff,this.old=Ro[this.o.direction],this.o.time.move=this.game.time.time,this.acc=Math.min(Math.abs(this.diff/30),this.o.maxAcceleration),this.scrollObject[this.o.direction]=this.target,this.handleUpdate(),this.o.emitMoving&&this.events.onInputMove.dispatch(e,t,n))}},{key:"handleUp",value:function(e,t){this.isDown=!1,this.o.addListeners&&this.game.input.deleteMoveCallback(this.handleMove,this),this.o.time.up=t.timeUp,this.o.time.up-this.o.time.down>this.o.accelerationT&&(this.o.multiplier=1);var n={duration:.5,target:this.target};this.o.bouncing||(n.duration=.01),!this.o.infinite&&this.scrollObject[this.o.direction]>this.max?(this.target=this.max,this.tweenTo(n.duration,this.target)):!this.o.infinite&&this.scrollObject[this.o.direction]<this.min?(this.target=this.min,this.tweenTo(n.duration,this.target)):(this._addMomentum(n),this._addSwiping(n,t),this._addSnapping(n),this._addLimits(n),this._calculateDuration(n),this.tweenTo(n.duration,n.target)),_o(t,this.clickables,"onInputUp"),this.events.onInputUp.dispatch(e,t,_o)}},{key:"_addMomentum",value:function(e){if(!this.o.momentum)return e.target;var t=Math.pow(this.acc,2)*this.maskLimits[this.o.direction];return t=Math.min(this.maxOffset,t),t=this.diff>0?-this.o.multiplier*t:this.o.multiplier*t,this.o.time.up-this.o.time.move<this.o.flickTimeThreshold&&0!==t&&Math.abs(t)>this.o.offsetThreshold&&(e.target+=t),e}},{key:"_addSwiping",value:function(e,t){var n=Math.abs(this.down-this.current);if(this.o.swipeEnabled&&this.o.time.up-this.o.time.down<this.o.swipeTimeThreshold&&n>this.o.swipeThreshold){var i=t[this.o.direction]<this.down?"forward":"backward";"forward"==i?e.target-=this.o.snapStep/2:e.target+=this.o.snapStep/2,this.events.onSwipe.dispatch(i)}return e}},{key:"_addSnapping",value:function(e){return this.o.snapping?(e.target=ko.nearestMultiple(e.target,this.o.snapStep),e):e}},{key:"_addLimits",value:function(e){return this.o.infinite?e:(e.target=Math.max(e.target,this.min),e.target=Math.min(e.target,this.max),e)}},{key:"_calculateDuration",value:function(e){var t=Math.abs(e.target-this.scrollObject[this.o.direction]);return e.duration=this.o.duration*t/this.maxOffset,e.duration=Math.max(this.o.minDuration,e.duration),e}},{key:"_requestDiff",value:function(e,t,n,i,o){if(this.o.infinite)return e;return t>i?e*=(i+o-t)/o:t<n&&(e*=-(n-o-t)/o),e}},{key:"tweenToSnap",value:function(e,t){var n=this.o.from-this.o.snapStep*t;this.tweenTo(e,n)}},{key:"tweenTo",value:function(e,t){if(0===e)return this.setTo(t);Po({},this.o.direction,t);t>this.max&&(t=this.max),t<this.min&&(t=this.min),this.tweenScroll.stop(),this.game.tweens.remove(this.tweenScroll),this.tweenScroll=this.game.add.tween(this.scrollObject).to(Po({},this.o.direction,t),1e3*e,Phaser.Easing.Quartic.Out),this.tweenScroll.onUpdateCallback(this.handleUpdate,this),this.tweenScroll.onComplete.add(this.handleComplete,this),this.tweenScroll.start()}},{key:"cancel",value:function(){this.isDown=!1}},{key:"setTo",value:function(e){e>this.max&&(e=this.max),e<this.min&&(e=this.min),this.scrollObject[this.o.direction]=e,this.tweenScroll.stop(),this.handleUpdate(),this.handleComplete()}},{key:"handleUpdate",value:function(){if(this.enabled){this.o.infinite?this.dispatchValues.total=Phaser.Math.wrap(this.scrollObject[this.o.direction],this.min,this.max):this.dispatchValues.total=this.scrollObject[this.o.direction];var e=this.dispatchValues.total-this.previousTotal;e<-this.length/2?e+=this.length:e>this.length/2&&(e-=this.length),this.dispatchValues.step=e,this.dispatchValues.percent=ko.percentageBetween2(this.dispatchValues.total,this.o.from,this.o.to),this.events.onUpdate.dispatch(this.dispatchValues),this.previousTotal=this.dispatchValues.total}}},{key:"handleComplete",value:function(){LogConsole.log("handleComplete"),this.enabled&&(this.isScrolling=!1,this.o.multiplier=1,this.events.onComplete.dispatch())}},{key:"_updateMinMax",value:function(){this.min=Math.min(this.o.from,this.o.to),this.max=Math.max(this.o.from,this.o.to),this.length=Math.abs(this.max-this.min),this.previousTotal=this.o.from}}])&&Oo(t.prototype,n),i&&Oo(t,i),e}();function Io(e){return(Io="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ao(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Lo(e,t){return!t||"object"!==Io(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Go(e,t,n){return(Go="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Do(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Do(e){return(Do=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mo(e,t){return(Mo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var No=function(e){function t(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Lo(this,Do(t).call(this,e,n,{x:n.width,y:n.height},i))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mo(e,t)}(t,To),n=t,(i=[{key:"handleDown",value:function(e,n){this.old=this.down=n[this.o.direction],Go(Do(t.prototype),"handleDown",this).call(this,e,n)}},{key:"handleUp",value:function(e,n){this.current=n[this.o.direction],Go(Do(t.prototype),"handleUp",this).call(this,e,n)}}])&&Ao(n.prototype,i),o&&Ao(n,o),t}();function Bo(e){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Uo(e,t){return!t||"object"!==Bo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fo(e,t,n){return(Fo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Zo(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Zo(e){return(Zo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ho(e,t){return(Ho=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qo={direction:"y",autocull:!0,momentum:!0,bouncing:!0,snapping:!1,overflow:100,padding:10,searchForClicks:!1},Vo=function(e){function t(e,n,i){var o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Uo(this,Zo(t).call(this,e,n,function(e){return e.x=e.x?e.x:0,e.y=e.y?e.y:0,e.width<=0?console.warn("PhaserListView: bounds.width <= 0"):e.height<=0&&console.warn("PhaserListView: bounds.height <= 0"),e}(i),Object.assign({},Qo,a)))).scroller=new No(o.game,o._addMask(i),Object.assign({from:0,to:0},o.options)),o.scroller.events.onUpdate.add(function(e){o._setPosition(e.total)}),o.events.onAdded.add(function(e){var t=Math.min(-e,0);o.scroller.setFromTo(0,t),o.options.searchForClicks&&o.scroller.registerClickables(o.items)}),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ho(e,t)}(t,Co),n=t,(i=[{key:"destroy",value:function(){null!==this.scroller&&(this.scroller.destroy(),this.scroller=null),Fo(Zo(t.prototype),"destroy",this).call(this)}},{key:"reset",value:function(){this._setPosition(0),this.scroller.reset()}}])&&jo(n.prototype,i),o&&jo(n,o),t}();function Wo(e){return(Wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qo(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ko(e,t){return!t||"object"!==Wo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zo(e){return(zo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yo(e,t){return(Yo=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jo=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Ko(this,zo(t).call(this,game,0,1140*window.GameConfig.RESIZE,null))).dailyRewardConfig=JSON.parse(game.cache.getText("dailyRewardConfig")),i.dailyRewardSettings=e,i.dailyRewardLog=n,i.popup,i.event={claimDailyReward:new Phaser.Signal},i.addPopup(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yo(e,t)}(t,Phaser.Sprite),n=t,o=[{key:"INIT",get:function(){return"INIT"}},{key:"NOT_INIT",get:function(){return"NOT_INIT"}},{key:"REWARDED",get:function(){return"REWARDED"}}],(i=[{key:"addPopup",value:function(){this.addEventExtension(),this.popup=new rt(this.dailyRewardConfig.popup),this.popup.x=18*window.GameConfig.RESIZE,this.popup.y=233*window.GameConfig.RESIZE,this.addChild(this.popup),this.addDecoPopup(),this.addListReward()}},{key:"addDecoPopup",value:function(){this.boxGift,this.ribbon,this.btnClaim,this.txtHeader,this.initRewardIndex=-1,this.rewardObj,this.addBoxGift(),this.addBtnClaim(),this.addBtnWatch(),this.addTxtHeader()}},{key:"addBoxGift",value:function(){this.boxGift=new rt(this.dailyRewardConfig.decorate.box_gift),this.boxGift.anchor.set(.5),this.popup.addChild(this.boxGift)}},{key:"addRibbon",value:function(){this.ribbon=new rt(this.dailyRewardConfig.decorate.ribbon),this.popup.addChild(this.ribbon)}},{key:"addBtnClaim",value:function(){this.btnClaim=new pt(this.dailyRewardConfig.decorate.btn_claim,this.onClickClaim,this),this.btnClaim.anchor.set(.5);var e=new _t(this.dailyRewardConfig.decorate.txt_btn,this.dailyRewardConfig.decorate.txt_btn.text);e.anchor.set(.5),this.btnClaim.addChild(e),this.popup.addChild(this.btnClaim)}},{key:"onClickClaim",value:function(){this.event.claimDailyReward.dispatch(this.rewardObj,0)}},{key:"changeItemChildInit",value:function(){this.btnClaim.kill(),this.btnWatch.kill(),this.groupPlaylists.children[this.initRewardIndex-1].changeRewarded()}},{key:"addBtnWatch",value:function(){this.btnWatch=new pt(this.dailyRewardConfig.decorate.btn_watch_video_reward,this.onClickWatch,this),this.btnWatch.anchor.set(.5);var e=new rt(this.dailyRewardConfig.decorate.btn_watch_video_reward.camera);this.btnWatch.addChild(e);var t=new _t(this.dailyRewardConfig.decorate.btn_watch_video_reward.txt1,this.dailyRewardConfig.decorate.btn_watch_video_reward.txt1.text),n=new _t(this.dailyRewardConfig.decorate.btn_watch_video_reward.txt2,this.dailyRewardConfig.decorate.btn_watch_video_reward.txt2.text);this.btnWatch.addChild(t),this.btnWatch.addChild(n),this.popup.addChild(this.btnWatch)}},{key:"onClickWatch",value:function(){li.instance().showRewardVideoX2Daily()}},{key:"addTxtHeader",value:function(){this.txtHeader=new _t(this.dailyRewardConfig.decorate.txt_header,this.dailyRewardConfig.decorate.txt_header.text),this.txtHeader.anchor.set(.5),this.popup.addChild(this.txtHeader)}},{key:"addListReward",value:function(){var e=0,n=35*window.GameConfig.RESIZE;this.groupPlaylists=new uo(0,0*window.GameConfig.RESIZE);var i=new Phaser.Group(game,this);i.x=0,i.y=148*window.GameConfig.RESIZE,this.popup.addChild(i);var o=new Phaser.Rectangle(17*window.GameConfig.RESIZE,0,570*window.GameConfig.RESIZE,551*window.GameConfig.RESIZE);this.listView=new Vo(game,i,o,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),LogConsole.log(this.dailyRewardSettings);for(var a=1;a<this.dailyRewardSettings.length+1;a++){if(this.dailyRewardSettings[a-1].day<this.dailyRewardLog.day){var s=new vo(e,n,this.dailyRewardSettings[a-1],t.REWARDED);this.groupPlaylists.add(s)}else if(this.dailyRewardSettings[a-1].day==this.dailyRewardLog.day){var r=new vo(e,n,this.dailyRewardSettings[a-1],this.dailyRewardLog.state);this.rewardObj=this.dailyRewardSettings[a-1],this.initRewardIndex=a,this.groupPlaylists.add(r)}else{var l=new vo(e,n,this.dailyRewardSettings[a-1],t.NOT_INIT);this.groupPlaylists.add(l)}a%5==0&&a>0?(e=0,n+=window.GameConfig.CONFIGS_DAILY_REWARD.y*window.GameConfig.RESIZE,this.groupPlaylists.height+=window.GameConfig.CONFIGS_DAILY_REWARD.y*window.GameConfig.RESIZE):e+=window.GameConfig.CONFIGS_DAILY_REWARD.x*window.GameConfig.RESIZE}this.listView.add(this.groupPlaylists)}},{key:"addEventExtension",value:function(){li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this)}},{key:"removeEventExtension",value:function(){li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.remove(this.rewardedVideoFailed,this)}},{key:"rewardedVideoRewardReceived",value:function(){this.event.claimDailyReward.dispatch(this.rewardObj,1)}},{key:"rewardedVideoFailed",value:function(){Gn.instance().addDialog("No ads to show"),this.btnClaim.inputEnabled=!0,this.btnWatch.inputEnabled=!0}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&qo(n.prototype,i),o&&qo(n,o),t}();function Xo(e){return(Xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ea(e,t){return!t||"object"!==Xo(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ta(e){return(ta=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function na(e,t){return(na=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ia=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ea(this,ta(t).call(this,game))).dailyRewardConfig=JSON.parse(game.cache.getText("dailyRewardConfig")),i.dailyRewardSettings=e,i.dailyRewardLog=n,i.event={claimDone:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&na(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.bg,this.headerResource,this.popup,this.addBg(),this.addHeaderResource(),this.addPopup(),Le.instance().logEvent(Le.Daily_reward)}},{key:"addBg",value:function(){this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg)}},{key:"addHeaderResource",value:function(){this.headerResource=new Phaser.Group(game),this.addChild(this.headerResource),this.txtGem,this.txtTicket,this.txtMic,this.tabGemHeader,this.tabTicketHeader,this.tabMicHeader,this.addTabGemHeader(this.dailyRewardConfig.header),this.addTabTicketHeader(this.dailyRewardConfig.header),this.addTabMicHeader(this.dailyRewardConfig.header)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.dailyRewardConfig.header.gem);this.txtGem=this.addTxtGem(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtGem.width;this.txtGem.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtGem.width+5*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(this.txtGem),this.headerResource.addChild(this.tabGemHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addTabTicketHeader",value:function(e){this.tabTicketHeader=new Phaser.Sprite(game,e.tabTicket.x*window.GameConfig.RESIZE,e.tabTicket.y*window.GameConfig.RESIZE,e.tabTicket.nameAtlas,e.tabTicket.nameSprite);var t=this.addTicket(this.dailyRewardConfig.header.ticket);this.txtTicket=this.addTxtTicket(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtTicket.width;this.txtTicket.x=(this.tabTicketHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabTicketHeader.width-n)/2+this.txtTicket.width+5*window.GameConfig.RESIZE,this.tabTicketHeader.addChild(t),this.tabTicketHeader.addChild(this.txtTicket),this.headerResource.addChild(this.tabTicketHeader)}},{key:"addTicket",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtTicket",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("ticket").value,e.configs)}},{key:"addTabMicHeader",value:function(e){this.tabMicHeader=new Phaser.Sprite(game,e.tabMic.x*window.GameConfig.RESIZE,e.tabMic.y*window.GameConfig.RESIZE,e.tabMic.nameAtlas,e.tabMic.nameSprite);var t=this.addMic(this.dailyRewardConfig.header.micro);this.txtMic=this.addTxtMic(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtMic.width;this.txtMic.x=(this.tabMicHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabMicHeader.width-n)/2+this.txtMic.width+10*window.GameConfig.RESIZE,this.tabMicHeader.addChild(t),this.tabMicHeader.addChild(this.txtMic),this.headerResource.addChild(this.tabMicHeader)}},{key:"addMic",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtMic",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("support_item").value,e.configs)}},{key:"addPopup",value:function(){this.popup=new Jo(this.dailyRewardSettings,this.dailyRewardLog),this.popup.event.claimDailyReward.add(this.onClaimDaily,this),this.addChild(this.popup),game.add.tween(this.popup).to({y:game.height-z.instance().STANDARD_HEIGHT},1800,Phaser.Easing.Elastic.Out,!1).start(),ce.instance().playSound(ce.dailyreward)}},{key:"onClaimDaily",value:function(e,t){this.rewardObj=e,this.is_watched_ads=t,this.sendClaim()}},{key:"sendClaim",value:function(){var e=new SFS2X.SFSObject;e.putInt("is_watched_ads",this.is_watched_ads),TF.instance().sendData(Et.DAILY_REWARD_CLAIM_REQUEST,e)}},{key:"onClaimDailyDone",value:function(){var e=this;this.popup.changeItemChildInit();var t={x:0,y:0};"DIAMOND"==this.rewardObj.reward_type?(t.x=351,t.y=54):"TICKET"==this.rewardObj.reward_type?(t.x=529,t.y=54):(t.x=164,t.y=54);var n=this.rewardObj.reward;1==this.is_watched_ads&&(n*=2),IE.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:this.rewardObj.reward_type,reward:n,finishPoint:t}),this.timeTweenUpdateRs=game.time.events.add(2*Phaser.Timer.SECOND,function(){e.updateVariableResource(e.rewardObj),e.timeTweenDispatchClaim=game.time.events.add(1.5*Phaser.Timer.SECOND,function(){e.event.claimDone.dispatch(),e.destroy()},e)},this)}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.DAILY_REWARD_CLAIM_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.onClaimDailyDone()}},{key:"updateVariableResource",value:function(e){var t=this;if("DIAMOND"==e.reward_type){this.txtGem.setText(TF.instance().socket.mySelf.getVariable("diamond").value-e.reward);var n=game.add.tween(this.txtGem).to({text:TF.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.txtGem.text=parseInt(t.txtGem.text)},this)}else if("TICKET"==e.reward_type){this.txtTicket.setText(TF.instance().socket.mySelf.getVariable("ticket").value-e.reward);var i=game.add.tween(this.txtTicket).to({text:TF.instance().socket.mySelf.getVariable("ticket").value},300,"Linear",!1);i.start(),i.onUpdateCallback(function(){t.txtTicket.text=parseInt(t.txtTicket.text)},this)}else if("SUPPORT_ITEM"==e.reward_type){this.txtMic.setText(TF.instance().socket.mySelf.getVariable("support_item").value-e.reward);var o=game.add.tween(this.txtMic).to({text:TF.instance().socket.mySelf.getVariable("support_item").value},300,"Linear",!1);o.start(),o.onUpdateCallback(function(){t.txtMic.text=parseInt(t.txtMic.text)},this)}}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.popup.event.claimDailyReward.remove(this.onClaimDaily,this),game.time.events.remove(this.timeTweenDispatchClaim),game.time.events.remove(this.timeTweenDispatchClaim);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&$o(n.prototype,i),o&&$o(n,o),t}();function oa(e){return(oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sa(e,t){return!t||"object"!==oa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ra(e,t,n){return(ra="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=la(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function la(e){return(la=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ha(e,t){return(ha=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ca=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=sa(this,la(t).call(this,game,e.x*z.instance().scale,e.y*z.instance().scale,null,i,o))).objConfig=e,game.cache.addNinePatch(e.name,e.nameAtlas,e.nameSprite,e.left*z.instance().scale,e.right*z.instance().scale,e.top*z.instance().scale,e.bot*z.instance().scale),a.bg=new Phaser.NinePatchImage(game,0,0,e.name),a.bg.targetWidth=e.width*z.instance().scale,a.bg.targetHeight=e.height*z.instance().scale,a.bg.UpdateImageSizes(),a.addChild(a.bg),a.addChild(a.bg),a.icon=null,e.icon&&(a.icon=new rt(e.icon),e.icon.width&&(a.icon.width=e.icon.width*z.instance().scale),e.icon.height&&(a.icon.height=e.icon.height*z.instance().scale),a.addChild(a.icon)),a.lbBtn=new _t(e.configText,n),a.reSize(),a.addChild(a.lbBtn),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ha(e,t)}(t,Phaser.Button),n=t,(i=[{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),ra(la(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"reSize",value:function(){var e=0,t=0,n=0,i=0,o=0,a=0;this.objConfig.configText.hasOwnProperty("paddingLeft")&&(n=this.objConfig.configText.paddingLeft*z.instance().scale),this.objConfig.configText.hasOwnProperty("paddingRight")&&(i=this.objConfig.configText.paddingRight*z.instance().scale),this.objConfig.configText.hasOwnProperty("paddingTop")&&(o=this.objConfig.configText.paddingTop*z.instance().scale),this.objConfig.configText.hasOwnProperty("paddingBot")&&(a=this.objConfig.configText.paddingBot*z.instance().scale),null==this.icon?(e=this.objConfig.configText.width?this.objConfig.configText.width*z.instance().scale-i-n:this.width-i-n,t=this.objConfig.configText.height?this.objConfig.configText.height*z.instance().scale-o-a:this.height-o-a,this.lbBtn.setTextBounds(0,0,e,t),this.lbBtn.x=i>0?this.width-i-e:n>0?n:(this.width-e)/2,this.lbBtn.y=o>0?o:a>0?this.height-a:(this.height-t)/2):(e=this.objConfig.configText.width?this.objConfig.configText.width*z.instance().scale-i-n:"right"==this.objConfig.icon.align?this.width-this.icon.x-6*z.instance().scale-i-n:this.width-this.icon.x-this.icon.width-6*z.instance().scale-i-n,t=this.objConfig.configText.height?this.objConfig.configText.height*z.instance().scale-o-a:this.height-o-a,this.objConfig.hasOwnProperty("alignAll")?this.setKCTextCenter():(this.lbBtn.setTextBounds(0,0,e,t),"right"==this.objConfig.icon.align?this.lbBtn.x=i>0?this.width-i-e:n>0?n:this.icon.x-e-6*z.instance().scale:this.lbBtn.x=i>0?this.width-i-e:n>0?n:this.icon.x+this.icon.width+6*z.instance().scale,this.lbBtn.y=o>0?o:a>0?this.height-a:(this.height-t)/2))}},{key:"setKCTextCenter",value:function(){var e=0,t=0;this.objConfig.configText.hasOwnProperty("paddingTop")&&(e=this.objConfig.configText.paddingTop*z.instance().scale),this.objConfig.configText.hasOwnProperty("paddingBot")&&(t=this.objConfig.configText.paddingBot*z.instance().scale);var n=6*z.instance().scale;this.objConfig.hasOwnProperty("kc")&&(n=this.objConfig.hasOwnProperty("kc")*z.instance().scale),"right"==this.objConfig.icon.align?(this.lbBtn.x=(this.width-(this.lbBtn.width+n+this.icon.width))/2,this.icon.x=this.lbBtn.x+this.lbBtn.width+n):(this.icon.x=(this.width-(this.lbBtn.width+n+this.icon.width))/2,this.lbBtn.x=this.icon.x+this.icon.width+n),this.lbBtn.y=e>0?e:t>0?this.height-t:(this.height-this.lbBtn.height)/2}},{key:"text",set:function(e){this.lbBtn.text=e,this.reSize()}},{key:"width",get:function(){return this.bg.targetWidth},set:function(e){this.bg.targetWidth=e,this.bg.UpdateImageSizes()}},{key:"height",get:function(){return this.bg.targetHeight},set:function(e){this.bg.targetHeight=e,this.bg.UpdateImageSizes()}}])&&aa(n.prototype,i),o&&aa(n,o),t}();var ua=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.userName="",this.diamond=0,this.userId=0,this.avatar="",this.isOnline=!1};function da(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"avatar",get:function(){return"avatar"}},{key:"diamond",get:function(){return"diamond"}},{key:"is_online",get:function(){return"is_online"}},{key:"userId",get:function(){return"userId"}},{key:"userName",get:function(){return"userName"}},{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"room_master",get:function(){return"room_master"}},{key:"gender",get:function(){return"gender"}},{key:"experience_score",get:function(){return"experience_score"}},{key:"heart",get:function(){return"heart"}},{key:"ticket",get:function(){return"ticket"}},{key:"weekly_high_score",get:function(){return"weekly_high_score"}},{key:"all_time_high_score",get:function(){return"all_time_high_score"}},{key:"level",get:function(){return"level"}},{key:"online_mode_genre",get:function(){return"online_mode_genre"}},{key:"online_mode_room_ready",get:function(){return"online_mode_room_ready"}},{key:"online_mode_loaded",get:function(){return"online_mode_loaded"}},{key:"is_playing_game",get:function(){return"is_playing_game"}},{key:"status",get:function(){return"status"}},{key:"playlists",get:function(){return"playlists"}},{key:"bets",get:function(){return"bets"}},{key:"id",get:function(){return"id"}},{key:"bet_place",get:function(){return"bet_place"}},{key:"percent_of_fee",get:function(){return"percent_of_fee"}},{key:"suggestion_playlist",get:function(){return"suggestion_playlist"}},{key:"score",get:function(){return"score"}},{key:"is_correct_answer",get:function(){return"is_correct_answer"}},{key:"diamond_change",get:function(){return"diamond_change"}},{key:"exp_score",get:function(){return"exp_score"}},{key:"players",get:function(){return"players"}},{key:"users",get:function(){return"users"}},{key:"streak",get:function(){return"streak"}},{key:"friends",get:function(){return"friends"}}],(n=null)&&da(t.prototype,n),i&&da(t,i),e}();function pa(e){return(pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ga(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ya(e,t){return!t||"object"!==pa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ma(e){return(ma=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function va(e,t){return(va=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wa=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ya(this,ma(t).call(this,game))).index=n,i.afterCreate(e),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&va(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterCreate",value:function(e){this._width=e,this._height=272*window.GameConfig.RESIZE,this.key="",this.ava=new Phaser.Sprite(game,0,0,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.signalInput=new Phaser.Signal,this.maskAva=new Phaser.Graphics(game,0,0),this.addChild(this.ava)}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.onClickSprite,this)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch(this.value),LogConsole.log("hehehe")}},{key:"addNameAva",value:function(e,t){this.txtName=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,t,e.configs),this.txtName.anchor.set(.5,0),this.addChild(this.txtName)}},{key:"addMaskAva",value:function(e){this.maskAva.beginFill(),this.maskAva.drawCircle(this.ava.x,this.ava.y,e),this.maskAva.endFill(),this.ava.mask=this.maskAva,this.addChild(this.maskAva)}},{key:"setValue",value:function(e){this.value=e}},{key:"setScale",value:function(e){this.ava.width=108,this.ava.height=108}},{key:"beginLoad",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.key)&&e&&(""!==e.key?(e.ava.loadTexture("".concat(e.key)),e.ava.width=108,e.ava.height=108):e.ava.loadTexture("songDetailSprites","ava-default"))}catch(e){}},150*this.index)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&ga(n.prototype,i),o&&ga(n,o),t}();function ba(e){return(ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Sa(e,t){return!t||"object"!==ba(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ea(e){return(Ea=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ca(e,t){return(Ca=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ka=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Sa(this,Ea(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),e.event={challengeGame:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ca(e,t)}(t,Phaser.Group),n=t,(i=[{key:"addGroupSuggestionFriend",value:function(){null!=this.group&&null!=this.group||(this.group=new Phaser.Group(game),this.addChild(this.group))}},{key:"addSuggestionFriend",value:function(e,t){var n=this;this.addTabScreenSuggestionFriend(),e&&this.shuffleFriendList(e,function(e){for(var i=0;i<e.length;i++)n.createSuggestionFriend(i,e[i]);t()})}},{key:"addTabScreenSuggestionFriend",value:function(){this.tabHeaderSuggestFriend,this.addTabHeaderSuggestFriend()}},{key:"addTabHeaderSuggestFriend",value:function(){this.tabHeaderSuggestFriend=new Phaser.Sprite(game,this.findOpponentConfig.tab_header.x*window.GameConfig.RESIZE,this.findOpponentConfig.tab_header.y*window.GameConfig.RESIZE,this.findOpponentConfig.tab_header.nameAtlas,this.findOpponentConfig.tab_header.nameSprite),this.group.add(this.tabHeaderSuggestFriend),this.addTxtAndLineGradient(this.findOpponentConfig.txt_famous_user,this.findOpponentConfig.line_famous_user),this.addBgSuggestFriend()}},{key:"addTxtAndLineGradient",value:function(e,t){var n=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs);n.anchor.set(.5);var i=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);this.tabHeaderSuggestFriend.addChild(n),this.tabHeaderSuggestFriend.addChild(i)}},{key:"addBgSuggestFriend",value:function(){var e=new Phaser.Sprite(game,this.findOpponentConfig.bg_suggest_friend.x*window.GameConfig.RESIZE,this.findOpponentConfig.bg_suggest_friend.y*window.GameConfig.RESIZE,this.findOpponentConfig.bg_suggest_friend.nameAtlas,this.findOpponentConfig.bg_suggest_friend.nameSprite);this.tabHeaderSuggestFriend.addChild(e)}},{key:"createSuggestionFriend",value:function(e,t){var n=new wa(0,e);n.x=(140+181*e)*window.GameConfig.RESIZE,n.y=298*window.GameConfig.RESIZE,n.beginLoad(t.avatar),n.width=164*window.GameConfig.RESIZE,n.addMaskAva(108),n.setScale(window.GameConfig.SCALE_AVA_FAMOUS_USER*window.GameConfig.RESIZE),n.addNameAva(this.findOpponentConfig.txt_suggest_friend,t.user_name),n.setValue(t),n.addInput(this.onInputSuggestionFriend,this),this.addFrameAva(e),this.group.add(n),this.addDotOnline(t,e)}},{key:"addFrameAva",value:function(e){this.frameAva=new Phaser.Sprite(game,(140+181*e)*window.GameConfig.RESIZE,298*window.GameConfig.RESIZE,"playSprites","Khung_Ava_Thuong"),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.4),this.group.add(this.frameAva)}},{key:"addDotOnline",value:function(e,t){var n=170+181*t;1==e.isOnline?(this.dotOnline=new rt({x:n,y:325,nameAtlas:"findOpponentSprites",nameSprite:"Online"}),this.group.add(this.dotOnline)):(this.dotOnline=new rt({x:n,y:325,nameAtlas:"findOpponentSprites",nameSprite:"Offline"}),this.group.add(this.dotOnline))}},{key:"shuffleFriendList",value:function(e,t){t(e.sort(function(){return Math.random()-.5}))}},{key:"removeGroup",value:function(){this.group.destroy(),this.group=null}},{key:"onInputSuggestionFriend",value:function(e){Le.instance().logEvent(Le.Find_Game_Suggestion_Opponent_profile),Le.instance().logEvent(Le.Find_Game_Suggestion_Opponent_profile_button),IE.instance().addUserProfile(e.id)}}])&&_a(n.prototype,i),o&&_a(n,o),t}();function Pa(e){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oa(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ra(e){return(Ra=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xa(e,t){return(xa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ta(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ia=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=Ra(t).call(this,game,e.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.y)*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite))||"object"!==Pa(a)&&"function"!=typeof a?Ta(o):a).anchor.set(.5),i.configs=n,i.signalInput=new Phaser.Signal,i.inputEnabled=!0,i.events.onInputUp.add(i.onClickBtn,Ta(Ta(i))),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xa(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"update",value:function(){}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t),this.inputEnabled=!0,this.events.onInputUp.add(this.onClickBtn,this)}},{key:"onClickBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch(this.configs)}},{key:"addTextInCenter",value:function(e){var t=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs);t.anchor.set(.5),this.addChild(t)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}}])&&Oa(n.prototype,i),o&&Oa(n,o),t}();function Aa(e){return(Aa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function La(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ga(e,t){return!t||"object"!==Aa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Da(e){return(Da=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ma(e,t){return(Ma=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Na=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ga(this,Da(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),e.event={challengeGame:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ma(e,t)}(t,Phaser.Group),n=t,(i=[{key:"initGroup",value:function(){null!=this.group&&null!=this.group||(this.group=game.add.group(),this.addChild(this.group))}},{key:"addButtonRandomUser",value:function(e){if(null==e.id||null==e.id);else{Le.instance().logEvent(Le.Find_Game_turbase_random_opponent);var t=new Ia(this.findOpponentConfig.Button_Random,e);t.addTextInCenter(this.findOpponentConfig.txt_random_user),t.addInput(this.onClickBtn,this),this.group.addChild(t)}}},{key:"addBtnInviteFriendFB",value:function(){var e=new Phaser.Sprite(game,this.findOpponentConfig.Button_FB.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.findOpponentConfig.Button_FB.y)*window.GameConfig.RESIZE,this.findOpponentConfig.Button_FB.nameAtlas,this.findOpponentConfig.Button_FB.nameSprite);e.anchor.set(0,.5),e.inputEnabled=!0,e.events.onInputUp.add(this.inviteFriendFB,this);var t=new Phaser.Sprite(game,this.findOpponentConfig.Icon_Button_FB.x*window.GameConfig.RESIZE,this.findOpponentConfig.Icon_Button_FB.y*window.GameConfig.RESIZE,this.findOpponentConfig.Icon_Button_FB.nameAtlas,this.findOpponentConfig.Icon_Button_FB.nameSprite);t.anchor.set(0,.5),e.addChild(t);var n=new Phaser.Text(game,this.findOpponentConfig.txt_Button_FB.x*window.GameConfig.RESIZE,this.findOpponentConfig.txt_Button_FB.y*window.GameConfig.RESIZE,this.findOpponentConfig.txt_Button_FB.text,this.findOpponentConfig.txt_Button_FB.configs);n.anchor.set(0,.5),e.addChild(n),this.group.add(e)}},{key:"inviteFriendFB",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().inviteFriend()}},{key:"onClickBtn",value:function(e){Le.instance().logEvent(Le.Find_Game_turbase_random_opponent_button),LogConsole.log(e),this.event.challengeGame.dispatch(e)}},{key:"removeGroup",value:function(){this.group.destroy(),this.group=null}}])&&La(n.prototype,i),o&&La(n,o),t}();function Ba(e){return(Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ja(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ua(e,t,n){return(Ua="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fa(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Fa(e){return(Fa=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Za(e,t){return(Za=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ha(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Qa=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Fa(t).call(this,game,0,0,null))||"object"!==Ba(i)&&"function"!=typeof i?Ha(n):i).event={back:new Phaser.Signal},e.positionUserProfile=JSON.parse(game.cache.getText("positionUserProfile")),e.bg=new rt(e.positionUserProfile.header_bg),e.bg.visible=!1,e.addChild(e.bg),e.bgVip=new rt(e.positionUserProfile.header_bg_vip),e.bgVip.visible=!1,e.addChild(e.bgVip),e.txtHeader=new _t(e.positionUserProfile.header_txt_content,""),e.txtHeader.setTextBounds(0,0,e.bg.width,e.bg.height),e.addChild(e.txtHeader),e.btnBack=new pt(e.positionUserProfile.header_button_back,e.chooseBack,Ha(Ha(e))),e.addChild(e.btnBack),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Za(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch(),1==z.instance().isGetUserProfileSearch&&(De.instance().event.searchFriendBackUserProfile.dispatch(),z.instance().isGetUserProfileSearch=!1)}},{key:"setBg",value:function(e){!0===e?(this.bgVip.visible=!0,this.bg.visible=!1):(this.bgVip.visible=!1,this.bg.visible=!0)}},{key:"setTitle",value:function(e){this.txtHeader.text=e}},{key:"destroy",value:function(){Ua(Fa(t.prototype),"destroy",this).call(this)}}])&&ja(n.prototype,i),o&&ja(n,o),t}();function Va(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Wa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"NO_GAME",get:function(){return"NO_GAME"}},{key:"THEIR_TURN",get:function(){return"THEIR_TURN"}},{key:"YOUR_TURN",get:function(){return"YOUR_TURN"}},{key:"ARCHIVED",get:function(){return"ARCHIVED"}},{key:"NO_FRIEND",get:function(){return"NO_FRIEND"}},{key:"PENDING_YOU",get:function(){return"PENDING_YOU"}},{key:"PENDING_THEM",get:function(){return"PENDING_THEM"}},{key:"FRIEND",get:function(){return"FRIEND"}}],(n=null)&&Va(t.prototype,n),i&&Va(t,i),e}();function qa(e){return(qa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ka(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function za(e,t){return!t||"object"!==qa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ya(e){return(Ya=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ja(e,t){return(Ja=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xa=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=za(this,Ya(t).call(this,game))).findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),i.index=n,i.afterCreate(e),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ja(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterCreate",value:function(e){this.signalInputAva=new Phaser.Signal,this._height=106*window.GameConfig.RESIZE,this.key="",this.ava=new Phaser.Sprite(game,40*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.clickAva,this),this.signalInput=new Phaser.Signal,this.addChild(this.ava),this.addFrameAva(),this.addLineUnder()}},{key:"clickAva",value:function(){this.signalInputAva.dispatch()}},{key:"addBtnPlay",value:function(e){if(this.value.status==Wa.NO_GAME){this.btnPlay=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnPlay.inputEnabled=!0,this.btnPlay.anchor.set(.5),this.btnPlay.events.onInputUp.add(this.onClickSprite,this);var t=new Phaser.Text(game,this.findOpponentConfig.txt_btn_play_findGame.x*window.GameConfig.RESIZE,this.findOpponentConfig.txt_btn_play_findGame.y*window.GameConfig.RESIZE,this.findOpponentConfig.txt_btn_play_findGame.text,this.findOpponentConfig.txt_btn_play_findGame.configs);t.anchor.set(.5),this.btnPlay.addChild(t),this.addChild(this.btnPlay)}else if(this.value.status==Wa.YOUR_TURN){var n=new Phaser.Text(game,570*window.GameConfig.RESIZE,58*window.GameConfig.RESIZE,"Lượt của bạn",{font:"Gilroy",fill:"#93909d",fontSize:21});n.anchor.set(1,.5),this.addChild(n)}else if(this.value.status==Wa.THEIR_TURN){var i=new Phaser.Text(game,570*window.GameConfig.RESIZE,58*window.GameConfig.RESIZE,"Lượt tiếp",{font:"Gilroy",fill:"#93909d",fontSize:21});i.anchor.set(1,.5),this.addChild(i)}}},{key:"addFrameAva",value:function(){this.frameAva=new Phaser.Sprite(game,40*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"playSprites","Khung_Ava_Thuong"),this.frameAva.anchor.set(.5),this.frameAva.scale.set(.9),this.addChild(this.frameAva)}},{key:"addLineUnder",value:function(){var e=new Phaser.Sprite(game,this.findOpponentConfig.line_friend_list.x*window.GameConfig.RESIZE,this.findOpponentConfig.line_friend_list.y*window.GameConfig.RESIZE,this.findOpponentConfig.line_friend_list.nameAtlas,this.findOpponentConfig.line_friend_list.nameSprite);this.addChild(e)}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch(this.value)}},{key:"addNameAva",value:function(e,t){this.txtName=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,t,e.configs),this.addChild(this.txtName)}},{key:"addMaskAva",value:function(e){this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(),this.maskAva.drawCircle(this.ava.x,this.ava.y,e),this.maskAva.endFill(),this.maskAva.anchor.set(.5),this.ava.mask=this.maskAva,this.addChild(this.maskAva)}},{key:"setStateFriend",value:function(){1==this.value.isOnline?this.setStateOnline():this.setStateOffline()}},{key:"setStateOnline",value:function(){var e=new Phaser.Sprite(game,50*window.GameConfig.RESIZE,71*window.GameConfig.RESIZE,"findOpponentSprites","Online");this.addChild(e)}},{key:"setStateOffline",value:function(){var e=new Phaser.Sprite(game,50*window.GameConfig.RESIZE,71*window.GameConfig.RESIZE,"findOpponentSprites","Offline");this.addChild(e)}},{key:"setValue",value:function(e){this.value=e,this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick)},this)}},{key:"setScale",value:function(e){this.ava.width=70,this.ava.height=70}},{key:"beginLoad",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.key)&&e&&(""!==e.key?e.ava.loadTexture("".concat(e.key)):e.ava.loadTexture("songDetailSprites","ava-default"),e.ava.width=70,e.ava.height=70)}catch(e){}},100*this.index)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&Ka(n.prototype,i),o&&Ka(n,o),t}();function $a(e){return($a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function es(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ts(e){return(ts=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ns(e,t){return(ns=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function is(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var os=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=ts(t).call(this,game))||"object"!==$a(i)&&"function"!=typeof i?is(n):i).positionUserProfile=JSON.parse(game.cache.getText("positionUserProfile")),e.positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),e.event={back:new Phaser.Signal,challengeGame:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),e.header=new Qa,e.header.event.back.add(e.chooseBack,is(is(e))),e.header.setBg(!1),e.header.setTitle("Bạn bè"),e.addChild(e.header),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ns(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){if(De.instance().event.backButton.add(this.chooseBack,this),null==this.group||null==this.group){this.group=new Phaser.Group(game);var e=new Phaser.Rectangle(35*window.GameConfig.RESIZE,125*window.GameConfig.RESIZE,game.width-35,980*window.GameConfig.RESIZE);this.listView=new Vo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addChild(this.group)}this.addListFriend(this.friendsList)}},{key:"addListFriend",value:function(e){for(var t=0;t<e.length;t++)this.createTabFriennd(t,e[t])}},{key:"setData",value:function(e){this.friendsList=e,this.afterInit()}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"createTabFriennd",value:function(e,t){var n=new Xa(0);n.beginLoad(t.avatar),n.setValue(t),n.setScale(window.GameConfig.SCALE_AVA_FRIEND*window.GameConfig.RESIZE),n.addMaskAva(70),n.addNameAva(this.findOpponentConfig.txt_friend_list,t.userName),n.setStateFriend(),n.addInput(this.onInputFriend,this),n.addBtnPlay(this.findOpponentConfig.btn_play_findGame),this.listView.add(n)}},{key:"onInputFriend",value:function(e){this.event.challengeGame.dispatch(e)}},{key:"destroy",value:function(){for(De.instance().event.backButton.remove(this.chooseBack,this),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&es(n.prototype,i),o&&es(n,o),t}();function as(e){return(as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ss(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rs(e,t){return!t||"object"!==as(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ls(e){return(ls=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hs(e,t){return(hs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cs=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=rs(this,ls(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),e.event={onBack:new Phaser.Signal,challengeGame:new Phaser.Signal,onSearch:new Phaser.Signal},e.onClickShowAll=!1,e.showAllFriend=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hs(e,t)}(t,Phaser.Group),n=t,(i=[{key:"addHeader",value:function(e,t){this.friends=t,this.addTxtAndLineGradient(this.findOpponentConfig.txt_friend,this.findOpponentConfig.line_friend,e);var n=new Phaser.Sprite(game,this.positionMainConfig.tab_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.tab_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.tab_chonplaylist.nameAtlas,this.positionMainConfig.tab_chonplaylist.nameSprite);n.anchor.set(.5,0);var i=new Phaser.Text(game,this.findOpponentConfig.txt_findGame.x*window.GameConfig.RESIZE,this.findOpponentConfig.txt_findGame.y*window.GameConfig.RESIZE,this.findOpponentConfig.txt_findGame.text,this.findOpponentConfig.txt_findGame.configs);i.anchor.set(.5),n.addChild(i),this.addEventExtension(),this.addChild(n),this.addSearchButton(n),this.addArrowBackMenu(n)}},{key:"addSearchButton",value:function(e){var t=new Phaser.Button(game,this.findOpponentConfig.Search_Icon.x*window.GameConfig.RESIZE,this.findOpponentConfig.Search_Icon.y*window.GameConfig.RESIZE,this.findOpponentConfig.Search_Icon.nameAtlas,this.onClickSearchBtn,this,null,this.findOpponentConfig.Search_Icon.nameSprite);t.anchor.set(1,.5),e.addChild(t)}},{key:"onClickSearchBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.onSearch.dispatch()}},{key:"addArrowBackMenu",value:function(e){var t=new Phaser.Button(game,this.positionMainConfig.arrow_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.arrow_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.arrow_chonplaylist.nameAtlas,function(){},this,null,this.positionMainConfig.arrow_chonplaylist.nameSprite);t.anchor.set(.5),e.addChild(t),t.events.onInputUp.add(this.onBack,this)}},{key:"onBack",value:function(){0==this.onClickShowAll&&(ce.instance().playSound(ce.buttonclick),this.event.onBack.dispatch())}},{key:"addShowAllText",value:function(e,t){var n=this,i=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs);i.anchor.set(1,0),i.inputEnabled=!0,i.events.onInputUp.add(function(){n.onClickShowAll=!0,ce.instance().playSound(ce.buttonclick),n.addShowAllFriend()}),this.addChild(i);var o=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);this.addChild(o)}},{key:"addShowAllFriend",value:function(){var e=this;this.removeShowAllFriend(),this.showAllFriend=new os,this.showAllFriend.setData(this.friends),this.showAllFriend.event.challengeGame.add(function(t){e.onClickShowAll=!1,e.event.challengeGame.dispatch(t),e.showAllFriend.destroy()},this),this.showAllFriend.event.back.add(function(){e.onClickShowAll=!1,e.showAllFriend.destroy()}),IE.instance().addChild(this.showAllFriend)}},{key:"removeShowAllFriend",value:function(){null!==this.showAllFriend&&(IE.instance().removeChild(this.showAllFriend),this.showAllFriend.destroy(),this.showAllFriend=null)}},{key:"addTxtAndLineGradient",value:function(e,t,n){var i=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,"".concat(e.text," ( ").concat(n," )"),e.configs),o=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);this.addChild(i),this.addChild(o),this.addShowAllText(this.findOpponentConfig.txt_show_all,this.findOpponentConfig.line_under_showall)}},{key:"addBtnInviteFriend",value:function(){this.btn_invite=new Phaser.Button(game,this.positionMainConfig.btn_invite.x*window.GameConfig.RESIZE,this.positionMainConfig.btn_invite.y*window.GameConfig.RESIZE,this.positionMainConfig.btn_invite.nameAtlas,this.onClickBtnInvite,this,null,this.positionMainConfig.btn_invite.nameSprite),this.btn_invite.anchor.set(1,.5),this.addChild(this.btn_invite)}},{key:"onClickBtnInvite",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().inviteFriend()}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&ss(n.prototype,i),o&&ss(n,o),t}();function us(e){return(us="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ds(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fs(e,t){return!t||"object"!==us(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ps(e){return(ps=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gs(e,t){return(gs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ys=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=fs(this,ps(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),i.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),i.event={challengeGame:new Phaser.Signal},i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gs(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){if(null==this.group||null==this.group){this.group=game.add.group();var e=new Phaser.Rectangle(35*window.GameConfig.RESIZE,534*window.GameConfig.RESIZE,game.width-35*window.GameConfig.RESIZE,(game.height-646)*window.GameConfig.RESIZE);this.listView=new Vo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addChild(this.group)}}},{key:"addListFriend",value:function(e){for(var t=0;t<e.length;t++)this.createTabFriennd(t,e[t])}},{key:"removeGroup",value:function(){this.group.destroy(),this.group=null}},{key:"createTabFriennd",value:function(e,t){var n=new Xa(0,e);n.beginLoad(t.avatar),n.setValue(t),n.setScale(window.GameConfig.SCALE_AVA_FRIEND*window.GameConfig.RESIZE),n.addMaskAva(70),n.addNameAva(this.findOpponentConfig.txt_friend_list,t.userName),n.setStateFriend(),n.addInput(this.onInputFriend,this),n.addBtnPlay(this.findOpponentConfig.btn_play_findGame),n.signalInputAva.add(function(){IE.instance().addUserProfile(t.id)},this),this.listView.add(n)}},{key:"onInputFriend",value:function(e){this.event.challengeGame.dispatch(e)}}])&&ds(n.prototype,i),o&&ds(n,o),t}();function ms(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var vs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"user_founds",get:function(){return"user_founds"}},{key:"friend_status",get:function(){return"friend_status"}},{key:"user_name",get:function(){return"user_name"}},{key:"is_online",get:function(){return"is_online"}},{key:"id",get:function(){return"id"}},{key:"avatar",get:function(){return"avatar"}}],(n=null)&&ms(t.prototype,n),i&&ms(t,i),e}();function ws(e){return(ws="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _s(e,t){return!t||"object"!==ws(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ss(e){return(Ss=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Es(e,t){return(Es=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Cs=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=_s(this,Ss(t).call(this,game))).findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),i.index=n,i.configsValue=e,i.signalInputAva=new Phaser.Signal,i.signalInput=new Phaser.Signal,i.afterCreate(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Es(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterCreate",value:function(){this.key="",this.ava=new Phaser.Sprite(game,75*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.clickAva,this),this.setScale(window.GameConfig.SCALE_AVA_FRIEND*window.GameConfig.RESIZE),this.addMaskAva(200),this.addChild(this.ava),this.addFrameAva(),this.addNameAva(this.findOpponentConfig.txt_friend_list,this.configsValue.user_name),this.setStateFriend(),this.addBtnPlay(this.findOpponentConfig.btn_play_findGame),this.addLineUnder(),this.beginLoad(this.configsValue.avatar)}},{key:"clickAva",value:function(){this.signalInputAva.dispatch(this.configsValue.id)}},{key:"addBtnPlay",value:function(e){if(this.configsValue.friend_status==Wa.PENDING_YOU){this.btnInput=new Phaser.Sprite(game,(e.x+45)*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnInput.inputEnabled=!0,this.btnInput.anchor.set(.5),this.btnInput.events.onInputUp.add(this.onClickSprite,this);var t=new Phaser.Text(game,this.findOpponentConfig.txt_btn_play_findGame.x*window.GameConfig.RESIZE,(this.findOpponentConfig.txt_btn_play_findGame.y+2)*window.GameConfig.RESIZE,"ĐỒNG Ý",{font:"GilroyBold",fill:"#ffffff",fontSize:18});t.anchor.set(.5),this.btnInput.addChild(t),this.addChild(this.btnInput)}else if(this.configsValue.friend_status==Wa.FRIEND){var n=new Phaser.Text(game,605*window.GameConfig.RESIZE,58*window.GameConfig.RESIZE,"Đã kết bạn",{font:"Gilroy",fill:"#93909d",fontSize:21});n.anchor.set(1,.5),this.addChild(n)}else if(this.configsValue.friend_status==Wa.PENDING_THEM){var i=new Phaser.Text(game,605*window.GameConfig.RESIZE,58*window.GameConfig.RESIZE,"Đã gửi lời mời kết bạn",{font:"Gilroy",fill:"#93909d",fontSize:21});i.anchor.set(1,.5),this.addChild(i)}else if(this.configsValue.friend_status==Wa.NO_FRIEND){this.btnInput=new Phaser.Sprite(game,(e.x+45)*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnInput.inputEnabled=!0,this.btnInput.anchor.set(.5),this.btnInput.events.onInputUp.add(this.onClickSprite,this);var o=new Phaser.Text(game,this.findOpponentConfig.txt_btn_play_findGame.x*window.GameConfig.RESIZE,(this.findOpponentConfig.txt_btn_play_findGame.y+2)*window.GameConfig.RESIZE,"KẾT BẠN",{font:"GilroyBold",fill:"#ffffff",fontSize:18});o.anchor.set(.5),this.btnInput.addChild(o),this.addChild(this.btnInput)}}},{key:"addFrameAva",value:function(){this.frameAva=new Phaser.Sprite(game,75*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"playSprites","Khung_Ava_Thuong"),this.frameAva.anchor.set(.5),this.frameAva.scale.set(.9),this.addChild(this.frameAva)}},{key:"addLineUnder",value:function(){var e=new Phaser.Sprite(game,(this.findOpponentConfig.line_friend_list.x+35)*window.GameConfig.RESIZE,this.findOpponentConfig.line_friend_list.y*window.GameConfig.RESIZE,this.findOpponentConfig.line_friend_list.nameAtlas,this.findOpponentConfig.line_friend_list.nameSprite);this.addChild(e)}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch(this.configsValue.friend_status,this.configsValue.id)}},{key:"addNameAva",value:function(e,t){this.txtName=new Phaser.Text(game,(e.x+35)*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,t,e.configs),this.addChild(this.txtName)}},{key:"addMaskAva",value:function(e){this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(),this.maskAva.drawCircle(0,0,e),this.maskAva.endFill(),this.maskAva.anchor.set(.5),this.ava.mask=this.maskAva,this.ava.addChild(this.maskAva)}},{key:"setStateFriend",value:function(){1==this.configsValue.is_online?this.setStateOnline():this.setStateOffline()}},{key:"setStateOnline",value:function(){var e=new Phaser.Sprite(game,85*window.GameConfig.RESIZE,71*window.GameConfig.RESIZE,"findOpponentSprites","Online");this.addChild(e)}},{key:"setStateOffline",value:function(){var e=new Phaser.Sprite(game,85*window.GameConfig.RESIZE,71*window.GameConfig.RESIZE,"findOpponentSprites","Offline");this.addChild(e)}},{key:"setValue",value:function(e){this.value=e,this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick)},this)}},{key:"setScale",value:function(e){this.ava.scale.set(e)}},{key:"beginLoad",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.key)&&e&&(""!==e.key?e.ava.loadTexture("".concat(e.key)):e.ava.loadTexture("songDetailSprites","ava-default"))}catch(e){}},100*this.index)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return 106}}])&&bs(n.prototype,i),o&&bs(n,o),t}();function ks(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ps=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"USER_PROFILE_LOAD_REQUEST",get:function(){return"USER_PROFILE_LOAD_REQUEST"}},{key:"USER_PROFILE_LOAD_RESPONSE",get:function(){return"USER_PROFILE_LOAD_RESPONSE"}},{key:"USER_FRIEND_REQUEST",get:function(){return"USER_FRIEND_REQUEST"}},{key:"USER_FRIEND_RESPONSE",get:function(){return"USER_FRIEND_RESPONSE"}},{key:"USER_DETAIL_LOAD_REQUEST",get:function(){return"USER_DETAIL_LOAD_REQUEST"}},{key:"USER_DETAIL_LOAD_RESPONSE",get:function(){return"USER_DETAIL_LOAD_RESPONSE"}},{key:"USER_DETAIL_PLAYLIST_LOAD_REQUEST",get:function(){return"USER_DETAIL_PLAYLIST_LOAD_REQUEST"}},{key:"USER_DETAIL_PLAYLIST_LOAD_RESPONSE",get:function(){return"USER_DETAIL_PLAYLIST_LOAD_RESPONSE"}},{key:"USER_DETAIL_ACHIEVEMENT_LOAD_REQUEST",get:function(){return"USER_DETAIL_ACHIEVEMENT_LOAD_REQUEST"}},{key:"USER_DETAIL_ACHIEVEMENT_LOAD_RESPONSE",get:function(){return"USER_DETAIL_ACHIEVEMENT_LOAD_RESPONSE"}},{key:"USER_DETAIL_FRIEND_LOAD_REQUEST",get:function(){return"USER_DETAIL_FRIEND_LOAD_REQUEST"}},{key:"USER_DETAIL_FRIEND_LOAD_RESPONSE",get:function(){return"USER_DETAIL_FRIEND_LOAD_RESPONSE"}},{key:"USER_FRIEND_LIST_LOAD_REQUEST",get:function(){return"USER_FRIEND_LIST_LOAD_REQUEST"}},{key:"USER_FRIEND_LIST_LOAD_RESPONSE",get:function(){return"USER_FRIEND_LIST_LOAD_RESPONSE"}}],(n=null)&&ks(t.prototype,n),i&&ks(t,i),e}();function Os(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Rs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){LogConsole.log("action "+e),LogConsole.log("friend_id "+t);var n=new SFS2X.SFSObject;return n.putUtfString("action",e),n.putInt("friend_id",t),n}},{key:"ACTION_ADD_FRIEND",get:function(){return"ADD_FRIEND"}},{key:"ACTION_ACCEPT_ADD_REQUEST",get:function(){return"ACCEPT_ADD_REQUEST"}},{key:"ACTION_REFUSE_ADD_REQUEST",get:function(){return"REFUSE_ADD_REQUEST"}},{key:"ACTION_REMOVE_FRIEND",get:function(){return"REMOVE_FRIEND"}}],(n=null)&&Os(t.prototype,n),i&&Os(t,i),e}();function xs(e){return(xs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ts(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Is(e,t){return!t||"object"!==xs(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function As(e){return(As=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ls(e,t){return(Ls=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gs=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Is(this,As(t).call(this,game,0,0,"bg_create_room"))).users=e,n.event={refreshSearch:new Phaser.Signal,getUserProfile:new Phaser.Signal},n.afterInit(),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ls(e,t)}(t,Phaser.Button),n=t,(o=[{key:"afterInit",value:function(){this.addEventExtension();var e=new Phaser.Group(game);e.x=0,e.y=220*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-239)*window.GameConfig.RESIZE);for(this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),i=0;i<this.users.length;i++){var n=new Cs(this.users[i],i);n.addInput(this.onInputFriend,this),n.signalInputAva.add(this.inputAva,this),this.listView.add(n)}if(0==this.users.length){var o=new Phaser.Text(game,320,270,"Không có kết quả phù hợp.",{font:"GilroyMedium",fill:"#eeeeee",fontSize:30});o.anchor.set(.5),this.addChild(o)}}},{key:"inputAva",value:function(e){this.event.getUserProfile.dispatch(e)}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.USER_FRIEND_RESPONSE&&(console.log(e.params.getDump()),"OK"==e.params.getUtfString("status")&&this.event.refreshSearch.dispatch())}},{key:"onInputFriend",value:function(e,t){e==Wa.NO_FRIEND&&this.sendUserFriendRequest(t),e==Wa.PENDING_YOU&&this.sendAcceptFriend(t)}},{key:"sendUserFriendRequest",value:function(e){TF.instance().sendData(Ps.USER_FRIEND_REQUEST,Rs.begin(Rs.ACTION_ADD_FRIEND,e))}},{key:"sendAcceptFriend",value:function(e){TF.instance().sendData(Ps.USER_FRIEND_REQUEST,Rs.begin(Rs.ACTION_ACCEPT_ADD_REQUEST,e))}},{key:"destroy",value:function(){for(this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Ts(n.prototype,o),a&&Ts(n,a),t}();var Ds=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=0,this.code="",this.genre="",this.active=0,this.id=1,this.priority=1,this.region="",this.choosed=!1};function Ms(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ns=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.objData={},this.arrLocal=[],this.arrInternational=[],this.arrAll=[]}var t,n,i;return t=e,(n=[{key:"resetData",value:function(){this.objData={},this.arrLocal=[],this.arrInternational=[],this.arrAll=[]}},{key:"setDataGenres",value:function(e){var t=new Ds;t=Object.assign({},t,e),this.objData[t.id]=t,"Local"===t.region?this.arrLocal.push(t.id):this.arrInternational.push(t.id),this.arrAll.push(t.id)}},{key:"getDataGenresByLocal",value:function(e){var t=[];if("Local"===e)for(var n=0;n<this.arrLocal.length;n++)t.push(this.objData[this.arrLocal[n]]);else for(var i=0;i<this.arrInternational.length;i++)"au_my"===this.objData[this.arrInternational[i]].code||t.push(this.objData[this.arrInternational[i]]);return t}},{key:"getAll",value:function(){for(var e=[],t=0;t<this.arrAll.length;t++)e.push(this.objData[this.arrAll[t]]);return e}}])&&Ms(t.prototype,n),i&&Ms(t,i),e}();var Bs=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.level=0,this.playlist_id=0,this.exp_score=0,this.created=0,this.active=0,this.id=0,this.current_level_score=0,this.next_level_score=0,this.updated=0,this.master=0};var js=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.is_highlight=0,this.used_times=0,this.thumb="",this.created=0,this.is_owner=0,this.description="",this.active=0,this.is_default=0,this.genre_id=0,this.price=0,this.is_general=0,this.name="",this.purchased_count=0,this.id=0,this.vip=0,this.is_solo_mode=0,this.updated=0,this.country_id=0,this.region="",this.user=new Bs};function Us(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Fs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.objData={},this.objGenres={},this.arrShop=[],this.arrMe=[]}var t,n,i;return t=e,(n=[{key:"resetData",value:function(){this.objData={},this.objGenres={},this.arrShop=[],this.arrMe=[]}},{key:"changeBuyItemById",value:function(e){this.objData[e]&&(this.objData[e].is_owner=1,this.setUpdateTimePlaylistById(e),this.objData[e].user.next_level_score=Ur.instance().playlist_level_setting[this.objData[e].user.level].exp_score)}},{key:"setDataMePlaylist",value:function(e,t){console.log("setDataMePlaylist : -----------------"+e),this.objData.hasOwnProperty(e)&&(this.objData[e].user=t,this.removePlaylistInArrShop(e))}},{key:"setDataPlayList",value:function(e){var t=new js;t=Object.assign({},t,e),this.objData[t.id]=t,this.objGenres.hasOwnProperty(t.genre_id)||(this.objGenres[t.genre_id]=[]),this.objGenres[t.genre_id].push(t.id),1==t.is_owner?1===t.active&&this.arrMe.push(t.id):this.arrShop.push(t.id)}},{key:"getArrByGenresId",value:function(e){var t=[];this.objGenres.hasOwnProperty(e)||(this.objGenres[e]=[]);for(var n=0;n<this.objGenres[e].length;n++)t.push(this.objData[this.objGenres[e][n]]);return t}},{key:"removePlaylistInArrShop",value:function(e){var t=this.arrShop.indexOf(e);t>-1&&(this.objData[e].is_owner=1,this.arrShop.splice(t,1),this.arrMe.push(e))}},{key:"getArrShop",value:function(){for(var e=[],t=0;t<this.arrShop.length;t++)e.push(this.objData[this.arrShop[t]]);return e}},{key:"getArrMe",value:function(){var e=[];console.log("this.arrMe : "),console.log(this.arrMe);for(var t=0;t<this.arrMe.length;t++)this.objData[this.arrMe[t]].user_playlist_mapping=this.objData[this.arrMe[t]].user,e.push(this.objData[this.arrMe[t]]);return e}},{key:"getSuggestPlaylist",value:function(){var e=Un.instance().randomNumber(0,this.arrShop.length-1);return this.objData[this.arrShop[e]]}},{key:"getPlayListById",value:function(e){return this.objData.hasOwnProperty(e)?(this.objData[e].user_playlist_mapping=this.objData[e].user,this.objData[e]):null}},{key:"setUpdateTimePlaylistById",value:function(e){if(this.objData.hasOwnProperty(e)){var t=new js;1===(t=Object.assign({},t,this.objData[e])).is_owner&&(t.user.updated=(new Date).getTime())}}},{key:"setExpPlaylistById",value:function(e){if(this.objData.hasOwnProperty(e)){var t=new js;if(1===(t=Object.assign({},t,this.objData[e])).is_owner)t.user.exp_score+=2,t.user.exp_score-t.user.current_level_score>t.user.next_level_score-t.user.current_level_score&&(t.user.level+=1,t.user.current_level_score=t.user.next_level_score,Ur.instance().playlist_level_setting[t.user.level]&&(t.user.next_level_score=Ur.instance().playlist_level_setting[t.user.level].exp_score)),this.setUpdateTimePlaylistById(e)}}}])&&Us(t.prototype,n),i&&Us(t,i),e}();function Zs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Hs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"SHOP_PLAYLIST_LOAD_REQUEST",get:function(){return"SHOP_PLAYLIST_LOAD_REQUEST"}},{key:"SHOP_PLAYLIST_LOAD_RESPONSE",get:function(){return"SHOP_PLAYLIST_LOAD_RESPONSE"}},{key:"SHOP_BUY_PLAYLIST_REQUEST",get:function(){return"SHOP_BUY_PLAYLIST_REQUEST"}},{key:"SHOP_BUY_PLAYLIST_RESPONSE",get:function(){return"SHOP_BUY_PLAYLIST_RESPONSE"}},{key:"PLAYLIST_DETAIL_REQUEST",get:function(){return"PLAYLIST_DETAIL_REQUEST"}},{key:"PLAYLIST_DETAIL_RESPONSE",get:function(){return"PLAYLIST_DETAIL_RESPONSE"}},{key:"PLAYLIST_CHANGE_ACTIVE_REQUEST",get:function(){return"PLAYLIST_CHANGE_ACTIVE_REQUEST"}},{key:"PLAYLIST_CHANGE_ACTIVE_RESPONSE",get:function(){return"PLAYLIST_CHANGE_ACTIVE_RESPONSE"}},{key:"RESOURCE_PACKAGE_LOAD_REQUEST",get:function(){return"RESOURCE_PACKAGE_LOAD_REQUEST"}},{key:"RESOURCE_PACKAGE_LOAD_RESPONSE",get:function(){return"RESOURCE_PACKAGE_LOAD_RESPONSE"}},{key:"RESOURCE_BUY_SUPPORT_ITEM_REQUEST",get:function(){return"RESOURCE_BUY_SUPPORT_ITEM_REQUEST"}},{key:"RESOURCE_BUY_SUPPORT_ITEM_RESPONSE",get:function(){return"RESOURCE_BUY_SUPPORT_ITEM_RESPONSE"}},{key:"RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_REQUEST",get:function(){return"RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_REQUEST"}},{key:"RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE",get:function(){return"RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE"}}],(n=null)&&Zs(t.prototype,n),i&&Zs(t,i),e}();function Qs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Vs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(){return new SFS2X.SFSObject}}],(n=null)&&Qs(t.prototype,n),i&&Qs(t,i),e}();function Ws(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var qs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"genres",get:function(){return"genres"}},{key:"parent",get:function(){return"parent"}},{key:"code",get:function(){return"code"}},{key:"genre",get:function(){return"genre"}},{key:"id",get:function(){return"id"}},{key:"priority",get:function(){return"priority"}},{key:"region",get:function(){return"region"}},{key:"playlists",get:function(){return"playlists"}},{key:"is_highlight",get:function(){return"is_highlight"}},{key:"thumb",get:function(){return"thumb"}},{key:"created",get:function(){return"created"}},{key:"is_owner",get:function(){return"is_owner"}},{key:"is_default",get:function(){return"is_default"}},{key:"genre_id",get:function(){return"genre_id"}},{key:"purchased",get:function(){return"purchased"}},{key:"songs",get:function(){return"songs"}},{key:"price",get:function(){return"price"}},{key:"is_general",get:function(){return"is_general"}},{key:"name",get:function(){return"name"}},{key:"vip",get:function(){return"vip"}},{key:"is_solo_mode",get:function(){return"is_solo_mode"}},{key:"updated",get:function(){return"updated"}},{key:"country_id",get:function(){return"country_id"}},{key:"status",get:function(){return"status"}},{key:"user_playlist_mapping",get:function(){return"user_playlist_mapping"}},{key:"user_id",get:function(){return"user_id"}},{key:"level",get:function(){return"level"}},{key:"playlist_id",get:function(){return"playlist_id"}},{key:"exp_score",get:function(){return"exp_score"}},{key:"active",get:function(){return"active"}},{key:"current_level_score",get:function(){return"current_level_score"}},{key:"next_level_score",get:function(){return"next_level_score"}},{key:"playlist",get:function(){return"playlist"}},{key:"author",get:function(){return"author"}},{key:"title",get:function(){return"title"}},{key:"singer",get:function(){return"singer"}},{key:"avatar",get:function(){return"avatar"}},{key:"file_path",get:function(){return"file_path"}},{key:"used_times",get:function(){return"used_times"}},{key:"song_links",get:function(){return"song_links"}},{key:"link_type",get:function(){return"link_type"}},{key:"song_id",get:function(){return"song_id"}},{key:"is_movie",get:function(){return"is_movie"}},{key:"link",get:function(){return"link"}},{key:"purchased_count",get:function(){return"purchased_count"}},{key:"description",get:function(){return"description"}}],(n=null)&&Ws(t.prototype,n),i&&Ws(t,i),e}();function Ks(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var zs=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event={call_load:new Phaser.Signal},this.arrUser=[]}var t,n,i;return t=e,(n=[{key:"resetData",value:function(){this.arrUser=[]}},{key:"setUser",value:function(e){this.arrUser.push(e)}},{key:"getUser",value:function(){if(this.arrUser.length>0){var e=this.arrUser[0];return this.arrUser.splice(0,1),1===this.arrUser.length&&this.event.call_load.dispatch(),e}return null}},{key:"getArrLenght",value:function(){return this.arrUser.length}}])&&Ks(t.prototype,n),i&&Ks(t,i),e}();var Ys=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.finish_at=0,this.created=0,this.description=0,this.banner=0,this.active=0,this.start_at=0,this.event_type="",this.name="",this.medal="",this.id=0,this.state="",this.updated=0,this.number_user=0,this.reward_1st={}};function Js(e){return(Js="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xs(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $s(e,t){return!t||"object"!==Js(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function er(e){return(er=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tr(e,t){return(tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nr=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=$s(this,er(t).call(this,game,0,0,null))).countNumber=0,e.timerToCountTime=null,e.event={complete:new Phaser.Signal},e.ktRed=!1,e.ktPlayTween=!1,e.positionEventMode=e.mainData.positionEventMode,e.clock=new rt(e.positionEventMode.selectroom_icon_clock),e.addChild(e.clock),e.txtCount=new _t(e.positionEventMode.selectroom_text_time_clock,""),e.txtCount.setTextBounds(0,0,77*z.instance().scale,24*z.instance().scale),e.addChild(e.txtCount),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tr(e,t)}(t,Mt),n=t,(i=[{key:"setTimer",value:function(e){var t=e-(new Date).getTime();this.countNumber=parseInt(t/1e3),this.setTextTimer(),this.stopCountTime(),this.timerToCountTime=this.game.time.create(!0),this.timerToCountTime.loop(1e3,this.onTimerToCountTime,this),this.timerToCountTime.start()}},{key:"setTextTimer",value:function(){var e,t="",n=parseInt(this.countNumber/3600),i=0,o=0;n>0?(t=n>9?n+":":"0"+n+":",i=parseInt(this.countNumber%3600/60),o=this.countNumber-(3600*n+60*i)):(i=parseInt(this.countNumber/60),o=this.countNumber%60),e=t+(i>9?i+":":"0"+i+":")+(o>9?o+"":"0"+o),0===n&&i<5?!1===this.ktPlayTween&&(this.ktPlayTween=!0):!0===this.ktPlayTween&&(this.ktPlayTween=!1),this.txtCount.text=e}},{key:"onTimerToCountTime",value:function(){this.countNumber--,this.countNumber<0&&(this.countNumber=0),0===this.countNumber&&(this.stopCountTime(),this.event.complete.dispatch()),LogConsole.log("this.ktPlayTween : "+this.ktPlayTween+" this.ktRed : "+this.ktRed),!0===this.ktPlayTween&&(!1===this.ktRed?(this.ktRed=!0,this.clock.tint=16711680):(this.ktRed=!1,this.clock.tint=16777215)),this.setTextTimer()}},{key:"getTime",value:function(){return this.countNumber}},{key:"stopCountTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy(),this.timerToCountTime=null)}},{key:"destroy",value:function(){this.stopCountTime(),this.removeAllItem()}}])&&Xs(n.prototype,i),o&&Xs(n,o),t}();function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function or(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ar(e,t){return!t||"object"!==ir(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sr(e){return(sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rr(e,t){return(rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lr=function(e){function t(e,n){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=ar(this,sr(t).call(this,game,0,0,null));var o="",a=new Date(e),s=new Date(n),r=a.getDate(),l=a.getMonth()+1,h=(a.getFullYear(),a.getHours()),c=a.getMinutes(),u=s.getDate(),d=s.getMonth()+1,f=s.getFullYear(),p=s.getHours(),g=s.getMinutes();return o=u===r?h+"h"+c+" - "+p+"h"+g+" "+u+"/"+d+"/"+f:h+"h"+c+" "+r+"/"+l+" - "+p+"h"+g+" "+u+"/"+d+"/"+f,LogConsole.log(r),LogConsole.log(l),i.positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),i.clock=new rt(i.positionEventMode.selectroom_icon_clock),i.clock.x=0,i.clock.y=2*z.instance().scale,i.addChild(i.clock),i.txtTime=new _t(i.positionEventMode.selectroom_text_time,o),i.addChild(i.txtTime),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rr(e,t)}(t,Mt),n=t,(i=[{key:"width",get:function(){return this.clock.width+this.txtTime.width+6*z.instance().scale}}])&&or(n.prototype,i),o&&or(n,o),t}();function hr(e){return(hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ur(e,t){return!t||"object"!==hr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dr(e){return(dr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fr(e,t){return(fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pr=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"otherSprites",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Nhactre";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ur(this,dr(t).call(this,game,0,0,n,i))).defaultImage=i,e.defaultAtlas=n,e._width=0,e._height=0,e.countLoad=0,e.isDefault=!0,e.afterCreate(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fr(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterCreate",value:function(){this.url="",this.loader=null,this.idTimeOut=null}},{key:"setSize",value:function(e,t){this._width=e,this._height=t,this.width=e,this.height=t}},{key:"beginLoad",value:function(e,t){this.url=e,this.idx=t,null!==this.idTimeOut&&clearTimeout(this.idTimeOut),""===this.url?this.default():game.cache.checkImageKey(this.url)?this.loadComplete():(this.removeLoader(),this.loader=new Phaser.Loader(game),this.loader.crossOrigin="anonymous",this.loader.onLoadStart.add(this.loadStart,this),this.loader.onLoadComplete.add(this.loadComplete,this),this.loader.image(e,e),this.loader.start())}},{key:"removeLoader",value:function(){null!=this.loader&&(this.loader.onLoadStart.remove(this.loadStart,this),this.loader.onLoadComplete.remove(this.loadComplete,this),this.loader.reset(),this.loader.removeAll(),this.loader=null)}},{key:"default",value:function(){!0===this.isDefault||(this.isDefault=!0,this.loadTexture(this.defaultAtlas,this.defaultImage),this.width=this._width,this.height=this._height)}},{key:"loadStart",value:function(){}},{key:"loadComplete",value:function(){var e=this;this.removeLoader(),this.idTimeOut=setTimeout(function(){e.onTimerToCountTime()},50*(this.idx+1))}},{key:"onTimerToCountTime",value:function(){this.showImage(this.url)}},{key:"showImage",value:function(e){game.cache.checkImageKey(e)&&(this.isDefault=!1,this.loadTexture(e),this.width=this._width,this.height=this._height)}},{key:"destroy",value:function(){this.timerToCountTime&&this.timerToCountTime.destroy(),null!==this.idTimeOut&&clearTimeout(this.idTimeOut),this.removeLoader()}}])&&cr(n.prototype,i),o&&cr(n,o),t}();function gr(e){return(gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mr(e,t){return!t||"object"!==gr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vr(e){return(vr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wr(e,t){return(wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var br=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=mr(this,vr(t).call(this,game,0,0,null))).positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),n.bg=new Zt(n.positionEventMode.queueroom_bg_win_item),n.addChild(n.bg),i&&(n.bg.height=50);var o=12*z.instance().scale;return LogConsole.log("---------------------------------"),e.diamond>0&&(n.txtDiamond=new _t(n.positionEventMode.queueroom_txt_win,e.diamond),i&&n.txtDiamond.changeStyle({fontSize:24}),n.txtDiamond.x=o,n.txtDiamond.y=(n.bg.height-n.txtDiamond.height)/2+3*z.instance().scale,n.addChild(n.txtDiamond),n.iconDiamon=new rt(n.positionEventMode.queueroom_icon_win_diamond),n.iconDiamon.x=n.txtDiamond.x+n.txtDiamond.width+3*z.instance().scale,n.iconDiamon.y=(n.bg.height-n.iconDiamon.height)/2,n.addChild(n.iconDiamon),o=n.iconDiamon.x+n.iconDiamon.width+12*z.instance().scale),e.ticket>0&&(n.txtTicket=new _t(n.positionEventMode.queueroom_txt_win,e.ticket),i&&n.txtTicket.changeStyle({fontSize:24}),n.txtTicket.x=o,n.txtTicket.y=(n.bg.height-n.txtTicket.height)/2+3*z.instance().scale,n.addChild(n.txtTicket),n.iconTicket=new rt(n.positionEventMode.queueroom_icon_win_ticket),n.iconTicket.x=n.txtTicket.x+n.txtTicket.width+3*z.instance().scale,n.iconTicket.y=(n.bg.height-n.iconTicket.height)/2,o=n.iconTicket.x+n.iconTicket.width+12*z.instance().scale,n.addChild(n.iconTicket)),e.support_item>0&&(n.txtSup=new _t(n.positionEventMode.queueroom_txt_win,e.support_item),i&&n.txtSup.changeStyle({fontSize:24}),n.txtSup.x=o,n.txtSup.y=(n.bg.height-n.txtSup.height)/2+3*z.instance().scale,n.addChild(n.txtSup),n.iconSup=new rt(n.positionEventMode.queueroom_icon_win_mic),n.iconSup.x=n.txtSup.x+n.txtSup.width+3*z.instance().scale,n.iconSup.y=(n.bg.height-n.iconSup.height)/2,n.addChild(n.iconSup),o=n.iconSup.x+n.iconSup.width+12*z.instance().scale),LogConsole.log("end ---------------------------------"),n.bg.width=o,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wr(e,t)}(t,Mt),n=t,(i=[{key:"hideBg",value:function(){this.bg.visible=!1}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&yr(n.prototype,i),o&&yr(n,o),t}();function _r(e){return(_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sr(e){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Er(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cr(e,t,n){return t&&Er(e.prototype,t),n&&Er(e,n),e}function kr(e,t){return(kr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Or=function(e){function t(e){var n,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=Sr(t).call(this,game,0,0,null))||"object"!==_r(o)&&"function"!=typeof o?Pr(i):o).event={choose_item:new Phaser.Signal,view_history:new Phaser.Signal},n.data=e,n.positionEventMode=n.mainData.positionEventMode,n.btnChoose=new pt(n.positionEventMode.selectroom_bg_default,n.chooseEvent,Pr(Pr(n))),n.btnChoose.alpha=0,n.addChild(n.btnChoose),n.bg=new pr(n.positionEventMode.selectroom_bg_default.nameAtlas,n.positionEventMode.selectroom_bg_default.nameSprite),n.bg.setSize(569*z.instance().scale,160*z.instance().scale),n.bg.beginLoad(n.data.banner,a),n.addChild(n.bg),n.bgWin=new br(n.data.reward_1st),n.bgWin.x=18*z.instance().scale,n.bgWin.y=19*z.instance().scale,n.addChild(n.bgWin),n.txtNameEvent=new _t(n.positionEventMode.selectroom_text_event_name,n.data.name),n.addChild(n.txtNameEvent),n.data.state===t.STATE_COMING?(n.timeEvent=new lr(n.data.start_at,n.data.finish_at),n.timeEvent.x=18*z.instance().scale,n.timeEvent.y=n.txtNameEvent.y+n.txtNameEvent.height,n.addChild(n.timeEvent)):n.data.state===t.STATE_STARTED?(n.countUser=new ca(n.positionEventMode.queueroom_button_count_user,n.data.number_user),n.addChild(n.countUser),n.bgWin.x=106*z.instance().scale,n.clock=new nr,n.clock.x=18*z.instance().scale,n.clock.y=n.txtNameEvent.y+n.txtNameEvent.height+3*z.instance().scale,n.clock.setTimer(n.data.finish_at),n.addChild(n.clock)):(n.txtXemKetqua=new _t(n.positionEventMode.selectroom_text_xemketqua,"XEM KẾT QUẢ"),n.txtXemKetqua.y=n.txtNameEvent.y+n.txtNameEvent.height+3*z.instance().scale,n.addChild(n.txtXemKetqua)),!0===n.data.vip&&(n.iconVip=new rt(n.positionEventMode.selectroom_icon_vip),n.addChild(n.iconVip)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kr(e,t)}(t,Mt),Cr(t,null,[{key:"STATE_FINISHED",get:function(){return"FINISHED"}},{key:"STATE_STARTED",get:function(){return"STARTED"}},{key:"STATE_COMING",get:function(){return"COMING"}}]),Cr(t,[{key:"setCuu",value:function(e){this.countUser&&(this.countUser.text=e)}},{key:"chooseEvent",value:function(){this.data.state===t.STATE_STARTED?this.clock.getTime()>5?this.event.choose_item.dispatch(this.data):IE.instance().addDialog("Sự kiện đã kết thúc."):this.data.state===t.STATE_COMING||this.event.view_history.dispatch(this.data.id)}},{key:"width",get:function(){return 640*z.instance().scale}},{key:"height",get:function(){return 160*z.instance().scale}}]),t}();function Rr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var xr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataEvent={},this.isStart=[],this.isWaitting=[],this.isEnd=[]}var t,n,i;return t=e,(n=[{key:"resetData",value:function(){this.dataEvent={},this.isStart=[],this.isWaitting=[],this.isEnd=[]}},{key:"setData",value:function(e){var t=new Ys;t=Object.assign({},t,e),this.dataEvent[t.id]=t,t.state===Or.STATE_COMING?this.isWaitting.push(t.id):t.state===Or.STATE_STARTED?this.isStart.push(t.id):this.isEnd.push(t.id)}},{key:"changeState",value:function(e,t){if(this.dataEvent.hasOwnProperty(e)){this.dataEvent[e].state=t;var n=this.isWaitting.indexOf(e);n>-1&&this.isWaitting.splice(n,1),(n=this.isStart.indexOf(e))>-1&&this.isStart.splice(n,1),(n=this.isEnd.indexOf(e))>-1&&this.isEnd.splice(n,1),this.dataEvent[e].state===Or.STATE_COMING?this.isWaitting.push(e):this.dataEvent[e].state===Or.STATE_STARTED?this.isStart.push(e):this.isEnd.push(e)}}},{key:"getWaittingRoom",value:function(){for(var e=[],t=0;t<this.isWaitting.length;t++)e.push(this.dataEvent[this.isWaitting[t]]);return e.sort(this.sortByTime)}},{key:"getStartRoom",value:function(){for(var e=[],t=0;t<this.isStart.length;t++)e.push(this.dataEvent[this.isStart[t]]);return e.sort(this.sortByTime)}},{key:"getEndRoom",value:function(){for(var e=[],t=0;t<this.isEnd.length;t++)e.push(this.dataEvent[this.isEnd[t]]);return e.sort(this.sortByTimeEnd)}},{key:"sortByTimeEnd",value:function(e,t){return e.finish_at<t.finish_at?1:e.finish_at>t.finish_at?-1:0}},{key:"sortByTime",value:function(e,t){return e.start_at<t.start_at?-1:e.start_at>t.start_at?1:0}}])&&Rr(t.prototype,n),i&&Rr(t,i),e}();function Tr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ir=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"events",get:function(){return"events"}},{key:"finish_at",get:function(){return"finish_at"}},{key:"created",get:function(){return"created"}},{key:"description",get:function(){return"description"}},{key:"banner",get:function(){return"banner"}},{key:"active",get:function(){return"active"}},{key:"start_at",get:function(){return"start_at"}},{key:"event_type",get:function(){return"event_type"}},{key:"name",get:function(){return"name"}},{key:"medal",get:function(){return"medal"}},{key:"id",get:function(){return"id"}},{key:"state",get:function(){return"state"}},{key:"updated",get:function(){return"updated"}},{key:"display_players",get:function(){return"display_players"}},{key:"question_index",get:function(){return"question_index"}},{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"is_dead",get:function(){return"is_dead"}},{key:"top_three",get:function(){return"top_three"}},{key:"event_id",get:function(){return"event_id"}},{key:"position",get:function(){return"position"}},{key:"achieved",get:function(){return"achieved"}},{key:"event_ranking",get:function(){return"event_ranking"}},{key:"your_rank",get:function(){return"your_rank"}},{key:"diamond",get:function(){return"diamond"}},{key:"event_reward",get:function(){return"event_reward"}},{key:"ticket",get:function(){return"ticket"}},{key:"support_item",get:function(){return"support_item"}},{key:"rank",get:function(){return"rank"}},{key:"reward_1st",get:function(){return"reward_1st"}},{key:"event_top_rank_log",get:function(){return"event_top_rank_log"}},{key:"top",get:function(){return"top"}},{key:"event",get:function(){return"event"}},{key:"number_user",get:function(){return"number_user"}},{key:"highest_achieved",get:function(){return"highest_achieved"}}],(n=null)&&Tr(t.prototype,n),i&&Tr(t,i),e}();function Ar(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Lr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reward=0,this.id=0,this.quest="",this.required=0,this.quest_type=0,this.order=0,this.reward_type=""}var t,n,i;return t=e,i=[{key:"get_quest",get:function(){return"quest"}},{key:"get_reward",get:function(){return"reward"}},{key:"get_id",get:function(){return"id"}},{key:"get_required",get:function(){return"required"}},{key:"get_quest_type",get:function(){return"quest_type"}},{key:"get_order",get:function(){return"order"}},{key:"get_reward_type",get:function(){return"reward_type"}}],(n=null)&&Ar(t.prototype,n),i&&Ar(t,i),e}();var Gr=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.created=0,this.quest_id=0,this.id=0,this.state="",this.updated=0};function Dr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Mr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ktSupport=!1,"undefined"!=typeof Storage&&(this.ktSupport=!0)}var t,n,i;return t=e,i=[{key:"VOTE",value:function(){return"vote"}},{key:"instance",value:function(){return this.controllStorage||(this.controllStorage=new e),this.controllStorage}}],(n=[{key:"setItem",value:function(e,t){this.ktSupport&&localStorage.setItem(e,t)}},{key:"getItem",value:function(e){return this.ktSupport?localStorage.getItem(e):"error"}},{key:"removeItem",value:function(e){this.ktSupport&&localStorage.removeItem(e)}}])&&Dr(t.prototype,n),i&&Dr(t,i),e}();function Nr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Br=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ktPush=!1,cordova.plugins&&cordova.plugins.notification&&cordova.plugins.notification.local&&(this.ktPush=!0,cordova.plugins.notification.local.on("add",this.addCallback,this),cordova.plugins.notification.local.on("trigger",this.triggerCallback,this),cordova.plugins.notification.local.on("click",this.clickCallback,this),cordova.plugins.notification.local.on("clear",this.clearCallback,this),cordova.plugins.notification.local.on("cancel",this.cancelCallback,this),cordova.plugins.notification.local.on("update",this.updateCallback,this),cordova.plugins.notification.local.on("clearall",this.clearallCallback,this),cordova.plugins.notification.local.on("cancelall",this.cancelallCallback,this))}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.pushLocal||(this.pushLocal=new e),this.pushLocal}}],(n=[{key:"addCallback",value:function(e){console.log("addCallback-----------------------------"),console.log(e)}},{key:"triggerCallback",value:function(e){console.log("triggerCallback-----------------------------"),console.log(e)}},{key:"clearCallback",value:function(e){console.log("clearCallback-----------------------------"),console.log(e)}},{key:"cancelCallback",value:function(e){console.log("cancelCallback-----------------------------"),console.log(e)}},{key:"updateCallback",value:function(e){console.log("updateCallback-----------------------------"),console.log(e)}},{key:"clearallCallback",value:function(e){console.log("clearallCallback-----------------------------"),console.log(e)}},{key:"cancelallCallback",value:function(e){console.log("cancelallCallback-----------------------------"),console.log(e)}},{key:"setLocalPush",value:function(e){this.ktPush&&cordova.plugins.notification.local.schedule(e)}},{key:"clearPush",value:function(e){cordova.plugins.notification.local.clear(e)}},{key:"add_minutes",value:function(e,t){return new Date(e.getTime()+6e4*t)}}])&&Nr(t.prototype,n),i&&Nr(t,i),e}();function jr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ur=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event={buy_playlist:new Phaser.Signal,event_update:new Phaser.Signal,load_online_mode_bet_complete:new Phaser.Signal,load_online_mode_room_bet_complete:new Phaser.Signal,load_event_list_complete:new Phaser.Signal,load_suggestion_opponent_complete:new Phaser.Signal,load_playlist_level_setting_complete:new Phaser.Signal,load_playlist_complete:new Phaser.Signal,load_random_opponent_complete:new Phaser.Signal,load_main_quest_complete:new Phaser.Signal},this.genres=new Ns,this.playlist=new Fs,this.playlist_level_setting={},this.quickplay_bet_setting=[],this.createroom_bet_setting=[],this.random_opponents=new zs,this.random_opponents.event.call_load.add(this.sendReloadRandomOpponent,this),this.roomEvent=new xr,this.suggestion_opponents=[],this.quests=[],this.quest_logs=[],this.ktLoadOnlineModeBet=!1,this.ktLoadOnlineModeRoomBet=!1,this.ktLoadEventList=!1,this.ktLoadSuggestionOpponent=!1,this.ktLoadPlaylistLevelSetting=!1,this.ktLoadPlaylist=!1,this.ktLoadRandomOpponent=!1,this.ktloadMainQuestComplete=!1,this.ktLoadingEventList=!1,TF.instance().events.onExtensionResponse.add(this.getData,this)}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.dataUser||(this.dataUser=new e),this.dataUser}}],(n=[{key:"resetData",value:function(){this.genres.resetData(),this.playlist.resetData(),this.playlist_level_setting={},this.quickplay_bet_setting=[],this.createroom_bet_setting=[],this.random_opponents.resetData(),this.roomEvent.resetData(),this.suggestion_opponents=[],this.quests=[],this.quest_logs=[],this.ktLoadOnlineModeBet=!1,this.ktLoadOnlineModeRoomBet=!1,this.ktLoadEventList=!1,this.ktLoadSuggestionOpponent=!1,this.ktLoadPlaylistLevelSetting=!1,this.ktLoadPlaylist=!1,this.ktLoadRandomOpponent=!1,this.ktloadMainQuestComplete=!1,this.ktLoadingEventList=!1}},{key:"getData",value:function(e){switch(e.cmd){case Hs.SHOP_PLAYLIST_LOAD_RESPONSE:case Pe.INIT_SHOP_PLAYLIST_RESPONSE:"OK"===e.params.getUtfString(qs.status)&&this.buildDataShop(e.params),this.event.load_playlist_complete.dispatch();break;case Hs.SHOP_BUY_PLAYLIST_RESPONSE:if(qe.instance().hideLoading(),"OK"===e.params.getUtfString(qs.status)){var t=e.params.getInt(qs.playlist_id);this.playlist.removePlaylistInArrShop(t),this.playlist.changeBuyItemById(t),this.event.buy_playlist.dispatch()}break;case Pe.INIT_CLIENT_GAME_DATA_RESPONSE:this.buildInitClientData(e.params);break;case Pe.EVENT_UPDATE:this.roomEventUpdate(e.params);break;case Pe.TURNBASE_RELOAD_RANDOM_OPPONENT_RESPONSE:var n=this.random_opponents.getArrLenght();"OK"===e.params.getUtfString(qs.status)&&this.buildRandomOpponent(e.params),0===n&&this.event.load_random_opponent_complete.dispatch();break;case Pe.INIT_ONLINE_MODE_BET_RESPONSE:"OK"===e.params.getUtfString(qs.status)&&this.buildOnlineModeBet(e.params),this.event.load_online_mode_bet_complete.dispatch();break;case Pe.INIT_ONLINE_MODE_ROOM_BET_RESPONSE:"OK"===e.params.getUtfString(qs.status)&&this.buildOnlineModeRoomBet(e.params),this.event.load_online_mode_room_bet_complete.dispatch();break;case Pe.INIT_EVENT_LIST_RESPONSE:!0===this.ktLoadEventList&&(this.ktLoadEventList=!1,"OK"===e.params.getUtfString(qs.status)&&this.buildEventList(e.params),this.event.load_event_list_complete.dispatch());break;case Pe.INIT_SUGGESTION_OPPONENT_RESPONSE:"OK"===e.params.getUtfString(qs.status)&&this.buildSuggestionOpponent(e.params),this.event.load_suggestion_opponent_complete.dispatch();break;case Pe.INIT_PLAYLIST_LEVEL_SETTING_RESPONSE:"OK"===e.params.getUtfString(qs.status)&&this.buildPlaylistLevelSetting(e.params),this.sendGetEventList(),this.checkChangeScreen(),this.event.load_playlist_level_setting_complete.dispatch();break;case Pe.INIT_MAIN_QUEST_DATA_RESPONSE:"OK"===e.params.getUtfString(qs.status)&&this.buildMainQuest(e.params),this.event.load_main_quest_complete.dispatch();break;case Pe.INIT_USER_PLAYLIST_MAPPING_RESPONSE:"OK"===e.params.getUtfString(qs.status)&&this.buildUserPlaylistMapping(e.params),this.sendGetPlaylistLevelSetting()}}},{key:"beginLoadData",value:function(){qe.instance().showLoading(),this.resetData(),this.sendGetDataShop()}},{key:"buildUserPlaylistMapping",value:function(e){if(e.containsKey("user_playlist_mappings"))for(var t=e.getSFSArray("user_playlist_mappings"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o=new Bs;o.user_id=i.getInt("user_id"),o.level=i.getInt("level"),o.playlist_id=i.getInt("playlist_id"),o.exp_score=i.getInt("exp_score"),o.created=i.getLong("created"),o.active=i.getInt("active"),o.id=i.getLong("id"),o.current_level_score=i.getInt("current_level_score"),o.next_level_score=i.getInt("next_level_score"),o.updated=i.getLong("updated"),this.playlist.setDataMePlaylist(o.playlist_id,o)}}},{key:"buildMainQuest",value:function(e){if(e.containsKey("quests"))for(var t=e.getSFSArray("quests"),n=0;n<t.size();n++){var i=new Lr,o=t.getSFSObject(n);i.reward=o.getInt("reward"),i.id=o.getInt("id"),i.quest=o.getUtfString("quest"),i.required=o.getInt("required"),i.quest_type=o.getInt("quest_type"),i.order=o.getInt("order"),i.reward_type=o.getUtfString("reward_type"),this.quests.push(i)}if(e.containsKey("quest_logs"))for(var a=e.getSFSArray("quest_logs"),s=0;s<a.size();s++){var r=new Gr,l=a.getSFSObject(s);r.user_id=l.getInt("user_id"),r.created=l.getLong("created"),r.quest_id=l.getInt("quest_id"),r.id=l.getLong("id"),r.state=l.getUtfString("state"),r.updated=l.getLong("updated"),this.quest_logs.push(r)}this.ktloadMainQuestComplete=!0}},{key:"buildRandomOpponent",value:function(e){if(e.containsKey("random_opponents")){for(var t=e.getSFSArray("random_opponents"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o={};o.gender=i.getUtfString("gender"),o.userName=i.getUtfString("user_name"),o.last_login=i.getLong("last_login"),o.genre_count=i.getLong("genre_count"),o.id=i.getInt("id"),o.avatar=i.getUtfString("avatar"),this.random_opponents.setUser(o)}this.ktLoadRandomOpponent=!0}}},{key:"buildPlaylistLevelSetting",value:function(e){if(e.containsKey("playlist_level_setting")){for(var t=e.getSFSArray("playlist_level_setting"),n=0;n<t.size();n++){var i=t.getSFSObject(n);this.playlist_level_setting[i.getInt("level")]=i.getInt("exp_score")}this.ktLoadPlaylistLevelSetting=!0}}},{key:"buildSuggestionOpponent",value:function(e){if(e.containsKey("suggestion_opponents")){for(var t=e.getSFSArray("suggestion_opponents"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o={};o.gender=i.getUtfString("gender"),o.user_name=i.getUtfString("user_name"),o.last_login=i.getLong("last_login"),o.id=i.getInt("id"),o.avatar=i.getUtfString("avatar"),this.suggestion_opponents.push(o)}this.ktLoadSuggestionOpponent=!0}}},{key:"buildEventList",value:function(e){if(e.containsKey("events")){for(var t=e.getSFSArray(Ir.events),n=0;n<t.size();n++){var i=t.getSFSObject(n),o=new Ys;if(o.finish_at=i.getLong(Ir.finish_at),o.created=i.getLong(Ir.created),o.description=i.getUtfString(Ir.description),o.banner=i.getUtfString(Ir.banner),o.active=i.getInt(Ir.active),o.start_at=i.getLong(Ir.start_at),o.event_type=i.getUtfString(Ir.event_type),o.name=i.getUtfString(Ir.name),o.medal=i.getUtfString(Ir.medal),o.id=i.getLong(Ir.id),o.state=i.getUtfString(Ir.state),o.updated=i.getLong(Ir.updated),i.containsKey(Ir.number_user)&&(o.number_user=i.getInt(Ir.number_user)),i.containsKey(Ir.reward_1st)){var a=i.getSFSObject(Ir.reward_1st);o.reward_1st.diamond=a.getInt(Ir.diamond),o.reward_1st.event_id=a.getLong(Ir.event_id),o.reward_1st.ticket=a.getInt(Ir.ticket),o.reward_1st.created=a.getLong(Ir.created),o.reward_1st.event_ranking=a.getUtfString(Ir.event_ranking),o.reward_1st.updated=a.getLong(Ir.updated),o.reward_1st.support_item=a.getInt(Ir.support_item)}this.roomEvent.setData(o)}this.ktLoadEventList=!0,this.checkSetLocalPush()}}},{key:"buildOnlineModeRoomBet",value:function(e){if(e.containsKey("online_mode_room_bet_setting")){for(var t=e.getSFSArray("online_mode_room_bet_setting"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o={};o.id=i.getInt("id"),o.bet_place=i.getInt("bet_place"),o.percent_of_fee=i.getInt("percent_of_fee"),this.createroom_bet_setting.push(o)}this.ktLoadOnlineModeRoomBet=!0}}},{key:"buildOnlineModeBet",value:function(e){if(e.containsKey("online_mode_bet_setting")){for(var t=e.getSFSArray("online_mode_bet_setting"),n=0;n<t.size();n++){var i=t.getSFSObject(n),o={};o.user_level_required=i.getInt("user_level_required"),o.id=i.getInt("id"),o.bet_place=i.getInt("bet_place"),o.percent_of_fee=i.getInt("percent_of_fee"),this.quickplay_bet_setting.push(o)}this.ktLoadOnlineModeBet=!0}}},{key:"roomEventUpdate",value:function(e){if("OK"===e.getUtfString(qs.status)){var t=e.getLong("event_id"),n=e.getUtfString("event_state");this.roomEvent.changeState(t,n),this.event.event_update.dispatch()}}},{key:"getNewPlaylist",value:function(e){this.playlist.removePlaylistInArrShop(e),this.playlist.changeBuyItemById(e)}},{key:"buildInitClientData",value:function(e){"OK"===e.getUtfString(qs.status)&&(this.buildOnlineModeBet(e),this.buildOnlineModeRoomBet(e),this.buildEventList(e),this.buildSuggestionOpponent(e),this.buildPlaylistLevelSetting(e),this.buildRandomOpponent(e),this.buildMainQuest(e),this.checkSetLocalPush()),this.checkChangeScreen()}},{key:"checkSetLocalPush",value:function(){var e=this.roomEvent.getWaittingRoom();if(e.length>0)for(var t=0;t<e.length;t++){var n=e[t].id,i=Mr.instance().getItem("RoomEvent"+n);if("error"===i||null===i||"null"===i){var o=(new Date).getTime();if(!(e[t].start_at-o<3e5)){var a="",s=new Date(e[t].start_at),r=new Date(e[t].finish_at),l=s.getDate(),h=s.getMonth()+1,c=s.getHours(),u=s.getMinutes(),d=r.getDate(),f=r.getMonth()+1,p=r.getFullYear(),g=r.getHours(),y=r.getMinutes();a=d===l?c+"h"+u+" - "+g+"h"+y+" "+d+"/"+f+"/"+p:c+"h"+u+" "+l+"/"+h+" - "+g+"h"+y+" "+d+"/"+f+"/"+p;var m={title:"Sự kiện "+e[t].name+" sắp bắt đầu",text:a,trigger:{at:new Date(e[t].start_at-3e5)}};Br.instance().setLocalPush(m),Mr.instance().setItem("RoomEvent"+n,!0);break}}}}},{key:"buildDataShop",value:function(e){if("OK"===e.getUtfString(qs.status)){for(var t=e.getSFSArray(qs.genres),n={},i={genres:[],playlists:[]},o=0;o<t.size();o++){var a=t.getSFSObject(o),s=new Ds;s.code=a.getUtfString(qs.code),s.genre=a.getUtfString(qs.genre),s.id=a.getInt(qs.id),s.region=a.getUtfString(qs.region),s.parent=a.getInt(qs.parent),s.priority=a.getInt(qs.priority),s.active=a.getInt(qs.active),n[s.id]=s.region,i.genres.push(s)}for(var r=e.getSFSArray(qs.playlists),l=0;l<r.size();l++){var h=r.getSFSObject(l),c=new js;if(c.is_highlight=h.getInt(qs.is_highlight),c.used_times=h.getInt(qs.used_times),c.thumb=h.getUtfString(qs.thumb),c.created=h.getLong(qs.created),c.is_owner=h.getInt(qs.is_owner),c.is_default=h.getInt(qs.is_default),c.genre_id=h.getInt(qs.genre_id),c.purchased=h.getInt(qs.purchased),c.songs=h.getUtfString(qs.songs),c.price=h.getInt(qs.price),c.is_general=h.getInt(qs.is_general),c.name=h.getUtfString(qs.name),c.id=h.getInt(qs.id),c.vip=h.getInt(qs.vip),c.is_solo_mode=h.getInt(qs.is_solo_mode),c.updated=h.getLong(qs.updated),c.country_id=h.getInt(qs.country_id),c.purchased_count=h.getInt(qs.purchased_count),c.active=h.getInt(qs.active),n.hasOwnProperty(c.genre_id)&&(c.region=n[c.genre_id]),h.containsKey(qs.user_playlist_mapping)){var u=h.getSFSObject(qs.user_playlist_mapping);u&&(c.user.user_id=u.getInt(qs.user_id),c.user.level=u.getInt(qs.level),c.user.playlist_id=u.getInt(qs.playlist_id),c.user.exp_score=u.getInt(qs.exp_score),c.user.created=u.getLong(qs.created),c.user.active=u.getInt(qs.active),c.user.id=u.getLong(qs.id),c.user.current_level_score=u.getInt(qs.current_level_score),c.user.next_level_score=u.getInt(qs.next_level_score),c.user.updated=u.getLong(qs.updated))}i.playlists.push(c)}this.setDataPlaylist(i),Mr.instance().setItem("playlist_reload_at",window.RESOURCE.playlist_reload_at),Mr.instance().setItem("playlist_data",JSON.stringify(i))}}},{key:"setDataPlaylist",value:function(e){for(var t=0;t<e.genres.length;t++)this.genres.setDataGenres(e.genres[t]);for(var n=0;n<e.playlists.length;n++)this.playlist.setDataPlayList(e.playlists[n]);this.ktLoadPlaylist=!0,this.sendGetUserPlaylistMapping()}},{key:"sendReloadRandomOpponent",value:function(){TF.instance().sendData(Pe.TURNBASE_RELOAD_RANDOM_OPPONENT_REQUEST,null)}},{key:"sendGetInitClientGameData",value:function(){TF.instance().sendData(Pe.INIT_CLIENT_GAME_DATA_REQUEST,null)}},{key:"sendGetDataShop",value:function(){var e=Mr.instance().getItem("playlist_reload_at");if("error"===e||null===e||"null"===e)TF.instance().sendData(Pe.INIT_SHOP_PLAYLIST_REQUEST,null);else if(e!==window.RESOURCE.playlist_reload_at)TF.instance().sendData(Pe.INIT_SHOP_PLAYLIST_REQUEST,null);else{var t=Mr.instance().getItem("playlist_data");"error"===t||null===t||"null"===t?TF.instance().sendData(Pe.INIT_SHOP_PLAYLIST_REQUEST,null):(this.setDataPlaylist(JSON.parse(t)),this.event.load_playlist_complete.dispatch())}}},{key:"setPlayList",value:function(e){this.playlist.setDataPlayList(e)}},{key:"sendGetOnlineModeBet",value:function(){TF.instance().sendData(Pe.INIT_ONLINE_MODE_BET_REQUEST,null)}},{key:"sendGetOnlineModeRoomBet",value:function(){TF.instance().sendData(Pe.INIT_ONLINE_MODE_ROOM_BET_REQUEST,null)}},{key:"sendGetEventList",value:function(){!1===this.ktLoadEventList&&(this.ktLoadEventList=!0,TF.instance().sendData(Pe.INIT_EVENT_LIST_REQUEST,null))}},{key:"sendGetSuggestionOpponent",value:function(){TF.instance().sendData(Pe.INIT_SUGGESTION_OPPONENT_REQUEST,null)}},{key:"sendGetPlaylistLevelSetting",value:function(){TF.instance().sendData(Pe.INIT_PLAYLIST_LEVEL_SETTING_REQUEST,null)}},{key:"sendGetMainQuest",value:function(){TF.instance().sendData(Pe.INIT_MAIN_QUEST_DATA_REQUEST,null)}},{key:"sendGetUserPlaylistMapping",value:function(){TF.instance().sendData(Pe.INIT_USER_PLAYLIST_MAPPING_REQUEST,null)}},{key:"checkChangeScreen",value:function(){qe.instance().hideLoading(),void 0!==z.instance().isNewUser&&1==z.instance().isNewUser?rF.instance().changeScreen(Ce.NEW_USER):rF.instance().changeScreen(Ce.MAIN_MENU)}}])&&jr(t.prototype,n),i&&jr(t,i),e}();function Fr(e){return(Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hr(e,t){return!t||"object"!==Fr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qr(e){return(Qr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vr(e,t){return(Vr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wr=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Hr(this,Qr(t).call(this,game))).event={choose_playlist:new Phaser.Signal,onBack:new Phaser.Signal,challengeGame:new Phaser.Signal},e.typeOfSearchFriend=t.NAME,e.valueKeyboard="",e.screenSearchResult=null,e.isClickSearch=!1,e.afterInit(),e}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vr(e,t)}(t,Phaser.Group),n=t,a=[{key:"NAME",get:function(){return"NAME"}},{key:"ID",get:function(){return"ID"}},{key:"MUST_INT",get:function(){return"Bạn phải nhập đúng ID(là số)!"}},{key:"MUST_GREATER_3",get:function(){return"Bạn phải nhập ít nhất 3 ký tự!"}}],(o=[{key:"afterInit",value:function(){this.findOpponentConfig=JSON.parse(game.cache.getText("findOpponentConfig")),this.findgameGroup=null,this.findGameSuggestionFriend=new ka,this.findGameSuggestionFriend.event.challengeGame.add(this.challengeGame,this),this.findGameRandomUser=new Na,this.findGameRandomUser.event.challengeGame.add(this.challengeGame,this),this.findGameHeaderAndTextInField=new cs,this.findGameHeaderAndTextInField.event.challengeGame.add(this.getChallengeGame,this),this.findGameHeaderAndTextInField.event.onBack.add(this.onBackFindGame,this),this.findGameHeaderAndTextInField.event.onSearch.add(this.onSearchFriend,this),this.findGameFriendlist=new ys,this.findGameFriendlist.event.challengeGame.add(this.challengeGame,this),this.addEventExtension(),this.sendRequestFindGame(),Le.instance().logEvent(Le.Find_Game_turnbase_mode)}},{key:"sendRequestFindGame",value:function(){this.checkRequestSocketFindGame(),0==z.instance().isChallengeGameFindOpponents.checking?(z.instance().friendLists=[],z.instance().suggestion_users=[],z.instance().random_user=null,this.sendTurnBaseFindOpponentRequest()):this.handleParamsOnFindOpponentsResponse(1,function(){})}},{key:"sendTurnBaseFindOpponentRequest",value:function(){TF.instance().sendData(Et.USER_FRIEND_LIST_LOAD_REQUEST,null),z.instance().isChallengeGameFindOpponents.checking=!0,z.instance().isChallengeGameFindOpponents.updated=Date.now()}},{key:"checkRequestSocketFindGame",value:function(){1==z.instance().isChallengeGameFindOpponents.checking?Date.now()-z.instance().isChallengeGameFindOpponents.updated<6e3?z.instance().isChallengeGameFindOpponents.checking=!0:z.instance().isChallengeGameFindOpponents.checking=!1:z.instance().isChallengeGameFindOpponents.checking=!1}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.clickOKDialog.add(this.clickOKDialog,this),De.instance().event.searchFriendBackUserProfile.add(this.searchFriendBackUserProfile,this),$r.instance().event.changeTypeSearch.add(this.changeTypeSearch,this),$r.instance().event.enter.add(this.onSubmitSearch,this),$r.instance().event.submit.add(this.onSubmitSearch,this),$r.instance().event.cancle.add(this.keyboardCancle,this),Ur.instance().event.load_random_opponent_complete.add(this.loadRandomOpponentComplete,this),Ur.instance().event.load_suggestion_opponent_complete.add(this.loadSuggestionUsersComplete,this)}},{key:"loadRandomOpponentComplete",value:function(){z.instance().random_user=Ur.instance().random_opponents.getUser(),this.doneHandleFindOpponentsRandomAndSuggestionResponse()}},{key:"loadSuggestionUsersComplete",value:function(){for(var e=[],t=0;t<3;t++)if(Ur.instance().suggestion_opponents[t]){var n=Ur.instance().suggestion_opponents[t];e.push(n)}z.instance().suggestion_users=e,this.handleRandomUser()}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),$r.instance().event.changeTypeSearch.remove(this.changeTypeSearch,this),$r.instance().event.submit.remove(this.onSubmitSearch,this),$r.instance().event.enter.remove(this.onSubmitSearch,this),De.instance().event.clickOKDialog.remove(this.clickOKDialog,this),De.instance().event.searchFriendBackUserProfile.remove(this.searchFriendBackUserProfile,this),$r.instance().event.cancle.remove(this.keyboardCancle,this),Ur.instance().event.load_random_opponent_complete.remove(this.loadRandomOpponentComplete,this),Ur.instance().event.load_suggestion_opponent_complete.remove(this.loadSuggestionUsersComplete,this)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.SEARCH_USER_BY_ID_RESPONSE&&(this.searchedUsers=this.handleSearchResponse(e.params),this.addScreenSearch(this.searchedUsers),qe.instance().hideLoading()),e.cmd==Et.SEARCH_USER_BY_NAME_RESPONSE&&(this.searchedUsers=this.handleSearchResponse(e.params),this.addScreenSearch(this.searchedUsers),qe.instance().hideLoading()),e.cmd==Et.USER_FRIEND_LIST_LOAD_RESPONSE&&this.handleParamsFriendList(e.params,function(){t.handleParamsOnFindOpponentsResponse(1,function(){})})}},{key:"handleParamsFriendList",value:function(e,t){if("OK"==e.getUtfString("status"))for(var n=e.getSFSArray("friends"),i=0;i<n.size();i++){for(var o=n.getSFSObject(i),a=o.getUtfString("user_name"),s=o.getUtfString("avatar"),r=o.getInt("id"),l=o.getBool("is_online"),h="NO_GAME",c=0;c<z.instance().menuOpponentsResponse.length;c++)if(r==z.instance().menuOpponentsResponse[c].opponentEntity.id){h=z.instance().menuOpponentsResponse[c].status;break}z.instance().friendLists.push({userName:a,avatar:s,id:r,isOnline:l,status:h})}t()}},{key:"doneHandleFindOpponentsRandomAndSuggestionResponse",value:function(){this.findGameSuggestionFriend.addGroupSuggestionFriend(),this.findGameSuggestionFriend.addSuggestionFriend(z.instance().suggestion_users,function(){}),this.findGameRandomUser.initGroup(),this.findGameRandomUser.addButtonRandomUser(z.instance().random_user),this.findGameRandomUser.addBtnInviteFriendFB(),this.doneHandleFindOpponentsResponse()}},{key:"doneHandleFindOpponentsResponse",value:function(){this.createFindGameScreenChooseFriend(),this.addChildInScreen()}},{key:"addChildInScreen",value:function(){this.addChild(this.findGameHeaderAndTextInField),this.addChild(this.findGameFriendlist),this.addChild(this.findGameSuggestionFriend),this.addChild(this.findGameRandomUser),qe.instance().hideLoading()}},{key:"addScreenSearch",value:function(e){this.removeScreenSearch(),this.screenSearchResult=new Gs(e),this.screenSearchResult.event.refreshSearch.add(this.refreshSearch,this),this.screenSearchResult.event.getUserProfile.add(this.getUserProfile,this),this.addChild(this.screenSearchResult),this.onSearchFriend()}},{key:"refreshSearch",value:function(){this.removeScreenSearch(),this.searchFriend(this.typeOfSearchFriend,this.valueKeyboard)}},{key:"getUserProfile",value:function(e){z.instance().isGetUserProfileSearch=!0,$r.instance().hide(),IE.instance().addUserProfile(e)}},{key:"searchFriendBackUserProfile",value:function(){this.onSearchFriend()}},{key:"removeScreenSearch",value:function(){null!==this.screenSearchResult&&(this.screenSearchResult.event.refreshSearch.remove(this.refreshSearch,this),this.screenSearchResult.event.getUserProfile.remove(this.getUserProfile,this),this.removeChild(this.screenSearchResult),this.screenSearchResult.destroy(),this.isClickSearch=!1,this.screenSearchResult=null)}},{key:"handleSearchResponse",value:function(e){var t=[];if(e.containsKey("user_founds")){var n=e.getSFSArray(vs.user_founds);for(i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString(vs.friend_status),s=o.getUtfString(vs.user_name),r=o.getBool(vs.is_online),l=o.getInt(vs.id),h=o.getUtfString(vs.avatar);t.push({friend_status:a,user_name:s,is_online:r,id:l,avatar:h})}}return t}},{key:"handleParamsOnFindOpponentsResponse",value:function(e,t){1==e&&(this.handleSuggestionUsers(),t())}},{key:"handleParamsFriendsOnFindOpponentsResponse",value:function(e,t){if("OK"==e.getUtfString("status"))for(var n=e.getSFSArray("friends"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString("user_name"),s=o.getUtfString("avatar"),r=o.getInt("id"),l=o.getUtfString("status"),h=o.getBool("is_online");z.instance().friendLists.push({userName:a,avatar:s,id:r,isOnline:h,status:l})}t()}},{key:"handleRandomUser",value:function(){1==Ur.instance().ktLoadRandomOpponent?this.loadRandomOpponentComplete():Ur.instance().sendReloadRandomOpponent()}},{key:"handleSuggestionUsers",value:function(){1==Ur.instance().ktLoadSuggestionOpponent?this.loadSuggestionUsersComplete():Ur.instance().sendGetSuggestionOpponent()}},{key:"getBuddyListFriend",value:function(e){this.listBuddy=[];for(var t=TF.instance().socket.buddyManager.getBuddyList(),n=0;n<t.length;n++){var i=t[n],o=new ua;o.avatar=i.getVariable("$"+fa.avatar).value,o.diamond=i.getVariable("$"+fa.diamond).value,o.isOnline=i[fa.isOnline],o.userId=i.getVariable("$"+fa.userId).value,o.userName=i.getVariable("$"+fa.userName).value,this.listBuddy.push(o)}this.listBuddy=this.listBuddy.sort(this.compareOnline),e()}},{key:"compareOnline",value:function(e){return 1==e.isOnline?-1:1}},{key:"createFindGameScreenChooseFriend",value:function(){var e=this;this.sortFriendlistsOfStatus(z.instance().friendLists,function(t){if(null==e.findgameGroup||null==e.findgameGroup){e.findgameGroup=new Phaser.Group(game),e.addChild(e.findgameGroup);var n=new Phaser.Button(game,0,0,"bg_create_room");e.findgameGroup.add(n),e.findGameFriendlist.afterInit(),e.findGameFriendlist.addListFriend(t),e.findGameHeaderAndTextInField.addHeader(t.length,t)}e.findgameGroup.position.x=0})}},{key:"getChallengeGame",value:function(e){LogConsole.log(e),this.event.challengeGame.dispatch(e)}},{key:"mergeListOnlineToListFriend",value:function(e){for(var t=[],n=0;n<this.listBuddy.length;n++)for(var i=0;i<this.friendLists.length;i++)if(this.friendLists[i].id==this.listBuddy[n].userId){var o={avatar:this.friendLists[i].avatar,id:this.friendLists[i].id,isOnline:this.listBuddy[n].isOnline,userName:this.friendLists[i].userName,status:this.friendLists[i].status};t.push(o)}e(t)}},{key:"sortFriendlistsOfStatus",value:function(e,t){t(e=e.sort(function(e,t){return e.status-t.status}))}},{key:"onBackFindGame",value:function(){0==this.isClickSearch?rF.instance().changeScreen(Ce.MAIN_MENU):(this.removeScreenSearch(),this.isClickSearch=!1)}},{key:"onSearchFriend",value:function(){var e=this,t="";""==this.valueKeyboard&&(t="Nhập tên"),setTimeout(function(){e.isClickSearch=!0,$r.instance().show({maxLength:"",showTransparent:!0,placeholder:t,isSearch:!0,isSearchFriend:!0,typeSearch:e.typeOfSearchFriend}),""!==e.valueKeyboard&&$r.instance().setValue(e.valueKeyboard)},100)}},{key:"challengeGame",value:function(e){this.event.challengeGame.dispatch(e)}},{key:"changeTypeSearch",value:function(e){this.typeOfSearchFriend=e}},{key:"onSubmitSearch",value:function(){if(this.valueKeyboard=$r.instance().getValue(),this.typeOfSearchFriend==t.ID){var e=this.valueKeyboard;"NaN"!==e&&e>0?this.searchFriend(this.typeOfSearchFriend,this.valueKeyboard):IE.instance().addDialog(t.MUST_INT)}else this.typeOfSearchFriend==t.NAME&&(this.valueKeyboard.length>2?this.searchFriend(this.typeOfSearchFriend,this.valueKeyboard):IE.instance().addDialog(t.MUST_GREATER_3));$r.instance().hide()}},{key:"searchFriend",value:function(e,n){this.searchedUsers=[];var i=new SFS2X.SFSObject;e==t.ID&&(i.putInt("user_id",parseInt(n)),TF.instance().sendData(Et.SEARCH_USER_BY_ID_REQUEST,i),qe.instance().showLoading()),e==t.NAME&&(i.putUtfString("user_name",n),TF.instance().sendData(Et.SEARCH_USER_BY_NAME_REQUEST,i),qe.instance().showLoading())}},{key:"clickOKDialog",value:function(){this.onSearchFriend()}},{key:"keyboardCancle",value:function(){this.removeScreenSearch()}},{key:"destroy",value:function(){for(this.removeEventExtension(),$r.instance().hide();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Zr(n.prototype,o),a&&Zr(n,a),t}();function qr(e){return(qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kr(e,t){return!t||"object"!==qr(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zr(e){return(zr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yr(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jr(e,t,n){return t&&Yr(e.prototype,t),n&&Yr(e,n),e}function Xr(e,t){return(Xr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $r=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Kr(this,zr(t).call(this,game,0,0,null))).event={enter:new Phaser.Signal,change:new Phaser.Signal,submit:new Phaser.Signal,cancle:new Phaser.Signal,changeHeight:new Phaser.Signal,hideKeyboard:new Phaser.Signal,changeTypeSearch:new Phaser.Signal},e.opened=!1,e.transparentObj=null,e.container=null,e.layoutChat=null,e.keyboardHeight=game.height,e.varTimeout=null,e.varTimeoutChange=null,window.addEventListener("resize",function(){e.varTimeout=setTimeout(function(){e.setStyleInput()},50)}),window.addEventListener("keyboardDidShow",function(t){console.log(t),"ios"===z.instance().platform?e.keyboardHeight=game.height-(screen.height-t.keyboardHeight)/game.scale.scaleFactorInversed.y+120:e.keyboardHeight=t.keyboardHeight/game.scale.scaleFactorInversed.y+Un.instance().getChangeHeight()+120,e.event.changeHeight.dispatch(e.keyboardHeight),e.changeHeightText()}),window.addEventListener("keyboardDidHide",function(t){console.log(t),e.event.hideKeyboard.dispatch()}),window.addEventListener("keyboardHeightWillChange",function(t){console.log(t.keyboardHeight);var n=0;n="ios"===z.instance().platform?game.height-(screen.height-t.keyboardHeight)/game.scale.scaleFactorInversed.y+120:t.keyboardHeight/game.scale.scaleFactorInversed.y+Un.instance().getChangeHeight()+120,e.keyboardHeight!==n&&(e.keyboardHeight=n,e.event.changeHeight.dispatch(e.keyboardHeight),e.changeHeightText())}),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xr(e,t)}(t,Mt),Jr(t,null,[{key:"instance",value:function(){return this.keyBoard||(this.keyBoard=new t),this.keyBoard}}]),Jr(t,[{key:"changeHeightText",value:function(){null!==this.layoutChat&&(this.layoutChat.y=game.height-this.keyboardHeight,this.layoutChat.y<0&&(this.layoutChat.y=0),this.setStyleInput()),game.world.add(this)}},{key:"setStyleInput",value:function(){if(LogConsole.log("setStyleInput"),LogConsole.log(game.canvas.getBoundingClientRect()),$("#chatInput").length){var e=game.canvas.getBoundingClientRect().width/game.width,t=game.canvas.getBoundingClientRect().height/game.height;console.log(game.scale);var n=Math.min(e,t);console.log(this.options.configText);var i=(window.innerWidth-game.canvas.getBoundingClientRect().width)/2,o={};o="input"===this.options.typeInputText?{top:game.canvas.getBoundingClientRect().top+this.options.configText.y*n+"px",left:i+this.options.configText.x*n+"px",width:(this.options.configText.width-24)*n+"px",height:(this.options.configText.height-5)*n+"px",position:"absolute"}:"chat"===this.options.typeInputText?{top:(game.canvas.getBoundingClientRect().top+(this.layoutChat.y+10))*n+"px",left:i+20*n+"px",width:480*n+"px",height:85*n+"px",position:"absolute"}:{top:game.canvas.getBoundingClientRect().top+105*n+"px",left:i+37*n+"px",width:460*n+"px",height:85*n+"px",position:"absolute"},console.log(o),o["font-size"]=30*n+"px",o["padding-left"]=10*n+"px",o["padding-right"]=10*n+"px",this.setStyleOnElement($("#chatInput"),o),$("#chatInput").focus()}}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.options=Object.assign({},{maxLength:"",showTransparent:!0,placeholder:"Nhập id phòng",isSearch:!1,isSearchFriend:!1,typeSearch:"NAME",typeInputText:"search",configText:{width:0,height:0,x:0,y:0}},e),null===this.container)this.container=new Phaser.Sprite(game,0,0,""),this.addChild(this.container);else for(null!=this.layoutChat&&(this.container.removeChild(this.layoutChat),this.layoutChat.destroy(!0),this.layoutChat=null);this.container.children.length>0;){var t=this.container.children[0];this.container.removeChild(t),t.destroy(),t=null}"input"===e.typeInputText||("chat"===e.typeInputText?this.addChat():this.addSearch()),!1===this.opened?(this.opened=!0,this.open(e.maxLength,e.placeholder||"")):this.setStyleInput(),e.defaultText&&this.setValue(e.defaultText),game.world.add(this)}},{key:"onUpBg",value:function(){this.hide()}},{key:"addSearch",value:function(){var e=this;null!=this.layoutChat&&(this.container.removeChild(this.layoutChat),this.layoutChat.destroy(!0),this.layoutChat=null);var t={x:0,y:0,nameAtlas:"defaultSource",nameSprite:"BG",left:4,right:4,top:4,bot:4,width:game.width,height:222,name:"chatBgkeyboard",configText:{x:0,y:0,style:{fontSize:25,font:"GilroyMedium",align:"left",boundsAlignH:"left",boundsAlignV:"middle"}}},n=new ca(t,"");n.input.useHandCursor=!1,this.container.addChild(n),this.options.hasOwnProperty("isSearchFriend")&&!0===this.options.isSearchFriend&&(this.isSearchFriend=!0,this.textName=new Phaser.Text(game,40,45,"Theo tên",{fontSize:25,font:"GilroyMedium",align:"left",fill:"#ffffff"}),n.addChild(this.textName),this.textName.inputEnabled=!0,this.options.hasOwnProperty("typeSearch")&&"ID"!==this.options.typeSearch?this.textName.activeTxt=!0:(this.textName.activeTxt=!1,this.textName.addColor("#8a8a8a",0)),this.textName.events.onInputUp.add(function(){1==e.textName.activeTxt||(e.textName.addColor("#ffffff",0),e.textName.activeTxt=!0),e.event.changeTypeSearch.dispatch(Wr.NAME)},this),n.addChild(this.addDoc(160,48)));var i={x:530,y:108,nameAtlas:"defaultSource",nameSprite:"Send_Icon"};this.options.hasOwnProperty("isSearch")&&!0===this.options.isSearch?i.nameSprite="Btn_Search_Icon":i.nameSprite="Send_Icon";var o=new pt(i,this.onSubmit,this),a=new pt({x:582,y:38,nameAtlas:"defaultSource",nameSprite:"Exit"},this.onCancel,this);n.addChild(o),n.addChild(a)}},{key:"addChat",value:function(){if(null===this.layoutChat){this.layoutChat=new Phaser.Sprite(game,0,0,"");var e={x:0,y:0,nameAtlas:"defaultSource",nameSprite:"BG",left:4,right:4,top:4,bot:4,width:game.width,height:120,name:"chatBgkeyboard",configText:{x:0,y:0,style:{fontSize:25,font:"GilroyMedium",align:"left",boundsAlignH:"left",boundsAlignV:"middle"}}},t=new ca(e,"");t.input.useHandCursor=!1,this.layoutChat.addChild(t);var n=new pt({x:545,y:23,nameAtlas:"defaultSource",nameSprite:"Close_Icon"},this.onCancel,this);this.layoutChat.addChild(n),this.layoutChat.y=game.height-this.keyboardHeight,this.layoutChat.y<0&&(this.layoutChat.y=0)}this.container.addChild(this.layoutChat)}},{key:"onSubmit",value:function(){this.event.submit.dispatch()}},{key:"onCancel",value:function(){this.event.cancle.dispatch(),this.hide()}},{key:"hide",value:function(){this.opened=!1,window.navigationbar&&window.navigationbar.hideNavigationBar(),"undefined"!=typeof StatusBar&&StatusBar.hide(),null!=this.layoutChat&&(this.container.removeChild(this.layoutChat),this.layoutChat.destroy(!0),this.layoutChat=null),null!=this.container&&(this.removeChild(this.container),this.container.destroy(!0),this.container=null),null!=this.transparentObj&&(this.transparentObj.destroy(!0),this.transparentObj=null),this.parent&&game.world.remove(this),null!==this.varTimeout&&(clearTimeout(this.varTimeout),this.varTimeout=null),null!=this.varTimeoutChange&&(clearTimeout(this.varTimeoutChange),this.varTimeoutChange=null),this.close()}},{key:"open",value:function(e,t){this.appendDOM(e,t)}},{key:"close",value:function(){$("#chatInput").length&&($("#game").remove("#chatInput"),$("#chatInput").remove())}},{key:"setValue",value:function(e){$("#chatInput").length&&$("#chatInput").val(e)}},{key:"getValue",value:function(){return $("#chatInput").length?$("#chatInput").val():""}},{key:"appendDOM",value:function(e,t){var n=this;this.close(),$("#game").append('<input id="chatInput" type="text" placeholder="'+t+'" value="" maxlength="'+e+'" autofocus>'),$("#chatInput").keypress(function(e){LogConsole.log("event.key : "+e.which),null!=n.varTimeoutChange&&clearTimeout(n.varTimeoutChange),13===e.which?(LogConsole.log("enter"),n.event.enter.dispatch()):n.varTimeoutChange=setTimeout(function(){n.event.change.dispatch()},300)}),this.setStyleInput()}},{key:"addDoc",value:function(e,t){return new Phaser.Sprite(game,e,t,"defaultSource","LineDoc")}},{key:"setStyleOnElement",value:function(e,t){e.css(t)}}]),t}();function el(e){return(el="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nl(e,t){return!t||"object"!==el(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function il(e){return(il=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ol(e,t){return(ol=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var al=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=nl(this,il(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.text=":)"==e||"(:"==e?"(smile)":":("==e||"):"==e?"(sad)":e,o.timeValue=n,o.checkShowTime=!1,o.isLastMess=i,o.index=0,o.event={showTime:new Phaser.Signal,hideTime:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ol(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.bgText=new Phaser.Group(game),this.addChild(this.bgText),this.text=new _t(this.positionMenuConfig.chat_screen.txt_mess,this.text),this.addChild(this.text);var e=40*window.GameConfig.RESIZE,t=70*window.GameConfig.RESIZE;this.configHeight=40*window.GameConfig.RESIZE;var n={x:35,y:22,nameAtlas:"mailSprites",nameSprite:"R_Chat_Violet",left:25,right:25,top:25,bot:25,width:0,height:0,name:"messageYour"};n.width=(this.text.width+e)/window.GameConfig.RESIZE,n.height=(this.text.height+e)/window.GameConfig.RESIZE,this.bg=new Zt(n),this.bgText.addChild(this.bg),this.text.x=this.bg.x+e/2,this.text.y=this.bg.y+e/2,this.addTimeSent(),1==this.isLastMess?this.height=this.bg.height+this.configHeight:this.height=this.bg.height+3,this.width=this.bg.width+t,this.bgText.x=window.GameConfig.GAME_WIDTH-this.width,this.text.x+=window.GameConfig.GAME_WIDTH-this.width,this.bg.inputEnabled=!0,this.bg.events.onInputUp.add(this.showTime,this)}},{key:"showTime",value:function(){0==this.checkShowTime?(this.event.showTime.dispatch(this.index),this.txtTime.revive(),this.checkShowTime=!0):(this.event.hideTime.dispatch(this.index),this.txtTime.kill(),this.checkShowTime=!1)}},{key:"setPosMess",value:function(e){void 0!==e?e.type==_l.THEIR_MESS&&(this.height=this.bg.height+this.configHeight):this.height=this.bg.height+this.configHeight}},{key:"addTimeSent",value:function(){this.timeValue=this.handleTime(),this.txtTime=new Phaser.Text(game,this.positionMenuConfig.chat_screen.txt_mess_time.x*window.GameConfig.RESIZE,this.bg.height+this.positionMenuConfig.chat_screen.txt_mess_time.y*window.GameConfig.RESIZE,"".concat(this.timeValue[1]," - ").concat(this.timeValue[0]),this.positionMenuConfig.chat_screen.txt_mess_time.style),this.addChild(this.txtTime),this.txtTime.kill()}},{key:"handleTime",value:function(){var e=this.timeValue.split(" "),t=e[0].split("-"),n=e[1].split(":");return[t[2]+"-"+t[1]+"-"+t[0],n[0]+":"+n[1]]}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&tl(n.prototype,i),o&&tl(n,o),t}();function sl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var rl=function(){function e(t,n,i,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.thumbUrl=o,this.index=a,this.sprite=game.add.sprite(t,n,"songDetailSprites",i),this.event={loadAvaDone:new Phaser.Signal},this.loadUrl()}var t,n,i;return t=e,(n=[{key:"loadUrl",value:function(){if(game.cache.checkImageKey(this.thumbUrl))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.thumbUrl,this.thumbUrl),e.start()}}},{key:"loadStart",value:function(){}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.thumbUrl)?(""!==e.thumbUrl?e.sprite.loadTexture(e.thumbUrl):e.sprite.loadTexture("songDetailSprites","ava-default"),e.event.loadAvaDone.dispatch(e.thumbUrl)):e.event.loadAvaDone.dispatch(e.thumbUrl)}catch(e){}},100*this.index)}}])&&sl(t.prototype,n),i&&sl(t,i),e}();function ll(e){return(ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cl(e,t){return!t||"object"!==ll(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ul(e){return(ul=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dl(e,t){return(dl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fl=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_l.YOUR_MESS,a=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=cl(this,ul(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),i.friend=e,i.text=":)"==n||"(:"==n?"(smile)":":("==n||"):"==n?"(sad)":n,i.beforeType=o,i.timeValue=a,i.checkShowTime=!1,i.isLastMess=s,i.index=0,i.event={clickAva:new Phaser.Signal,showTime:new Phaser.Signal,hideTime:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dl(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.bgText=new Phaser.Group(game),this.addChild(this.bgText),this.text=new _t(this.positionMenuConfig.chat_screen.txt_mess_friend,this.text),this.addChild(this.text),this.beforeType==_l.YOUR_MESS&&this.addAvaCircle();var e=40*window.GameConfig.RESIZE,t=35*window.GameConfig.RESIZE,n=70*window.GameConfig.RESIZE;this.configHeight=40*window.GameConfig.RESIZE;var i={x:77,y:22,nameAtlas:"mailSprites",nameSprite:"L_Chat_White",left:25,right:25,top:25,bot:25,width:0,height:0,name:"messageTheir"};i.width=(this.text.width+e)/window.GameConfig.RESIZE,i.height=(this.text.height+e)/window.GameConfig.RESIZE,this.bg=new Zt(i),this.bgText.addChild(this.bg),this.text.x=this.bg.x+e/2,this.text.y=this.bg.y+e/2,this.addTimeSent(),1==this.isLastMess?this.height=this.bg.height+this.configHeight:this.height=this.bg.height+3,this.width=this.bg.width+n,this.bgText.x=t,this.text.x+=t,this.ava&&(this.ava.x+=t,this.maskAva.x+=t),this.bg.inputEnabled=!0,this.bg.events.onInputUp.add(this.showTime,this)}},{key:"setPosMess",value:function(e){void 0!==e?e.type==_l.YOUR_MESS&&(this.height=this.bg.height+this.configHeight):this.height=this.bg.height+this.configHeight}},{key:"addAvaCircle",value:function(){var e=this;this.ava=new rl(this.positionMenuConfig.chat_screen.ava_friend.x*window.GameConfig.RESIZE,this.positionMenuConfig.chat_screen.ava_friend.y*window.GameConfig.RESIZE,"ava-default",this.friend.avatar),this.ava.sprite.inputEnabled=!0,this.ava.sprite.events.onInputUp.add(this.clickAva,this),this.ava.event.loadAvaDone.add(function(){e.ava.sprite.width=70,e.ava.sprite.height=70},this),this.addChild(this.ava.sprite),this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(16777215),this.maskAva.drawCircle(35*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,69*window.GameConfig.RESIZE),this.maskAva.anchor.set(.5),this.addChild(this.maskAva),this.ava.sprite.mask=this.maskAva}},{key:"clickAva",value:function(){IE.instance().addUserProfile(this.friend.id),this.event.clickAva.dispatch()}},{key:"showTime",value:function(){0==this.checkShowTime?(this.event.showTime.dispatch(this.index),this.txtTime.revive(),this.checkShowTime=!0):(this.event.hideTime.dispatch(this.index),this.txtTime.kill(),this.checkShowTime=!1)}},{key:"addTimeSent",value:function(){this.timeValue=this.handleTime(),this.txtTime=new Phaser.Text(game,this.positionMenuConfig.chat_screen.txt_mess_time_their.x*window.GameConfig.RESIZE,this.bg.height+this.positionMenuConfig.chat_screen.txt_mess_time_their.y*window.GameConfig.RESIZE,"".concat(this.timeValue[1]," - ").concat(this.timeValue[0]),this.positionMenuConfig.chat_screen.txt_mess_time_their.style),this.addChild(this.txtTime),this.txtTime.kill()}},{key:"handleTime",value:function(){var e=this.timeValue.split(" "),t=e[0].split("-"),n=e[1].split(":");return[t[2]+"-"+t[1]+"-"+t[0],n[0]+":"+n[1]]}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&hl(n.prototype,i),o&&hl(n,o),t}();function pl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var gl=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.coreUrl=window.RESOURCE.admin_domain,this.mainUrl="",this.method="",this.params={}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.ajaxServer||(this.ajaxServer=new e),this.ajaxServer}},{key:"LIMIT_10",get:function(){return 20}},{key:"OFF_SET_0",get:function(){return 0}}],(n=[{key:"sendData",value:function(e){$.ajax({type:this.method,url:this.mainUrl,data:this.params,dataType:"JSON",success:function(t){e(t)},error:function(e){LogConsole.log(e)}})}},{key:"countMessage",value:function(e){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/countMessage"),this.params={user_id:e,token:z.instance().token},this.method="GET"}},{key:"listConversation",value:function(e,t,n,i){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/listConversation"),this.params={user_from:e,user_to:t,limit:n,offset:i,token:z.instance().token},this.method="GET"}},{key:"listMessage",value:function(e,t,n){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/getMessenger"),this.params={user_id:e,limit:t,offset:n,token:z.instance().token},this.method="GET"}},{key:"sendMessage",value:function(e,t,n){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/sendMessenger"),this.params={user_from:e,user_to:t,message:n,token:z.instance().token},this.method="GET"}},{key:"getNotiSystem",value:function(e,t,n){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/getNotification"),this.params={user_id:e,limit:t,offset:n,token:z.instance().token},this.method="GET"}},{key:"seeNoticeSystem",value:function(e,t){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/seenNotification"),this.params={user_id:e,message_id:t,token:z.instance().token},this.method="GET"}},{key:"settingAccount",value:function(e,t,n,i,o){this.cleanData(),this.mainUrl="".concat(this.coreUrl,"api/settingGame"),this.params={user_id:e,user_name:t,gender:n,avatar:i,description:o,token:z.instance().token},this.method="POST"}},{key:"cleanData",value:function(){this.coreUrl=window.RESOURCE.admin_domain,this.mainUrl="",this.method="",this.params={}}}])&&pl(t.prototype,n),i&&pl(t,i),e}();function yl(e){return(yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ml(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vl(e,t){return!t||"object"!==yl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wl(e){return(wl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bl(e,t){return(bl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _l=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=vl(this,wl(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.friend=e,n.clickAvaFriend=!1,n.countMessSend=0,n.afterInit(),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bl(e,t)}(t,Phaser.Group),n=t,a=[{key:"YOUR_MESS",get:function(){return"YOUR_MESS"}},{key:"THEIR_MESS",get:function(){return"THEIR_MESS"}}],(o=[{key:"afterInit",value:function(){this.listView=null,this.heightDefault=144,this.listMessageOld=[],this.isHasNewMess=!1,this.bg,this.headerTab,this.scrollListChat,this.boxKeyboard,this.addBG(),this.addScrollListChat(),this.ajaxGetMessages(),this.addBoxKeyboard(),this.addEventExtension(),this.addHeaderTab()}},{key:"ajaxGetMessages",value:function(){gl.instance().listConversation(TF.instance().socket.mySelf.getVariable("user_id").value,this.friend.id,gl.LIMIT_10,gl.OFF_SET_0),gl.instance().sendData(this.onGetListConversationCallback.bind(this)),this.timeCounting=game.time.events.add(2*Phaser.Timer.SECOND,this.ajaxGetMessages,this)}},{key:"onGetListConversationCallback",value:function(e){if(this.listMessageNew=[],qe.instance().hideLoading(),"ok"==e.code){for(var n=e.data.messages.mes,i=[],o=n.length;o>0;o--){var a=n[o-1];a.from==this.friend.id?a.type=t.THEIR_MESS:a.type=t.YOUR_MESS,i.push(a)}this.listMessageNew=i}if(this.listMessageOld.length>19)if(this.listMessageNew[this.listMessageNew.length-1].message==this.listMessageOld[this.listMessageOld.length-1].message&&this.listMessageNew[this.listMessageNew.length-1].created==this.listMessageOld[this.listMessageOld.length-1].created);else for(var s=this.listMessageNew.length;s>0;s--)if(this.listMessageNew[s-1].message==this.listMessageOld[this.listMessageOld.length-1].message&&this.listMessageNew[s-1].created==this.listMessageOld[this.listMessageOld.length-1].created){this.listMessageOld.splice(0,this.listMessageNew.length-s);break}this.addListMess()}},{key:"addBG",value:function(){this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg)}},{key:"addHeaderTab",value:function(){this.headerTab=new Phaser.Group(game,0,0),this.tab=new rt(this.positionMenuConfig.chat_screen.header.tab),this.headerTab.addChild(this.tab),this.btnBack=new pt(this.positionMenuConfig.chat_screen.header.back,this.onBack,this),this.btnBack.anchor.set(.5),this.headerTab.addChild(this.btnBack),this.nameFriend=new _t(this.positionMenuConfig.chat_screen.header.name,this.friend.user_name),this.nameFriend.anchor.set(.5),this.headerTab.addChild(this.nameFriend),this.addChild(this.headerTab)}},{key:"onBack",value:function(){0==this.clickAvaFriend?this.destroy():this.clickAvaFriend=!1}},{key:"addScrollListChat",value:function(){this.removeScrollListChat(),this.group=new Phaser.Group(game),this.addChild(this.group);var e=new Phaser.Rectangle(0,0*window.GameConfig.RESIZE,game.width,(game.height-this.heightDefault-30)*window.GameConfig.RESIZE);this.group.y=66,this.listView=new Vo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}},{key:"removeScrollListChat",value:function(){null!==this.listView&&(this.removeChild(this.group),this.group.remove(this.listView),this.listView.removeAll(),this.listView.destroy(),this.listView=null,this.group=null)}},{key:"addListMess",value:function(){for(var e=this.listMessageOld.length;e<this.listMessageNew.length;e++){this.isHasNewMess=!0;var n=!1;if(e==this.listMessageNew.length-1&&(n=!0),this.listMessageNew[e].type==t.YOUR_MESS){e>0&&e===this.listMessageOld.length&&this.listMessageNew[e-1].type==t.THEIR_MESS&&(this.listView.grp.children[this.listView.grp.children.length-1].height=this.listView.grp.children[this.listView.grp.children.length-1].bg.height+40);var i=new al(this.listMessageNew[e].message,this.listMessageNew[e].created,n);i.event.showTime.add(this.onClickShowTime,this),i.event.hideTime.add(this.onHideTimeItem,this),i.setPosMess(this.listMessageNew[e+1]),this.listView.add(i),i.index=this.listView.grp.children.length-1}else if(e>0){this.listMessageNew[e-1].type==t.THEIR_MESS&&(this.listView.grp.children[this.listView.grp.children.length-1].height=this.listView.grp.children[this.listView.grp.children.length-1].bg.height+3);var o=new fl(this.friend,this.listMessageNew[e].message,this.listMessageNew[e-1].type,this.listMessageNew[e].created,n);o.event.clickAva.add(this.onClickAvaFr,this),o.event.showTime.add(this.onClickShowTime,this),o.event.hideTime.add(this.onHideTimeItem,this),o.setPosMess(this.listMessageNew[e+1]),this.listView.add(o),o.index=this.listView.grp.children.length-1}else{var a=new fl(this.friend,this.listMessageNew[e].message,t.YOUR_MESS,this.listMessageNew[e].created,n);a.event.clickAva.add(this.onClickAvaFr,this),a.event.showTime.add(this.onClickShowTime,this),a.event.hideTime.add(this.onHideTimeItem,this),a.setPosMess(this.listMessageNew[e+1]),this.listView.add(a),a.index=this.listView.grp.children.length-1}this.listMessageOld.push(this.listMessageNew[e])}1==this.isHasNewMess&&(this.isHasNewMess=!1,this.listView.grp.children.length>0&&this.listView.tweenToItem(this.listView.grp.children.length-1))}},{key:"onClickShowTime",value:function(e){for(i=e;i<this.listView.grp.children.length-1;i++){game.add.tween(this.listView.grp.children[i+1]).to({y:this.listView.grp.children[i+1].y+30},100,"Linear",!0).start()}}},{key:"onHideTimeItem",value:function(e){for(i=e;i<this.listView.grp.children.length-1;i++){game.add.tween(this.listView.grp.children[i+1]).to({y:this.listView.grp.children[i+1].y-30},100,"Linear",!0).start()}}},{key:"onClickAvaFr",value:function(){this.clickAvaFriend=!0}},{key:"addBoxKeyboard",value:function(){this.boxKeyboard=new rt(this.positionMenuConfig.chat_screen.keyboard.bg),this.boxKeyboard.y=game.height-107,this.addChild(this.boxKeyboard),this.whiteSpace=new Zt(this.positionMenuConfig.chat_screen.white_space),this.boxKeyboard.addChild(this.whiteSpace);var e=new _t(this.positionMenuConfig.chat_screen.txt_white_space,this.positionMenuConfig.chat_screen.txt_white_space.text);this.whiteSpace.addChild(e),this.btnSend=new pt(this.positionMenuConfig.chat_screen.btn_send,this.onClickSend,this),this.boxKeyboard.addChild(this.btnSend),this.boxKeyboard.inputEnabled=!0,this.boxKeyboard.events.onInputUp.add(this.inputKeyboard,this)}},{key:"onClickSend",value:function(){this.keyboardDone()}},{key:"inputKeyboard",value:function(){ce.instance().playSound(ce.buttonclick);var e={maxLength:"",showTransparent:!0,placeholder:"Nhắn tin",isSearch:!1,typeInputText:"input",configText:{width:this.whiteSpace.width,height:this.whiteSpace.height,x:this.boxKeyboard.x+36,y:this.boxKeyboard.y+21}};$r.instance().show(e)}},{key:"keyboardClose",value:function(){$r.instance().hide(),this.boxKeyboard.revive(),this.heightDefault=144,this.listMessageOld=[],this.addScrollListChat(),this.addListMess()}},{key:"keyboardDone",value:function(){this.message=$r.instance().getValue(),this.addNewMessage(),$r.instance().setValue("")}},{key:"hideKeyboard",value:function(){this.keyboardClose()}},{key:"addNewMessage",value:function(){qe.instance().showLoading(),gl.instance().sendMessage(TF.instance().dataMySeft.user_id,this.friend.id,this.message),gl.instance().sendData(this.onSendSuccess.bind(this))}},{key:"handleNewTime",value:function(){var e=(new Date).toISOString().split("T");return e[1]=e[1].split("Z"),e[1]=e[1][0],e[0]+" "+e[1]}},{key:"onSendSuccess",value:function(e){this.listView.grp.children[this.listView.grp.children.length-1].height=this.listView.grp.children[this.listView.grp.children.length-1].bg.height+3}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this),$r.instance().event.changeHeight.add(this.onChangeHeightKeyboard,this),$r.instance().event.cancle.add(this.keyboardClose,this),$r.instance().event.enter.add(this.keyboardDone,this),$r.instance().event.submit.add(this.keyboardDone,this),$r.instance().event.hideKeyboard.add(this.hideKeyboard,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this),$r.instance().event.changeHeight.remove(this.onChangeHeightKeyboard,this),$r.instance().event.cancle.remove(this.keyboardClose,this),$r.instance().event.enter.remove(this.keyboardDone,this),$r.instance().event.submit.remove(this.keyboardDone,this),$r.instance().event.hideKeyboard.remove(this.hideKeyboard,this)}},{key:"onChangeHeightKeyboard",value:function(e){var t={maxLength:"",showTransparent:!0,placeholder:"Nhắn tin",isSearch:!1,typeInputText:"chat",configText:{width:this.whiteSpace.width,height:this.whiteSpace.height,x:this.boxKeyboard.x+35,y:this.boxKeyboard.y+17}};$r.instance().show(t),this.listMessageOld=[],this.heightDefault=e+35,this.addScrollListChat(),this.addListMess()}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.keyboardClose(),De.instance().event.backChat.dispatch(),null!==this.listView&&(this.listView.removeAll(),this.listView.destroy(),this.listView=null),game.time.events.remove(this.timeCounting);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&ml(n.prototype,o),a&&ml(n,a),t}();function Sl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var El=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sound=null,this.playId=null,this.isLoading=!1,this.src="",this.event={loadComplete:new Phaser.Signal,playSoundComplete:new Phaser.Signal,loadFail:new Phaser.Signal},this.currentLoad=null,this.dic={},this.arrSrc=[],this.idxLoad=0,this.idDelayCall=null}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllSound||(this.controllSound=new e),this.controllSound}}],(n=[{key:"loadSound",value:function(e){var t=this;console.log("loadSound : ------- : "+e),this.dic[e]=new Howl({src:[Un.instance().genUrlSound(e)]}),this.dic[e].once("load",function(e){t.event.loadComplete.dispatch()}),this.dic[e].once("loaderror",function(){console.log("load fail------------------- : "+e),t.loadSound(e),t.event.loadFail.dispatch()})}},{key:"loadSoundArray",value:function(e){!1===this.isLoading&&(this.src="",this.arrSrc=e,this.isLoading=!0,this.idxLoad=0,this.loadItemInArray(this.arrSrc[this.idxLoad]),this.removeDelayCall(),this.idDelayCall=game.time.events.add(30*Phaser.Timer.SECOND,this.callLoadFail,this))}},{key:"removeDelayCall",value:function(){null!==this.idDelayCall&&(game.time.events.remove(this.idDelayCall),this.idDelayCall=null)}},{key:"callLoadFail",value:function(){this.event.loadFail.dispatch(),this.removeAllSound()}},{key:"loadItemInArray",value:function(e){var t=this;this.dic[e]?this.checkLoadContinuteArray():(this.dic[e]=new Howl({src:[Un.instance().genUrlSound(e)]}),this.dic[e].once("load",function(){t.checkLoadContinuteArray()}),this.dic[e].once("loaderror",function(){t.idxLoad--,t.checkLoadContinuteArray()}))}},{key:"checkLoadContinuteArray",value:function(){LogConsole.log("cccccccheckLoadContinuteArray"),this.idxLoad++,this.idxLoad<this.arrSrc.length?this.loadItemInArray(this.arrSrc[this.idxLoad]):(LogConsole.log("checkLoadContinuteArray"),this.isLoading=!1,this.event.loadComplete.dispatch(),this.removeDelayCall())}},{key:"playsound",value:function(e){!1===game.paused&&(this.removeSound(),this.src=e,console.log(" playsound :  "+this.src),console.log(this.dic),"ctx"in Howler&&null!==Howler.ctx&&("suspended"!==Howler.ctx.state&&"interrupted"!==Howler.ctx.state||Howler.ctx.resume()),this.dic.hasOwnProperty(e)?(console.log("load roi ---------"),this.sound=this.dic[e],this.playId=this.sound.play()):(console.log("chua load ---------"),this.sound=this.dic[e]=new Howl({src:[Un.instance().genUrlSound(e)]}),this.sound.once("end",function(){console.log("Finish play")}),this.playId=this.sound.play()),this.sound.volume(1))}},{key:"pauseSound",value:function(){!1===game.paused&&null!=this.sound&&this.sound.pause(this.playId)}},{key:"resumeSound",value:function(){!1===game.paused&&null!=this.sound&&this.sound.play(this.playId)}},{key:"removeAllSound",value:function(){for(var e in console.log("removeAllSound--------"),this.dic){var t=this.dic[e];t.stop(),t.unload(),t=null}this.dic={},this.isLoading=!1,this.removeSound(),this.src="",null!==this.currentLoad&&(this.currentLoad.stop(this.playId),this.currentLoad.unload(),this.currentLoad=null)}},{key:"removeSound",value:function(){if(console.log("removeSound : "+this.src),null!==this.sound&&(this.sound.stop(this.playId),this.sound.unload(),this.sound=null),""!==this.src&&this.dic[this.src]){var e=this.dic[this.src];e.stop(),e.unload(),e=null,delete this.dic[this.src],this.src=""}}},{key:"removeSoundFromUrl",value:function(e){if(console.log("removeSoundFromUrl---------------- : "+e),""!==e&&this.dic[e]){var t=this.dic[e];t.stop(),t.unload(),t=null,delete this.dic[e]}}}])&&Sl(t.prototype,n),i&&Sl(t,i),e}();function Cl(e){return(Cl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pl(e,t){return!t||"object"!==Cl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ol(e){return(Ol=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rl(e,t){return(Rl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xl=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Pl(this,Ol(t).call(this,game,e,n,null))).ava,o.btnPlay,o.btnPause,o.nameSong,o.nameSinger,o.checkAudioStop=!1,o.configsValue=i,o.songListen,o.urlSong=o.configsValue.listenLink,o.key="",o.isPlay=!1,o.tween,o.spriteTween,o.songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rl(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addAva(this.songDetailScreenConfig.songDetail.ava),this.addNameSong(this.songDetailScreenConfig.songDetail.nameSong),this.addNameSinger(this.songDetailScreenConfig.songDetail.nameSinger),this.loadToPlay()}},{key:"loadToPlay",value:function(){if(this.checkAudioStop=!1,game.cache.checkSoundKey(this.urlSong))this.onLoadAudio();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadComplete.addOnce(this.onLoadAudio,this),El.instance().loadSound(this.urlSong),e.start()}}},{key:"addAva",value:function(e){this.ava=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.ava.scale.set(1*window.GameConfig.RESIZE),this.ava.anchor.set(.5,0),this.addChild(this.ava);var t=new Phaser.Graphics(game,0,0);t.beginFill(16777215),t.drawRoundedRect((e.x-118)*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,237*window.GameConfig.RESIZE,237*window.GameConfig.RESIZE,15),t.anchor.set(.5),this.addChild(t),this.ava.mask=t,this.beginLoad(this.configsValue.thumb)}},{key:"beginLoad",value:function(e){if(e&&(this.key=e),game.cache.checkImageKey(this.key))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadComplete.add(this.onLoad,this),t.image(this.key,this.key),t.start()}}},{key:"onLoad",value:function(){game.cache.checkImageKey(this.key)&&this.ava.loadTexture(this.key)}},{key:"addBtnPlayAndPause",value:function(e){this.btnPlay=new Phaser.Sprite(game,e.btn_play.x*window.GameConfig.RESIZE,e.btn_play.y*window.GameConfig.RESIZE,e.btn_play.nameAtlas,e.btn_play.nameSprite),this.btnPlay.inputEnabled=!0,this.btnPlay.events.onInputUp.add(this.onPlay,this),this.btnPause=new Phaser.Sprite(game,e.btn_pause.x*window.GameConfig.RESIZE,e.btn_pause.y*window.GameConfig.RESIZE,e.btn_pause.nameAtlas,e.btn_pause.nameSprite),this.btnPause.inputEnabled=!0,this.btnPause.events.onInputUp.add(this.onPause,this),this.btnPause.kill(),this.addChild(this.btnPlay),this.addChild(this.btnPause)}},{key:"onPlay",value:function(){ce.instance().playSound(ce.buttonclick),this.isPlay?(this.tween.resume(),El.instance().resumeSound(this.urlSong)):(this.spriteTween=new Phaser.Sprite(game,this.ava.x-118*window.GameConfig.RESIZE,this.ava.y+237*window.GameConfig.RESIZE,"otherSprites","tween-time"),this.addChild(this.spriteTween),this.tween=game.add.tween(this.spriteTween.scale).to({x:27,y:1},10500,"Linear"),El.instance().playsound(this.urlSong),this.tween.start(),this.tween.onComplete.add(this.tweenComplete,this),this.checkAudioStop=!1,this.isPlay=!0),this.btnPlay.kill(),this.btnPause.revive()}},{key:"onPause",value:function(){ce.instance().playSound(ce.buttonclick),this.tween.pause(),El.instance().pauseSound(this.urlSong),this.btnPlay.revive(),this.btnPause.kill()}},{key:"onLoadAudio",value:function(){this.addBtnPlayAndPause(this.songDetailScreenConfig.songDetail)}},{key:"tweenComplete",value:function(){null!==this.spriteTween&&(this.spriteTween.destroy(),this.spriteTween=null,this.stopAudio())}},{key:"stopAudio",value:function(){0==this.checkAudioStop&&(this.checkAudioStop=!0,this.isPlay=!1,this.btnPause.kill(),this.btnPlay.revive(),El.instance().removeSound(this.urlSong))}},{key:"removeMethod",value:function(){El.instance().removeAllSound(),LogConsole.log(this.songListen)}},{key:"addNameSong",value:function(e){this.nameSong=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.configsValue.song,e.configs),this.nameSong.anchor.set(.5,0),this.addChild(this.nameSong)}},{key:"addNameSinger",value:function(e){this.nameSinger=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.configsValue.singer,e.configs),this.nameSinger.anchor.set(.5,0),this.addChild(this.nameSinger)}}])&&kl(n.prototype,i),o&&kl(n,o),t}();function Tl(e){return(Tl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Il(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Al(e,t){return!t||"object"!==Tl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ll(e){return(Ll=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gl(e,t){return(Gl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Dl=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Al(this,Ll(t).call(this,game,e,n,null))).songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),o.iconShareActive,o.txtShareActive,o.btnShareActive,o.btnShareDisactive,o.txtShareDisactive,o.iconShareDisactive,o.configsValue=i,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gl(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addDisactive(this.songDetailScreenConfig.btn_share.disactive),this.addActive(this.songDetailScreenConfig.btn_share.active)}},{key:"addDisactive",value:function(e){this.btnShareDisactive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnShareDisactive.inputEnabled=!0,this.btnShareDisactive.events.onInputUp.addOnce(this.onActive,this),this.addChild(this.btnShareDisactive),this.iconShareDisactive=new Phaser.Sprite(game,e.icon.x*window.GameConfig.RESIZE,e.icon.y*window.GameConfig.RESIZE,e.icon.nameAtlas,e.icon.nameSprite),this.btnShareDisactive.addChild(this.iconShareDisactive),this.txtShareDisactive=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs),this.btnShareDisactive.addChild(this.txtShareDisactive)}},{key:"addActive",value:function(e){this.btnShareActive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnShareActive.kill(),this.addChild(this.btnShareActive),this.iconShareActive=new Phaser.Sprite(game,e.icon.x*window.GameConfig.RESIZE,e.icon.y*window.GameConfig.RESIZE,e.icon.nameAtlas,e.icon.nameSprite),this.btnShareActive.addChild(this.iconShareActive),this.txtShareActive=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs),this.btnShareActive.addChild(this.txtShareActive)}},{key:"onActive",value:function(){ce.instance().playSound(ce.buttonclick),this.btnShareDisactive.destroy(),this.btnShareActive.revive()}}])&&Il(n.prototype,i),o&&Il(n,o),t}();function Ml(e){return(Ml="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bl(e,t){return!t||"object"!==Ml(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jl(e){return(jl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ul(e,t){return(Ul=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fl=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Bl(this,jl(t).call(this,game,e,n,null))).songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),o.iconLikeActive,o.txtLikeActive,o.btnLikeActive,o.btnLikeDisactive,o.txtLikeDisactive,o.iconLikeDisactive,o.configsValue=i,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ul(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addDisactive(this.songDetailScreenConfig.btn_like.disactive),this.addActive(this.songDetailScreenConfig.btn_like.active)}},{key:"addDisactive",value:function(e){this.btnLikeDisactive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnLikeDisactive.inputEnabled=!0,this.btnLikeDisactive.events.onInputUp.addOnce(this.onActive,this),this.addChild(this.btnLikeDisactive),this.iconLikeDisactive=new Phaser.Sprite(game,e.icon.x*window.GameConfig.RESIZE,e.icon.y*window.GameConfig.RESIZE,e.icon.nameAtlas,e.icon.nameSprite),this.btnLikeDisactive.addChild(this.iconLikeDisactive),this.txtLikeDisactive=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs),this.btnLikeDisactive.addChild(this.txtLikeDisactive)}},{key:"addActive",value:function(e){this.btnLikeActive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnLikeActive.kill(),this.addChild(this.btnLikeActive),this.iconLikeActive=new Phaser.Sprite(game,e.icon.x*window.GameConfig.RESIZE,e.icon.y*window.GameConfig.RESIZE,e.icon.nameAtlas,e.icon.nameSprite),this.btnLikeActive.addChild(this.iconLikeActive),this.txtLikeActive=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs),this.btnLikeActive.addChild(this.txtLikeActive)}},{key:"onActive",value:function(){ce.instance().playSound(ce.buttonclick),this.btnLikeDisactive.destroy(),this.btnLikeActive.revive()}}])&&Nl(n.prototype,i),o&&Nl(n,o),t}();function Zl(e){return(Zl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ql(e,t){return!t||"object"!==Zl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vl(e){return(Vl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wl(e,t){return(Wl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ql=function(e){function t(e,n,i){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Ql(this,Vl(t).call(this,game,e,n,null))).configsValue=i,o.linkMp3="",o.linkYoutube="";for(var a=0;a<o.configsValue.song_links.length;a++){var s=o.configsValue.song_links[a];s.link_type==$l.LINK_ZING_MP3&&(o.linkMp3=s.link),s.link_type==$l.LINK_YOUTUBE&&(o.linkYoutube=s.link)}return o.songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),o.txtListenFull,o.line,o.iconZing,o.iconYoutube,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wl(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addTxtListenFull(this.songDetailScreenConfig.otherOnBottom.txtListenFull),this.addLine(this.songDetailScreenConfig.otherOnBottom),this.addIconZing(this.songDetailScreenConfig.otherOnBottom.icon_zing),this.addIconYoutube(this.songDetailScreenConfig.otherOnBottom.icon_youtube)}},{key:"addTxtListenFull",value:function(e){this.txtListenFull=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtListenFull.anchor.set(.5,0),this.addChild(this.txtListenFull)}},{key:"addLine",value:function(e){this.line=new Phaser.Sprite(game,e.line_long.x*window.GameConfig.RESIZE,e.line_long.y*window.GameConfig.RESIZE,e.line_long.nameAtlas,e.line_long.nameSprite),this.line.anchor.set(.5,0);var t=new Phaser.Sprite(game,e.line.x*window.GameConfig.RESIZE,e.line.y*window.GameConfig.RESIZE,e.line.nameAtlas,e.line.nameSprite);t.anchor.set(.5),this.line.addChild(t),this.addChild(this.line)}},{key:"addIconZing",value:function(e){this.icon_zing=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.icon_zing.anchor.set(.5),this.icon_zing.inputEnabled=!0,this.icon_zing.events.onInputUp.add(this.clickZing,this),this.addChild(this.icon_zing)}},{key:"clickZing",value:function(){ce.instance().playSound(ce.buttonclick),"ios"!==z.instance().platform?window.open(this.linkMp3,"_blank"):IE.instance().addDialog("Hệ thống đang phát triển tính năng. Bạn vui lòng quay lại sau nhé!")}},{key:"addIconYoutube",value:function(e){this.icon_youtube=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.icon_youtube.anchor.set(.5),this.icon_youtube.inputEnabled=!0,this.icon_youtube.events.onInputUp.add(this.clickYoutube,this),this.addChild(this.icon_youtube)}},{key:"clickYoutube",value:function(){ce.instance().playSound(ce.buttonclick),LogConsole.log("Youtube: ".concat(this.configsValue.songLink))}}])&&Hl(n.prototype,i),o&&Hl(n,o),t}();function Kl(e){return(Kl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zl(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yl(e,t){return!t||"object"!==Kl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jl(e){return(Jl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xl(e,t){return(Xl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $l=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=Yl(this,Jl(t).call(this,game,0,0,"bg_create_room")),LogConsole.log(e),n.songDetailScreenConfig=JSON.parse(game.cache.getText("songDetailScreenConfig")),n.configsValue=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xl(e,t)}(t,Phaser.Button),n=t,o=[{key:"LINK_ZING_MP3",get:function(){return"mp3zing"}},{key:"LINK_YOUTUBE",get:function(){return"youtube"}}],(i=[{key:"afterInit",value:function(){this.headerTab,this.songDetail,this.btnShare,this.btnLike,this.otherOnBottom,this.addHeaderTab(this.songDetailScreenConfig.header),this.addSongDetail(),this.addBtnShare(),this.addBtnLike(),this.addOtherOnBottom(),li.instance().showBanerInfoSongScreen()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.borderDiamond,this.diamond,this.txtDiamond,this.addButtonBack(e),this.addBorderDiamond(e),this.addDiamond(e)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.btn_back.x*window.GameConfig.RESIZE,e.btn_back.y*window.GameConfig.RESIZE,e.btn_back.nameAtlas,e.btn_back.nameSprite),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),this.destroy(),this.songDetail.removeMethod()}},{key:"addBorderDiamond",value:function(e){this.borderDiamond=new Phaser.Sprite(game,e.border_diamond.x*window.GameConfig.RESIZE,e.border_diamond.y*window.GameConfig.RESIZE,e.border_diamond.nameAtlas,e.border_diamond.nameSprite),this.headerTab.addChild(this.borderDiamond)}},{key:"addDiamond",value:function(e){this.diamond=new Phaser.Sprite(game,e.diamond.x*window.GameConfig.RESIZE,e.diamond.y*window.GameConfig.RESIZE,e.diamond.nameAtlas,e.diamond.nameSprite),this.borderDiamond.addChild(this.diamond),this.txtDiamond=new Phaser.Text(game,e.txt_diamond.x*window.GameConfig.RESIZE,e.txt_diamond.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,e.txt_diamond.configs),this.borderDiamond.addChild(this.txtDiamond)}},{key:"addSongDetail",value:function(){this.songDetail=new xl(320*window.GameConfig.RESIZE,160*window.GameConfig.RESIZE,this.configsValue),this.addChild(this.songDetail)}},{key:"addBtnShare",value:function(){this.btnShare=new Dl(35*window.GameConfig.RESIZE,535*window.GameConfig.RESIZE),this.addChild(this.btnShare)}},{key:"addBtnLike",value:function(){this.btnLike=new Fl(329*window.GameConfig.RESIZE,535*window.GameConfig.RESIZE),this.addChild(this.btnLike)}},{key:"addOtherOnBottom",value:function(){this.otherOnBottom=new ql(0,705*window.GameConfig.RESIZE,this.configsValue),this.addChild(this.otherOnBottom)}},{key:"destroy",value:function(){for(li.instance().hideBanner();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&zl(n.prototype,i),o&&zl(n,o),t}();function eh(e){return(eh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function th(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nh(e,t,n){return(nh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ih(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ih(e){return(ih=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oh(e,t){return(oh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ah(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var sh=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=ih(t).call(this,game,0,0,null))||"object"!==eh(i)&&"function"!=typeof i?ah(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.topBg=new rt(e.positionPopup.popup_confirm_top_bg),e.addChild(e.topBg),e.bgText=new Zt(e.positionPopup.popup_confirm_bg_text),e.addChild(e.bgText),e.btnOk=new ln(e.positionPopup.popup_confirm_button_ok,"ĐỒNG Ý",e.chooseOK,ah(ah(e))),e.addChild(e.btnOk),e.btnCancle=new ln(e.positionPopup.popup_confirm_button_cancle,"HỦY BỎ",e.chooseCancle,ah(ah(e))),e.addChild(e.btnCancle),e.txtContent=new _t(e.positionPopup.popup_confirm_text_content,o),e.txtContent.setTextBounds(0,0,545*z.instance().scale,278*z.instance().scale),e.addChild(e.txtContent),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oh(e,t)}(t,Mt),n=t,(i=[{key:"setHeight",value:function(e){this.bgText.height=e,this.txtContent.setTextBounds(0,0,545*z.instance().scale,this.bgText.height-168*z.instance().scale),this.btnCancle.y=this.bgText.height-103*z.instance().scale,this.btnOk.y=this.bgText.height-103*z.instance().scale}},{key:"setTextCancle",value:function(e){this.btnCancle.setText(e)}},{key:"setTextOk",value:function(e){this.btnOk.setText(e)}},{key:"setContent",value:function(e){this.txtContent.setText(e)}},{key:"chooseOK",value:function(){LogConsole.log("chooseOK"),this.btnOk.inputEnabled=!1,this.btnCancle.inputEnabled=!1,this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){LogConsole.log("chooseCancle"),this.btnOk.inputEnabled=!1,this.btnCancle.inputEnabled=!1,this.event.CANCLE.dispatch()}},{key:"destroy",value:function(){this.topBg.destroy(),this.bgText.destroy(),this.btnOk.destroy(),this.btnCancle.destroy(),this.txtContent.destroy(),nh(ih(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.bgText.width}}])&&th(n.prototype,i),o&&th(n,o),t}();function rh(e){return(rh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hh(e,t){return!t||"object"!==rh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ch(e){return(ch=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uh(e,t){return(uh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dh=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),hh(this,ch(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uh(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.ava=new pr,this.addChild(this.ava),this.maskAva=new Phaser.Graphics(game,this.ava.x,this.ava.x),this.maskAva.beginFill(16711680,1),this.maskAva.drawRoundedRect(this.ava.x,this.ava.y,this.ava.width,this.ava.height,10),this.maskAva.endFill(),this.addChild(this.maskAva),this.ava.mask=this.maskAva}},{key:"setSize",value:function(e,t){this.ava.setSize(e,t),this.maskAva.clear(),this.maskAva.beginFill(16711680,1),this.maskAva.drawRoundedRect(this.ava.x,this.ava.y,this.ava.width,this.ava.height,10),this.maskAva.endFill()}},{key:"beginLoad",value:function(e,t){this.ava.beginLoad(e,t)}},{key:"width",get:function(){return this.ava.width}},{key:"height",get:function(){return this.ava.height}}])&&lh(n.prototype,i),o&&lh(n,o),t}();function fh(e){return(fh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ph(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gh(e,t){return!t||"object"!==fh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yh(e){return(yh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mh(e,t){return(mh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vh=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=gh(this,yh(t).call(this,game,0,0,null))).positionShop=n.mainData.positionDefaultSource,n.loaderPerc=0,n.beginLoad=!1,n.maxLoading=0,n.bg=new rt(e?n.positionShop.gennes_current_level_deactive1:n.positionShop.gennes_current_level_deactive),n.addChild(n.bg),n.bgLoading=new rt(e?n.positionShop.gennes_current_level_active1:n.positionShop.gennes_current_level_active),n.addChild(n.bgLoading),n.maskLoading=new Phaser.Graphics(game,n.bgLoading.width/2,n.bgLoading.height/2),n.maskLoading.anchor.setTo(.5,.5),n.addChild(n.maskLoading),n.bgLoading.mask=n.maskLoading,n.drawMask(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mh(e,t)}(t,Mt),n=t,(i=[{key:"drawMask",value:function(){this.maxLoading<100&&this.maxLoading>0&&(this.loaderPerc=this.maxLoading,this.maskLoading.clear(),this.maskLoading.beginFill(16777215),this.maskLoading.arc(0,0,this.bgLoading.width/2,this.game.math.degToRad(-220),this.game.math.degToRad(3.6*this.loaderPerc-220)),this.maskLoading.endFill())}},{key:"setMaxLoading",value:function(e){this.maxLoading=80*e/100,0===this.maxLoading&&(this.maxLoading=1),this.drawMask()}},{key:"width",get:function(){return this.bgLoading.width}}])&&ph(n.prototype,i),o&&ph(n,o),t}();function wh(e){return(wh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _h(e,t){return!t||"object"!==wh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Sh(e){return(Sh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eh(e,t){return(Eh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ch=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=_h(this,Sh(t).call(this,game,0,0,null))).user=new Bs,e.setData(n,i),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eh(e,t)}(t,Mt),n=t,(i=[{key:"setData",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.user=Object.assign({},this.user,e),this.removeAllItem(),this.user.level<5){for(var n=0,i=0;i<5;i++){var o=null;if(i==e.level)(o=new vh(t)).setMaxLoading(100*(this.user.exp_score-this.user.current_level_score)/(this.user.next_level_score-this.user.current_level_score));else{var a={x:0,y:10,nameAtlas:"defaultSource",nameSprite:"LevelActive"};t?i<this.user.level?a.nameSprite="LevelActive1":a.nameSprite="LevelDeactive1":i<this.user.level?a.nameSprite="LevelActive":a.nameSprite="LevelDeactive",o=new rt(a)}o.x=n,this.addChild(o),n+=i<4?o.width+7*z.instance().scale:o.width}LogConsole.log(this.children.length),this._width=n}else{var s=new rt({x:4,y:7,nameAtlas:"defaultSource",nameSprite:"Master_Icon"});this.addChild(s),this._width=s.width+5}}},{key:"width",get:function(){return this._width}}])&&bh(n.prototype,i),o&&bh(n,o),t}();function kh(e){return(kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ph(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Oh(e,t,n){return(Oh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rh(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Rh(e){return(Rh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xh(e,t){return(xh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Th(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ih=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Rh(t).call(this,game,0,0,null))||"object"!==kh(i)&&"function"!=typeof i?Th(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.data=null,e.positionPopup=e.mainData.positionPopup,e.bgConfirm=new sh,e.bgConfirm.event.OK.add(e.chooseOk,Th(Th(e))),e.bgConfirm.event.CANCLE.add(e.chooseCancle,Th(Th(e))),e.bgConfirm.x=0,e.bgConfirm.y=74*z.instance().scale,e.addChild(e.bgConfirm),e.avaPlayList=new dh,e.avaPlayList.setSize(200*z.instance().scale,200*z.instance().scale),e.avaPlayList.x=177*z.instance().scale,e.avaPlayList.y=0,e.addChild(e.avaPlayList),e.textName=new _t(e.positionPopup.popup_buy_playlist_text_name,""),e.textName.setTextBounds(0,0,560*z.instance().scale,47*z.instance().scale),e.addChild(e.textName),e.textContent=new _t(e.positionPopup.popup_buy_playlist_text_content,"Bạn muốn mua playlist này?"),e.textContent.setTextBounds(0,0,560*z.instance().scale,88*z.instance().scale),e.addChild(e.textContent),e.levePlayList=new Ch({},!1),e.levePlayList.y=266*z.instance().scale,e.levePlayList.x=e.avaPlayList.x+(e.avaPlayList.width-e.levePlayList.width)/2,e.addChild(e.levePlayList),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xh(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e){this.textContent.text=e}},{key:"setData",value:function(e){this.data=e,this.textName.text=this.formatName(this.data.name,25),this.levePlayList.setData(this.data.user,!1),this.levePlayList.x=this.avaPlayList.x+(this.avaPlayList.width-this.levePlayList.width)/2,this.avaPlayList.beginLoad(this.data.thumb,1)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}},{key:"destroy",value:function(){this.bgConfirm.destroy(),this.avaPlayList.destroy(),Oh(Rh(t.prototype),"destroy",this).call(this)}}])&&Ph(n.prototype,i),o&&Ph(n,o),t}();var Ah=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.is_highlight=0,this.thumb="",this.created=0,this.is_owner=0,this.is_default=0,this.genre_id=0,this.songs="",this.price=0,this.is_general=0,this.name="",this.id=0,this.vip=0,this.is_solo_mode=0,this.updated=0,this.country_id=0,this.user=new Bs,this.region="",this.arrSong=[],this.questions="",this.bet_id=0,this.purchased_count=0,this.description=""};function Lh(e){return(Lh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Dh(e,t,n){return(Dh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mh(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Mh(e){return(Mh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nh(e,t){return(Nh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var jh=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Mh(t).call(this,game,0,0,null))||"object"!==Lh(i)&&"function"!=typeof i?Bh(n):i).data=new Ah,e.event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.itemConfirm=new Ih,e.itemConfirm.event.OK.add(e.chooseOk,Bh(Bh(e))),e.itemConfirm.event.CANCLE.add(e.chooseCancle,Bh(Bh(e))),e.itemConfirm.x=35*z.instance().scale,e.itemConfirm.y=game.height+237*z.instance().scale,e.addChild(e.itemConfirm),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nh(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e){this.itemConfirm.setContent(e)}},{key:"setData",value:function(e){this.data=Object.assign({},this.data,e),this.itemConfirm.setData(e),this.tweenItemPopup(this.itemConfirm,game.height-900*z.instance().scale)}},{key:"chooseOk",value:function(){this.event.OK.dispatch(this.data)}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}},{key:"destroy",value:function(){this.bg.destroy(),this.itemConfirm.destroy(),Dh(Mh(t.prototype),"destroy",this).call(this)}}])&&Gh(n.prototype,i),o&&Gh(n,o),t}();function Uh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Fh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("playlist_id",e),t}}],(n=null)&&Uh(t.prototype,n),i&&Uh(t,i),e}();var Zh=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=0,this.title="",this.author="",this.fileName="",this.listenLink="",this.singer="",this.song="",this.thumb="",this.song_links=[],this.playlist_name=""};function Hh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Qh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"genres",get:function(){return"genres"}},{key:"parent",get:function(){return"parent"}},{key:"code",get:function(){return"code"}},{key:"genre",get:function(){return"genre"}},{key:"number_player",get:function(){return"number_player"}},{key:"id",get:function(){return"id"}},{key:"priority",get:function(){return"priority"}},{key:"status",get:function(){return"status"}},{key:"user_level_required",get:function(){return"user_level_required"}},{key:"bet_reward",get:function(){return"bet_reward"}},{key:"bet_place",get:function(){return"bet_place"}},{key:"genre_id",get:function(){return"genre_id"}},{key:"bets",get:function(){return"bets"}},{key:"playlists",get:function(){return"playlists"}},{key:"thumb",get:function(){return"thumb"}},{key:"price",get:function(){return"price"}},{key:"is_general",get:function(){return"is_general"}},{key:"name",get:function(){return"name"}},{key:"questions",get:function(){return"questions"}},{key:"vip",get:function(){return"vip"}},{key:"is_default",get:function(){return"is_default"}},{key:"country_id",get:function(){return"country_id"}},{key:"bet_id",get:function(){return"bet_id"}},{key:"online_mode_loaded",get:function(){return"online_mode_loaded"}},{key:"genres_user_count",get:function(){return"genres_user_count"}},{key:"purchased",get:function(){return"purchased"}},{key:"created",get:function(){return"created"}},{key:"is_owner",get:function(){return"is_owner"}},{key:"is_highlight",get:function(){return"is_highlight"}},{key:"is_solo_mode",get:function(){return"is_solo_mode"}},{key:"updated",get:function(){return"updated"}},{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"file_path",get:function(){return"file_path"}},{key:"question_type",get:function(){return"question_type"}},{key:"title",get:function(){return"title"}},{key:"correct_answer",get:function(){return"correct_answer"}},{key:"answer1",get:function(){return"answer1"}},{key:"answer2",get:function(){return"answer2"}},{key:"answer3",get:function(){return"answer3"}},{key:"answer4",get:function(){return"answer4"}},{key:"question_index",get:function(){return"question_index"}},{key:"streak",get:function(){return"streak"}},{key:"score",get:function(){return"score"}},{key:"players",get:function(){return"players"}},{key:"region",get:function(){return"region"}},{key:"diamond_change",get:function(){return"diamond_change"}},{key:"exp_score",get:function(){return"exp_score"}},{key:"song",get:function(){return"song"}},{key:"singer",get:function(){return"singer"}},{key:"count_down_time",get:function(){return"count_down_time"}},{key:"album",get:function(){return"album"}},{key:"is_correct_answer",get:function(){return"is_correct_answer"}},{key:"user",get:function(){return"user"}}],(n=null)&&Hh(t.prototype,n),i&&Hh(t,i),e}();function Vh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Wh=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=e.getSFSObject(qs.playlist),n=this.getPlayList(t),i=e.getSFSArray(qs.songs),o=0;o<i.size();o++){var a=i.getSFSObject(o),s=this.getSongDetail(a);s.playlist_name=t.getUtfString("name"),n.arrSong.push(s)}if(t.containsKey(qs.user_playlist_mapping)){var r=t.getSFSObject(qs.user_playlist_mapping);r&&(n.user=this.getUserPlayList(r))}return n}},{key:"getPlayList",value:function(e){var t=new Ah;return t.is_highlight=e.getInt(qs.is_highlight),t.thumb=e.getUtfString(qs.thumb),t.created=e.getLong(qs.created),t.is_owner=e.getInt(qs.is_owner),t.is_default=e.getInt(qs.is_default),t.genre_id=e.getInt(qs.genre_id),t.purchased=e.getInt(qs.purchased),t.songs=e.getUtfString(qs.songs),t.price=e.getInt(qs.price),t.is_general=e.getInt(qs.is_general),t.name=e.getUtfString(qs.name),t.id=e.getInt(qs.id),t.vip=e.getInt(qs.vip),t.is_solo_mode=e.getInt(qs.is_solo_mode),t.updated=e.getLong(qs.updated),t.country_id=e.getInt(qs.country_id),e.containsKey(qs.description)&&(t.description=e.getUtfString(qs.description)),e.containsKey(Qh.questions)&&(t.questions=e.getUtfString(Qh.questions)),t}},{key:"getUserPlayList",value:function(e){var t=new Bs;return t.user_id=e.getInt(qs.user_id),t.level=e.getInt(qs.level),t.playlist_id=e.getInt(qs.playlist_id),t.exp_score=e.getInt(qs.exp_score),t.created=e.getLong(qs.created),t.active=e.getInt(qs.active),t.id=e.getLong(qs.id),t.current_level_score=e.getInt(qs.current_level_score),t.next_level_score=e.getInt(qs.next_level_score),t.updated=e.getLong(qs.updated),t}},{key:"getSongDetail",value:function(e){var t=new Zh;if(t.id=e.getLong(qs.id),t.author=e.getUtfString(qs.author),t.title=e.getUtfString(qs.title),t.thumb=e.getSFSObject(qs.singer).getUtfString(qs.avatar),t.fileName=e.getUtfString(qs.title),t.listenLink=e.getUtfString(qs.file_path),t.singer=e.getSFSObject(qs.singer).getUtfString(qs.name),t.song=e.getUtfString(qs.title),e.containsKey(qs.song_links))for(var n=0;n<e.getSFSArray(qs.song_links).size();n++){var i={},o=e.getSFSArray(qs.song_links).getSFSObject(n);i.link_type=o.getUtfString(qs.link_type),i.song_id=o.getLong(qs.song_id),i.is_movie=o.getInt(qs.is_movie),i.link=o.getUtfString(qs.link),i.id=o.getLong(qs.id),t.song_links.push(i)}return t}}],(n=null)&&Vh(t.prototype,n),i&&Vh(t,i),e}();function qh(e){return(qh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kh(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zh(e,t,n){return(zh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Yh(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Yh(e){return(Yh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jh(e,t){return(Jh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var $h=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Yh(t).call(this,game,0,0,null))||"object"!==qh(i)&&"function"!=typeof i?Xh(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.data=null,e.positionPopup=e.mainData.positionPopup,LogConsole.log(e.positionPopup),e.bgConfirm=new gn,e.bgConfirm.setTextButton("TIẾP TỤC"),e.bgConfirm.event.OK.add(e.chooseOk,Xh(Xh(e))),e.bgConfirm.x=0,e.bgConfirm.y=74*e.mainData.scale,e.addChild(e.bgConfirm),e.avaPlayList=new dh,e.avaPlayList.setSize(200*e.mainData.scale,200*e.mainData.scale),e.avaPlayList.x=175*e.mainData.scale,e.avaPlayList.y=0,e.addChild(e.avaPlayList),e.textName=new _t(e.positionPopup.popup_buy_playlist_text_name,""),e.textName.setTextBounds(0,0,560*e.mainData.scale,47*e.mainData.scale),e.addChild(e.textName),e.textContent=new _t(e.positionPopup.popup_buy_playlist_text_content,"Bạn đã mua thành công playlist."),e.textContent.setTextBounds(0,0,560*e.mainData.scale,88*e.mainData.scale),e.addChild(e.textContent),e.levePlayList=new Ch({},!1),e.levePlayList.y=266*e.mainData.scale,e.levePlayList.x=e.avaPlayList.x+(e.avaPlayList.width-e.levePlayList.width)/2,e.addChild(e.levePlayList),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jh(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e){this.textContent.text=e}},{key:"setData",value:function(e){this.data=e,this.textName.text=this.formatName(this.data.name,25),this.levePlayList.setData(this.data.user,!1),this.levePlayList.x=this.avaPlayList.x+(this.avaPlayList.width-this.levePlayList.width)/2,this.avaPlayList.beginLoad(this.data.thumb,1)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"destroy",value:function(){this.bgConfirm.destroy(),this.avaPlayList.destroy(),zh(Yh(t.prototype),"destroy",this).call(this)}}])&&Kh(n.prototype,i),o&&Kh(n,o),t}();function ec(e){return(ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nc(e,t,n){return(nc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ic(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ic(e){return(ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oc(e,t){return(oc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ac(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var sc=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=ic(t).call(this,game,0,0,null))||"object"!==ec(o)&&"function"!=typeof o?ac(i):o).playlist_id=e,n.data=new Ah,n.event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"screen-dim"),n.addChild(n.bg),n.itemConfirm=new $h,n.itemConfirm.event.OK.add(n.chooseOk,ac(ac(n))),n.itemConfirm.x=35*z.instance().scale,n.itemConfirm.y=game.height+237*z.instance().scale,n.addChild(n.itemConfirm),n.addEvent(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oc(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().sendData(Hs.PLAYLIST_DETAIL_REQUEST,Fh.begin(this.playlist_id))}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case Hs.PLAYLIST_DETAIL_RESPONSE:"OK"===e.params.getUtfString(qs.status)&&this.setData(Wh.begin(e.params))}}},{key:"setContent",value:function(e){this.itemConfirm.setContent(e)}},{key:"setData",value:function(e){this.data=Object.assign({},this.data,e),this.itemConfirm.setData(e),this.tweenItemPopup(this.itemConfirm,game.height-810*z.instance().scale)}},{key:"chooseOk",value:function(){this.event.OK.dispatch(this.data)}},{key:"destroy",value:function(){this.bg.destroy(),this.itemConfirm.destroy(),this.removeEvent(),nc(ic(t.prototype),"destroy",this).call(this)}}])&&tc(n.prototype,i),o&&tc(n,o),t}();function rc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var lc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("playlist_id",e),t}}],(n=null)&&rc(t.prototype,n),i&&rc(t,i),e}();function hc(e){return(hc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function uc(e,t){return!t||"object"!==hc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dc(e){return(dc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fc(e,t){return(fc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pc=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),uc(this,dc(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fc(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.maskAva=null,this.ava=new pr("songDetailSprites","ava-default"),this.addChild(this.ava),this.createMask()}},{key:"setSize",value:function(e,t){this.ava.setSize(e,t),this.createMask()}},{key:"setAvatar",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.ava.beginLoad(e,t)}},{key:"createMask",value:function(){this.removeMask(),this.maskAva=new Phaser.Graphics(game,this.ava.x,this.ava.y),this.maskAva.beginFill(16711680,1),this.maskAva.drawCircle(this.ava.width/2,this.ava.height/2,this.ava.width-4*z.instance().scale),this.maskAva.endFill(),this.addChild(this.maskAva),this.ava.mask=this.maskAva}},{key:"removeMask",value:function(){null!==this.maskAva&&(this.maskAva.clear(),this.maskAva.destroy(),this.maskAva=null)}},{key:"width",get:function(){return this.ava.width}},{key:"height",get:function(){return this.ava.height}}])&&cc(n.prototype,i),o&&cc(n,o),t}();function gc(e){return(gc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mc(e){return(mc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vc(e,t){return(vc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var bc=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=mc(t).call(this,game,0,0,null))||"object"!==gc(i)&&"function"!=typeof i?wc(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.popup=new sh,e.popup.setHeight(562*z.instance().scale),e.popup.y=59*z.instance().scale,e.popup.event.OK.add(e.chooseOk,wc(wc(e))),e.popup.event.CANCLE.add(e.chooseCancle,wc(wc(e))),e.addChild(e.popup),e.ava=new pc,e.ava.setSize(197*z.instance().scale,197*z.instance().scale),e.ava.x=185*z.instance().scale,e.ava.y=0,e.addChild(e.ava),e.txtName=new _t(e.positionPopup.popup_invite_friend_txt_name,"Viet PV"),e.txtName.setTextBounds(0,0,568*z.instance().scale,47*z.instance().scale),e.addChild(e.txtName),e.txtDes=new _t(e.positionPopup.popup_invite_friend_txt_des,"Kien Pham mời bạn vào  phòng chơi cb247"),e.txtDes.setTextBounds(0,0,568*z.instance().scale,77*z.instance().scale),e.addChild(e.txtDes),e.txtMucCuoc=new _t(e.positionPopup.popup_invite_friend_txt_muccuoc,"Mức cược"),e.txtMucCuoc.setTextBounds(0,0,568*z.instance().scale,35*z.instance().scale),e.addChild(e.txtMucCuoc),e.btnMucCuoc=new ln(e.positionPopup.popup_invite_friend_btn_muccuoc,1e3),e.addChild(e.btnMucCuoc),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vc(e,t)}(t,Mt),n=t,(i=[{key:"setAvatar",value:function(e){this.ava.setAvatar(e,1)}},{key:"setContent",value:function(e,t){this.txtName.text=e,this.txtDes.text=e+" mời bạn vào phòng chơi "+t,this.txtDes.addColor("#FEAC4F",0),this.txtDes.addColor("#333333",e.length),this.txtDes.addColor("#FEAC4F",e.length+24)}},{key:"setMucCuoc",value:function(e){this.btnMucCuoc.setText(e)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}}])&&yc(n.prototype,i),o&&yc(n,o),t}();function _c(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Sc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dataBlock={}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllInvatation||(this.controllInvatation=new e),this.controllInvatation}}],(n=[{key:"getUserBlock",value:function(e){return!!this.dataBlock.hasOwnProperty(e)}},{key:"addBlock",value:function(e){this.dataBlock.hasOwnProperty(e)?this.removeIdTime(this.dataBlock[e].idTime):this.dataBlock[e]={},this.dataBlock[e].idTime=game.time.events.add(180*Phaser.Timer.SECOND,this.removeUserBlock,this,e)}},{key:"removeUserBlock",value:function(e){console.log("removeUserBlock : "+e),this.dataBlock.hasOwnProperty(e)&&delete this.dataBlock[e],console.log(this.dataBlock)}},{key:"removeIdTime",value:function(e){null!==this.idTime&&(game.time.events.remove(this.idTime),this.idTime=null)}}])&&_c(t.prototype,n),i&&_c(t,i),e}();function Ec(e){return(Ec="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kc(e){return(kc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pc(e,t){return(Pc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Rc=function(e){function t(e){var n,i,o,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=kc(t).call(this,game,0,0,null))||"object"!==Ec(o)&&"function"!=typeof o?Oc(i):o).invitation=e,n.cmd=a,n.event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal,OK_CMD:new Phaser.Signal,CANCLE_CMD:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"screen-dim"),n.addChild(n.bg),n.popup=new bc,n.popup.event.OK.add(n.chooseOk,Oc(Oc(n))),n.popup.event.CANCLE.add(n.chooseCancle,Oc(Oc(n))),n.popup.x=35*z.instance().scale,n.popup.y=266*z.instance().scale,n.addChild(n.popup),n.popup.y=game.height+237*z.instance().scale,n.tweenItemPopup(n.popup,game.height-870*z.instance().scale),!1===a?(n.setContent(e.inviter.getVariable("user_name").value,e.params.getInt("room_id")),n.popup.setAvatar(e.inviter.getVariable("avatar").value),n.popup.setMucCuoc(e.params.getInt("bet_place"))):(n.setContent(e.getUtfString("inviter_name"),e.getInt("room_id")),n.popup.setAvatar(e.getUtfString("inviter_avatar")),n.popup.setMucCuoc(e.getInt("bet_place"))),ce.instance().playSound(ce.popupinviteroom),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pc(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e,t){this.popup.setContent(e,t)}},{key:"chooseOk",value:function(){this.cmd?this.event.OK_CMD.dispatch(this.invitation.getInt("room_id"),this.invitation.getInt("bet_place")):this.event.OK.dispatch(this.invitation)}},{key:"chooseCancle",value:function(){this.cmd?(this.event.CANCLE_CMD.dispatch(),Sc.instance().addBlock(this.invitation.getInt("inviter_id"))):this.event.CANCLE.dispatch(this.invitation)}}])&&Cc(n.prototype,i),o&&Cc(n,o),t}();function xc(e){return(xc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ic(e){return(Ic=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ac(e,t){return(Ac=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Gc=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Ic(t).call(this,game,0,0,null))||"object"!==xc(i)&&"function"!=typeof i?Lc(n):i).tryNo=a,e.event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.popup=new sh(o),e.popup.x=35*z.instance().scale,e.addChild(e.popup),e.popup.event.OK.add(e.chooseOk,Lc(Lc(e))),e.popup.event.CANCLE.add(e.chooseCancle,Lc(Lc(e))),e.popup.y=game.height+237*z.instance().scale,e.tweenItemPopup(e.popup,game.height-900*z.instance().scale),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ac(e,t)}(t,Mt),n=t,(i=[{key:"setContent",value:function(e){this.popup.setContent(e)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){De.instance().event.chooseNoPopupConfirm.dispatch(this.tryNo),this.event.CANCLE.dispatch()}}])&&Tc(n.prototype,i),o&&Tc(n,o),t}();function Dc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Mc(e,t,n){return t&&Dc(e.prototype,t),n&&Dc(e,n),e}var Nc=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tween1=null,this.tween2=null,this.timeTween=200,this.ktComplete=!1,this.event={tweenComplete:new Phaser.Signal}}return Mc(e,null,[{key:"instance",value:function(){return this.switch||(this.switch=new e),this.switch}}]),Mc(e,[{key:"beginSwitch",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=0;this.removeAllTween(),this.ktComplete=!1,null!==t&&(t.x=n?-game.width:game.width,this.tween2=game.add.tween(t).to({x:0},this.timeTween,Phaser.Easing.Power1,!0,i),this.tween2.onComplete.add(this.onCompleteTween,this)),null!==e&&(o=n?game.width:-game.width,e.x=0,this.tween1=game.add.tween(e).to({x:o},this.timeTween,Phaser.Easing.Power1,!0,i),this.tween1.onComplete.add(this.onCompleteTween,this))}},{key:"onCompleteTween",value:function(){!1===this.ktComplete&&(this.ktComplete=!0,this.event.tweenComplete.dispatch(),this.removeAllTween())}},{key:"removeTween1",value:function(){null!==this.tween1&&(this.tween1.stop(),game.tweens.remove(this.tween1),this.tween1=null)}},{key:"removeTween2",value:function(){null!==this.tween2&&(this.tween2.stop(),game.tweens.remove(this.tween2),this.tween2=null)}},{key:"removeAllTween",value:function(){this.removeTween1(),this.removeTween2()}}]),e}();function Bc(e){return(Bc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Uc(e,t){return!t||"object"!==Bc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fc(e){return(Fc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zc(e,t){return(Zc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hc=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Uc(this,Fc(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.event={chooseSetting:new Phaser.Signal},e.name,e.btn,e.addLine(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zc(e,t)}(t,Phaser.Group),n=t,o=[{key:"SETTING_GAME",get:function(){return"setting_game"}},{key:"SETTING_ACCOUNT",get:function(){return"setting_account"}},{key:"SETTING_PROFILE",get:function(){return"setting_profile"}},{key:"SETTING_NOTI",get:function(){return"setting_noti"}},{key:"SETTING_SECRET",get:function(){return"setting_secret"}},{key:"SETTING_LANGUAGE",get:function(){return"setting_language"}},{key:"SETTING_TERMS",get:function(){return"setting_terms"}},{key:"SETTING_FOLLOW",get:function(){return"setting_follow"}},{key:"GIFT_CODE",get:function(){return"gift_code"}},{key:"REPORT_BUG",get:function(){return"report_bug"}},{key:"SYNS_FB",get:function(){return"syns_fb"}},{key:"VERSION_PLATFORM",get:function(){return"version_platform"}}],(i=[{key:"addLine",value:function(){var e=new rt(this.positionSetting.setting_item.line);this.addChild(e)}},{key:"addLanguage",value:function(){this.txtLanguage=new _t(this.positionSetting.setting_item.config_language,this.positionSetting.setting_item.config_language.text),this.addChild(this.txtLanguage)}},{key:"addVersion",value:function(){"and"==z.instance().platform?(this.txtVersion=new _t(this.positionSetting.setting_item.config_version,"".concat(z.instance().platform.toUpperCase()," ").concat(this.positionSetting.setting_item.config_version.text," ").concat(z.VERSION_AND)),this.txtVersion.anchor.set(1,0),this.addChild(this.txtVersion)):(this.txtVersion=new _t(this.positionSetting.setting_item.config_version,"".concat(z.instance().platform.toUpperCase()," ").concat(this.positionSetting.setting_item.config_version.text," ").concat(z.VERSION_IOS)),this.txtVersion.anchor.set(1,0),this.addChild(this.txtVersion))}},{key:"addType",value:function(e){this.type=e}},{key:"addNameSetting",value:function(e){this.name=new _t(this.positionSetting.setting_item.name,e),this.addChild(this.name)}},{key:"addButtonRight",value:function(){this.btn=new pt(this.positionSetting.setting_item.button_right,this.clickButton,this),this.btn.anchor.set(.5),this.addChild(this.btn)}},{key:"addButtonTop",value:function(){}},{key:"addButtonBottom",value:function(){}},{key:"addFacebookIcon",value:function(){this.fbIcon=new rt(this.positionSetting.setting_item.fb_icon),this.addChild(this.fbIcon),this.fbIcon.inputEnabled=!0,this.fbIcon.events.onInputUp.add(this.clickFBIcon,this)}},{key:"clickFBIcon",value:function(){ce.instance().playSound(ce.buttonclick),window.open("https://www.facebook.com/wazzat.sotaiamnhac","_blank")}},{key:"addInstagramIcon",value:function(){this.instaIcon=new rt(this.positionSetting.setting_item.insta_icon),this.addChild(this.instaIcon),this.instaIcon.inputEnabled=!0,this.instaIcon.events.onInputUp.add(this.clickInstaIcon,this)}},{key:"clickInstaIcon",value:function(){ce.instance().playSound(ce.buttonclick),window.open("https://www.instagram.com/wazzat.sotaiamnhac","_blank")}},{key:"setDisactive",value:function(){this.alpha=.4}},{key:"clickButton",value:function(){this.event.chooseSetting.dispatch(this.type)}},{key:"height",get:function(){return 102*window.GameConfig.RESIZE}}])&&jc(n.prototype,i),o&&jc(n,o),t}();function Qc(e){return(Qc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wc(e,t){return!t||"object"!==Qc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qc(e){return(qc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kc(e,t){return(Kc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zc=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Wc(this,qc(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kc(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addHeaderTab(this.positionSetting.header),this.addListSetting(),this.addEventExtension()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addListSetting",value:function(){var e=new Phaser.Group(game,this);e.x=0,e.y=109*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0*window.GameConfig.RESIZE,0,640*window.GameConfig.RESIZE,(game.height-130)*window.GameConfig.RESIZE);this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.settingGame,this.settingAccount,this.settingProfile,this.settingNoti,this.settingSecret,this.settingLanguage,this.settingTerms,this.settingFollow,this.reportBug,this.giftCode,this.synsFB,this.addSettingGame(),this.addSettingAccount(),this.addSettingProfile(),this.addSynsFB(),this.addSettingNoti(),this.addSettingSecret(),this.addSettingLanguage(),this.addSettingTerms(),this.addSettingFollow(),this.addReportBug(),this.addVersionPlatform(),""==z.instance().tokenYanAccount&&this.addBtnLogout()}},{key:"addSettingGame",value:function(){this.settingGame=new Hc,this.settingGame.addType(Hc.SETTING_GAME),this.settingGame.event.chooseSetting.add(this.chooseSetting,this),this.settingGame.addNameSetting("Trò chơi"),this.settingGame.addButtonRight(),this.listView.add(this.settingGame)}},{key:"addSettingAccount",value:function(){this.settingAccount=new Hc,this.settingAccount.addType(Hc.SETTING_ACCOUNT),this.settingAccount.event.chooseSetting.add(this.chooseSetting,this),this.settingAccount.addNameSetting("Tài khoản"),this.settingAccount.addButtonRight(),this.listView.add(this.settingAccount)}},{key:"addSettingProfile",value:function(){this.settingProfile=new Hc,this.settingProfile.addType(Hc.SETTING_PROFILE),this.settingProfile.event.chooseSetting.add(this.chooseSetting,this),this.settingProfile.addNameSetting("Hồ sơ"),this.settingProfile.addButtonRight(),this.listView.add(this.settingProfile)}},{key:"addSettingNoti",value:function(){this.settingNoti=new Hc,this.settingNoti.addType(Hc.SETTING_NOTI),this.settingNoti.event.chooseSetting.add(this.chooseSetting,this),this.settingNoti.addNameSetting("Thông báo"),this.settingNoti.addButtonRight(),this.settingNoti.setDisactive(),this.listView.add(this.settingNoti)}},{key:"addSettingSecret",value:function(){this.settingSecret=new Hc,this.settingSecret.addType(Hc.SETTING_SECRET),this.settingSecret.event.chooseSetting.add(this.chooseSetting,this),this.settingSecret.addNameSetting("Riêng tư"),this.settingSecret.addButtonRight(),this.settingSecret.setDisactive(),this.listView.add(this.settingSecret)}},{key:"addSettingLanguage",value:function(){this.settingLanguage=new Hc,this.settingLanguage.addType(Hc.SETTING_LANGUAGE),this.settingLanguage.event.chooseSetting.add(this.chooseSetting,this),this.settingLanguage.addNameSetting("Ngôn ngữ"),this.settingLanguage.addLanguage(),this.settingLanguage.addButtonRight(),this.settingLanguage.setDisactive(),this.listView.add(this.settingLanguage)}},{key:"addSettingTerms",value:function(){this.settingTerms=new Hc,this.settingTerms.addType(Hc.SETTING_TERMS),this.settingTerms.event.chooseSetting.add(this.chooseSetting,this),this.settingTerms.addNameSetting("Điều khoản"),this.settingTerms.addButtonRight(),this.settingTerms.setDisactive(),this.listView.add(this.settingTerms)}},{key:"addSettingFollow",value:function(){this.settingFollow=new Hc,this.settingFollow.addType(Hc.SETTING_FOLLOW),this.settingFollow.event.chooseSetting.add(this.chooseSetting,this),this.settingFollow.addNameSetting("Theo dõi Wazzat"),this.settingFollow.addFacebookIcon(),this.settingFollow.addInstagramIcon(),this.listView.add(this.settingFollow)}},{key:"addReportBug",value:function(){this.reportBug=new Hc,this.reportBug.addType(Hc.REPORT_BUG),this.reportBug.event.chooseSetting.add(this.chooseSetting,this),this.reportBug.addNameSetting("Báo lỗi"),this.reportBug.addButtonRight(),this.reportBug.setDisactive(),this.listView.add(this.reportBug)}},{key:"addGiftCode",value:function(){this.giftCode=new Hc,this.giftCode.addType(Hc.GIFT_CODE),this.giftCode.event.chooseSetting.add(this.chooseSetting,this),this.giftCode.addNameSetting("Giftcode"),this.giftCode.addButtonRight(),this.listView.add(this.giftCode)}},{key:"addSynsFB",value:function(){this.synsFB=new Hc,this.synsFB.addType(Hc.SYNS_FB),this.synsFB.event.chooseSetting.add(this.chooseSetting,this),this.synsFB.addNameSetting("Liên kết với Facebook"),this.synsFB.addButtonRight(),this.listView.add(this.synsFB)}},{key:"addVersionPlatform",value:function(){this.versionPlatform=new Hc,this.versionPlatform.addType(Hc.VERSION_PLATFORM),this.versionPlatform.event.chooseSetting.add(this.chooseSetting,this),this.versionPlatform.addNameSetting("Phiên bản trò chơi"),this.versionPlatform.addVersion(),this.versionPlatform.setDisactive(),this.listView.add(this.versionPlatform)}},{key:"chooseSetting",value:function(e){switch(e){case Hc.SETTING_GAME:IE.instance().addSettingGameScreen();break;case Hc.SETTING_ACCOUNT:IE.instance().addSettingAccountScreen();break;case Hc.SETTING_PROFILE:IE.instance().addSettingProfileScreen();break;case Hc.GIFT_CODE:IE.instance().addSettingGiftcode();break;case Hc.SYNS_FB:this.synsWithFacebook()}}},{key:"addBtnLogout",value:function(){this.btnLogout=new Phaser.Button(game,this.positionSetting.btn_logout.x,game.height-z.instance().STANDARD_HEIGHT+this.positionSetting.btn_logout.y,this.positionSetting.btn_logout.nameAtlas,this.onClickLogout,this,null,this.positionSetting.btn_logout.nameSprite),this.btnLogout.anchor.set(.5,0);var e=new _t(this.positionSetting.txt_logout,this.positionSetting.txt_logout.text);e.anchor.set(.5),this.btnLogout.addChild(e),this.listView.add(this.btnLogout)}},{key:"onClickLogout",value:function(){1==z.instance().LOG_IN_BY_FB?ui.instance().logout(function(e){"unknown"==e.status&&(z.instance().LOG_IN_BY_FB=!1,TF.instance().sendLogout())}):TF.instance().sendLogout()}},{key:"synsWithFacebook",value:function(){!0!==z.instance().LOG_IN_BY_FB?(qe.instance().showLoading(),console.log("Let's syns FB"+z.instance().platform),"web"!==z.instance().platform?(Ie.instance().login(),qe.instance().showLoading()):FB.login(function(e){if("unknown"==e.status&&alert("Đăng nhập lỗi, hãy đăng nhập lại! :'("),"connected"==e.status){var t=e.authResponse,n={userId:TF.instance().dataMySeft.user_id,fbId:t.userID,accessToken:t.accessToken};$.ajax({type:"POST",url:window.RESOURCE.fb_sync_api,data:n,dataType:"json",success:function(e){"Failed"==e.status?Gn.instance().addDialog(e.message):"OK"==e.status&&(rF.instance().changeScreen(Ce.LOGIN),IE.instance().removeAllItem(),Gn.instance().removeAllItem())}})}},{scope:"email, user_gender, user_friends"})):Gn.instance().addDialog("It's already login FB!")}},{key:"addEventExtension",value:function(){Ie.instance().event.loginComplete.add(this.loginFbMobileComplete,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){Ie.instance().event.loginComplete.remove(this.loginFbMobileComplete,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"loginFbMobileComplete",value:function(e){var t={userId:TF.instance().dataMySeft.user_id,fbId:e.userID,accessToken:e.accessToken};$.ajax({type:"POST",url:window.RESOURCE.fb_sync_api,data:t,dataType:"json",success:function(e){"Failed"==e.status?Gn.instance().addDialog(e.message):"OK"==e.status&&(rF.instance().changeScreen(Ce.LOGIN),IE.instance().removeAllItem(),Gn.instance().removeAllItem())}})}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Vc(n.prototype,i),o&&Vc(n,o),t}();function Yc(e){return(Yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jc(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xc(e,t){return!t||"object"!==Yc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $c(e){return($c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eu(e,t){return(eu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tu=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Xc(this,$c(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.event={onSetting:new Phaser.Signal,offSetting:new Phaser.Signal},e.name,e.btnOn,e.btnOff,e.boolean=!1,e.addLine(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eu(e,t)}(t,Phaser.Group),n=t,o=[{key:"SOUND_FX",get:function(){return"setting_game_soundfx"}},{key:"INVITE_PARTY",get:function(){return"setting_game_invite_party"}}],(i=[{key:"addType",value:function(e){this.type=e}},{key:"addNameSetting",value:function(e){this.name=new _t(this.positionSetting.setting_item.name,e),this.addChild(this.name)}},{key:"addButton",value:function(e){this.boolean=e,1==e?(this.addButtonOn(1,1),this.addButtonOff(0,1)):(this.addButtonOn(0,1),this.addButtonOff(1,1)),this.txtBtnOn=new _t(this.positionSetting.setting_item.txt_button_on,this.positionSetting.setting_item.txt_button_on.text),this.txtBtnOn.kill(),this.txtBtnOff=new _t(this.positionSetting.setting_item.txt_button_off,this.positionSetting.setting_item.txt_button_off.text),this.txtBtnOff.kill(),this.addChild(this.txtBtnOn),this.addChild(this.txtBtnOff),1==this.boolean?this.txtBtnOn.revive():this.txtBtnOff.revive()}},{key:"addButtonOn",value:function(e,t){this.btnOn=new pt(this.positionSetting.setting_item.button_on,this.clickOn,this),this.btnOn.scale.set(e,t),this.addChild(this.btnOn)}},{key:"addButtonOff",value:function(e,t){this.btnOff=new pt(this.positionSetting.setting_item.button_off,this.clickOff,this),this.btnOff.anchor.set(1,0),this.btnOff.scale.set(e,t),this.addChild(this.btnOff)}},{key:"clickOn",value:function(){this.boolean=!1,this.event.offSetting.dispatch(),this.addTweenButton()}},{key:"clickOff",value:function(){this.boolean=!0,this.event.onSetting.dispatch(),this.addTweenButton()}},{key:"addTweenButton",value:function(){1==this.boolean?(this.txtBtnOn.revive(),this.txtBtnOff.kill(),game.add.tween(this.btnOn.scale).to({x:1,y:1},250,"Linear",!1).start(),game.add.tween(this.btnOff.scale).to({x:0,y:1},250,"Linear",!1).start()):(this.txtBtnOff.revive(),this.txtBtnOn.kill(),game.add.tween(this.btnOff.scale).to({x:1,y:1},250,"Linear",!1).start(),game.add.tween(this.btnOn.scale).to({x:0,y:1},250,"Linear",!1).start())}},{key:"setDisactive",value:function(){this.alpha=.4,this.inputEnabled=!1,this.btnOff.inputEnabled=!1,this.btnOn.inputEnabled=!1}},{key:"addLine",value:function(){var e=new rt(this.positionSetting.setting_item.line);this.addChild(e)}},{key:"height",get:function(){return 102*window.GameConfig.RESIZE}}])&&Jc(n.prototype,i),o&&Jc(n,o),t}();function nu(e){return(nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ou(e,t){return!t||"object"!==nu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function au(e){return(au=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function su(e,t){return(su=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ru=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ou(this,au(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&su(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addHeaderTab(this.positionSetting.header),this.addListSetting()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting_game)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addListSetting",value:function(){var e=new Phaser.Group(game,this);e.x=0,e.y=109*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0*window.GameConfig.RESIZE,0,640*window.GameConfig.RESIZE,885*window.GameConfig.RESIZE);this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.settingSoundFx,this.settingInviteParty,this.addSettingSoundFx(),this.addSettingInviteParty()}},{key:"addSettingSoundFx",value:function(){this.settingSoundFx=new tu,this.settingSoundFx.event.onSetting.add(this.onSettingSoundFX,this),this.settingSoundFx.event.offSetting.add(this.offSettingSoundFX,this),this.settingSoundFx.addType(tu.SOUND_FX),this.settingSoundFx.addNameSetting("Âm thanh"),this.settingSoundFx.addButton(window.GameConfig.SOUND_FX),this.listView.add(this.settingSoundFx)}},{key:"onSettingSoundFX",value:function(){window.GameConfig.SOUND_FX=!0}},{key:"offSettingSoundFX",value:function(){window.GameConfig.SOUND_FX=!1}},{key:"addSettingInviteParty",value:function(){this.settingInviteParty=new tu,this.settingInviteParty.addType(tu.INVITE_PARTY),this.settingInviteParty.addNameSetting("Lời mời chơi nhóm"),this.settingInviteParty.addButton(!0),this.settingInviteParty.setDisactive(),this.listView.add(this.settingInviteParty)}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&iu(n.prototype,i),o&&iu(n,o),t}();function lu(e){return(lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cu(e,t){return!t||"object"!==lu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uu(e){return(uu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function du(e,t){return(du=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fu=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=cu(this,uu(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.event={chooseSetting:new Phaser.Signal},e.name,e.btn,e.txtOnRight,e.addLine(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&du(e,t)}(t,Phaser.Group),n=t,o=[{key:"SETTING_ACCOUNT_VIP",get:function(){return"setting_account_vip"}},{key:"SETTING_ACCOUNT_USERNAME",get:function(){return"setting_account_username"}},{key:"SETTING_ACCOUNT_EMAIL",get:function(){return"setting_account_email"}},{key:"SETTING_ACCOUNT_PASSWORD",get:function(){return"setting_account_password"}},{key:"SETTING_ACCOUNT_GENDER",get:function(){return"setting_account_gender"}}],(i=[{key:"addLine",value:function(){var e=new rt(this.positionSetting.setting_item.line);this.addChild(e)}},{key:"addTxtOnright",value:function(e){this.txtOnRight=new _t(this.positionSetting.setting_item.txt_on_right,e),this.txtOnRight.anchor.set(1,0),this.addChild(this.txtOnRight)}},{key:"addType",value:function(e){this.type=e}},{key:"addNameSetting",value:function(e){this.name=new _t(this.positionSetting.setting_item.name,e),this.addChild(this.name)}},{key:"addButtonRight",value:function(){this.btn=new pt(this.positionSetting.setting_item.button_right,this.clickButton,this),this.btn.anchor.set(.5),this.addChild(this.btn)}},{key:"addButtonTop",value:function(){}},{key:"addButtonBottom",value:function(){}},{key:"setDisactive",value:function(){this.alpha=.4}},{key:"clickButton",value:function(){this.event.chooseSetting.dispatch(this.type)}},{key:"height",get:function(){return 102*window.GameConfig.RESIZE}}])&&hu(n.prototype,i),o&&hu(n,o),t}();function pu(e){return(pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yu(e){return(yu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mu(e,t){return(mu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vu(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var wu=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=yu(t).call(this,game))||"object"!==pu(i)&&"function"!=typeof i?vu(n):i).event={choose_gender:new Phaser.Signal},e.positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.bgGenres=new pt(e.positionSetting.sort_play_list_bg_search_menu),e.bgGenres.height=120*z.instance().scale,e.bgGenres.width=161*z.instance().scale,e.addChild(e.bgGenres),e.arrSort=["MALE","FEMALE"];for(var o=10,a=0;a<e.arrSort.length;a++){var s=new ln(e.positionSetting.bg_tab_menu_select_item,e.arrSort[a],e.chooseItem,vu(vu(e)));s.name=a,s.y=o,s.x=10,o+=45,e.addChild(s)}return e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mu(e,t)}(t,Phaser.Group),n=t,(i=[{key:"chooseItem",value:function(e){LogConsole.log("chooseItem : "+e.name),this.event.choose_gender.dispatch(e.name,this.arrSort[parseInt(e.name)])}}])&&gu(n.prototype,i),o&&gu(n,o),t}();function bu(e){return(bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _u(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Su(e,t){return!t||"object"!==bu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Eu(e){return(Eu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cu(e,t){return(Cu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ku=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Su(this,Eu(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cu(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.settingGender=null,this.addHeaderTab(this.positionSetting.header),this.addListSetting()}},{key:"addEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"onUpdateUserVars",value:function(){this.userName.txtOnRight.setText(TF.instance().dataMySeft.user_name),this.gender.txtOnRight.setText(TF.instance().dataMySeft.gender)}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting_account)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addListSetting",value:function(){var e=new Phaser.Group(game,this);e.x=0,e.y=109*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0*window.GameConfig.RESIZE,0,640*window.GameConfig.RESIZE,885*window.GameConfig.RESIZE);this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.vip,this.userName,this.gender,this.email,this.password,this.addVip(),this.addUserName(),this.addGender(),this.addEmail(),this.addPassword(),this.addEventExtension()}},{key:"addVip",value:function(){this.vip=new fu,this.vip.addNameSetting("Tài khoản Vip"),this.vip.addType(fu.SETTING_ACCOUNT_VIP),this.vip.addTxtOnright("Chưa có"),this.vip.event.chooseSetting.add(this.chooseSetting,this),this.listView.add(this.vip)}},{key:"addGender",value:function(){this.gender=new fu,this.gender.addNameSetting("Giới tính"),this.gender.addType(fu.SETTING_ACCOUNT_GENDER),this.gender.addButtonRight(),null!==TF.instance().socket.mySelf?this.gender.addTxtOnright(TF.instance().dataMySeft.gender):this.gender.addTxtOnright("Chưa có"),this.gender.event.chooseSetting.add(this.chooseSetting,this),this.listView.add(this.gender)}},{key:"addUserName",value:function(){this.userName=new fu,this.userName.addNameSetting("Tên người dùng"),this.userName.addType(fu.SETTING_ACCOUNT_USERNAME),this.userName.addButtonRight(),null!==TF.instance().socket.mySelf?this.userName.addTxtOnright(TF.instance().dataMySeft.user_name):this.userName.addTxtOnright("Chưa có"),this.userName.event.chooseSetting.add(this.chooseSetting,this),this.listView.add(this.userName)}},{key:"addEmail",value:function(){this.email=new fu,this.email.addNameSetting("Email"),this.email.addType(fu.SETTING_ACCOUNT_EMAIL),this.email.addButtonRight(),this.email.addTxtOnright("anh******@gmail.com"),this.email.event.chooseSetting.add(this.chooseSetting,this),this.email.setDisactive(),this.listView.add(this.email)}},{key:"addPassword",value:function(){this.password=new fu,this.password.addNameSetting("Mật khẩu"),this.password.addType(fu.SETTING_ACCOUNT_PASSWORD),this.password.addButtonRight(),this.password.addTxtOnright("*********"),this.password.event.chooseSetting.add(this.chooseSetting,this),this.password.setDisactive(),this.listView.add(this.password)}},{key:"chooseSetting",value:function(e){switch(e){case fu.SETTING_ACCOUNT_USERNAME:IE.instance().addSettingAccountUserNameScreen();break;case fu.SETTING_ACCOUNT_GENDER:this.addSettingGender()}}},{key:"addSettingGender",value:function(){this.removeSettingGender(),this.settingGender=new wu,this.settingGender.x=430,this.settingGender.y=360,this.settingGender.event.choose_gender.add(this.choosedGender,this),this.addChild(this.settingGender)}},{key:"removeSettingGender",value:function(){null!==this.settingGender&&(this.removeChild(this.settingGender),this.settingGender.destroy(),this.settingGender=null)}},{key:"choosedGender",value:function(e,t){this.settingGender.destroy(),gl.instance().settingAccount(TF.instance().socket.mySelf.getVariable("user_id").value,TF.instance().dataMySeft.user_name,t,null),gl.instance().sendData(this.onChangeGender.bind(this))}},{key:"onChangeGender",value:function(e){if("ok"==e.code){var t=[];t.push(new SFS2X.SFSUserVariable("gender",e.data.gender)),TF.instance().socket.send(new SFS2X.SetUserVariablesRequest(t)),TF.instance().dataMySeft.setGender(e.data.gender)}}},{key:"destroy",value:function(){for(this.listView.removeAll(),this.removeEventExtension(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&_u(n.prototype,i),o&&_u(n,o),t}();function Pu(e){return(Pu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ou(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ru(e,t){return!t||"object"!==Pu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xu(e){return(xu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tu(e,t){return(Tu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Iu=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ru(this,xu(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tu(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){null!==TF.instance().socket.mySelf?this.nameChange=TF.instance().dataMySeft.user_name:this.nameChange="NameXXX_XXX",this.addEventExtension(),this.addHeaderTab(this.positionSetting.header),this.txtSettingHead,this.boxText,this.txtBoxText,this.btnSave,this.tick,this.addTxtSettingHead(),this.addBoxText(),this.addTxtBoxText(),this.addBtnSave(),this.addTick()}},{key:"addTxtSettingHead",value:function(){this.txtSettingHead=new _t(this.positionSetting.setting_account.txt_setting_head,this.positionSetting.setting_account.txt_setting_head.text),this.txtSettingHead.anchor.set(.5),this.addChild(this.txtSettingHead)}},{key:"addBoxText",value:function(){this.boxText=new pt(this.positionSetting.setting_account.box_text,this.clickBoxText,this),this.boxText.anchor.set(.5),this.addChild(this.boxText)}},{key:"addTxtBoxText",value:function(){this.txtBoxText=new _t(this.positionSetting.setting_account.txt_box_text,this.nameChange),this.txtBoxText.anchor.set(.5),this.boxText.addChild(this.txtBoxText)}},{key:"addBtnSave",value:function(){this.btnSave=new pt(this.positionSetting.setting_account.btn_save,this.clickSave,this),this.btnSave.anchor.set(.5);var e=new _t(this.positionSetting.setting_account.txt_btn_save,this.positionSetting.setting_account.txt_btn_save.text);e.anchor.set(.5),this.btnSave.addChild(e),this.addChild(this.btnSave)}},{key:"addTick",value:function(){this.tick=new rt(this.positionSetting.setting_account.tick),this.boxText.addChild(this.tick)}},{key:"clickBoxText",value:function(){this.tick.kill(),this.inputKeyboard()}},{key:"inputKeyboard",value:function(){var e={maxLength:"",showTransparent:!0,placeholder:"Nhập tên thay đổi",isSearch:!1,typeInputText:"input",configText:{width:this.boxText.width-70,height:this.boxText.height-5,x:this.boxText.x-this.boxText.width/2,y:this.boxText.y-this.boxText.height/2}};$r.instance().event.cancle.add(this.keyboardClose,this),$r.instance().event.enter.add(this.keyboardDone,this),$r.instance().event.submit.add(this.keyboardDone,this),$r.instance().show(e),$r.instance().setValue(this.nameChange)}},{key:"keyboardClose",value:function(){$r.instance().event.cancle.remove(this.keyboardClose,this),$r.instance().event.enter.remove(this.keyboardDone,this),$r.instance().event.submit.remove(this.keyboardDone,this),$r.instance().hide(),this.boxText.revive(),this.btnSave.revive()}},{key:"keyboardDone",value:function(){""!==this.nameChange&&""==$r.instance().getValue()||(this.nameChange=$r.instance().getValue(),LogConsole.log(this.nameChange)),this.changeTxtBoxText(),this.keyboardClose()}},{key:"changeTxtBoxText",value:function(){this.txtBoxText.setText(this.nameChange)}},{key:"clickSave",value:function(){this.keyboardDone(),this.nameChange==TF.instance().dataMySeft.user_name||(this.btnSave.kill(),gl.instance().settingAccount(TF.instance().socket.mySelf.getVariable("user_id").value,this.nameChange,TF.instance().socket.mySelf.getVariable("gender").value,null),gl.instance().sendData(this.onSendSettingDone.bind(this)))}},{key:"onSendSettingDone",value:function(e){if(LogConsole.log(e),this.btnSave.revive(),"ok"==e.code){this.tick.revive(),Gn.instance().addDialog("Đổi tên thành công");var t=[];t.push(new SFS2X.SFSUserVariable("user_name",this.nameChange)),TF.instance().socket.send(new SFS2X.SetUserVariablesRequest(t)),TF.instance().dataMySeft.setUserName(this.nameChange)}}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting_account_username)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for($r.instance().hide(),this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Ou(n.prototype,i),o&&Ou(n,o),t}();var Au=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.login_id=0,this.gender="",this.ticket=0,this.login_type="",this.level=0,this.user_name="",this.all_time_high_score=0,this.last_login=0,this.created=0,this.heart_updated=0,this.active=0,this.avatar=0,this.experience_score=0,this.heart=0,this.support_item=0,this.diamond=0,this.weekly_high_score=0,this.id=0,this.is_online=!1,this.email="",this.count_login=0,this.vip=!1,this.support_item=0,this.level_title=""};function Lu(e){return(Lu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Du(e,t){return!t||"object"!==Lu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mu(e){return(Mu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nu(e,t){return(Nu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bu=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Du(this,Mu(t).call(this,game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite))).configsValue=n,i.initChild(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nu(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addEvent",value:function(){Ur.instance().event.buy_playlist.add(this.buyPlaylistDone,this)}},{key:"removeEvent",value:function(){Ur.instance().event.buy_playlist.remove(this.buyPlaylistDone,this)}},{key:"getData",value:function(e){switch(e.cmd){case Hs.SHOP_BUY_PLAYLIST_RESPONSE:this.signalInput.dispatch({isBuyDone:!0})}}},{key:"buyPlaylistDone",value:function(){this.signalInput.dispatch({isBuyDone:!0})}},{key:"initChild",value:function(){this.avaThumb=null,this.tabGem=null,this.txtPlaylist=null,this.txtGem=null,this.signalInput=new Phaser.Signal,this.inputEnabled=!0,this.txtNoHasPlaylist=null,this.addEvent()}},{key:"checkHasSuggestPlaylist",value:function(e,t){e?null==e.id?t(!1):t(!0):t(!1)}},{key:"addInput",value:function(e,t){this.removeEventInput(e,t),this.addEventInput(e,t),this.events.onInputUp.add(this.onClickSprite,this)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"onClickSprite",value:function(){if(ce.instance().playSound(ce.buttonclick),1==this.configsValue.isFree&&this.signalInput.dispatch({id:this.configsValue.id,isBuy:null}),0==this.configsValue.isFree){var e=new Ah;e=Object.assign({},e,this.configsValue),IE.instance().buyItem(e)}}},{key:"addThumb",value:function(){this.thumb=new Phaser.Sprite(game,35*window.GameConfig.RESIZE,19*window.GameConfig.RESIZE,"songDetailSprites","Nhactre"),this.thumb.scale.set(105/165);var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawRoundedRect(35*window.GameConfig.RESIZE,19*window.GameConfig.RESIZE,105*window.GameConfig.RESIZE,105*window.GameConfig.RESIZE,20*window.GameConfig.RESIZE),this.addChild(e),this.addChild(this.thumb),this.thumb.mask=e}},{key:"addTextNoHasPlaylist",value:function(){this.txtNoHasPlaylist=new Phaser.Text(game,this.width/2*window.GameConfig.RESIZE,this.height/2*window.GameConfig.RESIZE,"BẠN ĐÃ ĐỦ HẾT PLAYLIST",{font:"GilroyBold",fill:"white",align:"center",fontSize:30}),this.txtNoHasPlaylist.anchor.set(.5),this.addChild(this.txtNoHasPlaylist)}},{key:"addTabGem",value:function(e,t){0==this.configsValue.isFree?(this.tabGem=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.addChild(this.tabGem)):1==this.configsValue.isFree&&(this.tabGem=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.text,t.configs),this.tabGem.anchor.set(1,0),this.addChild(this.tabGem))}},{key:"addTxtPlaylist",value:function(e,t){this.txtPlaylist=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,e,t.configs),this.addChild(this.txtPlaylist)}},{key:"addTxtGem",value:function(e,t){if(0==this.configsValue.isFree){this.txtGem=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,e,t.configs);var n=new rt(t.gem);this.tabGem.addChild(n),this.tabGem.addChild(this.txtGem)}}},{key:"beginLoadThumb",value:function(e){if(this.key=e,game.cache.checkImageKey(e))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(e,e),t.start()}}},{key:"loadStart",value:function(){}},{key:"onLoad",value:function(){game.cache.checkImageKey(this.key)&&this.thumb.loadTexture("".concat(this.key))}},{key:"destroy",value:function(){for(this.removeEvent();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&Gu(n.prototype,i),o&&Gu(n,o),t}();function ju(e){return(ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fu(e,t){return!t||"object"!==ju(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zu(e){return(Zu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hu(e,t){return(Hu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qu=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Fu(this,Zu(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),e.signalBuyPlaylistDone=new Phaser.Signal,e.event={choosedPlaylist:new Phaser.Signal},e.friend=n,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hu(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterGetPlaylistDone",value:function(e){this.playlist=e,null!=this.group&&null!=this.group||(this.group=new Phaser.Group(game),this.addChild(this.group))}},{key:"addSuggestPlaylist",value:function(){var e=this,t=new Bu(this.positionMainConfig.tab_recent,this.playlist);this.addChild(t),t.checkHasSuggestPlaylist(this.playlist,function(n){n?(t.addThumb(),t.beginLoadThumb(e.playlist.thumb),t.addTabGem(e.positionMainConfig.Tab_gem,e.positionMainConfig.txt_try_suggest_playlist_free),t.addTxtGem(e.playlist.price,e.positionMainConfig.txt_price_suggest_playlist),t.addTxtPlaylist(e.playlist.name,e.positionMainConfig.txt_suggest_playlist),t.addInput(e.onClickSuggestPlaylist,e)):e.destroy()})}},{key:"addOwnerPlaylist",value:function(){}},{key:"onClickSuggestPlaylist",value:function(e){LogConsole.log(e),e.isBuyDone?1==e.isBuyDone&&this.signalBuyPlaylistDone.dispatch():!0===e.isBuy?(LogConsole.log("true: ".concat(e.isBuy)),this.sendRequestBuyPlaylist(e.id)):!1===e.isBuy?LogConsole.log("false: ".concat(e.isBuy)):(this.questions=[],this.playlistId=e.id,this.playlistName=e.name,this.sendRequestChoosePlaylist(e.id))}},{key:"removeGroup",value:function(){null!==this.group&&this.group.destroy(),this.group=null}},{key:"sendRequestChoosePlaylist",value:function(e){LogConsole.log(this.idOpponent),this.event.choosedPlaylist.dispatch({id:e,name:this.playlist.name})}},{key:"sendRequestBuyPlaylist",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),TF.instance().sendData(Et.SHOP_BUY_PLAYLIST_REQUEST,t)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&Uu(n.prototype,i),o&&Uu(n,o),t}();function Vu(e){return(Vu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qu(e,t){return!t||"object"!==Vu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ku(e){return(Ku=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zu(e,t){return(zu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yu=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=qu(this,Ku(t).call(this,game))).positionMainConfig=JSON.parse(game.cache.getText("positionMainConfig")),n.friend=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zu(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.signalBuyPlaylistDone=new Phaser.Signal,this.event={choosePlaylist:new Phaser.Signal,backScreen:new Phaser.Signal}}},{key:"addChallPlayListGroup",value:function(e,t){if(this.listView,this.addGroupChallPlaylist(),this.addTabHeaderChoosePlaylist(),this.addTextHeader(),this.addBtnBackToMenu(),this.getPlaylistSuggestPlaylist=new Qu,this.getPlaylistSuggestPlaylist.event.choosedPlaylist.add(this.choosedSuggestPlaylist,this),this.getPlaylistSuggestPlaylist.afterGetPlaylistDone(t),this.getPlaylistSuggestPlaylist.signalBuyPlaylistDone.add(this.suggestPlaylistCallback,this),this.getPlaylistSuggestPlaylist.addSuggestPlaylist(),this.addChild(this.getPlaylistSuggestPlaylist),t)if(null==t.id){(o=new Phaser.Group(game)).x=0,o.y=105*window.GameConfig.RESIZE,this.addChild(o);var n=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-381)*window.GameConfig.RESIZE);this.listView=new Vo(game,o,n,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}else{(o=new Phaser.Group(game)).x=0,o.y=248*window.GameConfig.RESIZE,this.addChild(o);var i=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-381)*window.GameConfig.RESIZE);this.listView=new Vo(game,o,i,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}else{var o;(o=new Phaser.Group(game)).x=0,o.y=105*window.GameConfig.RESIZE,this.addChild(o);var a=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-381)*window.GameConfig.RESIZE);this.listView=new Vo(game,o,a,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}for(var s=0;s<e.length;s++)this.createTabPlaylist(e[s],s);this.loadLayerClassPlaylist()}},{key:"choosedSuggestPlaylist",value:function(e){this.event.choosePlaylist.dispatch(e)}},{key:"suggestPlaylistCallback",value:function(){this.signalBuyPlaylistDone.dispatch(),this.removeAllChild(),this.destroyAll(),this.destroy()}},{key:"addGroupChallPlaylist",value:function(){this.challPlaylistGroup=new Phaser.Group(game),this.addChild(this.challPlaylistGroup),this.challPlaylistGroup.position.x=0;var e=new Phaser.Button(game,0,0,"bg_create_room");this.addChild(e)}},{key:"addTabHeaderChoosePlaylist",value:function(){this.tab_chonplaylist=new Phaser.Sprite(game,this.positionMainConfig.tab_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.tab_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.tab_chonplaylist.nameAtlas,this.positionMainConfig.tab_chonplaylist.nameSprite),this.tab_chonplaylist.anchor.set(.5,0),this.addChild(this.tab_chonplaylist)}},{key:"addTextHeader",value:function(){var e=new Phaser.Text(game,this.positionMainConfig.txt_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.txt_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.txt_chonplaylist.text,this.positionMainConfig.txt_chonplaylist.configs);e.anchor.set(.5),this.tab_chonplaylist.addChild(e)}},{key:"addBtnBackToMenu",value:function(){var e=this,t=new Phaser.Button(game,this.positionMainConfig.arrow_chonplaylist.x*window.GameConfig.RESIZE,this.positionMainConfig.arrow_chonplaylist.y*window.GameConfig.RESIZE,this.positionMainConfig.arrow_chonplaylist.nameAtlas,function(){},this,null,this.positionMainConfig.arrow_chonplaylist.nameSprite);t.anchor.set(.5),this.tab_chonplaylist.addChild(t),t.events.onInputDown.add(function(){ce.instance().playSound(ce.buttonclick),e.destroyAll(),e.event.backScreen.dispatch()})}},{key:"loadLayerClassPlaylist",value:function(){var e=new Phaser.Sprite(game,this.positionMainConfig.tab_gem_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.tab_gem_playlist.y*window.GameConfig.RESIZE,this.positionMainConfig.tab_gem_playlist.nameAtlas,this.positionMainConfig.tab_gem_playlist.nameSprite);e.anchor.set(1,0);var t=new Phaser.Sprite(game,this.positionMainConfig.gem_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.gem_playlist.y*window.GameConfig.RESIZE,this.positionMainConfig.gem_playlist.nameAtlas,this.positionMainConfig.gem_playlist.nameSprite);e.addChild(t);var n=new Phaser.Text(game,this.positionMainConfig.txt_gem_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.txt_gem_playlist.y*window.GameConfig.RESIZE,"".concat(TF.instance().socket.mySelf.getVariable("diamond").value),this.positionMainConfig.txt_gem_playlist.configs);e.addChild(n);var i=t.width+n.width;n.x=(e.width-i)/2-2.5-e.width,t.x=(e.width-i)/2+n.width+5-e.width,this.tab_chonplaylist.addChild(e);var o=new Phaser.Button(game,this.positionMainConfig.btn_change_playlist.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionMainConfig.btn_change_playlist.y)*window.GameConfig.RESIZE,this.positionMainConfig.btn_change_playlist.nameAtlas,this.onClickChangePlaylist,this,null,this.positionMainConfig.btn_change_playlist.nameSprite);o.anchor.set(.5),this.addChild(o);var a=new Phaser.Text(game,this.positionMainConfig.txt_change_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.txt_change_playlist.y*window.GameConfig.RESIZE,this.positionMainConfig.txt_change_playlist.text,this.positionMainConfig.txt_change_playlist.configs);a.anchor.set(.5),o.addChild(a)}},{key:"onClickChangePlaylist",value:function(){ce.instance().playSound(ce.buttonclick),IE.instance().addShop(0)}},{key:"createTabPlaylist",value:function(e,t){var n=this,i=new Phaser.Button(game,this.positionMainConfig.tab_playlist.x*window.GameConfig.RESIZE,(this.positionMainConfig.tab_playlist.y+193*t)*window.GameConfig.RESIZE,this.positionMainConfig.tab_playlist.nameAtlas,function(){},this,null,this.positionMainConfig.tab_playlist.nameSprite);i.anchor.set(.5,0);var o=new Phaser.Graphics(game,0,0);o.beginFill(16777215),o.drawRoundedRect(-283*window.GameConfig.RESIZE,5*window.GameConfig.RESIZE,105*window.GameConfig.RESIZE,105*window.GameConfig.RESIZE,10*window.GameConfig.RESIZE),i.addChild(o);var a=new rl(-283*window.GameConfig.RESIZE,5,"Nhactre",e.thumb,t);a.sprite.scale.set(105/165),a.sprite.mask=o,i.addChild(a.sprite);var s=new Phaser.Text(game,this.positionMainConfig.txt_playlist.x*window.GameConfig.RESIZE,this.positionMainConfig.txt_playlist.y*window.GameConfig.RESIZE,"".concat(e.name),this.positionMainConfig.txt_playlist.configs);i.addChild(s);var r=new Ch;r.x=this.positionMainConfig.level_playlist.x*window.GameConfig.RESIZE,r.y=this.positionMainConfig.level_playlist.y*window.GameConfig.RESIZE,e.user&&r.setData(e.user),i.addChild(r),this.resizeTxtAndLevel(s,r),i.id=e.id,i.name=e.name,this.addChild(i),i.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),n.event.choosePlaylist.dispatch({id:i.id,name:i.name})}),LogConsole.log(i.height),this.addLineUnder(i),this.listView.add(i)}},{key:"resizeTxtAndLevel",value:function(e,t){console.log(e.height,t.height);var n=(139-(e.height+t.height))/2;e.y=n-15*window.GameConfig.RESIZE,t.y=e.y+e.height+7}},{key:"addLineUnder",value:function(e){var t=new rt(this.positionMainConfig.line_under);e.addChild(t)}},{key:"destroyAll",value:function(){this.removeAllChild(),this.destroy(),this.listView&&(this.listView.removeAll(),this.listView.y&&this.listView.reset(),this.listView.destroy())}},{key:"removeAllChild",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"destroy",value:function(){for(this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Wu(n.prototype,i),o&&Wu(n,o),t}();function Ju(e){return(Ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xu(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $u(e,t){return!t||"object"!==Ju(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ed(e){return(ed=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function td(e,t){return(td=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var nd=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=$u(this,ed(t).call(this,game))).friend=e,n.afterInit(),n.playlist={id:null,name:null},n.event={choosePlaylist:new Phaser.Signal,backScreen:new Phaser.Signal},n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&td(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.challPlaylistGroupMenuModule=null,this.sendRequestGetPlaylist()}},{key:"sendRequestGetPlaylist",value:function(){1==Ur.instance().ktLoadPlaylist?this.loadPlaylistComplete():Ur.instance().sendGetDataShop()}},{key:"sendRequestChoosePlaylist",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),t.putInt("opponent_id",this.friend.id),TF.instance().sendData(Et.CHALLENGE_GAME_QUESTIONS_REQUEST,t),qe.instance().showLoading()}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.choosePlaylistBack,this),Ur.instance().event.load_playlist_complete.add(this.loadPlaylistComplete,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.choosePlaylistBack,this),Ur.instance().event.load_playlist_complete.remove(this.loadPlaylistComplete,this)}},{key:"onExtensionResponse",value:function(e){}},{key:"loadPlaylistComplete",value:function(){var e=this;this.handleParamsOnGetPlaylistResponse(1,function(){e.addChallPlaylist(),qe.instance().hideLoading()})}},{key:"signalBuyPlaylistDone",value:function(){this.sendRequestGetPlaylist(this.friend.id)}},{key:"handleParamsOnGetPlaylistResponse",value:function(e,t){this.playlists=[],1==e&&(this.playlists=Ur.instance().playlist.getArrMe(),this.playlists=this.playlists.sort(this.sortPlaylists),this.handleSuggestionPlaylist(),t())}},{key:"sortPlaylists",value:function(e,t){return e.user_playlist_mapping?e.user_playlist_mapping.updated>t.user_playlist_mapping.updated?-1:e.user_playlist_mapping.updated<t.user_playlist_mapping.updated?1:0:1}},{key:"handleSuggestionPlaylist",value:function(){this.suggestion_playlist=Ur.instance().playlist.getSuggestPlaylist(),this.suggestion_playlist.isFree=Math.round(Math.random())}},{key:"addChallPlaylist",value:function(){this.removeChallPlaylist(),this.challPlaylistGroupMenuModule=new Yu(this.friend),this.challPlaylistGroupMenuModule.signalBuyPlaylistDone.add(this.signalBuyPlaylistDone,this),this.challPlaylistGroupMenuModule.event.choosePlaylist.add(this.choosePlaylist,this),this.challPlaylistGroupMenuModule.event.backScreen.add(this.choosePlaylistBack,this),this.challPlaylistGroupMenuModule.addChallPlayListGroup(this.playlists,this.suggestion_playlist),this.addChild(this.challPlaylistGroupMenuModule)}},{key:"choosePlaylistBack",value:function(){this.event.backScreen.dispatch()}},{key:"choosePlaylist",value:function(e){this.playlist=e,this.event.choosePlaylist.dispatch(this.playlist),this.sendRequestChoosePlaylist(e.id)}},{key:"removeChallPlaylist",value:function(){null!==this.challPlaylistGroupMenuModule&&(this.removeChild(this.challPlaylistGroupMenuModule),this.challPlaylistGroupMenuModule.destroy(),this.challPlaylistGroupMenuModule=null)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Xu(n.prototype,i),o&&Xu(n,o),t}();function id(e){return(id="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function od(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ad(e,t){return!t||"object"!==id(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sd(e){return(sd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rd(e,t){return(rd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ld=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ad(this,sd(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Ch,this.playlistLevel.x=413*window.GameConfig.RESIZE,this.playlistLevel.y=this.positionPlayConfig.scoreText.y*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:310*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this),this.scoreText.revive()}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=310*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){game.cache.checkImageKey(this.keyAva)?this.ava=new Phaser.Sprite(game,this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionPlayConfig.ava_fb.y*window.GameConfig.RESIZE,this.keyAva):this.ava=new Phaser.Sprite(game,this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionPlayConfig.ava_fb.y*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.width=151,this.ava.height=151,this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(16777215),this.maskAva.drawCircle(this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionPlayConfig.ava_fb.y*window.GameConfig.RESIZE,151),this.maskAva.anchor.set(.5),this.ava.mask=this.maskAva,this.addChild(this.ava),this.addChild(this.maskAva),this.frameAva=new Phaser.Sprite(game,this.positionPlayConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionPlayConfig.ava_fb.y*window.GameConfig.RESIZE,this.positionPlayConfig.frame_ava_right.nameAtlas,this.positionPlayConfig.frame_ava_right.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.875*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionPlayConfig.nameFB.x*window.GameConfig.RESIZE,this.positionPlayConfig.nameFB.y*window.GameConfig.RESIZE,this.nameValue,this.positionPlayConfig.nameFB.configs),this.name.anchor.set(.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionPlayConfig.scoreText.x*window.GameConfig.RESIZE,this.positionPlayConfig.scoreText.y*window.GameConfig.RESIZE,this.scoreValue,this.positionPlayConfig.scoreText.configs),this.scoreText.anchor.set(.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){this.dotOnline=new rt(this.positionPlayConfig.dot_online_right),this.addChild(this.dotOnline)}}])&&od(n.prototype,i),o&&od(n,o),t}();function hd(e){return(hd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ud(e,t){return!t||"object"!==hd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dd(e){return(dd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fd(e,t){return(fd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pd=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ud(this,dd(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=-this.positionPlayConfig.avaOpp.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse,this.playlistLevel}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Ch,this.playlistLevel.x=78*window.GameConfig.RESIZE,this.playlistLevel.y=this.positionPlayConfig.scoreTextOpp.y*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:310*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this),this.scoreText.revive()}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=310*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){var e=this;this.ava=new rl(this.positionPlayConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.avaOpp.y*window.GameConfig.RESIZE,"ava-default",this.keyAva,1),this.ava.sprite.anchor.set(.5),this.ava.event.loadAvaDone.add(function(t){e.ava.sprite.width=151,e.ava.sprite.height=151},this),this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(16777215),this.maskAva.drawCircle(this.positionPlayConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.avaOpp.y*window.GameConfig.RESIZE,151),this.maskAva.anchor.set(.5),this.ava.sprite.mask=this.maskAva,this.addChild(this.ava.sprite),this.addChild(this.maskAva),this.frameAva=new Phaser.Sprite(game,this.positionPlayConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.avaOpp.y*window.GameConfig.RESIZE,this.positionPlayConfig.frame_ava_left.nameAtlas,this.positionPlayConfig.frame_ava_left.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.875*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionPlayConfig.nameFBOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.nameFBOpp.y*window.GameConfig.RESIZE,this.nameValue,this.positionPlayConfig.nameFBOpp.configs),this.name.anchor.set(.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionPlayConfig.scoreTextOpp.x*window.GameConfig.RESIZE,this.positionPlayConfig.scoreTextOpp.y*window.GameConfig.RESIZE,this.scoreValue,this.positionPlayConfig.scoreTextOpp.configs),this.scoreText.anchor.set(.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){1==this.configs.is_online?this.dotOnline=new rt(this.positionPlayConfig.dot_online_left):this.dotOnline=new rt(this.positionPlayConfig.dot_offline_left),this.addChild(this.dotOnline)}}])&&cd(n.prototype,i),o&&cd(n,o),t}();function gd(e){return(gd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function md(e){return(md=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vd(e,t){return(vd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var bd=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,s=md(t).call(this,game),(o=!s||"object"!==gd(s)&&"function"!=typeof s?wd(a):s).posX=e,o.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),o.sprite=new Phaser.Button(game,e+640,n,o.positionPlayConfig.answer_tab.nameAtlas,function(){},wd(wd(o)),null,o.positionPlayConfig.answer_tab.nameSprite),o.sprite.anchor=new Phaser.Point(.5,.5),o.sprite.update=o.update.bind(wd(wd(o))),o.sprite.inputEnabled=!0,o.configs=i,o.choosed=!1,o.addChild(o.sprite),o.event={answer:new Phaser.Signal},o.addTextToTabAnswer(),o.sprite.events.onInputDown.add(function(){o.choosed=!0,o.event.answer.dispatch(o.configs.index)}),o.addTweenSprite(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"addTweenSprite",value:function(){var e=this;setTimeout(function(){game.add.tween(e.sprite).to({x:e.posX},300,Phaser.Easing.Power1,!1).start()},200*(this.configs.index+1))}},{key:"update",value:function(){}},{key:"displayScreenWhenAnswerRight",value:function(){this.sprite.inputEnabled=!1,this.answerText.addColor("#01c66a",0)}},{key:"displayScreenWhenAnswerWrong",value:function(){this.sprite.inputEnabled=!1,this.answerText.addColor("#ff0000",0)}},{key:"displayScreenWhenAnswerNotChoosed",value:function(){this.answerText.addColor("#ffffff",0),this.sprite.inputEnabled=!1,this.sprite.alpha=.15}},{key:"addTextToTabAnswer",value:function(){this.answerText=new Phaser.Text(game,0,0,"".concat(this.configs.questions[this.configs.countQuiz].answers[this.configs.index]),{font:"GilroyMedium",fill:"#000000",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:500}),this.answerText.anchor.set(.5),this.sprite.value=this.configs.index+1,this.sprite.addChild(this.answerText)}},{key:"hide",value:function(){this.answerText.addColor("#ffffff",0),this.sprite.alpha=.15,this.sprite.inputEnabled=!1}},{key:"activeInput",value:function(){this.sprite.inputEnabled=!0}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&yd(n.prototype,i),o&&yd(n,o),t}();function _d(e){return(_d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ed(e){return(Ed=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cd(e,t){return(Cd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kd(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Pd=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Ed(t).call(this,game,0,0,null))||"object"!==_d(i)&&"function"!=typeof i?kd(n):i).trueAnswer=new Phaser.Sprite(game,0,0,"trueanswer"),e.trueAnswer.animations.add("trueanswer").onComplete.add(e.animTrueAnswerComplete,kd(kd(e))),e.trueAnswer.visible=!1,e.addChild(e.trueAnswer),e.failAnswer=new Phaser.Sprite(game,0,0,"failanswer"),e.failAnswer.animations.add("failanswer").onComplete.add(e.animFailAnswerComplete,kd(kd(e))),e.failAnswer.visible=!1,e.addChild(e.failAnswer),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cd(e,t)}(t,Mt),n=t,(i=[{key:"setSize",value:function(e,t){this.trueAnswer.width=e,this.trueAnswer.height=t,this.failAnswer.width=e,this.failAnswer.height=t}},{key:"animTrueAnswerComplete",value:function(){this.trueAnswer.visible=!1}},{key:"animFailAnswerComplete",value:function(){this.failAnswer.visible=!1}},{key:"setTrueAnswer",value:function(){this.trueAnswer.visible=!0,this.trueAnswer.animations.play("trueanswer",20,!1)}},{key:"setFailtAnswer",value:function(){this.failAnswer.visible=!0,this.failAnswer.animations.play("failanswer",20,!1)}},{key:"destroy",value:function(){this.failAnswer.destroy(),this.trueAnswer.destroy()}}])&&Sd(n.prototype,i),o&&Sd(n,o),t}();function Od(e){return(Od="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xd(e,t){return!t||"object"!==Od(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Td(e,t,n){return(Td="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Id(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Id(e){return(Id=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ad(e,t){return(Ad=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ld=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=xd(this,Id(t).call(this,game,0,0,null))).tween=null,e.countTween=0,e.scaleMin=.8,e.arrStr=["Tốt!","Hay quá","Tuyệt!","Quá giỏi","Đỉnh!","Tuyệt vời","Quá đỉnh","Không thể tin được","Thánh rồi"],e.arrColor=["#0cdb69","#fff222","#0ff5f8"],e.arrSpriteStreak=["actionphaseanswer1","actionphaseanswer2","actionphaseanswer3"],e.arrSize=[70,70,65,70,70,65,70,60,70],e.action=null,e.lbText=new _t(e.mainData.positionCreateRoom.text_action_phase_true_answer,""),e.lbText.anchor.set(.5),e.lbText.x=e.getWidth()/2,e.lbText.y=e.getHeight()/2,e.addChild(e.lbText),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ad(e,t)}(t,Mt),n=t,(i=[{key:"addStreak",value:function(){this.removeStreak(),ce.instance().playSound(ce.streakanswer),this.action=new Phaser.Sprite(game,0,0,this.arrSpriteStreak[Un.instance().randomNumber(0,2)]),this.action.animations.add("actionphaseanswer"),this.action.animations.play("actionphaseanswer",30),this.action.x=(this.getWidth()-this.action.width)/2,this.action.y=(this.getHeight()-this.action.height)/2,this.addChildAt(this.action,0)}},{key:"removeStreak",value:function(){null!==this.action&&(this.removeChild(this.action),this.action.destroy(),this.action=null)}},{key:"getWidth",value:function(){return 280}},{key:"getHeight",value:function(){return 280}},{key:"setStreak",value:function(e){(e-=1)<0&&(e=0),e>this.arrStr.length-1&&(e=this.arrStr.length-1),this.countTween=0,this.scaleMin=.8,this.addStreak();var t={fontSize:this.arrSize[e],fill:this.arrColor[Un.instance().randomNumber(0,2)]};this.bounces=100,this.lbText.scale.set(0),this.lbText.changeStyle(t),this.lbText.text=this.arrStr[e].toUpperCase(),this.beginTween(),this.removeIdTime(),this.idTime=game.time.events.add(1.5*Phaser.Timer.SECOND,this.setDefault,this)}},{key:"beginTween",value:function(){this.removeTween(),this.countTween++,1===this.countTween?this.tween=game.add.tween(this.lbText.scale).to({x:1,y:1},150,Phaser.Easing.Sinusoidal.InOut,!0):this.tween=game.add.tween(this.lbText.scale).to({x:1,y:1},this.bounces,Phaser.Easing.Sinusoidal.InOut,!0),this.tween.onComplete.add(this.onCompleteTween,this),this.bounces+=50}},{key:"onCompleteTween",value:function(){this.removeTween(),this.countTween<2&&(this.tween=game.add.tween(this.lbText.scale).to({x:this.scaleMin,y:this.scaleMin},this.bounces,Phaser.Easing.Sinusoidal.InOut,!0),this.tween.onComplete.add(this.beginTween,this),this.bounces+=50,this.scaleMin+=.1)}},{key:"removeTween",value:function(){null!==this.tween&&(game.tweens.remove(this.tween),this.tween=null)}},{key:"removeIdTime",value:function(){null!==this.idTime&&game.time.events.remove(this.idTime)}},{key:"setDefault",value:function(){this.removeIdTime(),this.removeStreak(),this.lbText.text=""}},{key:"destroy",value:function(){this.setDefault(),Td(Id(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.getWidth()}}])&&Rd(n.prototype,i),o&&Rd(n,o),t}();function Gd(e){return(Gd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Md(e,t){return!t||"object"!==Gd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nd(e){return(Nd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Bd(e,t){return(Bd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jd=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Md(this,Nd(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.event={resultGame:new Phaser.Signal},e.checkUseSpt=!1,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addScreenLoadTurnBase()}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"addScreenLoadTurnBase",value:function(){this.score=0,this.scoreOpp=0,this.countQuiz=0,this.correctList=[],this.wrongList=[],this.streak=1,this.answers=[],this.result,this.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new rt(this.positionPlayConfig.line_top);this.addChild(e),this.loadScreenPlayChallenged("Lượt tiếp"),this.addNamePlaylistAndTextLoading(),this.addActionPhase()}},{key:"addNamePlaylistAndTextLoading",value:function(){this.namePlaylist=new Phaser.Text(game,this.positionPlayConfig.namePlaylist.x*window.GameConfig.RESIZE,(this.positionPlayConfig.namePlaylist.y+80)*window.GameConfig.RESIZE,this.playlist.name,this.positionPlayConfig.namePlaylist.configs),this.namePlaylist.anchor.set(.5),this.addChild(this.namePlaylist),game.add.tween(this.namePlaylist).to({y:this.positionPlayConfig.namePlaylist.y*window.GameConfig.RESIZE},300,Phaser.Easing.Linear.Out,!1).start(),this.loadingAnim=new Fe,this.addChild(this.loadingAnim)}},{key:"addActionPhase",value:function(){this.actionPhase=new Ld,this.actionPhase.position.x=(this.game.width-this.actionPhase.width)/2,this.addChild(this.actionPhase)}},{key:"loadScreenPlayChallenged",value:function(e){var t=new Phaser.Sprite(game,this.positionPlayConfig.versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.versus.nameAtlas,this.positionPlayConfig.versus.nameSprite);t.anchor.set(.5);var n=new Phaser.Text(game,this.positionPlayConfig.txt_versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.text,this.positionPlayConfig.txt_versus.configs);n.anchor.set(.5),t.addChild(n),t.scale.set(.1),this.addChild(t),game.add.tween(t.scale).to({x:1,y:1},400,"Linear").start(),this.UserSpriteRight=new ld,this.UserSpriteRight.setAva("ava_fb"),this.UserSpriteRight.setPosition(),this.UserSpriteRight.setNameAndScore("You",this.score),this.UserSpriteRight.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRight.addDotOnline(),this.addChild(this.UserSpriteRight),this.UserSpriteRight.makeTweenAvaLoading(),this.trueOrFalseUser=new Pd,this.trueOrFalseUser.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseUser.x=320*window.GameConfig.RESIZE,this.trueOrFalseUser.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseUser),this.UserSpriteLeft=new pd(this.opponent),this.UserSpriteLeft.setAva(this.opponent.avatar),this.UserSpriteLeft.setPosition(),this.UserSpriteLeft.setNameAndScore(this.opponent.userName,e),this.UserSpriteLeft.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeft.addDotOnline(),this.addChild(this.UserSpriteLeft),this.trueOrFalseOpp=new Pd,this.trueOrFalseOpp.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseOpp.x=-10*window.GameConfig.RESIZE,this.trueOrFalseOpp.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseOpp),this.UserSpriteLeft.makeTweenAvaLoading(),this.loadAfter()}},{key:"loadAfter",value:function(){for(var e=[],t=0;t<5;t++)e.push(this.questions[t].songEntity.fileUrl);El.instance().loadSoundArray(e),El.instance().event.loadComplete.add(this.loadComplete,this)}},{key:"setData",value:function(e,t,n,i,o){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o}},{key:"loadComplete",value:function(){LogConsole.log("load complete"),this.loadingAnim.destroy(),this.makeTweenToPlay()}},{key:"loadStart",value:function(){}},{key:"makeTweenToPlay",value:function(){0==this.countQuiz&&(this.UserSpriteLeft.makeTweenAva(),this.UserSpriteRight.makeTweenAva()),this.addBtnRemoveAnswer(),this.createGamePlayChallenged()}},{key:"createGamePlayChallenged",value:function(){this.timeCounter=game.time.create(),0==this.countQuiz?this.createLoadingScreenAfterStart():this.displayAnswering()}},{key:"addCircleNormal",value:function(){for(var e=this,t=function(t){0==e.countQuiz&&setTimeout(function(){var n=new Phaser.Sprite(game,(e.positionPlayConfig.circleNormal.x+62*t)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y+50)*window.GameConfig.RESIZE,e.positionPlayConfig.circleNormal.nameAtlas,e.positionPlayConfig.circleNormal.nameSprite);n.anchor.set(.5),game.add.tween(n).to({y:(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start(),e.addChild(n)},50*t)},n=0;n<5;n++)t(n)}},{key:"addCorrectListSprites",value:function(){for(var e=0;e<this.correctList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.correctList[e].countQuiz)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Text(game,0,3*window.GameConfig.RESIZE,this.correctList[e].time.toFixed(1),{font:"GilroyBold",fontSize:15});n.anchor.set(.5),t.addChild(n)}}},{key:"addWrongListSprites",value:function(){for(var e=0;e<this.wrongList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.wrongList[e])*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,this.positionPlayConfig.wrongMini.nameAtlas,this.positionPlayConfig.wrongMini.nameSprite);n.anchor.set(.5),t.addChild(n)}}},{key:"createLoadingScreenAfterStart",value:function(){var e=this,t=game.add.audio("beep_audio"),n=new Phaser.Text(game,this.positionPlayConfig.countdownNumber.x*window.GameConfig.RESIZE,(this.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,"3",this.positionPlayConfig.countdownNumber.configs);n.anchor.set(.5),this.addChild(n);var i=game.add.tween(n).to({y:this.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("2");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("1");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){Le.instance().logEvent(Le.pro_quiz_start_turnbase),n.setText("Bắt đầu"),n.scale.set(.5),n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE;var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),i.onComplete.add(function(){n.destroy(),t.destroy(),e.addCircleNormal(),e.displayAnswering()})})})})}},{key:"displayAnswering",value:function(){var e=this;this.namePlaylist.destroy(),this.btn_remove_answer.revive(),El.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.timeTweenBegin=game.time.events.add(.5*Phaser.Timer.SECOND,function(){e.spriteTime=new Phaser.Sprite(game,0,(game.height-746)*window.GameConfig.RESIZE,"otherSprites","tween-time"),e.spriteTime.anchor.set(0,.5),e.addChild(e.spriteTime),e.tweenSpriteTime=game.add.tween(e.spriteTime.scale).to({x:70,y:1},1e4,"Linear"),e.createFourAnswer(),e.timeTweenStart=game.time.events.add(.2*Phaser.Timer.SECOND,function(){e.tweenSpriteTime.start(),e.timeCounter.start()},e),e.btn_remove_answer.inputEnabled=!0,e.btn_remove_answer.alpha=1,e.tweenSpriteTime.onComplete.add(function(){})})}},{key:"activeAnswer",value:function(){this.answerA.activeInput(),this.answerB.activeInput(),this.answerC.activeInput(),this.answerD.activeInput()}},{key:"addBtnRemoveAnswer",value:function(){this.btn_remove_answer=new Phaser.Button(game,this.positionPlayConfig.btn_remove_answer.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.btn_remove_answer.y)*window.GameConfig.RESIZE,this.positionPlayConfig.btn_remove_answer.nameAtlas,function(){},this,null,this.positionPlayConfig.btn_remove_answer.nameSprite),this.btn_remove_answer.anchor.set(.5),this.btn_remove_answer.kill();var e=new Phaser.Text(game,this.positionPlayConfig.txt_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.text,this.positionPlayConfig.txt_remove_answer.configs);e.anchor.set(.5);var t=new _t(this.positionPlayConfig.txt_dis_one,this.positionPlayConfig.txt_dis_one.text);t.anchor.set(.5),this.btn_remove_answer.addChild(t);var n=new Phaser.Sprite(game,this.positionPlayConfig.diamond_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.nameAtlas,this.positionPlayConfig.diamond_remove_answer.nameSprite);n.anchor.set(1,.5);var i=new rt(this.positionPlayConfig.mic_so_luong);i.anchor.set(.5),this.countMic=TF.instance().socket.mySelf.getVariable("support_item").value,this.numberOfSptItem=new _t(this.positionPlayConfig.number_mic_so_luong,TF.instance().socket.mySelf.getVariable("support_item").value),this.numberOfSptItem.anchor.set(.5),i.addChild(this.numberOfSptItem),this.btn_remove_answer.addChild(i),this.btn_remove_answer.addChild(n),this.btn_remove_answer.addChild(e),this.btn_remove_answer.inputEnabled=!1,this.btn_remove_answer.events.onInputDown.add(this.sendRemoveAnswer,this),this.addChild(this.btn_remove_answer)}},{key:"removeAnswer",value:function(){this.countMic--,this.numberOfSptItem.setText(this.countMic),this.btn_remove_answer.inputEnabled=!1,this.btn_remove_answer.alpha=.5,Bn.getTwoOfFourAnswer(this.answerA,this.answerB,this.answerC,this.answerD,this.questions[this.countQuiz])}},{key:"sendRemoveAnswer",value:function(){ce.instance().playSound(ce.buttonclick),0==this.checkUseSpt&&(TF.instance().dataMySeft.support_item>0?TF.instance().sendData(Et.SUPPORT_REQUEST,null):IE.instance().addDialog("Bạn không đủ Míc"))}},{key:"createFourAnswer",value:function(){for(var e=0;e<4;e++)0==e&&(this.answerA=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerA.event.answer.add(this.updateOnClickAnswer,this),this.addChild(this.answerA)),1==e&&(this.answerB=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerB.event.answer.add(this.updateOnClickAnswer,this),this.addChild(this.answerB)),2==e&&(this.answerC=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerC.event.answer.add(this.updateOnClickAnswer,this),this.addChild(this.answerC)),3==e&&(this.answerD=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerD.event.answer.add(this.updateOnClickAnswer,this),this.addChild(this.answerD))}},{key:"updateOnClickAnswer",value:function(e){if(this.answerA.sprite.inputEnabled=!1,this.answerB.sprite.inputEnabled=!1,this.answerC.sprite.inputEnabled=!1,this.answerD.sprite.inputEnabled=!1,this.answered=e,LogConsole.log(this.questions),LogConsole.log(e),e+1==this.questions[this.countQuiz].correctAnswer){if(this.setActionPhaseOnCorrect(),this.setTrueAva(),this.answeredResult=!0,this.timeCounter.ms/1e3>10)this.score+=Math.floor(100*Math.pow(1,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:10});else{var t=parseFloat((this.timeCounter.ms/1e3).toFixed(1));this.score+=Math.floor(100*(11-t)*Math.pow(11-t,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:t})}this.setScore(this.score),Ur.instance().playlist.setExpPlaylistById(this.playlist.id)}else this.setFalseAva(),this.answeredResult=!1,this.wrongList.push(this.countQuiz);for(var n=0;n<4;n++)0==n&&this.setTrueFalseTabAnswer(this.answerA,n),1==n&&this.setTrueFalseTabAnswer(this.answerB,n),2==n&&this.setTrueFalseTabAnswer(this.answerC,n),3==n&&this.setTrueFalseTabAnswer(this.answerD,n);this.pushResultAnswer(),this.addCorrectListSprites(),this.addWrongListSprites(),this.timeNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.resetQuestion,this)}},{key:"setActionPhaseOnCorrect",value:function(){this.questions[this.countQuiz].correctAnswer>2?this.actionPhase.position.y=game.height-636:this.actionPhase.position.y=game.height-416,this.actionPhase.setStreak(this.streak),this.addChild(this.actionPhase)}},{key:"pushResultAnswer",value:function(){var e="INCORRECT";if(1==this.answeredResult&&(e="CORRECT"),this.timeCounter.ms/1e3>10)this.answers.push({answer_time:10,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0});else{var t=parseFloat((this.timeCounter.ms/1e3).toFixed(1));this.answers.push({answer_time:t,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0})}}},{key:"removeTimeNextQuestion",value:function(){null!==this.timeNextQuestion&&game.time.events.remove(this.timeNextQuestion)}},{key:"resetQuestion",value:function(){this.removeTimeNextQuestion(),this.tweenSpriteTime.stop(),this.timeCounter.stop(),this.actionPhase.setDefault(),this.spriteTime.destroy(),this.timeCounter.destroy(),this.checkUseSpt=!1,this.answerA.destroy(),this.answerB.destroy(),this.answerC.destroy(),this.answerD.destroy(),1==this.answeredResult?this.streak++:this.streak=1,this.countQuiz<4?(this.countQuiz+=1,this.createGamePlayChallenged()):(El.instance().removeSound(),this.result={answers:this.answers,score:this.score,opponent_id:this.opponent.id,playlist_id:this.playlist.id},this.event.resultGame.dispatch(this.result))}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SUPPORT_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.removeAnswer()}},{key:"setTrueFalseTabAnswer",value:function(e,t){t==this.answered?t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerWrong():t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerNotChoosed()}},{key:"setTrueAva",value:function(){this.trueOrFalseUser.setTrueAnswer()}},{key:"setFalseAva",value:function(){this.trueOrFalseUser.setFailtAnswer()}},{key:"setTrueAvaOpp",value:function(){this.trueOrFalseOpp.setTrueAnswer()}},{key:"setFalseAvaOpp",value:function(){this.trueOrFalseOpp.setFailtAnswer()}},{key:"setScore",value:function(e){this.UserSpriteRight.setScore(e)}},{key:"setScoreOpp",value:function(e){this.UserSpriteLeft.setScore(e)}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timeTweenBegin),game.time.events.remove(this.timeTweenStart),El.instance().event.loadComplete.remove(this.loadComplete,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Dd(n.prototype,i),o&&Dd(n,o),t}();function Ud(e){return(Ud="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zd(e,t){return!t||"object"!==Ud(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hd(e){return(Hd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qd(e,t){return(Qd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vd=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=Zd(this,Hd(t).call(this,game,0,0,e.tab.nameAtlas,function(){},o,null,e.tab.nameSprite))).configs=e,a.gemCount=n,a.expCount=i,a.anchor.set(.5),a.gem,a.exp,a.txtGem,a.txtExp,a.addGemAndExp(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qd(e,t)}(t,Phaser.Button),n=t,(i=[{key:"addGemAndExp",value:function(){this.gem=new rt(this.configs.gem),this.addChild(this.gem),this.exp=new rt(this.configs.exp),this.addChild(this.exp),this.txtGem=new _t(this.configs.txt1,"+".concat(this.gemCount)),this.addChild(this.txtGem),this.txtExp=new _t(this.configs.txt2,"+".concat(this.expCount)),this.addChild(this.txtExp);var e=this.gem.width+this.txtGem.width,t=this.exp.width+this.txtExp.width;this.txtGem.x=(-this.width/2-e)/2+5*window.GameConfig.RESIZE,this.gem.x=(-this.width/2-e)/2+this.txtGem.width+10*window.GameConfig.RESIZE,this.txtExp.x=(this.width/2-t)/2-10*window.GameConfig.RESIZE,this.exp.x=(this.width/2-t)/2+this.txtGem.width-5*window.GameConfig.RESIZE}}])&&Fd(n.prototype,i),o&&Fd(n,o),t}();function Wd(e){return(Wd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qd(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Kd(e,t){return!t||"object"!==Wd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zd(e){return(zd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yd(e,t){return(Yd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Jd=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Kd(this,zd(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yd(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Ch,this.playlistLevel.x=355*window.GameConfig.RESIZE,this.playlistLevel.y=155*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:200*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this),this.scoreText.revive()}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=190*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){game.cache.checkImageKey(this.keyAva)?this.ava=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,this.keyAva):this.ava=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.width=80,this.ava.height=80;var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawCircle(this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,80),e.anchor.set(.5),this.ava.mask=e,this.addChild(e),this.addChild(this.ava),this.frameAva=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,this.positionWinConfig.frame_ava_right.nameAtlas,this.positionWinConfig.frame_ava_right.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.025*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionWinConfig.nameFB.x*window.GameConfig.RESIZE,140*window.GameConfig.RESIZE,this.nameValue,this.positionWinConfig.nameFB.configs),this.name.anchor.set(1,.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionWinConfig.scoreText.x*window.GameConfig.RESIZE,175*window.GameConfig.RESIZE,this.scoreValue,this.positionWinConfig.scoreText.configs),this.scoreText.anchor.set(1,.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){this.dotOnline=new rt(this.positionWinConfig.dot_online_right_challen),this.addChild(this.dotOnline)}},{key:"addBtnChallenGemAndExp",value:function(){var e=this;this.btnGemAndExp=new Vd(this.positionWinConfig.btn_gem_exp,1,1),this.btnGemAndExp.x=320,this.btnGemAndExp.y=275,this.btnGemAndExp.scale.set(0),this.addChild(this.btnGemAndExp),game.time.events.add(1*Phaser.Timer.SECOND,function(){game.add.tween(e.btnGemAndExp.scale).to({x:1,y:1},200,"Linear",!0).start()},this)}}])&&qd(n.prototype,i),o&&qd(n,o),t}();function Xd(e){return(Xd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ef(e,t){return!t||"object"!==Xd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tf(e){return(tf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nf(e,t){return(nf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var of=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ef(this,tf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Ch,this.playlistLevel.x=140*window.GameConfig.RESIZE,this.playlistLevel.y=155*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:200*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this),this.scoreText.revive()}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=190*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){var e=this;this.ava=new rl(this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,"ava-default",this.keyAva,0),this.ava.sprite.anchor.set(.5),this.ava.sprite.inputEnabled=!0,this.ava.event.loadAvaDone.add(function(){e.ava.sprite.width=80,e.ava.sprite.height=80},this),this.ava.sprite.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),IE.instance().addUserProfile(e.configs.id)},this);var t=new Phaser.Graphics(game,0,0);t.beginFill(16777215),t.drawCircle(this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,80),t.anchor.set(.5),this.ava.sprite.mask=t,this.addChild(t),this.addChild(this.ava.sprite),this.frameAva=new Phaser.Sprite(game,this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,168*window.GameConfig.RESIZE,this.positionWinConfig.frame_ava_left.nameAtlas,this.positionWinConfig.frame_ava_left.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.025*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionWinConfig.nameFBOpp.x*window.GameConfig.RESIZE,140*window.GameConfig.RESIZE,this.nameValue,this.positionWinConfig.nameFBOpp.configs),this.name.anchor.set(0,.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionWinConfig.scoreTextOpp.x*window.GameConfig.RESIZE,170*window.GameConfig.RESIZE,this.scoreValue,{font:"GilroyMedium",fill:"#93909d",fontSize:23}),this.scoreText.anchor.set(0,.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){1==this.configs.is_online?this.dotOnline=new rt(this.positionWinConfig.dot_online_left_challen):this.dotOnline=new rt(this.positionWinConfig.dot_offline_left_challen),this.addChild(this.dotOnline)}}])&&$d(n.prototype,i),o&&$d(n,o),t}();function af(e){return(af="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rf(e,t){return!t||"object"!==af(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lf(e){return(lf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hf(e,t){return(hf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cf=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=rf(this,lf(t).call(this,game,e,n,"songDetailSprites","Ava_Playlist"))).anchor.set(.5),o.scale.set(65/165*window.GameConfig.RESIZE),o.positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),o.configValues=i,o.ktPlay=!1,o.ktPause=!1,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hf(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.key="",this.btn,this.addUnBtn(this.positionWinConfig.songDetail_btn_pause),this.addBtn(this.positionWinConfig.songDetail_btn_play)}},{key:"loadAva",value:function(e,t){this.key=e||"",this.idx=t,this.beginLoad()}},{key:"addBtn",value:function(e){this.btn=new Phaser.Sprite(game,e.x,e.y,e.nameAtlas,e.nameSprite),this.btn.scale.set(80/65*window.GameConfig.RESIZE),this.addChild(this.btn)}},{key:"addUnBtn",value:function(e){this.unBtn=new Phaser.Sprite(game,e.x,e.y,e.nameAtlas,e.nameSprite),this.unBtn.scale.set(80/65*window.GameConfig.RESIZE),this.unBtn.kill(),this.addChild(this.unBtn)}},{key:"beginLoad",value:function(){if(game.cache.checkImageKey(this.key))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadComplete.add(this.onLoad,this),e.image(this.key,this.key),e.start()}}},{key:"playsound",value:function(){this.btn.kill(),this.unBtn.revive()}},{key:"stopSound",value:function(){this.btn.revive(),this.unBtn.kill()}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){game.cache.checkImageKey(e.key)&&e.loadTexture(e.key)},100*this.idx)}},{key:"width",get:function(){return 65}},{key:"height",get:function(){return 65}}])&&sf(n.prototype,i),o&&sf(n,o),t}();function uf(e){return(uf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function df(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ff(e,t){return!t||"object"!==uf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pf(e){return(pf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gf(e,t){return(gf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yf=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3?arguments[3]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ff(this,pf(t).call(this,game,285,0,null))).configValues=e,i.result=n,i.opponentResult=o,i.inputEnabled=!0,i.ktPlay=!1,i.index=a,i.anchor.set(.5,0),i.event={playSound:new Phaser.Signal,pauseSound:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gf(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){var e=this,t=new Phaser.Button(game,-114,0,"otherSprites",function(){var t=new $l(e.configValues);game.add.existing(t)},this,null,"Song_Result");this.addChild(t);var n=new Phaser.Sprite(game,0,135*window.GameConfig.RESIZE,"otherSprites","line-box-win");n.anchor.set(.5),this.addChild(n),this.imgAlbum=new cf(-160*window.GameConfig.RESIZE,70*window.GameConfig.RESIZE,this.configValues),this.imgAlbum.loadAva(this.configValues.thumb,this.index),this.imgAlbum.inputEnabled=!0,this.imgAlbum.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),1==e.ktPlay?e.pauseSound():e.event.playSound.dispatch(e.index)},this);var i=new Phaser.Graphics(game,0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE);i.beginFill(16777215),i.drawRoundedRect(-110*window.GameConfig.RESIZE,-110*window.GameConfig.RESIZE,220*window.GameConfig.RESIZE,220*window.GameConfig.RESIZE,10),i.anchor.set(.5),this.imgAlbum.mask=i,this.imgAlbum.addChild(i);var o=this.configValues.song;o=(new Mt).formatName(o,21);var a=new Phaser.Text(game,-99*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"".concat(o),{font:"Gilroy",fill:"#ffffff",wordWrap:!0,wordWrapWidth:500,maxLines:1,fontSize:22});a.anchor.set(0,.5),this.addChild(a);var s=new Phaser.Text(game,-99*window.GameConfig.RESIZE,81*window.GameConfig.RESIZE,"".concat(this.configValues.singer),{font:"Gilroy",fill:"#93909d",fontSize:19});if(s.anchor.set(0,.5),this.addChild(s),"CORRECT"==this.result.result.toUpperCase()){var r=game.add.sprite(230*window.GameConfig.RESIZE,51*window.GameConfig.RESIZE,"otherSprites","v_icon");r.anchor.set(.5),this.addChild(r);var l=new Phaser.Text(game,230*window.GameConfig.RESIZE,77*window.GameConfig.RESIZE,"".concat(this.result.answer_time.toFixed(1),"s"),{font:"GilroyMedium",fill:"#07cf81",fontSize:17});l.anchor.set(.5),this.addChild(l)}else{var h=game.add.sprite(230*window.GameConfig.RESIZE,51*window.GameConfig.RESIZE,"otherSprites","x_icon");h.anchor.set(.5),this.addChild(h);var c=new Phaser.Text(game,230*window.GameConfig.RESIZE,77*window.GameConfig.RESIZE,"".concat(this.result.answer_time.toFixed(1),"s"),{font:"GilroyMedium",fill:"#ff1d58",fontSize:17});c.anchor.set(.5),this.addChild(c)}if(null!==this.opponentResult)if("CORRECT"==this.opponentResult.result.toUpperCase()){var u=game.add.sprite(-230*window.GameConfig.RESIZE,51*window.GameConfig.RESIZE,"otherSprites","v_icon");u.anchor.set(.5),this.addChild(u);var d=new Phaser.Text(game,-230*window.GameConfig.RESIZE,77*window.GameConfig.RESIZE,"".concat(this.opponentResult.answer_time.toFixed(1),"s"),{font:"GilroyMedium",fill:"#07cf81",fontSize:17});d.anchor.set(.5),this.addChild(d)}else{var f=game.add.sprite(-230*window.GameConfig.RESIZE,51*window.GameConfig.RESIZE,"otherSprites","x_icon");f.anchor.set(.5),this.addChild(f);var p=new Phaser.Text(game,-230*window.GameConfig.RESIZE,77*window.GameConfig.RESIZE,"".concat(this.opponentResult.answer_time.toFixed(1),"s"),{font:"GilroyMedium",fill:"#ff1d58",fontSize:17});p.anchor.set(.5),this.addChild(p)}this.addChild(this.imgAlbum)}},{key:"pauseSound",value:function(){this.ktPlay=!1,this.imgAlbum.stopSound(),El.instance().pauseSound()}},{key:"stopSound",value:function(){this.ktPlay=!1,this.imgAlbum.stopSound()}},{key:"playSound",value:function(){!1===this.ktPlay&&(this.ktPlay=!0,El.instance().playsound(this.configValues.listenLink),this.imgAlbum.playsound())}},{key:"height",get:function(){return 135}}])&&df(n.prototype,i),o&&df(n,o),t}();function mf(e){return(mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wf(e,t){return!t||"object"!==mf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bf(e){return(bf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _f(e,t){return(_f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Sf=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=wf(this,bf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),e.addChild(e.bg),e.event={reHome:new Phaser.Signal,nextGame:new Phaser.Signal},e.challenge_msg_updated=0,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_f(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this;this.addEventExtension(),this.loadDisplayChallenge(function(){e.handleBtnNext()})}},{key:"handleBtnNext",value:function(){var e=this;if(this.listGame=[],this.gamesList=[],this.challengeGames=[],this.doneGames=[],this.waitingGames=[],this.gamesList=z.instance().menuOpponentsResponse,this.filterResponseGames(),this.listGame=this.checkHasGames(),this.listGame=this.listGame.sort(function(e,t){return e.base_updated-t.base_updated}),this.listGame.length>0&&void 0!==this.listGame){(n=new Phaser.Button(game,374*window.GameConfig.RESIZE,(game.height-81)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"btn_next_game")).anchor.set(.5);var t=new Phaser.Text(game,0,0,"".concat(this.positionWinConfig.txt_btn_next_game.text," ( ").concat(this.listGame.length," )"),this.positionWinConfig.txt_btn_next_game.configs);t.anchor.set(.5),n.addChild(t),n.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),"YOUR_TURN"==e.listGame[0].status?e.listGame[0].turnCount>0?e.event.nextGame.dispatch({opponent:e.listGame[0].opponentEntity,type:"BECHALLENGED",weeklyResult:{userWon:e.listGame[0].weeklyResult.userWon,opponentWon:e.listGame[0].weeklyResult.opponentWon},isHasHistory:!0,gameLogId:e.listGame[0].userGameLog,requestId:e.listGame[0].id,challenge_msg:e.listGame[0].challenge_msg}):e.event.nextGame.dispatch({opponent:e.listGame[0].opponentEntity,type:"BECHALLENGED",weeklyResult:{userWon:e.listGame[0].weeklyResult.userWon,opponentWon:e.listGame[0].weeklyResult.opponentWon},isHasHistory:!1,gameLogId:e.listGame[0].userGameLog,requestId:e.listGame[0].id,challenge_msg:e.listGame[0].challenge_msg}):"NO_GAME"==e.listGame[0].status&&e.event.nextGame.dispatch({opponent:e.listGame[0].opponentEntity,type:"CHALLENGE",weeklyResult:{userWon:e.listGame[0].weeklyResult.userWon,opponentWon:e.listGame[0].weeklyResult.opponentWon,challenge_msg:e.listGame[0].challenge_msg}})}),this.addChild(n)}else{var n;(n=new Phaser.Button(game,374*window.GameConfig.RESIZE,(game.height-81)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"btn_next_game")).anchor.set(.5);var i=new Phaser.Text(game,0,0,"".concat(this.positionWinConfig.txt_btn_find_game.text),this.positionWinConfig.txt_btn_next_game.configs);i.anchor.set(.5),n.addChild(i),n.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),rF.instance().changeScreen(Ce.TURN_BASE)},this),this.addChild(n)}}},{key:"sendRequestMainMenuLoad",value:function(){TF.instance().sendData(Et.MAIN_MENU_LOAD_REQUEST,null)}},{key:"setData",value:function(e,t,n,i,o,a,s,r,l){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.result=a,this.play_log_id=r,this.request_id=l,this.challenge_msg=s,this.challenge_msg=Bn.formatName(this.challenge_msg,25),LogConsole.log(this.result),LogConsole.log(this.opponent),LogConsole.log(this.questions),LogConsole.log(this.playlist)}},{key:"loadDisplayChallenge",value:function(e){this.UserSpriteRightWin=new Jd,this.UserSpriteRightWin.setAva("ava_fb"),this.UserSpriteRightWin.setNameAndScore("You",this.result.score),this.UserSpriteRightWin.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRightWin.makeDefaultScreenNotTween(),this.UserSpriteRightWin.addDotOnline(),this.addChild(this.UserSpriteRightWin),this.UserSpriteLeftWin=new of(this.opponent),this.UserSpriteLeftWin.setAva(this.opponent.avatar),this.UserSpriteLeftWin.setNameAndScore(this.opponent.userName,"Lượt tiếp"),this.UserSpriteLeftWin.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeftWin.makeDefaultScreenNotTween(),this.UserSpriteLeftWin.addDotOnline(),this.addChild(this.UserSpriteLeftWin),this.createBoxScoreYourChallen(),this.addEditMessage(),e()}},{key:"createBoxScoreYourChallen",value:function(){var e=new Phaser.Sprite(game,0,0,"playSprites","Header"),t=new Phaser.Text(game,game.width/2,38*window.GameConfig.RESIZE,this.playlist.name,{font:"Gilroy",fill:"white",fontSize:23});t.anchor.set(.5),e.addChild(t),this.addChild(e);var n=new Phaser.Graphics(game,0,(game.height-785)*window.GameConfig.RESIZE);n.beginFill(),n.drawRect(0,0,game.width,(game.height-491)*window.GameConfig.RESIZE),n.endFill(),this.addChild(n);var i=new Phaser.Button(game,game.width/2,1200*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Box_ketqua_old");i.anchor.set(.5,0),i.mask=n,this.UserSpriteRightWin.addBtnChallenGemAndExp(),this.addChild(i);var o=new Phaser.Group(game,0,0);o.y=1200,this.addChild(o);var a=new Phaser.Rectangle(35,0,615*window.GameConfig.RESIZE,(game.height-510)*window.GameConfig.RESIZE);this.listView=new Vo(game,o,a,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addTweenBoxResult(i,o);for(var s=0;s<5;s++){var r=new yf(this.questions[s].songEntity,this.result.answers[s],null,s);r.event.playSound.add(this.playSongResult,this),this.listView.add(r)}var l=new rt(this.positionWinConfig.shadow);l.y=game.height-z.instance().STANDARD_HEIGHT+this.positionWinConfig.shadow.y,this.addChild(l);var h=new Phaser.Button(game,80*window.GameConfig.RESIZE,(game.height-81)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Button_home");h.anchor.set(.5),h.events.onInputUp.add(this.backHome,this),this.addChild(h)}},{key:"addEditMessage",value:function(){this.txtEdit=new Phaser.Text(game,this.positionWinConfig.edit_message.txt.x,this.positionWinConfig.edit_message.txt.y,this.challenge_msg,this.positionWinConfig.edit_message.txt.configs),this.txtEdit.anchor.set(.5),this.addChild(this.txtEdit),this.btnEdit=new Phaser.Button(game,480,329,this.positionWinConfig.edit_message.btn.nameAtlas,this.onClickEditMessage,this,null,this.positionWinConfig.edit_message.btn.nameSprite),this.btnEdit.anchor.set(.5),this.addChild(this.btnEdit)}},{key:"onClickEditMessage",value:function(){$r.instance().show({maxLength:"",showTransparent:!0,placeholder:"Nhắn tin",isSearch:!1,typeInputText:"search",configText:{width:250,height:40,x:180,y:300}}),$r.instance().setValue(this.txtEdit.text)}},{key:"backHome",value:function(){ce.instance().playSound(ce.buttonclick),this.event.reHome.dispatch()}},{key:"playSongResult",value:function(e){El.instance().pauseSound();for(var t=0;t<this.listView.grp.children.length;t++){var n=this.listView.grp.children[t];n.index!==e?n.stopSound():n.playSound()}}},{key:"addTweenBoxResult",value:function(e,t){game.add.tween(e).to({y:(game.height-765)*window.GameConfig.RESIZE},500,"Linear",!1).start(),game.add.tween(t).to({y:(game.height-765)*window.GameConfig.RESIZE},500,"Linear",!1).start()}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.MAIN_MENU_LOAD_RESPONSE&&("OK"==e.params.getUtfString("status")||console.error("MAIN_MENU_LOAD_RESPONSE not response: ".concat(e.params.errorMessage)))}},{key:"filterResponseGames",value:function(){this.waitingGames=this.gamesList.filter(function(e){return"THEIR_TURN"==e.status}),this.doneGames=this.gamesList.filter(function(e){return"NO_GAME"==e.status}),this.challengeGames=this.gamesList.filter(function(e){return"YOUR_TURN"==e.status})}},{key:"checkHasGames",value:function(){return void 0!==this.challengeGames?this.challengeGames.concat(this.doneGames):[]}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.backHome,this),$r.instance().event.enter.add(this.doneKeyboard,this),$r.instance().event.submit.add(this.doneKeyboard,this)}},{key:"doneKeyboard",value:function(){var e=(new Date).getTime();e-this.challenge_msg_updated>6e3?(this.challenge_msg=$r.instance().getValue(),this.challenge_msg=Bn.formatName(this.challenge_msg,25),this.txtEdit.setText(this.challenge_msg),this.challenge_msg_updated=e,this.updateChallengeMsg(),$r.instance().hide()):(Gn.instance().addDialog("Bạn thay đổi quá nhanh, vui lòng thử lại"),$r.instance().hide())}},{key:"updateChallengeMsg",value:function(){var e=new SFS2X.SFSObject;e.putUtfString("challenge_msg",this.challenge_msg),e.putLong("challenge_request_id",this.request_id),TF.instance().sendData(Et.CHALLENGE_GAME_UPDATE_MESSAGE_REQUEST,e)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.backHome,this),$r.instance().event.enter.remove(this.doneKeyboard,this),$r.instance().event.submit.remove(this.doneKeyboard,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&vf(n.prototype,i),o&&vf(n,o),t}();function Ef(e){return(Ef="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kf(e,t){return!t||"object"!==Ef(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pf(e,t,n){return(Pf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Of(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Of(e){return(Of=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rf(e,t){return(Rf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xf=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=kf(this,Of(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse,this.dotOnline,this.btnGemAndExp}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Ch,this.playlistLevel.x=348*window.GameConfig.RESIZE,this.playlistLevel.y=272*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:323*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this)}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=272*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){game.cache.checkImageKey(this.keyAva)?this.ava=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionWinConfig.ava_fb.y*window.GameConfig.RESIZE,this.keyAva):this.ava=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionWinConfig.ava_fb.y*window.GameConfig.RESIZE,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.width=80,this.ava.height=80;var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawCircle(this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionWinConfig.ava_fb.y*window.GameConfig.RESIZE,80),e.anchor.set(.5),this.ava.mask=e,this.addChild(e),this.addChild(this.ava),this.frameAva=new Phaser.Sprite(game,this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionWinConfig.ava_fb.y*window.GameConfig.RESIZE,this.positionWinConfig.frame_ava_right.nameAtlas,this.positionWinConfig.frame_ava_right.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.035*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionWinConfig.nameFB.x*window.GameConfig.RESIZE,this.positionWinConfig.nameFB.y*window.GameConfig.RESIZE,this.nameValue,this.positionWinConfig.nameFB.configs),this.name.anchor.set(1,.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionWinConfig.scoreText.x*window.GameConfig.RESIZE,this.positionWinConfig.scoreText.y*window.GameConfig.RESIZE,this.scoreValue,this.positionWinConfig.scoreText.configs),this.scoreText.anchor.set(1,.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){this.dotOnline=new rt(this.positionWinConfig.dot_online_right),this.addChild(this.dotOnline)}},{key:"addBtnWinGemAndExp",value:function(){var e=this;this.btnGemAndExp=new Vd(this.positionWinConfig.btn_gem_exp,2,2),this.btnGemAndExp.x=320,this.btnGemAndExp.y=350,this.btnGemAndExp.scale.set(0),this.addChild(this.btnGemAndExp),this.timeTweenBtn=game.time.events.add(1*Phaser.Timer.SECOND,function(){game.add.tween(e.btnGemAndExp.scale).to({x:1,y:1},200,"Linear",!0).start()},this)}},{key:"addBtnLoseGemAndExp",value:function(){var e=this;this.btnGemAndExp=new Vd(this.positionWinConfig.btn_gem_exp,1,1),this.btnGemAndExp.x=320,this.btnGemAndExp.y=350,this.btnGemAndExp.scale.set(0),this.addChild(this.btnGemAndExp),this.timeTweenBtn=game.time.events.add(1*Phaser.Timer.SECOND,function(){game.add.tween(e.btnGemAndExp.scale).to({x:1,y:1},200,"Linear",!0).start()},this)}},{key:"destroy",value:function(){game.time.events.remove(this.timeTweenBtn),Pf(Of(t.prototype),"destroy",this).call(this)}}])&&Cf(n.prototype,i),o&&Cf(n,o),t}();function Tf(e){return(Tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function If(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Af(e,t){return!t||"object"!==Tf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lf(e){return(Lf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gf(e,t){return(Gf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Df=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Af(this,Lf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.configs=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setPosition",value:function(){this.x=this.positionWinConfig.ava_fb.x*window.GameConfig.RESIZE}},{key:"afterInit",value:function(){this.maskAva,this.ava,this.frameAva,this.name,this.nameValue,this.scoreText,this.scoreValue,this.trueOrFalse}},{key:"setAva",value:function(e){this.keyAva=e,this.addAva()}},{key:"setNameAndScore",value:function(e,t){this.nameValue=e,this.scoreValue=t,this.addNameAndScore()}},{key:"setLevelPlaylist",value:function(e){this.playlistLevel=new Ch,this.playlistLevel.x=155*window.GameConfig.RESIZE,this.playlistLevel.y=272*window.GameConfig.RESIZE,this.playlistLevel.setData(e),this.addChild(this.playlistLevel)}},{key:"makeTweenAvaLoading",value:function(){game.add.tween(this).to({x:0},1200,Phaser.Easing.Exponential.Out,!1).start()}},{key:"makeTweenAva",value:function(){var e=this,t=game.add.tween(this.playlistLevel).to({y:324*window.GameConfig.RESIZE},300,"Linear",!1);t.start(),t.onComplete.add(function(){e.scoreText.revive()},this)}},{key:"makeDefaultScreenNotTween",value:function(){this.playlistLevel.y=272*window.GameConfig.RESIZE,this.scoreText.revive()}},{key:"addAva",value:function(){var e=this;this.ava=new rl(this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.avaOpp.y*window.GameConfig.RESIZE,"ava-default",this.keyAva,0),this.ava.sprite.anchor.set(.5),this.ava.sprite.inputEnabled=!0,this.ava.event.loadAvaDone.add(function(){e.ava.sprite.width=80,e.ava.sprite.height=80},this),this.ava.sprite.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),IE.instance().addUserProfile(e.configs.id)},this);var t=new Phaser.Graphics(game,0,0);t.beginFill(16777215),t.drawCircle(this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.avaOpp.y*window.GameConfig.RESIZE,80),t.anchor.set(.5),this.ava.sprite.mask=t,this.addChild(this.ava.sprite),this.addChild(t),this.frameAva=new Phaser.Sprite(game,this.positionWinConfig.avaOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.avaOpp.y*window.GameConfig.RESIZE,this.positionWinConfig.frame_ava_left.nameAtlas,this.positionWinConfig.frame_ava_left.nameSprite),this.frameAva.anchor.set(.5),this.frameAva.scale.set(1.035*window.GameConfig.RESIZE),this.addChild(this.frameAva)}},{key:"addNameAndScore",value:function(){this.name=new Phaser.Text(game,this.positionWinConfig.nameFBOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.nameFBOpp.y*window.GameConfig.RESIZE,this.nameValue,this.positionWinConfig.nameFBOpp.configs),this.name.anchor.set(0,.5),this.addChild(this.name),this.scoreText=new Phaser.Text(game,this.positionWinConfig.scoreTextOpp.x*window.GameConfig.RESIZE,this.positionWinConfig.scoreTextOpp.y*window.GameConfig.RESIZE,this.scoreValue,this.positionWinConfig.scoreTextOpp.configs),this.scoreText.anchor.set(0,.5),this.scoreText.kill(),this.addChild(this.scoreText)}},{key:"setScore",value:function(e){var t=this,n=game.add.tween(this.scoreText).to({text:e},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.scoreText.text=parseInt(t.scoreText.text)},this)}},{key:"addDotOnline",value:function(){1==this.configs.is_online?this.dotOnline=new rt(this.positionWinConfig.dot_online_left):this.dotOnline=new rt(this.positionWinConfig.dot_offline_left),this.addChild(this.dotOnline)}}])&&If(n.prototype,i),o&&If(n,o),t}();function Mf(e){return(Mf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bf(e,t){return!t||"object"!==Mf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jf(e){return(jf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uf(e,t){return(Uf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ff=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Bf(this,jf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),e.addChild(e.bg),e.isLastWeek=!1,e.event={challengeAgain:new Phaser.Signal,reHome:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.loadDisplayBeChallenged(function(){})}},{key:"setData",value:function(e,t,n,i,o,a,s,r,l,h,c){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.result=a,this.play_log_id=l,this.request_id=h,this.opponentAnswerLogs=s,this.weeklyResult=r,this.dataTurnbase=c,LogConsole.log(this.result),LogConsole.log(this.opponent),LogConsole.log(this.questions),LogConsole.log(this.playlist),LogConsole.log(this.opponentAnswerLogs),LogConsole.log(this.weeklyResult)}},{key:"loadDisplayBeChallenged",value:function(e){this.UserSpriteRightWin=new xf,this.UserSpriteRightWin.setAva("ava_fb"),this.UserSpriteRightWin.setNameAndScore("You",this.result.score),this.UserSpriteRightWin.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRightWin.makeDefaultScreenNotTween(this.user_playlist_mapping),this.UserSpriteRightWin.addDotOnline(),this.addChild(this.UserSpriteRightWin),this.UserSpriteLeftWin=new Df(this.opponent),this.UserSpriteLeftWin.setAva(this.opponent.avatar),this.UserSpriteLeftWin.setNameAndScore(this.opponent.userName,this.result.scoreOpp),this.UserSpriteLeftWin.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeftWin.makeDefaultScreenNotTween(),this.UserSpriteLeftWin.addDotOnline(),this.addChild(this.UserSpriteLeftWin),this.createBoxScoreFriendChallen(),e()}},{key:"createBoxScoreFriendChallen",value:function(){var e=this;console.log("createBoxScoreFriendChallencreateBoxScoreFriendChallen"),console.log(this.weeklyResult);var t=new Phaser.Text(game,game.width/2,485*window.GameConfig.RESIZE,"Kết quả trong tuần",{font:"Gilroy",fill:"#9d92a6",fontSize:19});t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,"playSprites","Header"),i=new Phaser.Text(game,game.width/2,35*window.GameConfig.RESIZE,this.playlist.name,{font:"Gilroy",fill:"white",fontSize:23});i.anchor.set(.5),n.addChild(i),this.addChild(n);var o=new Phaser.Graphics(game,0,551*window.GameConfig.RESIZE);o.beginFill(),o.drawRect(0,0,game.width,(game.height-676)*window.GameConfig.RESIZE),o.endFill(),this.addChild(o);var a=new Phaser.Button(game,game.width/2,1200*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Box_ketqua_old");a.anchor.set(.5,0),a.mask=o;var s=new Phaser.Text(game,game.width/2,520*window.GameConfig.RESIZE,"Score",{font:"GilroyBold",fill:"white",fontSize:30});if(this.result.score>this.result.scoreOpp){ce.instance().playSound(ce.winturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Chiến thắng !!!",{font:"GilroyBold",fill:"white",fontSize:43})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon+1));var r=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,140*window.GameConfig.RESIZE,"firework");r.anchor.set(.5),this.addChild(r);r.animations.add("run_win");r.animations.play("run_win",30,!0),this.addChild(l),this.UserSpriteRightWin.addBtnWinGemAndExp()}else if(this.result.score==this.result.scoreOpp){ce.instance().playSound(ce.loseturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Điểm số hòa !!!",{font:"GilroyBold",fill:"white",fontSize:43})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon)),this.addChild(l),this.UserSpriteRightWin.addBtnLoseGemAndExp()}else{var l;ce.instance().playSound(ce.loseturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Thua cuộc !!!",{font:"GilroyBold",fill:"white",fontSize:43})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon+1," - ").concat(this.weeklyResult.userWon)),this.addChild(l),this.UserSpriteRightWin.addBtnLoseGemAndExp()}s.anchor.set(.5),this.addChild(s),this.addChild(a);var h=new Phaser.Group(game,0,0);h.y=1200,this.addChild(h);var c=new Phaser.Rectangle(35,0,615*window.GameConfig.RESIZE,(game.height-685)*window.GameConfig.RESIZE);this.listView=new Vo(game,h,c,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addTweenBoxResult(a,h);for(var u=0;u<5;u++){var d=new yf(this.questions[u].songEntity,this.result.answers[u],this.opponentAnswerLogs[u],u);d.event.playSound.add(this.playSongResult,this),this.listView.add(d)}var f=new rt(this.positionWinConfig.shadow);f.y=game.height-z.instance().STANDARD_HEIGHT+this.positionWinConfig.shadow.y,this.addChild(f);var p=new Phaser.Button(game,378*window.GameConfig.RESIZE,(game.height-86)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"btn_next_game");p.anchor.set(.5),this.addChild(p);var g=new Phaser.Text(game,0,0,this.positionWinConfig.txt_challenge_your_turn.text,this.positionWinConfig.txt_challenge_your_turn.configs);g.anchor.set(.5),p.addChild(g),p.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),e.event.challengeAgain.dispatch()},this);var y=new Phaser.Button(game,this.positionWinConfig.share.x*window.GameConfig.RESIZE,this.positionWinConfig.share.y*window.GameConfig.RESIZE,this.positionWinConfig.share.nameAtlas,function(){},this,null,this.positionWinConfig.share.nameSprite);y.anchor.set(.5),y.events.onInputUp.add(this.shareResult,this),this.addChild(y);var m=new Phaser.Button(game,80*window.GameConfig.RESIZE,(game.height-86)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Button_home");m.anchor.set(.5),m.events.onInputUp.add(this.backHome,this),this.addChild(m),this.addMessageOpp(),this.addBtnLastWeekResult()}},{key:"addBtnLastWeekResult",value:function(){this.btnLastWeekResult=new Phaser.Button(game,this.positionWinConfig.last_week.x*window.GameConfig.RESIZE,this.positionWinConfig.last_week.y*window.GameConfig.RESIZE,this.positionWinConfig.last_week.nameAtlas,function(){},this,null,this.positionWinConfig.last_week.nameSprite),this.btnLastWeekResult.anchor.set(.5),this.btnLastWeekResult.events.onInputUp.add(this.chooseLastWeek,this);var e=new Phaser.Text(game,this.positionWinConfig.last_week.txt.x,this.positionWinConfig.last_week.txt.y,this.positionWinConfig.last_week.txt.text,this.positionWinConfig.last_week.txt.configs);e.anchor.set(.5),this.btnLastWeekResult.addChild(e),this.addChild(this.btnLastWeekResult)}},{key:"chooseLastWeek",value:function(){ce.instance().playSound(ce.buttonclick),this.isLastWeek=!0,IE.instance().addLastWeekResultScreen(this.opponent)}},{key:"addMessageOpp",value:function(){if(void 0!==this.dataTurnbase.challenge_msg&&""!==this.dataTurnbase.challenge_msg&&null!==this.dataTurnbase.challenge_msg){var e=new Phaser.Sprite(game,75,298,"playSprites","Box_Chat_02");this.addChild(e),this.msgChallenge=new Phaser.Text(game,25,25,this.dataTurnbase.challenge_msg,{font:"Gilroy",fill:"#333333",fontSize:18,wordWrap:!0,wordWrapWidth:130,align:"center"});var t=20*window.GameConfig.RESIZE,n={x:35,y:310,nameAtlas:"mailSprites",nameSprite:"Box_Chat_01",left:25,right:25,top:25,bot:25,width:0,height:0,name:"challengeMsg"};n.width=(this.msgChallenge.width+t)/window.GameConfig.RESIZE,n.height=(this.msgChallenge.height+t)/window.GameConfig.RESIZE,this.bg=new Zt(n),this.bg.addChild(this.msgChallenge),this.addChild(this.bg),this.msgChallenge.x=t/2,this.msgChallenge.y=t/2}}},{key:"playSongResult",value:function(e){El.instance().pauseSound();for(var t=0;t<this.listView.grp.children.length;t++){var n=this.listView.grp.children[t];n.index!==e?n.stopSound():n.playSound()}}},{key:"shareResult",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"onShared",value:function(e){e.hasOwnProperty("error_code")||this.sendShareResult()}},{key:"sendShareResult",value:function(){TF.instance().sendData(Et.FB_USER_SHARED_RESULT_REQUEST,null)}},{key:"onExtensionResponse",value:function(e){}},{key:"addTweenBoxResult",value:function(e,t){game.add.tween(e).to({y:551*window.GameConfig.RESIZE},500,"Linear",!1).start(),game.add.tween(t).to({y:551*window.GameConfig.RESIZE},500,"Linear",!1).start()}},{key:"backHome",value:function(){ce.instance().playSound(ce.buttonclick),0==this.isLastWeek&&this.event.reHome.dispatch()}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.backHome,this),ui.instance().event.share.add(this.onShared,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.backHome,this),ui.instance().event.share.remove(this.onShared,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Nf(n.prototype,i),o&&Nf(n,o),t}();function Zf(e){return(Zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qf(e,t){return!t||"object"!==Zf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vf(e){return(Vf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wf(e,t){return(Wf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qf=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Qf(this,Vf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),n.type=e,n.screenChallenge=null,n.screenBeChallenged=null,n.challenge_msg="",n.event={screenReHome:new Phaser.Signal,screenBeChallengedChallengAgain:new Phaser.Signal,screenChallengeNextGame:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){}},{key:"addScreen",value:function(){"CHALLENGE"==this.type?this.addScreenChallenge():this.addScreenBeChallenged(),li.instance().playTurnBase(),li.instance().showInterstitialTurnBase()}},{key:"addScreenChallenge",value:function(){this.removeScreenChallenge(),this.screenChallenge=new Sf,this.screenChallenge.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.result,this.challenge_msg,this.play_log_id,this.request_id),this.screenChallenge.afterInit(),this.screenChallenge.event.reHome.add(this.screenReHome,this),this.screenChallenge.event.nextGame.add(this.screenChallengeNextGame,this),this.addChild(this.screenChallenge)}},{key:"removeScreenChallenge",value:function(){null!==this.screenChallenge&&(this.removeChild(this.screenChallenge),this.screenChallenge.destroy(),this.screenChallenge=null)}},{key:"screenReHome",value:function(){this.event.screenReHome.dispatch()}},{key:"screenChallengeNextGame",value:function(e){this.event.screenChallengeNextGame.dispatch(e)}},{key:"addScreenBeChallenged",value:function(){this.removeScreenBeChallenged(),this.screenBeChallenged=new Ff,this.screenBeChallenged.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.result,this.opponentAnswerLogs,this.weeklyResult,this.play_log_id,this.request_id,this.dataTurnbase),this.screenBeChallenged.afterInit(),this.screenBeChallenged.event.challengeAgain.add(this.challengeAgain,this),this.screenBeChallenged.event.reHome.add(this.screenReHome,this),this.addChild(this.screenBeChallenged)}},{key:"removeScreenBeChallenged",value:function(){null!==this.screenBeChallenged&&(this.removeChild(this.screenBeChallenged),this.screenBeChallenged.destroy(),this.screenBeChallenged=null)}},{key:"challengeAgain",value:function(){this.event.screenBeChallengedChallengAgain.dispatch()}},{key:"setData",value:function(e,t,n,i,o,a,s){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.result=a,this.challenge_msg=s}},{key:"setDataBeChallenged",value:function(e,t,n,i,o,a){"BECHALLENGED"==this.type&&(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.opponentAnswerLogs=i,this.weeklyResult=o,this.dataTurnbase=a)}},{key:"setDataChallenge",value:function(e,t){"CHALLENGE"==this.type&&(this.play_log_id=e,this.request_id=t)}}])&&Hf(n.prototype,i),o&&Hf(n,o),t}();function Kf(e){return(Kf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zf(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yf(e,t){return!t||"object"!==Kf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jf(e){return(Jf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xf(e,t){return(Xf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $f=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Yf(this,Jf(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.event={resultGame:new Phaser.Signal},e.checkUseSpt=!1,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xf(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addScreenLoadTurnBase()}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"addScreenLoadTurnBase",value:function(){this.score=0,this.scoreOpp=0,this.countQuiz=0,this.correctList=[],this.wrongList=[],this.streak=1,this.answers=[],this.result,this.timeNextQuestion=null,this.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new rt(this.positionPlayConfig.line_top);this.addChild(e),this.loadScreenPlayChallenged(this.scoreOpp),this.addNamePlaylistAndTextLoading(),this.addActionPhase()}},{key:"addNamePlaylistAndTextLoading",value:function(){this.namePlaylist=new Phaser.Text(game,this.positionPlayConfig.namePlaylist.x*window.GameConfig.RESIZE,(this.positionPlayConfig.namePlaylist.y+80)*window.GameConfig.RESIZE,this.playlist.name,this.positionPlayConfig.namePlaylist.configs),this.namePlaylist.anchor.set(.5),this.addChild(this.namePlaylist),game.add.tween(this.namePlaylist).to({y:this.positionPlayConfig.namePlaylist.y*window.GameConfig.RESIZE},300,Phaser.Easing.Linear.Out,!1).start(),this.loadingAnim=new Fe,this.addChild(this.loadingAnim)}},{key:"addActionPhase",value:function(){this.actionPhase=new Ld,this.actionPhase.position.x=(this.game.width-this.actionPhase.width)/2,this.addChild(this.actionPhase)}},{key:"loadScreenPlayChallenged",value:function(e){var t=new Phaser.Sprite(game,this.positionPlayConfig.versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.versus.nameAtlas,this.positionPlayConfig.versus.nameSprite);t.anchor.set(.5);var n=new Phaser.Text(game,this.positionPlayConfig.txt_versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.text,this.positionPlayConfig.txt_versus.configs);n.anchor.set(.5),t.addChild(n),t.scale.set(.1),this.addChild(t),game.add.tween(t.scale).to({x:1,y:1},400,"Linear").start(),this.UserSpriteRight=new ld,this.UserSpriteRight.setAva("ava_fb"),this.UserSpriteRight.setPosition(),this.UserSpriteRight.setNameAndScore("You",this.score),this.UserSpriteRight.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRight.addDotOnline(),this.addChild(this.UserSpriteRight),this.UserSpriteRight.makeTweenAvaLoading(),this.trueOrFalseUser=new Pd,this.trueOrFalseUser.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseUser.x=320*window.GameConfig.RESIZE,this.trueOrFalseUser.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseUser),this.UserSpriteLeft=new pd(this.opponent),this.UserSpriteLeft.setAva(this.opponent.avatar),this.UserSpriteLeft.setPosition(),this.UserSpriteLeft.setNameAndScore(this.opponent.userName,e),this.UserSpriteLeft.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeft.addDotOnline(),this.addChild(this.UserSpriteLeft),this.trueOrFalseOpp=new Pd,this.trueOrFalseOpp.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseOpp.x=-10*window.GameConfig.RESIZE,this.trueOrFalseOpp.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseOpp),this.UserSpriteLeft.makeTweenAvaLoading(),this.loadAfter()}},{key:"loadAfter",value:function(){for(var e=[],t=0;t<5;t++)e.push(this.questions[t].songEntity.fileUrl);El.instance().loadSoundArray(e),LogConsole.log("arrSongs:------- "),El.instance().event.loadComplete.add(this.loadComplete,this)}},{key:"setData",value:function(e,t,n,i,o,a){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.opponentAnswerLogs=a}},{key:"setDataBeChallenged",value:function(e,t,n){this.play_log_id=e,this.request_id=t,this.isHasHistory=n}},{key:"loadComplete",value:function(){LogConsole.log("load complete"),this.loadingAnim.destroy(),this.makeTweenToPlay()}},{key:"loadStart",value:function(){}},{key:"makeTweenToPlay",value:function(){0==this.countQuiz&&(this.UserSpriteLeft.makeTweenAva(),this.UserSpriteRight.makeTweenAva()),this.addBtnRemoveAnswer(),this.createGamePlayChallenged()}},{key:"createGamePlayChallenged",value:function(){this.timeCounter=game.time.create(),0==this.countQuiz?this.createLoadingScreenAfterStart():this.displayAnswering()}},{key:"addCircleNormal",value:function(){for(var e=this,t=function(t){0==e.countQuiz&&setTimeout(function(){var n=new Phaser.Sprite(game,(e.positionPlayConfig.circleNormal.x+62*t)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y+50)*window.GameConfig.RESIZE,e.positionPlayConfig.circleNormal.nameAtlas,e.positionPlayConfig.circleNormal.nameSprite);n.anchor.set(.5),game.add.tween(n).to({y:(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start(),e.addChild(n)},50*t)},n=0;n<5;n++)t(n)}},{key:"addCorrectListSprites",value:function(){for(var e=0;e<this.correctList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.correctList[e].countQuiz)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Text(game,0,3*window.GameConfig.RESIZE,this.correctList[e].time.toFixed(1),{font:"GilroyBold",fontSize:15});n.anchor.set(.5),t.addChild(n)}}},{key:"addWrongListSprites",value:function(){for(var e=0;e<this.wrongList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.wrongList[e])*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,this.positionPlayConfig.wrongMini.nameAtlas,this.positionPlayConfig.wrongMini.nameSprite);n.anchor.set(.5),t.addChild(n)}}},{key:"createLoadingScreenAfterStart",value:function(){var e=this,t=game.add.audio("beep_audio"),n=new Phaser.Text(game,this.positionPlayConfig.countdownNumber.x*window.GameConfig.RESIZE,(this.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,"3",this.positionPlayConfig.countdownNumber.configs);n.anchor.set(.5),this.addChild(n);var i=game.add.tween(n).to({y:this.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("2");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("1");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){Le.instance().logEvent(Le.pro_quiz_start_turnbase),n.setText("Bắt đầu"),n.scale.set(.5),n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE;var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),i.onComplete.add(function(){n.destroy(),t.destroy(),e.addCircleNormal(),e.displayAnswering()})})})})}},{key:"displayAnswering",value:function(){var e=this;this.namePlaylist.destroy(),this.btn_remove_answer.revive(),console.log("LINK PLAY"+this.questions[this.countQuiz].songEntity.fileUrl),El.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.timeTweenBegin=game.time.events.add(.5*Phaser.Timer.SECOND,function(){if(e.spriteTime=new Phaser.Sprite(game,0,(game.height-746)*window.GameConfig.RESIZE,"otherSprites","tween-time"),e.spriteTime.anchor.set(0,.5),e.addChild(e.spriteTime),e.tweenSpriteTime=game.add.tween(e.spriteTime.scale).to({x:70,y:1},1e4,"Linear"),e.createFourAnswer(),e.timeTweenStart=game.time.events.add(.2*Phaser.Timer.SECOND,function(){e.tweenSpriteTime.start(),e.timeCounter.start()},e),e.btn_remove_answer.inputEnabled=!0,e.btn_remove_answer.alpha=1,e.tweenSpriteTime.onComplete.add(function(){}),0==e.countQuiz){var t=new en;t.addHelperStep4(),t.changeBg(),e.addChild(t),z.instance().playScript.playing_guide==en.DONE_GET_QUEST?e.timePS4=game.time.events.add(1.4*Phaser.Timer.SECOND,function(){t.addStep4UseSupportItem(),t.event.step4.add(e.stepRemoveAnswer,e)}):t.destroy()}if(1==e.countQuiz){var n=new en;e.addChild(n),z.instance().playScript.playing_guide==en.DONE_GET_QUEST?(n.addStep9GoodLuck(),z.instance().playScript.playing_guide=en.DONE_ALL):n.destroy()}})}},{key:"stepRemoveAnswer",value:function(){this.tweenSpriteTime.resume(),this.timeCounter.resume(),El.instance().resumeSound(),TF.instance().sendData(Et.PLAY_SCRIPT_DONE_ALL_REQUEST,null),this.sendRemoveAnswer()}},{key:"activeAnswer",value:function(){this.answerA.activeInput(),this.answerB.activeInput(),this.answerC.activeInput(),this.answerD.activeInput()}},{key:"addBtnRemoveAnswer",value:function(){this.btn_remove_answer=new Phaser.Button(game,this.positionPlayConfig.btn_remove_answer.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.btn_remove_answer.y)*window.GameConfig.RESIZE,this.positionPlayConfig.btn_remove_answer.nameAtlas,function(){},this,null,this.positionPlayConfig.btn_remove_answer.nameSprite),this.btn_remove_answer.anchor.set(.5),this.btn_remove_answer.kill();var e=new Phaser.Text(game,this.positionPlayConfig.txt_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.text,this.positionPlayConfig.txt_remove_answer.configs);e.anchor.set(.5);var t=new _t(this.positionPlayConfig.txt_dis_one,this.positionPlayConfig.txt_dis_one.text);t.anchor.set(.5),this.btn_remove_answer.addChild(t);var n=new Phaser.Sprite(game,this.positionPlayConfig.diamond_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.nameAtlas,this.positionPlayConfig.diamond_remove_answer.nameSprite);n.anchor.set(1,.5);var i=new rt(this.positionPlayConfig.mic_so_luong);i.anchor.set(.5),this.countMic=TF.instance().socket.mySelf.getVariable("support_item").value,this.numberOfSptItem=new _t(this.positionPlayConfig.number_mic_so_luong,TF.instance().socket.mySelf.getVariable("support_item").value),this.numberOfSptItem.anchor.set(.5),i.addChild(this.numberOfSptItem),this.btn_remove_answer.addChild(i),this.btn_remove_answer.addChild(n),this.btn_remove_answer.addChild(e),this.btn_remove_answer.inputEnabled=!1,this.btn_remove_answer.events.onInputUp.add(this.sendRemoveAnswer,this),this.addChild(this.btn_remove_answer)}},{key:"removeAnswer",value:function(){this.countMic--,this.numberOfSptItem.setText(this.countMic),this.btn_remove_answer.inputEnabled=!1,this.btn_remove_answer.alpha=.5,Bn.getTwoOfFourAnswer(this.answerA,this.answerB,this.answerC,this.answerD,this.questions[this.countQuiz])}},{key:"sendRemoveAnswer",value:function(){this.btn_remove_answer.inputEnabled=!1,0==this.checkUseSpt&&(this.checkUseSpt=!0,TF.instance().dataMySeft.support_item>0?(TF.instance().sendData(Et.SUPPORT_REQUEST,null),this.removeAnswer()):IE.instance().addDialog("Bạn không đủ Míc")),ce.instance().playSound(ce.buttonclick)}},{key:"createFourAnswer",value:function(){for(var e=0;e<4;e++)0==e&&(this.answerA=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerA.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerA.sprite),this.addChild(this.answerA)),1==e&&(this.answerB=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerB.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerB.sprite),this.addChild(this.answerB)),2==e&&(this.answerC=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerC.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerC.sprite),this.addChild(this.answerC)),3==e&&(this.answerD=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerD.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerD.sprite),this.addChild(this.answerD))}},{key:"updateOnClickAnswer",value:function(e){if(this.answerA.sprite.inputEnabled=!1,this.answerB.sprite.inputEnabled=!1,this.answerC.sprite.inputEnabled=!1,this.answerD.sprite.inputEnabled=!1,this.answered=e,this.calculateScoreOpp(),e+1==this.questions[this.countQuiz].correctAnswer){if(this.setActionPhaseOnCorrect(),this.setTrueAva(),this.answeredResult=!0,this.timeCounter.ms/1e3>10)this.score+=Math.floor(100*Math.pow(1,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:10});else{var t=parseFloat((this.timeCounter.ms/1e3).toFixed(1));this.score+=Math.floor(100*(11-t)*Math.pow(11-t,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:t})}this.setScore(this.score),Ur.instance().playlist.setExpPlaylistById(this.playlist.id)}else this.setFalseAva(),this.answeredResult=!1,this.wrongList.push(this.countQuiz);for(var n=0;n<4;n++)0==n&&this.setTrueFalseTabAnswer(this.answerA,n),1==n&&this.setTrueFalseTabAnswer(this.answerB,n),2==n&&this.setTrueFalseTabAnswer(this.answerC,n),3==n&&this.setTrueFalseTabAnswer(this.answerD,n);this.pushResultAnswer(),this.addCorrectListSprites(),this.addWrongListSprites(),this.timeNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.resetQuestion,this)}},{key:"setActionPhaseOnCorrect",value:function(){this.questions[this.countQuiz].correctAnswer>2?this.actionPhase.position.y=game.height-636:this.actionPhase.position.y=game.height-416,this.actionPhase.setStreak(this.streak),this.addChild(this.actionPhase)}},{key:"addAvaMiniInTheLeftOfTab",value:function(e){var t,n=game.add.graphics(0,0);(n.beginFill(16777215),n.drawCircle(-246*window.GameConfig.RESIZE,0,40*window.GameConfig.RESIZE),n.anchor.set(.5),window.MQ.isBotMode)?((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,"bot-mini".concat(window.MQ.botKey))).anchor.set(.5),t.mask=n):""!==this.opponent.avatar?((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,this.opponent.avatar)).anchor.set(.5),t.scale.set(window.GameConfig.SCALE_AVA_OPPO_INTHELEFT*window.GameConfig.RESIZE),t.mask=n):((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,"songDetailSprites","ava-default")).anchor.set(.5),t.scale.set(window.GameConfig.SCALE_AVA_OPPO_INTHELEFT*window.GameConfig.RESIZE),t.mask=n);t.kill(),e.addChild(n),e.addChild(t),this.timeAvaMiniShow=game.time.create(!0),this.timeAvaMiniShow.add(Phaser.Timer.SECOND*(this.opponentAnswerLogs[this.countQuiz].answer_time+.4),function(){t.revive()}),this.timeAvaMiniShow.start()}},{key:"calculateScoreOpp",value:function(){if(this.countQuiz<=4)if("CORRECT"==this.opponentAnswerLogs[this.countQuiz].result.toUpperCase()){this.setTrueAvaOpp();var e=Math.floor(100*(11-this.opponentAnswerLogs[this.countQuiz].answer_time)*Math.pow(11-this.opponentAnswerLogs[this.countQuiz].answer_time,(this.opponentAnswerLogs[this.countQuiz].streak-1)/4));this.scoreOpp+=e,this.setScoreOpp(this.scoreOpp)}else this.setFalseAvaOpp()}},{key:"pushResultAnswer",value:function(){var e="INCORRECT";if(1==this.answeredResult&&(e="CORRECT"),this.timeCounter.ms/1e3>10)this.answers.push({answer_time:10,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0});else{var t=(this.timeCounter.ms/1e3).toFixed(1);this.answers.push({answer_time:parseFloat(t),result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0})}}},{key:"removeTimeNextQuestion",value:function(){null!==this.timeNextQuestion&&game.time.events.remove(this.timeNextQuestion)}},{key:"resetQuestion",value:function(){this.removeTimeNextQuestion(),this.tweenSpriteTime.stop(),this.spriteTime.destroy(),this.timeCounter.stop(),this.actionPhase.setDefault(),this.timeCounter.destroy(),this.checkUseSpt=!1,this.answerA.destroy(),this.answerB.destroy(),this.answerC.destroy(),this.answerD.destroy(),this.btn_remove_answer.revive(),1==this.answeredResult?this.streak++:this.streak=1,this.countQuiz<4?(this.countQuiz+=1,this.createGamePlayChallenged()):(El.instance().removeSound(),this.result={answers:this.answers,score:this.score,scoreOpp:this.scoreOpp,game_log_id:this.play_log_id,challenge_request_id:this.request_id,opponentAnswerLogs:this.opponentAnswerLogs,playlist_id:this.playlist.id},this.event.resultGame.dispatch(this.result))}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SUPPORT_RESPONSE&&e.params.getUtfString("status")}},{key:"setTrueFalseTabAnswer",value:function(e,t){t==this.answered?t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerWrong():t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerNotChoosed()}},{key:"setTrueAva",value:function(){this.trueOrFalseUser.setTrueAnswer()}},{key:"setFalseAva",value:function(){this.trueOrFalseUser.setFailtAnswer()}},{key:"setTrueAvaOpp",value:function(){this.trueOrFalseOpp.setTrueAnswer()}},{key:"setFalseAvaOpp",value:function(){this.trueOrFalseOpp.setFailtAnswer()}},{key:"setScore",value:function(e){this.UserSpriteRight.setScore(e)}},{key:"setScoreOpp",value:function(e){this.UserSpriteLeft.setScore(e)}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timeTweenBegin),game.time.events.remove(this.timeTweenStart),game.time.events.remove(this.timePS4),game.time.events.remove(this.timeNextQuestion),El.instance().event.loadComplete.remove(this.loadComplete,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&zf(n.prototype,i),o&&zf(n,o),t}();function ep(e){return(ep="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function np(e,t){return!t||"object"!==ep(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ip(e){return(ip=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function op(e,t){return(op=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ap=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=np(this,ip(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),e.addChild(e.bg),e.event={playYourTurn:new Phaser.Signal,challenge:new Phaser.Signal,reHome:new Phaser.Signal},e.type=null,e.isLastWeek=!1,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&op(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setType",value:function(e){this.type=e}},{key:"afterInit",value:function(){this.addEventExtension(),this.loadDisplayBeChallenged(function(){qe.instance().hideLoading()})}},{key:"setData",value:function(e,t,n,i,o,a,s,r,l){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.result=a,this.opponentAnswerLogs=s,this.weeklyResult=r,this.historyGameLog=l}},{key:"loadDisplayBeChallenged",value:function(e){this.UserSpriteRightWin=new xf,this.UserSpriteRightWin.setAva("ava_fb"),this.UserSpriteRightWin.setNameAndScore("You",this.result.score),this.UserSpriteRightWin.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRightWin.makeDefaultScreenNotTween(),this.UserSpriteRightWin.addDotOnline(),this.addChild(this.UserSpriteRightWin),this.UserSpriteLeftWin=new Df(this.opponent),this.UserSpriteLeftWin.setAva(this.opponent.avatar),this.UserSpriteLeftWin.setNameAndScore(this.opponent.userName,this.result.scoreOpp),this.UserSpriteLeftWin.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeftWin.makeDefaultScreenNotTween(),this.UserSpriteLeftWin.addDotOnline(),this.addChild(this.UserSpriteLeftWin),this.createBoxScoreFriendChallen(),e()}},{key:"createBoxScoreFriendChallen",value:function(){var e=this,t=new Phaser.Text(game,game.width/2,485*window.GameConfig.RESIZE,"Kết quả trong tuần",{font:"Gilroy",fill:"#9d92a6",fontSize:19});t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,"playSprites","Header"),i=new Phaser.Text(game,game.width/2,35*window.GameConfig.RESIZE,this.playlist.name,{font:"Gilroy",fill:"white",fontSize:23});i.anchor.set(.5),n.addChild(i),this.addChild(n);var o=new Phaser.Graphics(game,0,551*window.GameConfig.RESIZE);o.beginFill(),o.drawRect(0,0,game.width,(game.height-676)*window.GameConfig.RESIZE),o.endFill(),this.addChild(o);var a=new Phaser.Button(game,game.width/2,1200*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Box_ketqua_old");a.anchor.set(.5,0),a.mask=o;var s=new Phaser.Text(game,game.width/2,520*window.GameConfig.RESIZE,"Score",{font:"GilroyBold",fill:"white",fontSize:30});if(this.result.score>this.result.scoreOpp){ce.instance().playSound(ce.winturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Chiến thắng !!!",{font:"GilroyBold",fill:"white",fontSize:40})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon));var r=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,140*window.GameConfig.RESIZE,"firework");r.anchor.set(.5),this.addChild(r);r.animations.add("run_win");r.animations.play("run_win",30,!0),this.addChild(l),this.UserSpriteRightWin.addBtnWinGemAndExp()}else if(this.result.score==this.result.scoreOpp){ce.instance().playSound(ce.loseturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Điểm số hòa !!!",{font:"GilroyBold",fill:"white",fontSize:40})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon)),this.addChild(l),this.UserSpriteRightWin.addBtnLoseGemAndExp()}else{var l;ce.instance().playSound(ce.loseturnbase),(l=new Phaser.Text(game,game.width/2,145*window.GameConfig.RESIZE,"Thua cuộc !!!",{font:"GilroyBold",fill:"white",fontSize:40})).anchor.set(.5),null==this.weeklyResult?s.setText("0 - 0"):s.setText("".concat(this.weeklyResult.opponentWon," - ").concat(this.weeklyResult.userWon)),this.addChild(l),this.UserSpriteRightWin.addBtnLoseGemAndExp()}s.anchor.set(.5),this.addChild(s),this.addChild(a);var h=new Phaser.Group(game,0,0);h.y=1200,this.addChild(h);var c=new Phaser.Rectangle(35,0,615*window.GameConfig.RESIZE,(game.height-685)*window.GameConfig.RESIZE);this.listView=new Vo(game,h,c,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.addTweenBoxResult(a,h);for(var u=0;u<5;u++){var d=new yf(this.questions[u].songEntity,this.result.answers[u],this.opponentAnswerLogs[u],u);d.event.playSound.add(this.playSongResult,this),this.listView.add(d)}var f=new rt(this.positionWinConfig.shadow);f.y=game.height-z.instance().STANDARD_HEIGHT+this.positionWinConfig.shadow.y,this.addChild(f);var p=new Phaser.Button(game,378*window.GameConfig.RESIZE,(game.height-86)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"btn_next_game");p.anchor.set(.5),this.addChild(p);var g=new Phaser.Text(game,0,0,this.positionWinConfig.txt_play_your_turn.text,this.positionWinConfig.txt_play_your_turn.configs);"CHALLENGE"==this.type&&g.setText("THÁCH ĐẤU LẠI"),g.anchor.set(.5),p.addChild(g),p.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),"CHALLENGE"==e.type?e.event.challenge.dispatch():e.event.playYourTurn.dispatch()},this);var y=new Phaser.Button(game,this.positionWinConfig.share.x*window.GameConfig.RESIZE,this.positionWinConfig.share.y*window.GameConfig.RESIZE,this.positionWinConfig.share.nameAtlas,function(){},this,null,this.positionWinConfig.share.nameSprite);y.anchor.set(.5),y.events.onInputUp.add(this.shareResult,this),this.addChild(y);var m=new Phaser.Button(game,80*window.GameConfig.RESIZE,(game.height-86)*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,"Button_home");m.anchor.set(.5),m.events.onInputUp.add(this.backHome,this),this.addChild(m),this.addBtnLastWeekResult()}},{key:"addBtnLastWeekResult",value:function(){this.btnLastWeekResult=new Phaser.Button(game,this.positionWinConfig.last_week.x*window.GameConfig.RESIZE,this.positionWinConfig.last_week.y*window.GameConfig.RESIZE,this.positionWinConfig.last_week.nameAtlas,function(){},this,null,this.positionWinConfig.last_week.nameSprite),this.btnLastWeekResult.anchor.set(.5),this.btnLastWeekResult.events.onInputUp.add(this.chooseLastWeek,this);var e=new Phaser.Text(game,this.positionWinConfig.last_week.txt.x,this.positionWinConfig.last_week.txt.y,this.positionWinConfig.last_week.txt.text,this.positionWinConfig.last_week.txt.configs);e.anchor.set(.5),this.btnLastWeekResult.addChild(e),this.addChild(this.btnLastWeekResult)}},{key:"chooseLastWeek",value:function(){this.isLastWeek=!0,IE.instance().addLastWeekResultScreen(this.opponent)}},{key:"backHome",value:function(){ce.instance().playSound(ce.buttonclick),0==this.isLastWeek&&this.event.reHome.dispatch()}},{key:"playSongResult",value:function(e){El.instance().pauseSound();for(var t=0;t<this.listView.grp.children.length;t++){var n=this.listView.grp.children[t];n.index!==e?n.stopSound():n.playSound()}}},{key:"shareResult",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"backLastWeek",value:function(){this.isLastWeek=!1}},{key:"onShared",value:function(e){e.hasOwnProperty("error_code")||this.sendShareResult()}},{key:"sendShareResult",value:function(){TF.instance().sendData(DataCommand.FB_USER_SHARED_RESULT_REQUEST,null)}},{key:"onExtensionResponse",value:function(e){}},{key:"addTweenBoxResult",value:function(e,t){game.add.tween(e).to({y:551*window.GameConfig.RESIZE},500,"Linear",!1).start(),game.add.tween(t).to({y:551*window.GameConfig.RESIZE},500,"Linear",!1).start()}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.backHome,this),De.instance().event.backLastWeek.add(this.backLastWeek,this),ui.instance().event.share.add(this.onShared,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.backHome,this),De.instance().event.backLastWeek.remove(this.backLastWeek,this),ui.instance().event.share.remove(this.onShared,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&tp(n.prototype,i),o&&tp(n,o),t}();function sp(e){return(sp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lp(e,t){return!t||"object"!==sp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hp(e){return(hp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cp(e,t){return(cp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var up=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=lp(this,hp(t).call(this,game,0,0,"screen-dim"))).input.useHandCursor=!1,e.signalInput=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cp(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.avaOpp,this.nameOpp,this.avaUrl}},{key:"setAvaUrl",value:function(e){this.avaUrl=e}},{key:"setTxtNameOpp",value:function(e){this.txtNameOpp=e}},{key:"addPopup",value:function(){this.removePopupConfirm(),this.popup=new sh,this.popup.x=35*window.GameConfig.RESIZE,this.popup.y=372*window.GameConfig.RESIZE,this.popup.setTextCancle("ĐỂ SAU"),this.popup.setContent("".concat(this.txtNameOpp," đã thách đấu bạn trước!")),this.popup.txtContent.addColor("#ffab4f",0),this.popup.txtContent.addColor("#000000",this.txtNameOpp.length),this.popup.event.OK.add(this.onOK,this),this.popup.event.CANCLE.add(this.onCancle,this),this.addChild(this.popup),this.addAvaAndNameOpp()}},{key:"onOK",value:function(){LogConsole.log("onOK"),this.popup.destroy(),this.popup=null,this.signalInput.dispatch("OK"),this.destroy()}},{key:"onCancle",value:function(){LogConsole.log("ononCancle"),this.popup.destroy(),this.popup=null,this.signalInput.dispatch("CANCLE"),this.destroy()}},{key:"removePopupConfirm",value:function(){null!==this.popup&&void 0!==this.popup&&(this.popup.destroy(),this.popup=null)}},{key:"addAvaAndNameOpp",value:function(){this.avaOpp=new wa(0),this.avaOpp.x=284*window.GameConfig.RESIZE,this.avaOpp.beginLoad(this.avaUrl),this.avaOpp.anchor.set(.5),this.avaOpp.addMaskAva(200),this.avaOpp.setScale(.825*window.GameConfig.RESIZE),this.popup.addChild(this.avaOpp)}}])&&rp(n.prototype,i),o&&rp(n,o),t}();function dp(e){return(dp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pp(e,t){return!t||"object"!==dp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gp(e){return(gp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yp(e,t){return(yp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mp=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=pp(this,gp(t).call(this,game))).positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.event={playIllegalTurn:new Phaser.Signal,illegalTurnCancle:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"makeNewGameBeChallenged",value:function(e,t){this.game_log_id=e.game_log_id,this.request_id=e.request_id,t()}},{key:"setData",value:function(e){this.opponent=e}},{key:"addPopupIllegalTurn",value:function(){this.popup=new up,this.popup.setAvaUrl(this.opponent.avatar),this.popup.setTxtNameOpp(this.opponent.userName),this.popup.addPopup(),this.popup.signalInput.add(this.onPopupCallback,this),this.addChild(this.popup)}},{key:"onPopupCallback",value:function(e){"OK"==e?this.event.playIllegalTurn.dispatch({game_log_id:this.game_log_id,request_id:this.request_id}):this.event.illegalTurnCancle.dispatch()}}])&&fp(n.prototype,i),o&&fp(n,o),t}();function vp(e){return(vp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bp(e,t){return!t||"object"!==vp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _p(e){return(_p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sp(e,t){return(Sp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ep=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=bp(this,_p(t).call(this,game))).positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.positionPlayConfig=JSON.parse(game.cache.getText("positionPlayConfig")),e.event={resultGame:new Phaser.Signal,doneTutorial:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addScreenLoadTurnBase()}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"addScreenLoadTurnBase",value:function(){this.score=0,this.scoreOpp=0,this.countQuiz=0,this.correctList=[],this.wrongList=[],this.streak=1,this.answers=[],this.result,this.timeNextQuestion=null,this.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new rt(this.positionPlayConfig.line_top);this.addChild(e),this.loadScreenPlayChallenged(this.scoreOpp),this.addNamePlaylistAndTextLoading(),this.addActionPhase()}},{key:"addNamePlaylistAndTextLoading",value:function(){this.namePlaylist=new Phaser.Text(game,this.positionPlayConfig.namePlaylist.x*window.GameConfig.RESIZE,(this.positionPlayConfig.namePlaylist.y+80)*window.GameConfig.RESIZE,this.playlist.name,this.positionPlayConfig.namePlaylist.configs),this.namePlaylist.anchor.set(.5),this.addChild(this.namePlaylist),game.add.tween(this.namePlaylist).to({y:this.positionPlayConfig.namePlaylist.y*window.GameConfig.RESIZE},300,Phaser.Easing.Linear.Out,!1).start(),this.loadingAnim=new Fe,this.addChild(this.loadingAnim)}},{key:"addActionPhase",value:function(){this.actionPhase=new Ld,this.actionPhase.position.x=(this.game.width-this.actionPhase.width)/2,this.addChild(this.actionPhase)}},{key:"loadScreenPlayChallenged",value:function(e){var t=new Phaser.Sprite(game,this.positionPlayConfig.versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.versus.nameAtlas,this.positionPlayConfig.versus.nameSprite);t.anchor.set(.5);var n=new Phaser.Text(game,this.positionPlayConfig.txt_versus.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_versus.text,this.positionPlayConfig.txt_versus.configs);n.anchor.set(.5),t.addChild(n),t.scale.set(.1),this.addChild(t),game.add.tween(t.scale).to({x:1,y:1},400,"Linear").start(),this.UserSpriteRight=new ld,this.UserSpriteRight.setAva("ava_fb"),this.UserSpriteRight.setPosition(),this.UserSpriteRight.setNameAndScore("You",this.score),this.UserSpriteRight.setLevelPlaylist(this.user_playlist_mapping),this.UserSpriteRight.addDotOnline(),this.addChild(this.UserSpriteRight),this.UserSpriteRight.makeTweenAvaLoading(),this.trueOrFalseUser=new Pd,this.trueOrFalseUser.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseUser.x=320*window.GameConfig.RESIZE,this.trueOrFalseUser.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseUser),this.UserSpriteLeft=new pd(this.opponent),this.UserSpriteLeft.setAva(this.opponent.avatar),this.UserSpriteLeft.setPosition(),this.UserSpriteLeft.setNameAndScore(this.opponent.userName,e),this.UserSpriteLeft.setLevelPlaylist(this.opponent_playlist_mapping),this.UserSpriteLeft.addDotOnline(),this.addChild(this.UserSpriteLeft),this.trueOrFalseOpp=new Pd,this.trueOrFalseOpp.setSize(330*window.GameConfig.RESIZE,330*window.GameConfig.RESIZE),this.trueOrFalseOpp.x=-10*window.GameConfig.RESIZE,this.trueOrFalseOpp.y=-25*window.GameConfig.RESIZE,this.addChild(this.trueOrFalseOpp),this.UserSpriteLeft.makeTweenAvaLoading(),this.loadAfter()}},{key:"loadAfter",value:function(){for(var e=[],t=0;t<5;t++)e.push(this.questions[t].songEntity.fileUrl);El.instance().loadSoundArray(e),LogConsole.log("arrSongs:------- "),LogConsole.log(e),El.instance().event.loadComplete.add(this.loadComplete,this)}},{key:"setData",value:function(e,t,n,i,o,a){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,this.opponentAnswerLogs=a}},{key:"setDataBeChallenged",value:function(e,t,n){this.play_log_id=e,this.request_id=t,this.isHasHistory=n}},{key:"loadComplete",value:function(){LogConsole.log("load complete"),this.loadingAnim.destroy(),this.makeTweenToPlay()}},{key:"loadStart",value:function(){}},{key:"makeTweenToPlay",value:function(){0==this.countQuiz&&(this.UserSpriteLeft.makeTweenAva(),this.UserSpriteRight.makeTweenAva()),this.addBtnRemoveAnswer(),this.createGamePlayChallenged()}},{key:"createGamePlayChallenged",value:function(){this.timeCounter=game.time.create(),0==this.countQuiz?this.createLoadingScreenAfterStart():(this.timeCounter.start(),this.displayAnswering())}},{key:"addCircleNormal",value:function(){for(var e=this,t=function(t){0==e.countQuiz&&setTimeout(function(){var n=new Phaser.Sprite(game,(e.positionPlayConfig.circleNormal.x+62*t)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y+50)*window.GameConfig.RESIZE,e.positionPlayConfig.circleNormal.nameAtlas,e.positionPlayConfig.circleNormal.nameSprite);n.anchor.set(.5),game.add.tween(n).to({y:(game.height-z.instance().STANDARD_HEIGHT+e.positionPlayConfig.circleNormal.y)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start(),e.addChild(n)},50*t)},n=0;n<5;n++)t(n)}},{key:"addCorrectListSprites",value:function(){for(var e=0;e<this.correctList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.correctList[e].countQuiz)*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Text(game,0,3*window.GameConfig.RESIZE,this.correctList[e].time.toFixed(1),{font:"GilroyBold",fontSize:15});n.anchor.set(.5),t.addChild(n)}}},{key:"addWrongListSprites",value:function(){for(var e=0;e<this.wrongList.length;e++){var t=new Phaser.Sprite(game,(this.positionPlayConfig.circleWhite.x+62*this.wrongList[e])*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.circleWhite.y)*window.GameConfig.RESIZE,this.positionPlayConfig.circleWhite.nameAtlas,this.positionPlayConfig.circleWhite.nameSprite);t.anchor.set(.5),this.addChild(t);var n=new Phaser.Sprite(game,0,0,this.positionPlayConfig.wrongMini.nameAtlas,this.positionPlayConfig.wrongMini.nameSprite);n.anchor.set(.5),t.addChild(n)}}},{key:"createLoadingScreenAfterStart",value:function(){var e=this,t=game.add.audio("beep_audio"),n=new Phaser.Text(game,this.positionPlayConfig.countdownNumber.x*window.GameConfig.RESIZE,(this.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,"3",this.positionPlayConfig.countdownNumber.configs);n.anchor.set(.5),this.addChild(n);var i=game.add.tween(n).to({y:this.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("2");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE,n.setText("1");var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),t.play(),i.onComplete.add(function(){Le.instance().logEvent(Le.pro_quiz_start_turnbase),n.setText("Bắt đầu"),n.scale.set(.5),n.y=(e.positionPlayConfig.countdownNumber.y+80)*window.GameConfig.RESIZE;var i=game.add.tween(n).to({y:e.positionPlayConfig.countdownNumber.y*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1);i.start(),i.onComplete.add(function(){n.destroy(),t.destroy(),e.addCircleNormal(),e.displayAnswering()})})})})}},{key:"displayAnswering",value:function(){var e=this;if(this.namePlaylist.destroy(),this.btn_remove_answer.revive(),El.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.spriteTime=new Phaser.Sprite(game,0,(game.height-746)*window.GameConfig.RESIZE,"otherSprites","tween-time"),this.spriteTime.anchor.set(0,.5),this.addChild(this.spriteTime),this.tweenSpriteTime=game.add.tween(this.spriteTime.scale).to({x:70,y:1},1e4,"Linear"),this.tweenSpriteTime.start(),this.timeCounter.start(),this.createFourAnswer(),this.tweenSpriteTime.onComplete.add(function(){}),0==this.countQuiz){var t=new en;t.addHelperStep1(),this.addChild(t),this.timePS1=game.time.events.add(1.2*Phaser.Timer.SECOND,function(){t.addStep1ChooseAnswerQuest1(e.questions[0],e.countQuiz),t.event.step1.add(e.stepOneChoosed,e)})}if(1==this.countQuiz){var n=new en;n.addHelperStep2(),this.addChild(n),this.timePS2=game.time.events.add(1.2*Phaser.Timer.SECOND,function(){n.addStep2ChooseAnswerQuest2(e.questions[1],e.countQuiz),n.event.step2.add(e.stepTwoChoosed,e)})}if(2==this.countQuiz){var i=new en;i.addHelperStep3(),this.addChild(i),this.timePS3=game.time.events.add(1.2*Phaser.Timer.SECOND,function(){i.addStep3ChooseAnswerQuest3(e.questions[2],e.countQuiz),i.event.step3.add(e.stepThreeChoosed,e)})}}},{key:"stepOneChoosed",value:function(e){this.updateOnClickAnswer(e)}},{key:"stepTwoChoosed",value:function(e){this.updateOnClickAnswer(e)}},{key:"stepThreeChoosed",value:function(e){this.updateOnClickAnswer(e)}},{key:"addBtnRemoveAnswer",value:function(){this.btn_remove_answer=new Phaser.Button(game,this.positionPlayConfig.btn_remove_answer.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionPlayConfig.btn_remove_answer.y)*window.GameConfig.RESIZE,this.positionPlayConfig.btn_remove_answer.nameAtlas,function(){},this,null,this.positionPlayConfig.btn_remove_answer.nameSprite),this.btn_remove_answer.anchor.set(.5),this.btn_remove_answer.kill();var e=new Phaser.Text(game,this.positionPlayConfig.txt_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.txt_remove_answer.text,this.positionPlayConfig.txt_remove_answer.configs);e.anchor.set(.5);var t=new _t(this.positionPlayConfig.txt_dis_one,this.positionPlayConfig.txt_dis_one.text);t.anchor.set(.5),this.btn_remove_answer.addChild(t);var n=new Phaser.Sprite(game,this.positionPlayConfig.diamond_remove_answer.x*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.y*window.GameConfig.RESIZE,this.positionPlayConfig.diamond_remove_answer.nameAtlas,this.positionPlayConfig.diamond_remove_answer.nameSprite);n.anchor.set(1,.5);var i=new rt(this.positionPlayConfig.mic_so_luong);i.anchor.set(.5),this.countMic=TF.instance().socket.mySelf.getVariable("support_item").value,this.numberOfSptItem=new _t(this.positionPlayConfig.number_mic_so_luong,TF.instance().socket.mySelf.getVariable("support_item").value),this.numberOfSptItem.anchor.set(.5),i.addChild(this.numberOfSptItem),this.btn_remove_answer.addChild(i),this.btn_remove_answer.addChild(n),this.btn_remove_answer.addChild(e),this.btn_remove_answer.events.onInputDown.add(this.sendRemoveAnswer,this),this.addChild(this.btn_remove_answer)}},{key:"removeAnswer",value:function(){this.countMic--,this.numberOfSptItem.setText(this.countMic),this.btn_remove_answer.kill(),Bn.getTwoOfFourAnswer(this.answerA,this.answerB,this.answerC,this.answerD,this.questions[this.countQuiz])}},{key:"sendRemoveAnswer",value:function(){TF.instance().dataMySeft.support_item>0||IE.instance().addDialog("Bạn không đủ Míc"),ce.instance().playSound(ce.buttonclick)}},{key:"createFourAnswer",value:function(){for(var e=0;e<4;e++)0==e&&(this.answerA=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerA.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerA.sprite),this.addChild(this.answerA)),1==e&&(this.answerB=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerB.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerB.sprite),this.addChild(this.answerB)),2==e&&(this.answerC=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerC.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerC.sprite),this.addChild(this.answerC)),3==e&&(this.answerD=new bd(game.width/2,(game.height-576+122*e)*window.GameConfig.RESIZE,{index:e,questions:this.questions,countQuiz:this.countQuiz}),this.answerD.event.answer.add(this.updateOnClickAnswer,this),this.opponentAnswerLogs[this.countQuiz].answer==e+1&&this.addAvaMiniInTheLeftOfTab(this.answerD.sprite),this.addChild(this.answerD))}},{key:"updateOnClickAnswer",value:function(e){this.answerA.sprite.inputEnabled=!1,this.answerB.sprite.inputEnabled=!1,this.answerC.sprite.inputEnabled=!1,this.answerD.sprite.inputEnabled=!1,this.answered=e,this.calculateScoreOpp(),e+1==this.questions[this.countQuiz].correctAnswer?(this.setActionPhaseOnCorrect(),this.setTrueAva(),this.answeredResult=!0,this.timeCounter.ms/1e3>10?(this.score+=Math.floor(100*Math.pow(1,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:10})):(this.score+=Math.floor(100*(11-this.timeCounter.ms/1e3)*Math.pow(11-this.timeCounter.ms/1e3,(this.streak-1)/4)),this.correctList.push({countQuiz:this.countQuiz,time:this.timeCounter.ms/1e3})),this.setScore(this.score)):(this.setFalseAva(),this.answeredResult=!1,this.wrongList.push(this.countQuiz));for(var t=0;t<4;t++)0==t&&this.setTrueFalseTabAnswer(this.answerA,t),1==t&&this.setTrueFalseTabAnswer(this.answerB,t),2==t&&this.setTrueFalseTabAnswer(this.answerC,t),3==t&&this.setTrueFalseTabAnswer(this.answerD,t);this.pushResultAnswer(),this.addCorrectListSprites(),this.addWrongListSprites(),this.timeNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.resetQuestion,this)}},{key:"setActionPhaseOnCorrect",value:function(){this.questions[this.countQuiz].correctAnswer>2?this.actionPhase.position.y=game.height-636:this.actionPhase.position.y=game.height-416,this.actionPhase.setStreak(this.streak),this.addChild(this.actionPhase)}},{key:"addAvaMiniInTheLeftOfTab",value:function(e){var t,n=game.add.graphics(0,0);(n.beginFill(16777215),n.drawCircle(-246*window.GameConfig.RESIZE,0,40*window.GameConfig.RESIZE),n.anchor.set(.5),window.MQ.isBotMode)?((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,"bot-mini".concat(window.MQ.botKey))).anchor.set(.5),t.mask=n):((t=game.add.sprite(-246*window.GameConfig.RESIZE,0,this.opponent.avatar)).anchor.set(.5),t.scale.set(window.GameConfig.SCALE_AVA_OPPO_INTHELEFT*window.GameConfig.RESIZE),t.mask=n);t.kill(),e.addChild(n),e.addChild(t),this.timeAvaMiniShow=game.time.create(!0),this.timeAvaMiniShow.add(Phaser.Timer.SECOND*this.opponentAnswerLogs[this.countQuiz].timeAnswer,function(){t.revive()}),this.timeAvaMiniShow.start()}},{key:"calculateScoreOpp",value:function(){if(this.countQuiz<=4)if("CORRECT"==this.opponentAnswerLogs[this.countQuiz].trueOrFalse.toUpperCase()){this.setTrueAvaOpp();var e=Math.floor(100*(11-this.opponentAnswerLogs[this.countQuiz].timeAnswer)*Math.pow(11-this.opponentAnswerLogs[this.countQuiz].timeAnswer,(this.opponentAnswerLogs[this.countQuiz].streak-1)/4));this.scoreOpp+=e,this.setScoreOpp(this.scoreOpp)}else this.setFalseAvaOpp()}},{key:"pushResultAnswer",value:function(){var e="INCORRECT";1==this.answeredResult&&(e="CORRECT"),this.timeCounter.ms/1e3>10?this.answers.push({answer_time:10,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0}):this.answers.push({answer_time:this.timeCounter.ms/1e3,result:e,answer:this.answered+1,streak:this.streak,question_id:this.questions[this.countQuiz].id,created:Date.now(),index:0})}},{key:"removeTimeNextQuestion",value:function(){null!==this.timeNextQuestion&&game.time.events.remove(this.timeNextQuestion)}},{key:"resetQuestion",value:function(){this.removeTimeNextQuestion(),this.tweenSpriteTime.stop(),this.spriteTime.destroy(),this.timeCounter.stop(),this.actionPhase.setDefault(),this.timeCounter.destroy(),El.instance().removeSound(this.questions[this.countQuiz].songEntity.fileUrl),this.answerA.destroy(),this.answerB.destroy(),this.answerC.destroy(),this.answerD.destroy(),this.btn_remove_answer.revive(),1==this.answeredResult?this.streak++:this.streak=1,this.countQuiz<4?(this.countQuiz+=1,this.createGamePlayChallenged()):(El.instance().removeSound(),this.result={answers:this.answers,score:this.score,scoreOpp:this.scoreOpp,game_log_id:this.play_log_id,challenge_request_id:this.request_id,opponentAnswerLogs:this.opponentAnswerLogs,playlist_id:this.playlist.id},TF.instance().sendData(Et.PLAY_SCRIPT_DONE_TURNBASE_REQUEST,null),z.instance().playScript.playing_guide=en.DONE_TURNBASE)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.SUPPORT_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.removeAnswer(),e.cmd==Et.PLAY_SCRIPT_DONE_TURNBASE_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.event.doneTutorial.dispatch(),e.cmd==Et.PLAY_SCRIPT_DONE_ALL_RESPONSE&&(console.log("PLAY_SCRIPT_DONE_TURNBASE_RESPONSE"),"OK"==e.params.getUtfString("status")&&(z.instance().playScript.playing_guide=en.DONE_ALL,this.event.doneTutorial.dispatch()))}},{key:"setTrueFalseTabAnswer",value:function(e,t){t==this.answered?t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerWrong():t==this.questions[this.countQuiz].correctAnswer-1?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerNotChoosed()}},{key:"setTrueAva",value:function(){this.trueOrFalseUser.setTrueAnswer()}},{key:"setFalseAva",value:function(){this.trueOrFalseUser.setFailtAnswer()}},{key:"setTrueAvaOpp",value:function(){this.trueOrFalseOpp.setTrueAnswer()}},{key:"setFalseAvaOpp",value:function(){this.trueOrFalseOpp.setFailtAnswer()}},{key:"setScore",value:function(e){this.UserSpriteRight.setScore(e)}},{key:"setScoreOpp",value:function(e){this.UserSpriteLeft.setScore(e)}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timePS1),game.time.events.remove(this.timePS2),game.time.events.remove(this.timePS3),game.time.events.remove(this.timeNextQuestion),El.instance().event.loadComplete.remove(this.loadComplete,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&wp(n.prototype,i),o&&wp(n,o),t}();function Cp(e){return(Cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pp(e,t){return!t||"object"!==Cp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Op(e){return(Op=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rp(e,t){return(Rp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xp=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Pp(this,Op(t).call(this,game))).type=n,e.screenChallenge=null,e.screenBeChallenged=null,e.screenTutorial=null,e.screenWin=null,e.screenHistory=null,e.challengeMsg="",e.event={historyPlayTurn:new Phaser.Signal,screenRehome:new Phaser.Signal,screenWinScreenBeChallengedChallengAgain:new Phaser.Signal,playIllegalTurn:new Phaser.Signal,illegalTurnCancle:new Phaser.Signal,screenChallengeNextGame:new Phaser.Signal,historyChallenge:new Phaser.Signal},e.addEventExtension(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setData",value:function(e,t,n,i,o,a){this.questions=e,this.opponent=t,this.user_playlist_mapping=n,this.opponent_playlist_mapping=i,this.playlist=o,"BECHALLENGED"==this.type&&(this.opponentAnswerLogs=a),"TUTORIAL"==this.type&&(this.opponentAnswerLogs=a)}},{key:"setDataBeChallenged",value:function(e,t,n,i,o,a){"BECHALLENGED"==this.type&&(n?(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.weeklyResult=i,this.historyGameLog=o,this.dataTurnbase=a):(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.weeklyResult=i,this.dataTurnbase=a))}},{key:"setDataChallenge",value:function(e,t,n,i,o){"CHALLENGE"==this.type&&(n?(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.weeklyResult=i,this.historyGameLog=o):(this.play_log_id=e,this.request_id=t,this.isHasHistory=n,this.weeklyResult=i))}},{key:"addScreenPlay",value:function(){this.timeCountActionPhase=game.time.create(),"CHALLENGE"==this.type?this.isHasHistory?this.addScreenHistory():(this.addScreenChallenge(),this.timeCountActionPhase.start()):"BECHALLENGED"==this.type?this.isHasHistory?this.addScreenHistory():(this.addScreenBeChallenged(),this.timeCountActionPhase.start()):(this.addScreenTutorial(),this.timeCountActionPhase.start())}},{key:"addScreenTutorial",value:function(){this.removeScreenTutorial(),this.screenTutorial=new Ep,this.screenTutorial.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.opponentAnswerLogs),this.screenTutorial.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory),this.screenTutorial.event.resultGame.add(this.onCompleteBeChallenged,this),this.screenTutorial.event.doneTutorial.add(this.doneTutorial,this),this.screenTutorial.afterInit(),this.addChild(this.screenTutorial)}},{key:"doneTutorial",value:function(){window.GameConfig.IS_TUTORIAL=!1,rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"removeScreenTutorial",value:function(){null!==this.screenTutorial&&(this.removeChild(this.screenTutorial),this.screenTutorial.destroy(),this.screenTutorial=null)}},{key:"addScreenChallenge",value:function(){this.removeScreenChallenge(),this.screenChallenge=new jd,this.screenChallenge.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist),this.screenChallenge.event.resultGame.add(this.onCompleteChallenge,this),this.screenChallenge.afterInit(),this.addChild(this.screenChallenge)}},{key:"removeScreenChallenge",value:function(){null!==this.screenChallenge&&(this.removeChild(this.screenChallenge),this.screenChallenge.destroy(),this.screenChallenge=null)}},{key:"onCompleteChallenge",value:function(e){var t=this;this.result=e,this.handledJSONResultToSfsResultChallengeMode(e,function(e){qe.instance().showLoading(),t.sendGameFinishRequest(Et.CHALLENGE_GAME_FINISH_REQUEST,e),Le.instance().logEvent(Le.play_time,parseInt(t.timeCountActionPhase/1e3)),t.timeCountActionPhase.stop(),t.timeCountActionPhase.destroy()})}},{key:"addScreenBeChallenged",value:function(){this.removeScreenBeChallenged(),this.screenBeChallenged=new $f,this.screenBeChallenged.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.opponentAnswerLogs),this.screenBeChallenged.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory),this.screenBeChallenged.event.resultGame.add(this.onCompleteBeChallenged,this),this.screenBeChallenged.afterInit(),this.addChild(this.screenBeChallenged)}},{key:"removeScreenBeChallenged",value:function(){null!==this.screenBeChallenged&&(this.removeChild(this.screenBeChallenged),this.screenBeChallenged.destroy(),this.screenBeChallenged=null)}},{key:"onCompleteBeChallenged",value:function(e){var t=this;this.result=e,this.handledJSONResultToSfsResultBeChallengedMode(e,function(e){qe.instance().showLoading(),t.sendGameFinishRequest(Et.BECHALLENGED_GAME_FINISH_REQUEST,e),LogConsole.log(parseInt(t.timeCountActionPhase.ms/1e3)),Le.instance().logEvent(Le.play_time,parseInt(t.timeCountActionPhase/1e3)),t.timeCountActionPhase.stop(),t.timeCountActionPhase.destroy()})}},{key:"handledJSONResultToSfsResultChallengeMode",value:function(e,t){LogConsole.log(e);var n=new SFS2X.SFSObject,i=new SFS2X.SFSArray;this.putValueToAnswers(i,e,function(e){n.putSFSArray("answers",e)}),n.putInt("score",e.score),n.putInt("opponent_id",e.opponent_id),n.putInt("playlist_id",e.playlist_id),t(n)}},{key:"handledJSONResultToSfsResultBeChallengedMode",value:function(e,t){LogConsole.log(e);var n=new SFS2X.SFSObject,i=new SFS2X.SFSArray;this.putValueToAnswers(i,e,function(e){n.putSFSArray("answers",e)}),n.putInt("score",e.score),n.putInt("playlist_id",e.playlist_id),n.putLong("challenge_request_id",e.challenge_request_id),t(n)}},{key:"putValueToAnswers",value:function(e,t,n){for(var i=0;i<5;i++){var o=new SFS2X.SFSObject;o.putFloat("answer_time",t.answers[i].answer_time),o.putUtfString("result",t.answers[i].result),o.putInt("answer",t.answers[i].answer),o.putInt("streak",t.answers[i].streak),o.putLong("question_id",t.answers[i].question_id),o.putLong("created",t.answers[i].created),o.putInt("index",t.answers[i].index),e.addSFSObject(o)}n(e)}},{key:"sendGameFinishRequest",value:function(e,t){LogConsole.log(t.getDump()),TF.instance().sendData(e,t)}},{key:"switchToScreenWin",value:function(e){this.removeScreenChallenge(),this.removeScreenBeChallenged(),this.addScreenWin(e)}},{key:"addScreenHistory",value:function(){this.removeScreenHistory(),this.screenHistory=new ap,this.screenHistory.setType(this.type),this.screenHistory.setData(this.historyGameLog.questions,this.opponent,this.historyGameLog.user_playlist_mapping,this.historyGameLog.opponent_playlist_mapping,this.historyGameLog.playlist,this.historyGameLog.result,this.historyGameLog.result.opponentAnswerLogs,this.weeklyResult),this.screenHistory.afterInit(),this.screenHistory.event.playYourTurn.add(this.historyPlayTurn,this),this.screenHistory.event.reHome.add(this.screenRehome,this),this.screenHistory.event.challenge.add(this.historyChallenge,this),this.addChild(this.screenHistory)}},{key:"removeScreenHistory",value:function(){null!==this.screenHistory&&(this.removeChild(this.screenHistory),this.screenHistory.destroy(),this.screenHistory=null)}},{key:"historyPlayTurn",value:function(){this.removeScreenHistory(),this.event.historyPlayTurn.dispatch()}},{key:"historyChallenge",value:function(){this.removeScreenHistory(),this.event.historyChallenge.dispatch()}},{key:"addScreenWin",value:function(e){this.removeScreenWin(),this.screenWin=new qf(e),this.screenWin.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.result,this.challengeMsg),"BECHALLENGED"==e?this.screenWin.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory,this.opponentAnswerLogs,this.weeklyResult,this.dataTurnbase):this.screenWin.setDataChallenge(this.play_log_id,this.request_id),this.screenWin.addScreen(),this.screenWin.event.screenReHome.add(this.screenRehome,this),this.screenWin.event.screenBeChallengedChallengAgain.add(this.screenWinScreenBeChallengedChallengAgain,this),this.screenWin.event.screenChallengeNextGame.add(this.screenChallengeNextGame,this),this.addChild(this.screenWin)}},{key:"removeScreenWin",value:function(){null!==this.screenWin&&(this.removeChild(this.screenWin),this.screenWin.destroy(),this.screenWin=null)}},{key:"screenRehome",value:function(){this.event.screenRehome.dispatch()}},{key:"screenWinScreenBeChallengedChallengAgain",value:function(){this.event.screenWinScreenBeChallengedChallengAgain.dispatch()}},{key:"screenChallengeNextGame",value:function(e){this.event.screenChallengeNextGame.dispatch(e)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.CHALLENGE_GAME_FINISH_RESPONSE?"OK"==e.params.getUtfString("status")?(qe.instance().hideLoading(),this.request_id=e.params.getLong("challenge_request_id"),this.challengeMsg=e.params.getUtfString("challenge_msg"),Le.instance().logEvent(Le.pro_quiz_end_turnbase),this.switchToScreenWin("CHALLENGE")):"WARNING"==e.params.getUtfString("status")&&(qe.instance().hideLoading(),this.handleIllegalTurn(e.params)):e.cmd==Et.BECHALLENGED_GAME_FINISH_RESPONSE&&"OK"==e.params.getUtfString("status")&&(Le.instance().logEvent(Le.pro_quiz_end_turnbase),qe.instance().hideLoading(),this.switchToScreenWin("BECHALLENGED"))}},{key:"handleIllegalTurn",value:function(e){var t=this,n=e.getLong("opponent_game_log"),i=e.getLong("challenge_request_id");this.illlegalTurn={request_id:i,game_log_id:n},this.illlegalTurnModule=new mp,this.illlegalTurnModule.setData(this.opponent),this.illlegalTurnModule.event.playIllegalTurn.add(this.playIllegalTurn,this),this.illlegalTurnModule.event.illegalTurnCancle.add(this.illegalTurnCancle,this),this.addChild(this.illlegalTurnModule),this.illlegalTurnModule.makeNewGameBeChallenged(this.illlegalTurn,function(){t.illlegalTurnModule.addPopupIllegalTurn()})}},{key:"playIllegalTurn",value:function(e){this.event.playIllegalTurn.dispatch(e)}},{key:"illegalTurnCancle",value:function(){this.event.illegalTurnCancle.dispatch()}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),El.instance().removeAllSound();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&kp(n.prototype,i),o&&kp(n,o),t}();function Tp(e){return(Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ip(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ap(e,t){return!t||"object"!==Tp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lp(e,t,n){return(Lp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gp(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Gp(e){return(Gp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dp(e,t){return(Dp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mp=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ap(this,Gp(t).call(this,game))).arrResource=[],e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"loadResource",value:function(){for(var e=0;e<this.arrResource.length;e++){var t=this.arrResource[e],n=t.type,i=t.link+"?v=".concat(window.VersionClient),o=t.key;switch(n){case"text":game.load.text(o,i);break;case"image":game.load.image(o,i);break;case"atlas":var a=t.linkJson+"?v=".concat(window.VersionClient);game.load.atlas(o,i,a,Phaser.Loader.TEXTURE_ATLAS_JSON_HASH);break;case"spritesheet":var s=t.width,r=t.height,l=t.countFrame;game.load.spritesheet(o,i,s,r,l)}}game.load.onLoadComplete.add(this.loadFileComplete,this),game.load.start()}},{key:"loadFileComplete",value:function(){game.load.onLoadComplete.remove(this.loadFileComplete,this),this.onLoadFileComplete()}},{key:"onLoadFileComplete",value:function(){}},{key:"removeResource",value:function(){for(var e=0;e<this.arrResource.length;e++){var t=this.arrResource[e],n=t.type,i=(t.link,"?v=".concat(window.VersionClient),t.key);switch(n){case"text":console.log("remove text : "+i),game.cache.checkTextKey(i)&&(console.log("da xoa"),game.cache.removeText(i));break;case"image":console.log("remove image : "+i),game.cache.checkImageKey(i)&&(console.log("da xoa"),game.cache.removeImage(i));break;case"atlas":console.log("remove atlas : "+i),game.cache.checkImageKey(i)&&(console.log("da xoa image"),game.cache.removeImage(i));var o=t.linkJson+"?v=".concat(window.VersionClient);game.cache.checkJSONKey(o)&&(console.log("da xoa json"),game.cache.checkJSONKey(o)),game.cache.checkXMLKey(o)&&(console.log("da xoa xml"),game.cache.checkXMLKey(o));break;case"spritesheet":console.log("remove spritesheet : "+i),game.cache.checkImageKey(i)&&(console.log("da xoa image"),game.cache.removeImage(i))}}}},{key:"destroy",value:function(){this.removeResource(),Lp(Gp(t.prototype),"destroy",this).call(this),console.log(game.cache)}}])&&Ip(n.prototype,i),o&&Ip(n,o),t}();function Np(e){return(Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bp(e,t){return!t||"object"!==Np(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jp(e,t,n){return(jp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Up(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Up(e){return(Up=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Zp(e,t,n){return t&&Fp(e.prototype,t),n&&Fp(e,n),e}function Hp(e,t){return(Hp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qp=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=Bp(this,Up(t).call(this)),null==n&&null==i?e.screenType=1:i==t.TYPE_BECHALLENGED?e.screenType=3:i==t.TYPE_CHALLENGE?e.screenType=2:e.screenType=4,e.opponent=n,e.type=i,e.dataTurnbase=o,e.findgame=null,e.choosePlaylist=null,e.playGame=null,e.event={backMenu:new Phaser.Signal},e.arrResource=[{type:"text",link:"img/config/positionCreateRoom.json",key:"positionCreateRoom"},{type:"text",link:"img/config/findOpponents.json",key:"findOpponentConfig"},{type:"text",link:"img/config/positionWinConfig.json",key:"positionWinConfig"},{type:"text",link:"img/config/positionMainConfig.json",key:"positionMainConfig"},{type:"text",link:"img/config/limitTurn.json",key:"limitTurnConfig"},{type:"atlas",link:"img/atlas/playTurnBase.png",key:"playSprites",linkJson:"img/atlas/playTurnBase.json"},{type:"atlas",link:"img/atlas/findOpponent.png",key:"findOpponentSprites",linkJson:"img/atlas/findOpponent.json"}],e.loadResource(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hp(e,t)}(t,Mp),Zp(t,null,[{key:"TYPE_BECHALLENGED",get:function(){return"BECHALLENGED"}},{key:"TYPE_CHALLENGE",get:function(){return"CHALLENGE"}},{key:"TUTORIAL",get:function(){return"TUTORIAL"}}]),Zp(t,[{key:"onLoadFileComplete",value:function(){this.afterInit(),this.addScreen()}},{key:"afterInit",value:function(){this.playScript=JSON.parse(game.cache.getText("playScript")),this.definedData(),this.addEventExtension()}},{key:"definedData",value:function(){this.historyGameLog={questions:[],playlist:{},result:{answers:[],score:0,scoreOpp:0,opponentAnswerLogs:[]},user_playlist_mapping:{},opponent_playlist_mapping:{}},this.playlistHisTory,this.questions=[],this.playlist={},this.opponentAnswerLogs=[],qe.instance().showLoading()}},{key:"addScreen",value:function(){null!==this.opponent?this.type==t.TYPE_CHALLENGE?(this.sendChallengeGameHistoryRequest(),this.screenType=2):this.type==t.TYPE_BECHALLENGED?(this.handleRequestBeChallengedGame(),this.screenType=3):(this.addPlayGame(t.TUTORIAL),this.screenType=4):this.addFindGame()}},{key:"sendChallengeGameHistoryRequest",value:function(){var e=new SFS2X.SFSObject;e.putInt("opponent_id",this.opponent.id),TF.instance().sendData(Et.CHALLENGE_GAME_HISTORY_REQUEST,e),qe.instance().showLoading()}},{key:"handleRequestBeChallengedGame",value:function(){this.sendBeChallengedGameLogRequest(TF.instance().dataMySeft.user_id,this.opponent.id)}},{key:"sendBeChallengedGameLogRequest",value:function(e,t){var n=new SFS2X.SFSObject;n.putInt("user_id",e),n.putInt("opponent_id",t),TF.instance().sendData(Et.BECHALLENGED_GAME_OPPONENT_GAME_LOG_REQUEST,n),qe.instance().showLoading()}},{key:"setDataBeChallenged",value:function(e,n,i,o,a){this.type==t.TYPE_BECHALLENGED&&(this.play_log_id=e,this.request_id=n,this.isHasHistory=i),this.weeklyResult=o,this.dataTurnbase=a}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),Ur.instance().event.load_playlist_complete.add(this.loadPlaylistComplete,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),Ur.instance().event.load_playlist_complete.remove(this.loadPlaylistComplete,this)}},{key:"onExtensionResponse",value:function(e){var n=this;e.cmd==Et.CHALLENGE_GAME_QUESTIONS_RESPONSE&&("WARNING"===e.params.getUtfString("status")?(IE.instance().addLimitTurn(),qe.instance().hideLoading()):this.handleQuestionResponse(e.params,function(){n.isHandleQuestionResponse=!0,n.addPlayGame(t.TYPE_CHALLENGE),qe.instance().hideLoading()})),e.cmd==Et.BECHALLENGED_GAME_OPPONENT_GAME_LOG_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.opponentAnswerLogs=[],this.beChallengedParamsSimple=e.params,1==Ur.instance().ktLoadPlaylist?this.loadPlaylistComplete():Ur.instance().sendGetDataShop()):rF.instance().changeScreen(Ce.MAIN_MENU)),e.cmd==Et.CHALLENGE_GAME_HISTORY_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.handleHistory(e.params),1==this.isHasHistory?this.addPlayGame(t.TYPE_CHALLENGE):this.addChoosePlaylist(this.opponent)):rF.instance().changeScreen(Ce.MAIN_MENU))}},{key:"loadPlaylistComplete",value:function(){var e=this;this.type==t.TYPE_BECHALLENGED&&this.handleResponseBeChallengedGame(this.beChallengedParamsSimple,function(){e.sortQuestions(e.questions),e.sortQuestions(e.opponentAnswerLogs),e.addPlayGame(t.TYPE_BECHALLENGED),qe.instance().hideLoading()})}},{key:"sortQuestions",value:function(e){e=e.sort(function(e,t){return e.questionId-t.questionId})}},{key:"addFindGame",value:function(){this.removeFindGame(),this.findgame=new Wr,this.findgame.event.choose_playlist.add(this.addChoosePlaylist,this),this.findgame.event.onBack.add(this.onBackFindGame,this),this.findgame.event.challengeGame.add(this.challengeGame,this),this.addChild(this.findgame)}},{key:"removeFindGame",value:function(){null!==this.findgame&&(this.removeChild(this.findgame),this.findgame.destroy(),this.findgame=null)}},{key:"addChoosePlaylist",value:function(e){qe.instance().showLoading(),this.opponent=e,this.removeChoosePlaylist(),this.choosePlaylist=new nd(e),this.choosePlaylist.event.choosePlaylist.add(this.onChoosedPlaylist,this),this.choosePlaylist.event.backScreen.add(this.onBackChoosePlaylist,this),this.addChild(this.choosePlaylist)}},{key:"removeChoosePlaylist",value:function(){null!==this.choosePlaylist&&(this.removeChild(this.choosePlaylist),this.choosePlaylist.destroy(),this.choosePlaylist=null)}},{key:"onBackChoosePlaylist",value:function(){1!==this.screenType?(this.removeChoosePlaylist(),rF.instance().changeScreen(Ce.TURN_BASE)):this.removeChoosePlaylist()}},{key:"onChoosedPlaylist",value:function(e){this.playlist=e,this.removeChoosePlaylist(),this.removeFindGame()}},{key:"onBackFindGame",value:function(){this.removeFindGame()}},{key:"challengeGame",value:function(e){this.type=t.TYPE_CHALLENGE,this.opponent=e,this.sendChallengeGameHistoryRequest(),this.screenType=2}},{key:"addPlayGame",value:function(e){this.removePlayGame(),this.playGame=new xp(e),this.playGame.setData(this.questions,this.opponent,this.user_playlist_mapping,this.opponent_playlist_mapping,this.playlist,this.opponentAnswerLogs),this.type==t.TYPE_BECHALLENGED&&(this.isHasHistory?(this.playGame.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory,this.weeklyResult,this.historyGameLog,this.dataTurnbase),this.playGame.event.historyPlayTurn.add(this.historyPlayTurn,this)):this.playGame.setDataBeChallenged(this.play_log_id,this.request_id,this.isHasHistory,this.weeklyResult,this.historyGameLog,this.dataTurnbase)),e==t.TYPE_CHALLENGE&&(this.isHasHistory?this.playGame.setDataChallenge(this.play_log_id,this.request_id,this.isHasHistory,this.weeklyResult,this.historyGameLog):this.playGame.setDataChallenge(this.play_log_id,this.request_id,this.isHasHistory,this.weeklyResult)),this.type==t.TUTORIAL&&(this.playGame.setData(this.playScript.demoData.questions,this.playScript.demoData.opponent,this.playScript.demoData.user_playlist_mapping,this.playScript.demoData.opponent_playlist_mapping,this.playScript.demoData.playlist,this.playScript.demoData.opponentAnswerLogs),this.playGame.setDataBeChallenged(this.playScript.demoData.play_log_id,this.playScript.demoData.request_id,this.playScript.demoData.isHasHistory,this.playScript.demoData.weeklyResult),qe.instance().hideLoading()),this.playGame.addScreenPlay(),this.playGame.event.screenRehome.add(this.playGameScreenWinScreenChallengeReHome,this),this.playGame.event.screenWinScreenBeChallengedChallengAgain.add(this.screenWinScreenBeChallengedChallengAgain,this),this.playGame.event.illegalTurnCancle.add(this.illegalTurnCancle,this),this.playGame.event.playIllegalTurn.add(this.playIllegalTurn,this),this.playGame.event.screenChallengeNextGame.add(this.screenChallengeNextGame,this),this.playGame.event.historyChallenge.add(this.historyChallenge,this),this.addChild(this.playGame)}},{key:"removePlayGame",value:function(){null!==this.playGame&&(this.removeChild(this.playGame),this.playGame.destroy(),this.playGame=null)}},{key:"historyPlayTurn",value:function(){this.removePlayGame(),this.isHasHistory=!1,this.addPlayGame(t.TYPE_BECHALLENGED)}},{key:"historyChallenge",value:function(){this.removePlayGame(),this.isHasHistory=!1,this.addChoosePlaylist(this.opponent)}},{key:"playGameScreenWinScreenChallengeReHome",value:function(){rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"screenWinScreenBeChallengedChallengAgain",value:function(){this.removePlayGame(),this.type=t.TYPE_CHALLENGE,this.definedData(),this.addChoosePlaylist(this.opponent)}},{key:"illegalTurnCancle",value:function(){this.removePlayGame(),rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"playIllegalTurn",value:function(e){this.removePlayGame(),this.type=t.TYPE_BECHALLENGED,this.definedData(),this.addScreen()}},{key:"screenChallengeNextGame",value:function(e){this.removePlayGame(),this.type=e.type,this.opponent=e.opponent,this.definedData(),this.setDataBeChallenged(e.gameLogId,e.requestId,e.isHasHistory,e.weeklyResult,e),this.addScreen()}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this),jp(Up(t.prototype),"destroy",this).call(this)}},{key:"handleQuestionResponse",value:function(e,t){if("OK"==e.getUtfString("status")){for(var n=e.getSFSArray("response"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString("question_type"),s=o.getUtfString("answer1"),r=o.getUtfString("answer2"),l=o.getUtfString("answer3"),h=o.getUtfString("answer4"),c=o.getLong("id"),u=o.getInt("correct_answer"),d=o.getUtfString("file_path"),f=o.getUtfString("file_path"),p=o.getSFSObject("song"),g=p.getUtfString("title"),y=p.getLong("id"),m=p.getUtfString("title"),v=p.getUtfString("author"),w=p.getSFSObject("singer"),b=w.getUtfString("name"),_=w.getUtfString("avatar"),S=[];if(p.containsKey("song_links"))for(var E=p.getSFSArray("song_links"),C=0;C<E.size();C++){var k=E.getSFSObject(C),P=k.getUtfString("link_type"),O=k.getLong("song_id"),R=k.getInt("is_movie"),x=k.getUtfString("link"),T=k.getLong("id");S.push({link_type:P,song_id:O,is_movie:R,link:x,id:T})}this.questions.push({questionType:a,answers:[s,r,l,h],correctAnswer:u,songEntity:{thumb:_,song:g,song_links:S,fileName:m,author:v,singer:b,listenLink:f,id:y,fileUrl:d},id:c})}if(e.containsKey("opponent_playlist_mapping"))var I=e.getSFSObject("opponent_playlist_mapping");if(e.containsKey("user_playlist_mapping"))e.getSFSObject("user_playlist_mapping");this.user_playlist_mapping=this.handleUserPlaylistMapping(this.playlist),this.opponent_playlist_mapping=this.handlePlaylistMapping(I),t()}else rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"handleResponseBeChallengedGame",value:function(e,t){var n=e.getSFSArray("opponent_answer_logs"),i=e.getSFSObject("playlist"),o=i.getInt("id"),a=i.getUtfString("name");this.playlist={id:o,name:a};for(var s=0;s<n.size();s++){var r=n.getSFSObject(s),l=r.getSFSObject("question_entity"),h=l.getUtfString("question_type"),c=l.getUtfString("answer1"),u=l.getUtfString("answer2"),d=l.getUtfString("answer3"),f=l.getUtfString("answer4"),p=l.getLong("id"),g=l.getInt("correct_answer"),y=l.getUtfString("file_path"),m=l.getUtfString("file_path"),v=l.getSFSObject("song"),w=v.getUtfString("title"),b=v.getLong("id"),_=v.getUtfString("title"),S=v.getUtfString("author"),E=v.getSFSObject("singer"),C=E.getUtfString("name"),k=E.getUtfString("avatar"),P=[];if(v.containsKey("song_links"))for(var O=v.getSFSArray("song_links"),R=0;R<O.size();R++){var x=O.getSFSObject(R),T=x.getUtfString("link_type"),I=x.getLong("song_id"),A=x.getInt("is_movie"),L=x.getUtfString("link"),G=x.getLong("id");P.push({link_type:T,song_id:I,is_movie:A,link:L,id:G})}var D=r.getLong("question_id"),M=r.getDouble("answer_time"),N=r.getInt("answer"),B=r.getInt("streak"),j=r.getUtfString("result");this.opponentAnswerLogs.push({questionId:D,answer_time:M,answer:N,streak:B,result:j}),this.questions.push({questionId:D,questionType:h,answers:[c,u,d,f],correctAnswer:g,songEntity:{thumb:k,song:w,fileName:_,song_links:P,author:S,singer:C,listenLink:m,id:b,fileUrl:y},id:p})}if(e.containsKey("opponent_playlist_mapping"))var U=e.getSFSObject("opponent_playlist_mapping");if(e.containsKey("user_playlist_mapping"))e.getSFSObject("user_playlist_mapping");this.user_playlist_mapping=this.handleUserPlaylistMapping(this.playlist),this.opponent_playlist_mapping=this.handlePlaylistMapping(U),this.handleHistory(e);var F=e.getLong("challenge_request_id");this.request_id=F;var Z=e.getSFSObject("weekly_result"),H=Z.getInt("user_won"),Q=Z.getInt("opponent_won");this.weeklyResult={userWon:H,opponentWon:Q},t()}},{key:"handleHistory",value:function(e){if(e.containsKey("history")){this.isHasHistory=!0;var t=e.getSFSObject("history");t.containsKey("user_id")?(this.handleResponseBechallengedGameHistory(t,function(){}),this.sortQuestions(this.historyGameLog.questions),this.sortQuestions(this.historyGameLog.result.answers),this.sortQuestions(this.historyGameLog.result.opponentAnswerLogs)):this.isHasHistory=!1}else this.isHasHistory=!1}},{key:"handleUserPlaylistMapping",value:function(e){return Ur.instance().playlist.getPlayListById(e.id).user_playlist_mapping}},{key:"handlePlaylistMapping",value:function(e){var t=new Bs;return e?(t.user_id=e.getInt(qs.user_id),t.level=e.getInt(qs.level),t.playlist_id=e.getInt(qs.playlist_id),t.exp_score=e.getInt(qs.exp_score),t.created=e.getLong(qs.created),t.active=e.getInt(qs.active),t.id=e.getLong(qs.id),t.current_level_score=e.getInt(qs.current_level_score),t.next_level_score=e.getInt(qs.next_level_score),t.updated=e.getLong(qs.updated),t):t}},{key:"handleResponseBechallengedGameHistory",value:function(e,t){var n=e.getInt("user_id"),i=e.getInt("playlist_id"),o=e.getSFSObject("playlist").getUtfString("name"),a=e.getSFSObject("user_play_log_entity"),s=e.getSFSObject("opponent_play_log_entity"),r=a.getInt("score"),l=s.getInt("score");if(e.containsKey("opponent_playlist_mapping"))var h=e.getSFSObject("opponent_playlist_mapping");if(e.containsKey("user_playlist_mapping"))var c=e.getSFSObject("user_playlist_mapping");n==TF.instance().dataMySeft.user_id?(this.historyGameLog.user_playlist_mapping=this.handleUserPlaylistMapping({id:i,name:o}),this.historyGameLog.opponent_playlist_mapping=this.handlePlaylistMapping(h),this.handleGameLogEntity(a,this.historyGameLog.result.answers),this.handleGameLogEntity(s,this.historyGameLog.result.opponentAnswerLogs),this.historyGameLog.result.score=r,this.historyGameLog.result.scoreOpp=l):(this.historyGameLog.user_playlist_mapping=this.handleUserPlaylistMapping({id:i,name:o}),this.historyGameLog.opponent_playlist_mapping=this.handlePlaylistMapping(c),this.handleGameLogEntity(a,this.historyGameLog.result.opponentAnswerLogs),this.handleGameLogEntity(s,this.historyGameLog.result.answers),this.historyGameLog.result.score=l,this.historyGameLog.result.scoreOpp=r),this.handleQuestionLogEntity(s,this.historyGameLog.questions),this.historyGameLog.playlist={id:i,name:o},t()}},{key:"handleQuestionLogEntity",value:function(e,t){for(var n=e.getSFSArray("answer_entities"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getSFSObject("question_entity"),s=a.getUtfString("question_type"),r=a.getUtfString("file_path"),l=a.getUtfString("file_path"),h=a.getSFSObject("song"),c=h.getUtfString("title"),u=h.getLong("id"),d=h.getUtfString("title"),f=h.getUtfString("author"),p=h.getSFSObject("singer"),g=p.getUtfString("name"),y=p.getUtfString("avatar"),m=o.getLong("question_id"),v=[];if(h.containsKey("song_links"))for(var w=h.getSFSArray("song_links"),b=0;b<w.size();b++){var _=w.getSFSObject(b),S=_.getUtfString("link_type"),E=_.getLong("song_id"),C=_.getInt("is_movie"),k=_.getUtfString("link"),P=_.getLong("id");v.push({link_type:S,song_id:E,is_movie:C,link:k,id:P})}t.push({questionId:m,questionType:s,songEntity:{thumb:y,song:c,fileName:d,song_links:v,author:f,singer:g,listenLink:l,id:u,fileUrl:r}})}}},{key:"handleGameLogEntity",value:function(e,t){for(var n=e.getSFSArray("answer_entities"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getDouble("answer_time"),s=o.getUtfString("result"),r=o.getLong("question_id");t.push({answer_time:a,result:s,questionId:r})}}}]),t}();function Vp(e){return(Vp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qp(e,t){return!t||"object"!==Vp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kp(e){return(Kp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zp(e,t){return(zp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yp=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=qp(this,Kp(t).call(this,game))).positionUserProfile=JSON.parse(game.cache.getText("positionUserProfile")),o.current_exp_level=e,o.next_exp_level=n,o.percentLevelCurrent=0,TF.instance().dataMySeft&&(o.experience_score=i),o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zp(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.calCurrentExpLevel=this.experience_score-this.current_exp_level,this.calExpLevel=this.next_exp_level-this.current_exp_level,this.txt=new _t(this.positionUserProfile.profile_exp_current_txt,"Level hiện tại (".concat(this.calCurrentExpLevel,"/").concat(this.calExpLevel,")")),this.txt.anchor.set(.5),this.exp_current,this.ext_require,this.exp_current=new rt(this.positionUserProfile.profile_current_level),this.exp_current.anchor.set(0,.5),this.ext_require=new rt(this.positionUserProfile.profile_require_level),this.ext_require.anchor.set(0,.5),this.calculatePercentLevelCurrent(),this.addChild(this.txt),this.addChild(this.ext_require),this.addChild(this.exp_current)}},{key:"calculatePercentLevelCurrent",value:function(){this.percentLevelCurrent=(this.calCurrentExpLevel/this.calExpLevel).toFixed(1),this.exp_current.scale.set(this.percentLevelCurrent,1)}}])&&Wp(n.prototype,i),o&&Wp(n,o),t}();function Jp(e){return(Jp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xp(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $p(e,t,n){return($p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eg(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function eg(e){return(eg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tg(e,t){return(tg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ng(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ig=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=eg(t).call(this,game,0,0,null))||"object"!==Jp(i)&&"function"!=typeof i?ng(n):i).event={back:new Phaser.Signal},e.isMe=!1,e.heightGame=474*window.GameConfig.RESIZE,e.user=new Au,e.game_status=0,e.positionUserProfile=e.mainData.positionUserProfile,e.header=new Qa,e.header.event.back.add(e.chooseBack,ng(ng(e))),e.addChild(e.header),e.txtOnline=new _t(e.positionUserProfile.profile_txt_online,""),e.txtOnline.setTextBounds(0,0,game.width,27*window.GameConfig.RESIZE),e.addChild(e.txtOnline),e.bgAva=new rt(e.positionUserProfile.profile_bg_avatar),e.addChild(e.bgAva),e.clickBigAva=!1,e.ava=new pc,e.ava.setSize(148*window.GameConfig.RESIZE,148*window.GameConfig.RESIZE),e.ava.inputEnabled=!0,e.ava.events.onInputUp.add(e.onClickAva,ng(ng(e))),e.ava.x=246*window.GameConfig.RESIZE,e.ava.y=43*window.GameConfig.RESIZE,e.addChild(e.ava),e.bgAvaVip=new rt(e.positionUserProfile.profile_bg_avatar_vip),e.bgAvaVip.visible=!1,e.addChild(e.bgAvaVip),e.txtUserName=new _t(e.positionUserProfile.profile_txt_username,"MrViet"),e.txtUserName.setTextBounds(0,0,game.width,35*window.GameConfig.RESIZE),e.addChild(e.txtUserName),e.txtLevel=new _t(e.positionUserProfile.profile_txt_level,"Level 12- abc"),e.txtLevel.setTextBounds(0,0,game.width,27*window.GameConfig.RESIZE),e.addChild(e.txtLevel),e.addEventExtension(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tg(e,t)}(t,Mt),n=t,(i=[{key:"onClickAva",value:function(){this.clickBigAva=!0,this.bigAvatar=new Rn(this.user.avatar),this.bigAvatar.event.back.add(this.backBigAva,this),Gn.instance().addChild(this.bigAvatar)}},{key:"backBigAva",value:function(){this.clickBigAva=!1}},{key:"chooseBack",value:function(){0==this.clickBigAva&&this.event.back.dispatch()}},{key:"addOtherUser",value:function(e,t,n){LogConsole.log("friend_status"),LogConsole.log(e),this.txtDescription=new _t(this.positionUserProfile.profile_txt_description,this.user.description),this.txtDescription.setTextBounds(0,0,game.width,30*window.GameConfig.RESIZE),this.addChild(this.txtDescription),"NO_FRIEND"===n?(this.btnSendMessage=new pt(this.positionUserProfile.profile_btn_nhantin,this.chooseSendMessage,this),this.addChild(this.btnSendMessage),this.btnInviteFriend=new ln(this.positionUserProfile.profile_btn_ketban,"KẾT BẠN",this.chooseInviteFriend,this),this.addChild(this.btnInviteFriend),this.btnDuel=new ln(this.positionUserProfile.profile_btn_thachdau,"THÁCH ĐẤU",this.chooseDuel,this),this.addChild(this.btnDuel),!0===e.vip?(this.btnInviteFriend.y=(this.positionUserProfile.profile_btn_ketban.y+12)*window.GameConfig.RESIZE,this.btnDuel.y=(this.positionUserProfile.profile_btn_thachdau.y+12)*window.GameConfig.RESIZE,this.txtDescription.y=(this.positionUserProfile.profile_txt_description.y+12)*window.GameConfig.RESIZE,this.heightGame=575*window.GameConfig.RESIZE):(this.btnInviteFriend.y=this.positionUserProfile.profile_btn_ketban.y*window.GameConfig.RESIZE,this.btnDuel.y=this.positionUserProfile.profile_btn_thachdau.y*window.GameConfig.RESIZE,this.txtDescription.y=this.positionUserProfile.profile_txt_description.y*window.GameConfig.RESIZE,this.heightGame=563*window.GameConfig.RESIZE)):(this.btnSendMessage=new pt(this.positionUserProfile.profile_btn_nhantin,this.chooseSendMessage,this),this.addChild(this.btnSendMessage),this.btnDuel=new ln(this.positionUserProfile.profile_btn_thachdau_friend,"THÁCH ĐẤU",this.chooseDuel,this),this.addChild(this.btnDuel),!0===e.vip?(this.btnDuel.y=(this.positionUserProfile.profile_btn_thachdau_friend.y+12)*window.GameConfig.RESIZE,this.btnSendMessage.y=(this.positionUserProfile.profile_btn_nhantin_friend.y+12)*window.GameConfig.RESIZE,this.txtDescription.y=(this.positionUserProfile.profile_txt_description.y+12)*window.GameConfig.RESIZE,this.heightGame=474*window.GameConfig.RESIZE):(this.btnDuel.y=this.positionUserProfile.profile_btn_thachdau_friend.y*window.GameConfig.RESIZE,this.btnSendMessage.y=this.positionUserProfile.profile_btn_nhantin_friend.y*window.GameConfig.RESIZE,this.txtDescription.y=this.positionUserProfile.profile_txt_description.y*window.GameConfig.RESIZE,this.heightGame=462*window.GameConfig.RESIZE),"PENDING_THEM"===n&&(this.txtWarning=new _t(this.positionUserProfile.profile_txt_warning_pending_them,""),Bn.getGender(e),this.txtWarning.setText("Bạn đã gửi yêu cầu kết bạn tới "+e.user_name),this.txtWarning.setTextBounds(0,0,game.width,30*window.GameConfig.RESIZE),this.addChild(this.txtWarning),this.txtWarning.addColor("#93909d",0),this.txtWarning.addFontStyle("italic",0),!0===e.vip?(this.txtWarning.y=(this.positionUserProfile.profile_txt_warning_pending_them.y+12)*window.GameConfig.RESIZE,this.heightGame=515*window.GameConfig.RESIZE):(this.txtWarning.y=this.positionUserProfile.profile_txt_warning_pending_them.y*window.GameConfig.RESIZE,this.heightGame=504*window.GameConfig.RESIZE)),"FRIEND"===n&&(this.hideUnfriend=!0,this.btnHuyKetBan=new ln(this.positionUserProfile.profile_btn_huy_ket_ban,"Hủy kết bạn",this.chooseRemoveFriend,this),this.addChild(this.btnHuyKetBan),this.btnHuyKetBan.kill(),this.btnViewMore=new pt(this.positionUserProfile.profile_btn_view_more,this.onClickViewMore,this),this.addChild(this.btnViewMore),this.btnSendMessage.revive()),"PENDING_YOU"===n&&(this.btnDongYFriend=new ln(this.positionUserProfile.profile_btn_dongy_friend,"ĐỒNG Ý",this.chooseOkFriend,this),this.addChild(this.btnDongYFriend),this.btnHuyBoFriend=new ln(this.positionUserProfile.profile_btn_huybo_friend,"TỪ CHỐI",this.chooseCancle,this),this.addChild(this.btnHuyBoFriend),this.txtWarning=new _t(this.positionUserProfile.profile_txt_warning_pending_you,this.user.user_name+" đã gửi yêu cầu kết bạn."),this.txtWarning.setTextBounds(0,0,game.width,30*window.GameConfig.RESIZE),this.txtWarning.addColor("#ffa33a",0),this.txtWarning.addColor("#93909d",this.user.user_name.length),this.txtWarning.addFontStyle("italic",this.user.user_name.length),this.addChild(this.txtWarning),!0===e.vip?(this.btnDongYFriend.y=(this.positionUserProfile.profile_btn_dongy_friend.y+12)*window.GameConfig.RESIZE,this.btnHuyBoFriend.y=(this.positionUserProfile.profile_btn_huybo_friend.y+12)*window.GameConfig.RESIZE,this.txtWarning.y=(this.positionUserProfile.profile_txt_warning_pending_you.y+12)*window.GameConfig.RESIZE,this.heightGame=622*window.GameConfig.RESIZE):(this.btnDongYFriend.y=this.positionUserProfile.profile_btn_dongy_friend.y*window.GameConfig.RESIZE,this.btnHuyBoFriend.y=this.positionUserProfile.profile_btn_huybo_friend.y*window.GameConfig.RESIZE,this.txtWarning.y=this.positionUserProfile.profile_txt_warning_pending_you.y*window.GameConfig.RESIZE,this.heightGame=610*window.GameConfig.RESIZE))),"NO_GAME"===t||"ARCHIVED"===t?this.btnDuel.setText("THÁCH ĐẤU"):"THEIR_TURN"===t?(this.btnDuel.setText("ĐÃ THÁCH ĐẤU"),this.btnDuel.inputEnabled=!1):"YOUR_TURN"===t&&this.btnDuel.setText("NHẬN THÁCH ĐẤU")}},{key:"onClickViewMore",value:function(){1==this.hideUnfriend?(this.btnHuyKetBan.revive(),this.hideUnfriend=!1):(this.btnHuyKetBan.kill(),this.hideUnfriend=!0)}},{key:"setTextVip",value:function(){this.txtUserName.y=232*window.GameConfig.RESIZE,this.txtLevel.y=267*window.GameConfig.RESIZE}},{key:"addEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this),De.instance().event.backButton.add(this.chooseBack,this)}},{key:"removeEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this),De.instance().event.backButton.remove(this.chooseBack,this)}},{key:"addMe",value:function(e){this.btnMic=new ln(this.positionUserProfile.profile_btn_mic,TF.instance().dataMySeft.support_item),this.addChild(this.btnMic),this.btnDiamond=new ln(this.positionUserProfile.profile_btn_diamond,TF.instance().dataMySeft.diamond),this.addChild(this.btnDiamond),this.btnTicket=new ln(this.positionUserProfile.profile_btn_ticket,TF.instance().dataMySeft.ticket),this.addChild(this.btnTicket),this.txtDescription=new _t(this.positionUserProfile.profile_txt_description_me,this.user.description),this.txtDescription.anchor.set(.5),this.txtDescription.lineSpacing=-5,this.addChild(this.txtDescription),this.heightGame=421*window.GameConfig.RESIZE,this.hideSetting=!0,this.btnSetting=new ln(this.positionUserProfile.profile_btn_huy_ket_ban,"Cài đặt",this.chooseSetting,this),this.addChild(this.btnSetting),this.btnSetting.kill(),this.btnViewSetting=new pt(this.positionUserProfile.profile_btn_view_more,this.onClickViewSetting,this),!1===TF.instance().dataMySeft.is_playing_game&&this.addChild(this.btnViewSetting),this.levelExpCurrent=new Yp(this.current_level.experience_score,this.next_level.experience_score,this.user.experience_score),this.addChild(this.levelExpCurrent),1==e.vip&&(this.btnDiamond.y+=20,this.btnTicket.y+=20,this.btnMic.y+=20)}},{key:"onClickViewSetting",value:function(){1==this.hideSetting?(this.btnSetting.revive(),this.hideSetting=!1):(this.btnSetting.kill(),this.hideSetting=!0)}},{key:"chooseSetting",value:function(){this.btnSetting.kill(),this.hideSetting=!0,IE.instance().addSettingGame()}},{key:"setData",value:function(e,t,n,i,o){LogConsole.log(t,n),this.game_status=t,this.user=Object.assign({},this.user,e),this.txtUserName.text=e.user_name,this.txtLevel.text="LV "+e.level+" - "+e.level_title,e.level>9?this.txtLevel.addColor("#ffffff",5):this.txtLevel.addColor("#ffffff",4),this.current_level=i,this.next_level=o,this.ava.setAvatar(e.avatar),this.urlAvatar=e.avatar,z.instance().userDescription=e.description,this.header.setBg(this.user.vip),!0===e.vip?(this.bgAvaVip.visible=!0,this.bgAva.visible=!1,this.txtUserName.y=(this.positionUserProfile.profile_txt_username.y+12)*window.GameConfig.RESIZE,this.txtLevel.y=(this.positionUserProfile.profile_txt_level.y+12)*window.GameConfig.RESIZE):(this.bgAvaVip.visible=!1,this.bgAva.visible=!0),TF.instance().dataMySeft.user_id==e.id?this.addMe(e):this.addOtherUser(e,t,n)}},{key:"chooseRemoveFriend",value:function(){this.btnHuyKetBan.inputEnabled=!1,TF.instance().sendData(Ps.USER_FRIEND_REQUEST,Rs.begin(Rs.ACTION_REMOVE_FRIEND,this.user.id))}},{key:"chooseOkFriend",value:function(){this.btnDongYFriend.inputEnabled=!1,TF.instance().sendData(Ps.USER_FRIEND_REQUEST,Rs.begin(Rs.ACTION_ACCEPT_ADD_REQUEST,this.user.id))}},{key:"chooseCancle",value:function(){this.btnHuyBoFriend.inputEnabled=!1,TF.instance().sendData(Ps.USER_FRIEND_REQUEST,Rs.begin(Rs.ACTION_REFUSE_ADD_REQUEST,this.user.id))}},{key:"chooseInviteFriend",value:function(){LogConsole.log("chooseInviteFriend"),this.btnInviteFriend.inputEnabled=!1,TF.instance().sendData(Ps.USER_FRIEND_REQUEST,Rs.begin(Rs.ACTION_ADD_FRIEND,this.user.id))}},{key:"chooseSendMessage",value:function(){LogConsole.log("chooseSendMessage"),!0===TF.instance().dataMySeft.is_playing_game?IE.instance().addDialog("Bạn đang chơi game không thể chat."):(z.instance().isGetUserProfileSearch=!1,rF.instance().changeScreen(Ce.MAIN_MENU),li.instance().hideBanner(),IE.instance().addChatScreen(this.user))}},{key:"chooseDuel",value:function(){LogConsole.log("chooseDuel"+this.game_status),!0===TF.instance().dataMySeft.is_playing_game?IE.instance().addDialog("Bạn đang chơi game không thể thách đấu."):(this.chooseBack(),"NO_GAME"==this.game_status?rF.instance().changeScreen(Ce.TURN_BASE,{opponent:{id:this.user.id,userName:this.user.user_name,avatar:this.user.avatar,is_online:this.user.is_online},type:Qp.TYPE_CHALLENGE}):"YOUR_TURN"==this.game_status?rF.instance().changeScreen(Ce.TURN_BASE,{opponent:{id:this.user.id,userName:this.user.user_name,avatar:this.user.avatar,is_online:this.user.is_online},type:Qp.TYPE_BECHALLENGED}):"ARCHIVED"==this.game_status&&Gn.instance().addDialog("Bạn hoặc đối thủ đã ẩn game của nhau. Hãy quay lại thách đấu sau 1 tuần nữa"))}},{key:"onUpdateUserVars",value:function(){TF.instance().dataMySeft.user_id==this.user.id&&(this.txtUserName.setText(TF.instance().dataMySeft.user_name),this.urlAvatar!==TF.instance().dataMySeft.avatar&&this.ava.setAvatar(TF.instance().dataMySeft.avatar),parseInt(this.btnDiamond.lbBtn.text)!==TF.instance().dataMySeft.diamond&&this.btnDiamond.setText(TF.instance().dataMySeft.diamond),parseInt(this.btnMic.lbBtn.text)!==TF.instance().dataMySeft.support_item&&this.btnMic.setText(TF.instance().dataMySeft.support_item),parseInt(this.btnTicket.lbBtn.text)!==TF.instance().dataMySeft.ticket&&this.btnTicket.setText(TF.instance().dataMySeft.ticket))}},{key:"destroy",value:function(){this.removeEventExtension(),this.removeEvent(),this.removeAllItem(),$p(eg(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this.heightGame}}])&&Xp(n.prototype,i),o&&Xp(n,o),t}();function og(e){return(og="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ag(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sg(e){return(sg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rg(e,t){return(rg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var hg=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=sg(t).call(this,game,0,0,""))||"object"!==og(i)&&"function"!=typeof i?lg(n):i).event={BUY:new Phaser.Signal,CHOOSE:new Phaser.Signal},e.data=null,e.positionShop=z.instance().positionDefaultSource,e.bgButton=new pt(e.positionShop.playlist_button_buy,e.chooseItem,lg(lg(e))),e.bgButton.alpha=0,e.bgButton.x=0,e.bgButton.y=0,e.bgButton.width=166*z.instance().scale,e.bgButton.height=260*z.instance().scale,e.addChild(e.bgButton),e.ava=new dh,e.ava.setSize(166*z.instance().scale,166*z.instance().scale),e.addChild(e.ava),e.lbName=new _t(e.positionShop.gennes_text_name_playlist,""),e.lbName.lineSpacing=6,e.lbName.setTextBounds(0,0,166*z.instance().scale,89*z.instance().scale),e.addChild(e.lbName),e.btnBuy=new ln(e.positionShop.playlist_button_buy,"",e.chooseBuy,lg(lg(e))),e.btnBuy.visible=!1,e.addChild(e.btnBuy),e.lbWarning=new _t(e.positionShop.playlist_text_warning,""),e.lbWarning.setTextBounds(0,0,166*z.instance().scale,41*z.instance().scale),e.lbWarning.text="",e.addChild(e.lbWarning),e.addLayout=new Phaser.Sprite(game,0,0,null),e.addLayout.x=6*z.instance().scale,e.addLayout.y=250*z.instance().scale,e.addChild(e.addLayout),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rg(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"chooseItem",value:function(){LogConsole.log("ShopItemPlayList - chooseItem"),this.event.CHOOSE.dispatch(this.data)}},{key:"chooseBuy",value:function(){LogConsole.log("chooseBuy : "+this.parent.x+" --- "+this.parent.y+"this.data  "+this.data.id),this.event.BUY.dispatch(this.data)}},{key:"setData",value:function(e,t){if(this.data=e,null!=e)if(this.addLayout.removeChildren(),this.ava.beginLoad(this.data.thumb,t),this.lbName.text=this.data.name,1==this.data.is_owner){this.btnBuy.visible=!1;var n=new Ch(e.user);this.addLayout.addChild(n)}else this.btnBuy.setText(this.data.price),this.btnBuy.visible=!0}},{key:"getData",value:function(){return this.data}},{key:"destroy",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"width",get:function(){return this.ava.width}},{key:"height",get:function(){return 326*z.instance().scale}}])&&ag(n.prototype,i),o&&ag(n,o),t}();function cg(e){return(cg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ug(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dg(e){return(dg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fg(e,t){return(fg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gg=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=dg(t).call(this,game,0,0,null))||"object"!==cg(i)&&"function"!=typeof i?pg(n):i).event={view_all:new Phaser.Signal},e.positionUserProfile=JSON.parse(game.cache.getText("positionUserProfile")),e.txtPlayList=new _t(e.positionUserProfile.playlist_txt_playlist,"Playlist (0)"),e.txtPlayList.setTextBounds(0,0,237*window.GameConfig.RESIZE,35*window.GameConfig.RESIZE),e.addChild(e.txtPlayList),e.txtViewAll=new _t(e.positionUserProfile.playlist_txt_xemtatca,"Xem tất cả"),e.txtViewAll.setTextBounds(0,0,191*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtViewAll),e.btnViewAll=new pt(e.positionUserProfile.playlist_line_select,e.chooseViewAll,pg(pg(e))),e.btnViewAll.x=e.txtViewAll.x,e.btnViewAll.y=e.txtViewAll.y,e.btnViewAll.width=191*window.GameConfig.RESIZE,e.btnViewAll.height=30*window.GameConfig.RESIZE,e.btnViewAll.alpha=0,e.addChild(e.btnViewAll),e.line=new rt(e.positionUserProfile.playlist_line),e.addChild(e.line),e.lineActive=new rt(e.positionUserProfile.playlist_line_select),e.addChild(e.lineActive),e.addPlayList=new Phaser.Sprite(game,0,0,null),e.addChild(e.addPlayList),e.heightGame=89*window.GameConfig.RESIZE,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fg(e,t)}(t,Mt),n=t,(i=[{key:"chooseViewAll",value:function(){this.event.view_all.dispatch()}},{key:"setData",value:function(e){for(;this.addPlayList.children.length>0;){var t=this.addPlayList.children[0];this.addPlayList.removeChild(t),t.destroy(),t=null}this.txtPlayList.text="Playlist("+e+")"}},{key:"choosePlaylist",value:function(e){IE.instance().addPlaylistDetail(e.id)}},{key:"height",get:function(){return this.heightGame}},{key:"width",get:function(){return game.width}}])&&ug(n.prototype,i),o&&ug(n,o),t}();var yg=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reward=0,this.condition="",this.achievement_type_id=0,this.is_done=!1,this.reward_type="",this.medal="",this.achieved=0,this.id=0,this.title="",this.required=0};function mg(e){return(mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wg(e,t){return!t||"object"!==mg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bg(e,t,n){return(bg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_g(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _g(e){return(_g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sg(e,t){return(Sg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Eg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=wg(this,_g(t).call(this,game,0,0,null))).idRemove=null,e.positionUserProfile=e.mainData.positionUserProfile,e.data=new yg,e.ava=new pc,e.ava.setSize(118*window.GameConfig.RESIZE,118*window.GameConfig.RESIZE),e.addChild(e.ava),e.txtName=new _t(e.positionUserProfile.achievement_txt_name,"hahah ahha ha hah ah ha hah ah ha hah"),e.txtName.setTextBounds(0,0,118*window.GameConfig.RESIZE,47*window.GameConfig.RESIZE),e.addChild(e.txtName),e.iconAchiment=new Phaser.Sprite(game,0,0,"EffectAchiment"),e.iconAchiment.x=e.ava.x+(e.ava.width-e.iconAchiment.width)/2,e.iconAchiment.y=e.ava.y+(e.ava.height-e.iconAchiment.height)/2,e.iconAchiment.smoothed=!0,e.iconAchiment.animations.add("EffectAchiment"),e.addChild(e.iconAchiment),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sg(e,t)}(t,Mt),n=t,(i=[{key:"removeDelayCall",value:function(){null!==this.idRemove&&game.time.events.remove(this.idRemove)}},{key:"setData",value:function(e,t){this.data=Object.assign({},this.data,e),this.ava.setAvatar(this.data.medal,t),this.txtName.text=this.data.title,console.log("idx : "+t);var n=.5+.5*t;console.log("time ------ : "+n),this.removeDelayCall(),this.idRemove=game.time.events.add(Phaser.Timer.SECOND*n,this.playSpriteSheet,this)}},{key:"playSpriteSheet",value:function(){console.log("playSpriteSheet---------------"),this.iconAchiment.animations.play("EffectAchiment",60)}},{key:"destroy",value:function(){this.removeDelayCall(),bg(_g(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return 118*window.GameConfig.RESIZE}},{key:"height",get:function(){return 178*window.GameConfig.RESIZE}}])&&vg(n.prototype,i),o&&vg(n,o),t}();function Cg(e){return(Cg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pg(e){return(Pg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Og(e,t){return(Og=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var xg=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Pg(t).call(this,game,0,0,null))||"object"!==Cg(i)&&"function"!=typeof i?Rg(n):i).event={view_all:new Phaser.Signal},e.positionUserProfile=e.mainData.positionUserProfile,e.txtPlayList=new _t(e.positionUserProfile.playlist_txt_playlist,"Huy chương (0)"),e.txtPlayList.setTextBounds(0,0,237*window.GameConfig.RESIZE,35*window.GameConfig.RESIZE),e.addChild(e.txtPlayList),e.txtViewAll=new _t(e.positionUserProfile.playlist_txt_xemtatca,"Xem tất cả"),e.txtViewAll.setTextBounds(0,0,191*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtViewAll),e.btnViewAll=new pt(e.positionUserProfile.playlist_line_select,e.chooseViewAll,Rg(Rg(e))),e.btnViewAll.x=e.txtViewAll.x,e.btnViewAll.y=e.txtViewAll.y,e.btnViewAll.width=191*window.GameConfig.RESIZE,e.btnViewAll.height=30*window.GameConfig.RESIZE,e.btnViewAll.alpha=0,e.addChild(e.btnViewAll),e.line=new rt(e.positionUserProfile.playlist_line),e.addChild(e.line),e.lineActive=new rt(e.positionUserProfile.playlist_line_select),e.addChild(e.lineActive),e.addAchi=new Phaser.Sprite(game,0,0,null),e.addChild(e.addAchi),e.heightGame=89*window.GameConfig.RESIZE,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Og(e,t)}(t,Mt),n=t,(i=[{key:"chooseViewAll",value:function(){this.event.view_all.dispatch()}},{key:"setData",value:function(e){for(;this.addAchi.children.length>0;){var t=this.addAchi.children[0];this.addAchi.removeChild(t),t.destroy(),t=null}this.txtPlayList.text="Huy chương ("+e+")"}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this.heightGame}}])&&kg(n.prototype,i),o&&kg(n,o),t}();function Tg(e){return(Tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ig(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ag(e){return(Ag=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lg(e,t){return(Lg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gg(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Dg=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Ag(t).call(this,game,0,0,null))||"object"!==Tg(i)&&"function"!=typeof i?Gg(n):i).event={view_all:new Phaser.Signal},e.positionUserProfile=e.mainData.positionUserProfile,e.txtPlayList=new _t(e.positionUserProfile.playlist_txt_playlist,"Danh sách bạn bè (0)"),e.txtPlayList.setTextBounds(0,0,237*window.GameConfig.RESIZE,35*window.GameConfig.RESIZE),e.addChild(e.txtPlayList),e.txtViewAll=new _t(e.positionUserProfile.playlist_txt_xemtatca,"Xem tất cả"),e.txtViewAll.setTextBounds(0,0,191*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtViewAll),e.btnViewAll=new pt(e.positionUserProfile.playlist_line_select,e.chooseViewAll,Gg(Gg(e))),e.btnViewAll.x=e.txtViewAll.x,e.btnViewAll.y=e.txtViewAll.y,e.btnViewAll.width=191*window.GameConfig.RESIZE,e.btnViewAll.height=30*window.GameConfig.RESIZE,e.btnViewAll.alpha=0,e.addChild(e.btnViewAll),e.line=new rt(e.positionUserProfile.playlist_line),e.addChild(e.line),e.lineActive=new rt(e.positionUserProfile.playlist_line_select),e.addChild(e.lineActive),e.addAchi=new Phaser.Sprite(game,0,0,null),e.addChild(e.addAchi),e.heightGame=89*window.GameConfig.RESIZE,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lg(e,t)}(t,Mt),n=t,(i=[{key:"chooseViewAll",value:function(){this.event.view_all.dispatch()}},{key:"setData",value:function(e){for(;this.addAchi.children.length>0;){var t=this.addAchi.children[0];this.addAchi.removeChild(t),t.destroy(),t=null}this.txtPlayList.text="Bạn bè ("+e+")"}},{key:"height",get:function(){return this.heightGame}},{key:"width",get:function(){return game.width}}])&&Ig(n.prototype,i),o&&Ig(n,o),t}();function Mg(e){return(Mg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ng(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bg(e,t){return!t||"object"!==Mg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jg(e){return(jg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ug(e,t){return(Ug=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Bg(this,jg(t).call(this,game,0,0,null))).positionUserProfile=e.mainData.positionUserProfile,e.txtPlayList=new _t(e.positionUserProfile.playlist_txt_playlist,"Điểm số cao nhất"),e.txtPlayList.setTextBounds(0,0,237*window.GameConfig.RESIZE,35*window.GameConfig.RESIZE),e.addChild(e.txtPlayList),e.line=new rt(e.positionUserProfile.playlist_line),e.addChild(e.line),e.lineActive=new rt(e.positionUserProfile.playlist_line_select),e.addChild(e.lineActive),e.lbMonth=new _t(e.positionUserProfile.maxscore_label_month,"Tuần"),e.lbMonth.setTextBounds(0,0,255*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.lbMonth),e.lbAll=new _t(e.positionUserProfile.maxscore_label_all,"Toàn bộ thời gian"),e.lbAll.setTextBounds(0,0,255*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.lbAll),e.txtScoreMonth=new _t(e.positionUserProfile.maxscore_txt_month,"0"),e.txtScoreMonth.setTextBounds(0,0,255*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtScoreMonth),e.txtScoreAll=new _t(e.positionUserProfile.maxscore_txt_all,"0"),e.txtScoreAll.setTextBounds(0,0,255*window.GameConfig.RESIZE,30*window.GameConfig.RESIZE),e.addChild(e.txtScoreAll),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ug(e,t)}(t,Mt),n=t,(i=[{key:"setData",value:function(e,t){this.txtScoreMonth.text=e,this.txtScoreAll.text=t}},{key:"height",get:function(){return 225*window.GameConfig.RESIZE}},{key:"width",get:function(){return game.width}}])&&Ng(n.prototype,i),o&&Ng(n,o),t}();function Zg(e){return(Zg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Qg(e,t){return!t||"object"!==Zg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vg(e,t,n){return(Vg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Wg(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Wg(e){return(Wg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qg(e,t){return(qg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Kg=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Qg(this,Wg(t).call(this,game,0,0,null))).dataProfile=null,e.event={view_all_playlist:new Phaser.Signal,view_all_friend:new Phaser.Signal,view_all_achievement:new Phaser.Signal,back:new Phaser.Signal},e.list=null,e.userProfile=null,e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),li.instance().showBanerUserProfileScreen(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qg(e,t)}(t,Mt),n=t,(i=[{key:"setData",value:function(e){null!==this.list&&(this.list.removeAll(),this.list.destroy(),this.list=null),this.dataProfile=e,null!==this.userProfile&&(this.removeChild(this.userProfile),this.userProfile.destroy(),this.userProfile=null),this.userProfile=new ig,this.userProfile.event.back.add(this.chooseBack,this),this.addChild(this.userProfile),this.userProfile.setData(this.dataProfile.user,this.dataProfile.game_status,this.dataProfile.friend_status,this.dataProfile.current_level,this.dataProfile.next_level);var t=new Phaser.Group(game,0,0,null);this.list=new Vo(game,t,new Phaser.Rectangle(0,this.userProfile.height+20,game.width,(game.height-this.userProfile.height)*window.GameConfig.RESIZE),{direction:"y",padding:0,searchForClicks:!0}),this.addChild(t),this.playList=new gg,this.playList.event.view_all.add(this.viewAllPlaylist,this),this.playList.setData(this.dataProfile.number_of_playlist),this.list.add(this.playList),this.achievement=new xg,this.achievement.event.view_all.add(this.viewAllAchievement,this),this.achievement.setData(this.dataProfile.number_achievement),this.list.add(this.achievement),this.friends=new Dg,this.friends.event.view_all.add(this.viewAllFriend,this),this.friends.setData(this.dataProfile.count_friend),this.list.add(this.friends),this.maxScore=new Fg,this.maxScore.setData(this.dataProfile.user.weekly_high_score,this.dataProfile.user.all_time_high_score),this.list.add(this.maxScore)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.list.removeAll(),this.list.destroy(),this.removeAllItem(),li.instance().hideBanner(),Vg(Wg(t.prototype),"destroy",this).call(this)}},{key:"viewAllPlaylist",value:function(){this.event.view_all_playlist.dispatch()}},{key:"viewAllAchievement",value:function(){this.event.view_all_achievement.dispatch()}},{key:"viewAllFriend",value:function(){this.event.view_all_friend.dispatch()}}])&&Hg(n.prototype,i),o&&Hg(n,o),t}();function zg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Yg=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("user_id",e),t}}],(n=null)&&zg(t.prototype,n),i&&zg(t,i),e}();function Jg(e){return(Jg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xg(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $g(e,t){return!t||"object"!==Jg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ey(e){return(ey=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ty(e,t){return(ty=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ny=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$g(this,ey(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ty(e,t)}(t,Mt),n=t,(i=[{key:"init",value:function(){}},{key:"afterCreate",value:function(){this.columnNumber=0,this.rowNumber=0,this.viewWidth=0,this.viewHeight=0,this.leftDistance=0,this.distanceBetweenColumns=0,this.distanceBetweenRows=0}},{key:"setViewList",value:function(e){for(var t=0;t<e.length;t++){t%this.columnNumber==0?e[t].x=this.leftDistance:e[t].x=e[t-1].x+e[t-1].width+this.distanceBetweenColumns;var n=Math.floor(t/this.columnNumber);e[t].y=0===n?0:e[t-this.columnNumber].y+e[t-this.columnNumber].height+this.distanceBetweenRows,this.addChild(e[t])}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"height",get:function(){return this.viewHeight}},{key:"width",get:function(){return this.viewWidth}}])&&Xg(n.prototype,i),o&&Xg(n,o),t}();function iy(e){return(iy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ay(e,t,n){return(ay="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sy(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sy(e){return(sy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ry(e,t){return(ry=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ly(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var hy=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=sy(t).call(this,game,0,0,null))||"object"!==iy(o)&&"function"!=typeof o?ly(i):o).event={changeIndex:new Phaser.Signal},e&&(n.columnNumber=e.column,n.viewWidth=e.width,n.viewHeight=e.height,n.rowHeight=e.rowHeight,n.leftDistance=e.leftDistance,n.direction=e.direction,n.distanceBetweenColumns=e.distanceBetweenColumns,n.distanceBetweenRows=e.distanceBetweenRows),n.idDelay=null,n.idx=0,n.countItem=0,n.list=[];var a=new Phaser.Group(game),s=new Phaser.Rectangle(0,0,n.viewWidth,n.viewHeight);return n.scroll=new Vo(n.game,a,s,{direction:n.direction,searchForClicks:!0,padding:n.distanceBetweenRows}),n.scroll.events.changeIndex.add(n.changeIndex,ly(ly(n))),n.addChild(a),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ry(e,t)}(t,Mt),n=t,(i=[{key:"changeIndex",value:function(){this.event.changeIndex.dispatch(this.scroll.getIdx())}},{key:"buildListItem",value:function(){for(var e,t=this.idx;t<this.list.length;t++){if(t%this.columnNumber==0&&(e=[]),e.push(this.list[t]),this.idx++,e.length===this.columnNumber||t===this.list.length-1){var n=new ny;n.columnNumber=this.columnNumber,n.rowNumber=1,n.viewWidth=this.viewWidth,n.viewHeight=this.rowHeight,n.leftDistance=this.leftDistance,n.distanceBetweenColumns=this.distanceBetweenColumns,n.distanceBetweenRows=this.distanceBetweenRows,n.setViewList(e),this.countItem++,this.scroll.add(n)}}}},{key:"addItem",value:function(e){var t=new ny;t.columnNumber=this.columnNumber,t.rowNumber=1,t.viewWidth=this.viewWidth,t.viewHeight=this.rowHeight,t.leftDistance=this.leftDistance,t.distanceBetweenColumns=this.distanceBetweenColumns,t.distanceBetweenRows=this.distanceBetweenRows,t.setViewList(e),this.scroll.add(t)}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){if(this.removeDelayBuild(),this.scroll.removeAll(),this.scroll.destroy(),this.removeAllItem(),this.parent){var e=this;this.parent.removeChild(e),e.destroy(),e=null}ay(sy(t.prototype),"destroy",this).call(this)}},{key:"viewList",set:function(e){this.scroll.removeAll(),this.scroll.reset(),this.idx=0,this.countItem=0,this.list=e,this.list.length>0&&(this.removeDelayBuild(),this.idDelay=game.time.events.add(.3*Phaser.Timer.SECOND,this.buildListItem,this))}}])&&oy(n.prototype,i),o&&oy(n,o),t}();function cy(e){return(cy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dy(e){return(dy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fy(e,t){return(fy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function py(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gy=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=dy(t).call(this,game,0,0,null))||"object"!==cy(o)&&"function"!=typeof o?py(i):o).user_id=e,qe.instance().showLoading(),n.event={back:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg);var a={column:3,width:game.width,height:game.height-160*window.GameConfig.RESIZE,rowHeight:326*window.GameConfig.RESIZE,leftDistance:35*window.GameConfig.RESIZE,direction:"y",distanceBetweenColumns:35*window.GameConfig.RESIZE,distanceBetweenRows:35*window.GameConfig.RESIZE};return n.scroll=new hy(a),n.scroll.y=148*window.GameConfig.RESIZE,n.addChild(n.scroll),n.header=new Qa,n.header.event.back.add(n.chooseBack,py(py(n))),n.header.setBg(!1),n.header.setTitle("Playlist"),n.addChild(n.header),!0===Ur.instance().ktLoadPlaylist?n.buildDataPlaylistUser():(Ur.instance().event.load_playlist_complete.add(n.buildDataPlaylistUser,py(py(n))),Ur.instance().sendGetDataShop()),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fy(e,t)}(t,Mt),n=t,(i=[{key:"buildDataPlaylistUser",value:function(){this.user_id===TF.instance().dataMySeft.user_id?(this.setPlaylist(Ur.instance().playlist.getArrMe()),qe.instance().hideLoading()):TF.instance().sendData(Ps.USER_DETAIL_PLAYLIST_LOAD_REQUEST,Yg.begin(this.user_id))}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"setPlaylist",value:function(e){var t=[];LogConsole.log("playlists -----------");for(var n=0;n<e.length;n++){var i=new hg;i.event.CHOOSE.add(this.choosePlaylist,this),i.setData(e[n],n),t.push(i)}this.scroll.viewList=t}},{key:"choosePlaylist",value:function(e){IE.instance().addPlaylistDetail(e.id)}},{key:"destroy",value:function(){Ur.instance().event.load_playlist_complete.remove(this.buildDataPlaylistUser,this),this.scroll.destroy(),this.removeAllItem()}}])&&uy(n.prototype,i),o&&uy(n,o),t}();function yy(e){return(yy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function my(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vy(e){return(vy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wy(e,t){return(wy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function by(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var _y=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,n=!(o=vy(t).call(this,game,0,0,null))||"object"!==yy(o)&&"function"!=typeof o?by(i):o,qe.instance().showLoading(),n.event={back:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg);var a={column:4,width:game.width,height:game.height-160*window.GameConfig.RESIZE,rowHeight:178*window.GameConfig.RESIZE,leftDistance:35*window.GameConfig.RESIZE,direction:"y",distanceBetweenColumns:32*window.GameConfig.RESIZE,distanceBetweenRows:32*window.GameConfig.RESIZE};return n.scroll=new hy(a),n.scroll.y=148*window.GameConfig.RESIZE,n.addChild(n.scroll),n.header=new Qa,n.header.event.back.add(n.chooseBack,by(by(n))),n.header.setBg(!1),n.header.setTitle("Huy chương"),n.addChild(n.header),TF.instance().sendData(Ps.USER_DETAIL_ACHIEVEMENT_LOAD_REQUEST,Yg.begin(e)),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wy(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"setAchievement",value:function(e){var t=[];LogConsole.log("playlists -----------");for(var n=0;n<e.length;n++){var i=new Eg;i.setData(e[n],n),t.push(i)}this.scroll.viewList=t}},{key:"destroy",value:function(){this.scroll.destroy(),this.removeAllItem()}}])&&my(n.prototype,i),o&&my(n,o),t}();function Sy(e){return(Sy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ey(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cy(e,t){return!t||"object"!==Sy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ky(e){return(ky=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Py(e,t){return(Py=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Oy=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Cy(this,ky(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Py(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.positionCreateRoom=this.mainData.positionDefaultSource,this.event={invite:new Phaser.Signal},this.data=new ua,this.ava=new pc,this.ava.inputEnabled=!0,this.ava.events.onInputDown.add(this.chooseInfo,this),this.ava.setSize(68*z.instance().scale,68*z.instance().scale),this.ava.x=36*z.instance().scale,this.ava.y=27*z.instance().scale,this.addChild(this.ava),this.txtName=new _t(this.positionCreateRoom.listfriend_txt_name,"Viet PV"),this.addChild(this.txtName),this.btnInvite=new ln(this.positionCreateRoom.listfriend_btn_invite,"MỜI",this.chooseInvite,this),this.addChild(this.btnInvite),this.inviteDone=new rt(this.positionCreateRoom.friend_invite_done),this.inviteDone.x=this.btnInvite.x+(this.btnInvite.width-this.inviteDone.width)/2,this.inviteDone.y=this.btnInvite.y+(this.btnInvite.height-this.inviteDone.height)/2,this.inviteDone.visible=!1,this.addChild(this.inviteDone),this.iconOnline=new rt(this.positionCreateRoom.listfriend_icon_online),this.iconOnline.visible=!1,this.addChild(this.iconOnline),this.iconOffline=new rt(this.positionCreateRoom.listfriend_icon_offline),this.addChild(this.iconOffline),this.line=new rt(this.positionCreateRoom.listfriend_bg_line),this.addChild(this.line)}},{key:"chooseInfo",value:function(e,t,n){n&&IE.instance().addUserProfile(this.data.userId)}},{key:"setData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];LogConsole.log(e),this.data=Object.assign({},this.data,e),this.txtName.text=this.data.userName,!0===n?(this.data.isOnline?(this.iconOnline.visible=!0,this.iconOffline.visible=!1):(this.iconOnline.visible=!1,this.iconOffline.visible=!0),this.btnInvite.visible=!1):this.data.isOnline?(this.iconOnline.visible=!0,this.iconOffline.visible=!1,this.btnInvite.visible=!0):(this.iconOnline.visible=!1,this.iconOffline.visible=!0,this.btnInvite.visible=!1),this.ava.setAvatar(this.data.avatar,t),this.x=game.width,game.add.tween(this).to({x:0},150,Phaser.Easing.Power1,!0,80*(t+1))}},{key:"chooseInvite",value:function(){LogConsole.log("chooseInvite"),this.btnInvite.visible=!1,this.inviteDone.visible=!0,this.event.invite.dispatch(this.data)}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return 110*z.instance().scale}}])&&Ey(n.prototype,i),o&&Ey(n,o),t}();function Ry(e){return(Ry="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ty(e){return(Ty=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Iy(e,t){return(Iy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ay(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ly=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,n=!(o=Ty(t).call(this,game,0,0,null))||"object"!==Ry(o)&&"function"!=typeof o?Ay(i):o,qe.instance().showLoading(),n.event={back:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg);var a=new Phaser.Group(game,0,0,null);return n.listFriends=new Vo(game,a,new Phaser.Rectangle(0,0,game.width,game.height-100*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),a.x=0,a.y=100*z.instance().scale,n.addChild(a),n.header=new Qa,n.header.event.back.add(n.chooseBack,Ay(Ay(n))),n.header.setBg(!1),n.header.setTitle("Bạn bè"),n.addChild(n.header),li.instance().showBanerViewAllFriendScreen(),TF.instance().sendData(Ps.USER_FRIEND_LIST_LOAD_REQUEST,Yg.begin(e)),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iy(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"setFriend",value:function(e){LogConsole.log("playlists -----------");for(var t=0;t<e.length;t++){var n=new Oy;n.setData(e[t],t,!0),this.listFriends.add(n)}}},{key:"destroy",value:function(){li.instance().hideBanner(),this.listFriends.removeAll(),this.listFriends.destroy(),this.removeAllItem()}}])&&xy(n.prototype,i),o&&xy(n,o),t}();function Gy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Dy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t={game_status:"",friend_status:"",number_achievement:0,its_me:!1,user:{level:0,level_title:"",user_name:"",all_time_high_score:0,last_login:0,weekly_high_score:0,description:"",id:0,avatar:"",is_online:!1,experience_score:0},number_of_playlist:0,count_friend:0,next_level:{level:0,id:0,experience_score:0},current_level:{level:0,id:0,experience_score:0}};if(!0===e.getBool("its_me")){var n=TF.instance().dataMySeft;t.user.level=n.level,t.user.level_title=e.getUtfString("level_title"),t.user.user_name=n.user_name,t.user.all_time_high_score=n.all_time_high_score,t.user.weekly_high_score=n.weekly_high_score,t.user.description=n.description,t.user.id=n.user_id,t.user.avatar=n.avatar,t.user.experience_score=n.experience_score;var i=e.getSFSObject("current_level");t.current_level.level=i.getInt("level"),t.current_level.id=i.getInt("id"),t.current_level.experience_score=i.getInt("experience_score");var o=e.getSFSObject("next_level");t.next_level.level=o.getInt("level"),t.next_level.id=o.getInt("id"),t.next_level.experience_score=o.getInt("experience_score")}else{t.game_status=e.getUtfString("game_status"),t.friend_status=e.getUtfString("friend_status");var a=e.getSFSObject("user");t.user.level=a.getInt("level"),t.user.level_title=a.getUtfString("level_title"),t.user.user_name=a.getUtfString("user_name"),t.user.all_time_high_score=a.getInt("all_time_high_score"),t.user.last_login=a.getLong("last_login"),t.user.weekly_high_score=a.getInt("weekly_high_score"),t.user.description=a.getUtfString("description"),t.user.id=a.getInt("id"),t.user.avatar=a.getUtfString("avatar"),t.user.is_online=a.getBool("is_online"),t.user.experience_score=a.getInt("experience_score")}return t.number_achievement=e.getInt("number_achievement"),t.number_of_playlist=e.getInt("number_of_playlist"),t.count_friend=e.getInt("count_friend"),t}}],(n=null)&&Gy(t.prototype,n),i&&Gy(t,i),e}();function My(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ny=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=[],n=e.getSFSArray("playlists"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=Ur.instance().playlist.getPlayListById(o.getInt("playlist_id"));null!==a&&(console.log(a),a.user.level=o.getInt("level"),a.user.exp_score=o.getInt("exp_score"),a.user.current_level_score=o.getInt("current_level_score"),a.user.next_level_score=o.getInt("next_level_score"),a.user.updated=o.getLong("updated"),a.is_owner=1,t.push(a))}return t}}],(n=null)&&My(t.prototype,n),i&&My(t,i),e}();function By(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"achievements",get:function(){return"achievements"}},{key:"reward",get:function(){return"reward"}},{key:"condition",get:function(){return"condition"}},{key:"achievement_type_id",get:function(){return"achievement_type_id"}},{key:"is_done",get:function(){return"is_done"}},{key:"reward_type",get:function(){return"reward_type"}},{key:"medal",get:function(){return"medal"}},{key:"achieved",get:function(){return"achieved"}},{key:"description",get:function(){return"description"}},{key:"id",get:function(){return"id"}},{key:"title",get:function(){return"title"}},{key:"required",get:function(){return"required"}},{key:"playlists",get:function(){return"playlists"}},{key:"is_highlight",get:function(){return"is_highlight"}},{key:"used_times",get:function(){return"used_times"}},{key:"thumb",get:function(){return"thumb"}},{key:"created",get:function(){return"created"}},{key:"is_owner",get:function(){return"is_owner"}},{key:"is_default",get:function(){return"is_default"}},{key:"genre_id",get:function(){return"genre_id"}},{key:"price",get:function(){return"price"}},{key:"is_general",get:function(){return"is_general"}},{key:"name",get:function(){return"name"}},{key:"purchased_count",get:function(){return"purchased_count"}},{key:"vip",get:function(){return"vip"}},{key:"is_solo_mode",get:function(){return"is_solo_mode"}},{key:"updated",get:function(){return"updated"}},{key:"user_playlist_mapping",get:function(){return"user_playlist_mapping"}},{key:"user_id",get:function(){return"user_id"}},{key:"level",get:function(){return"level"}},{key:"playlist_id",get:function(){return"playlist_id"}},{key:"exp_score",get:function(){return"exp_score"}},{key:"active",get:function(){return"active"}},{key:"current_level_score",get:function(){return"current_level_score"}},{key:"next_level_score",get:function(){return"next_level_score"}},{key:"master",get:function(){return"master"}},{key:"gender",get:function(){return"gender"}},{key:"user_name",get:function(){return"user_name"}},{key:"all_time_high_score",get:function(){return"all_time_high_score"}},{key:"last_login",get:function(){return"last_login"}},{key:"weekly_high_score",get:function(){return"weekly_high_score"}},{key:"avatar",get:function(){return"avatar"}},{key:"is_online",get:function(){return"is_online"}},{key:"user",get:function(){return"user"}},{key:"friends",get:function(){return"friends"}},{key:"game_status",get:function(){return"game_status"}},{key:"friend_status",get:function(){return"friend_status"}},{key:"support_item",get:function(){return"support_item"}},{key:"level_title",get:function(){return"level_title"}},{key:"next_level",get:function(){return"next_level"}},{key:"current_level",get:function(){return"current_level"}},{key:"experience_score",get:function(){return"experience_score"}}],(n=null)&&By(t.prototype,n),i&&By(t,i),e}();function Uy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Fy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=[],n=e.getSFSArray(jy.achievements),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new yg;a.reward=o.getInt(jy.reward),a.condition=o.getUtfString(jy.condition),a.achievement_type_id=o.getInt(jy.achievement_type_id),a.is_done=o.getBool(jy.is_done),a.reward_type=o.getUtfString(jy.reward_type),a.medal=o.getUtfString(jy.medal),a.achieved=o.getInt(jy.achieved),a.id=o.getInt(jy.id),a.title=o.getUtfString(jy.title),a.required=o.getInt(jy.required),t.push(a)}return t}}],(n=null)&&Uy(t.prototype,n),i&&Uy(t,i),e}();function Zy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Hy=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=[],n=e.getSFSArray(jy.friends),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new ua;a.avatar=o.getUtfString(jy.avatar),a.isOnline=o.getBool(jy.is_online),a.userId=o.getInt(jy.id),a.userName=o.getUtfString(jy.user_name),t.push(a)}return t}}],(n=null)&&Zy(t.prototype,n),i&&Zy(t,i),e}();function Qy(e){return(Qy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vy(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wy(e,t){return!t||"object"!==Qy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qy(e,t,n){return(qy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ky(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ky(e){return(Ky=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zy(e,t){return(zy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yy=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Wy(this,Ky(t).call(this,game,0,0,null,null))).arrResource=[],e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zy(e,t)}(t,Mt),n=t,(i=[{key:"loadResource",value:function(){for(var e=0;e<this.arrResource.length;e++){console.log(this.arrResource[e]);var t=this.arrResource[e],n=t.type,i=t.link+"?v=".concat(window.VersionClient),o=t.key;switch(n){case"text":game.load.text(o,i);break;case"image":game.load.image(o,i);break;case"atlas":var a=t.linkJson+"?v=".concat(window.VersionClient);game.load.atlas(o,i,a,Phaser.Loader.TEXTURE_ATLAS_JSON_HASH);break;case"spritesheet":var s=t.width,r=t.height,l=t.countFrame;game.load.spritesheet(o,i,s,r,l)}}game.load.onLoadComplete.add(this.loadDataFileComplete,this),game.load.start()}},{key:"loadDataFileComplete",value:function(){console.log("loadDataFileComplete----------"),game.load.onLoadComplete.remove(this.loadDataFileComplete,this),this.loadFileComplete()}},{key:"loadFileComplete",value:function(){}},{key:"removeResource",value:function(){console.log("removeResource--------------");for(var e=0;e<this.arrResource.length;e++){var t=this.arrResource[e],n=t.type,i=t.key;switch(n){case"text":game.cache.checkTextKey(i)&&game.cache.removeText(i);break;case"image":game.cache.checkImageKey(i)&&game.cache.removeImage(i);break;case"atlas":game.cache.checkImageKey(i)&&game.cache.removeImage(i);var o=t.linkJson+"?v=".concat(window.VersionClient);game.cache.checkJSONKey(o)&&game.cache.removeJSON(o),game.cache.checkXMLKey(o)&&game.cache.removeXML(o);break;case"spritesheet":game.cache.checkImageKey(i)&&game.cache.removeImage(i)}}}},{key:"destroy",value:function(){this.removeResource(),qy(Ky(t.prototype),"destroy",this).call(this)}}])&&Vy(n.prototype,i),o&&Vy(n,o),t}();function Jy(e){return(Jy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xy(e,t){return!t||"object"!==Jy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $y(e,t,n){return($y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=em(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function em(e){return(em=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nm(e,t,n){return t&&tm(e.prototype,t),n&&tm(e,n),e}function im(e,t){return(im=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var om=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Xy(this,em(t).call(this,game,0,0,null))).event={back:new Phaser.Signal},LogConsole.log("user_id : "+e),n.screenIdx=i,n.user_id=e,n.userProfile=null,n.allPlaylist=null,n.allAchievement=null,n.allFriend=null,n.dataProfile=null,n.arrResource=[{type:"atlas",link:"img/atlas/userprofile.png",key:"userprofile",linkJson:"img/atlas/userprofile.json"}],n.loadResource(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&im(e,t)}(t,Yy),nm(t,null,[{key:"SCREEN_PROFILE",get:function(){return 0}},{key:"SCREEN_PLAYLIST",get:function(){return 1}},{key:"SCREEN_ACHIEVEMENT",get:function(){return 2}},{key:"SCREEN_FRIEND",get:function(){return 3}}]),nm(t,[{key:"loadFileComplete",value:function(){switch($y(em(t.prototype),"loadFileComplete",this).call(this),this.screenIdx){case t.SCREEN_PROFILE:this.addUserProfile();break;case t.SCREEN_ACHIEVEMENT:this.addAllAchievement();break;case t.SCREEN_PLAYLIST:this.addAllPlaylist();break;case t.SCREEN_FRIEND:this.addAllFriend()}this.addEvent()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),qe.instance().showLoading(),this.updateDescription(),De.instance().event.updateDescription.add(this.updateDescription,this)}},{key:"updateDescription",value:function(){TF.instance().sendData(Ps.USER_DETAIL_LOAD_REQUEST,Yg.begin(this.user_id))}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),De.instance().event.updateDescription.remove(this.updateDescription,this)}},{key:"getData",value:function(e){switch(e.cmd){case Ps.USER_DETAIL_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")?(this.dataProfile=Dy.begin(e.params),null!==this.userProfile&&this.userProfile.setData(this.dataProfile)):this.chooseBackUser(),qe.instance().hideLoading();break;case Ps.USER_FRIEND_RESPONSE:case Ps.USER_FRIEND_REQUEST:this.updateDescription();break;case Ps.USER_DETAIL_PLAYLIST_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&null!==this.allPlaylist?this.allPlaylist.setPlaylist(Ny.begin(e.params)):this.chooseBack(),qe.instance().hideLoading();break;case Ps.USER_DETAIL_ACHIEVEMENT_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&null!==this.allAchievement?this.allAchievement.setAchievement(Fy.begin(e.params)):this.chooseBack(),qe.instance().hideLoading();break;case Ps.USER_FRIEND_LIST_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&null!==this.allFriend?this.allFriend.setFriend(Hy.begin(e.params)):this.chooseBack(),qe.instance().hideLoading()}}},{key:"removeAllScreen",value:function(){this.removeUserProfile(),this.removeAllPlaylist(),this.removeAllAchievement(),this.removeAllFriend()}},{key:"addUserProfile",value:function(){this.removeAllScreen(),this.userProfile=new Kg,this.userProfile.event.back.add(this.chooseBackUser,this),this.userProfile.event.view_all_achievement.add(this.addAllAchievement,this),this.userProfile.event.view_all_friend.add(this.addAllFriend,this),this.userProfile.event.view_all_playlist.add(this.addAllPlaylist,this),null!==this.dataProfile&&this.userProfile.setData(this.dataProfile),this.addChild(this.userProfile)}},{key:"removeUserProfile",value:function(){null!==this.userProfile&&(this.removeChild(this.userProfile),this.userProfile.destroy(),this.userProfile=null)}},{key:"addAllPlaylist",value:function(){this.removeAllScreen(),this.allPlaylist=new gy(this.user_id),this.allPlaylist.event.back.add(this.chooseBack,this),this.addChild(this.allPlaylist)}},{key:"removeAllPlaylist",value:function(){null!==this.allPlaylist&&(this.removeChild(this.allPlaylist),this.allPlaylist.destroy(),this.allPlaylist=null)}},{key:"addAllAchievement",value:function(){this.removeAllScreen(),this.allAchievement=new _y(this.user_id),this.allAchievement.event.back.add(this.chooseBack,this),this.addChild(this.allAchievement)}},{key:"removeAllAchievement",value:function(){null!==this.allAchievement&&(this.removeChild(this.allAchievement),this.allAchievement.destroy(),this.allAchievement=null)}},{key:"addAllFriend",value:function(){this.removeAllScreen(),this.allFriend=new Ly(this.user_id),this.allFriend.event.back.add(this.chooseBack,this),this.addChild(this.allFriend)}},{key:"removeAllFriend",value:function(){null!==this.allFriend&&(this.removeChild(this.allFriend),this.allFriend.destroy(),this.allFriend=null)}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack"+this.screenIdx),this.screenIdx>0?this.event.back.dispatch():this.addUserProfile()}},{key:"chooseBackUser",value:function(){LogConsole.log("chooseBackUser"),this.event.back.dispatch()}},{key:"destroy",value:function(){this.removeEvent(),this.removeAllScreen(),this.removeAllItem(),$y(em(t.prototype),"destroy",this).call(this)}}]),t}();function am(e){return(am="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rm(e,t){return!t||"object"!==am(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lm(e){return(lm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hm(e,t){return(hm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cm=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=rm(this,lm(t).call(this,e,n,i))).positionShop=z.instance().positionShop,o.btn=null,o.idx=-1,o.txtContent=new _t(o.positionShop.bot_menu_text_button,""),o.txtContent.setTextBounds(0,0,160*z.instance().scale,27*z.instance().scale),o.addChild(o.txtContent),o.lineDoc=new rt(o.positionShop.playlist_menu_linedoc),o.lineDoc.x=159*z.instance().scale,o.lineDoc.y=41*z.instance().scale,o.addChild(o.lineDoc),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hm(e,t)}(t,pt),n=t,(i=[{key:"setButton",value:function(e,t){this.idx=t,this.btn=new rt(e.obj),LogConsole.log("this.width : "+this.width+" this.btn.width "+this.btn.width),this.btn.x=(this.width-this.btn.width)/2,this.addChild(this.btn),this.txtContent.text=e.content,3==t&&(this.lineDoc.visible=!1)}},{key:"getIdx",value:function(){return this.idx}},{key:"active",value:function(){this.btn.alpha=1,this.btn.y=25*z.instance().scale,this.txtContent.visible=!0}},{key:"deactive",value:function(){this.btn.alpha=.2,this.btn.y=41*z.instance().scale,this.txtContent.visible=!1}}])&&sm(n.prototype,i),o&&sm(n,o),t}();function um(e){return(um="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fm(e){return(fm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pm(e,t){return(pm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ym=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=fm(t).call(this,game,0,0,null))||"object"!==um(i)&&"function"!=typeof i?gm(n):i).event={change_menu:new Phaser.Signal},e.positionShop=z.instance().positionShop,e.idxTab=o;var a=[{obj:{x:0,y:0,nameAtlas:"shop",nameSprite:"Icon_Playlist_active"},content:"Playlist"},{obj:{x:0,y:0,nameAtlas:"shop",nameSprite:"Icon_Tainguyen_active"},content:"Tài nguyên"},{obj:{x:0,y:0,nameAtlas:"shop",nameSprite:"Icon_Hotro_active"},content:"Hỗ trợ"},{obj:{x:0,y:0,nameAtlas:"shop",nameSprite:"Icon_Vip_active"},content:"Vip"}];e.line=new rt(e.positionShop.bot_menu_line_top),e.addChild(e.line),e.arrButtonTab=[];for(var s=0,r=0;r<a.length;r++){var l=new cm(e.positionShop.bot_menu_bg_button,e.chooseButton,gm(gm(e)));l.setButton(a[r],r),l.x=s,s+=l.width,e.addChild(l),r===e.idxTab?l.active():l.deactive(),e.arrButtonTab.push(l)}return e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pm(e,t)}(t,Mt),n=t,(i=[{key:"chooseButton",value:function(e){LogConsole.log("chooseButton"),LogConsole.log(e);var t=e.getIdx();if(3===t)IE.instance().addDialog("Chức năng Vip sắp ra mắt.");else if(t===this.idxTab);else{for(var n=0;n<this.arrButtonTab.length;n++){var i=this.arrButtonTab[n];i.getIdx()!==t?i.deactive():i.active()}this.idxTab=t,this.event.change_menu.dispatch(this.idxTab)}}}])&&dm(n.prototype,i),o&&dm(n,o),t}();function mm(e){return(mm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wm(e,t){return!t||"object"!==mm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bm(e,t,n){return(bm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_m(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _m(e){return(_m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sm(e,t){return(Sm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Em=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=wm(this,_m(t).call(this,game,0,0,null,n,i))).positionShop=z.instance().positionShop,o.lineNgang=new rt(o.positionShop.sort_play_list_icon_active_search_menu),o.addChild(o.lineNgang),o.lineDoc=new rt(o.positionShop.sort_play_list_linedoc_search_menu),o.addChild(o.lineDoc),o.txtContent=new _t(o.positionShop.sort_play_list_text_search_menu,e),o.txtContent.setTextBounds(0,0,o.width,o.height),o.addChild(o.txtContent),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sm(e,t)}(t,Phaser.Button),n=t,(i=[{key:"active",value:function(){this.lineNgang.visible=!0,this.txtContent.changeStyle({fill:"#ffffff"})}},{key:"deactive",value:function(){this.lineNgang.visible=!1,this.txtContent.changeStyle({fill:"#695782"})}},{key:"hideDoc",value:function(){this.lineDoc.visible=!1}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),bm(_m(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"destroy",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}bm(_m(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return 213*z.instance().scale}},{key:"height",get:function(){return 100*z.instance().scale}}])&&vm(n.prototype,i),o&&vm(n,o),t}();function Cm(e){return(Cm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function km(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pm(e,t){return!t||"object"!==Cm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Om(e){return(Om=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rm(e,t){return(Rm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Pm(this,Om(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rm(e,t)}(t,Mt),n=t,o=[{key:"SORT_AZ",value:function(){return"SORT_AZ"}},{key:"SORT_NEW",value:function(){return"SORT_NEW"}},{key:"SORT_POP",value:function(){return"SORT_POP"}}],(i=[{key:"afterCreate",value:function(){this.eventChangeMenu=new Phaser.Signal,this.eventSearch=new Phaser.Signal,this.positionShop=this.mainData.positionShop,this.type=t.sortAZ,this.bg=new pt(this.positionShop.sort_play_list_bg_search_menu),this.addChild(this.bg),this.sortAZ=new Em("Top nghệ sĩ",this.chooseSortAZ,this),this.sortAZ.active(),this.addChild(this.sortAZ),this.sortNew=new Em("Mới Nhất",this.chooseSortNew,this),this.sortNew.deactive(),this.sortNew.x=this.sortAZ.x+213*z.instance().scale,this.addChild(this.sortNew),this.sortPhobien=new Em("Phổ Biến",this.chooseSortPhobien,this),this.sortPhobien.deactive(),this.sortPhobien.hideDoc(),this.sortPhobien.x=this.sortNew.x+213*z.instance().scale,this.addChild(this.sortPhobien)}},{key:"setMenu",value:function(e){e===t.SORT_AZ?(this.type=t.SORT_AZ,this.sortAZ.active(),this.sortNew.deactive(),this.sortPhobien.deactive()):e===t.SORT_NEW?(this.type=t.SORT_NEW,this.sortAZ.deactive(),this.sortNew.active(),this.sortPhobien.deactive()):(this.type=t.SORT_POP,this.sortAZ.deactive(),this.sortNew.deactive(),this.sortPhobien.active())}},{key:"addEventChangeMenu",value:function(e,t){this.eventChangeMenu.add(e,t)}},{key:"removeEventChangeMenu",value:function(e,t){this.eventChangeMenu.remove(e,t)}},{key:"dispatchEventChangeMenu",value:function(){this.eventChangeMenu.dispatch(this.type)}},{key:"addEventSearch",value:function(e,t){this.eventSearch.add(e,t)}},{key:"removeEventSearch",value:function(e,t){this.eventSearch.remove(e,t)}},{key:"dispatchEventSearch",value:function(e){this.eventSearch.dispatch(e)}},{key:"chooseSortAZ",value:function(){LogConsole.log("chooseSortAZ"),this.type!==t.SORT_AZ&&(this.type=t.SORT_AZ,this.sortAZ.active(),this.sortNew.deactive(),this.sortPhobien.deactive(),this.dispatchEventChangeMenu())}},{key:"chooseSortNew",value:function(){LogConsole.log("chooseSortNew"),this.type!==t.SORT_NEW&&(this.type=t.SORT_NEW,this.sortAZ.deactive(),this.sortNew.active(),this.sortPhobien.deactive(),this.dispatchEventChangeMenu())}},{key:"chooseSortPhobien",value:function(){LogConsole.log("chooseSortPhobien"),this.type!==t.SORT_POP&&(this.type=t.SORT_POP,this.sortAZ.deactive(),this.sortNew.deactive(),this.sortPhobien.active(),this.dispatchEventChangeMenu())}},{key:"destroy",value:function(){this.bg.destroy(),this.sortAZ.destroy(),this.sortNew.destroy(),this.sortPhobien.destroy()}}])&&km(n.prototype,i),o&&km(n,o),t}();function Tm(e){return(Tm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Im(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Am(e,t){return!t||"object"!==Tm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lm(e,t,n){return(Lm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gm(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Gm(e){return(Gm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dm(e,t){return(Dm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mm=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Am(this,Gm(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dm(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.eventSearch=new Phaser.Signal,this.eventBack=new Phaser.Signal,this.positionShop=this.mainData.positionShop,this.bg=new rt(this.positionShop.sort_play_list_bg_top_menu),this.addChild(this.bg),this.btnBack=new pt(this.positionShop.sort_play_list_bg_back_top_menu,this.chooseBack,this),this.addChild(this.btnBack),this.btnSearch=new pt(this.positionShop.sort_play_list_bg_search_icon_top_menu,this.chooseSearch,this),this.addChild(this.btnSearch),this.btnDiamond=new ln(this.positionShop.sort_play_list_bg_diamond_top_menu,TF.instance().dataMySeft.diamond),this.addChild(this.btnDiamond),this.addEvent()}},{key:"addEvent",value:function(){TF.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this),De.instance().event.backButton.add(this.chooseBack,this)}},{key:"removeEvent",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this),De.instance().event.backButton.remove(this.chooseBack,this)}},{key:"onUserVarsUpdate",value:function(e){null!==this.btnDiamond&&this.btnDiamond.setText(TF.instance().dataMySeft.diamond)}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack"),this.dispatchEventBack()}},{key:"chooseSearch",value:function(){LogConsole.log("chooseSearch"),this.addKeyBoard()}},{key:"addEventSearch",value:function(e,t){this.eventSearch.add(e,t)}},{key:"removeEventSearch",value:function(e,t){this.eventSearch.remove(e,t)}},{key:"dispatchEventSearch",value:function(e){this.eventSearch.dispatch(e)}},{key:"addEventBack",value:function(e,t){this.eventBack.add(e,t)}},{key:"removeEventBack",value:function(e,t){this.eventBack.remove(e,t)}},{key:"dispatchEventBack",value:function(){this.eventBack.dispatch()}},{key:"addKeyBoard",value:function(){$r.instance().show({maxLength:"",showTransparent:!0,placeholder:"Nhập từ khóa",isSearch:!0,typeInputText:"search"}),$r.instance().event.change.add(this.changeKeyBoard,this),$r.instance().event.hideKeyboard.add(this.hideKeyboard,this),$r.instance().event.enter.add(this.onSubmit,this),$r.instance().event.submit.add(this.onSubmit,this),$r.instance().event.cancle.add(this.onCancel,this)}},{key:"hideKeyboard",value:function(){$r.instance().hide()}},{key:"onSubmit",value:function(){var e=$r.instance().getValue();this.dispatchEventSearch(e),setTimeout(function(){$r.instance().hide()},100)}},{key:"onCancel",value:function(){$r.instance().event.change.remove(this.changeKeyBoard,this),$r.instance().event.hideKeyboard.remove(this.hideKeyboard,this),$r.instance().event.enter.remove(this.onSubmit,this),$r.instance().event.submit.remove(this.onSubmit,this),$r.instance().event.cancle.remove(this.onCancel,this),$r.instance().hide()}},{key:"changeKeyBoard",value:function(){var e=$r.instance().getValue();this.dispatchEventSearch(e)}},{key:"destroy",value:function(){this.removeEvent(),this.bg.destroy(),this.btnBack.destroy(),this.btnSearch.destroy(),this.btnDiamond.destroy(),this.onCancel(),Lm(Gm(t.prototype),"destroy",this).call(this)}}])&&Im(n.prototype,i),o&&Im(n,o),t}();function Nm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Bm=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"getNameRegion",value:function(t){return t===e.Local?"Nhạc Châu Á":t===e.International?"Nhạc Âu Mỹ":void 0}},{key:"Local",get:function(){return"Local"}},{key:"International",get:function(){return"International"}}],(n=null)&&Nm(t.prototype,n),i&&Nm(t,i),e}();function jm(e){return(jm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Um(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Fm(e,t){return!t||"object"!==jm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zm(e,t,n){return(Zm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Hm(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Hm(e){return(Hm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qm(e,t){return(Qm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vm=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Fm(this,Hm(t).call(this,game,0,0,null,e,n))).data=null,i.idx=0,i.positionShop=z.instance().positionShop,i.bgGenes=new Zt(i.positionShop.gennes_bg_item),i.addChild(i.bgGenes),i.bgGenesActive=new Zt(i.positionShop.gennes_bg_item_active),i.addChild(i.bgGenesActive),i.lbGennes=new _t(i.positionShop.gennes_text_item),i.addChild(i.lbGennes),i.deactive(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qm(e,t)}(t,Phaser.Button),n=t,(i=[{key:"active",value:function(){this.bgGenesActive.visible=!0,this.bgGenes.visible=!1}},{key:"deactive",value:function(){this.bgGenesActive.visible=!1,this.bgGenes.visible=!0}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e,t){this.data=e,this.idx=t,this.lbGennes.text=this.data.genre,this.bgGenes.width=this.lbGennes.width+35*z.instance().scale,this.bgGenes.height=65*z.instance().scale,this.bgGenesActive.width=this.lbGennes.width+35*z.instance().scale,this.bgGenesActive.height=65*z.instance().scale,this.lbGennes.x=(this.bgGenes.width-this.lbGennes.width)/2,this.lbGennes.y=(this.bgGenes.height-this.lbGennes.height)/2,LogConsole.log(this.lbGennes.width),LogConsole.log(this.bgGenes.width)}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),Zm(Hm(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"destroy",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}Zm(Hm(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.bgGenes.width}},{key:"height",get:function(){return this.bgGenes.height}}])&&Um(n.prototype,i),o&&Um(n,o),t}();function Wm(e){return(Wm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qm(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Km(e,t){return!t||"object"!==Wm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zm(e,t,n){return(zm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Ym(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Ym(e){return(Ym=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jm(e,t){return(Jm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xm=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Km(this,Ym(t).call(this,game,0,0,null,n,i))).positionShop=z.instance().positionShop,o.lineNgang=new rt(o.positionShop.playlist_menu_linengang),o.lineNgang.width=224,o.addChild(o.lineNgang),o.lineDoc=new rt(o.positionShop.playlist_menu_linedoc),o.addChild(o.lineDoc),o.txtContent=new _t(o.positionShop.playlist_menu_textcontent,e),o.txtContent.setTextBounds(0,0,o.width,o.height),o.addChild(o.txtContent),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jm(e,t)}(t,Phaser.Button),n=t,(i=[{key:"active",value:function(){this.lineNgang.visible=!0,this.txtContent.changeStyle({fill:"#ffffff"})}},{key:"deactive",value:function(){this.lineNgang.visible=!1,this.txtContent.changeStyle({fill:"#695782"})}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),zm(Ym(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"destroy",value:function(){if(this.children)for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}zm(Ym(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return 225*z.instance().scale}},{key:"height",get:function(){return 87*z.instance().scale}}])&&qm(n.prototype,i),o&&qm(n,o),t}();function $m(e){return($m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ev(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tv(e,t){return!t||"object"!==$m(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nv(e){return(nv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iv(e,t){return(iv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ov=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),tv(this,nv(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iv(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={close:new Phaser.Signal,change_menu:new Phaser.Signal,choose_sort:new Phaser.Signal},this.type=Bm.Local,this.positionShop=this.mainData.positionShop,this.bgMenu=new pt(this.positionShop.playlist_bg_menu),this.bgMenu.height=89*this.mainData.scale,this.addChild(this.bgMenu),this.btnNhacViet=new Xm(Bm.getNameRegion(Bm.Local),this.chooseNhacViet,this),this.btnNhacViet.active(),this.addChild(this.btnNhacViet),this.btnQuocTe=new Xm(Bm.getNameRegion(Bm.International),this.chooseQuocTe,this),this.btnQuocTe.x=this.btnNhacViet.width*this.mainData.scale,this.btnQuocTe.deactive(),this.addChild(this.btnQuocTe),this.btnChooseSort=new ln(this.positionShop.bg_tab_menu_select,"A-Z",this.btnChooseSort,this),this.addChild(this.btnChooseSort)}},{key:"setTextSort",value:function(e){this.btnChooseSort.setText(e)}},{key:"btnChooseSort",value:function(){this.event.choose_sort.dispatch()}},{key:"chooseClose",value:function(){LogConsole.log("chooseClose"),this.event.close.dispatch()}},{key:"chooseNhacViet",value:function(){LogConsole.log("chooseNhacViet"),this.type===Bm.International&&(this.type=Bm.Local,this.btnNhacViet.active(),this.btnQuocTe.deactive(),this.event.change_menu.dispatch(Bm.Local))}},{key:"chooseQuocTe",value:function(){LogConsole.log("chooseQuocTe"),this.type===Bm.Local&&(this.type=Bm.International,this.btnNhacViet.deactive(),this.btnQuocTe.active(),this.event.change_menu.dispatch(Bm.International))}}])&&ev(n.prototype,i),o&&ev(n,o),t}();function av(e){return(av="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rv(e){return(rv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lv(e,t){return(lv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var cv=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=rv(t).call(this,game,0,0,null))||"object"!==av(i)&&"function"!=typeof i?hv(n):i).event={choose_sort:new Phaser.Signal},e.positionShop=e.mainData.positionShop,e.bgGenres=new pt(e.positionShop.sort_play_list_bg_search_menu),e.bgGenres.height=165*z.instance().scale,e.bgGenres.width=166*z.instance().scale,e.addChild(e.bgGenres),e.arrSort=["A-Z","Mới Nhất","Phổ Biến"];for(var o=10,a=0;a<e.arrSort.length;a++){var s=new ln(e.positionShop.bg_tab_menu_select_item,e.arrSort[a],e.chooseItem,hv(hv(e)));s.name=a,s.y=o,s.x=10,o+=45,e.addChild(s)}return e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lv(e,t)}(t,Mt),n=t,(i=[{key:"chooseItem",value:function(e){LogConsole.log("chooseItem : "+e.name),this.event.choose_sort.dispatch(e.name,this.arrSort[parseInt(e.name)])}}])&&sv(n.prototype,i),o&&sv(n,o),t}();function uv(e){return(uv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fv(e,t){return!t||"object"!==uv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pv(e,t,n){return(pv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=gv(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function gv(e){return(gv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yv(e,t){return(yv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var mv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),fv(this,gv(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yv(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){qe.instance().showLoading(),this.event={back:new Phaser.Signal,close:new Phaser.Signal,show_all:new Phaser.Signal,search:new Phaser.Signal},this.ktShowSort=!1,this.positionShop=this.mainData.positionShop,this.dataPlayList={genres:[],playlists:[]},this.idxItem=0,this.countItem=0,this.idDelay=null,this.ktBuildItem=!1,this.detail=null,this.popupBuy=null,this.popupMoney=null,this.chooseSort=null,this.type=xm.SORT_POP,this.local=Bm.Local,this.genres=-1,this.itemGenresActive=null,this.strSearch="",this.dataList=[],this.ktSearch=!1,this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.addChild(this.bg);var e={column:3,width:game.width,height:game.height-460*z.instance().scale,rowHeight:326*z.instance().scale,leftDistance:35*z.instance().scale,direction:"y",distanceBetweenColumns:35*z.instance().scale,distanceBetweenRows:35*z.instance().scale};this.scroll=new hy(e),this.scroll.event.changeIndex.add(this.changeIndex,this),this.scroll.y=335*z.instance().scale,this.addChild(this.scroll),this.parentGenres=new Phaser.Group(game,0,0,null),this.listGenres=new Vo(game,this.parentGenres,new Phaser.Rectangle(0,0,game.width-70,95*z.instance().scale),{direction:"x",padding:18*z.instance().scale,bouncing:!0,searchForClicks:!0}),this.parentGenres.x=35,this.parentGenres.y=189*z.instance().scale,this.addChild(this.parentGenres),this.header=new Mm,this.header.addEventSearch(this.searchData,this),this.header.addEventBack(this.chooseBackHeader,this),this.addChild(this.header),this.menu=new ov,this.menu.event.change_menu.add(this.changeMenu,this),this.menu.event.choose_sort.add(this.chooseSortPlaylist,this),this.menu.y=100,this.addChild(this.menu),this.txtSearch=new _t(this.positionShop.sort_play_list_text_current_search,"Tất cả"),this.txtSearch.setTextBounds(0,0,game.width-71*z.instance().scale,59*z.instance().scale),this.addChild(this.txtSearch),this.btnCloseTextSearch=new pt(this.positionShop.sort_play_list_btn_close_search,this.chooseCloseTextSearch,this),this.addChild(this.btnCloseTextSearch),this.btnCloseTextSearch.visible=!1}},{key:"addEvent",value:function(){LogConsole.log("addEvent"),TF.instance().events.onExtensionResponse.add(this.getData,this),Ur.instance().event.buy_playlist.add(this.resetShop,this),Ur.instance().event.load_playlist_complete.add(this.buildDataShop,this),!0===Ur.instance().ktLoadPlaylist?this.buildDataShop():Ur.instance().sendGetDataShop()}},{key:"buildDataShop",value:function(){this.buildListGenres(),this.buildDataList(),!0===this.ktSearch&&(this.ktSearch=!1,this.addKeyBoard()),qe.instance().hideLoading()}},{key:"removeEvent",value:function(){Ur.instance().event.buy_playlist.remove(this.resetShop,this),this.scroll.event.changeIndex.remove(this.changeIndex,this),TF.instance().events.onExtensionResponse.remove(this.getData,this),Ur.instance().event.load_playlist_complete.remove(this.buildDataShop,this)}},{key:"getData",value:function(e){switch(e.cmd){case Hs.SHOP_PLAYLIST_LOAD_RESPONSE:case Hs.SHOP_BUY_PLAYLIST_RESPONSE:}}},{key:"resetShop",value:function(){this.buildDataList()}},{key:"addKeyBoard",value:function(){this.header.addKeyBoard()}},{key:"chooseBackHeader",value:function(){LogConsole.log("chooseBackHeader"),this.event.close.dispatch()}},{key:"chooseCloseTextSearch",value:function(){this.btnCloseTextSearch.visible=!1,this.txtSearch.text="Tất cả",this.strSearch="",this.buildDataList()}},{key:"changeMenu",value:function(e){this.local=e,this.buildListGenres(),this.buildDataList()}},{key:"setData",value:function(e,t,n,i){this.local=e,this.genres=t,this.type=n,this.ktSearch=i,""!=this.type&&this.menu.setMenu(this.type)}},{key:"changeData",value:function(e){this.dataPlayList=e,this.buildDataList()}},{key:"chooseItem",value:function(e){-1===this.genres?(this.itemGenresActive=e,this.itemGenresActive.active(),this.genres=e.getData().id):this.genres===e.getData().id?(e.deactive(),this.genres=-1,this.itemGenresActive=null):(this.itemGenresActive.deactive(),e.active(),this.genres=e.getData().id,this.itemGenresActive=e),this.listGenres.tweenToItem(e.idx,.5),this.buildDataList()}},{key:"searchData",value:function(e){if(LogConsole.log("searchData : "+e),this.strSearch=e,this.txtSearch.text=this.strSearch,""!=this.strSearch){this.btnCloseTextSearch.visible=!0,this.dataList=[];for(var t=Ur.instance().playlist.getArrShop(),n=0;n<t.length;n++)-1!==this.xoa_dau(t[n].name).toUpperCase().indexOf(this.xoa_dau(e).toUpperCase())&&this.dataList.push(t[n])}else this.btnCloseTextSearch.visible=!1,this.txtSearch.text="Tất cả";this.buildDataList()}},{key:"buildDataList",value:function(){if(""===this.strSearch){var e=Ur.instance().playlist.getArrShop();this.type===xm.SORT_AZ?(this.dataList=e.sort(this.sortAZ),this.menu.setTextSort("A-Z")):this.type===xm.SORT_NEW?(this.dataList=e.sort(this.sortNewPlayList),this.menu.setTextSort("Mới Nhất")):(this.type,xm.SORT_POP,this.dataList=e.sort(this.sortPhoBien),this.menu.setTextSort("Phổ Biến"))}else this.type===xm.SORT_AZ?(this.dataList.sort(this.sortAZ),this.menu.setTextSort("A-Z")):this.type===xm.SORT_NEW?(this.dataList.sort(this.sortNewPlayList),this.menu.setTextSort("Mới Nhất")):(this.type,xm.SORT_POP,this.dataList.sort(this.sortPhoBien),this.menu.setTextSort("Phổ Biến"));this.idxItem=0,this.countItem=0,this.scroll.viewList=[],this.removeDelayBuild(),this.idDelay=game.time.events.add(.1*Phaser.Timer.SECOND,this.addItemPageShop,this)}},{key:"changeIndex",value:function(e){console.log("this.countItem : "+this.countItem),console.log("idx : "+e),this.countItem===e+1&&!1===this.ktBuildItem&&this.addItemPageShop()}},{key:"addItemPageShop",value:function(){var e=[],t=0;this.ktBuildItem=!0;for(var n=this.idxItem;n<this.dataList.length;n++){if(this.idxItem++,(-1===this.genres||this.dataList[n].genre_id===this.genres)&&this.local===this.dataList[n].region&&1!==this.dataList[n].is_owner){t++;var i=new hg;i.event.CHOOSE.add(this.chooseItemShop,this),i.event.BUY.add(this.buyItemShop,this),i.setData(this.dataList[n],t),e.push(i)}if(e.length===this.scroll.columnNumber||this.idxItem===this.dataList.length){if(this.countItem++,this.scroll.addItem(e),this.countItem%3==0){this.ktBuildItem=!1;break}this.idxItem===this.dataList.length&&(this.ktBuildItem=!1),e=[]}}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"buildListGenres",value:function(){LogConsole.log(this.listGenres),this.listGenres.reset(),this.listGenres.removeAll();var e=-1,t=-1;this.genres=-1;for(var n=Ur.instance().genres.getDataGenresByLocal(this.local),i=0;i<n.length;i++){t++;var o=new Vm(this.chooseItem,this);n[i].id===this.genres?(this.itemGenresActive=o,o.active(),e=t):o.deactive(),o.y=20*this.mainData.scale,o.setData(n[i],t),this.listGenres.add(o)}e>-1&&this.listGenres.tweenToItem(e,.5)}},{key:"chooseItemShop",value:function(e){$r.instance().hide(),IE.instance().addPlaylistDetail(e.id)}},{key:"buyItemShop",value:function(e){IE.instance().buyItem(e)}},{key:"chooseSortPlaylist",value:function(){this.ktShowSort=!this.ktShowSort,!0===this.ktShowSort?this.addChooseSortPlaylist():this.removeChooseSortPlayList()}},{key:"addChooseSortPlaylist",value:function(){this.removeChooseSortPlayList(),this.ktShowSort=!0,this.chooseSort=new cv,this.chooseSort.event.choose_sort.add(this.changeSortPlayList,this),this.chooseSort.x=455*this.mainData.scale,this.chooseSort.y=165*this.mainData.scale,this.addChild(this.chooseSort)}},{key:"changeSortPlayList",value:function(e,t){this.removeChooseSortPlayList(),this.type=0===e?xm.SORT_AZ:1===e?xm.SORT_NEW:xm.SORT_POP,this.menu.setTextSort(t),this.buildDataList()}},{key:"removeChooseSortPlayList",value:function(){null!==this.chooseSort&&(this.ktShowSort=!1,this.removeChild(this.chooseSort),this.chooseSort.destroy(),this.chooseSort=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),this.bg.destroy(),this.header.destroy(),this.menu.destroy(),this.txtSearch.destroy(),this.btnCloseTextSearch.destroy(),this.listGenres.removeAll(),this.listGenres.destroy(),this.scroll.destroy(),this.removeAllItem(),this.parentGenres.destroy(),IE.instance().removePlaylistDetail(),IE.instance().removePopupBuy(),IE.instance().removePopupMoney(),pv(gv(t.prototype),"destroy",this).call(this)}}])&&dv(n.prototype,i),o&&dv(n,o),t}();function vv(e){return(vv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wv(e){return(wv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bv(e,t){return(bv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Sv=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=wv(t).call(this,game,0,0,null))||"object"!==vv(i)&&"function"!=typeof i?_v(n):i).content=new _t({x:0,y:0,style:{}},"VipScreen"),e.addChild(e.content),Le.instance().logEvent(Le.Shop_Vip);var o=new Phaser.Group(game,0,0,null);return e.listRoom=new ListView(game,o,new Phaser.Rectangle(0,0,game.width,game.height-142*MainData.instance().scale),{direction:"y",padding:38*MainData.instance().scale,searchForClicks:!0}),o.x=0,o.y=142*MainData.instance().scale,e.addChild(o),e.header=new ShopTNItemHeader,e.header.event.back.add(e.chooseBackMenu,_v(_v(e))),e.addChild(e.header),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bv(e,t)}(t,Mt),t}();function Ev(e){return(Ev="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kv(e,t,n){return(kv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Pv(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pv(e){return(Pv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ov(e,t){return(Ov=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var xv=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Pv(t).call(this,game,0,0,null))||"object"!==Ev(i)&&"function"!=typeof i?Rv(n):i).event={back:new Phaser.Signal},e.positionShop=e.mainData.positionShop,e.bg=new rt(e.positionShop.sort_play_list_bg_top_menu),e.addChild(e.bg),e.scoreDiamond=0,e.scoreTicket=0,e.scoreHeart=0,e.btnBack=new pt(e.positionShop.sort_play_list_bg_back_top_menu,e.chooseBack,Rv(Rv(e))),e.addChild(e.btnBack),e.scoreDiamond=TF.instance().dataMySeft.diamond,e.btnDiamond=new ln(e.positionShop.tn_header_item_gem,e.scoreDiamond),e.addChild(e.btnDiamond),e.scoreTicket=TF.instance().dataMySeft.ticket,e.btnTicket=new ln(e.positionShop.tn_header_item_ticket,e.scoreTicket),e.addChild(e.btnTicket),e.scoreHeart=TF.instance().dataMySeft.heart,e.btnHeart=new ln(e.positionShop.tn_header_item_heart,e.scoreHeart),e.addChild(e.btnHeart),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ov(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),TF.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),TF.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this)}},{key:"onUserVarsUpdate",value:function(e){var t,n=this,i={score:0};this.scoreDiamond<TF.instance().dataMySeft.diamond?(game.tweens.removeFrom(this.btnDiamond),i.score=this.scoreDiamond,this.scoreDiamond=TF.instance().dataMySeft.diamond,console.log("scoreDiamond : "+this.scoreDiamond),(t=game.add.tween(i).to({score:TF.instance().dataMySeft.diamond},500,"Linear",!0,1500)).start(),t.onUpdateCallback(function(){n.btnDiamond&&n.btnDiamond.setText(parseInt(i.score))},this),t.onComplete.add(function(){n.btnDiamond&&n.btnDiamond.setText(parseInt(n.scoreDiamond))},this)):this.btnDiamond.setText(TF.instance().dataMySeft.diamond),this.scoreHeart<TF.instance().dataMySeft.heart&&(game.tweens.removeFrom(this.btnHeart),i.score=this.scoreHeart,this.scoreHeart=TF.instance().dataMySeft.heart,console.log("scoreHeart : "+this.scoreHeart),(t=game.add.tween(i).to({score:TF.instance().dataMySeft.heart},500,"Linear",!0,1500)).start(),t.onUpdateCallback(function(){n.btnHeart&&n.btnHeart.setText(parseInt(i.score))},this),t.onComplete.add(function(){n.btnHeart&&n.btnHeart.setText(parseInt(n.scoreHeart))},this)),this.scoreTicket<TF.instance().dataMySeft.ticket&&(game.tweens.removeFrom(this.btnTicket),i.score=this.scoreTicket,this.scoreTicket=TF.instance().dataMySeft.ticket,console.log("scoreTicket : "+this.scoreTicket),(t=game.add.tween(i).to({score:TF.instance().dataMySeft.ticket},500,"Linear",!0,1500)).start(),t.onUpdateCallback(function(){n.btnTicket&&n.btnTicket.setText(parseInt(i.score))},this),t.onComplete.add(function(){n.btnTicket&&n.btnTicket.setText(parseInt(n.scoreTicket))},this))}},{key:"removeTween",value:function(){game.tweens.removeFrom(this.btnDiamond),game.tweens.removeFrom(this.btnTicket),game.tweens.removeFrom(this.btnHeart)}},{key:"destroy",value:function(){console.log("destroy header"),this.removeTween(),kv(Pv(t.prototype),"destroy",this).call(this)}}])&&Cv(n.prototype,i),o&&Cv(n,o),t}();function Tv(e){return(Tv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Iv(e,t){return!t||"object"!==Tv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Av(e){return(Av=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Lv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Gv(e,t,n){return t&&Lv(e.prototype,t),n&&Lv(e,n),e}function Dv(e,t){return(Dv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mv=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Iv(this,Av(t).call(this,game,0,0,null,n,i))).positionShop=z.instance().positionShop,o.bg=new rt(o.positionShop.sort_play_list_icon_active_search_menu),o.bg.height=89,o.bg.y=0,o.bg.alpha=0,o.addChild(o.bg),e===t.GEM?(o.icon=new rt(o.positionShop.tn_tab_icon_gem),o.iconActive=new rt(o.positionShop.tn_tab_icon_gem_active)):e===t.TICKET?(o.icon=new rt(o.positionShop.tn_tab_icon_ticket),o.iconActive=new rt(o.positionShop.tn_tab_icon_ticket_active)):e===t.HEART&&(o.icon=new rt(o.positionShop.tn_tab_icon_heart),o.iconActive=new rt(o.positionShop.tn_tab_icon_heart_active)),o.icon.x=(o.width-o.icon.width)/2,o.icon.y=(o.height-o.icon.height)/2,o.iconActive.x=(o.width-o.iconActive.width)/2,o.iconActive.y=(o.height-o.iconActive.height)/2,o.addChild(o.icon),o.addChild(o.iconActive),o.lineActive=new rt(o.positionShop.sort_play_list_icon_active_search_menu),o.lineActive.y=83,o.addChild(o.lineActive),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dv(e,t)}(t,Phaser.Button),Gv(t,null,[{key:"GEM",get:function(){return"DIAMOND"}},{key:"TICKET",get:function(){return"TICKET"}},{key:"HEART",get:function(){return"HEART"}}]),Gv(t,[{key:"active",value:function(){this.icon.visible=!1,this.iconActive.visible=!0,this.lineActive.visible=!0}},{key:"deactive",value:function(){this.icon.visible=!0,this.iconActive.visible=!1,this.lineActive.visible=!1}},{key:"width",get:function(){return 213*z.instance().scale}},{key:"height",get:function(){return 89*z.instance().scale}}]),t}();function Nv(e){return(Nv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jv(e){return(jv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uv(e,t){return(Uv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fv(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Zv=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=jv(t).call(this,game,0,0,null))||"object"!==Nv(o)&&"function"!=typeof o?Fv(i):o).event={change_menu:new Phaser.Signal},n.positionShop=n.mainData.positionShop,n.bg=new rt(n.positionShop.playlist_bg_menu),n.addChild(n.bg),n.typeTab=e,n.tabGem=new Mv(Mv.GEM,n.chooseTabGem,Fv(Fv(n))),n.typeTab===Mv.GEM?n.tabGem.active():n.tabGem.deactive(),n.addChild(n.tabGem),n.tabTicket=new Mv(Mv.TICKET,n.chooseTabTicket,Fv(Fv(n))),n.tabTicket.x=213*n.mainData.scale,n.typeTab===Mv.TICKET?n.tabTicket.active():n.tabTicket.deactive(),n.addChild(n.tabTicket),n.tabHeart=new Mv(Mv.HEART,n.chooseTabHeart,Fv(Fv(n))),n.tabHeart.x=426*n.mainData.scale,n.typeTab===Mv.HEART?n.tabHeart.active():n.tabHeart.deactive(),n.addChild(n.tabHeart),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uv(e,t)}(t,Mt),n=t,(i=[{key:"chooseTabGem",value:function(){this.typeTab===Mv.GEM||(this.tabGem.active(),this.tabTicket.deactive(),this.tabHeart.deactive(),this.typeTab=Mv.GEM,this.event.change_menu.dispatch(this.typeTab))}},{key:"chooseTabTicket",value:function(){this.typeTab===Mv.TICKET||(this.tabGem.deactive(),this.tabTicket.active(),this.tabHeart.deactive(),this.typeTab=Mv.TICKET,this.event.change_menu.dispatch(this.typeTab))}},{key:"chooseTabHeart",value:function(){this.typeTab===Mv.HEART||(this.tabGem.deactive(),this.tabTicket.deactive(),this.tabHeart.active(),this.typeTab=Mv.HEART,this.event.change_menu.dispatch(this.typeTab))}}])&&Bv(n.prototype,i),o&&Bv(n,o),t}();function Hv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Qv=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putUtfString("payment_service",e),t.putBool("new_ticket",!0),t}},{key:"GOOGLE_PLAY",get:function(){return"GOOGLE_PLAY"}},{key:"APPLE",get:function(){return"APPLE"}},{key:"AMAZON_IAP",get:function(){return"AMAZON_IAP"}},{key:"GAME",get:function(){return"GAME"}},{key:"FACEBOOK",get:function(){return"FACEBOOK"}}],(n=null)&&Hv(t.prototype,n),i&&Hv(t,i),e}();function Vv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Wv=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ktIPA=!1,TF.instance().events.onExtensionResponse.add(this.getData,this),"undefined"!=typeof store&&(this.ktIPA=!0),!0===this.ktIPA&&(store.verbosity=store.INFO,store.autoFinishTransactions=!0,store.ready(function(){console.log("\\o/ STORE READY \\o/")}),store.refresh()),this.ktLoad=!1,this.event={buy_complete:new Phaser.Signal,buy_error:new Phaser.Signal},this.ktCall=!1}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.ipa||(this.ipa=new e),this.ipa}}],(n=[{key:"getDataInapp",value:function(){if(null===z.instance().dataPackage){this.ktLoad=!0;var e="";e=!0===this.ktIPA?"android"===device.platform.toLowerCase()?Qv.GOOGLE_PLAY:"ios"===device.platform.toLowerCase()?Qv.APPLE:"amazon-fireos"===device.platform.toLowerCase()?Qv.AMAZON_IAP:Qv.GAME:""===z.instance().tokenYanAccount?Qv.FACEBOOK:Qv.GAME,TF.instance().sendData(Hs.RESOURCE_PACKAGE_LOAD_REQUEST,Qv.begin(e))}}},{key:"getData",value:function(e){switch(e.cmd){case Hs.RESOURCE_PACKAGE_LOAD_RESPONSE:if(!0===this.ktLoad&&(this.ktLoad=!1,"OK"===e.params.getUtfString("status")&&(z.instance().dataPackage=e.params,LogConsole.log(e.params),!0===this.ktIPA))){for(var t=0;t<z.instance().dataPackage.getSFSArray("resource_packages").size();t++){var n=z.instance().dataPackage.getSFSArray("resource_packages").getSFSObject(t);""!==n.getUtfString("pack_name")&&store.register({id:n.getUtfString("pack_name"),alias:n.getUtfString("pack_name"),type:store.CONSUMABLE})}store.refresh()}}}},{key:"buyItem",value:function(e){var t=this;if(!0===this.ktIPA){this.ktCall=!1;var n=e.getUtfString("pack_name");console.log("pack_name : "+n),store.order(n).then(function(){console.log("success")}).error(function(e){console.log("error.."+e.code),t.event.buy_error.dispatch(e.code)}),store.when(n).approved(function(e){console.log("approved"),console.log(e),"android"==device.platform||"Android"==device.platform?(console.log("1111111111111"),e.finish()):(console.log("2222222222222"),e.verify())}),store.validator=function(e){console.log("validator"),console.log(e)},store.when(n).verified(function(n){n.hasOwnProperty("transaction")&&n.transaction.hasOwnProperty("appStoreReceipt")&&!1===t.ktCall&&(t.ktCall=!0,t.callToServerIos(e.getInt("id"),e.getInt("quantity"),e.getUtfString("resource_type"),e.getInt("price"),n.transaction.appStoreReceipt),n.finish())}),store.error(function(e){console.log("ERROR "+e.code+": "+e.message),t.event.buy_error.dispatch(e.message)}),store.when(n).cancelled(function(e){console.log("cancelled"),console.log(e),t.event.buy_error.dispatch("")}),store.when(n).error(function(e){console.log("error"),console.log(e),t.event.buy_error.dispatch("")}),store.when(n).updated(function(e){console.log("updated"),console.log(e),e.loaded&&e.valid&&e.state===store.APPROVED&&null!=e.transaction&&e.finish()}),store.when(n).finished(function(i){var o;console.log("finished----------------------------"),console.log(n+" finished "+i.state+", title is "+i.title+" "+JSON.stringify(i)),console.log(i),"android"==device.platform||"Android"==device.platform?!1===t.ktCall&&(t.ktCall=!0,i.transaction.purchaseToken,o=JSON.parse(i.transaction.receipt),t.callToServerAndroid(o.orderId,o.packageName,o.productId,o.purchaseToken,o.purchaseTime,e.getInt("id"),e.getInt("quantity"),e.getUtfString("resource_type"),e.getInt("price"))):i.transaction.id})}else this.event.buy_error.dispatch("Chưa có thanh toán qua web")}},{key:"callToServerFacebook",value:function(e){console.log("callToServerFacebook : "+e),FB.ui({method:"pay",action:"purchaseitem",product:e},this.buyFacebookItemComplete.bind(this))}},{key:"buyFacebookItemComplete",value:function(e){var t=this;if(console.log("result -----------------"),console.log(e),void 0===e)this.event.buy_error.dispatch("Thanh toán lỗi");else if(e.hasOwnProperty("status")&&"completed"===e.status){var n={signed_request:e.signed_request};console.log("url : "+window.RESOURCE.in_app_facebook_validator),console.log("postData"),console.log(n),$.ajax({url:window.RESOURCE.in_app_facebook_validator,type:"POST",data:n,dataType:"json",success:function(e){LogConsole.log("callToServerFacebook"),LogConsole.log(e),e.hasOwnProperty("error_message")?t.event.buy_error.dispatch(e.error_message):t.event.buy_complete.dispatch(e)},error:function(e,n,i){console.error("Error get server infomation"),console.error(i),console.error(e.status),console.error(e.responseJSON),e.hasOwnProperty("error_message")?t.event.buy_error.dispatch(e.error_message):t.event.buy_error.dispatch("Thanh toán lỗi")}})}else this.event.buy_error.dispatch("Thanh toán lỗi")}},{key:"callToServerIos",value:function(e,t,n,i,o){var a=this;console.log("callToServerIos");var s={userId:TF.instance().dataMySeft.user_id,resourcePackageId:e,resourceQuantity:t,resourceType:n,resourcePrice:i,receiptBase64Data:o};console.log("url : "+window.RESOURCE.in_app_apple_validator),console.log("postData"),console.log(s),$.ajax({url:window.RESOURCE.in_app_apple_validator,type:"POST",data:s,dataType:"json",success:function(e){LogConsole.log("callToServerAndroid"),LogConsole.log(e),a.event.buy_complete.dispatch(e)},error:function(e,t,n){console.error("Error get server infomation"),console.error(n),console.error(e.status),console.error(e.responseJSON),a.event.buy_error.dispatch("Thanh toán lỗi")}})}},{key:"callToServerAndroid",value:function(e,t,n,i,o,a,s,r,l){var h=this;console.log("callToServerAndroid");var c={userId:TF.instance().dataMySeft.user_id,orderId:e,packageName:t,productId:n,purchaseToken:i,purchaseTime:o,resourcePackageId:a,resourceQuantity:s,resourceType:r,resourcePrice:l};console.log("postData"),console.log(c),$.ajax({url:window.RESOURCE.in_app_google_validator,type:"POST",data:c,dataType:"json",success:function(e){LogConsole.log("callToServerAndroid"),LogConsole.log(e),h.event.buy_complete.dispatch(e)},error:function(e,t,n){console.error("Error get server infomation"),console.error(n),console.error(e.status),console.error(e.responseJSON),h.event.buy_error.dispatch("Thanh toán lỗi")}})}}])&&Vv(t.prototype,n),i&&Vv(t,i),e}();function qv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Kv=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t,n){var i=new SFS2X.SFSObject;return i.putInt("resource_pakage_id",e),i.putInt("quantity",t),i.putUtfString("resource_type",n),i}}],(n=null)&&qv(t.prototype,n),i&&qv(t,i),e}();function zv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Yv=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ktIPA=!1,this.ktCall=!1,this.event={buy_complete:new Phaser.Signal,buy_error:new Phaser.Signal},TF.instance().events.onExtensionResponse.add(this.getData,this),window.Cocoon&&Cocoon.InApp&&(this.ktIPA=!0,this.service=Cocoon.InApp,this.service.on("purchase",{start:function(e){console.log("purchase started "+e)},error:function(e,n){console.log("purchase failed "+e+" error: "+JSON.stringify(n)),t.event.buy_error.dispatch(n.message)},complete:function(e){console.log("purchase completed "+JSON.stringify(e))}}),this.service.initialize({autofinish:!0},function(e){console.log(e)}),this.service.setValidationHandler(this.setupCompletePurchase.bind(this)))}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.ipa||(this.ipa=new e),this.ipa}}],(n=[{key:"setupCompletePurchase",value:function(e,t,n){console.log("setValidationHandler"),console.log(t),this.callToServerIos(this.data.getInt("id"),this.data.getInt("quantity"),this.data.getUtfString("resource_type"),this.data.getInt("price"),e)}},{key:"callToServerIos",value:function(e,t,n,i,o){var a=this;qe.instance().showLoading(),console.log("receiptBase64Data: "+o),console.log("callToServerIos");var s={userId:TF.instance().dataMySeft.user_id,resourcePackageId:e,resourceQuantity:t,resourceType:n,resourcePrice:i,receiptBase64Data:o};console.log("url : "+window.RESOURCE.in_app_apple_validator),console.log("postData"),console.log(s),$.ajax({url:window.RESOURCE.in_app_apple_validator,type:"POST",data:s,dataType:"json",success:function(e){LogConsole.log("callToServerAndroid"),LogConsole.log(e),a.event.buy_complete.dispatch(e)},error:function(e,t,n){console.error("Error get server infomation"),console.error(n),console.error(e.status),console.error(e.responseJSON),a.event.buy_error.dispatch("Thanh toán lỗi")}})}},{key:"buyItem",value:function(e){var t=this;if(this.ktIPA){this.data=e,this.ktCall=!1;var n=e.getUtfString("pack_name");this.service.purchase(n,1,function(e){console.log("error"),console.log(e),t.event.buy_error.dispatch(e.message)}),this.service.isPurchased(n)}}},{key:"getDataInapp",value:function(){if(null===z.instance().dataPackage){this.ktLoad=!0;var e="";e=!0===this.ktIPA?"android"===device.platform.toLowerCase()?Qv.GOOGLE_PLAY:"ios"===device.platform.toLowerCase()?Qv.APPLE:"amazon-fireos"===device.platform.toLowerCase()?Qv.AMAZON_IAP:Qv.GAME:Qv.GAME,TF.instance().sendData(Hs.RESOURCE_PACKAGE_LOAD_REQUEST,Qv.begin(e))}}},{key:"getData",value:function(e){switch(e.cmd){case Hs.RESOURCE_PACKAGE_LOAD_RESPONSE:!0===this.ktLoad&&(this.ktLoad=!1,"OK"===e.params.getUtfString("status")&&(z.instance().dataPackage=e.params))}}}])&&zv(t.prototype,n),i&&zv(t,i),e}();function Jv(e){return(Jv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xv(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $v(e,t,n){return($v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ew(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function ew(e){return(ew=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tw(e,t){return(tw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var iw=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=ew(t).call(this,game,0,0,null))||"object"!==Jv(s)&&"function"!=typeof s?nw(a):s).positionShop=z.instance().positionShop,o.data=e,o.iconStr=n,o.isSup=i,o.timeWait=0,o.timerToCountTime=null,o.totalVideo=null,o.bg=new rt(o.positionShop.tn_item_bg),o.addChild(o.bg),o.btnNamePackage=new ln(o.positionShop.tn_item_package_name,e.getUtfString("name")),o.addChild(o.btnNamePackage),o.txtPrice=new _t(o.positionShop.tn_item_price,Un.instance().format(e.getInt("quantity"))),o.txtPrice.setTextBounds(0,0,200*z.instance().scale,52*z.instance().scale),o.addChild(o.txtPrice),o.icon=new Phaser.Sprite(game,0,0,n),o.icon.smoothed=!0,o.icon.animations.pause=!0,o.icon.animations.add("shop"+n),o.icon.x=(o.bg.width-o.icon.width)/2,o.icon.y=90*z.instance().scale+(60*z.instance().scale-o.icon.height)/2,o.icon.animations.play("shop"+n,30,!0),o.addChild(o.icon),i?"ADS"===e.getUtfString("price_type")?o.checkShowTotalVideo():(o.buyItem=new ln(o.positionShop.tn_item_total_support,Un.instance().format(e.getInt("price")),o.buyDiamond,nw(nw(o))),o.addChild(o.buyItem)):"ADS"===e.getUtfString("price_type")?o.checkShowTotalVideo():(o.totalMoney=new ln(o.positionShop.tn_item_total_money,Un.instance().format(e.getInt("price"))+"đ",o.chooseBuy,nw(nw(o))),o.addChild(o.totalMoney)),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tw(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this),li.instance().event.rewardedVideoClosed.add(this.rewardedVideoClosed,this),"ios"===z.instance().platform?(Yv.instance().event.buy_complete.add(this.removeLoading,this),Yv.instance().event.buy_error.add(this.removeLoading,this)):(Wv.instance().event.buy_complete.add(this.removeLoading,this),Wv.instance().event.buy_error.add(this.removeLoading,this))}},{key:"removeEvent",value:function(){li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.remove(this.rewardedVideoFailed,this),li.instance().event.rewardedVideoClosed.remove(this.rewardedVideoClosed,this),"ios"===z.instance().platform?(Yv.instance().event.buy_complete.remove(this.removeLoading,this),Yv.instance().event.buy_error.remove(this.removeLoadingError,this)):(Wv.instance().event.buy_complete.remove(this.removeLoading,this),Wv.instance().event.buy_error.remove(this.removeLoadingError,this))}},{key:"rewardedVideoClosed",value:function(){qe.instance().hideLoading()}},{key:"rewardedVideoFailed",value:function(){qe.instance().hideLoading(),IE.instance().addDialog("No Ads to show")}},{key:"rewardedVideoRewardReceived",value:function(e){qe.instance().hideLoading();var t=e.placement,n=t.name,i=t.amount,o=t.reward;console.log("placementName : "+n),console.log("rewardAmount : "+i),console.log("rewardName : "+o),TF.instance().sendData(Hs.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_REQUEST,Kv.begin(this.data.getInt("id"),this.data.getInt("quantity"),this.data.getUtfString("resource_type")))}},{key:"checkShowTotalVideo",value:function(){this.removeTotalVideo(),!0===this.data.getBool("isAllowWatch")?(this.totalVideo=new ln(this.positionShop.tn_item_total_video,"1x",this.chooseBuyVideo,this),this.addEvent()):(this.timeWait=parseInt((this.data.getLong("next_watched_at")-this.getTime())/1e3),this.timeWait>0?(this.totalVideo=new ln(this.positionShop.tn_item_total_video_wait,""),this.stopCountTime(),this.timerToCountTime=this.game.time.create(!0),this.timerToCountTime.loop(1e3,this.onTimerToCountTime,this),this.timerToCountTime.start(),this.setTextTimer()):(this.totalVideo=new ln(this.positionShop.tn_item_total_video,"1x",this.chooseBuyVideo,this),this.addEvent())),this.addChild(this.totalVideo)}},{key:"onTimerToCountTime",value:function(){this.timeWait=this.timeWait-1,this.timeWait<0&&(this.timeWait=0),0===this.timeWait?(this.stopCountTime(),qe.instance().showLoading(),this.mainData.dataPackage=null,"ios"===z.instance().platform?Yv.instance().getDataInapp():Wv.instance().getDataInapp()):this.setTextTimer()}},{key:"setTextTimer",value:function(){var e,t="",n=parseInt(this.timeWait/3600),i=0,o=0;n>0?(t=n>9?n+":":"0"+n+":",i=parseInt(this.timeWait%3600/60),o=this.timeWait-(3600*n+60*i)):(i=parseInt(this.timeWait/60),o=this.timeWait%60),e=t+(i>9?i+":":"0"+i+":")+(o>9?o+"":"0"+o),this.totalVideo.setText(e)}},{key:"stopCountTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy(),this.timerToCountTime=null)}},{key:"removeTotalVideo",value:function(){null!==this.totalVideo&&(this.removeChild(this.totalVideo),this.totalVideo.destroy(),this.totalVideo=null)}},{key:"buyDiamond",value:function(){LogConsole.log("buyDiamond"),IE.instance().addPopupConfirmBuyItemShop(this.data,this.iconStr,this.isSup)}},{key:"chooseBuy",value:function(){if(LogConsole.log("chooseBuy"),window.cordova&&"undefined"!=typeof device)"ios"===z.instance().platform?Yv.instance().buyItem(this.data):Wv.instance().buyItem(this.data),qe.instance().showLoading(),this.removeIdLoading(),this.idRemoveLoading=game.time.events.add(10*Phaser.Timer.SECOND,this.removeLoading,this);else if(console.log("this.data.payment_service  : "+this.data.getUtfString("payment_service")),"FACEBOOK"===this.data.getUtfString("payment_service"))if(window.RESOURCE.fb_products.hasOwnProperty(this.data.getUtfString("pack_name"))){var e=window.RESOURCE.fb_products[this.data.getUtfString("pack_name")];Wv.instance().callToServerFacebook(e)}else IE.instance().addDialog("Sản phẩm không tồn tại")}},{key:"removeLoadingError",value:function(e){this.removeLoading(),""!==e&&IE.instance().addDialog(e)}},{key:"removeLoading",value:function(){this.removeIdLoading(),qe.instance().hideLoading()}},{key:"removeIdLoading",value:function(){null!==this.idRemoveLoading&&game.time.events.remove(this.idRemoveLoading)}},{key:"chooseBuyVideo",value:function(){LogConsole.log("chooseBuyVideo"),window.cordova&&"undefined"!=typeof device?(qe.instance().showLoading(),li.instance().showRewardVideoInappPurchase(this.data.getUtfString("resource_type"))):IE.instance().addDialog("comming soon")}},{key:"destroy",value:function(){this.removeEvent(),$v(ew(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return 213*z.instance().scale}},{key:"height",get:function(){return 324*z.instance().scale}}])&&Xv(n.prototype,i),o&&Xv(n,o),t}();function ow(e){return(ow="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sw(e,t,n){return(sw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=rw(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function rw(e){return(rw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lw(e,t){return(lw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var cw=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,e=!(i=rw(t).call(this,game,0,0,null))||"object"!==ow(i)&&"function"!=typeof i?hw(n):i,qe.instance().showLoading(),e.event={close:new Phaser.Signal},e.arrResource=[],e.typeMenu=o,e.dataServer=null;var a={column:2,width:game.width,height:game.height-356*z.instance().scale,rowHeight:325*z.instance().scale,leftDistance:80*z.instance().scale,direction:"y",distanceBetweenColumns:55*z.instance().scale,distanceBetweenRows:35*z.instance().scale};return e.scroll=new hy(a),e.scroll.y=230*z.instance().scale,e.addChild(e.scroll),e.header=new xv,e.header.event.back.add(e.chooseBackMenu,hw(hw(e))),e.addChild(e.header),""===e.typeMenu&&(e.typeMenu=Mv.GEM),e.tabMenu=new Zv(e.typeMenu),e.tabMenu.event.change_menu.add(e.changeMenu,hw(hw(e))),e.tabMenu.y=100*e.mainData.scale,e.addChild(e.tabMenu),e.addEvent(),Le.instance().logEvent(Le.Shop_resource),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lw(e,t)}(t,Yy),n=t,(i=[{key:"loadFileComplete",value:function(){sw(rw(t.prototype),"loadFileComplete",this).call(this),this.buildData()}},{key:"chooseBackMenu",value:function(){this.event.close.dispatch()}},{key:"changeMenu",value:function(e){console.log("this.typeMenu : "+this.typeMenu),this.typeMenu=e,qe.instance().showLoading(),this.typeMenu===Mv.GEM?this.arrResource=[{type:"spritesheet",link:"img/atlas/Diamond1.png",key:"Diamond1",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond2.png",key:"Diamond2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond3.png",key:"Diamond3",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond4.png",key:"Diamond4",width:200,height:140,countFrame:30}]:this.typeMenu===Mv.TICKET?this.arrResource=[{type:"spritesheet",link:"img/atlas/Ticket1.png",key:"Ticket1",width:200,height:140,countFrame:24},{type:"spritesheet",link:"img/atlas/Ticket2.png",key:"Ticket2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Ticket3.png",key:"Ticket3",width:200,height:140,countFrame:60},{type:"spritesheet",link:"img/atlas/Ticket4.png",key:"Ticket4",width:200,height:140,countFrame:44}]:this.typeMenu===Mv.HEART&&(this.arrResource=[{type:"spritesheet",link:"img/atlas/Heart1.png",key:"Heart1",width:200,height:140,countFrame:10},{type:"spritesheet",link:"img/atlas/Heart2.png",key:"Heart2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Heart3.png",key:"Heart3",width:200,height:140,countFrame:13},{type:"spritesheet",link:"img/atlas/Heart4.png",key:"Heart4",width:200,height:140,countFrame:60}]),this.loadResource()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),"ios"===z.instance().platform?(Yv.instance().event.buy_complete.add(this.buyItemComplete,this),Yv.instance().event.buy_error.add(this.buyItemError,this)):(Wv.instance().event.buy_complete.add(this.buyItemComplete,this),Wv.instance().event.buy_error.add(this.buyItemError,this)),null===this.mainData.dataPackage?"ios"===z.instance().platform?Yv.instance().getDataInapp():Wv.instance().getDataInapp():(this.dataServer=this.mainData.dataPackage,this.changeMenu(this.typeMenu),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),"ios"===z.instance().platform?(Yv.instance().event.buy_complete.remove(this.buyItemComplete,this),Yv.instance().event.buy_error.remove(this.buyItemError,this)):(Wv.instance().event.buy_complete.remove(this.buyItemComplete,this),Wv.instance().event.buy_error.remove(this.buyItemError,this))}},{key:"buyItemCompleteDiamond",value:function(e){if(console.log("buyItemCompleteDiamond ------------"),"OK"===e.getUtfString("status")){var t=500*this.mainData.scale,n=45*this.mainData.scale,i="HEART";"DIAMOND"===e.getUtfString("resource_type")?(i="DIAMOND",t=140*this.mainData.scale,n=45*this.mainData.scale):"TICKET"===e.getUtfString("resource_type")?(i="TICKET",t=316*this.mainData.scale,n=45*this.mainData.scale):"HEART"===e.getUtfString("resource_type")&&(i="HEART",t=500*this.mainData.scale,n=45*this.mainData.scale);var o={type:i,reward:e.getInt("resource_up"),finishPoint:{x:t,y:n}};IE.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,o)}}},{key:"buyItemComplete",value:function(e){if(console.log("buyItemComplete------ "),console.log(e),qe.instance().hideLoading(),"OK"===e.status){var t=500*this.mainData.scale,n=45*this.mainData.scale,i="HEART",o="";"DIAMOND"===e.resourceType?(i="DIAMOND",t=140*this.mainData.scale,n=45*this.mainData.scale,o="diamond"):"TICKET"===e.resourceType?(i="TICKET",t=316*this.mainData.scale,n=45*this.mainData.scale,o="ticket"):"HEART"===e.resourceType&&(i="HEART",t=500*this.mainData.scale,n=45*this.mainData.scale,o="heart");var a={type:i,reward:e.newResource-e.oldResource,finishPoint:{x:t,y:n}};console.log("data.newResource : "+e.newResource);var s=[];s.push(new SFS2X.SFSUserVariable(o,e.newResource)),TF.instance().socket.send(new SFS2X.SetUserVariablesRequest(s)),IE.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,a)}}},{key:"buyItemError",value:function(e){qe.instance().hideLoading(),""!==e&&IE.instance().addDialog(e)}},{key:"getData",value:function(e){switch(e.cmd){case Hs.RESOURCE_PACKAGE_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&(this.mainData.dataPackage=e.params,this.dataServer=this.mainData.dataPackage,this.changeMenu(this.typeMenu)),qe.instance().hideLoading();break;case Hs.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE:if("OK"===e.params.getUtfString("status")){var t={newResource:0,oldResource:0,resourceType:"DIAMOND",status:"OK"};t.newResource=e.params.getInt("new_resource"),t.resourceType=e.params.getUtfString("resource_type"),t.oldResource=e.params.getInt("old_resource"),this.buyItemComplete(t),this.mainData.dataPackage=null,"ios"===z.instance().platform?Yv.instance().getDataInapp():Wv.instance().getDataInapp()}qe.instance().hideLoading();break;case Hs.RESOURCE_BUY_SUPPORT_ITEM_RESPONSE:"OK"===e.params.getUtfString("status")&&this.buyItemCompleteDiamond(e.params)}}},{key:"buildData",value:function(){var e=[],t=[];this.typeMenu===Mv.GEM?t=["Diamond1","Diamond2","Diamond3","Diamond4"]:this.typeMenu===Mv.TICKET?t=["Ticket1","Ticket2","Ticket3","Ticket4"]:this.typeMenu===Mv.HEART&&(t=["Heart1","Heart2","Heart3","Heart4"]);for(var n=0,i=0;i<this.dataServer.getSFSArray("resource_packages").size();i++){var o=this.dataServer.getSFSArray("resource_packages").getSFSObject(i);if(o.getUtfString("resource_type")===this.typeMenu)if(o.getUtfString("resource_type")===Mv.TICKET&&"CASH"===o.getUtfString("price_type")||o.getUtfString("resource_type")===Mv.TICKET&&"ADS"===o.getUtfString("price_type"));else{var a="";a=n<t.length?t[n]:t[t.length-1];var s=void 0;s="DIAMOND"===o.getUtfString("price_type")?new iw(o,a,!0):new iw(o,a),e.push(s),n++}}this.scroll.viewList=e,qe.instance().hideLoading()}},{key:"destroy",value:function(){this.arrResource=[{type:"spritesheet",link:"img/atlas/Diamond1.png",key:"Diamond1",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond2.png",key:"Diamond2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond3.png",key:"Diamond3",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Diamond4.png",key:"Diamond4",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Ticket1.png",key:"Ticket1",width:200,height:140,countFrame:24},{type:"spritesheet",link:"img/atlas/Ticket2.png",key:"Ticket2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Ticket3.png",key:"Ticket3",width:200,height:140,countFrame:60},{type:"spritesheet",link:"img/atlas/Ticket4.png",key:"Ticket4",width:200,height:140,countFrame:44},{type:"spritesheet",link:"img/atlas/Heart1.png",key:"Heart1",width:200,height:140,countFrame:10},{type:"spritesheet",link:"img/atlas/Heart2.png",key:"Heart2",width:200,height:140,countFrame:30},{type:"spritesheet",link:"img/atlas/Heart3.png",key:"Heart3",width:200,height:140,countFrame:13},{type:"spritesheet",link:"img/atlas/Heart4.png",key:"Heart4",width:200,height:140,countFrame:60}],this.scroll.viewList=[],this.scroll.destroy(),this.removeEvent(),sw(rw(t.prototype),"destroy",this).call(this)}}])&&aw(n.prototype,i),o&&aw(n,o),t}();function uw(e){return(uw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fw(e,t,n){return(fw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pw(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pw(e){return(pw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gw(e,t){return(gw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var mw=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=pw(t).call(this,game,0,0,null))||"object"!==uw(i)&&"function"!=typeof i?yw(n):i).event={back:new Phaser.Signal},e.positionShop=e.mainData.positionShop,e.bg=new rt(e.positionShop.sort_play_list_bg_top_menu),e.addChild(e.bg),e.btnBack=new pt(e.positionShop.sort_play_list_bg_back_top_menu,e.chooseBack,yw(yw(e))),e.addChild(e.btnBack),e.score=TF.instance().dataMySeft.support_item,e.btnMic=new ln(e.positionShop.tn_header_item_mic,TF.instance().dataMySeft.support_item),e.addChild(e.btnMic),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gw(e,t)}(t,Mt),n=t,(i=[{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),TF.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),TF.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this)}},{key:"onUserVarsUpdate",value:function(){var e=this,t={score:this.score};this.score=TF.instance().dataMySeft.support_item;var n=game.add.tween(t).to({score:TF.instance().dataMySeft.support_item},500,"Linear",!0,1500);n.start(),n.onUpdateCallback(function(){e.btnMic&&e.btnMic.setText(parseInt(t.score))},this),n.onComplete.add(function(){e.btnMic&&e.btnMic.setText(parseInt(e.score))},this)}},{key:"destroy",value:function(){this.removeEvent(),game.tweens.removeFrom(this.btnMic),fw(pw(t.prototype),"destroy",this).call(this)}}])&&dw(n.prototype,i),o&&dw(n,o),t}();function vw(e){return(vw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ww(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bw(e,t){return!t||"object"!==vw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _w(e,t,n){return(_w="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sw(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Sw(e){return(Sw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ew(e,t){return(Ew=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Cw=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=bw(this,Sw(t).call(this,game,0,0,null)),qe.instance().showLoading(),e.event={close:new Phaser.Signal},e.arrResource=[{type:"spritesheet",link:"img/atlas/Mic1.png",key:"Mic1",width:200,height:140,countFrame:16},{type:"spritesheet",link:"img/atlas/Mic2.png",key:"Mic2",width:200,height:140,countFrame:16},{type:"spritesheet",link:"img/atlas/Mic3.png",key:"Mic3",width:200,height:140,countFrame:60},{type:"spritesheet",link:"img/atlas/Mic4.png",key:"Mic4",width:200,height:140,countFrame:60}];var n={column:2,width:game.width,height:game.height-256*z.instance().scale,rowHeight:325*z.instance().scale,leftDistance:80*z.instance().scale,direction:"y",distanceBetweenColumns:55*z.instance().scale,distanceBetweenRows:35*z.instance().scale};return e.scroll=new hy(n),e.scroll.y=230*z.instance().scale,e.addChild(e.scroll),e.loadResource(),Le.instance().logEvent(Le.Shop_items_support),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ew(e,t)}(t,Yy),n=t,(i=[{key:"loadFileComplete",value:function(){_w(Sw(t.prototype),"loadFileComplete",this).call(this),this.header=new mw,this.header.event.back.add(this.chooseBackMenu,this),this.addChild(this.header),this.addEvent()}},{key:"chooseBackMenu",value:function(){this.event.close.dispatch()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataPackage?"ios"===z.instance().platform?Yv.instance().getDataInapp():Wv.instance().getDataInapp():(this.dataServer=this.mainData.dataPackage,this.buildData(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(LogConsole.log("cmd : "+e.cmd),LogConsole.log(e.params.getDump()),e.cmd){case Hs.RESOURCE_PACKAGE_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&(this.mainData.dataPackage=e.params,this.dataServer=this.mainData.dataPackage,this.buildData()),qe.instance().hideLoading();break;case Hs.RESOURCE_BUY_SUPPORT_ITEM_RESPONSE:"OK"===e.params.getUtfString("status")&&this.buyItemComplete(e.params.getInt("resource_up"));break;case Hs.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE:"OK"===e.params.getUtfString("status")&&"SUPPORT_ITEM"===e.params.getUtfString("resource_type")&&(this.buyItemComplete(e.params.getInt("new_resource")-e.params.getInt("old_resource")),this.mainData.dataPackage=null,"ios"===z.instance().platform?Yv.instance().getDataInapp():Wv.instance().getDataInapp()),qe.instance().hideLoading()}}},{key:"buyItemComplete",value:function(e){var t={type:"SUPPORT_ITEM",reward:e,finishPoint:{x:330*this.mainData.scale,y:45*this.mainData.scale}};IE.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,t)}},{key:"buildData",value:function(){var e,t=[];e=["Mic1","Mic2","Mic3","Mic4"];for(var n=0,i=0;i<this.dataServer.getSFSArray("resource_packages").size();i++){var o=this.dataServer.getSFSArray("resource_packages").getSFSObject(i);if(console.log(o),"SUPPORT_ITEM"===o.getUtfString("resource_type")){var a=new iw(o,n<e.length?e[n]:e[e.length-1],!0);t.push(a),n++}}this.scroll.viewList=t}},{key:"destroy",value:function(){this.scroll.viewList=[],this.removeEvent(),this.scroll.destroy(),_w(Sw(t.prototype),"destroy",this).call(this)}}])&&ww(n.prototype,i),o&&ww(n,o),t}();function kw(e){return(kw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ow(e,t){return!t||"object"!==kw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rw(e,t,n){return(Rw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xw(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xw(e){return(xw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tw(e,t){return(Tw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Iw=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Ow(this,xw(t).call(this,game,0,0,null))).event={close:new Phaser.Signal,view_all_shop:new Phaser.Signal,search_shop:new Phaser.Signal},e.ktTween=!1,e.shop=null,e.vip=null,e.buyDiamond=null,e.help=null,e.idxTab=n,e.typeSubTab=i,e.bg=new Phaser.Button(game,0,0,"bg-playlist"),e.addChild(e.bg),e.arrResource=[{type:"text",link:"img/config/positionShop.json",key:"positionShop"},{type:"atlas",link:"img/atlas/shop.png",key:"shop",linkJson:"img/atlas/shop.json"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tw(e,t)}(t,Yy),n=t,(i=[{key:"loadFileComplete",value:function(){Rw(xw(t.prototype),"loadFileComplete",this).call(this),this.menuBot=new ym(this.idxTab),this.menuBot.event.change_menu.add(this.change_menu,this),this.menuBot.y=game.height-120*z.instance().scale,this.addChild(this.menuBot),game.time.events.add(.1*Phaser.Timer.SECOND,this.change_menu,this,this.idxTab)}},{key:"change_menu",value:function(e){if(!1===this.ktTween){switch(this.idxTab=e,e){case 0:Le.instance().logEvent(Le.Shop_Vip_button),this.addShop();break;case 1:Le.instance().logEvent(Le.Shop_resource_button),this.addBuyDiamond();break;case 2:Le.instance().logEvent(Le.Shop_items_support_butotn),this.addHelp();break;case 3:Le.instance().logEvent(Le.Shop_Vip_button)}this.addChild(this.menuBot)}}},{key:"tweenVipComplete",value:function(){this.ktTween=!1,Nc.instance().event.tweenComplete.remove(this.tweenVipComplete,this),null!==this.shop&&this.shop.addEvent(),this.removeVip()}},{key:"tweenHelpComplete",value:function(){this.ktTween=!1,Nc.instance().event.tweenComplete.remove(this.tweenHelpComplete,this),null!==this.shop&&this.shop.addEvent(),this.removeHelp()}},{key:"tweenBuyDiamondComplete",value:function(){this.ktTween=!1,Nc.instance().event.tweenComplete.remove(this.tweenBuyDiamondComplete,this),null!==this.shop&&this.shop.addEvent(),this.removeBuyDiamond()}},{key:"tweenShopComplete",value:function(){this.ktTween=!1,Nc.instance().event.tweenComplete.remove(this.tweenShopComplete,this),this.removeShop()}},{key:"addShop",value:function(){this.removeShop(),this.shop=new mv,this.shop.event.close.add(this.chooseClose,this),this.addChild(this.shop),null!==this.vip?(this.ktTween=!0,Nc.instance().beginSwitch(this.vip,this.shop,!0),Nc.instance().event.tweenComplete.add(this.tweenVipComplete,this)):null!==this.help?(this.ktTween=!0,Nc.instance().beginSwitch(this.help,this.shop,!0),Nc.instance().event.tweenComplete.add(this.tweenHelpComplete,this)):null!==this.buyDiamond?(this.ktTween=!0,Nc.instance().beginSwitch(this.buyDiamond,this.shop,!0),Nc.instance().event.tweenComplete.add(this.tweenBuyDiamondComplete,this)):(this.ktTween=!0,Nc.instance().beginSwitch(null,this.shop,!0),Nc.instance().event.tweenComplete.add(this.tweenShopBeginComplete,this))}},{key:"shopSearch",value:function(e){this.event.search_shop.dispatch(e)}},{key:"showAllShop",value:function(e){this.event.view_all_shop.dispatch(e)}},{key:"tweenShopBeginComplete",value:function(){null!==this.shop&&(this.ktTween=!1,Nc.instance().event.tweenComplete.remove(this.tweenShopBeginComplete,this),this.shop.addEvent())}},{key:"removeShop",value:function(){null!==this.shop&&(this.removeChild(this.shop),this.shop.destroy(),this.shop=null)}},{key:"addVip",value:function(){this.removeVip(),this.vip=new Sv,this.addChild(this.vip),null!==this.shop&&(this.ktTween=!0,Nc.instance().beginSwitch(this.shop,this.vip,!1),Nc.instance().event.tweenComplete.add(this.tweenShopComplete,this)),null!==this.buyDiamond&&(this.ktTween=!0,Nc.instance().beginSwitch(this.buyDiamond,this.vip,!1),Nc.instance().event.tweenComplete.add(this.tweenBuyDiamondComplete,this)),null!==this.help&&(this.ktTween=!0,Nc.instance().beginSwitch(this.help,this.vip,!1),Nc.instance().event.tweenComplete.add(this.tweenHelpComplete,this))}},{key:"removeVip",value:function(){null!==this.vip&&(this.removeChild(this.vip),this.vip.destroy(),this.vip=null)}},{key:"addBuyDiamond",value:function(){this.removeBuyDiamond(),this.buyDiamond=new cw(this.typeSubTab),this.buyDiamond.event.close.add(this.chooseClose,this),this.addChild(this.buyDiamond),null!==this.shop&&(this.ktTween=!0,Nc.instance().beginSwitch(this.shop,this.buyDiamond,!1),Nc.instance().event.tweenComplete.add(this.tweenShopComplete,this)),null!==this.help&&(this.ktTween=!0,Nc.instance().beginSwitch(this.help,this.buyDiamond,!0),Nc.instance().event.tweenComplete.add(this.tweenHelpComplete,this)),null!==this.vip&&(this.ktTween=!0,Nc.instance().beginSwitch(this.vip,this.buyDiamond,!0),Nc.instance().event.tweenComplete.add(this.tweenVipComplete,this)),this.typeSubTab=""}},{key:"removeBuyDiamond",value:function(){null!==this.buyDiamond&&(this.removeChild(this.buyDiamond),this.buyDiamond.destroy(),this.buyDiamond=null)}},{key:"addHelp",value:function(){this.removeHelp(),this.help=new Cw,this.help.event.close.add(this.chooseClose,this),this.addChild(this.help),null!==this.vip&&(this.ktTween=!0,Nc.instance().beginSwitch(this.vip,this.help,!0),Nc.instance().event.tweenComplete.add(this.tweenVipComplete,this)),null!==this.shop&&(this.ktTween=!0,Nc.instance().beginSwitch(this.shop,this.help,!1),Nc.instance().event.tweenComplete.add(this.tweenShopComplete,this)),null!==this.buyDiamond&&(this.ktTween=!0,Nc.instance().beginSwitch(this.buyDiamond,this.help,!1),Nc.instance().event.tweenComplete.add(this.tweenBuyDiamondComplete,this))}},{key:"removeHelp",value:function(){null!==this.help&&(this.removeChild(this.help),this.help.destroy(),this.help=null)}},{key:"chooseClose",value:function(){this.event.close.dispatch()}},{key:"destroy",value:function(){this.mainData.positionShopData=null,this.removeBuyDiamond(),this.removeEvent(),this.removeHelp(),this.removeShop(),this.removeVip(),Rw(xw(t.prototype),"destroy",this).call(this)}}])&&Pw(n.prototype,i),o&&Pw(n,o),t}();var Aw=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=0,this.code="",this.genre="",this.id=0,this.priority=0,this.region=""};function Lw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Gw=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t={genres:[],playlists:[]};if("OK"===e.getUtfString(qs.status)){for(var n=[],i={},o=e.getSFSArray(qs.genres),a=0;a<o.size();a++){var s=o.getSFSObject(a),r=new Aw;r.code=s.getUtfString(qs.code),r.genre=s.getUtfString(qs.genre),r.id=s.getInt(qs.id),r.region=s.getUtfString(qs.region),r.parent=s.getInt(qs.parent),r.priority=s.getInt(qs.priority),i[r.id]=r.region,n.push(r)}t.genres=n;for(var l=[],h=e.getSFSArray(qs.playlists),c=0;c<h.size();c++){var u=h.getSFSObject(c),d=new Ah;if(d.is_highlight=u.getInt(qs.is_highlight),d.used_times=u.getInt(qs.used_times),d.thumb=u.getUtfString(qs.thumb),d.created=u.getLong(qs.created),d.is_owner=u.getInt(qs.is_owner),d.is_default=u.getInt(qs.is_default),d.genre_id=u.getInt(qs.genre_id),d.purchased=u.getInt(qs.purchased),d.songs=u.getUtfString(qs.songs),d.price=u.getInt(qs.price),d.is_general=u.getInt(qs.is_general),d.name=u.getUtfString(qs.name),d.id=u.getInt(qs.id),d.vip=u.getInt(qs.vip),d.is_solo_mode=u.getInt(qs.is_solo_mode),d.updated=u.getLong(qs.updated),d.country_id=u.getInt(qs.country_id),d.purchased_count=u.getInt(qs.purchased_count),i.hasOwnProperty(d.genre_id)&&(d.region=i[d.genre_id]),u.containsKey(qs.user_playlist_mapping)){var f=u.getSFSObject(qs.user_playlist_mapping);f&&(d.user.user_id=f.getInt(qs.user_id),d.user.level=f.getInt(qs.level),d.user.playlist_id=f.getInt(qs.playlist_id),d.user.exp_score=f.getInt(qs.exp_score),d.user.created=f.getLong(qs.created),d.user.active=f.getInt(qs.active),d.user.id=f.getLong(qs.id),d.user.current_level_score=f.getInt(qs.current_level_score),d.user.next_level_score=f.getInt(qs.next_level_score),d.user.updated=f.getLong(qs.updated))}1==d.is_owner||l.push(d)}t.playlists=l}return t}}],(n=null)&&Lw(t.prototype,n),i&&Lw(t,i),e}();function Dw(e){return(Dw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Nw(e,t){return!t||"object"!==Dw(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bw(e,t,n){return(Bw="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jw(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function jw(e){return(jw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uw(e,t){return(Uw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Fw=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Nw(this,jw(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uw(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={back:new Phaser.Signal},this.positionShop=this.mainData.positionShop,this.dataPlayList={genres:[],playlists:[]},this.detail=null,this.popupBuy=null,this.popupMoney=null,this.type=xm.SORT_AZ,this.local=Bm.Local,this.genres=-1,this.itemGenresActive=null,this.strSearch="",this.dataList=[],this.ktSearch=!1,this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.addChild(this.bg);var e={column:3,width:game.width,height:732*z.instance().scale,rowHeight:326*z.instance().scale,leftDistance:35*z.instance().scale,direction:"y",distanceBetweenColumns:35*z.instance().scale,distanceBetweenRows:35*z.instance().scale};this.scroll=new hy(e),this.scroll.y=376*z.instance().scale,this.addChild(this.scroll),this.bgGenres=new pt(this.positionShop.sort_play_list_bg_search_menu),this.bgGenres.height=136*z.instance().scale,this.bgGenres.y=100*z.instance().scale,this.addChild(this.bgGenres),this.line=new Zt(this.positionShop.shop_line),this.line.x=0*z.instance().scale,this.line.y=this.bgGenres.y+this.bgGenres.height-2*z.instance().scale,this.addChild(this.line);var t=new Phaser.Group(game,0,0,null);this.listGenres=new Vo(game,t,new Phaser.Rectangle(0,0,game.width,95*z.instance().scale),{direction:"x",padding:18*z.instance().scale,bouncing:!0,searchForClicks:!0}),t.x=0,t.y=112*z.instance().scale,this.addChild(t),this.header=new Mm,this.header.addEventSearch(this.searchData,this),this.header.addEventBack(this.chooseBackHeader,this),this.addChild(this.header),this.menu=new xm,this.menu.addEventChangeMenu(this.changeMenu,this),this.menu.y=238*z.instance().scale,this.addChild(this.menu),this.txtSearch=new _t(this.positionShop.sort_play_list_text_current_search,""),this.txtSearch.setTextBounds(0,0,game.width-71*z.instance().scale,59*z.instance().scale),this.addChild(this.txtSearch),this.btnCloseTextSearch=new pt(this.positionShop.sort_play_list_btn_close_search,this.chooseCloseTextSearch,this),this.addChild(this.btnCloseTextSearch),this.btnCloseTextSearch.visible=!1}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().sendData(Hs.SHOP_PLAYLIST_LOAD_REQUEST,Vs.begin())}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case Hs.SHOP_PLAYLIST_LOAD_RESPONSE:this.dataPlayList=Gw.begin(e.params),this.buildListGenres(),this.buildDataList(),!0===this.ktSearch&&(this.ktSearch=!1,this.addKeyBoard());break;case Hs.SHOP_BUY_PLAYLIST_RESPONSE:"OK"===e.params.getUtfString(ShopDataField.status)&&TF.instance().sendData(Hs.SHOP_PLAYLIST_LOAD_REQUEST,Vs.begin())}}},{key:"addKeyBoard",value:function(){this.header.addKeyBoard()}},{key:"chooseBackHeader",value:function(){LogConsole.log("chooseBackHeader"),this.event.back.dispatch()}},{key:"chooseCloseTextSearch",value:function(){this.btnCloseTextSearch.visible=!1,this.txtSearch.text="",this.strSearch="",this.buildDataList()}},{key:"changeMenu",value:function(e){this.type=e,this.buildDataList()}},{key:"setData",value:function(e,t,n,i){this.local=e,this.genres=t,this.type=n,this.ktSearch=i,""!=this.type&&this.menu.setMenu(this.type)}},{key:"changeData",value:function(e){this.dataPlayList=e,this.buildDataList()}},{key:"chooseItem",value:function(e){-1===this.genres?(this.itemGenresActive=e,this.itemGenresActive.active(),this.genres=e.getData().id):this.genres===e.getData().id?(e.deactive(),this.genres=-1,this.itemGenresActive=null):(this.itemGenresActive.deactive(),e.active(),this.genres=e.getData().id,this.itemGenresActive=e),this.listGenres.tweenToItem(e.idx,.5),this.buildDataList()}},{key:"searchData",value:function(e){if(LogConsole.log("searchData : "+e),this.strSearch=e,this.txtSearch.text=this.strSearch,""!=this.strSearch){this.btnCloseTextSearch.visible=!0,this.dataList=[];for(var t=0;t<this.dataPlayList.playlists.length;t++)-1!==this.xoa_dau(this.dataPlayList.playlists[t].name).toUpperCase().indexOf(this.xoa_dau(e).toUpperCase())&&this.dataList.push(this.dataPlayList.playlists[t])}else this.btnCloseTextSearch.visible=!1;this.buildDataList()}},{key:"buildDataList",value:function(){""===this.strSearch?this.type===xm.SORT_AZ?this.dataList=this.dataPlayList.playlists.sort(this.sortTopNgheSi):this.type===xm.SORT_NEW?this.dataList=this.dataPlayList.playlists.sort(this.sortNewPlayList):this.type===xm.SORT_POP?this.dataList=this.dataPlayList.playlists.sort(this.sortPhoBien):this.dataList=this.dataPlayList.playlists.sort(this.sortAZ):this.type===xm.SORT_AZ?this.dataList.sort(this.sortTopNgheSi):this.type===xm.SORT_NEW?this.dataList.sort(this.sortNewPlayList):this.type===xm.SORT_POP?this.dataList.sort(this.sortPhoBien):this.dataList.sort(this.sortAZ);for(var e=[],t=-1,n=0;n<this.dataList.length;n++)if((-1===this.genres||this.dataList[n].genre_id===this.genres)&&this.local===this.dataList[n].region&&1!==this.dataList[n].is_owner){t++;var i=new hg;i.event.CHOOSE.add(this.chooseItemShop,this),i.event.BUY.add(this.buyItemShop,this),i.setData(this.dataList[n],t),e.push(i)}this.scroll.viewList=e}},{key:"buildListGenres",value:function(){this.listGenres.removeAll(),this.listGenres.reset();for(var e=-1,t=-1,n=0;n<this.dataPlayList.genres.length;n++)if(this.dataPlayList.genres[n].region===this.local){t++;var i=new Vm(this.chooseItem,this);this.dataPlayList.genres[n].id===this.genres?(this.itemGenresActive=i,i.active(),e=t):i.deactive(),i.y=15*this.mainData.scale,i.setData(this.dataPlayList.genres[n],t),this.listGenres.add(i)}e>-1&&this.listGenres.tweenToItem(e,.5)}},{key:"chooseItemShop",value:function(e){KeyBoard.instance().hide(),IE.instance().addPlaylistDetail(e.id)}},{key:"buyItemShop",value:function(e){IE.instance().buyItem(e)}},{key:"destroy",value:function(){LogConsole.log("destroy - ShopSortPlayList"),this.removeEvent(),this.bg.destroy(),this.header.destroy(),this.menu.destroy(),this.txtSearch.destroy(),this.btnCloseTextSearch.destroy(),this.listGenres.removeAll(),this.listGenres.destroy(),this.scroll.destroy(),this.removeAllItem(),IE.instance().removePlaylistDetail(),IE.instance().removePopupBuy(),IE.instance().removePopupMoney(),Bw(jw(t.prototype),"destroy",this).call(this)}}])&&Mw(n.prototype,i),o&&Mw(n,o),t}();function Zw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Hw=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("resource_package_id",e),t}}],(n=null)&&Zw(t.prototype,n),i&&Zw(t,i),e}();function Qw(e){return(Qw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ww(e){return(Ww=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qw(e,t){return(qw=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kw(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var zw=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=Ww(t).call(this,game,0,0,null))||"object"!==Qw(s)&&"function"!=typeof s?Kw(a):s).event={exit:new Phaser.Signal},o.positionShop=o.mainData.positionShop,o.data=e,o.bg=new $i,o.bg.y=96,o.addChild(o.bg),o.icon=new Phaser.Sprite(game,0,0,n),o.icon.smoothed=!0,o.icon.animations.pause=!0,o.icon.animations.add("shop"+n),o.icon.animations.play("shop"+n,30,!0),o.icon.width=2*o.icon.width,o.icon.height=2*o.icon.height,o.icon.x=(o.bg.width-o.icon.width)/2,o.icon.y=(200*o.mainData.scale-o.icon.height)/2,o.addChild(o.icon),o.txtName=new _t(o.positionShop.popup_confirm_txt_name,e.getUtfString("name")),o.txtName.setTextBounds(0,0,o.bg.width,64),o.addChild(o.txtName),o.txtPrice=new _t(o.positionShop.popup_confirm_txt_price,e.getInt("quantity")),o.txtPrice.setTextBounds(0,0,o.bg.width,48),o.addChild(o.txtPrice),o.txtDes=new _t(o.positionShop.popup_confirm_txt_des,"Bạn có muốn sở hữu số tài nguyên này không?"),o.txtDes.setTextBounds(0,0,o.bg.width,91),o.addChild(o.txtDes),o.btnThoat=new ln(o.positionShop.popup_confirm_button_thoat,"THOÁT",o.chooseExit,Kw(Kw(o))),o.addChild(o.btnThoat),o.btnBuy=i?new ln(o.positionShop.popup_confirm_button_mua_diamond,e.getInt("price"),o.chooseBuyDiamond,Kw(Kw(o))):new ln(o.positionShop.popup_confirm_button_mua,e.getInt("price")+"đ",o.chooseBuy,Kw(Kw(o))),o.addChild(o.btnBuy),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qw(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch()}},{key:"chooseBuyDiamond",value:function(){this.btnBuy.inputEnabled=!1,TF.instance().sendData(Hs.RESOURCE_BUY_SUPPORT_ITEM_REQUEST,Hw.begin(this.data.getInt("id"))),this.event.exit.dispatch()}}])&&Vw(n.prototype,i),o&&Vw(n,o),t}();function Yw(e){return(Yw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jw(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xw(e){return(Xw=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $w(e,t){return($w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function eb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var tb=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=Xw(t).call(this,game,0,0,null))||"object"!==Yw(s)&&"function"!=typeof s?eb(a):s).event={exit:new Phaser.Signal},o.bg=new Phaser.Button(game,0,0,"screen-dim"),o.addChild(o.bg),o.popup=new zw(e,n,i),o.popup.event.exit.add(o.chooseExit,eb(eb(o))),o.popup.x=35*o.mainData.scale,o.popup.y=game.height,o.addChild(o.popup),o.tweenItemPopup(o.popup,275*o.mainData.scale),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$w(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch()}}])&&Jw(n.prototype,i),o&&Jw(n,o),t}();function nb(e){return(nb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ib(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ob(e,t){return!t||"object"!==nb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ab(e){return(ab=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sb(e,t){return(sb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rb=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ob(this,ab(t).call(this,game))).quest=e,n.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),n.dailyRewardConfig=JSON.parse(game.cache.getText("dailyRewardConfig")),n.eventInput={claim:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sb(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.screenDim,this.addScreenDim(),this.headerResource,this.addHeaderResource(),this.popup,this.addPopup(),Le.instance().logEvent(Le.Popup_Quest)}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.addChild(this.screenDim)}},{key:"addHeaderResource",value:function(){this.headerResource=new Phaser.Group(game,0,0),this.addChild(this.headerResource),this.txtGem,this.txtTicket,this.txtMic,this.tabGemHeader,this.tabTicketHeader,this.tabMicHeader,this.addTabGemHeader(this.dailyRewardConfig.header),this.addTabTicketHeader(this.dailyRewardConfig.header),this.addTabMicHeader(this.dailyRewardConfig.header)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.dailyRewardConfig.header.gem);this.txtGem=this.addTxtGem(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtGem.width;this.txtGem.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtGem.width+10*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(this.txtGem),this.headerResource.addChild(this.tabGemHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return"DIAMOND"==this.quest.reward_type?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value-this.quest.reward,e.configs):new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addTabTicketHeader",value:function(e){this.tabTicketHeader=new Phaser.Sprite(game,e.tabTicket.x*window.GameConfig.RESIZE,e.tabTicket.y*window.GameConfig.RESIZE,e.tabTicket.nameAtlas,e.tabTicket.nameSprite);var t=this.addTicket(this.dailyRewardConfig.header.ticket);this.txtTicket=this.addTxtTicket(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtTicket.width;this.txtTicket.x=(this.tabTicketHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabTicketHeader.width-n)/2+this.txtTicket.width+10*window.GameConfig.RESIZE,this.tabTicketHeader.addChild(t),this.tabTicketHeader.addChild(this.txtTicket),this.headerResource.addChild(this.tabTicketHeader)}},{key:"addTicket",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtTicket",value:function(e){return"TICKET"==this.quest.reward_type?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("ticket").value-this.quest.reward,e.configs):new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("ticket").value,e.configs)}},{key:"addTabMicHeader",value:function(e){this.tabMicHeader=new Phaser.Sprite(game,e.tabMic.x*window.GameConfig.RESIZE,e.tabMic.y*window.GameConfig.RESIZE,e.tabMic.nameAtlas,e.tabMic.nameSprite);var t=this.addMic(this.dailyRewardConfig.header.micro);this.txtMic=this.addTxtMic(this.dailyRewardConfig.header.txtResource);var n=t.width+this.txtMic.width;this.txtMic.x=(this.tabMicHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabMicHeader.width-n)/2+this.txtMic.width+10*window.GameConfig.RESIZE,this.tabMicHeader.addChild(t),this.tabMicHeader.addChild(this.txtMic),this.headerResource.addChild(this.tabMicHeader)}},{key:"addMic",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtMic",value:function(e){return"SUPPORT_ITEM"==this.quest.reward_type?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("support_item").value-this.quest.reward,e.configs):new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("support_item").value,e.configs)}},{key:"addPopup",value:function(){this.txtPopup,this.rewardClaimed,this.txtQuestReward,this.btnClaim,this.popup=new $i,this.popup.x=35*window.GameConfig.RESIZE,this.popup.y=1140*window.GameConfig.RESIZE,this.popup.setHeight(400*window.GameConfig.RESIZE),this.addTxtPopup(),this.addRewardClaimed(),this.addTxtQuestReward(),this.addBtnClaim(),this.addChild(this.popup)}},{key:"addTxtPopup",value:function(){this.txtPopup=new Phaser.Text(game,this.positionQAndAConfig.txtPopupClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.txtPopupClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.txtPopupClaim.text,this.positionQAndAConfig.txtPopupClaim.configs),this.txtPopup.anchor.set(.5,0),this.popup.addChild(this.txtPopup)}},{key:"addRewardClaimed",value:function(){if(this.rewardClaimed=new Phaser.Text(game,this.positionQAndAConfig.rewardClaimed.x*window.GameConfig.RESIZE,this.positionQAndAConfig.rewardClaimed.y*window.GameConfig.RESIZE,this.quest.reward,this.positionQAndAConfig.rewardClaimed.configs),"DIAMOND"==this.quest.reward_type)(e=new Phaser.Sprite(game,this.positionQAndAConfig.gemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.gemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.gemClaim.nameAtlas,this.positionQAndAConfig.gemClaim.nameSprite)).scale.set(1.2);else if("TICKET"==this.quest.reward_type){(e=new Phaser.Sprite(game,this.positionQAndAConfig.ticketClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.ticketClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.ticketClaim.nameAtlas,this.positionQAndAConfig.ticketClaim.nameSprite)).scale.set(1.2)}else{var e;(e=new Phaser.Sprite(game,this.positionQAndAConfig.sptItemClaim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.sptItemClaim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.sptItemClaim.nameAtlas,this.positionQAndAConfig.sptItemClaim.nameSprite)).scale.set(1.2)}var t=this.rewardClaimed.width+e.width;this.rewardClaimed.x=(570*window.GameConfig.RESIZE-t)/2-5*window.GameConfig.RESIZE,e.x=(570*window.GameConfig.RESIZE-t)/2+this.rewardClaimed.width+10*window.GameConfig.RESIZE,this.popup.addChild(this.rewardClaimed),this.popup.addChild(e)}},{key:"addTxtQuestReward",value:function(){this.txtQuestReward=new Phaser.Text(game,this.positionQAndAConfig.questReward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.questReward.y*window.GameConfig.RESIZE,this.quest.quest,this.positionQAndAConfig.questReward.configs),this.txtQuestReward.anchor.set(.5,0),this.popup.addChild(this.txtQuestReward)}},{key:"addBtnClaim",value:function(){var e=this;this.btnClaim=new Phaser.Sprite(game,285*window.GameConfig.RESIZE,295*window.GameConfig.RESIZE,"questAndAchieveSprites","Button_Nhan_popup"),this.btnClaim.anchor.set(.5,0);var t=new Phaser.Text(game,0,27*window.GameConfig.RESIZE,"NHẬN",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:30});t.anchor.set(.5,0),this.btnClaim.addChild(t),this.btnClaim.inputEnabled=!0,this.btnClaim.events.onInputUp.add(function(){e.btnClaim.inputEnabled=!1,ce.instance().playSound(ce.buttonclick);var t={x:0,y:0};"DIAMOND"==e.quest.reward_type?(t.x=351,t.y=55):"TICKET"==e.quest.reward_type?(t.x=529,t.y=55):(t.x=164,t.y=55),IE.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:e.quest.reward_type,reward:e.quest.reward,finishPoint:t}),e.timeUpdateRs=game.time.events.add(2*Phaser.Timer.SECOND,function(){e.updateVariableResource(e.quest)},e),IE.instance().animClaimReward.event.tweenDoneAll.add(e.onClaimDone,e)},this),this.popup.addChild(this.btnClaim)}},{key:"updateVariableResource",value:function(e){var t=this;if("DIAMOND"==e.reward_type){var n=game.add.tween(this.txtGem).to({text:TF.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.txtGem.text=parseInt(t.txtGem.text)},this)}else if("TICKET"==e.reward_type){var i=game.add.tween(this.txtTicket).to({text:TF.instance().socket.mySelf.getVariable("ticket").value},300,"Linear",!1);i.start(),i.onUpdateCallback(function(){t.txtTicket.text=parseInt(t.txtTicket.text)},this)}else if("SUPPORT_ITEM"==e.reward_type){var o=game.add.tween(this.txtMic).to({text:TF.instance().socket.mySelf.getVariable("support_item").value},300,"Linear",!1);o.start(),o.onUpdateCallback(function(){t.txtMic.text=parseInt(t.txtMic.text)},this)}}},{key:"onClaimDone",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-430*window.GameConfig.RESIZE},400,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.eventInput.claim.dispatch(),e.destroy()},this)}},{key:"makeTweenPopup",value:function(){ce.instance().playSound(ce.popupfinishquest),game.add.tween(this.popup).to({y:(game.height-763)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Elastic.Out,!1).start()}},{key:"onClose",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-430*window.GameConfig.RESIZE},200,Phaser.Easing.Linear.Out,!1);t.start(),t.onComplete.add(function(){e.destroy()},this),this.popup.event.close.remove(this.onClose,this)}},{key:"destroy",value:function(){for(game.time.events.remove(this.timeUpdateRs);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&ib(n.prototype,i),o&&ib(n,o),t}();function lb(e){return(lb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cb(e){return(cb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ub(e,t){return(ub=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function db(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var fb=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=cb(t).call(this,game,0,0,null))||"object"!==lb(o)&&"function"!=typeof o?db(i):o).event={complete:new Phaser.Signal},n.timerToCountTime=null,n.graphics=game.add.graphics(0,0),n.graphics.beginFill(0,.8),n.graphics.drawRect(0,0,game.width,60*z.instance().scale),n.graphics.endFill(),n.addChild(n.graphics),n.txtContent=new _t({x:0,y:0,style:{fontSize:26*z.instance().scale}},e),n.addChild(n.txtContent),n.txtContent.x=game.width,n.txtContent.y=15,n.timerToCountTime=n.game.time.create(!0),n.timerToCountTime.loop(20,n.onTimerToCountTime,db(db(n))),n.timerToCountTime.start(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ub(e,t)}(t,Mt),n=t,(i=[{key:"onTimerToCountTime",value:function(){this.txtContent.x-=3,this.txtContent.x<-this.txtContent.width&&(this.timerToCountTime.stop(),this.event.complete.dispatch())}},{key:"destroyTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy())}},{key:"destroy",value:function(){this.graphics.clear(),this.destroyTime(),this.removeAllItem()}}])&&hb(n.prototype,i),o&&hb(n,o),t}();function pb(e){return(pb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yb(e,t){return!t||"object"!==pb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mb(e,t,n){return(mb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vb(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function vb(e){return(vb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wb(e,t){return(wb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bb=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yb(this,vb(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wb(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.eventBack=new Phaser.Signal,this.positionShop=this.mainData.positionDetailPlaylist,this.bg=new rt(this.positionShop.sort_play_list_bg_top_menu),this.addChild(this.bg),this.btnBack=new pt(this.positionShop.sort_play_list_bg_back_top_menu,this.chooseBack,this),this.addChild(this.btnBack),this.btnDiamond=new ln(this.positionShop.sort_play_list_bg_diamond_top_menu,TF.instance().dataMySeft.diamond),this.addChild(this.btnDiamond),De.instance().event.backButton.add(this.chooseBack,this)}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack"),this.dispatchEventBack()}},{key:"addEventBack",value:function(e,t){this.eventBack.add(e,t)}},{key:"removeEventBack",value:function(e,t){this.eventBack.remove(e,t)}},{key:"dispatchEventBack",value:function(){this.eventBack.dispatch()}},{key:"destroy",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),mb(vb(t.prototype),"destroy",this).call(this)}}])&&gb(n.prototype,i),o&&gb(n,o),t}();function _b(e){return(_b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Eb(e,t){return!t||"object"!==_b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cb(e){return(Cb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kb(e,t){return(kb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Pb=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Eb(this,Cb(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kb(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.data=new Zh,this.positionShop=this.mainData.positionDetailPlaylist,this.bg=new Phaser.Button(game,0,0,"bg-playlist",this.chooseDetail,this),this.bg.alpha=0,this.bg.width=this.width,this.bg.height=this.height,this.addChild(this.bg),this.line=new rt(this.positionShop.detail_playlist_item_line),this.line.width=570*z.instance().scale,this.addChild(this.line),this.txtNameSong=new _t(this.positionShop.detail_playlist_item_name_song),this.txtNameSong.setTextBounds(0,0,551*z.instance().scale,59*z.instance().scale),this.addChild(this.txtNameSong),this.txtNameCaSi=new _t(this.positionShop.detail_playlist_item_name_casi),this.txtNameCaSi.setTextBounds(0,0,551*z.instance().scale,31*z.instance().scale),this.addChild(this.txtNameCaSi),this.btnDetailSong=new pt(this.positionShop.detail_playlist_btn_detail_song,this.chooseDetail,this),this.addChild(this.btnDetailSong)}},{key:"chooseDetail",value:function(){LogConsole.log("chooseDetail"),IE.instance().addDetailSong(this.data)}},{key:"hideLine",value:function(){this.line.visible=!1}},{key:"setData",value:function(e){this.data=e,this.txtNameSong.text=this.data.title,this.txtNameCaSi.text=this.data.singer}},{key:"width",get:function(){return 586*z.instance().scale}},{key:"height",get:function(){return 115*z.instance().scale}}])&&Sb(n.prototype,i),o&&Sb(n,o),t}();function Ob(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Rb=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){var n=new SFS2X.SFSObject;return n.putInt("playlist_id",e),n.putInt("active",t),n}}],(n=null)&&Ob(t.prototype,n),i&&Ob(t,i),e}();function xb(e){return(xb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Ib(e,t){return!t||"object"!==xb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ab(e,t,n){return(Ab="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lb(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Lb(e){return(Lb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gb(e,t){return(Gb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Db=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ib(this,Lb(t).call(this,game,0,0,null))).playListDetail=new Ah,n.playlist_id=e,n.eventBack=new Phaser.Signal,n.arrResource=[{type:"text",link:"img/config/positionDetailPlaylist.json",key:"positionDetailPlaylist"},{type:"atlas",link:"img/atlas/detailplaylist.png",key:"detailplaylist",linkJson:"img/atlas/detailplaylist.json"}],n.loadResource(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gb(e,t)}(t,Yy),n=t,(i=[{key:"loadFileComplete",value:function(){Ab(Lb(t.prototype),"loadFileComplete",this).call(this),this.buildScreen()}},{key:"buildScreen",value:function(){this.positionShop=this.mainData.positionDetailPlaylist,this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.addChild(this.bg),this.popupBuy=null,this.popupMoney=null,this.header=new bb,this.header.addEventBack(this.chooseBack,this),this.addChild(this.header),this.ava=new dh,this.ava.setSize(163*z.instance().scale,163*z.instance().scale),this.ava.x=234*z.instance().scale,this.ava.y=148*z.instance().scale,this.addChild(this.ava),this.namePlayList=new _t(this.positionShop.detail_playlist_name,""),this.namePlayList.setTextBounds(0,0,game.width-47*z.instance().scale,41*z.instance().scale),this.addChild(this.namePlayList),this.detailPlayList=new _t(this.positionShop.detail_playlist_detail,""),this.detailPlayList.setTextBounds(0,0,533*z.instance().scale,118*z.instance().scale),this.addChild(this.detailPlayList),this.btnBuy=new ln(this.positionShop.playlist_button_buy,"0",this.chooseBuy,this),this.btnBuy.visible=!1,this.btnBuy.x=(game.width-this.btnBuy.width)/2,this.addChild(this.btnBuy),this.btnKichHoat=new ln(this.positionShop.detail_button_kichhoat,"aaaaaaaa",this.chooseKickHoat,this),this.btnKichHoat.visible=!1,this.addChild(this.btnKichHoat),this.btnBuy.y=this.positionShop.detail_button_kichhoat.y*z.instance().scale,this.txtBaiHat=new _t(this.positionShop.detail_playlist_lb_baihat,"Bài hát"),this.txtBaiHat.setTextBounds(0,0,207*z.instance().scale,35*z.instance().scale),this.addChild(this.txtBaiHat),this.levelPlayList=new Ch,this.levelPlayList.x=this.ava.x+(this.ava.width-this.levelPlayList.width)/2,this.levelPlayList.y=373*z.instance().scale,this.addChild(this.levelPlayList),this.txtCountBaiHat=new _t(this.positionShop.detail_playlist_lb_count_baihat,"0"),this.txtCountBaiHat.setTextBounds(0,0,189*z.instance().scale,31*z.instance().scale),this.addChild(this.txtCountBaiHat);var e=new Phaser.Group(game,0,0,null);this.listSong=new Vo(game,e,new Phaser.Rectangle(0,0,586*z.instance().scale,420*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),e.x=35*z.instance().scale,e.y=708*z.instance().scale,this.addChild(e),this.line=new rt(this.positionShop.detail_playlist_item_line),this.line.width=570*z.instance().scale,this.addChild(this.line),this.activeBaiHat=new rt(this.positionShop.detail_playlist_active_baihat),this.addChild(this.activeBaiHat),this.line.y=this.activeBaiHat.y+3,this.line.x=this.activeBaiHat.x,this.addEvent()}},{key:"addEventBack",value:function(e,t){this.eventBack.add(e,t)}},{key:"removeEventBack",value:function(e,t){this.eventBack.remove(e,t)}},{key:"dispatchEventBack",value:function(){this.eventBack.dispatch()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().sendData(Hs.PLAYLIST_DETAIL_REQUEST,Fh.begin(this.playlist_id))}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case Hs.PLAYLIST_DETAIL_RESPONSE:LogConsole.log("PLAYLIST_DETAIL_RESPONSE : "+e.params.getDump()),"OK"===e.params.getUtfString(qs.status)&&(this.playListDetail=Wh.begin(e.params),this.buildDataDetail());break;case Hs.PLAYLIST_CHANGE_ACTIVE_RESPONSE:case Hs.SHOP_BUY_PLAYLIST_RESPONSE:"OK"===e.params.getUtfString(qs.status)&&TF.instance().sendData(Hs.PLAYLIST_DETAIL_REQUEST,Fh.begin(this.playlist_id))}}},{key:"buildDataDetail",value:function(){this.ava.beginLoad(this.playListDetail.thumb,1),this.namePlayList.text=this.playListDetail.name,this.btnBuy.setText(this.playListDetail.price),this.txtCountBaiHat.text=this.playListDetail.arrSong.length,this.detailPlayList.text=this.playListDetail.description,this.levelPlayList.setData(this.playListDetail.user),this.levelPlayList.x=this.ava.x+(this.ava.width-this.levelPlayList.width)/2,this.listSong.removeAll(),this.listSong.reset();for(var e=0;e<this.playListDetail.arrSong.length;e++){var t=new Pb;0===e&&t.hideLine(),t.setData(this.playListDetail.arrSong[e]),this.listSong.add(t)}1==this.playListDetail.is_owner?(this.btnBuy.visible=!1,this.btnKichHoat.visible=!0,0===this.playListDetail.user.active?this.btnKichHoat.setText("KÍCH HOẠT"):this.btnKichHoat.setText("HỦY")):(this.btnBuy.visible=!0,this.btnKichHoat.visible=!1)}},{key:"chooseBuy",value:function(){IE.instance().buyItem(this.playListDetail)}},{key:"chooseKickHoat",value:function(){var e=0;e=0===this.playListDetail.user.active?1:0,TF.instance().sendData(Hs.PLAYLIST_CHANGE_ACTIVE_REQUEST,Rb.begin(this.playlist_id,e))}},{key:"chooseBack",value:function(){this.dispatchEventBack()}},{key:"destroy",value:function(){this.removeEvent(),this.mainData.positionDetailPlaylistData=null,this.listSong.removeAll(),this.listSong.destroy(),IE.instance().removePopupBuy(),IE.instance().removePopupMoney(),Ab(Lb(t.prototype),"destroy",this).call(this)}}])&&Tb(n.prototype,i),o&&Tb(n,o),t}();function Mb(e){return(Mb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Bb(e,t,n){return(Bb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jb(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function jb(e){return(jb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ub(e,t){return(Ub=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Fb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Zb=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=jb(t).call(this,game,0,0,null))||"object"!==Mb(i)&&"function"!=typeof i?Fb(n):i).event={close:new Phaser.Signal},e.tweenAlphaText=null,e.level=o,e.dialog=new Fi,e.dialog.event.close.add(e.chooseClose,Fb(Fb(e))),e.dialog.setHeight(420*z.instance().scale),e.addChild(e.dialog),e.levelUp=new Phaser.Sprite(game,0,0,"LevelUp"),e.levelUp.width=444*z.instance().scale,e.levelUp.height=270.47*z.instance().scale,e.levelUp.x=62*z.instance().scale,e.levelUp.y=29*z.instance().scale,e.levelUp.smoothed=!0,e.levelUp.animations.pause=!0,e.anim=e.levelUp.animations.add("playLevelUp"),e.anim.enableUpdate=!0,e.levelUp.animations.play("playLevelUp",30,!0),e.addChild(e.levelUp),e.anim.onUpdate.add(e.animationUpdate,Fb(Fb(e)));return e.txtLeveUp=new _t({x:0,y:0,style:{fontSize:32,wordWrap:!0,wordWrapWidth:388,align:"center",boundsAlignH:"center",boundsAlignV:"middle",fill:"#000000",font:"GilroyBold"}},"Chúc mừng bạn đã lên Level "+o),e.txtLeveUp.setTextBounds(0,0,568*.7*z.instance().scale,118*z.instance().scale),e.txtLeveUp.lineSpacing=12*z.instance().scale,e.txtLeveUp.y=296*z.instance().scale,e.txtLeveUp.x=(568-568*.7)*z.instance().scale/2,e.addChild(e.txtLeveUp),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ub(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseClose,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseClose,this)}},{key:"animationUpdate",value:function(){console.log("animationUpdate: "+this.levelUp.animations.frame),59===this.levelUp.animations.frame&&this.levelUp.animations.stop()}},{key:"chooseClose",value:function(){var e=Mr.instance().getItem(Mr.VOTE);console.log("voteCheck : "+e),"error"===e||null===e||"null"===e?this.checkShowVote(this.level):"VoteSau"===e&&this.checkShowVote(this.level),this.event.close.dispatch()}},{key:"setData",value:function(e){this.level=e,this.txtLeveUp.text="Chúc mừng bạn đã lên Level "+e,this.levelUp.animations.play("playLevelUp",30,!0)}},{key:"checkShowVote",value:function(e){(console.log("voteCheck : "+e),e>5)?(e-6)%2==0&&IE.instance().addSuggetRating():5===e&&IE.instance().addSuggetRating()}},{key:"destroy",value:function(){this.removeEvent(),null!==this.tweenAlphaText&&(this.tweenAlphaText.stop(),game.tweens.remove(this.tweenAlphaText),this.tweenAlphaText=null),this.anim.destroy(),this.removeAllItem(),Bb(jb(t.prototype),"destroy",this).call(this)}}])&&Nb(n.prototype,i),o&&Nb(n,o),t}();function Hb(e){return(Hb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Vb(e,t,n){return(Vb="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Wb(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Wb(e){return(Wb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qb(e,t){return(qb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kb(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var zb=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=Wb(t).call(this,game,0,0,null))||"object"!==Hb(o)&&"function"!=typeof o?Kb(i):o).level_up=e,n.event={close:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"screen-dim",n.closeLevelUp,Kb(Kb(n))),n.addChild(n.bg),n.arrResource=[{type:"spritesheet",link:"img/atlas/LevelUp.png",key:"LevelUp",width:240,height:146,countFrame:61}],n.loadResource(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qb(e,t)}(t,Yy),n=t,(i=[{key:"loadFileComplete",value:function(){Vb(Wb(t.prototype),"loadFileComplete",this).call(this),this.level=new Zb(this.level_up),this.level.event.close.add(this.closeLevelUp,this),this.level.x=35*z.instance().scale,this.addChild(this.level),this.level.y=game.height-89*z.instance().scale,this.tweenItemPopup(this.level,385*z.instance().scale),ce.instance().playSound(ce.popuplevelup)}},{key:"closeLevelUp",value:function(){this.event.close.dispatch(),ce.instance().removeSound()}}])&&Qb(n.prototype,i),o&&Qb(n,o),t}();function Yb(e){return(Yb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jb(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Xb(e){return(Xb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $b(e,t){return($b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function e_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var t_=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=Xb(t).call(this,game,0,0,null))||"object"!==Yb(i)&&"function"!=typeof i?e_(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.popup=new sh,e.popup.setTextOk("ĐỒNG Ý"),e.popup.setTextCancle("QUAY LẠI"),e.popup.event.OK.add(e.chooseOk,e_(e_(e))),e.popup.event.CANCLE.add(e.chooseCancle,e_(e_(e))),e.popup.setHeight(580*e.mainData.scale),e.addChild(e.popup),e.dia=new Phaser.Sprite(game,0,0,"disconnect"),e.dia.width=228*e.mainData.scale,e.dia.height=228*e.mainData.scale,e.dia.x=172*e.mainData.scale,e.dia.y=70*e.mainData.scale,e.dia.smoothed=!0,e.dia.animations.pause=!0,e.anim=e.dia.animations.add("disconnect"),e.anim.enableUpdate=!0,e.addChild(e.dia),e.dia.animations.play("disconnect",30,!0);var o=new _t(e.mainData.positionPopup.bad_connection_label_thongbao,"Kết nối internet của bạn không tốt");return o.setTextBounds(0,0,e.popup.width,30*e.mainData.scale),e.addChild(o),e.lbConfirm=new _t(e.mainData.positionPopup.bad_connection_label_confirm,"Nếu bạn vẫn muốn chơi có thể bạn sẽ phải nghe nhạc chất lượng thấp."),e.lbConfirm.setTextBounds(0,0,e.popup.width,50*e.mainData.scale),e.addChild(e.lbConfirm),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$b(e,t)}(t,Mt),n=t,(i=[{key:"setTextConfirm",value:function(e){this.lbConfirm.text=e}},{key:"setTextOk",value:function(e){this.popup.setTextOk(e)}},{key:"setTextCancle",value:function(e){this.popup.setTextCancle(e)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}}])&&Jb(n.prototype,i),o&&Jb(n,o),t}();function n_(e){return(n_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o_(e){return(o_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a_(e,t){return(a_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s_(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var r_=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=o_(t).call(this,game,0,0,null))||"object"!==n_(i)&&"function"!=typeof i?s_(n):i).event={OK:new Phaser.Signal,CANCLE:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.popup=new t_,e.popup.event.OK.add(e.chooseOk,s_(s_(e))),e.popup.event.CANCLE.add(e.chooseCancle,s_(s_(e))),e.popup.x=35*e.mainData.scale,e.popup.y=game.height+237*e.mainData.scale,e.tweenItemPopup(e.popup,game.height-810*e.mainData.scale),e.addChild(e.popup),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a_(e,t)}(t,Mt),n=t,(i=[{key:"setTextOk",value:function(e){this.popup.setTextOk(e)}},{key:"setTextCancle",value:function(e){this.popup.setTextCancle(e)}},{key:"setTextConfirm",value:function(e){this.popup.setTextConfirm(e)}},{key:"chooseOk",value:function(){this.event.OK.dispatch()}},{key:"chooseCancle",value:function(){this.event.CANCLE.dispatch()}}])&&i_(n.prototype,i),o&&i_(n,o),t}();function l_(e){return(l_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c_(e,t){return!t||"object"!==l_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u_(e){return(u_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d_(e,t){return(d_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f_=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=c_(this,u_(t).call(this,game,e,n,"settingSprites","Hoso_Box_Ten"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),a.label=i,a.valueText=o,a.afterInit(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d_(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){var e=Bn.formatName(this.valueText,21);this.valueText=e,this.labelTxt,this.valueTextTxt,this.addLabel(),this.addValueText()}},{key:"addLabel",value:function(){this.label=new Phaser.Text(game,this.positionSetting.setting_profile.lbl_box.x,this.positionSetting.setting_profile.lbl_box.y,this.label,this.positionSetting.setting_profile.lbl_box.style),this.addChild(this.label)}},{key:"addValueText",value:function(){this.valueTextTxt=new Phaser.Text(game,this.positionSetting.setting_profile.value_box.x,this.positionSetting.setting_profile.value_box.y,this.valueText,this.positionSetting.setting_profile.value_box.style),this.addChild(this.valueTextTxt)}}])&&h_(n.prototype,i),o&&h_(n,o),t}();function p_(e){return(p_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function y_(e,t){return!t||"object"!==p_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m_(e){return(m_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function v_(e,t){return(v_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var w_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=y_(this,m_(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),null!==TF.instance().socket.mySelf&&(e.name=TF.instance().dataMySeft.user_name),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&v_(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.boxName,this.boxLocation,this.addBoxName(),this.addBoxLocation()}},{key:"addBoxName",value:function(){this.boxName=new f_(255*z.instance().scale,169*z.instance().scale,this.positionSetting.setting_profile.lbl_box.name,this.name),this.addChild(this.boxName)}},{key:"addBoxLocation",value:function(){this.boxLocation=new f_(255*z.instance().scale,255*z.instance().scale,this.positionSetting.setting_profile.lbl_box.location,"Việt Nam"),this.addChild(this.boxLocation)}}])&&g_(n.prototype,i),o&&g_(n,o),t}();function b_(e){return(b_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function __(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function S_(e,t){return!t||"object"!==b_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function E_(e){return(E_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C_(e,t){return(C_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var k_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=S_(this,E_(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.description=z.instance().userDescription,e.event={changeDes:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&C_(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.lbl,this.box,this.addLabel(),this.addBox()}},{key:"addLabel",value:function(){this.lbl=new _t(this.positionSetting.setting_profile.lbl_des,this.positionSetting.setting_profile.lbl_des.text),this.addChild(this.lbl)}},{key:"addBox",value:function(){this.box=new pt(this.positionSetting.setting_profile.box_des,this.onClickBox,this);var e=new rt(this.positionSetting.setting_profile.icon_edit);this.box.addChild(e),this.desText=new _t(this.positionSetting.setting_profile.txt_des,this.description),this.tick=new rt(this.positionSetting.setting_profile.tick_des),this.box.addChild(this.tick),this.box.addChild(this.desText),this.addChild(this.box)}},{key:"onClickBox",value:function(){this.inputKeyboard(),this.tick.kill()}},{key:"inputKeyboard",value:function(){var e={maxLength:"",showTransparent:!0,placeholder:"Nhập trạng thái",isSearch:!1,typeInputText:"input",configText:{width:this.box.width-70,height:this.box.height-5,x:this.box.x,y:this.box.y}};$r.instance().event.cancle.add(this.keyboardClose,this),$r.instance().event.enter.add(this.keyboardDone,this),$r.instance().event.submit.add(this.keyboardDone,this),$r.instance().show(e),$r.instance().setValue(this.description)}},{key:"keyboardClose",value:function(){$r.instance().event.cancle.remove(this.keyboardClose,this),$r.instance().event.enter.remove(this.keyboardDone,this),$r.instance().event.submit.remove(this.keyboardDone,this),$r.instance().hide(),this.box.revive()}},{key:"keyboardDone",value:function(){this.description=$r.instance().getValue(),this.changeTxtBoxText(),this.sendDes(),this.keyboardClose()}},{key:"sendDes",value:function(){gl.instance().settingAccount(TF.instance().socket.mySelf.getVariable("user_id").value,TF.instance().dataMySeft.user_name,TF.instance().socket.mySelf.getVariable("gender").value,null,this.description),gl.instance().sendData(this.onSendSettingDone.bind(this))}},{key:"onSendSettingDone",value:function(e){if("ok"==e.code){De.instance().event.updateDescription.dispatch(),this.description=e.data.description,this.desText.setText(this.description),this.tick.revive();var t=[];t.push(new SFS2X.SFSUserVariable("description",e.data.description)),TF.instance().socket.send(new SFS2X.SetUserVariablesRequest(t)),TF.instance().dataMySeft.setDescription(e.data.description)}}},{key:"changeTxtBoxText",value:function(){this.desText.setText(this.description)}},{key:"destroy",value:function(){for($r.instance().hide();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&__(n.prototype,i),o&&__(n,o),t}();function P_(e){return(P_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function R_(e,t){return!t||"object"!==P_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x_(e){return(x_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T_(e,t){return(T_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var I_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=R_(this,x_(t).call(this,game))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.event={reloadScreen:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T_(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.ava,this.frameAva,this.btnCamera,this.name,this.description,this.addAva(),this.addFrameAva(),this.addName(),this.addDescription(),this.addBtnCamera(),this.addEventExtension()}},{key:"addEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this)}},{key:"onUpdateUserVars",value:function(){this.urlAvatar!==TF.instance().dataMySeft.avatar&&this.event.reloadScreen.dispatch()}},{key:"addAva",value:function(){this.urlAvatar=TF.instance().dataMySeft.avatar,this.ava=new rl(this.positionSetting.setting_profile.ava.x*window.GameConfig.RESIZE,this.positionSetting.setting_profile.ava.y*window.GameConfig.RESIZE,"ava-default",TF.instance().dataMySeft.avatar,1),this.ava.sprite.scale.set(.85*window.GameConfig.RESIZE),this.ava.sprite.anchor.set(.5),this.addChild(this.ava.sprite);var e=new Phaser.Graphics(game,0,0);e.drawCircle(128*window.GameConfig.RESIZE,238*window.GameConfig.RESIZE,170*window.GameConfig.RESIZE),e.anchor.set(.5),this.ava.sprite.mask=e}},{key:"addName",value:function(){this.name=new w_,this.addChild(this.name)}},{key:"addDescription",value:function(){this.description=new k_,this.description.event.changeDes.add(this.changeDes,this),this.addChild(this.description)}},{key:"changeDes",value:function(){this.event.reloadScreen.dispatch()}},{key:"addFrameAva",value:function(){this.frameAva=new rt(this.positionSetting.setting_profile.frame_ava),this.frameAva.anchor.set(.5),this.addChild(this.frameAva)}},{key:"addBtnCamera",value:function(){this.btnCamera=new pt(this.positionSetting.setting_profile.btn_camera,this.onClickBtnCam,this),this.btnCamera.anchor.set(.5),this.addChild(this.btnCamera)}},{key:"onClickBtnCam",value:function(){this.appendDOMFile()}},{key:"setStylesAvaField",value:function(){var e=game.canvas.getBoundingClientRect().width/game.width,t=game.canvas.getBoundingClientRect().height/game.height,n=(window.innerWidth-game.canvas.getBoundingClientRect().width)/2,i={top:game.canvas.getBoundingClientRect().top+150*z.instance().scale*t+"px",left:n+250*z.instance().scale*e+"px",width:300*z.instance().scale*e+"px",height:85*z.instance().scale*t+"px",position:"absolute","z-index":1};i["padding-left"]=10*z.instance().scale*e+"px",i["padding-right"]=10*z.instance().scale*e+"px",this.setStyleOnElement($("#avatarField"),i);var o={top:game.canvas.getBoundingClientRect().top+140*z.instance().scale*t+"px",left:game.canvas.getBoundingClientRect().left+50*z.instance().scale*e+"px",width:130*z.instance().scale*e+"px",height:130*z.instance().scale*t+"px",position:"absolute"};this.setStyleOnElement($("#preview"),o)}},{key:"setStyleOnElement",value:function(e,t){e.css(t)}},{key:"addFundametal",value:function(){this.bg=new pt({x:36,y:120,nameAtlas:"settingSprites",nameSprite:"Hoso_Box_Mota"},function(){},this),this.addChild(this.bg),this.btnSubmit=new pt({x:470,y:110,nameAtlas:"defaultSource",nameSprite:"Send_Icon"},this.onSubmit,this),this.bg.addChild(this.btnSubmit),this.btnCancle=new pt({x:570,y:-30,nameAtlas:"defaultSource",nameSprite:"Exit"},this.cancleBg,this),this.bg.addChild(this.btnCancle),this.addTick()}},{key:"addTick",value:function(){this.tick=new rt(this.positionSetting.setting_account.tick_ava),this.tick.kill(),this.bg.addChild(this.tick)}},{key:"cancleBg",value:function(){this.closeDOM(),this.btnCancle.destroy(),this.btnSubmit.destroy(),this.bg.destroy()}},{key:"onSubmit",value:function(){this.avaRender=$("#getImageDataUrl").attr("src"),void 0!==this.avaRender&&(qe.instance().showLoading(),gl.instance().settingAccount(TF.instance().socket.mySelf.getVariable("user_id").value,TF.instance().dataMySeft.user_name,TF.instance().socket.mySelf.getVariable("gender").value,this.avaRender),gl.instance().sendData(this.onSendAvaDone.bind(this)))}},{key:"onSendAvaDone",value:function(e){if("ok"==e.code){this.tick.revive();var t=[];t.push(new SFS2X.SFSUserVariable("avatar",e.data.avatar)),TF.instance().socket.send(new SFS2X.SetUserVariablesRequest(t)),qe.instance().hideLoading(),TF.instance().dataMySeft.setAvatar(e.data.avatar)}}},{key:"closeDOM",value:function(){$("#avatarField").remove(),$("#preview").remove()}},{key:"appendDOMFile",value:function(){this.addFundametal(),$("#game").append('<input type="file" id="avatarField">'),$("#game").append('<div id="preview"></div>'),this.setStylesAvaField(),$("#avatarField").change(function(){this.files[0].size>z.instance().SIZE_AVA_UPLOAD?alert("photo file has too big size!! Pls choose another."):renderImage(this.files[0],function(e){$("#preview").html("<img id='getImageDataUrl' style=width:100px; src='"+e+"' />")})})}},{key:"destroy",value:function(){for(this.closeDOM(),this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&O_(n.prototype,i),o&&O_(n,o),t}();function A_(e){return(A_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function G_(e,t){return!t||"object"!==A_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function D_(e){return(D_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function M_(e,t){return(M_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var N_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=G_(this,D_(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&M_(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.addHeaderTab(this.positionSetting.header),this.addListSetting()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_setting_profile)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),this.ava&&this.ava.closeDOM(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addListSetting",value:function(){this.ava,this.location,this.description,this.name,this.addAva()}},{key:"addAva",value:function(){this.ava=new I_,this.ava.event.reloadScreen.add(this.reloadScreen,this),this.addChild(this.ava)}},{key:"reloadScreen",value:function(){this.ava.destroy(),this.addAva()}},{key:"addBtnSave",value:function(){this.btnSave=new pt(this.positionSetting.setting_profile.btn_save,this.clickSave,this),this.btnSave.anchor.set(.5);var e=new _t(this.positionSetting.setting_profile.txt_btn_save,this.positionSetting.setting_profile.txt_btn_save.text);e.anchor.set(.5),this.btnSave.addChild(e),this.addChild(this.btnSave)}},{key:"clickSave",value:function(){}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.ava&&this.ava.closeDOM();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&L_(n.prototype,i),o&&L_(n,o),t}();function B_(e){return(B_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function U_(e,t){return!t||"object"!==B_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function F_(e){return(F_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z_(e,t){return(Z_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var H_=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=U_(this,F_(t).call(this,game,0,0,"screen-dim2"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),n.claimValues=e,n.getReward(),n.afterInit(),n}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Z_(e,t)}(t,Phaser.Button),n=t,a=[{key:"HEART",get:function(){return"HEART"}},{key:"DIAMOND",get:function(){return"DIAMOND"}},{key:"TICKET",get:function(){return"TICKET"}},{key:"SUPPORT_ITEM",get:function(){return"SUPPORT_ITEM"}}],(o=[{key:"getReward",value:function(){this.rewards=[],this.claimValues.diamond>0&&this.rewards.push({type:t.DIAMOND,reward:this.claimValues.diamond}),this.claimValues.heart>0&&this.rewards.push({type:t.HEART,reward:this.claimValues.heart}),this.claimValues.ticket>0&&this.rewards.push({type:t.TICKET,reward:this.claimValues.ticket}),this.claimValues.support_item>0&&this.rewards.push({type:t.SUPPORT_ITEM,reward:this.claimValues.support_item})}},{key:"afterInit",value:function(){this.addHeaderTab(this.positionSetting.header)}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_giftcode)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.headerTab.addChild(this.btnBack)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addGift",value:function(){var e=this.rewards.length;for(this.txtQuest.kill(),i=0;i<e;i++)this.addClaim(this.rewards[i].type,this.rewards[i].reward,i,e)}},{key:"addClaim",value:function(e,n,i,o){var a=this,s=this.addTabResource(this.positionSetting.header,e,n);this.addChild(s),this.timeTweenBox=game.time.events.add(3*Phaser.Timer.SECOND*i,function(){var i=game.add.tween(s).to({y:a.positionSetting.header.tab_resource.y},200,Phaser.Easing.Back.Out,!1);i.start(),i.onComplete.add(function(){var i=new si(e,n,{x:355,y:47});a.addChild(i),a.timeTweenTxtRs=game.time.events.add(1.5*Phaser.Timer.SECOND,function(){if(e==t.DIAMOND){var n=game.add.tween(s.txtResource).to({text:TF.instance().socket.mySelf.getVariable("diamond").value},500,Phaser.Easing.Back.Out,!1);n.start(),n.onUpdateCallback(function(){s.txtResource.text=parseInt(s.txtResource.text)},a)}else if(e==t.TICKET){var i=game.add.tween(s.txtResource).to({text:TF.instance().socket.mySelf.getVariable("ticket").value},500,Phaser.Easing.Back.Out,!1);i.start(),i.onUpdateCallback(function(){s.txtResource.text=parseInt(s.txtResource.text)},a)}else if(e==t.HEART){var o=game.add.tween(s.txtResource).to({text:TF.instance().socket.mySelf.getVariable("heart").value},500,Phaser.Easing.Back.Out,!1);o.start(),o.onUpdateCallback(function(){s.txtResource.text=parseInt(s.txtResource.text)},a)}else if(e==t.SUPPORT_ITEM){var r=game.add.tween(s.txtResource).to({text:TF.instance().socket.mySelf.getVariable("support_item").value},500,Phaser.Easing.Back.Out,!1);r.start(),r.onUpdateCallback(function(){s.txtResource.text=parseInt(s.txtResource.text)},a)}}),a.timeTweenBoxRs=game.time.events.add(2.5*Phaser.Timer.SECOND,function(){game.add.tween(s).to({y:-100},200,Phaser.Easing.Back.Out,!1).start()})},a)}),i==o-1&&(this.timeTweenDestroy=game.time.events.add(Phaser.Timer.SECOND*o*3,function(){a.destroy()}))}},{key:"addTabResource",value:function(e,t,n){var i=new Phaser.Sprite(game,e.tab_resource.x*window.GameConfig.RESIZE,-100*window.GameConfig.RESIZE,e.tab_resource.nameAtlas,e.tab_resource.nameSprite);i.iconResourse=this.addGem(this.positionSetting.header.icon_resource,t),i.txtResource=this.addTxtGem(this.positionSetting.header.txt_resource,t,n);var o=i.iconResourse.width+i.txtResource.width;return i.txtResource.x=(i.width-o)/2-5*window.GameConfig.RESIZE,i.iconResourse.x=(i.width-o)/2+i.txtResource.width+5*window.GameConfig.RESIZE,i.addChild(i.iconResourse),i.addChild(i.txtResource),i}},{key:"addGem",value:function(e,n){var i="";return n==t.DIAMOND?i="Gem":n==t.TICKET?i="Ticket":n==t.HEART?i="Heart":n==t.SUPPORT_ITEM&&(i="Mic"),new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,i)}},{key:"addTxtGem",value:function(e,n,i){return n==t.DIAMOND?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value-i,e.configs):n==t.TICKET?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("ticket").value-i,e.configs):n==t.HEART?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("heart").value-i,e.configs):n==t.SUPPORT_ITEM?new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("support_item").value-i,e.configs):void 0}},{key:"destroy",value:function(){for(game.time.events.remove(this.timeTweenBox),game.time.events.remove(this.timeTweenTxtRs),game.time.events.remove(this.timeTweenBoxRs),game.time.events.remove(this.timeTweenDestroy);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&j_(n.prototype,o),a&&j_(n,a),t}();var Q_=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.amount=0,this.diamond=0,this.ticket=0,this.created=0,this.name="",this.id=0,this.expiration_date=0,this.updated=0,this.heart=0,this.support_item=0};function V_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var W_=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new Q_,n=e.getSFSObject("gift_code");return t.amount=n.getInt("amount"),t.created=n.getLong("created"),t.diamond=n.getInt("diamond"),t.expiration_date=n.getLong("expiration_date"),t.heart=n.getInt("heart"),t.id=n.getLong("id"),t.name=n.getUtfString("name"),t.support_item=n.getInt("support_item"),t.ticket=n.getInt("ticket"),t.updated=n.getLong("updated"),t}}],(n=null)&&V_(t.prototype,n),i&&V_(t,i),e}();function q_(e){return(q_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function z_(e,t){return!t||"object"!==q_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Y_(e){return(Y_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J_(e,t){return(J_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var X_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=z_(this,Y_(t).call(this,game,0,0,"bg-playlist"))).positionSetting=JSON.parse(game.cache.getText("positionSetting")),e.signalInputX=new Phaser.Signal,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J_(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.giftcode={},this.isActiveBtnSave=!0,this.addHeaderTab(this.positionSetting.header),this.txtSettingHead,this.boxText,this.txtBoxText,this.btnSave,this.tick,this.addTxtSettingHead(),this.addBoxText(),this.addTxtBoxText(),this.addBtnSave(),this.addTick()}},{key:"addTxtSettingHead",value:function(){this.txtSettingHead=new _t(this.positionSetting.setting_giftcode.txt_setting_head,this.positionSetting.setting_giftcode.txt_setting_head.text),this.txtSettingHead.anchor.set(.5),this.addChild(this.txtSettingHead)}},{key:"addBoxText",value:function(){this.boxText=new pt(this.positionSetting.setting_giftcode.box_text,this.clickBoxText,this),this.boxText.anchor.set(.5),this.addChild(this.boxText)}},{key:"addBtnSave",value:function(){this.btnSave=new pt(this.positionSetting.setting_giftcode.btn_save,this.clickSave,this),this.btnSave.anchor.set(.5);var e=new _t(this.positionSetting.setting_giftcode.txt_btn_save,this.positionSetting.setting_giftcode.txt_btn_save.text);e.anchor.set(.5),this.btnSave.addChild(e),this.addChild(this.btnSave)}},{key:"addTick",value:function(){this.tick=new rt(this.positionSetting.setting_giftcode.tick),this.tick.kill(),this.boxText.addChild(this.tick)}},{key:"clickBoxText",value:function(){this.tick.kill(),this.inputKeyboard()}},{key:"inputKeyboard",value:function(){this.isActiveBtnSave=!1,ce.instance().playSound(ce.buttonclick),this.boxText.kill();$r.instance().event.cancle.add(this.keyboardClose,this),$r.instance().event.enter.add(this.keyboardDone,this),$r.instance().event.submit.add(this.keyboardDone,this),$r.instance().show({maxLength:"",showTransparent:!0,placeholder:"Nhập Giftcode",isSearch:!1}),$r.instance().setValue(this.codeGift)}},{key:"keyboardClose",value:function(){this.isActiveBtnSave=!0,$r.instance().event.cancle.remove(this.keyboardClose,this),$r.instance().event.enter.remove(this.keyboardDone,this),$r.instance().event.submit.remove(this.keyboardDone,this),$r.instance().hide(),this.boxText.revive()}},{key:"keyboardDone",value:function(){this.codeGift=$r.instance().getValue(),LogConsole.log(this.codeGift),this.changeTxtBoxText(),this.keyboardClose()}},{key:"changeTxtBoxText",value:function(){this.txtBoxText.setText(this.codeGift)}},{key:"clickSave",value:function(){1==this.isActiveBtnSave&&this.sendGiftcode()}},{key:"sendGiftcode",value:function(){var e=new SFS2X.SFSObject;e.putUtfString("code",this.codeGift),TF.instance().sendData(Et.GIFT_CODE_CLAIM_REQUEST,e)}},{key:"addTxtBoxText",value:function(){this.txtBoxText=new _t(this.positionSetting.setting_giftcode.txt_box_text,"Giftcode"),this.txtBoxText.anchor.set(.5),this.boxText.addChild(this.txtBoxText)}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.addButtonBack(e.btn_back),this.addTxtSetting(e.txt_giftcode)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:640*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}},{key:"addTxtSetting",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"onExtensionResponse",value:function(e){if(e.cmd==Et.GIFT_CODE_CLAIM_RESPONSE){if("OK"==e.params.getUtfString("status")){this.giftcode=W_.begin(e.params);var t=new H_(this.giftcode);t.addGift(),this.addChild(t)}"WARNING"==e.params.getUtfString("status")&&Gn.instance().addDialog("Giftcode sai hoặc đã được sử dụng.")}}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&K_(n.prototype,i),o&&K_(n,o),t}();function $_(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var eS=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("room_id",e),t}}],(n=null)&&$_(t.prototype,n),i&&$_(t,i),e}();function tS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var nS=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"ONLINE_MODE_ROOM_CREATE_REQUEST",get:function(){return"ONLINE_MODE_ROOM_CREATE_REQUEST"}},{key:"ONLINE_MODE_ROOM_CREATE_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_CREATE_RESPONSE"}},{key:"ONLINE_MODE_ROOM_LOAD_PLAYLIST_AND_BET_REQUEST",get:function(){return"ONLINE_MODE_ROOM_LOAD_PLAYLIST_AND_BET_REQUEST"}},{key:"ONLINE_MODE_ROOM_LOAD_PLAYLIST_AND_BET_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_LOAD_PLAYLIST_AND_BET_RESPONSE"}},{key:"ONLINE_MODE_ROOM_INVITE_REQUEST",get:function(){return"ONLINE_MODE_ROOM_INVITE_REQUEST"}},{key:"ONLINE_MODE_ROOM_INVITE_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_INVITE_RESPONSE"}},{key:"ONLINE_MODE_ROOM_ONLINE_USER_LIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_ONLINE_USER_LIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_ONLINE_USER_LIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_ONLINE_USER_LIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_PLAYLIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_PLAYLIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_START_GAME_REQUEST",get:function(){return"ONLINE_MODE_ROOM_START_GAME_REQUEST"}},{key:"ONLINE_MODE_ROOM_START_GAME_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_START_GAME_RESPONSE"}},{key:"ONLINE_MODE_ROOM_SERVER_QUESTIONS_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_SERVER_QUESTIONS_RESPONSE"}},{key:"ONLINE_MODE_ROOM_GAME_START",get:function(){return"ONLINE_MODE_ROOM_GAME_START"}},{key:"ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_REQUEST",get:function(){return"ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_REQUEST"}},{key:"ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_RESPONSE"}},{key:"ONLINE_MODE_ROOM_LOAD_PLAYLIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_LOAD_PLAYLIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_LOAD_PLAYLIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_LOAD_PLAYLIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_LOAD_BET_REQUEST",get:function(){return"ONLINE_MODE_ROOM_LOAD_BET_REQUEST"}},{key:"ONLINE_MODE_ROOM_LOAD_BET_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_LOAD_BET_RESPONSE"}},{key:"ONLINE_MODE_ROOM_MOVE_TO_NEXT_QUESTION",get:function(){return"ONLINE_MODE_ROOM_MOVE_TO_NEXT_QUESTION"}},{key:"ONLINE_MODE_ROOM_GAME_RESULT",get:function(){return"ONLINE_MODE_ROOM_GAME_RESULT"}},{key:"ONLINE_MODE_ROOM_GAME_FINISH",get:function(){return"ONLINE_MODE_ROOM_GAME_FINISH"}},{key:"ONLINE_MODE_ROOM_QUICK_JOIN_REQUEST",get:function(){return"ONLINE_MODE_ROOM_QUICK_JOIN_REQUEST"}},{key:"ONLINE_MODE_ROOM_QUICK_JOIN_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_QUICK_JOIN_RESPONSE"}},{key:"ONLINE_MODE_ROOM_KICK_USER_REQUEST",get:function(){return"ONLINE_MODE_ROOM_KICK_USER_REQUEST"}},{key:"ONLINE_MODE_ROOM_ONLINE_USERS_LIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_ONLINE_USERS_LIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_ONLINE_USERS_LIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_ONLINE_USERS_LIST_RESPONSE"}},{key:"ONLINE_MODE_ROOM_BE_KICKED",get:function(){return"ONLINE_MODE_ROOM_BE_KICKED"}},{key:"SUPPORT_RESPONSE",get:function(){return"SUPPORT_RESPONSE"}},{key:"SUPPORT_REQUEST",get:function(){return"SUPPORT_REQUEST"}},{key:"ONLINE_MODE_ROOM_FRIEND_LIST_REQUEST",get:function(){return"ONLINE_MODE_ROOM_FRIEND_LIST_REQUEST"}},{key:"ONLINE_MODE_ROOM_FRIEND_LIST_RESPONSE",get:function(){return"ONLINE_MODE_ROOM_FRIEND_LIST_RESPONSE"}},{key:"USER_FRIEND_LIST_LOAD_REQUEST",get:function(){return"USER_FRIEND_LIST_LOAD_REQUEST"}},{key:"USER_FRIEND_LIST_LOAD_RESPONSE",get:function(){return"USER_FRIEND_LIST_LOAD_RESPONSE"}}],(n=null)&&tS(t.prototype,n),i&&tS(t,i),e}();function iS(e){return(iS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oS(e,t,n){return(oS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=aS(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function aS(e){return(aS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rS(e,t,n){return t&&sS(e.prototype,t),n&&sS(e,n),e}function lS(e,t){return(lS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var cS=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=aS(t).call(this,game,0,0,"IconChatOnlineMode","Circle_Icon"))||"object"!==iS(o)&&"function"!=typeof o?hS(i):o).event={call_remove:new Phaser.Signal},n.idRemove=null,n.iconChat=new Phaser.Sprite(game,0,0,"IconChatOnlineMode"),n.iconChat.anchor.x=.5,n.iconChat.anchor.y=.5,n.iconChat.smoothed=!0,n.addChild(n.iconChat);var a={prefix:"",start:0,stop:0,zeroPad:5};return e===t.chenhao?(a.prefix="01_CuoiCheNhao_",a.start=0,a.stop=7):e===t.vuive?(a.prefix="02_CuoiVuiVe_",a.start=0,a.stop=9):e===t.ngaingung?(a.prefix="03_CuoiNgaiNgung_",a.start=0,a.stop=9):e===t.khoc?(a.prefix="04_Khoc_",a.start=0,a.stop=9):e===t.buon?(a.prefix="05_Buon_",a.start=0,a.stop=19):e===t.batngo?(a.prefix="06_Batngo_",a.start=0,a.stop=14):e===t.tucgian&&(a.prefix="07_Tucgian_",a.start=0,a.stop=23),n.action=n.iconChat.animations.add("playiconchat",Phaser.Animation.generateFrameNames(a.prefix,a.start,a.stop,"",a.zeroPad)),n.action.play(30,!0),n.removeIcon(),n.idRemove=game.time.events.add(2*Phaser.Timer.SECOND,n.callRemove,hS(hS(n))),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lS(e,t)}(t,Phaser.Sprite),rS(t,null,[{key:"chenhao",get:function(){return"chenhao"}},{key:"vuive",get:function(){return"vuive"}},{key:"ngaingung",get:function(){return"ngaingung"}},{key:"khoc",get:function(){return"khoc"}},{key:"buon",get:function(){return"buon"}},{key:"batngo",get:function(){return"batngo"}},{key:"tucgian",get:function(){return"tucgian"}}]),rS(t,[{key:"removeIcon",value:function(){null!==this.idRemove&&game.time.events.remove(this.idRemove)}},{key:"callRemove",value:function(){this.event.call_remove.dispatch()}},{key:"destroy",value:function(){this.removeIcon(),oS(aS(t.prototype),"destroy",this).call(this)}}]),t}();function uS(e){return(uS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fS(e){return(fS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pS(e,t){return(pS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var yS=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=fS(t).call(this,game,0,0,null))||"object"!==uS(i)&&"function"!=typeof i?gS(n):i).event={close_dialog:new Phaser.Signal},e.positionCreateRoom=e.mainData.positionCreateRoom,e.bg=new rt(e.positionCreateRoom.chat_icon_bg),e.addChild(e.bg),e.arrType=[cS.batngo,cS.buon,cS.chenhao,cS.khoc,cS.ngaingung,cS.tucgian,cS.vuive],e.arrString=["06_Batngo","05_Buon","01_CuoiCheNhao","04_Khoc","03_CuoiNgaiNgung","07_Tucgian","02_CuoiVuiVe"];for(var o=30,a=30,s=0,r=0;r<e.arrType.length;r++){s++;var l={x:0,y:0,nameAtlas:"IconChatOnlineMode",nameSprite:"Circle_Icon",configText:{x:0,y:0,style:{fontSize:26,font:"GilroyBold"}},icon:{x:0,y:8,nameAtlas:"IconChatOnlineMode",nameSprite:e.arrString[r]},alignAll:"center"};console.log("aaaaaaaaaa ------------------"),console.log(l);var h=new ln(l,"",e.chooseItem,gS(gS(e)));h.x=o,h.y=a,h.type=e.arrType[r],o+=133,s%4==0&&(a+=135,o=30),e.addChild(h)}return e.btnClose=new pt(e.positionCreateRoom.chat_icon_btn_close,e.chooseClose,gS(gS(e))),e.addChild(e.btnClose),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pS(e,t)}(t,Mt),n=t,(i=[{key:"chooseClose",value:function(){this.event.close_dialog.dispatch()}},{key:"chooseItem",value:function(e){console.log("chooseItem---------"),console.log(e.type);var t=new SFS2X.SFSObject;t.putUtfString("typeicon",e.type),TF.instance().sendPublicChat(Pe.CHAT_ONLINE_MODE,t),this.chooseClose()}}])&&dS(n.prototype,i),o&&dS(n,o),t}();function mS(e){return(mS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wS(e,t){return!t||"object"!==mS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bS(e,t,n){return(bS="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_S(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _S(e){return(_S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SS(e,t){return(SS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ES=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=wS(this,_S(t).call(this,game,0,0,"limitTurn",function(){},e,null,"BG_Opacity_limit_turn"))).limitTurnConfig=JSON.parse(game.cache.getText("limitTurnConfig")),n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SS(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterInit",value:function(){this.addBg(),this.addText(),this.addBtnRemove(),this.addBtnBecomeVip()}},{key:"addBg",value:function(){this.bg=new Phaser.Sprite(game,0,0,"limitTurn","BG_Opacity_limit_turn"),this.bg.width=game.width,this.bg.height=game.height,this.addChild(this.bg)}},{key:"addText",value:function(){this.txt=new _t(this.limitTurnConfig.txt_limit,this.limitTurnConfig.txt_limit.text),this.txt.position.y=-300,this.txt.anchor.set(.5);var e=new _t(this.limitTurnConfig.txt_want,this.limitTurnConfig.txt_want.text);e.anchor.set(.5),this.txt.addChild(e),this.addChild(this.txt),game.add.tween(this.txt).to({y:this.limitTurnConfig.txt_limit.y},1250,Phaser.Easing.Exponential.Out,!1).start()}},{key:"addBtnRemove",value:function(){this.btnRemove=new pt(this.limitTurnConfig.btn_delete,this.onClickRemove,this),this.btnRemove.position.x=-300,this.btnRemove.anchor.set(.5);var e=new _t(this.limitTurnConfig.btn_delete.txt,this.limitTurnConfig.btn_delete.txt.text);e.anchor.set(.5),this.btnRemove.addChild(e),this.addChild(this.btnRemove),game.add.tween(this.btnRemove).to({x:this.limitTurnConfig.btn_delete.x},1250,Phaser.Easing.Exponential.Out,!1).start()}},{key:"onClickRemove",value:function(){rF.instance().changeScreen(Ce.MAIN_MENU),this.destroy()}},{key:"addBtnBecomeVip",value:function(){this.btnBecomeVip=new pt(this.limitTurnConfig.btn_vip,this.onClickBecomeVip,this),this.btnBecomeVip.position.x=game.width+300,this.btnBecomeVip.anchor.set(.5);var e=new _t(this.limitTurnConfig.btn_vip.txt,this.limitTurnConfig.btn_vip.txt.text);e.anchor.set(.5),this.btnBecomeVip.addChild(e),this.addChild(this.btnBecomeVip),game.add.tween(this.btnBecomeVip).to({x:this.limitTurnConfig.btn_vip.x},1250,Phaser.Easing.Exponential.Out,!1).start()}},{key:"onClickBecomeVip",value:function(){}},{key:"destroy",value:function(){bS(_S(t.prototype),"destroy",this).call(this)}}])&&vS(n.prototype,i),o&&vS(n,o),t}();function CS(e){return(CS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function PS(e){return(PS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function OS(e,t){return(OS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function RS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var xS=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=PS(t).call(this,game,0,0,""))||"object"!==CS(i)&&"function"!=typeof i?RS(n):i).event={close:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.bg=new rt(e.positionPopup.popup_suggets_rating_bg),e.addChild(e.bg),e.btnVoteSau=new ln(e.positionPopup.popup_suggets_rating_btn_votesau,"VOTE SAU",e.chooseVoteSau,RS(RS(e))),e.addChild(e.btnVoteSau),e.btnVoteNgay=new ln(e.positionPopup.popup_suggets_rating_btn_votengay,"VOTE NGAY",e.chooseVoteNgay,RS(RS(e))),e.addChild(e.btnVoteNgay),e.btnClose=new pt(e.positionPopup.popup_suggets_rating_btn_close,e.chooseClose,RS(RS(e))),e.addChild(e.btnClose),e.txt1=new _t(e.positionPopup.popup_suggets_rating_lb1,"Hãy ủng hộ chúng mình nhé!"),e.txt1.x=(e.bg.width-e.txt1.width)/2,e.addChild(e.txt1),e.txt2=new _t(e.positionPopup.popup_suggets_rating_lb2,"Bạn có yêu thích Wazzat không?"),e.txt2.x=(e.bg.width-e.txt2.width)/2,e.addChild(e.txt2),Le.instance().logEvent(Le.SuggetRatingShow),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&OS(e,t)}(t,Mt),n=t,(i=[{key:"chooseVoteSau",value:function(){LogConsole.log("chooseVoteSau"),Mr.instance().setItem(Mr.VOTE,"VoteSau"),Le.instance().logEvent(Le.SuggetRatingVoteSau),this.event.close.dispatch()}},{key:"chooseVoteNgay",value:function(){LogConsole.log("chooseVoteNgay"),Mr.instance().setItem(Mr.VOTE,"VoteNgay"),"and"===z.instance().platform?window.open(window.RESOURCE.android_storage_link):"ios"===z.instance().platform&&window.open(window.RESOURCE.ios_storage_link),Le.instance().logEvent(Le.SuggetRatingVoteNgay),this.event.close.dispatch()}},{key:"chooseClose",value:function(){LogConsole.log("chooseClose"),Mr.instance().setItem(Mr.VOTE,"Close"),Le.instance().logEvent(Le.SuggetRatingClose),this.event.close.dispatch()}}])&&kS(n.prototype,i),o&&kS(n,o),t}();function TS(e){return(TS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AS(e){return(AS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function LS(e,t){return(LS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GS(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var DS=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=AS(t).call(this,game,0,0,""))||"object"!==TS(i)&&"function"!=typeof i?GS(n):i).event={close:new Phaser.Signal},e.bg=new Phaser.Button(game,0,0,"screen-dim"),e.addChild(e.bg),e.item=new xS,e.item.event.close.add(e.chooseClose,GS(GS(e))),e.item.x=35*z.instance().scale,e.item.y=game.height+237*z.instance().scale,e.addChild(e.item),e.tweenItemPopup(e.item,game.height-850*z.instance().scale),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LS(e,t)}(t,Mt),n=t,(i=[{key:"chooseClose",value:function(){this.event.close.dispatch()}}])&&IS(n.prototype,i),o&&IS(n,o),t}();function MS(e){return(MS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BS(e,t){return!t||"object"!==MS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jS(e){return(jS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function US(e,t){return(US=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var FS=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=BS(this,jS(t).call(this,game))).positionLoadConfig=JSON.parse(game.cache.getText("positionLoadConfig")),n.messenger=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&US(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.ava,this.name,this.from,this.time,this.ava=new rt(this.positionLoadConfig.mail_system.mailDetail.ava),this.addChild(this.ava),this.name=new _t(this.positionLoadConfig.mail_system.mailDetail.name,this.positionLoadConfig.mail_system.mailDetail.name.text),this.addChild(this.name),this.from=new _t(this.positionLoadConfig.mail_system.mailDetail.from,this.positionLoadConfig.mail_system.mailDetail.from.text),this.addChild(this.from),this.time=new _t(this.positionLoadConfig.mail_system.mailDetail.time,this.messenger.data.created),this.addChild(this.time)}},{key:"height",get:function(){return 131*window.GameConfig.RESIZE}}])&&NS(n.prototype,i),o&&NS(n,o),t}();function ZS(e){return(ZS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QS(e,t){return!t||"object"!==ZS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function VS(e){return(VS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function WS(e,t){return(WS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qS=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=QS(this,VS(t).call(this,game))).positionLoadConfig=JSON.parse(game.cache.getText("positionLoadConfig")),n.data=e,n.eventClickBtn=new Phaser.Signal,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&WS(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.txtDes,this.btn,this.addTxtDes(),this.addBtn()}},{key:"addTxtDes",value:function(){this.txtDes=new _t(this.positionLoadConfig.system_btn_link.text,this.data.description),this.addChild(this.txtDes)}},{key:"addBtn",value:function(){this.btn=new pt(this.positionLoadConfig.system_btn_link,this.onClick,this);var e={x:this.btn.x+15,y:this.btn.y+15,text:"EMAIL",style:{font:"GilroyBold",fill:"#bfbec4",fontSize:24,align:"center"}},t=new _t(e,this.data.name.toUpperCase());this.btn.width=t.width+30,this.addChild(this.btn),this.addChild(t)}},{key:"onClick",value:function(){this.eventClickBtn.dispatch(this.data)}},{key:"height",get:function(){return 151}}])&&HS(n.prototype,i),o&&HS(n,o),t}();function KS(e){return(KS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zS(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function YS(e,t){return!t||"object"!==KS(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function JS(e){return(JS=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XS(e,t){return(XS=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $S=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=YS(this,JS(t).call(this,game))).positionLoadConfig=JSON.parse(game.cache.getText("positionLoadConfig")),n.messengerId=e,n.messenger,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&XS(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.bg,this.headerTab,this.title,this.inforSystem,this.detail,this.addBG(),this.addHeaderTab(),this.ajaxGetNotiDetail(),this.addEventExtension()}},{key:"ajaxGetNotiDetail",value:function(){LogConsole.log(this.messengerId),gl.instance().seeNoticeSystem(TF.instance().socket.mySelf.getVariable("user_id").value,this.messengerId),gl.instance().sendData(this.detailMessageCallback.bind(this))}},{key:"detailMessageCallback",value:function(e){if(this.dataControls=[],this.messenger=e,null!==this.messenger.data.control){var t=JSON.parse(this.messenger.data.control);for(var n in t)this.dataControls.push(t[n])}LogConsole.log("detailMessageCallback"),LogConsole.log(this.messenger),this.addTitle(),this.addListView(),this.addInforSystem(),this.addDetailMessage(),this.addButtonLink()}},{key:"addBG",value:function(){this.bg=new Phaser.Button(game,0,0,this.positionLoadConfig.mail_system.bg.nameSprite),this.addChild(this.bg)}},{key:"addHeaderTab",value:function(){this.headerTab=new rt(this.positionLoadConfig.mail_system.header.tab),this.addChild(this.headerTab),this.btnBack,this.emailTxt,this.btnBack=new pt(this.positionLoadConfig.mail_system.header.btn_back,this.onClickBack,this),this.btnBack.anchor.set(.5),this.addChild(this.btnBack),this.emailTxt=new _t(this.positionLoadConfig.mail_system.header.txt_email,this.positionLoadConfig.mail_system.header.txt_email.text),this.emailTxt.anchor.set(.5),this.addChild(this.emailTxt)}},{key:"onClickBack",value:function(){De.instance().event.backSystemChat.dispatch(),this.destroy()}},{key:"addTitle",value:function(){this.title=new _t(this.positionLoadConfig.mail_system.title,this.messenger.data.title),this.addChild(this.title),this.lineUnder,this.lineUnder=new rt(this.positionLoadConfig.mail_system.line_under),this.lineUnder.y+=this.title.y+this.title.height,this.addChild(this.lineUnder)}},{key:"addListView",value:function(){this.group=new Phaser.Group(game),this.addChild(this.group);var e=new Phaser.Rectangle(0,this.lineUnder.y+2,game.width,(game.height-253)*window.GameConfig.RESIZE);this.listView=new Vo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}},{key:"addInforSystem",value:function(){this.inforSystem=new FS(this.messenger),this.listView.add(this.inforSystem)}},{key:"addDetailMessage",value:function(){this.detail=new _t(this.positionLoadConfig.mail_system.detailMessage,this.messenger.data.message);var e=new Phaser.Sprite(game,0,this.detail.height+25,"mailSprites","line_line");this.detail.addChild(e),this.listView.add(this.detail)}},{key:"addButtonLink",value:function(){for(var e=0;e<this.dataControls.length;e++)if("ios"!==z.instance().platform&&void 0!==this.dataControls[e].link){var t=new qS(this.dataControls[e]);t.eventClickBtn.add(this.eventClickBtn,this),this.listView.add(t)}}},{key:"eventClickBtn",value:function(e){window.open(e.link,"_blank")}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onClickBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onClickBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&zS(n.prototype,i),o&&zS(n,o),t}();function eE(e){return(eE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nE(e,t){return!t||"object"!==eE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iE(e,t,n){return(iE="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oE(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oE(e){return(oE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aE(e,t){return(aE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sE=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=nE(this,oE(t).call(this,game))).positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),e.signalBtn=new Phaser.Signal,e.typeRsr=n,e.confirmWatchVideoReward=!1,e.timeWait=0,e.timerToCountTime=null,e.popup=null,e.btnWatch=null,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aE(e,t)}(t,Phaser.Group),n=t,o=[{key:"TICKET",get:function(){return"TICKET"}},{key:"HEART",get:function(){return"HEART"}}],(i=[{key:"addEventExtension",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),li.instance().event.rewardedVideoRewardReceived.add(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.add(this.rewardedVideoFailed,this),li.instance().event.rewardedVideoClosed.add(this.rewardedVideoClosed,this)}},{key:"removeEventExtension",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),li.instance().event.rewardedVideoRewardReceived.remove(this.rewardedVideoRewardReceived,this),li.instance().event.rewardedVideoFailed.remove(this.rewardedVideoFailed,this),li.instance().event.rewardedVideoClosed.remove(this.rewardedVideoClosed,this)}},{key:"rewardedVideoRewardReceived",value:function(e){this.confirmWatchVideoReward=!0;var t=e.placement;t.name,t.amount,t.reward}},{key:"rewardedVideoFailed",value:function(){console.log("GGGGGGGGGAAA")}},{key:"rewardedVideoClosed",value:function(){if(1==this.confirmWatchVideoReward){var e=0,n=0,i="";this.typeRsr==t.HEART?(e=this.rsrPkgs.heart.id,n=this.rsrPkgs.heart.quantity,i=this.rsrPkgs.heart.resource_type):(e=this.rsrPkgs.ticket.id,n=this.rsrPkgs.ticket.quantity,i=this.rsrPkgs.ticket.resource_type),TF.instance().sendData(Hs.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_REQUEST,Kv.begin(e,n,i))}else qe.instance().hideLoading()}},{key:"afterInit",value:function(){qe.instance().showLoading(),this.botSprite=new Phaser.Sprite(game,0,0,null),this.addChild(this.botSprite),this.topSprite=new Phaser.Sprite(game,0,0,null),this.addChild(this.topSprite),this.screenDim,this.tabGem,this.tabHeart,this.popup,this.addScreenDim(),this.typeRsr!=t.HEART&&null!=this.typeRsr||this.addGemAndHeart(),this.addEventExtension(),null===z.instance().dataPackage?"ios"===z.instance().platform?Yv.instance().getDataInapp():Wv.instance().getDataInapp():this.handlePackage()}},{key:"addScreenDim",value:function(){this.screenDim=new Phaser.Sprite(game,0,0,"screen-dim"),this.screenDim.inputEnabled=!0,this.botSprite.addChild(this.screenDim)}},{key:"addGemAndHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGem.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGem.nameAtlas,this.positionPracticePopupConfig.tabGem.nameSprite),this.addGemDetail(),this.botSprite.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeart.nameAtlas,this.positionPracticePopupConfig.tabHeart.nameSprite),this.addHeartDetail(),this.botSprite.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_reward.nameAtlas,this.positionPracticePopupConfig.gem_reward.nameSprite),this.txtGem=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txt.y*window.GameConfig.RESIZE,TF.instance().dataMySeft.diamond,this.positionPracticePopupConfig.gem_reward_txt.configs);var t=e.width+this.txtGem.width;this.txtGem.x=(this.tabGem.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-t)/2+this.txtGem.width+5*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(this.txtGem)}},{key:"addHeartDetail",value:function(){var e;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_reward.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_reward.nameAtlas,this.positionPracticePopupConfig.heart_reward.nameSprite),this.txtHeart=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txt.y*window.GameConfig.RESIZE,TF.instance().dataMySeft.heart,this.positionPracticePopupConfig.heart_reward_txt.configs);var t=e.width+this.txtHeart.width;this.txtHeart.x=(this.tabHeart.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-t)/2+this.txtHeart.width+5*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(this.txtHeart)}},{key:"addPopup",value:function(){null!==this.popup?(this.removeBtnWatch(),this.addBtnWatch(),this.checkConfirmAds()):(this.removePopup(),this.txtMainPopup,this.txtQuestPopup,this.popup=new Phaser.Sprite(game,35,1140,"dailyRewardSprites","Box"),this.addIconCamera(),this.addBtnWatch(),this.addBtnBuy(),this.addTxtMainPopup(),this.addTxtQuestPopup(),this.addBtnClose(),this.botSprite.addChild(this.popup),this.makeTweenPopup(),this.checkConfirmAds())}},{key:"removePopup",value:function(){null!==this.popup&&(this.botSprite.removeChild(this.popup),this.popup.destroy(),this.popup=null)}},{key:"removeBtnWatch",value:function(){null!==this.btnWatch&&(this.popup.removeChild(this.btnWatch),this.btnWatch.destroy(),this.btnWatch=null)}},{key:"addIconCamera",value:function(){this.icon=new Phaser.Sprite(game,285,42,"dailyRewardSprites","Camera"),this.icon.anchor.set(.5,0),this.popup.addChild(this.icon)}},{key:"addBtnWatch",value:function(){this.btnWatch=new Phaser.Button(game,414,379,"dailyRewardSprites",this.onWatch,this,null,"Button_Xem"),this.btnWatch.anchor.set(.5),"web"===z.instance().platform&&(this.btnWatch.alpha=.5,this.btnWatch.inputEnabled=!1),this.txtBtnWatch=new Phaser.Text(game,0,0,"XEM",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:35}),this.txtBtnWatch.anchor.set(.5),this.txtCountBtnWatch=new Phaser.Text(game,0,23,"",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:18}),this.txtCountBtnWatch.anchor.set(.5),this.btnWatch.addChild(this.txtBtnWatch),this.btnWatch.addChild(this.txtCountBtnWatch),this.popup.addChild(this.btnWatch)}},{key:"addBtnBuy",value:function(){this.btnBuy=new Phaser.Button(game,156,379,"dailyRewardSprites",this.onBuy,this,null,"Button_Mua"),this.btnBuy.anchor.set(.5),this.txtBtnBuy=new Phaser.Text(game,0,0,"MUA",{font:"GilroyBold",fill:"#ffffff",align:"center",fontSize:35}),this.txtBtnBuy.anchor.set(.5),this.btnBuy.addChild(this.txtBtnBuy),this.popup.addChild(this.btnBuy)}},{key:"onWatch",value:function(){ce.instance().playSound(ce.buttonclick),qe.instance().showLoading(),li.instance().showRewardVideoInappPurchase(this.typeRsr)}},{key:"getData",value:function(e){switch(e.cmd){case Hs.RESOURCE_PACKAGE_LOAD_RESPONSE:"OK"===e.params.getUtfString("status")&&(z.instance().dataPackage=e.params,this.handlePackage());break;case Hs.RESOURCE_PACKAGE_WATCHED_ADS_CLAIM_RESPONSE:"OK"===e.params.getUtfString("status")&&(this.animClaim(),z.instance().dataPackage=null,"ios"===z.instance().platform?Yv.instance().getDataInapp():Wv.instance().getDataInapp(),qe.instance().hideLoading())}}},{key:"onBuy",value:function(){ce.instance().playSound(ce.buttonclick),IE.instance().addShop(1,Mv.HEART),this.destroy()}},{key:"addTxtMainPopup",value:function(){var e="";e=this.typeRsr==t.HEART?this.positionPracticePopupConfig.txtNotEnoughHeart.text:this.positionPracticePopupConfig.txtNotEnoughTicket.text,this.txtMainPopup=new Phaser.Text(game,this.positionPracticePopupConfig.txtNotEnoughHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txtNotEnoughHeart.y*window.GameConfig.RESIZE,e,this.positionPracticePopupConfig.txtNotEnoughHeart.configs),this.txtMainPopup.anchor.set(.5,0),this.popup.addChild(this.txtMainPopup)}},{key:"addTxtQuestPopup",value:function(){var e="";e=this.typeRsr==t.HEART?this.positionPracticePopupConfig.txtQuestNotEnoughHeart.text:this.positionPracticePopupConfig.txtQuestNotEnoughTicket.text,this.txtQuestPopup=new Phaser.Text(game,this.positionPracticePopupConfig.txtQuestNotEnoughHeart.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.txtQuestNotEnoughHeart.y*window.GameConfig.RESIZE,e,this.positionPracticePopupConfig.txtQuestNotEnoughHeart.configs),this.txtQuestPopup.anchor.set(.5,0),this.popup.addChild(this.txtQuestPopup)}},{key:"addBtnClose",value:function(){this.btnClose=new Phaser.Button(game,536,-29,"dailyRewardSprites",this.onClose,this,null,"Button_Exit"),this.popup.addChild(this.btnClose)}},{key:"onClose",value:function(){ce.instance().playSound(ce.buttonclick),this.destroy()}},{key:"makeTweenPopup",value:function(){game.add.tween(this.popup).to({y:(game.height-830)*window.GameConfig.RESIZE},1e3,Phaser.Easing.Bounce.Out,!1).start()}},{key:"removeTabGemAndTabHeart",value:function(){this.tabGem.destroy(),this.tabHeart.destroy()}},{key:"handlePackage",value:function(){this.rsrPkgs={heart:{},ticket:{}};for(var e=z.instance().dataPackage.getSFSArray("resource_packages"),t=0;t<e.size();t++){var n=e.getSFSObject(t);if("HEART"==n.getUtfString("resource_type")&&"ADS"==n.getUtfString("price_type")){var i=n.getUtfString("pack_name"),o=n.getInt("sale"),a=n.getInt("quantity"),s=n.getUtfString("payment_service"),r=n.getInt("price"),l=n.getUtfString("name"),h=n.getUtfString("resource_type"),c=n.getUtfString("price_type"),u=n.getInt("active"),d=n.getLong("next_watched_at"),f=n.getInt("id"),p=n.getBool("is_allow_watch");this.rsrPkgs.heart={pack_name:i,sale:o,quantity:a,payment_service:s,price:r,name:l,resource_type:h,price_type:c,active:u,id:f,is_allow_watch:p,next_watched_at:d}}if("HEART"==n.getUtfString("resource_type")&&"ADS"==n.getUtfString("price_type")){var g=n.getUtfString("pack_name"),y=n.getInt("sale"),m=n.getInt("quantity"),v=n.getUtfString("payment_service"),w=n.getInt("price"),b=n.getUtfString("name"),_=n.getUtfString("resource_type"),S=n.getUtfString("price_type"),E=n.getInt("active"),C=n.getInt("id"),k=n.getLong("next_watched_at"),P=n.getBool("is_allow_watch");this.rsrPkgs.ticket={pack_name:g,sale:y,quantity:m,payment_service:v,price:w,name:b,resource_type:_,price_type:S,active:E,id:C,is_allow_watch:P,next_watched_at:k}}}qe.instance().hideLoading(),this.addPopup()}},{key:"checkConfirmAds",value:function(){"HEART"==this.typeRsr?1==this.rsrPkgs.heart.is_allow_watch?(this.btnWatch.inputEnabled=!0,this.btnWatch.alpha=1):(this.timeWait=parseInt((this.rsrPkgs.heart.next_watched_at-(new Date).getTime())/1e3),this.changeTxtBtnAds()):this.rsrPkgs.ticket.is_allow_watch}},{key:"changeTxtBtnAds",value:function(){this.timeWait>0?(this.btnWatch.inputEnabled=!1,this.btnWatch.alpha=.7,this.txtBtnWatch.y=-5,this.stopCountTime(),this.timerToCountTime=game.time.create(!0),this.timerToCountTime.loop(1e3,this.onTimerToCountTime,this),this.timerToCountTime.start(),this.setTextTimer()):"web"===z.instance().platform?(this.btnWatch.alpha=.5,this.btnWatch.inputEnabled=!1):(this.btnWatch.inputEnabled=!0,this.btnWatch.alpha=1,this.txtBtnWatch.y=0)}},{key:"onTimerToCountTime",value:function(){this.timeWait=this.timeWait-1,this.timeWait<0&&(this.timeWait=0),0===this.timeWait?(this.stopCountTime(),qe.instance().showLoading(),z.instance().dataPackage=null,"ios"===z.instance().platform?Yv.instance().getDataInapp():Wv.instance().getDataInapp()):this.setTextTimer()}},{key:"setTextTimer",value:function(){var e,t="",n=parseInt(this.timeWait/3600),i=0,o=0;n>0?(t=n>9?n+":":"0"+n+":",i=parseInt(this.timeWait%3600/60),o=this.timeWait-(3600*n+60*i)):(i=parseInt(this.timeWait/60),o=this.timeWait%60),e="( "+t+(i>9?i+":":"0"+i+":")+(o>9?o+"":"0"+o)+" )",this.txtCountBtnWatch.setText(e)}},{key:"animClaim",value:function(){var e={x:0,y:0};if("HEART"==this.typeRsr?(e.x=this.positionPracticePopupConfig.tabHeart.x+100,e.y=this.positionPracticePopupConfig.tabHeart.y+25):"TICKET"==this.typeRsr&&(e.x=0,e.y=0),this.typeRsr==t.HEART){var n=new si(this.typeRsr,5,e);this.topSprite.addChild(n);var i=game.add.tween(this.txtHeart).to({text:TF.instance().dataMySeft.heart},300,"Linear",!1);this.tweenTxtRsr(i,this.txtHeart)}}},{key:"tweenTxtRsr",value:function(e,t){var n=this;this.timeStartTween=game.time.events.add(2*Phaser.Timer.SECOND,function(){e.start()},this),e.onUpdateCallback(function(){t.text=parseInt(t.text)},this),e.onComplete.add(function(){window.cordova&&"undefined"!=typeof device?(n.isWatchRewardVideo,n.tweenDestroy()):n.tweenDestroy()},this)}},{key:"tweenDestroy",value:function(){var e=this,t=game.add.tween(this.popup).to({y:-1200*window.GameConfig.RESIZE},200,"Linear",!1);this.timeTweenDestroy=game.time.events.add(1*Phaser.Timer.SECOND,function(){t.start()},this),t.onComplete.add(function(){e.destroy()},this)}},{key:"stopCountTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy(),game.time.events.remove(this.timerToCountTime),this.timerToCountTime=null)}},{key:"destroy",value:function(){this.stopCountTime(),this.removeEventExtension(),iE(oE(t.prototype),"destroy",this).call(this)}}])&&tE(n.prototype,i),o&&tE(n,o),t}();function rE(e){return(rE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hE(e,t){return!t||"object"!==rE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cE(e){return(cE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uE(e,t){return(uE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dE=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=hE(this,cE(t).call(this,game))).x=e,o.y=n,o.positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),o.user=i,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.avatar,this.frame,this.name,this.levelTitle,this.frame=new Phaser.Sprite(game,-5,-5,"playSprites","Khung_Ava_Thuong"),this.frame.width=130,this.frame.height=130,this.addChild(this.frame),this.avatar=new Phaser.Sprite(game,0,0,"otherSprites","ava-default"),this.avatar.width=120,this.avatar.height=120,this.maskAva=new Phaser.Graphics(game,this.avatar.width/2,this.avatar.width/2),this.maskAva.beginFill(),this.maskAva.drawCircle(0,0,this.avatar.width),this.addChild(this.maskAva),this.avatar.mask=this.maskAva,this.addChild(this.avatar),this.name=new Phaser.Text(game,this.positionWinConfig.last_week_screen.user_name.x,this.positionWinConfig.last_week_screen.user_name.y,this.user.userName,this.positionWinConfig.last_week_screen.user_name.configs),this.name.anchor.set(.5,0),this.addChild(this.name),this.levelTitle=new Phaser.Text(game,this.positionWinConfig.last_week_screen.level_title.x,this.positionWinConfig.last_week_screen.level_title.y,this.user.level_title,this.positionWinConfig.last_week_screen.level_title.configs),this.levelTitle.anchor.set(.5,0),this.addChild(this.levelTitle),""!==this.user.avatar&&this.loadAva()}},{key:"loadAva",value:function(){if(game.cache.checkImageKey(this.user.avatar))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.user.avatar,this.user.avatar),e.start()}}},{key:"loadStart",value:function(){}},{key:"onLoad",value:function(){try{game.cache.checkImageKey(this.user.avatar)&&(""!==this.user.avatar?this.avatar.loadTexture(this.user.avatar):this.avatar.loadTexture("otherSprites","ava-default"))}catch(e){}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&lE(n.prototype,i),o&&lE(n,o),t}();function fE(e){return(fE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gE(e,t){return!t||"object"!==fE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yE(e){return(yE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mE(e,t){return(mE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vE=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=gE(this,yE(t).call(this,game))).x=245,n.y=244,n.positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),n.user=e,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.avatar,this.frame,this.name,this.levelTitle,this.frame=new Phaser.Sprite(game,-6,-24,"playSprites","ava"),this.addChild(this.frame),this.avatar=new Phaser.Sprite(game,0,10,"otherSprites","ava-default"),this.avatar.width=140,this.avatar.height=140,this.maskAva=new Phaser.Graphics(game,this.avatar.x+this.avatar.width/2,this.avatar.y+this.avatar.width/2),this.maskAva.beginFill(),this.maskAva.drawCircle(0,0,this.avatar.width),this.addChild(this.maskAva),this.avatar.mask=this.maskAva,this.addChild(this.avatar),this.name=new Phaser.Text(game,this.positionWinConfig.last_week_screen.user_name_win.x,this.positionWinConfig.last_week_screen.user_name_win.y,this.user.userName,this.positionWinConfig.last_week_screen.user_name_win.configs),this.name.anchor.set(.5,0),this.addChild(this.name),this.levelTitle=new Phaser.Text(game,this.positionWinConfig.last_week_screen.level_title_win.x,this.positionWinConfig.last_week_screen.level_title_win.y,this.user.level_title,this.positionWinConfig.last_week_screen.level_title_win.configs),this.levelTitle.anchor.set(.5,0),this.addChild(this.levelTitle),""!==this.user.avatar&&this.loadAva()}},{key:"loadAva",value:function(){if(game.cache.checkImageKey(this.user.avatar))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.user.avatar,this.user.avatar),e.start()}}},{key:"loadStart",value:function(){}},{key:"onLoad",value:function(){try{game.cache.checkImageKey(this.user.avatar)&&(""!==this.user.avatar?this.avatar.loadTexture(this.user.avatar):this.avatar.loadTexture("otherSprites","ava-default"))}catch(e){}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&pE(n.prototype,i),o&&pE(n,o),t}();function wE(e){return(wE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _E(e,t){return!t||"object"!==wE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SE(e){return(SE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EE(e,t){return(EE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CE=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=_E(this,SE(t).call(this,game))).opponent=n,e.positionWinConfig=JSON.parse(game.cache.getText("positionWinConfig")),e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),e.lastWeekResult=null,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtensions(),this.addHeader(),this.addFundaMetal(),this.sendRequestLastWeekResult()}},{key:"sendRequestLastWeekResult",value:function(){qe.instance().showLoading();var e=new SFS2X.SFSObject;e.putInt("opponent_id",this.opponent.id),TF.instance().sendData(Et.TURNBASE_LAST_WEEK_RESULT_REQUEST,e)}},{key:"addHeader",value:function(){this.headerTab=new Phaser.Sprite(game,this.positionWinConfig.header.tab.x,this.positionWinConfig.header.tab.y,this.positionWinConfig.header.tab.nameAtlas,this.positionWinConfig.header.tab.nameSprite),this.addChild(this.headerTab),this.btnBack=new Phaser.Button(game,this.positionWinConfig.header.back.x,this.positionWinConfig.header.back.y,this.positionWinConfig.header.back.nameAtlas,this.onBack,this,null,this.positionWinConfig.header.back.nameSprite),this.headerTab.addChild(this.btnBack),this.txtHeader=new Phaser.Text(game,this.positionWinConfig.header.txt.x,this.positionWinConfig.header.txt.y,this.positionWinConfig.header.txt.text,this.positionWinConfig.header.txt.configs),this.txtHeader.anchor.set(.5,0),this.headerTab.addChild(this.txtHeader)}},{key:"addFundaMetal",value:function(){this.txtScore,this.vsIcon,this.btnShare,this.boxScore,this.txtScore=new Phaser.Text(game,this.positionWinConfig.last_week_screen.txt_score.x,this.positionWinConfig.last_week_screen.txt_score.y,this.positionWinConfig.last_week_screen.txt_score.text,this.positionWinConfig.last_week_screen.txt_score.configs),this.txtScore.anchor.set(.5,0),this.addChild(this.txtScore),this.boxScore=new Phaser.Sprite(game,this.positionWinConfig.last_week_screen.box_score.x,this.positionWinConfig.last_week_screen.box_score.y,this.positionWinConfig.last_week_screen.box_score.nameAtlas,this.positionWinConfig.last_week_screen.box_score.nameSprite),this.boxScore.anchor.set(.5),this.addChild(this.boxScore),this.vsIcon=new Phaser.Sprite(game,this.positionWinConfig.last_week_screen.vs.x,this.positionWinConfig.last_week_screen.vs.y,this.positionWinConfig.last_week_screen.vs.nameAtlas,this.positionWinConfig.last_week_screen.vs.nameSprite),this.vsIcon.anchor.set(.5);var e=new Phaser.Text(game,this.positionWinConfig.last_week_screen.txt_vs.x,this.positionWinConfig.last_week_screen.txt_vs.y,this.positionWinConfig.last_week_screen.txt_vs.text,this.positionWinConfig.last_week_screen.txt_vs.configs);e.anchor.set(.5),this.vsIcon.addChild(e),this.addChild(this.vsIcon),this.btnShare=new Phaser.Button(game,this.positionWinConfig.last_week_screen.btn_share.x,this.positionWinConfig.last_week_screen.btn_share.y,this.positionWinConfig.last_week_screen.btn_share.nameAtlas,this.onClickShare,this,null,this.positionWinConfig.last_week_screen.btn_share.nameSprite),this.btnShare.anchor.set(.5);var t=new Phaser.Text(game,this.positionWinConfig.last_week_screen.btn_share.txt.x,this.positionWinConfig.last_week_screen.btn_share.txt.y,this.positionWinConfig.last_week_screen.btn_share.txt.text,this.positionWinConfig.last_week_screen.btn_share.txt.configs);t.anchor.set(0,.5),this.btnShare.addChild(t),this.addChild(this.btnShare)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),De.instance().event.backLastWeek.dispatch(),this.destroy()}},{key:"onClickShare",value:function(){ce.instance().playSound(ce.buttonclick),ui.instance().share()}},{key:"onExtensionResponse",value:function(e){if(e.cmd==Et.TURNBASE_LAST_WEEK_RESULT_RESPONSE&&"OK"==e.params.getUtfString("status")){var t=e.params.getSFSObject("last_week_result"),n=t.getInt("user_won"),i=t.getInt("opponent_won");this.lastWeekResult={user_won:n,opponent_won:i},this.opponent.level_title="Gâu gâu",this.showResult()}}},{key:"showResult",value:function(){this.scorePoint,this.userSprite,this.opponentSprite,this.scorePoint=new Phaser.Text(game,this.positionWinConfig.last_week_screen.score_point.x,this.positionWinConfig.last_week_screen.score_point.y,"".concat(this.lastWeekResult.opponent_won," - ").concat(this.lastWeekResult.user_won),this.positionWinConfig.last_week_screen.score_point.configs),this.scorePoint.anchor.set(.5),this.boxScore.addChild(this.scorePoint),this.circle=new Phaser.Sprite(game,320,320,"playSprites","Light"),this.circle.anchor.set(.5),this.tweenCircle=game.add.tween(this.circle).to({angle:359},2e3,"Linear",!0,0,-1,!1),this.tweenCircle.start(),this.addChild(this.circle),this.userSprite=new dE(395,734,{id:TF.instance().dataMySeft.user_id,userName:TF.instance().dataMySeft.user_name,avatar:TF.instance().dataMySeft.avatar,is_online:!0,level_title:"Meo Meo"}),this.opponentSprite=new dE(125,734,this.opponent),this.addChild(this.userSprite),this.addChild(this.opponentSprite),this.addCongrat(),qe.instance().hideLoading()}},{key:"addCongrat",value:function(){this.lastWeekResult.user_won>this.lastWeekResult.opponent_won?(this.addTxtWhoWin(),this.userWin=new vE({id:TF.instance().dataMySeft.user_id,userName:TF.instance().dataMySeft.user_name,avatar:TF.instance().dataMySeft.avatar,is_online:!0,level_title:"Meo Meo"}),this.addChild(this.userWin)):this.lastWeekResult.user_won==this.lastWeekResult.opponent_won?this.addTxtDeuce():(this.addTxtWhoWin(),this.userWin=new vE(this.opponent),this.addChild(this.userWin)),this.addFirework()}},{key:"addTxtWhoWin",value:function(){this.txtWhoWin=new Phaser.Text(game,this.positionWinConfig.last_week_screen.txt_who_win.x,this.positionWinConfig.last_week_screen.txt_who_win.y,this.positionWinConfig.last_week_screen.txt_who_win.text,this.positionWinConfig.last_week_screen.txt_who_win.configs),this.txtWhoWin.anchor.set(.5,0),this.addChild(this.txtWhoWin)}},{key:"addTxtDeuce",value:function(){this.txtDeuce=new Phaser.Sprite(game,this.positionWinConfig.last_week_screen.deuce.x,this.positionWinConfig.last_week_screen.deuce.y,this.positionWinConfig.last_week_screen.deuce.nameAtlas,this.positionWinConfig.last_week_screen.deuce.nameSprite),this.txtDeuce.anchor.set(.5),this.addChild(this.txtDeuce)}},{key:"addFirework",value:function(){this.fireWork=new Phaser.Sprite(game,320*window.GameConfig.RESIZE,210*window.GameConfig.RESIZE,"firework"),this.fireWork.anchor.set(.5),this.fireWork.scale.set(1.3),this.addChild(this.fireWork);this.fireWork.animations.add("run_firework");this.fireWork.animations.play("run_firework",30,!0)}},{key:"addEventExtensions",value:function(){TF.instance().events.onExtensionResponse.add(this.onExtensionResponse,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtensions",value:function(){TF.instance().events.onExtensionResponse.remove(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(this.removeEventExtensions(),this.tweenCircle&&this.tweenCircle.stop();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&bE(n.prototype,i),o&&bE(n,o),t}();function kE(e){return(kE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PE(e,t){return!t||"object"!==kE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OE(e){return(OE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xE(e,t,n){return t&&RE(e.prototype,t),n&&RE(e,n),e}function TE(e,t){return(TE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var IE=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=PE(this,OE(t).call(this,game))).event={change_turnbase:new Phaser.Signal,change_menu:new Phaser.Signal,change_value_resource:new Phaser.Signal},e.badConnection=null,e.popupBuy=null,e.popupMoney=null,e.detail=null,e.levelUp=null,e.popupBuyDone=null,e.detailSong=null,e.inviteFriend=null,e.dialog=null,e.dialogConfirmMoney=null,e.dialogConfirmTicket=null,e.shop=null,e.sortShop=null,e.qAndAPopup=null,e.popupClaimQuest=null,e.userProfile=null,e.ranking=null,e.chatOnlineMode=null,e.turnbase=null,e.animClaimReward=null,e.achievedNotification=null,e.chatScreen=null,e.popupShortUserProfile=null,e.dailyReward=null,e.dailyRewardPopup=null,e.soloModeRankingClaimPopup=null,e.screenTimeout=null,e.screenLosePopup=null,e.screenReward=null,e.screenNotReward=null,e.screenDoneSoloMode=null,e.animClaimReward=null,e.questClaimPopup=null,e.achievementClaimPopup=null,e.dailyrewardPopup=null,e.chatScreen=null,e.settingScreen=null,e.settingGameScreen=null,e.settingAccountScreen=null,e.settingAccountUserNameScreen=null,e.settingProfileScreen=null,e.popupBuyItemConfirm=null,e.textScroll=null,e.settingGiftcode=null,e.limitTurn=null,e.suggetRating=null,e.mailSystemScreen=null,e.popupNotEnoughResource=null,e.lastWeekResultScreen=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TE(e,t)}(t,Phaser.Group),xE(t,[{key:"buyItem",value:function(e){TF.instance().dataMySeft.diamond<e.price?this.addPopupMoney(e):this.addPopupBuy(e)}},{key:"addPopupBuyDone",value:function(e){this.removePopupBuyDone(),this.popupBuyDone=new sc(e),this.popupBuyDone.event.OK.add(this.chooseBuyDoneOk,this),this.addChild(this.popupBuyDone)}},{key:"chooseBuyDoneOk",value:function(){this.removePopupBuyDone()}},{key:"removePopupBuyDone",value:function(){null!==this.popupBuyDone&&(this.removeChild(this.popupBuyDone),this.popupBuyDone.destroy(),this.popupBuyDone=null)}},{key:"addPopupQAndA",value:function(e){this.removePopupQAndA(),this.qAndAPopup=new QuestAndAchievementScreen(e),this.qAndAPopup.setQuestAndQuestLogs(),this.qAndAPopup.signalBack.add(this.onQAndAPopupBack,this),this.addChild(this.qAndAPopup)}},{key:"onQAndAPopupBack",value:function(){this.removePopupQAndA(),window.smartFoxSignal.sendData(DataCommand.QUEST_LOAD_REQUEST,null)}},{key:"removePopupQAndA",value:function(){null!==this.qAndAPopup&&(this.removeChild(this.qAndAPopup),this.qAndAPopup.destroy(),this.qAndAPopup=null)}},{key:"addPopupBuy",value:function(e){this.removePopupBuy(),this.popupBuy=new jh,this.popupBuy.event.OK.add(this.chooseOk,this),this.popupBuy.event.CANCLE.add(this.chooseCanle,this),this.popupBuy.setData(e),this.addChild(this.popupBuy)}},{key:"chooseOk",value:function(e){TF.instance().dataMySeft.diamond<e.price?this.addPopupMoney(e):(qe.instance().showLoading(),TF.instance().sendData(Hs.SHOP_BUY_PLAYLIST_REQUEST,lc.begin(e.id))),this.removePopupBuy()}},{key:"chooseCanle",value:function(){this.removePopupBuy()}},{key:"removePopupBuy",value:function(){null!==this.popupBuy&&(this.removeChild(this.popupBuy),this.popupBuy.destroy(),this.popupBuy=null)}},{key:"addPopupMoney",value:function(e){this.removePopupBuy(),this.popupMoney=new jh,this.popupMoney.event.OK.add(this.chooseMoneyOk,this),this.popupMoney.event.CANCLE.add(this.chooseMoneyCancle,this),this.popupMoney.setContent("Bạn không đủ ngọc\nbạn muốn mua thêm ngọc?"),this.popupMoney.setData(e),this.addChild(this.popupMoney)}},{key:"chooseMoneyOk",value:function(e){this.addShop(1),this.removePopupMoney()}},{key:"chooseMoneyCancle",value:function(){this.removePopupMoney()}},{key:"removePopupMoney",value:function(){null!==this.popupMoney&&(this.removeChild(this.popupMoney),this.popupMoney.destroy(),this.popupMoney=null)}},{key:"addPlaylistDetail",value:function(e){LogConsole.log("addPlaylistDetail"),this.removePlaylistDetail(),this.detail=new Db(e),this.detail.addEventBack(this.removePlaylistDetail,this),this.addChild(this.detail)}},{key:"removePlaylistDetail",value:function(){null!==this.detail&&(this.removeChild(this.detail),this.detail.destroy(),this.detail=null)}},{key:"addLevelUp",value:function(e){var t=this;setTimeout(function(){t.beginAddUpLevel(e)},2500)}},{key:"beginAddUpLevel",value:function(e){this.removeLevelUp(),this.levelUp=new zb(e),this.levelUp.event.close.add(this.closeLevelUp,this),this.addChild(this.levelUp)}},{key:"closeLevelUp",value:function(){this.removeLevelUp()}},{key:"removeLevelUp",value:function(){null!==this.levelUp&&(this.removeChild(this.levelUp),this.levelUp.destroy(),this.levelUp=null)}},{key:"addDetailSong",value:function(e){this.removeDetailSong(),this.detailSong=new $l(e),this.addChild(this.detailSong)}},{key:"removeDetailSong",value:function(){null!==this.detailSong&&(this.removeChild(this.detailSong),this.detailSong.destroy(),this.detailSong=null)}},{key:"addDialogInviteFriend",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.removeDialogInviteFriend(),z.instance().playScript.playing_guide==en.DONE_ALL&&(this.inviteFriend=new Rc(e,t),this.inviteFriend.event.OK.add(this.chooseOkInviteFriend,this),this.inviteFriend.event.CANCLE.add(this.chooseCancleInviteFriend,this),this.inviteFriend.event.OK_CMD.add(this.chooseOkCmdInviteFriend,this),this.inviteFriend.event.CANCLE_CMD.add(this.chooseCancleCmdInviteFriend,this),this.addChild(this.inviteFriend))}},{key:"chooseOkCmdInviteFriend",value:function(e,t){TF.instance().dataMySeft.diamond<t?this.addDialogConfirnMoney("Bạn không đủ kim cương để vào phòng, bạn có muốn nạp thêm?"):TF.instance().sendData(nS.ONLINE_MODE_ROOM_QUICK_JOIN_REQUEST,eS.begin(e)),this.removeDialogInviteFriend()}},{key:"chooseOkInviteFriend",value:function(e){TF.instance().dataMySeft.diamond<e.params.getInt("bet_place")?this.addDialogConfirnMoney("Bạn không đủ kim cương để vào phòng, bạn có muốn nạp thêm?"):TF.instance().sendInvitationReply(e,SFS2X.InvitationReply.ACCEPT),this.removeDialogInviteFriend()}},{key:"chooseCancleCmdInviteFriend",value:function(){this.removeDialogInviteFriend()}},{key:"chooseCancleInviteFriend",value:function(e){TF.instance().sendInvitationReply(e,SFS2X.InvitationReply.REFUSE),this.removeDialogInviteFriend()}},{key:"removeDialogInviteFriend",value:function(){null!==this.inviteFriend&&(this.removeChild(this.inviteFriend),this.inviteFriend.destroy(),this.inviteFriend=null)}},{key:"addDialog",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.removeDialog(),this.dialog=new _n(e,t),""!==n&&this.dialog.setContentButton(n),this.dialog.event.OK.add(this.removeDialog,this),this.addChild(this.dialog)}},{key:"removeDialog",value:function(){null!==this.dialog&&(this.removeChild(this.dialog),this.dialog.destroy(),this.dialog=null)}},{key:"addDialogConfirnMoney",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.removeDialogConfirnMoney(),this.dialogConfirmMoney=new Gc(e,t),this.dialogConfirmMoney.event.OK.add(this.chooseOkConfirmMoney,this),this.dialogConfirmMoney.event.CANCLE.add(this.chooseCancleConfirmMoney,this),this.addChild(this.dialogConfirmMoney)}},{key:"removeDialogConfirnMoney",value:function(){null!==this.dialogConfirmMoney&&(this.removeChild(this.dialogConfirmMoney),this.dialogConfirmMoney.destroy(),this.dialogConfirmMoney=null)}},{key:"chooseOkConfirmMoney",value:function(){this.addShop(1,Mv.GEM),this.removeDialogConfirnMoney()}},{key:"chooseCancleConfirmMoney",value:function(){this.removeDialogConfirnMoney()}},{key:"addDialogConfirnTicket",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.removeDialogConfirnTicket(),this.dialogConfirmTicket=new Gc(e,t),this.dialogConfirmTicket.event.OK.add(this.chooseOkConfirmTicket,this),this.dialogConfirmTicket.event.CANCLE.add(this.chooseCancleConfirmTicket,this),this.addChild(this.dialogConfirmTicket)}},{key:"removeDialogConfirnTicket",value:function(){null!==this.dialogConfirmTicket&&(this.removeChild(this.dialogConfirmTicket),this.dialogConfirmTicket.destroy(),this.dialogConfirmTicket=null)}},{key:"chooseOkConfirmTicket",value:function(){this.addShop(1,Mv.TICKET),this.removeDialogConfirnTicket()}},{key:"chooseCancleConfirmTicket",value:function(){this.removeDialogConfirnTicket()}},{key:"addShop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.removeShop(),this.shop=new Iw(e,t),this.shop.event.close.add(this.tweenRemoveShop,this),this.shop.event.view_all_shop.add(this.addSortShop,this),this.shop.event.search_shop.add(this.addSortShop,this),this.addChild(this.shop)}},{key:"tweenRemoveShop",value:function(){null!==this.shop&&(Nc.instance().beginSwitch(this.shop,null,!1),Nc.instance().event.tweenComplete.add(this.tweenShopComplete,this))}},{key:"tweenShopComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenShopComplete,this),this.removeShop()}},{key:"removeShop",value:function(){null!==this.shop&&(this.removeChild(this.shop),this.shop.destroy(),this.shop=null)}},{key:"addSortShop",value:function(e){this.removeSortShop(),this.sortShop=new Fw,this.sortShop.setData(e.type,e.genres,e.typeMenu,e.ktSearch),this.sortShop.event.back.add(this.choosebackSortShop,this),Nc.instance().beginSwitch(null,this.sortShop,!1),Nc.instance().event.tweenComplete.add(this.tweenSortShopBeginComplete,this),this.addChild(this.sortShop)}},{key:"choosebackSortShop",value:function(){this.addShop(0),this.removeSortShop()}},{key:"tweenSortShopComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenSortShopComplete,this),this.removeSortShop()}},{key:"tweenSortShopBeginComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenSortShopBeginComplete,this),this.sortShop.addEvent()}},{key:"removeSortShop",value:function(){null!==this.sortShop&&(this.removeChild(this.sortShop),this.sortShop.destroy(),this.sortShop=null)}},{key:"addUserProfile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.removeUserProfile(),this.userProfile=new om(e,t),this.userProfile.event.back.add(this.removeUserProfile,this),this.addChild(this.userProfile)}},{key:"removeUserProfile",value:function(){null!==this.userProfile&&(this.removeChild(this.userProfile),this.userProfile.destroy(),this.userProfile=null)}},{key:"addRanking",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.ranking=new Ranking(e),this.ranking.event.back.add(this.removeRanking,this),this.addChild(this.ranking)}},{key:"removeRanking",value:function(){null!==this.ranking&&(this.removeChild(this.ranking),this.ranking.destroy(),this.ranking=null)}},{key:"addChatOnlineMode",value:function(){this.chatOnlineMode=new yS,this.chatOnlineMode.x=36,this.chatOnlineMode.y=game.height-444,this.chatOnlineMode.event.close_dialog.add(this.removeChatOnlineMode,this),this.addChild(this.chatOnlineMode)}},{key:"removeChatOnlineMode",value:function(){null!==this.chatOnlineMode&&(this.removeChild(this.chatOnlineMode),this.chatOnlineMode.destroy(),this.chatOnlineMode=null)}},{key:"addChatScreen",value:function(e){this.removeChatScreen(),this.chatScreen=new _l(e),this.addChild(this.chatScreen)}},{key:"removeChatScreen",value:function(){null!==this.chatScreen&&(this.removeChild(this.chatScreen),this.chatScreen.destroy(),this.chatScreen=null)}},{key:"addShortUserProfile",value:function(e){this.removeShortUserProfile(),this.popupShortUserProfile=new PopupShortProfileUser(e),this.addChild(this.popupShortUserProfile)}},{key:"removeShortUserProfile",value:function(){null!==this.popupShortUserProfile&&(this.removeChild(this.popupShortUserProfile),this.popupShortUserProfile.destroy(),this.popupShortUserProfile=null)}},{key:"addDailyReward",value:function(e,t){this.removeDailyReward(),this.dailyReward=new ia(e,t),this.dailyReward.event.claimDone.add(this.claimDone,this),this.addChild(this.dailyReward)}},{key:"claimDone",value:function(){this.removeDailyReward(),this.event.change_menu.dispatch()}},{key:"removeDailyReward",value:function(){null!==this.dailyReward&&(this.removeChild(this.dailyReward),this.dailyReward.destroy(),this.dailyReward=null)}},{key:"addDailyRewardPopup",value:function(e){this.removeDailyRewardPopup(),this.dailyRewardPopup=new rb(e),this.dailyRewardPopup.eventInput.claim.add(this.dailyRewardPopupClaim,this),this.addChild(this.dailyRewardPopup),this.dailyRewardPopup.makeTweenPopup()}},{key:"dailyRewardPopupClaim",value:function(){this.removeDailyRewardPopup()}},{key:"removeDailyRewardPopup",value:function(){null!==this.dailyRewardPopup&&(this.removeChild(this.dailyRewardPopup),this.dailyRewardPopup.destroy(),this.dailyRewardPopup=null)}},{key:"addSoloModeRankingClaimPopup",value:function(e,t){this.removeSoloModeRankingClaimPopup(),this.soloModeRankingClaimPopup=new PopupClaimSoloMode(e,t),this.addChild(this.soloModeRankingClaimPopup)}},{key:"removeSoloModeRankingClaimPopup",value:function(){null!==this.soloModeRankingClaimPopup&&(this.removeChild(this.soloModeRankingClaimPopup),this.soloModeRankingClaimPopup.destroy(),this.soloModeRankingClaimPopup=null)}},{key:"addSettingGame",value:function(){this.removeSettingGame(),this.settingScreen=new zc,this.addChild(this.settingScreen)}},{key:"removeSettingGame",value:function(){null!==this.settingScreen&&(this.removeChild(this.settingScreen),this.settingScreen.destroy(),this.settingScreen=null)}},{key:"addSettingGameScreen",value:function(){this.removeSettingGameScreen(),this.settingGameScreen=new ru,this.addChild(this.settingGameScreen)}},{key:"removeSettingGameScreen",value:function(){null!==this.settingGameScreen&&(this.removeChild(this.settingGameScreen),this.settingGameScreen.destroy(),this.settingGameScreen=null)}},{key:"addSettingAccountScreen",value:function(){this.removeSettingAccountScreen(),this.settingAccountScreen=new ku,this.addChild(this.settingAccountScreen)}},{key:"removeSettingAccountScreen",value:function(){null!==this.settingAccountScreen&&(this.removeChild(this.settingAccountScreen),this.settingAccountScreen.destroy(),this.settingAccountScreen=null)}},{key:"addSettingAccountUserNameScreen",value:function(){this.removeSettingAccoungUserNameScreen(),this.settingAccountUserNameScreen=new Iu,this.addChild(this.settingAccountUserNameScreen)}},{key:"removeSettingAccoungUserNameScreen",value:function(){null!==this.settingAccountUserNameScreen&&(this.removeChild(this.settingAccountUserNameScreen),this.settingAccountUserNameScreen.destroy(),this.settingAccountUserNameScreen=null)}},{key:"addPopupConfirmBuyItemShop",value:function(e,t,n){this.removePopupConfirmBuyItemShop(),this.popupBuyItemConfirm=new tb(e,t,n),this.popupBuyItemConfirm.event.exit.add(this.removePopupConfirmBuyItemShop,this),this.addChild(this.popupBuyItemConfirm)}},{key:"removePopupConfirmBuyItemShop",value:function(){null!==this.popupBuyItemConfirm&&(this.removeChild(this.popupBuyItemConfirm),this.popupBuyItemConfirm.destroy(),this.popupBuyItemConfirm=null)}},{key:"addTextScroll",value:function(e){this.removeTextScroll(),this.textScroll=new fb(e),this.textScroll.event.complete.add(this.removeTextScroll,this),this.addChild(this.textScroll)}},{key:"removeTextScroll",value:function(){null!==this.textScroll&&(this.removeChild(this.textScroll),this.textScroll.destroy(),this.textScroll=null)}},{key:"addBadConnection",value:function(){this.removeBadConnection(),this.badConnection=new r_,this.badConnection.event.OK.add(this.chooseOkBadConnection,this),this.badConnection.event.CANCLE.add(this.chooseCancleBadConnection,this),this.addChild(this.badConnection)}},{key:"chooseOkBadConnection",value:function(){this.removeBadConnection()}},{key:"chooseCancleBadConnection",value:function(){De.instance().event.chooseExitBadConnection.dispatch(),this.removeBadConnection()}},{key:"removeBadConnection",value:function(){null!=this.badConnection&&(this.removeChild(this.badConnection),this.badConnection.destroy(),this.badConnection=null)}},{key:"addSettingProfileScreen",value:function(){this.removeSettingProfileScreen(),this.settingProfileScreen=new N_,this.addChild(this.settingProfileScreen)}},{key:"removeSettingProfileScreen",value:function(){null!==this.settingProfileScreen&&(this.removeChild(this.settingProfileScreen),this.settingProfileScreen.destroy(),this.settingProfileScreen=null)}},{key:"addSuggetRating",value:function(){"web"!==z.instance().platform&&(this.removeSuggetRating(),this.suggetRating=new DS,this.suggetRating.event.close.add(this.removeSuggetRating,this),this.addChild(this.suggetRating))}},{key:"removeSuggetRating",value:function(){null!==this.suggetRating&&(this.removeChild(this.suggetRating),this.suggetRating.destroy(),this.suggetRating=null)}}],[{key:"instance",value:function(){return this.controllScreenDialog||(this.controllScreenDialog=new t),this.controllScreenDialog}}]),xE(t,[{key:"removeAllItem",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"removeScreen",value:function(){null!==this.screen&&(this.removeChild(this.screen),this.screen.destroy(),this.screen=null)}},{key:"addLastWeekResultScreen",value:function(e){this.removeLastWeekResultScreen(),this.lastWeekResultScreen=new CE(e),this.addChild(this.lastWeekResultScreen)}},{key:"removeLastWeekResultScreen",value:function(){}},{key:"addPopupNotEnoughResource",value:function(e){this.removePopupNotEnoughResource(),this.popupNotEnoughResource=new sE(e),this.addChild(this.popupNotEnoughResource)}},{key:"removePopupNotEnoughResource",value:function(){null!==this.popupNotEnoughResource&&(this.removeChild(this.popupNotEnoughResource),this.popupNotEnoughResource.destroy(),this.popupNotEnoughResource=null)}},{key:"addScreenTimeOut",value:function(e){this.screenTimeout=new qn(e.score),this.screenTimeout.addPopup(),this.screenTimeout.makeTweenPopup(),this.addChild(this.screenTimeout)}},{key:"removeScreenTimeOut",value:function(){null!==this.screenTimeout&&(this.removeChild(this.screenTimeout),this.screenTimeout.destroy(),this.screenTimeout=null)}},{key:"addScreenLosePopup",value:function(e){this.screenLosePopup=new ei(e.score),this.screenLosePopup.addPopup(),this.screenLosePopup.makeTweenPopup(),this.addChild(this.screenLosePopup)}},{key:"removeScreenLosePopup",value:function(){null!==this.screenLosePopup&&(this.removeChild(this.screenLosePopup),this.screenLosePopup.destroy(),this.screenLosePopup=null)}},{key:"addScreenReward",value:function(e){this.screenReward=new mi(e.score,e.reward),this.screenReward.addPopup(),this.screenReward.makeTweenPopup(),this.addChild(this.screenReward)}},{key:"removeScreenReward",value:function(){null!==this.screenReward&&(this.removeChild(this.screenReward),this.screenReward.destroy(),this.screenReward=null)}},{key:"addScreenNotReward",value:function(e){this.screenNotReward=new Ei(e.score),this.screenNotReward.addPopup(),this.screenNotReward.makeTweenPopup(),this.addChild(this.screenNotReward)}},{key:"removeScreenNotReward",value:function(){null!==this.screenNotReward&&(this.removeChild(this.screenNotReward),this.screenNotReward.destroy(),this.screenNotReward=null)}},{key:"addScreenDoneSoloMode",value:function(e){this.screenDoneSoloMode=new Di(e.score,e.reward,e.playlist),this.screenDoneSoloMode.addPopup(),this.screenDoneSoloMode.makeTweenPopup(),this.addChild(this.screenDoneSoloMode)}},{key:"removeScreenDoneSoloMode",value:function(){null!==this.screenDoneSoloMode&&(this.removeChild(this.screenDoneSoloMode),this.screenDoneSoloMode.destroy(),this.screenDoneSoloMode=null)}},{key:"addAnimClaimReward",value:function(e){this.animClaimReward=new si(e.type,e.reward,e.finishPoint),this.addChild(this.animClaimReward)}},{key:"removeAnimClaimReward",value:function(){null!==this.animClaimReward&&(this.removeChild(this.animClaimReward),this.animClaimReward.destroy(),this.animClaimReward=null)}},{key:"addQuestClaimReward",value:function(e){this.questClaimPopup=new qi(e),this.questClaimPopup.makeTweenPopup(),this.questClaimPopup.eventInput.claim.add(this.onClaimQuest,this),this.addChild(this.questClaimPopup)}},{key:"onClaimQuest",value:function(){this.removeQuestClaimReward(),rF.instance().changeScreen(Ce.QUEST_ACHIEVEMENT,2)}},{key:"removeQuestClaimReward",value:function(){null!==this.questClaimPopup&&(this.removeChild(this.questClaimPopup),this.questClaimPopup.destroy(),this.questClaimPopup=null)}},{key:"addAchievementClaimReward",value:function(e){this.achievementClaimPopup=new ao(e),this.achievementClaimPopup.makeTweenPopup(),this.achievementClaimPopup.eventInput.claim.add(this.onClaimAchievement,this),this.addChild(this.achievementClaimPopup)}},{key:"onClaimAchievement",value:function(){this.removeAchievementClaimReward(),rF.instance().changeScreen(Ce.QUEST_ACHIEVEMENT,3)}},{key:"removeAchievementClaimReward",value:function(){null!==this.achievementClaimPopup&&(this.removeChild(this.achievementClaimPopup),this.achievementClaimPopup.destroy(),this.achievementClaimPopup=null)}},{key:"addDailyReward",value:function(e){this.dailyrewardPopup=new ia(e.dailyRewardSettings,e.dailyRewardLog),this.dailyrewardPopup.event.claimDone.add(this.dailyrewardPopupClaimDone,this),this.addChild(this.dailyrewardPopup)}},{key:"dailyrewardPopupClaimDone",value:function(){rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"removeDailyReward",value:function(){null!==this.dailyrewardPopup&&(this.removeChild(this.dailyrewardPopup),this.dailyrewardPopup.destroy(),this.dailyrewardPopup=null)}},{key:"addChatScreen",value:function(e){this.removeChatScreen(),this.chatScreen=new _l(e),this.addChild(this.chatScreen)}},{key:"removeChatScreen",value:function(){null!==this.chatScreen&&(this.removeChild(this.chatScreen),this.chatScreen.destroy(),this.chatScreen=null)}},{key:"addMailSystemScreen",value:function(e){this.removeMailSystemScreen(),this.mailSystemScreen=new $S(e.message_content_id),this.addChild(this.mailSystemScreen)}},{key:"removeMailSystemScreen",value:function(){null!==this.mailSystemScreen&&(this.removeChild(this.mailSystemScreen),this.mailSystemScreen.destroy(),this.mailSystemScreen=null)}},{key:"addSettingGiftcode",value:function(){this.removeSettingGiftcode(),this.settingGiftcode=new X_,this.addChild(this.settingGiftcode)}},{key:"removeSettingGiftcode",value:function(){null!==this.settingGiftcode&&(this.removeChild(this.settingGiftcode),this.settingGiftcode.destroy(),this.settingGiftcode=null)}},{key:"addLimitTurn",value:function(){this.removeLimitTurn(),this.limitTurn=new ES,this.addChild(this.limitTurn)}},{key:"removeLimitTurn",value:function(){null!==this.limitTurn&&(this.removeChild(this.limitTurn),this.limitTurn.destroy(),this.limitTurn=null)}},{key:"changeScreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(LogConsole.log(e),e){case Ce.SOLOMODE_TIMEOUT:this.removeScreenTimeOut(),this.addScreenTimeOut(t);break;case Ce.SOLOMODE_LOSE_POPUP:this.removeScreenLosePopup(),this.addScreenLosePopup(t);break;case Ce.SOLOMODE_REWARD:this.removeScreenReward(),this.addScreenReward(t);break;case Ce.SOLOMODE_NOT_REWARD:this.removeScreenNotReward(),this.addScreenNotReward(t);break;case Ce.SOLOMODE_DONE:this.removeScreenDoneSoloMode(),this.addScreenDoneSoloMode(t);break;case Ce.ANIM_CLAIM_REWARD:this.removeAnimClaimReward(),this.addAnimClaimReward(t);break;case Ce.QUEST_CLAIM_POPUP:this.removeQuestClaimReward(),this.addQuestClaimReward(t);break;case Ce.ACHIEVEMENT_CLAIM_POPUP:this.removeAchievementClaimReward(),this.addAchievementClaimReward(t);break;case Ce.DAILY_REWARD:this.removeDailyReward(),this.addDailyReward(t)}}}]),t}();function AE(e){return(AE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GE(e,t){return!t||"object"!==AE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DE(e){return(DE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ME(e,t){return(ME=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var NE=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=GE(this,DE(t).call(this,game))).positionBootConfig=JSON.parse(game.cache.getText("positionBootConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ME(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this,t=new F;this.addChild(t),this.addLogoSprite();qe.instance().hideLoading(),Bn.getGame(function(t){LogConsole.log("success--------"),LogConsole.log(t),LogConsole.log(t.resource),void 0!==t.resource?(!0,clearInterval(n),e.definedGame(t)):(qe.instance().hideLoading(),IE.instance().addDialog("Kiểm tra kết nối của bạn trước khi vào game"))}),qe.instance().showLoading();var n=setInterval(function(){Bn.getGame(function(t){LogConsole.log("success--------"),LogConsole.log(t),LogConsole.log(t.resource),void 0!==t.resource?(!0,clearInterval(n),qe.instance().hideLoading(),e.definedGame(t)):(qe.instance().hideLoading(),IE.instance().addDialog("Kiểm tra kết nối của bạn trước khi vào game"))})},5e3)}},{key:"addThemeTET",value:function(){var e=new ye;this.addChild(e)}},{key:"definedGame",value:function(e){var t=this;z.instance().isRefreshMenu.checking=!1,z.instance().menuLoadResponses=null;var n=0,i=0;"and"===z.instance().platform?(n=Un.instance().convertVersionToInt(z.VERSION_AND),i=e.resource.hasOwnProperty("android_version")?Un.instance().convertVersionToInt(e.resource.android_version):Un.instance().convertVersionToInt(z.VERSION_AND)):"ios"===z.instance().platform&&(n=Un.instance().convertVersionToInt(z.VERSION_IOS),i=e.resource.hasOwnProperty("ios_version")?Un.instance().convertVersionToInt(e.resource.ios_version):Un.instance().convertVersionToInt(z.VERSION_IOS)),n<i&&(z.instance().ktUpdate=!0),window.RESOURCE=Object.assign({},window.RESOURCE,e.resource),z.instance().ktUpdate&&("and"===z.instance().platform?IE.instance().addDialog("Đã có bản cập nhật mới trên store. Bạn hãy ấn vào đây để cập nhật",window.RESOURCE.android_storage_link,"Cập Nhật"):"ios"===z.instance().platform&&IE.instance().addDialog("Đã có bản cập nhật mới trên store. Bạn hãy ấn vào đây để cập nhật",window.RESOURCE.ios_storage_link,"Cập Nhật")),De.instance().event.onConnectServer.add(this.onConnectServer,this),window.isTest?window.cordova&&"undefined"!=typeof device?(Ie.instance().init(),Ie.instance().event.loginComplete.add(this.loginFbMobileComplete,this),Ie.instance().event.loginStatusUnknown.add(this.loginStatusUnknown,this),Ie.instance().event.loginError.add(this.loginErrorFbMobileComplete,this)):this.initFaceBook(function(){Le.instance().logEvent(Le.LoginScreen),checkLoginState(function(e,n,i){qe.instance().hideLoading(),1==e&&null!=n&&null!=i?(z.instance().LOG_IN_BY_FB=!0,qe.instance().showLoading(),t.getServerInfomationAjax(n,i,function(e){"OK"==e.status?(z.instance().response=e,z.instance().userId=e.userId,z.instance().token=e.token,z.instance().isNewUser=e.isNewUser,t.sfsInfo=e.sfs_info,t.initServer()):"Failed"==e.status?(qe.instance().hideLoading(),IE.instance().addDialog(e.message)):(Gn.instance().addPopupDisconnect(),Gn.instance().addDialog("Đăng nhập Facebook không thành công"))})):(t.addButtonFBLogin(),window.cordova&&"undefined"!=typeof device&&t.addButtonPlayNow(),!1===window.isTest&&t.addButtonPlayNow())})}):(qe.instance().hideLoading(),this.addButtonPlayNow())}},{key:"loginErrorFbMobileComplete",value:function(){qe.instance().hideLoading(),this.addButtonFBLogin(),window.cordova&&"undefined"!=typeof device&&(Gn.instance().addPopupDisconnect(),this.addButtonPlayNow()),!1===window.isTest&&this.addButtonPlayNow()}},{key:"loginStatusUnknown",value:function(){this.addButtonFBLogin(),this.addButtonPlayNow(),qe.instance().hideLoading()}},{key:"loginFbMobileComplete",value:function(e){var t=this;z.instance().LOG_IN_BY_FB=!0,LogConsole.log(e),this.getServerInfomationAjax(e.userID,e.accessToken,function(e){"OK"==e.status?(LogConsole.log(e),z.instance().response=e,z.instance().userId=e.userId,z.instance().token=e.token,z.instance().isNewUser=e.isNewUser,t.sfsInfo=e.sfs_info,t.initServer()):"Failed"==e.status?(qe.instance().hideLoading(),IE.instance().addDialog(e.message)):(t.addButtonPlayNow(),Gn.instance().addPopupDisconnect(),console.warn("Could not get login & sfs informations from webservice"))})}},{key:"onConnectServer",value:function(){LogConsole.log("onConnectServeronConnectServer"),this.loginSFS(z.instance().userId,z.instance().token)}},{key:"addButtonFBLogin",value:function(){this.fbBtn=game.add.button(this.positionBootConfig.btn_fb.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionBootConfig.btn_fb.y)*window.GameConfig.RESIZE,this.positionBootConfig.btn_fb.nameAtlas,this.onclickFBLoginBt,this,null,this.positionBootConfig.btn_fb.nameSprite),this.fbBtn.anchor.set(.5),this.fbBtn.scale.set(.9),this.addChild(this.fbBtn)}},{key:"addButtonPlayNow",value:function(){this.playNowBtn=game.add.button(this.positionBootConfig.btn_play_now.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+this.positionBootConfig.btn_play_now.y)*window.GameConfig.RESIZE,this.positionBootConfig.btn_play_now.nameAtlas,this.onclickPlayNow,this,null,this.positionBootConfig.btn_play_now.nameSprite),this.playNowBtn.anchor.set(.5),this.playNowBtn.scale.set(.9),this.addChild(this.playNowBtn)}},{key:"onclickPlayNow",value:function(){var e=this;TF.instance().ktLogin=!1,TF.instance().loginSFSByDevice(function(t){"OK"==t.status?(LogConsole.log(t),z.instance().response=t,z.instance().userId=t.userId,z.instance().token=t.token,z.instance().isNewUser=t.isNewUser,e.sfsInfo=t.sfs_info,e.initServer()):(Gn.instance().addPopupDisconnect(),console.warn("Could not get login & sfs informations from webservice"))})}},{key:"onclickFBLoginBt",value:function(){TF.instance().ktLogin=!1,Le.instance().logEvent(Le.Login_buttons),window.cordova&&"undefined"!=typeof device?(Ie.instance().login(),qe.instance().showLoading()):FB.login(function(e){"unknown"==e.status&&alert("Đăng nhập lỗi, hãy đăng nhập lại! :'("),"connected"==e.status&&rF.instance().changeScreen(Ce.LOGIN)},{scope:"email, user_gender, user_friends"})}},{key:"addLogoSprite",value:function(){var e=game.add.sprite(this.positionBootConfig.logo.x*window.GameConfig.RESIZE,this.positionBootConfig.logo.y*window.GameConfig.RESIZE,"".concat(this.positionBootConfig.logo.nameAtlas),"".concat(this.positionBootConfig.logo.nameSprite));e.anchor.set(.5),this.addChild(e)}},{key:"loginSFS",value:function(e,t){TF.instance().loginSFS(e,t)}},{key:"initFaceBook",value:function(e){FB.init({appId:window.RESOURCE.fb_app,cookie:!0,xfbml:!0,version:"v3.1"}),e()}},{key:"getServerInfomationAjax",value:function(e,t,n){var i={fbId:e,accessToken:t,device:ze.getNamePlatform()};$.ajax({url:window.RESOURCE.login_url,type:"POST",data:i,dataType:"json",success:function(e){n(e)},error:function(e,t,i){console.error("Error get server infomation"),console.error(i),console.error(e.status),console.error(e.responseJSON),n({status:"ERROR_LOGIN"})}})}},{key:"initServer",value:function(){var e={host:"103.9.77.122",port:8096,useSSL:!1,zone:"MusicQuiz",debug:!1};this.sfsInfo&&(e.host=this.sfsInfo.sfs_host,e.port=this.sfsInfo.sfs_port,e.useSSL=this.sfsInfo.sfs_ssl,e.zone=this.sfsInfo.sfs_zone,e.debug=this.sfsInfo.sfs_debug),LogConsole.log(this.sfsInfo),TF.instance().initListenerSfs(e),TF.instance().connect()}},{key:"destroy",value:function(){for(De.instance().event.onConnectServer.remove(this.onConnectServer,this),Ie.instance().event.loginComplete.remove(this.loginFbMobileComplete,this),Ie.instance().event.loginError.remove(this.loginErrorFbMobileComplete,this),Ie.instance().event.loginStatusUnknown.remove(this.loginStatusUnknown,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&LE(n.prototype,i),o&&LE(n,o),t}();function BE(e){return(BE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function UE(e){return(UE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FE(e,t){return(FE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ZE(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var HE=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,o=UE(t).call(this,game,0,0,e),(n=!o||"object"!==BE(o)&&"function"!=typeof o?ZE(i):o).inputEnabled=!0,n.scrollMaskMenu=new Phaser.Graphics(game,0,353*window.GameConfig.RESIZE),n.scrollMaskMenu.beginFill(1378108),n.scrollMaskMenu.drawRect(0,353*window.GameConfig.RESIZE,game.width,1090*window.GameConfig.RESIZE),n.scrollMaskMenu.endFill(),n.countHeight=n.height-440*window.GameConfig.RESIZE,n.txtRefresh=n.addTxtRefresh(),n.addChild(n.txtRefresh),n.savedPosition=new Phaser.Point(n.x,n.y),n.movingSpeed=0,n.friction=.94,n.speedMult=.7,n.input.enableDrag(),n.input.allowHorizontalDrag=!1,n.events.onDragStart.add(function(){n.isDraging=!0,n.savedPosition=new Phaser.Point(n.x,n.y),n.movingSpeed=0},ZE(ZE(n))),n.events.onDragStop.add(n.onDragStop,ZE(ZE(n))),n.events.onDragUpdate.add(n.onDragUpdate,ZE(ZE(n))),n.mask=n.scrollMaskMenu,n.countHeightChild=0,n.event={refreshMenu:new Phaser.Signal,scrollChange:new Phaser.Signal,scrollDefault:new Phaser.Signal,scrollList:new Phaser.Signal},n.isScrollChange=!1,1==z.instance().isScrollChange?(n.y=-235,n.scrollMaskMenu.countHeight=1270):(n.y=0,n.scrollMaskMenu.countHeight=1090),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FE(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addTxtRefresh",value:function(){var e=new Phaser.Text(game,game.world.centerX,250*window.GameConfig.RESIZE,"Refresh..",{font:"".concat(20*window.GameConfig.RESIZE,"px GilroyMedium"),fill:"#ffffff"});return e.anchor.set(.5),e}},{key:"onDragStop",value:function(){this.isDraging=!1,this.position.y>100*window.GameConfig.RESIZE?this.tweenInertiaComplete():(this.tweenInertia=game.add.tween(this).to({alpha:1},300,"Linear",!0),this.tweenInertia.start(),this.tweenInertia.onUpdateCallback(this.updateInertia,this),this.tweenInertia.onComplete.add(this.tweenInertiaComplete,this))}},{key:"updateInertia",value:function(){!0!==this.isDraging&&(this.movingSpeed>0?(this.y>30*window.GameConfig.RESIZE?this.y+=this.movingSpeed*Math.sin(this.movingangle)*.1:this.position.y<(game.height-150)*window.GameConfig.RESIZE-this.countHeight?this.y+=this.movingSpeed*Math.sin(this.movingangle)*.1:this.y+=this.movingSpeed*Math.sin(this.movingangle),this.movingSpeed=this.movingSpeed*this.friction,this.distanceNew=this.distanceNew*this.friction):this.distanceNew>0&&(this.movingSpeed=this.distanceNew*this.speedMult,this.movingangle=this.angleNew)),this.catchScrollList()}},{key:"catchScrollChange",value:function(){this.y<=-20?!0!==this.isScrollChange&&(this.isScrollChange=!0,!0!==z.instance().isScrollChange&&(this.event.scrollChange.dispatch(),this.scrollChange(),z.instance().isScrollChange=!0)):!1!==this.isScrollChange&&(this.isScrollChange=!1,!1!==z.instance().isScrollChange&&(z.instance().isScrollChange=!1,this.event.scrollDefault.dispatch(),this.scrollDefault()))}},{key:"tweenInertiaComplete",value:function(){(this.catchScrollChange(),this.position.y>=0)&&game.add.tween(this).to({y:0},200,"Linear").start();(this.position.y>100*window.GameConfig.RESIZE&&(this.countHeightChild=0,this.countHeight=this.height-440*window.GameConfig.RESIZE,this.sendRequestMenuChallenges()),(game.height-130)*window.GameConfig.RESIZE-this.countHeight<0)?this.position.y<(game.height-130)*window.GameConfig.RESIZE-this.countHeight&&(1==z.instance().isScrollChange&&this.countHeight<this.scrollMaskMenu.countHeight?game.add.tween(this).to({y:-245},200,"Linear").start():game.add.tween(this).to({y:(game.height-130)*window.GameConfig.RESIZE-this.countHeight},200,"Linear").start()):1==z.instance().isScrollChange?game.add.tween(this).to({y:-235},200,"Linear").start():game.add.tween(this).to({y:0},200,"Linear").start()}},{key:"onDragUpdate",value:function(){this.catchScrollChange(),this.distanceNew=Math.abs(this.y-this.savedPosition.y),this.angleNew=0,this.y-this.savedPosition.y>0?this.angleNew=90:this.angleNew=-90,this.savedPosition=new Phaser.Point(this.x,this.y),this.catchScrollList()}},{key:"catchScrollList",value:function(){this.y<-840&&this.y>-1680?this.event.scrollList.dispatch(8):this.y<-1680&&this.y>-2520?this.event.scrollList.dispatch(16):this.y<-2520&&this.y>-3360&&this.event.scrollList.dispatch(24)}},{key:"sendRequestMenuChallenges",value:function(){this.event.refreshMenu.dispatch()}},{key:"scrollChange",value:function(){this.scrollMaskMenu.clear(),this.scrollMaskMenu.drawRect(0,333*window.GameConfig.RESIZE,game.width,1110*window.GameConfig.RESIZE),this.scrollMaskMenu.countHeight=1270}},{key:"scrollDefault",value:function(){this.scrollMaskMenu.clear(),this.scrollMaskMenu.drawRect(0,353*window.GameConfig.RESIZE,game.width,1090*window.GameConfig.RESIZE),this.scrollMaskMenu.countHeight=1090}},{key:"addChildren",value:function(e){this.countHeightChild+=e.height,this.countHeight+=e.height,this.addChild(e)}}])&&jE(n.prototype,i),o&&jE(n,o),t}();function QE(e){return(QE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function WE(e,t){return!t||"object"!==QE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qE(e){return(qE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function KE(e,t){return(KE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zE=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=WE(this,qE(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={onClickFindGame:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KE(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this;this.btn=new Phaser.Button(game,this.positionMenuConfig.btn_findgame.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_findgame.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_findgame.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_findgame.nameSprite),this.btn.anchor.set(.5),this.btn.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),e.event.onClickFindGame.dispatch(),Le.instance().logEvent(Le.Find_Game_turnbase_mode_button)},this);var t=new Phaser.Text(game,this.positionMenuConfig.txt_btn_findgame.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_findgame.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_findgame.text,this.positionMenuConfig.txt_btn_findgame.configs);t.anchor.set(.5),this.btn.addChild(t);var n=new Phaser.Sprite(game,0,-23*window.GameConfig.RESIZE,"FindGameButton");n.anchor.set(.5),this.runAnim=n.animations.add("run_anim"),this.runAnim.onLoop.add(this.onAnimLooped,this),this.runAnim.play(30,!0),this.btn.addChild(n),this.addChild(this.btn)}},{key:"startAnim",value:function(){this.runAnim.play(30,!0)}},{key:"onAnimLooped",value:function(e,t){t.loopCount%10==0&&t.stop()}},{key:"setPosY",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"setPosYDefault",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"sendRequestFindGame",value:function(){TF.instance().sendData(Et.CHALLENGE_GAME_FIND_OPPONENTS_REQUEST,null)}}])&&VE(n.prototype,i),o&&VE(n,o),t}();function YE(e){return(YE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JE(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function XE(e,t){return!t||"object"!==YE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $E(e){return($E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eC(e,t){return(eC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=XE(this,$E(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={onClickPractice:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn=new Phaser.Button(game,this.positionMenuConfig.btn_practice.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_practice.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_practice.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_practice.nameSprite),this.btn.anchor.set(.5),this.btn.events.onInputUp.add(this.onClickPracticeBtn,this);var e=new Phaser.Text(game,this.positionMenuConfig.txt_btn_practice.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_practice.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_practice.text,this.positionMenuConfig.txt_btn_practice.configs);e.anchor.set(.5),this.btn.addChild(e);var t=new Phaser.Sprite(game,0,-23*window.GameConfig.RESIZE,"PracticeButton");t.anchor.set(.5),this.runAnim=t.animations.add("run_anim"),this.runAnim.onLoop.add(this.onAnimLooped,this),this.runAnim.play(30,!0),this.btn.addChild(t),this.addChild(this.btn)}},{key:"onClickPracticeBtn",value:function(){Le.instance().logEvent(Le.Solo_mode_button),ce.instance().playSound(ce.buttonclick),this.event.onClickPractice.dispatch()}},{key:"startAnim",value:function(){this.runAnim.play(30,!0)}},{key:"onAnimLooped",value:function(e,t){t.loopCount%13==0&&t.stop()}},{key:"setPosY",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"setPosYDefault",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"sendSoloModePlaylistsRequest",value:function(){TF.instance().sendData(Et.SOLO_MODE_PLAYLISTS_REQUEST,null)}}])&&JE(n.prototype,i),o&&JE(n,o),t}();function nC(e){return(nC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oC(e,t){return!t||"object"!==nC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aC(e){return(aC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sC(e,t){return(sC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=oC(this,aC(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={goToParty:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn=new Phaser.Button(game,this.positionMenuConfig.btn_party.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_party.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_party.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_party.nameSprite),this.btn.anchor.set(.5),this.btn.events.onInputUp.add(this.onClickPartyBtn,this);var e=new Phaser.Text(game,this.positionMenuConfig.txt_btn_party.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_party.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_btn_party.text,this.positionMenuConfig.txt_btn_party.configs);e.anchor.set(.5),this.btn.addChild(e);var t=new Phaser.Sprite(game,0,-23*window.GameConfig.RESIZE,"PartyButton");t.anchor.set(.5),this.runAnim=t.animations.add("run_anim"),this.runAnim.onLoop.add(this.onAnimLooped,this),this.runAnim.play(30,!0),this.btn.addChild(t),this.addChild(this.btn)}},{key:"onClickPartyBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.goToParty.dispatch()}},{key:"startAnim",value:function(){this.runAnim.play(30,!0)}},{key:"setPosY",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"setPosYDefault",value:function(e){game.add.tween(this.btn).to({y:e},150,"Linear",!0).start()}},{key:"onAnimLooped",value:function(e,t){t.loopCount%10==0&&t.stop()}}])&&iC(n.prototype,i),o&&iC(n,o),t}();function lC(e){return(lC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cC(e){return(cC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uC(e,t){return(uC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var fC=function(e){function t(e,n,i,o){var a,s,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),s=this,r=cC(t).call(this,game,e,n,i,o),(a=!r||"object"!==lC(r)&&"function"!=typeof r?dC(s):r).anchor.set(.5),a.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),a.inputEnabled=!0,a.event={tick:new Phaser.Signal},a.addTick(),a.events.onInputUp.add(function(){a.event.tick.dispatch()},dC(dC(a))),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uC(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"addTick",value:function(){this.btn_tick=new Phaser.Sprite(game,this.positionMenuConfig.delete_game.tick_of_btn_delete.x,this.positionMenuConfig.delete_game.tick_of_btn_delete.y,this.positionMenuConfig.delete_game.tick_of_btn_delete.nameAtlas,this.positionMenuConfig.delete_game.tick_of_btn_delete.nameSprite),this.btn_tick.anchor.set(.5),this.btn_tick.kill(),this.addChild(this.btn_tick)}},{key:"showTick",value:function(){void 0!==this.btn_tick&&this.btn_tick.revive()}},{key:"hideTick",value:function(){void 0!==this.btn_tick&&this.btn_tick.kill()}}])&&hC(n.prototype,i),o&&hC(n,o),t}();function pC(e){return(pC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yC(e,t){return!t||"object"!==pC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mC(e){return(mC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vC(e,t){return(vC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wC=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=yC(this,mC(t).call(this,game,e,n,i,o))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),a.event={playGame:new Phaser.Signal,nudgeFriend:new Phaser.Signal,deleteChallenge:new Phaser.Signal},a.isHide=!1,a}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vC(e,t)}(t,Phaser.Sprite),n=t,(o=[{key:"setData",value:function(e,t,n,i,o,a,s,r,l,h,c,u,d,f){this.avaKey=e,this.btnTexture=t,this.userWon=n,this.opponentWon=i,this.gameLogId=o,this.requestId=a,this.turnCount=s,this.opponentEntity=r,this.mode=l,this.isFinish=h,this.can_be_poked=c,this.poked=u,this.baseUpdated=d,this.updated=this.controllUpdated(this.baseUpdated),this.message=f,-1!==s&&(this.btnTexture=s>0?"btnNotFirstGame":"btnFirstGame")}},{key:"setHide",value:function(){this.isHide=!0,this.x=0,this.visible=!1}},{key:"setAppear",value:function(){this.isHide=!1,this.x=0,this.visible=!0}},{key:"controllUpdated",value:function(e){return this.formatChallengeGameUpdated(e)}},{key:"formatChallengeGameUpdated",value:function(e){var t="",n=Date.now()-e;n=parseInt(n/1e3);var i=parseInt((n/2592e3).toFixed(0));if(i>0)t="".concat(i," tháng trước");else{var o=parseInt(n/604800);if(o>0)t="".concat(o," tuần trước");else{var a=parseInt(n/86400);if(a>0)t="".concat(a," ngày trước");else{var s=parseInt(n/3600);if(s>0)t="".concat(s," giờ trước");else{var r=parseInt(n/60);t=r>0?"".concat(r," phút trước"):"vài giây trước"}}}}return t}},{key:"addItems",value:function(){var e=this;this.isHide=!1;var t=new Phaser.Graphics(game,0,0);t.beginFill(16777215),t.drawCircle(71*window.GameConfig.RESIZE,50*window.GameConfig.RESIZE,68*window.GameConfig.RESIZE),t.anchor.set(.5),this.addChild(t);var n=new rl(71*window.GameConfig.RESIZE,50*window.GameConfig.RESIZE,"ava-default",this.avaKey,i);n.sprite.anchor.set(.5),n.sprite.width=68,n.sprite.height=68,n.sprite.mask=t,n.sprite.inputEnabled=!0,n.event.loadAvaDone.add(function(){n.sprite.width=68,n.sprite.height=68},this),n.sprite.events.onInputUp.add(function(){ce.instance().playSound(ce.buttonclick),IE.instance().addUserProfile(e.opponentEntity.id)},this),this.addChild(n.sprite),this.nameFriendChallenge=new Phaser.Text(game,123*window.GameConfig.RESIZE,50*window.GameConfig.RESIZE,Bn.formatName(this.opponentEntity.userName,20),{font:"Gilroy",fill:"white",fontSize:24*window.GameConfig.RESIZE}),this.nameFriendChallenge.anchor.set(0,.5),this.addChild(this.nameFriendChallenge),this.btn_accept=new Phaser.Button(game,this.positionMenuConfig.btn_accept.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_accept.y*window.GameConfig.RESIZE,"otherSprites",function(){},this,null,this.btnTexture),this.btn_accept.anchor.set(.5),this.addChild(this.btn_accept);var o=new Phaser.Text(game,430*window.GameConfig.RESIZE,55*window.GameConfig.RESIZE,"".concat(this.opponentWon," : ").concat(this.userWon),{font:"Gilroy",fill:"white",fontSize:24*window.GameConfig.RESIZE});o.anchor.set(.5),this.addChild(o),this.btn_accept.value={gameLogId:this.gameLogId,requestId:this.requestId,opponentEntity:this.opponentEntity,mode:this.mode,can_be_poked:this.can_be_poked,challenge_msg:this.message},"isWaitingGame"==this.mode&&0==this.can_be_poked&&this.btn_accept.kill(),1==this.poked&&(this.btn_accept.y=35,this.txtPoked=new Phaser.Text(game,505*window.GameConfig.RESIZE,70*window.GameConfig.RESIZE,"Đã chọc bạn",{font:"Gilroy",fill:"#8a8a8a",fontSize:16*window.GameConfig.RESIZE}),this.txtPoked.anchor.set(0,.5),this.addChild(this.txtPoked));var a=new Phaser.Text(game,125*window.GameConfig.RESIZE,80*window.GameConfig.RESIZE,this.updated,{font:"Gilroy",fill:"#8a8a8a",fontSize:16*window.GameConfig.RESIZE});if(a.anchor.set(0,.5),this.addChild(a),this.btn_accept.events.onInputDown.add(function(){ce.instance().playSound(ce.buttonclick),e.btn_accept.input.enabled=!1,e.gameLogId=e.gameLogId,"btnFirstGame"==e.btnTexture?e.event.playGame.dispatch({type:"BECHALLENGED",isHasHistory:!1,opponent:e.btn_accept.value.opponentEntity,gameLogId:e.btn_accept.value.gameLogId,requestId:e.btn_accept.value.requestId,weeklyResult:{userWon:e.userWon,opponentWon:e.opponentWon},challenge_msg:e.btn_accept.value.challenge_msg}):"btnNotFirstGame"==e.btnTexture?("isDoneGame"==e.mode&&e.event.playGame.dispatch({type:"CHALLENGE",opponent:e.btn_accept.value.opponentEntity,weeklyResult:{userWon:e.userWon,opponentWon:e.opponentWon},challenge_msg:e.btn_accept.value.challenge_msg}),"isChallengeGame"==e.mode&&e.event.playGame.dispatch({type:"BECHALLENGED",isHasHistory:!0,opponent:e.btn_accept.value.opponentEntity,gameLogId:e.btn_accept.value.gameLogId,requestId:e.btn_accept.value.requestId,weeklyResult:{userWon:e.userWon,opponentWon:e.opponentWon},challenge_msg:e.btn_accept.value.challenge_msg})):e.event.nudgeFriend.dispatch(e.btn_accept.value),setTimeout(function(){e.btn_accept.input.enabled=!0},5e3)}),1==this.opponentEntity.is_online){var s=new rt({x:84,y:68,nameAtlas:"defaultSource",nameSprite:"Online"});this.addChild(s)}else{var r=new rt({x:84,y:68,nameAtlas:"defaultSource",nameSprite:"Offline"});this.addChild(r)}this.addBtnDelete(),this.addMessage()}},{key:"addMessage",value:function(){null!==this.message&&""!==this.message&&(this.nameFriendChallenge.y=30,this.message=Bn.formatName(this.message.toString(),28),this.txtMessage=new Phaser.Text(game,125,57,this.message,{font:"Gilroy",fill:"#ffa33a",fontSize:21}),this.txtMessage.anchor.set(0,.5),this.addChild(this.txtMessage))}},{key:"addBtnDelete",value:function(){this.btnDelete=new fC(this.positionMenuConfig.delete_game.btn_delete.x*window.GameConfig.RESIZE,this.positionMenuConfig.delete_game.btn_delete.y*window.GameConfig.RESIZE,this.positionMenuConfig.delete_game.btn_delete.nameAtlas,this.positionMenuConfig.delete_game.btn_delete.nameSprite),this.btnDelete.event.tick.add(this.deleteChallenge,this),this.btnDelete.kill(),this.addChild(this.btnDelete)}},{key:"deleteChallenge",value:function(){1==this.isClickDelete?(this.isClickDelete=!1,this.btnDelete.hideTick(),null!==this.opponentEntity&&this.event.deleteChallenge.dispatch(this.opponentEntity.id,this.mode)):(this.isClickDelete=!0,this.btnDelete.showTick(),null!==this.opponentEntity&&this.event.deleteChallenge.dispatch(this.opponentEntity.id,this.mode))}},{key:"showBtnDelete",value:function(){this.isClickDelete=!1,void 0!==this.btnDelete&&(this.btnDelete.hideTick(),this.btnDelete.revive()),this.txtPoked&&this.txtPoked.kill(),0!==this.can_be_poked&&this.btn_accept.kill()}},{key:"hideDelete",value:function(){0!==this.can_be_poked&&this.btn_accept.revive(),this.txtPoked&&this.txtPoked.revive(),void 0!==this.btnDelete&&this.btnDelete.kill()}}])&&gC(n.prototype,o),a&&gC(n,a),t}();function bC(e){return(bC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _C(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SC(e,t){return!t||"object"!==bC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function EC(e){return(EC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function CC(e,t){return(CC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=SC(this,EC(t).call(this,game)))._height=0,e.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.configHeightOfRowTab=106*window.GameConfig.RESIZE,e.countHandleGetMainMenuResponse=0,e.event={playGame:new Phaser.Signal,nudgeFriend:new Phaser.Signal,deleteChallenge:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&CC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"sendRequestMenuChallenges",value:function(){TF.instance().sendData(Et.MAIN_MENU_LOAD_REQUEST,null)}},{key:"sendBeChallengedGameLogRequest",value:function(e,t){var n=new SFS2X.SFSObject;n.putLong("play_log_id",e),n.putLong("challenge_request_id",t),TF.instance().sendData(Et.BECHALLENGED_GAME_OPPONENT_GAME_LOG_REQUEST,n)}},{key:"handleMainMenuLoadResponse",value:function(e,t,n){var i=this;if(z.instance().menuLoadResponses={waitingGames:[],doneGames:[],challengeGames:[]},this.menuResponseGames=[],1==t){if("OK"==e.getUtfString("status")){var o=e.getSFSArray("opponents");Bn.handleArrMainMenuLoad(o,this.menuResponseGames,function(){z.instance().menuOpponentsResponse=i.menuResponseGames,i.filterResponseGames()}),this.init_quests_count=e.getInt("init_quests_count"),this.new_friend_request_count=e.getLong("new_friend_request_count"),this.started_event_count=e.getLong("started_event_count"),this.handlePlayScript(e),this.handleHoursReward(e)}else console.error("MAIN_MENU_LOAD_RESPONSE not response: ".concat(e.errorMessage));n(z.instance().menuLoadResponses,this.init_quests_count,this.new_friend_request_count,this.started_event_count,this.hoursReward,this.play_script)}}},{key:"handlePlayScript",value:function(e){if(this.play_script={playing_guide:"",play_script_questions:[]},e.containsKey("play_script")){var t=e.getSFSObject("play_script");if(t.containsKey("playing_guide")&&(this.play_script.playing_guide=t.getUtfString("playing_guide")),t.containsKey("play_script_questions"))for(var n=t.getSFSArray("play_script_questions"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString("question_type"),s=o.getUtfString("answer1"),r=o.getUtfString("answer2"),l=o.getUtfString("answer3"),h=o.getUtfString("answer4"),c=o.getLong("id"),u=o.getInt("correct_answer"),d=o.getUtfString("file_path"),f=o.getUtfString("file_path"),p=o.getSFSObject("song"),g=p.getUtfString("title"),y=p.getLong("id"),m=p.getUtfString("title"),v=p.getUtfString("author"),w=p.getSFSObject("singer"),b=w.getUtfString("name"),_=w.getUtfString("avatar");this.play_script.play_script_questions.push({questionType:a,answers:[s,r,l,h],correctAnswer:u,songEntity:{thumb:_,song:g,fileName:m,author:v,singer:b,listenLink:f,id:y,fileUrl:d},id:c})}}this.play_script.playing_guide==en.DONE_GET_QUEST&&(z.instance().botChallenge={value:0,gameLogId:z.instance().menuLoadResponses.challengeGames[0].userGameLog,requestId:z.instance().menuLoadResponses.challengeGames[0].id,opponentEntity:z.instance().menuLoadResponses.challengeGames[0].opponentEntity,mode:"isChallengeGame",can_be_poked:z.instance().menuLoadResponses.challengeGames[0].can_be_poked,weeklyResult:{userWon:0,opponentWon:0}})}},{key:"handleHoursReward",value:function(e){var t=e.getSFSObject("hours_reward");this.hoursReward={hours_reward_id:t.getInt("hours_reward_id"),user_id:t.getInt("user_id"),created:t.getLong("created"),state:t.getUtfString("state"),updated:t.getLong("updated")}}},{key:"filterResponseGames",value:function(){z.instance().menuLoadResponses.waitingGames=z.instance().menuOpponentsResponse.filter(function(e){return"THEIR_TURN"==e.status}),z.instance().menuLoadResponses.doneGames=z.instance().menuOpponentsResponse.filter(function(e){return"NO_GAME"==e.status}),z.instance().menuLoadResponses.challengeGames=z.instance().menuOpponentsResponse.filter(function(e){return"YOUR_TURN"==e.status}),z.instance().menuLoadResponses.waitingGames=z.instance().menuLoadResponses.waitingGames.sort(function(e,t){return t.can_be_poked-e.can_be_poked}),z.instance().menuLoadResponses.challengeGames=z.instance().menuLoadResponses.challengeGames.sort(function(e,t){return t.poked-e.poked}),z.instance().menuLoadResponses.challengeGames=z.instance().menuLoadResponses.challengeGames.sort(function(e,t){return t.poked_at-e.poked_at})}},{key:"displayListChallenge",value:function(){this.removeAllChild(),this.configHeightOfRowTab=106*window.GameConfig.RESIZE,this.countHandleGetMainMenuResponse=0,this.grapChallenge=new Phaser.Group(game),this.grapChallenge.y=106*window.GameConfig.RESIZE,this.createGrapScrollMenu(),this.addTittleYourTurn(),this.createTabYourTurn(),this.addTittleTheirTurn(),this.createTabTheirTurn(),this.addChild(this.grapMenu)}},{key:"createTabYourTurn",value:function(){if(void 0!==z.instance().menuLoadResponses.challengeGames&&z.instance().menuLoadResponses.challengeGames.length>0)for(var e=0;e<z.instance().menuLoadResponses.challengeGames.length;e++)0==z.instance().menuLoadResponses.doneGames.length&&z.instance().menuLoadResponses.challengeGames.length==e+1?this.createTabPlayInScrollMenu(e,0,z.instance().menuLoadResponses.challengeGames[e].opponentEntity.avatar,"afterSet",z.instance().menuLoadResponses.challengeGames[e].weeklyResult.userWon,z.instance().menuLoadResponses.challengeGames[e].weeklyResult.opponentWon,z.instance().menuLoadResponses.challengeGames[e].userGameLog,z.instance().menuLoadResponses.challengeGames[e].challenge_request_id,z.instance().menuLoadResponses.challengeGames[e].turnCount,z.instance().menuLoadResponses.challengeGames[e].opponentEntity,"isChallengeGame",!0,z.instance().menuLoadResponses.challengeGames[e].can_be_poked,z.instance().menuLoadResponses.challengeGames[e].poked,z.instance().menuLoadResponses.challengeGames[e].base_updated,z.instance().menuLoadResponses.challengeGames[e].challenge_msg):this.createTabPlayInScrollMenu(e,0,z.instance().menuLoadResponses.challengeGames[e].opponentEntity.avatar,"afterSet",z.instance().menuLoadResponses.challengeGames[e].weeklyResult.userWon,z.instance().menuLoadResponses.challengeGames[e].weeklyResult.opponentWon,z.instance().menuLoadResponses.challengeGames[e].userGameLog,z.instance().menuLoadResponses.challengeGames[e].challenge_request_id,z.instance().menuLoadResponses.challengeGames[e].turnCount,z.instance().menuLoadResponses.challengeGames[e].opponentEntity,"isChallengeGame",!1,z.instance().menuLoadResponses.challengeGames[e].can_be_poked,z.instance().menuLoadResponses.challengeGames[e].poked,z.instance().menuLoadResponses.challengeGames[e].base_updated,z.instance().menuLoadResponses.challengeGames[e].challenge_msg);if(void 0!==z.instance().menuLoadResponses.doneGames&&z.instance().menuLoadResponses.doneGames.length>0)for(var t=0;t<z.instance().menuLoadResponses.doneGames.length;t++)z.instance().menuLoadResponses.doneGames.length==t+1?this.createTabPlayInScrollMenu(t,z.instance().menuLoadResponses.challengeGames.length,z.instance().menuLoadResponses.doneGames[t].opponentEntity.avatar,"afterSet",z.instance().menuLoadResponses.doneGames[t].weeklyResult.userWon,z.instance().menuLoadResponses.doneGames[t].weeklyResult.opponentWon,z.instance().menuLoadResponses.doneGames[t].userGameLog,z.instance().menuLoadResponses.doneGames[t].challenge_request_id,z.instance().menuLoadResponses.doneGames[t].turnCount,z.instance().menuLoadResponses.doneGames[t].opponentEntity,"isDoneGame",!0,z.instance().menuLoadResponses.doneGames[t].can_be_poked,z.instance().menuLoadResponses.doneGames[t].poked,z.instance().menuLoadResponses.doneGames[t].base_updated,z.instance().menuLoadResponses.doneGames[t].challenge_msg):this.createTabPlayInScrollMenu(t,z.instance().menuLoadResponses.challengeGames.length,z.instance().menuLoadResponses.doneGames[t].opponentEntity.avatar,"afterSet",z.instance().menuLoadResponses.doneGames[t].weeklyResult.userWon,z.instance().menuLoadResponses.doneGames[t].weeklyResult.opponentWon,z.instance().menuLoadResponses.doneGames[t].userGameLog,z.instance().menuLoadResponses.doneGames[t].challenge_request_id,z.instance().menuLoadResponses.doneGames[t].turnCount,z.instance().menuLoadResponses.doneGames[t].opponentEntity,"isDoneGame",!1,z.instance().menuLoadResponses.doneGames[t].can_be_poked,z.instance().menuLoadResponses.doneGames[t].poked,z.instance().menuLoadResponses.doneGames[t].base_updated,z.instance().menuLoadResponses.doneGames[t].challenge_msg)}},{key:"createTabTheirTurn",value:function(){if(void 0!==z.instance().menuLoadResponses.waitingGames&&z.instance().menuLoadResponses.waitingGames.length>0)for(var e=0;e<z.instance().menuLoadResponses.waitingGames.length;e++)z.instance().menuLoadResponses.waitingGames.length==e+1?this.createTabPlayInScrollMenu(e,z.instance().menuLoadResponses.doneGames.length+z.instance().menuLoadResponses.challengeGames.length+1,z.instance().menuLoadResponses.waitingGames[e].opponentEntity.avatar,"btnWaitingGame",z.instance().menuLoadResponses.waitingGames[e].weeklyResult.userWon,z.instance().menuLoadResponses.waitingGames[e].weeklyResult.opponentWon,z.instance().menuLoadResponses.waitingGames[e].userGameLog,z.instance().menuLoadResponses.waitingGames[e].challenge_request_id,-1,z.instance().menuLoadResponses.waitingGames[e].opponentEntity,"isWaitingGame",!0,z.instance().menuLoadResponses.waitingGames[e].can_be_poked,z.instance().menuLoadResponses.waitingGames[e].poked,z.instance().menuLoadResponses.waitingGames[e].base_updated,z.instance().menuLoadResponses.waitingGames[e].challenge_msg):this.createTabPlayInScrollMenu(e,z.instance().menuLoadResponses.doneGames.length+z.instance().menuLoadResponses.challengeGames.length+1,z.instance().menuLoadResponses.waitingGames[e].opponentEntity.avatar,"btnWaitingGame",z.instance().menuLoadResponses.waitingGames[e].weeklyResult.userWon,z.instance().menuLoadResponses.waitingGames[e].weeklyResult.opponentWon,z.instance().menuLoadResponses.waitingGames[e].userGameLog,z.instance().menuLoadResponses.waitingGames[e].challenge_request_id,-1,z.instance().menuLoadResponses.waitingGames[e].opponentEntity,"isWaitingGame",!1,z.instance().menuLoadResponses.waitingGames[e].can_be_poked,z.instance().menuLoadResponses.waitingGames[e].poked,z.instance().menuLoadResponses.waitingGames[e].base_updated,z.instance().menuLoadResponses.waitingGames[e].challenge_msg)}},{key:"createGrapScrollMenu",value:function(){this.grapMenu=new Phaser.Group(game),this.grapMenu.y=545*window.GameConfig.RESIZE,this.addChild(this.grapMenu),this.grapMenu.addChild(this.grapChallenge)}},{key:"addTittleYourTurn",value:function(){var e=new Phaser.Sprite(game,this.positionMenuConfig.tab_yourTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.tab_yourTurn.y*window.GameConfig.RESIZE,"otherSprites","tab-friend"),t=new Phaser.Text(game,this.positionMenuConfig.txt_yourTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_yourTurn.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_yourTurn.text,this.positionMenuConfig.txt_yourTurn.configs);t.anchor.set(0,.5);var n=new Phaser.Text(game,this.positionMenuConfig.txt_count_yourTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_count_yourTurn.y*window.GameConfig.RESIZE,"(".concat(z.instance().menuLoadResponses.doneGames.length+z.instance().menuLoadResponses.challengeGames.length," lượt)"),this.positionMenuConfig.txt_count_yourTurn.configs);n.anchor.set(1,.5),e.addChild(n),e.addChild(t),this.addLineUnder(e),this.grapMenu.addChild(e),this.btnMethodDelete1=new Phaser.Button(game,this.positionMenuConfig.delete_game.btn_bin_blue.x,this.positionMenuConfig.delete_game.btn_bin_blue.y,this.positionMenuConfig.delete_game.btn_bin_blue.nameAtlas,this.onClickMethodDeleteYourTurn,this,null,this.positionMenuConfig.delete_game.btn_bin_blue.nameSprite),this.btnMethodDelete1.anchor.set(.5),this.btnMethodDelete1.scale.set(0),e.addChild(this.btnMethodDelete1),this.btnBin1=new Phaser.Button(game,this.positionMenuConfig.delete_game.bin.x,this.positionMenuConfig.delete_game.bin.y,this.positionMenuConfig.delete_game.bin.nameAtlas,this.onClickBinYourTurn,this,null,this.positionMenuConfig.delete_game.bin.nameSprite),this.btnBin1.anchor.set(.5),e.addChild(this.btnBin1),this.btnCancleDelelte1=new Phaser.Button(game,this.positionMenuConfig.delete_game.btn_x.x,this.positionMenuConfig.delete_game.btn_x.y,this.positionMenuConfig.delete_game.btn_x.nameAtlas,this.onClickCancleDelete,this,null,this.positionMenuConfig.delete_game.btn_x.nameSprite),this.btnCancleDelelte1.anchor.set(.5),this.btnCancleDelelte1.kill(),e.addChild(this.btnCancleDelelte1),this._height+=e.height}},{key:"addTittleTheirTurn",value:function(){var e=new Phaser.Sprite(game,this.positionMenuConfig.tab_yourTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.tab_theirTurn.y*window.GameConfig.RESIZE+this.grapChallenge.y+(z.instance().menuLoadResponses.challengeGames.length+z.instance().menuLoadResponses.doneGames.length)*this.configHeightOfRowTab,"otherSprites","tab-friend"),t=new Phaser.Text(game,this.positionMenuConfig.txt_theirTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_theirTurn.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_theirTurn.text,this.positionMenuConfig.txt_theirTurn.configs);t.anchor.set(0,.5);var n=new Phaser.Text(game,this.positionMenuConfig.txt_count_theirTurn.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_count_theirTurn.y*window.GameConfig.RESIZE,"(".concat(z.instance().menuLoadResponses.waitingGames.length," lượt)"),this.positionMenuConfig.txt_count_theirTurn.configs);n.anchor.set(0,.5),e.addChild(n),e.addChild(t),this.btnMethodDelete2=new Phaser.Button(game,this.positionMenuConfig.delete_game.btn_bin_blue.x,this.positionMenuConfig.delete_game.btn_bin_blue.y,this.positionMenuConfig.delete_game.btn_bin_blue.nameAtlas,this.onClickMethodDeleteTheirTurn,this,null,this.positionMenuConfig.delete_game.btn_bin_blue.nameSprite),this.btnMethodDelete2.anchor.set(.5),this.btnMethodDelete2.scale.set(0),e.addChild(this.btnMethodDelete2),this.btnBin2=new Phaser.Button(game,this.positionMenuConfig.delete_game.bin.x,this.positionMenuConfig.delete_game.bin.y,this.positionMenuConfig.delete_game.bin.nameAtlas,this.onClickBinTheirTurn,this,null,this.positionMenuConfig.delete_game.bin.nameSprite),this.btnBin2.anchor.set(.5),e.addChild(this.btnBin2),this.btnCancleDelelte2=new Phaser.Button(game,this.positionMenuConfig.delete_game.btn_x.x,this.positionMenuConfig.delete_game.btn_x.y,this.positionMenuConfig.delete_game.btn_x.nameAtlas,this.onClickCancleDelete,this,null,this.positionMenuConfig.delete_game.btn_x.nameSprite),this.btnCancleDelelte2.anchor.set(.5),this.btnCancleDelelte2.kill(),e.addChild(this.btnCancleDelelte2),this.addLineUnder(e),this.grapMenu.addChild(e),this._height+=e.height}},{key:"onClickMethodDeleteYourTurn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.deleteChallenge.dispatch(this.listYourTurnDeletes)}},{key:"onClickMethodDeleteTheirTurn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.deleteChallenge.dispatch(this.listTheirTurnDeletes)}},{key:"onClickBinTheirTurn",value:function(){ce.instance().playSound(ce.buttonclick),this.listTheirTurnDeletes=[],this.btnBin2.kill(),this.btnCancleDelelte2.revive();for(var e=0;e<this.grapChallenge.children.length;e++){var t=this.grapChallenge.children[e];"isWaitingGame"==t.mode&&t.showBtnDelete()}}},{key:"onClickBinYourTurn",value:function(){ce.instance().playSound(ce.buttonclick),this.listYourTurnDeletes=[],this.btnBin1.kill(),this.btnCancleDelelte1.revive();for(var e=0;e<this.grapChallenge.children.length;e++){var t=this.grapChallenge.children[e];"isWaitingGame"!==t.mode&&t.showBtnDelete()}}},{key:"onClickCancleDelete",value:function(){ce.instance().playSound(ce.buttonclick),this.btnBin1.revive(),this.btnBin2.revive(),this.btnCancleDelelte1.kill(),this.btnCancleDelelte2.kill(),game.add.tween(this.btnMethodDelete1).to({x:580},50,Phaser.Easing.Linear.In,!0).start(),game.add.tween(this.btnMethodDelete2).to({x:580},50,Phaser.Easing.Linear.In,!0).start(),game.add.tween(this.btnMethodDelete1.scale).to({x:0,y:0},50,"Linear",!0).start(),game.add.tween(this.btnMethodDelete2.scale).to({x:0,y:0},50,"Linear",!0).start();for(var e=0;e<this.grapChallenge.children.length;e++){this.grapChallenge.children[e].hideDelete()}}},{key:"addLineUnder",value:function(e){var t=new rt(this.positionMenuConfig.line_under);e.addChild(t)}},{key:"createTabPlayInScrollMenu",value:function(e,t,n,i,o,a,s,r,l,h,c,u,d,f,p,g){var y=this,m=new wC(640*window.GameConfig.RESIZE,(e+t)*this.configHeightOfRowTab+this.positionMenuConfig.tab_theirTurn.y*window.GameConfig.RESIZE,"otherSprites","tab-friend");if(m.setData(n,i,o,a,s,r,l,h,c,u,d,f,p,g),m.event.playGame.add(function(e){y.event.playGame.dispatch(e)},this),m.event.nudgeFriend.add(function(e){y.event.nudgeFriend.dispatch(e)},this),m.event.deleteChallenge.add(function(e,t){"isWaitingGame"==t?(y.listTheirTurnDeletes.includes(e)?y.listTheirTurnDeletes=y.removeFromListDeletes(y.listTheirTurnDeletes,e):y.listTheirTurnDeletes.push(e),y.listTheirTurnDeletes.length>0?525!==y.btnMethodDelete2.x&&(game.add.tween(y.btnMethodDelete2).to({x:525},400,Phaser.Easing.Elastic.Out,!0).start(),game.add.tween(y.btnMethodDelete2.scale).to({x:1,y:1},50,"Linear",!0).start()):(game.add.tween(y.btnMethodDelete2).to({x:580},50,Phaser.Easing.Linear.In,!0).start(),game.add.tween(y.btnMethodDelete2.scale).to({x:0,y:0},50,"Linear",!0).start())):(y.listYourTurnDeletes.includes(e)?y.listYourTurnDeletes=y.removeFromListDeletes(y.listYourTurnDeletes,e):y.listYourTurnDeletes.push(e),y.listYourTurnDeletes.length>0?525!==y.btnMethodDelete1.x&&(game.add.tween(y.btnMethodDelete1).to({x:525},400,Phaser.Easing.Elastic.Out,!0).start(),game.add.tween(y.btnMethodDelete1.scale).to({x:1,y:1},50,"Linear",!0).start()):(game.add.tween(y.btnMethodDelete1).to({x:580},50,Phaser.Easing.Linear.In,!0).start(),game.add.tween(y.btnMethodDelete1.scale).to({x:0,y:0},50,"Linear",!0).start()))},this),0==u&&this.addLineUnder(m),this._height+=m.height,m.addItems(),this.grapChallenge.addChild(m),e<8){var v=game.add.tween(m).to({x:0},500,Phaser.Easing.Back.Out,!1);this.timeout=setTimeout(function(){v.start()},100*e)}else m.setHide()}},{key:"removeFromListDeletes",value:function(e,t){return e.filter(function(e){return e!==t})}},{key:"scrollEventResponse",value:function(e){for(var t=e-1;t<e+8&&!(t>=this.grapChallenge.children.length);t++)1==this.grapChallenge.children[t].isHide&&this.grapChallenge.children[t].setAppear()}},{key:"removeAllChild",value:function(){for(void 0!==this.timeout&&clearTimeout(this.timeout),this.configHeightOfRowTab=106*window.GameConfig.RESIZE,this.countHandleGetMainMenuResponse=0;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}}])&&_C(n.prototype,i),o&&_C(n,o),t}();function PC(e){return(PC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function RC(e,t){return!t||"object"!==PC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xC(e){return(xC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TC(e,t){return(TC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var IC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=RC(this,xC(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.outSize=!0,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.animCircleScale,this.animButtonInOut,this.addBtn(),this.addAnimButtonInOut()}},{key:"addBtn",value:function(){this.btn=new Phaser.Sprite(game,this.positionMenuConfig.btnQAndA.x*window.GameConfig.RESIZE,this.positionMenuConfig.btnQAndA.y*window.GameConfig.RESIZE,this.positionMenuConfig.btnQAndA.nameAtlas,this.positionMenuConfig.btnQAndA.nameSprite),this.btn.inputEnabled=!0,this.btn.anchor.set(.5),this.txtBtn=new Phaser.Text(game,this.positionMenuConfig.txt_QAndA.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_QAndA.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_QAndA.text,this.positionMenuConfig.txt_QAndA.configs),this.txtBtn.anchor.set(.5),this.btn.addChild(this.txtBtn),this.addChild(this.btn)}},{key:"addAnimCircleScale",value:function(){this.animCircleScale=new Phaser.Sprite(game,0,0,"CircleScale"),this.animCircleScale.anchor.set(.5),this.btn.addChild(this.animCircleScale)}},{key:"addAnimButtonInOut",value:function(){this.animButtonInOut=new Phaser.Sprite(game,0,0,"ButtonQuest"),this.animButtonInOut.anchor.set(.5),this.btn.addChild(this.animButtonInOut)}},{key:"addAnim",value:function(){this.animCircleScale.animations.add("run_scale_circle");this.animCircleScale.animations.play("run_scale_circle",30,!0);this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",15,!0)}},{key:"runAnim",value:function(){this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",25,!0)}},{key:"scrollChange",value:function(){this.txtBtn.kill();var e=game.add.tween(this.btn).to({x:this.positionMenuConfig.btnQAndA.x*window.GameConfig.RESIZE+115},70,"Linear",!0);game.add.tween(this.btn).to({y:65},150,"Linear",!0).start(),e.start()}},{key:"scrollDefault",value:function(){this.txtBtn.revive();var e=game.add.tween(this.btn).to({x:this.positionMenuConfig.btnQAndA.x*window.GameConfig.RESIZE},150,"Linear",!0);game.add.tween(this.btn).to({y:this.positionMenuConfig.btnQAndA.y*window.GameConfig.RESIZE},70,"Linear",!0).start(),e.start()}},{key:"addDotNoti",value:function(e){if(e>0){this.runAnim();var t=new Phaser.Sprite(game,this.positionMenuConfig.notiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.y*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.nameAtlas,this.positionMenuConfig.notiDot.nameSprite),n=new Phaser.Text(game,this.positionMenuConfig.txtNotiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.txtNotiDot.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txtNotiDot.configs);n.anchor.set(.5),t.addChild(n),this.btn.addChild(t)}}}])&&OC(n.prototype,i),o&&OC(n,o),t}();function AC(e){return(AC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GC(e,t){return!t||"object"!==AC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DC(e){return(DC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MC(e,t){return(MC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var NC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=GC(this,DC(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.outSize=!0,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.animCircleScale,this.animButtonInOut,this.addBtn(),this.addAnimButtonInOut(),this.runAnim()}},{key:"addBtn",value:function(){this.btn=new Phaser.Sprite(game,this.positionMenuConfig.btnRanking.x*window.GameConfig.RESIZE,this.positionMenuConfig.btnRanking.y*window.GameConfig.RESIZE,this.positionMenuConfig.btnRanking.nameAtlas,this.positionMenuConfig.btnRanking.nameSprite),this.btn.inputEnabled=!0,this.btn.anchor.set(.5),this.txtBtn=new Phaser.Text(game,this.positionMenuConfig.txt_rank.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_rank.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_rank.text,this.positionMenuConfig.txt_rank.configs),this.txtBtn.anchor.set(.5),this.btn.addChild(this.txtBtn),this.addChild(this.btn)}},{key:"addAnimCircleScale",value:function(){this.animCircleScale=new Phaser.Sprite(game,0,0,"CircleScale"),this.animCircleScale.anchor.set(.5),this.btn.addChild(this.animCircleScale)}},{key:"addAnimButtonInOut",value:function(){this.animButtonInOut=new Phaser.Sprite(game,0,0,"ButtonRank"),this.animButtonInOut.anchor.set(.5),this.btn.addChild(this.animButtonInOut)}},{key:"scrollChange",value:function(){this.txtBtn.kill();var e=game.add.tween(this.btn).to({x:this.positionMenuConfig.btnRanking.x*window.GameConfig.RESIZE-115},70,"Linear",!0);game.add.tween(this.btn).to({y:65},150,"Linear",!0).start(),e.start()}},{key:"scrollDefault",value:function(){this.txtBtn.revive();var e=game.add.tween(this.btn).to({x:this.positionMenuConfig.btnRanking.x*window.GameConfig.RESIZE},150,"Linear",!0);game.add.tween(this.btn).to({y:this.positionMenuConfig.btnRanking.y*window.GameConfig.RESIZE},70,"Linear",!0).start(),e.start()}},{key:"runAnim",value:function(){this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",25,!0)}}])&&LC(n.prototype,i),o&&LC(n,o),t}();function BC(e){return(BC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function UC(e,t){return!t||"object"!==BC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function FC(e){return(FC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ZC(e,t){return(ZC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var HC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=UC(this,FC(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.inputEnabled=!0,e.outSize=!0,e.event={gotToEvent:new Phaser.Signal},e.isEvent=!1,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ZC(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.animCircleScale,this.animButtonInOut,this.addBtn(),this.addAnimCircleScale(),this.addAnimButtonInOut()}},{key:"addBtn",value:function(){this.btn=new Phaser.Sprite(game,this.positionMenuConfig.btnEvent.x*window.GameConfig.RESIZE,this.positionMenuConfig.btnEvent.y*window.GameConfig.RESIZE,this.positionMenuConfig.btnEvent.nameAtlas,this.positionMenuConfig.btnEvent.nameSprite),this.btn.anchor.set(.5),this.btn.inputEnabled=!0,this.btn.events.onInputUp.add(this.onClickBtn,this),this.txtBtn=new Phaser.Text(game,this.positionMenuConfig.txt_event.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_event.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_event.text,this.positionMenuConfig.txt_event.configs),this.txtBtn.anchor.set(.5),this.btn.addChild(this.txtBtn),this.addChild(this.btn)}},{key:"onClickBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.gotToEvent.dispatch()}},{key:"addAnimCircleScale",value:function(){this.animCircleScale=new Phaser.Sprite(game,0,0,"CircleScale"),this.animCircleScale.anchor.set(.5),this.btn.addChild(this.animCircleScale)}},{key:"addAnimButtonInOut",value:function(){this.animButtonInOut=new Phaser.Sprite(game,0,0,"ButtonEvent"),this.animButtonInOut.anchor.set(.5),this.btn.addChild(this.animButtonInOut)}},{key:"runAnim",value:function(){this.isEvent=!0;this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",25,!0);this.animCircleScale.animations.add("run_scale_circle");this.animCircleScale.animations.play("run_scale_circle",30,!0)}},{key:"scrollChange",value:function(){this.txtBtn.kill(),game.add.tween(this.btn).to({y:65},150,"Linear",!0).start(),1==this.isEvent&&this.animCircleScale.animations.stop("run_scale_circle",!0)}},{key:"scrollDefault",value:function(){this.txtBtn.revive(),game.add.tween(this.btn).to({y:this.positionMenuConfig.btnEvent.y*window.GameConfig.RESIZE},150,"Linear",!0).start(),1==this.isEvent&&this.animCircleScale.animations.play("run_scale_circle",30,!0)}},{key:"addDotNoti",value:function(e){if(e>0){this.runAnim();var t=new Phaser.Sprite(game,this.positionMenuConfig.notiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.y*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.nameAtlas,this.positionMenuConfig.notiDot.nameSprite),n=new Phaser.Text(game,this.positionMenuConfig.txtNotiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.txtNotiDot.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txtNotiDot.configs);n.anchor.set(.5),t.addChild(n),this.btn.addChild(t)}}}])&&jC(n.prototype,i),o&&jC(n,o),t}();function QC(e){return(QC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function VC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function WC(e,t){return!t||"object"!==QC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qC(e){return(qC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function KC(e,t){return(KC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var zC=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=WC(this,qC(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={claimHourRewardDone:new Phaser.Signal},e.user_id=0,e.user_name="",e.avatar="",e.gender="",e.experience_score=0,e.heart=0,e.diamond=0,e.ticket=0,e.weekly_high_score=0,e.all_time_high_score=0,e.u_level=0,e.level_title="",e.user_id=TF.instance().dataMySeft.user_id,e.user_name=TF.instance().dataMySeft.user_name,e.avatar=TF.instance().dataMySeft.avatar,e.gender=TF.instance().dataMySeft.gender,e.experience_score=TF.instance().dataMySeft.experience_score,e.heart=TF.instance().dataMySeft.heart,e.diamond=TF.instance().dataMySeft.diamond,e.ticket=TF.instance().dataMySeft.ticket,e.weekly_high_score=TF.instance().dataMySeft.weekly_high_score,e.all_time_high_score=TF.instance().dataMySeft.all_time_high_score,e.u_level=TF.instance().dataMySeft.level,e.level_title=TF.instance().socket.mySelf.getVariable("level_title").value,e.addEventExtension(),e.addHeartAndtxtHeart(e.heart),e.addDiamondAndTxtDiamond(e.diamond),e.addTicketAndTxtTicket(e.ticket),e.addDoc(),e.addAvaAndName(e.user_name),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KC(e,t)}(t,Phaser.Group),n=t,o=[{key:"UPDATE_AVA",get:function(){return"update_ava"}},{key:"UPDATE_NAME",get:function(){return"update_name"}}],(i=[{key:"addEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this)}},{key:"onUpdateUserVars",value:function(){TF.instance().dataMySeft.user_id==this.user_id&&(parseInt(this.txt_diamond.text)!==TF.instance().dataMySeft.diamond&&(this.txt_diamond.text=TF.instance().dataMySeft.diamond),parseInt(this.txt_heart.text)!==TF.instance().dataMySeft.heart&&(this.txt_heart.text=TF.instance().dataMySeft.heart),parseInt(this.txt_ticket.text)!==TF.instance().dataMySeft.ticket&&(this.txt_ticket.text=TF.instance().dataMySeft.ticket))}},{key:"updateValue",value:function(e){e==t.UPDATE_AVA||e==t.UPDATE_NAME&&(this.user_name=TF.instance().dataMySeft.user_name,this.nameFB.setText(this.user_name))}},{key:"addAvaAndName",value:function(e){this.maskAva=null,this.ava=null,this.addAva(),this.addNameAndLvl(e),this.loadAva()}},{key:"addFrameAva",value:function(){if(this.user_vip=!1,1==this.user_vip){this.frameAvatar=new Phaser.Sprite(game,this.positionMenuConfig.frame_ava_vip.x*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip.y*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip.nameAtlas,this.positionMenuConfig.frame_ava_vip.nameSprite),this.frameAvatar.anchor.set(.5),this.frameAvatar.scale.set(145/140*window.GameConfig.RESIZE);var e=new Phaser.Sprite(game,this.positionMenuConfig.frame_ava_vip_icon.x*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip_icon.y*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip_icon.nameAtlas,this.positionMenuConfig.frame_ava_vip_icon.nameSprite);e.anchor.set(.5),this.frameAvatar.addChild(e),this.laurel=new Phaser.Sprite(game,this.positionMenuConfig.frame_ava_vip_laurel.x*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip_laurel.y*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava_vip_laurel.nameAtlas,this.positionMenuConfig.frame_ava_vip_laurel.nameSprite),this.laurel.anchor.set(.5),this.frameAvatar.addChild(this.laurel)}else this.frameAvatar=new Phaser.Sprite(game,this.positionMenuConfig.frame_ava.x*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava.y*window.GameConfig.RESIZE,this.positionMenuConfig.frame_ava.nameAtlas,this.positionMenuConfig.frame_ava.nameSprite),this.frameAvatar.anchor.set(.5),this.frameAvatar.scale.set(145/140*window.GameConfig.RESIZE)}},{key:"addAva",value:function(){this.addFrameAva()}},{key:"loadAva",value:function(){if(null!==TF.instance().dataMySeft){var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.image("ava_fb",this.avatar),e.onLoadComplete.add(this.onLoad,this),1==game.cache.checkImageKey("ava_fb")?this.onLoad():e.start()}}},{key:"onLoad",value:function(){var e=this;null==this.maskAva&&(this.maskAva=new Phaser.Graphics(game,0,0)),this.maskAva.clear(),this.maskAva.drawCircle(0,0,148*window.GameConfig.RESIZE),this.maskAva.anchor.set(.5),this.avaBox=new Phaser.Sprite(game,this.positionMenuConfig.ava_fb.x*window.GameConfig.RESIZE,this.positionMenuConfig.ava_fb.y*window.GameConfig.RESIZE,null),this.addChild(this.avaBox),null!==this.ava&&(this.removeChild(this.ava),this.ava.destroy(),this.ava=null),1==game.cache.checkImageKey("ava_fb")?this.ava=new Phaser.Button(game,0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,"ava_fb"):this.ava=new Phaser.Button(game,0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,"songDetailSprites",function(){},this,null,"ava-default"),this.ava.anchor.set(.5),this.ava.width=148,this.ava.height=148,this.ava.mask=this.maskAva,this.avaBox.addChild(this.maskAva),this.avaBox.addChild(this.ava),this.addChild(this.frameAvatar),this.ava.events.onInputUp.add(function(){IE.instance().addUserProfile(e.user_id)}),1==z.instance().isScrollChange?this.scrollChange():this.scrollDefault()}},{key:"addNameAndLvl",value:function(e){e=Bn.formatName(e,25),this.nameFB=new Phaser.Text(game,320*window.GameConfig.RESIZE,238*window.GameConfig.RESIZE,e,{font:"GilroyBold",fill:"white",fontSize:26*window.GameConfig.RESIZE}),this.nameFB.anchor.set(.5),this.addChild(this.nameFB),this.u_level=new Phaser.Text(game,320*window.GameConfig.RESIZE,270*window.GameConfig.RESIZE,"LV ".concat(this.u_level," - ").concat(this.level_title),{font:"".concat(19*window.GameConfig.RESIZE,"px GilroyMedium"),fill:"orange",boundsAlignH:"center",boundsAlignV:"middle"}),this.u_level.anchor.set(.5),this.u_level.addColor("#ffffff",6),this.addChild(this.u_level)}},{key:"addHeartAndtxtHeart",value:function(e){var t=this;this.heartSprite=new Phaser.Sprite(game,this.positionMenuConfig.heart.x*window.GameConfig.RESIZE,this.positionMenuConfig.heart.y*window.GameConfig.RESIZE,this.positionMenuConfig.heart.nameAtlas,this.positionMenuConfig.heart.nameSprite),this.heartSprite.anchor.set(.5),this.addChild(this.heartSprite),this.txt_heart=new Phaser.Text(game,this.positionMenuConfig.txt_heart.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_heart.y*window.GameConfig.RESIZE,"".concat(e).concat(this.positionMenuConfig.txt_heart.text),this.positionMenuConfig.txt_heart.configs),this.txt_heart.anchor.set(0,.5),this.addChild(this.txt_heart),TF.instance().events.onUserVarsUpdate.add(function(){t.txt_heart.setText("".concat(TF.instance().socket.mySelf.getVariable("heart").value).concat(t.positionMenuConfig.txt_heart.text))},this)}},{key:"addDiamondAndTxtDiamond",value:function(e){this.diamondSprite=new Phaser.Button(game,this.positionMenuConfig.diamond.x*window.GameConfig.RESIZE,this.positionMenuConfig.diamond.y*window.GameConfig.RESIZE,this.positionMenuConfig.diamond.nameAtlas,function(){},this,null,this.positionMenuConfig.diamond.nameSprite),this.diamondSprite.anchor.set(.5),this.addChild(this.diamondSprite),this.txt_diamond=new Phaser.Text(game,this.positionMenuConfig.txt_diamond.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_diamond.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txt_diamond.configs),this.txt_diamond.anchor.set(0,.5),this.addChild(this.txt_diamond)}},{key:"addTicketAndTxtTicket",value:function(e){this.ticketSprite=new Phaser.Sprite(game,this.positionMenuConfig.ticket.x*window.GameConfig.RESIZE,this.positionMenuConfig.ticket.y*window.GameConfig.RESIZE,this.positionMenuConfig.ticket.nameAtlas,this.positionMenuConfig.ticket.nameSprite),this.ticketSprite.anchor.set(.5),this.addChild(this.ticketSprite),this.txt_ticket=new Phaser.Text(game,this.positionMenuConfig.txt_ticket.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_ticket.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txt_ticket.configs),this.txt_ticket.anchor.set(0,.5),this.addChild(this.txt_ticket)}},{key:"addDoc",value:function(){this.groupDoc=new Phaser.Group(game,0,0);var e=new rt(this.positionMenuConfig.line_doc1);this.groupDoc.add(e);var t=new rt(this.positionMenuConfig.line_doc2);this.groupDoc.add(t),this.addChild(this.groupDoc)}},{key:"claimHourReward",value:function(e){var t=this;this.hours_reward_setting=e;IE.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:this.hours_reward_setting.reward_type,reward:this.hours_reward_setting.reward,finishPoint:{x:315,y:303}}),this.timeClaimHourReward=game.time.events.add(2*Phaser.Timer.SECOND,function(){if("DIAMOND"==e.reward_type){var n=game.add.tween(t.txt_diamond).to({text:TF.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.txt_diamond.text=parseInt(t.txt_diamond.text)},t),n.onComplete.add(t.completeClaim,t)}else e.reward_type;z.instance().isRefreshMenu.checking=!1},this)}},{key:"completeClaim",value:function(){this.event.claimHourRewardDone.dispatch()}},{key:"scrollChange",value:function(){1==this.user_vip&&game.add.tween(this.laurel).to({alpha:0},150,"Linear",!0).start();if(null!==this.ava){var e=game.add.tween(this.ava).to({width:103.6*window.GameConfig.RESIZE,height:103.6*window.GameConfig.RESIZE},150,"Linear",!0),t=game.add.tween(this.frameAvatar.scale).to({x:.725*window.GameConfig.RESIZE,y:.725*window.GameConfig.RESIZE},150,"Linear",!0);e.start(),t.start();var n=game.add.tween(this.avaBox).to({y:this.positionMenuConfig.ava_fb.y-50},150,"Linear",!0),i=game.add.tween(this.frameAvatar).to({y:this.positionMenuConfig.frame_ava.y-50},150,"Linear",!0);n.start(),i.start(),game.add.tween(this.maskAva.scale).to({x:.7,y:.7},150,"Linear",!0).start()}this.nameFB.kill(),this.u_level.kill(),this.diamondSprite.kill(),this.txt_diamond.kill(),this.heartSprite.kill(),this.txt_heart.kill(),this.ticketSprite.kill(),this.txt_ticket.kill();for(var o=0;o<this.groupDoc.children.length;o++)this.groupDoc.children[o].kill()}},{key:"scrollDefault",value:function(){1==this.user_vip&&game.add.tween(this.laurel).to({alpha:1},150,"Linear",!0).start();if(null!==this.ava){var e=game.add.tween(this.ava).to({width:148*window.GameConfig.RESIZE,height:148*window.GameConfig.RESIZE},150,"Linear",!0),t=game.add.tween(this.frameAvatar.scale).to({x:145/140*window.GameConfig.RESIZE,y:145/140*window.GameConfig.RESIZE},150,"Linear",!0);e.start(),t.start();var n=game.add.tween(this.avaBox).to({y:this.positionMenuConfig.ava_fb.y},150,"Linear",!0),i=game.add.tween(this.frameAvatar).to({y:this.positionMenuConfig.frame_ava.y},150,"Linear",!0);n.start(),i.start(),game.add.tween(this.maskAva.scale).to({x:1,y:1},150,"Linear",!0).start()}void 0!==this.nameFB&&this.nameFB.revive(),this.u_level.revive(),void 0!==this.diamondSprite&&this.diamondSprite.revive(),this.txt_diamond.revive(),this.heartSprite.revive(),this.txt_heart.revive(),this.ticketSprite.revive(),this.txt_ticket.revive();for(var o=0;o<this.groupDoc.children.length;o++)this.groupDoc.children[o].revive()}},{key:"destroy",value:function(){for(this.removeEventExtension(),game.time.events.remove(this.timeClaimHourReward);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&VC(n.prototype,i),o&&VC(n,o),t}();function YC(e){return(YC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JC(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function XC(e,t){return!t||"object"!==YC(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $C(e){return($C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ek(e,t){return(ek=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tk=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=XC(this,$C(t).call(this,game,e,n,null))).inputEnabled=!0,o.anchor.set(.5),o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.type=i,o.event={clickTab:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ek(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.layoutBot=new Phaser.Group(game,0,0),this.layoutTop=new Phaser.Group(game,0,0),this.addChild(this.layoutBot),this.addChild(this.layoutTop),this.bgTab,this.txtTab,this.lineUnderTab,this.addBGTab(),this.addTxtTab(),this.addLineUnderTab()}},{key:"addBGTab",value:function(){this.bgTab=new Phaser.Button(game,this.positionMenuConfig.mail.tab_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.tab_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.mail.tab_active.nameAtlas,this.onClickTab,this,null,this.positionMenuConfig.mail.tab_active.nameSprite),this.bgTab.anchor.set(.5),this.layoutBot.addChild(this.bgTab)}},{key:"addTxtTab",value:function(){this.txtTab=new Phaser.Text(game,this.positionMenuConfig.mail.txt_tab.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.txt_tab.y*window.GameConfig.RESIZE,this.type,this.positionMenuConfig.mail.txt_tab.style),this.txtTab.anchor.set(.5),this.layoutBot.addChild(this.txtTab)}},{key:"addLineUnderTab",value:function(){this.lineUnderTab=new rt(this.positionMenuConfig.mail.line_gradient),this.lineUnderTab.anchor.set(.5),this.layoutBot.addChild(this.lineUnderTab)}},{key:"onClickTab",value:function(){ce.instance().playSound(ce.buttonclick),this.event.clickTab.dispatch()}},{key:"setActive",value:function(){this.txtTab.addColor("#ffffff",0),this.bgTab.loadTexture("mailSprites","Header_tab_Active"),this.lineUnderTab.revive()}},{key:"setDisActive",value:function(){this.txtTab.addColor("#93909d",0),this.bgTab.loadTexture("mailSprites","Header_tab_disActive"),this.lineUnderTab.kill()}},{key:"addCountUnread",value:function(e){null==this.noti&&(this.noti=new rt(this.positionMenuConfig.count_unread),this.noti.kill(),this.noti.anchor.set(.5),this.countUnread=new _t(this.positionMenuConfig.txt_count_unread,this.positionMenuConfig.txt_count_unread.text),this.countUnread.anchor.set(.5),this.noti.addChild(this.countUnread),this.layoutTop.addChild(this.noti)),e>0?(this.noti.revive(),this.countUnread.setText(e)):this.noti.kill()}}])&&JC(n.prototype,i),o&&JC(n,o),t}();function nk(e){return(nk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ik(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ok(e,t){return!t||"object"!==nk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ak(e){return(ak=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sk(e,t){return(sk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rk=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ok(this,ak(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),i.messenger=e,i.index=n,i.event={choosedMessenger:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.avatar,this.userName,this.message,this.sentTime,void 0!==this.messenger.updated&&(this.addAva(),this.addMaskAva(68),this.addUserName(),this.addMessage(),this.addSentTime(),this.beginLoad(),this.addBtn(),this.addLineUnder())}},{key:"addBtn",value:function(){this.btn=new Phaser.Button(game,0,0,"otherSprites",function(){},this,null,"tab-friend"),this.btn.alpha=0,this.btn.onInputUp.add(this.choosedMessenger,this),this.addChild(this.btn)}},{key:"addAva",value:function(){this.avatar=new Phaser.Sprite(game,this.positionMenuConfig.mail.ava.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava.y*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava.nameAtlas,this.positionMenuConfig.mail.ava.nameSprite),this.avatar.anchor.set(.5),this.addChild(this.avatar)}},{key:"addMaskAva",value:function(e){this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(),this.maskAva.drawCircle(this.positionMenuConfig.mail.ava.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava.y*window.GameConfig.RESIZE,e),this.maskAva.endFill(),this.maskAva.anchor.set(.5),this.avatar.mask=this.maskAva,this.addChild(this.maskAva)}},{key:"addUserName",value:function(){this.userName=new Phaser.Text(game,this.positionMenuConfig.mail.userName.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.userName.y*window.GameConfig.RESIZE,Bn.formatName(this.messenger.user_name,30),this.positionMenuConfig.mail.userName.configs),this.messenger.user_name==TF.instance().dataMySeft.user_name&&this.userName.setText(this.messenger.user_name),this.messenger.from==TF.instance().socket.mySelf.getVariable("user_id").value?this.userName.addColor("#93909d",0):1==this.messenger.is_read&&this.userName.addColor("#93909d",0),this.addChild(this.userName)}},{key:"addMessage",value:function(){this.message=new Phaser.Text(game,this.positionMenuConfig.mail.message.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.message.y*window.GameConfig.RESIZE,this.messenger.message,this.positionMenuConfig.mail.message.configs),this.addChild(this.message)}},{key:"addSentTime",value:function(){this.monthAndDate="",this.timeDate="";var e=this.messenger.updated.split(" "),t=e[0].split("-"),n=e[1].split(":");this.monthAndDate=t[1]+"/"+t[2],this.timeDate=n[0]+n[1],this.sentTime=new Phaser.Text(game,this.positionMenuConfig.mail.sentTime.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.sentTime.y*window.GameConfig.RESIZE,this.monthAndDate,this.positionMenuConfig.mail.sentTime.configs),this.addChild(this.sentTime)}},{key:"choosedMessenger",value:function(){ce.instance().playSound(ce.buttonclick),this.event.choosedMessenger.dispatch(this.messenger)}},{key:"addLineUnder",value:function(){var e=new rt(this.positionMenuConfig.mail.line_under);this.addChild(e)}},{key:"beginLoad",value:function(){if(this.avaUrl=this.messenger.avatar,game.cache.checkImageKey(this.avaUrl))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.avaUrl,this.avaUrl),e.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.avaUrl)&&""!==e.avaUrl&&e.avatar.loadTexture("".concat(e.avaUrl)),e.avatar.width=68,e.avatar.height=68}catch(e){}},30*this.index)}},{key:"loadStart",value:function(){}},{key:"height",get:function(){return 142*window.GameConfig.RESIZE}}])&&ik(n.prototype,i),o&&ik(n,o),t}();function lk(e){return(lk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ck(e,t){return!t||"object"!==lk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uk(e){return(uk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dk(e,t){return(dk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fk=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ck(this,uk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),n.list=e,n.event={countUnread:new Phaser.Signal},n.now=n.getTimeNow(),n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"getTimeNow",value:function(){var e=(new Date).toISOString().split("T");return e[1]=e[1].split("Z"),e[1]=e[1][0],e}},{key:"afterInit",value:function(){this.chatScreen=null,this.group=new Phaser.Group(game),this.addChild(this.group);var e=new Phaser.Rectangle(0,207*window.GameConfig.RESIZE,game.width,(game.height-342)*window.GameConfig.RESIZE);this.listView=new Vo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.ajaxGetListMail(),this.addEventExtension()}},{key:"addEventExtension",value:function(){De.instance().event.backChat.add(this.backChat,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backChat.remove(this.backChat,this)}},{key:"backChat",value:function(){this.ajaxGetListMail()}},{key:"ajaxGetListMail",value:function(){Date.now()-z.instance().checkLoadMessage<6e3?this.onListMessageCallback(z.instance().messageData):(gl.instance().listMessage(TF.instance().dataMySeft.user_id,gl.LIMIT_10,gl.OFF_SET_0),gl.instance().sendData(this.onListMessageCallback.bind(this)),z.instance().checkLoadMessage=Date.now())}},{key:"onListMessageCallback",value:function(e){z.instance().messageData=e,"ok"==e.code&&null!==this.listView&&void 0!==this.listView&&(this.listView.removeAll(),this.handleResponseListMess(e.data),this.addMessenger())}},{key:"addMessenger",value:function(){for(var e=0;e<this.list.length;e++){var t=this.list[e],n=new rk(t,e);n.event.choosedMessenger.add(this.choosedMessenger,this),this.listView.add(n)}}},{key:"choosedMessenger",value:function(e){this.addChatScreen(e)}},{key:"addChatScreen",value:function(e){var t={};t=e.from==TF.instance().socket.mySelf.getVariable("user_id").value?{id:e.to,user_name:e.user_name,avatar:e.avatar}:{id:e.from,user_name:e.user_name,avatar:e.avatar},IE.instance().addChatScreen(t)}},{key:"handleResponseListMess",value:function(e){var t=[],n=0;for(var i in e.messages)t.push(e.messages[i]),e.messages[i].from!==TF.instance().dataMySeft.user_id&&0==e.messages[i].is_read&&n++;this.list=t,this.countUnread(n)}},{key:"countUnread",value:function(e){this.event.countUnread.dispatch(e)}},{key:"destroy",value:function(){for(null!==this.listView&&(this.listView.removeAll(),this.listView.destroy(),this.listView=null),this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&hk(n.prototype,i),o&&hk(n,o),t}();function pk(e){return(pk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yk(e,t){return!t||"object"!==pk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function mk(e){return(mk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vk(e,t){return(vk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wk=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=yk(this,mk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),i.messenger=e,i.index=n,i.event={choosedMessenger:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.avatar,this.userName,this.message,this.sentTime,this.addAva(),this.addMaskAva(68),this.addUserName(),this.addMessage(),this.addSentTime(),this.addBtn()}},{key:"addBtn",value:function(){this.btn=new Phaser.Button(game,0,0,"otherSprites",function(){},this,null,"tab-friend"),this.btn.alpha=0,this.btn.onInputUp.add(this.choosedMessenger,this),this.addChild(this.btn)}},{key:"addAva",value:function(){this.avatar=new Phaser.Sprite(game,this.positionMenuConfig.mail.ava_system.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava_system.y*window.GameConfig.RESIZE,this.positionMenuConfig.mail.ava_system.nameAtlas,this.positionMenuConfig.mail.ava_system.nameSprite),this.avatar.anchor.set(.5),this.addChild(this.avatar)}},{key:"addMaskAva",value:function(e){this.maskAva=new Phaser.Graphics(game,0,0),this.maskAva.beginFill(),this.maskAva.drawCircle(0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,e),this.maskAva.endFill(),this.maskAva.anchor.set(.5),this.avatar.mask=this.maskAva,this.avatar.addChild(this.maskAva)}},{key:"addUserName",value:function(){this.userName=new Phaser.Text(game,this.positionMenuConfig.mail.userName.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.userName.y*window.GameConfig.RESIZE,"Hệ thống",this.positionMenuConfig.mail.userName.configs),this.addChild(this.userName),1==this.messenger.is_read&&this.userName.addColor("#93909d",0)}},{key:"addMessage",value:function(){this.message=new Phaser.Text(game,this.positionMenuConfig.mail.message.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.message.y*window.GameConfig.RESIZE,this.messenger.system_message_content.title,this.positionMenuConfig.mail.message.configs),this.addChild(this.message)}},{key:"addSentTime",value:function(){this.sentTime=new Phaser.Text(game,this.positionMenuConfig.mail.sentTime.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.sentTime.y*window.GameConfig.RESIZE,this.messenger.time,this.positionMenuConfig.mail.sentTime.configs),this.addChild(this.sentTime)}},{key:"choosedMessenger",value:function(){ce.instance().playSound(ce.buttonclick),this.event.choosedMessenger.dispatch(this.messenger)}},{key:"beginLoad",value:function(e){if(this.avaUrl=e,game.cache.checkImageKey(this.avaUrl))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadStart.add(this.loadStart,this),t.onLoadComplete.add(this.onLoad,this),t.image(this.avaUrl,this.avaUrl),t.start()}}},{key:"onLoad",value:function(){var e=this;game.cache.checkImageKey(this.avaUrl)&&setTimeout(function(){try{e.avatar.loadTexture("".concat(e.avaUrl))}catch(e){}},70*this.index)}},{key:"loadStart",value:function(){}},{key:"height",get:function(){return 142*window.GameConfig.RESIZE}}])&&gk(n.prototype,i),o&&gk(n,o),t}();function bk(e){return(bk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _k(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Sk(e,t){return!t||"object"!==bk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ek(e){return(Ek=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ck(e,t){return(Ck=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var kk=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Sk(this,Ek(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.positionLoadConfig=JSON.parse(game.cache.getText("positionLoadConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ck(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.isSeeMail=!1,this.group=new Phaser.Group(game),this.addChild(this.group);var e=new Phaser.Rectangle(0,207*window.GameConfig.RESIZE,game.width,(game.height-342)*window.GameConfig.RESIZE);this.listView=new Vo(game,this.group,e,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.ajaxGetListMail(),this.addEventExtension()}},{key:"addEventExtension",value:function(){De.instance().event.backChat.add(this.backChat,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backChat.remove(this.backChat,this)}},{key:"backChat",value:function(){this.ajaxGetListMail()}},{key:"ajaxGetListMail",value:function(){Date.now()-z.instance().checkLoadMail<6e3?this.onListSystemCallback(z.instance().mailData):(gl.instance().getNotiSystem(TF.instance().dataMySeft.user_id,gl.LIMIT_10,gl.OFF_SET_0),gl.instance().sendData(this.onListSystemCallback.bind(this)),z.instance().checkLoadMail=Date.now())}},{key:"onListSystemCallback",value:function(e){z.instance().mailData=e,"ok"==e.code&&null!==this.listView&&void 0!==this.listView&&(this.listView.removeAll(),this.handleResponseListSystem(e.data),this.addListSystem())}},{key:"addListSystem",value:function(){for(var e=0;e<this.list.length;e++){var t=this.list[e],n=new wk(t,e);n.event.choosedMessenger.add(this.choosedMessenger,this),this.listView.add(n)}}},{key:"choosedMessenger",value:function(e){IE.instance().addMailSystemScreen(e),this.isSeeMail=!0}},{key:"handleResponseListSystem",value:function(e){var t=[];if(Array.isArray(e))for(var n=0;n<e.length;n++)t.push(e[n]);else for(var i in e)t.push(e[i]);this.list=t}},{key:"destroy",value:function(){for(null!==this.listView&&(this.listView.removeAll(),this.listView.destroy(),this.listView=null),this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&_k(n.prototype,i),o&&_k(n,o),t}();function Pk(e){return(Pk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ok(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Rk(e,t){return!t||"object"!==Pk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xk(e){return(xk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Tk(e,t){return(Tk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ik=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=Rk(this,xk(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.getData(),e.setData(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"getData",value:function(){this.listMailResponse=[]}},{key:"setData",value:function(){this.afterInit()}},{key:"afterInit",value:function(){this.bg,this.searchTab,this.newsTab,this.systemTab,this.friendsTab,this.listViewNewsTab=null,this.listViewSystemTab=null,this.listViewFriendsTab=null,this.typeOfTab=null,this.addBG(),this.addSearchTab(),this.addNewsTab(),this.addSystemTab(),this.showTab(1),this.ajaxGetSystemMail(),Le.instance().logEvent(Le.Mail),this.addEventExtension()}},{key:"ajaxGetSystemMail",value:function(){gl.instance().getNotiSystem(TF.instance().dataMySeft.user_id,gl.LIMIT_10,gl.OFF_SET_0),gl.instance().sendData(this.onListNotiCallback.bind(this))}},{key:"onListNotiCallback",value:function(e){if("ok"==e.code){var t=0;if(Array.isArray(e.data))for(var n=0;n<e.data.length;n++)0==e.data[n].is_read&&t++;else for(var i in e.data)0==e.data[i].is_read&&t++;t>0?this.countUnreadSystem(t):this.systemTab.addCountUnread(0)}}},{key:"countUnreadSystem",value:function(e){this.systemTab.addCountUnread(e)}},{key:"addBG",value:function(){this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.addChild(this.bg)}},{key:"addSearchTab",value:function(){this.searchTab=new Phaser.Sprite(game,0,0,null),this.searchTab.inputEnabled=!0;var e=new rt(this.positionMenuConfig.mail.search_bg),t=new _t(this.positionMenuConfig.mail.txt_search,this.positionMenuConfig.mail.txt_search.text);t.anchor.set(.5,0),e.addChild(t),this.searchTab.addChild(e),this.searchTab.events.onInputUp.add(this.onSearchTabInput,this),this.addChild(this.searchTab)}},{key:"onSearchTabInput",value:function(){ce.instance().playSound(ce.buttonclick),console.log("ndsjgbg"),this.searchTab.inputEnabled=!1}},{key:"addNewsTab",value:function(){this.newsTab=new tk(160*window.GameConfig.RESIZE,153*window.GameConfig.RESIZE,"Tin nhắn"),this.newsTab.event.clickTab.add(this.onNewsTabInput,this),this.addChild(this.newsTab)}},{key:"onNewsTabInput",value:function(){1==this.typeOfTab||(this.typeOfTab=1,this.showTab(1))}},{key:"addSystemTab",value:function(){this.systemTab=new tk(480*window.GameConfig.RESIZE,153*window.GameConfig.RESIZE,"Hệ thống"),this.systemTab.event.clickTab.add(this.onSystemTabInput,this),this.addChild(this.systemTab)}},{key:"onSystemTabInput",value:function(){2==this.typeOfTab||(this.typeOfTab=2,this.showTab(2))}},{key:"showTab",value:function(e){1==e?(this.newsTab.setActive(),this.systemTab.setDisActive(),this.addMailTabNews(),this.removeMailTabSystem()):2==e&&(this.newsTab.setDisActive(),this.systemTab.setActive(),this.removeMailTabNews(),this.addMailTabSystem())}},{key:"addMailTabNews",value:function(){this.removeMailTabNews(),this.listViewNewsTab=new fk(this.listMailResponse),this.listViewNewsTab.event.countUnread.add(this.countUnread,this),this.addChild(this.listViewNewsTab)}},{key:"removeMailTabNews",value:function(){null!==this.listViewNewsTab&&(this.removeChild(this.listViewNewsTab),this.listViewNewsTab.destroy(),this.listViewNewsTab=null)}},{key:"countUnread",value:function(e){this.newsTab.addCountUnread(e)}},{key:"addMailTabSystem",value:function(){this.removeMailTabSystem(),this.listViewSystemTab=new kk,this.addChild(this.listViewSystemTab)}},{key:"removeMailTabSystem",value:function(){null!==this.listViewSystemTab&&(this.removeChild(this.listViewSystemTab),this.listViewSystemTab.destroy(),this.listViewSystemTab=null)}},{key:"addMailTabFriends",value:function(){this.removeMailTabFriends()}},{key:"removeMailTabFriends",value:function(){null!==this.listViewFriendsTab&&(this.removeChild(this.listViewFriendsTab),this.listViewFriendsTab.destroy(),this.listViewFriendsTab=null)}},{key:"addEventExtension",value:function(){De.instance().event.backSystemChat.add(this.backSystemChat,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backSystemChat.remove(this.backSystemChat,this)}},{key:"backSystemChat",value:function(){this.ajaxGetSystemMail()}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&Ok(n.prototype,i),o&&Ok(n,o),t}();function Ak(e){return(Ak="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Gk(e,t){return!t||"object"!==Ak(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dk(e){return(Dk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mk(e,t){return(Mk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nk=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=Gk(this,Dk(t).call(this,game,e,n,null))).type=2,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mk(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){}},{key:"createMail",value:function(){this.mailScreen=new Ik,this.addChild(this.mailScreen)}},{key:"show",value:function(){game.add.tween(this).to({x:0},150,"Linear",!0)}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300},150,"Linear",!0);i.start(),i.onComplete.add(function(){t.destroy()},this)}}}])&&Lk(n.prototype,i),o&&Lk(n,o),t}();function Bk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jk=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"friend_requests",get:function(){return"friend_requests"}},{key:"user_2",get:function(){return"user_2"}},{key:"user_1",get:function(){return"user_1"}},{key:"created",get:function(){return"created"}},{key:"friend",get:function(){return"friend"}},{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"state",get:function(){return"state"}},{key:"is_aware",get:function(){return"is_aware"}},{key:"updated",get:function(){return"updated"}},{key:"is_onlines",get:function(){return"is_onlines"}}],(n=null)&&Bk(t.prototype,n),i&&Bk(t,i),e}();var Uk=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_1=0,this.user_2=0,this.created=0,this.friend={user_id:0,user_name:"",avatar:"",is_online:!1},this.state="",this.is_aware=0,this.updated=0};function Fk(e){return(Fk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Hk(e,t){return!t||"object"!==Fk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Qk(e,t,n){return(Qk="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Vk(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Vk(e){return(Vk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wk(e,t){return(Wk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qk=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Hk(this,Vk(t).call(this,game))).positionFriendRequestConfig=JSON.parse(game.cache.getText("positionFriendRequestConfig")),i.request=e,i.index=n,i.event={accept:new Phaser.Signal,decline:new Phaser.Signal,clickAva:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.ava,this.name,this.btnAccept,this.btnDecline,this.dotOnline,this.line,this.addAva(),this.addName(),this.addLineUnder(),this.addBtnAccept(),this.addBtnDecline(),this.addDotOnline(),this.loadAva()}},{key:"addAva",value:function(){var e=new Phaser.Graphics(game,0,0);e.drawCircle(this.positionFriendRequestConfig.request.ava.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.y*window.GameConfig.RESIZE,68*window.GameConfig.RESIZE),e.anchor.set(.5),this.addChild(e),this.ava=new Phaser.Sprite(game,this.positionFriendRequestConfig.request.ava.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.y*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.nameAtlas,this.positionFriendRequestConfig.request.ava.nameSprite),this.ava.anchor.set(.5),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.inputAva,this),this.ava.mask=e,this.addChild(this.ava)}},{key:"inputAva",value:function(){console.log(this.request.friend.user_id),this.event.clickAva.dispatch(this.request.friend.user_id)}},{key:"loadAva",value:function(){if(game.cache.checkImageKey(this.request.friend.avatar))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.request.friend.avatar,this.request.friend.avatar),e.start()}}},{key:"onLoad",value:function(){var e=this;this.timeOnload=game.time.events.add(.1*Phaser.Timer.SECOND*this.index,function(){try{""!==e.request.friend.avatar&&e.ava.loadTexture("".concat(e.request.friend.avatar)),e.ava.width=70,e.ava.height=70}catch(e){}},this)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"addName",value:function(){this.name=new _t(this.positionFriendRequestConfig.request.name,this.request.friend.user_name),this.name.anchor.set(0,.5),this.addChild(this.name)}},{key:"addLineUnder",value:function(){this.line=new rt(this.positionFriendRequestConfig.request.line),this.addChild(this.line)}},{key:"addBtnAccept",value:function(){this.btnAccept=new pt(this.positionFriendRequestConfig.request.btn_accept,this.onClickAccept,this),this.btnAccept.anchor.set(.5);var e=new _t(this.positionFriendRequestConfig.request.txt_accept,this.positionFriendRequestConfig.request.txt_accept.text);e.anchor.set(.5),this.btnAccept.addChild(e),this.addChild(this.btnAccept)}},{key:"onClickAccept",value:function(){this.btnAccept.inputEnabled=!1,this.event.accept.dispatch(this.request)}},{key:"addBtnDecline",value:function(){this.btnDecline=new pt(this.positionFriendRequestConfig.request.btn_decline,this.onClickDecline,this),this.btnDecline.anchor.set(.5);var e=new _t(this.positionFriendRequestConfig.request.txt_decline,this.positionFriendRequestConfig.request.txt_decline.text);e.anchor.set(.5),this.btnDecline.addChild(e),this.addChild(this.btnDecline)}},{key:"onClickDecline",value:function(){this.event.decline.dispatch(this.request)}},{key:"addDotOnline",value:function(){1==this.request.friend.is_online?(this.dotOnline=new rt(this.positionFriendRequestConfig.request.online_icon),this.addChild(this.dotOnline)):(this.dotOnline=new rt(this.positionFriendRequestConfig.request.offline_icon),this.addChild(this.dotOnline))}},{key:"destroy",value:function(){game.time.events.remove(this.timeOnload),Qk(Vk(t.prototype),"destroy",this).call(this)}},{key:"height",get:function(){return 114*window.GameConfig.RESIZE}}])&&Zk(n.prototype,i),o&&Zk(n,o),t}();function Kk(e){return(Kk="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function zk(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yk(e,t){return!t||"object"!==Kk(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jk(e){return(Jk=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xk(e,t){return(Xk=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var $k=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Yk(this,Jk(t).call(this,game))).friendRequestList=e,n.event={accept:new Phaser.Signal,decline:new Phaser.Signal,getUserProfile:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xk(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.listView;var e=new Phaser.Group(game);e.x=0,e.y=205*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-321)*window.GameConfig.RESIZE);this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var n=0;n<this.friendRequestList.length;n++){var i=new qk(this.friendRequestList[n],n);i.event.accept.add(this.acceptRequestFriend,this),i.event.decline.add(this.declineRequestFriend,this),i.event.clickAva.add(this.requestClickAva,this),this.listView.add(i)}}},{key:"acceptRequestFriend",value:function(e){this.event.accept.dispatch(e)}},{key:"declineRequestFriend",value:function(e){this.event.decline.dispatch(e)}},{key:"requestClickAva",value:function(e){this.event.getUserProfile.dispatch(e)}},{key:"destroy",value:function(){for(this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&zk(n.prototype,i),o&&zk(n,o),t}();function eP(e){return(eP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nP(e,t){return!t||"object"!==eP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function iP(e){return(iP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oP(e,t){return(oP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var aP=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=nP(this,iP(t).call(this,game,e,n,null))).inputEnabled=!0,o.anchor.set(.5),o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.positionFriendRequestConfig=JSON.parse(game.cache.getText("positionFriendRequestConfig")),o.type=i,o.event={clickTab:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oP(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.layoutBot=new Phaser.Sprite(game,0,0,null),this.layoutTop=new Phaser.Sprite(game,0,0,null),this.addChild(this.layoutBot),this.addChild(this.layoutTop),this.bgTab,this.txtTab,this.lineUnderTab,this.addBGTab(),this.addTxtTab(),this.addLineUnderTab(),this.addLineDoc()}},{key:"addBGTab",value:function(){this.bgTab=new Phaser.Button(game,this.positionFriendRequestConfig.tab_active.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.tab_active.y*window.GameConfig.RESIZE,this.positionFriendRequestConfig.tab_active.nameAtlas,this.onClickTab,this,null,this.positionFriendRequestConfig.tab_active.nameSprite),this.bgTab.anchor.set(.5),this.layoutBot.addChild(this.bgTab)}},{key:"addTxtTab",value:function(){this.txtTab=new Phaser.Text(game,this.positionMenuConfig.mail.txt_tab.x*window.GameConfig.RESIZE,this.positionMenuConfig.mail.txt_tab.y*window.GameConfig.RESIZE,this.type,this.positionMenuConfig.mail.txt_tab.style),this.txtTab.anchor.set(.5),this.layoutBot.addChild(this.txtTab)}},{key:"addLineUnderTab",value:function(){this.lineUnderTab=new rt(this.positionMenuConfig.mail.line_gradient),this.lineUnderTab.anchor.set(.5),this.layoutBot.addChild(this.lineUnderTab)}},{key:"onClickTab",value:function(){ce.instance().playSound(ce.buttonclick),this.event.clickTab.dispatch()}},{key:"setActive",value:function(){this.txtTab.addColor("#ffffff",0),this.lineUnderTab.revive()}},{key:"setDisActive",value:function(){this.txtTab.addColor("#93909d",0),this.lineUnderTab.kill()}},{key:"addLineDoc",value:function(){var e=new Phaser.Sprite(game,this.positionFriendRequestConfig.line_doc.x,this.positionFriendRequestConfig.line_doc.y,this.positionFriendRequestConfig.line_doc.nameAtlas,this.positionFriendRequestConfig.line_doc.nameSprite);e.anchor.set(.5),e.scale.set(3,1),this.layoutTop.addChild(e)}},{key:"addCountUnread",value:function(e){null==this.noti&&(this.noti=new rt(this.positionMenuConfig.count_unread),this.noti.kill(),this.noti.anchor.set(.5),this.countUnread=new _t(this.positionMenuConfig.txt_count_unread,this.positionMenuConfig.txt_count_unread.text),this.countUnread.anchor.set(.5),this.noti.addChild(this.countUnread),this.layoutTop.addChild(this.noti)),e>0?(this.noti.revive(),this.countUnread.setText(e)):this.noti.kill()}},{key:"addCountFriend",value:function(e){this.txtTab.setText("".concat(this.type," (").concat(e,")"))}}])&&tP(n.prototype,i),o&&tP(n,o),t}();function sP(e){return(sP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lP(e,t){return!t||"object"!==sP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hP(e,t,n){return(hP="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cP(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function cP(e){return(cP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uP(e,t){return(uP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dP=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=lP(this,cP(t).call(this,game))).positionFriendRequestConfig=JSON.parse(game.cache.getText("positionFriendRequestConfig")),i.friend=e,i.index=n,i.event={chat:new Phaser.Signal,clickAva:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.ava,this.name,this.btnAccept,this.btnDecline,this.dotOnline,this.line,this.addAva(),this.addName(),this.addLineUnder(),this.addChat(),this.addDotOnline(),this.loadAva()}},{key:"addAva",value:function(){var e=new Phaser.Graphics(game,0,0);e.drawCircle(this.positionFriendRequestConfig.request.ava.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.y*window.GameConfig.RESIZE,68*window.GameConfig.RESIZE),e.anchor.set(.5),this.addChild(e),this.ava=new Phaser.Sprite(game,this.positionFriendRequestConfig.request.ava.x*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.y*window.GameConfig.RESIZE,this.positionFriendRequestConfig.request.ava.nameAtlas,this.positionFriendRequestConfig.request.ava.nameSprite),this.ava.anchor.set(.5),this.ava.scale.set(window.GameConfig.SCALE_AVA_FRIEND*window.GameConfig.RESIZE),this.ava.inputEnabled=!0,this.ava.events.onInputUp.add(this.inputAva,this),this.ava.mask=e,this.addChild(this.ava)}},{key:"inputAva",value:function(){this.event.clickAva.dispatch(this.friend.user_id)}},{key:"loadAva",value:function(){if(game.cache.checkImageKey(this.friend.avatar))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.friend.avatar,this.friend.avatar),e.start()}}},{key:"onLoad",value:function(){var e=this;this.timeOnload=game.time.events.add(.1*Phaser.Timer.SECOND*this.index,function(){try{""!==e.friend.avatar&&e.ava.loadTexture("".concat(e.friend.avatar)),e.ava.width=70,e.ava.height=70}catch(e){}},this)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"addName",value:function(){this.name=new _t(this.positionFriendRequestConfig.request.name,this.friend.user_name),this.name.anchor.set(0,.5),this.addChild(this.name)}},{key:"addLineUnder",value:function(){this.line=new rt(this.positionFriendRequestConfig.request.line),this.addChild(this.line)}},{key:"addDotOnline",value:function(){1==this.friend.is_online?(this.dotOnline=new rt(this.positionFriendRequestConfig.request.online_icon),this.addChild(this.dotOnline)):(this.dotOnline=new rt(this.positionFriendRequestConfig.request.offline_icon),this.addChild(this.dotOnline))}},{key:"addChat",value:function(){this.btnChat=new pt(this.positionFriendRequestConfig.request.icon_chat,this.onClickChat,this),this.btnChat.anchor.set(.5),this.addChild(this.btnChat)}},{key:"onClickChat",value:function(){this.event.chat.dispatch({avatar:this.friend.avatar,is_online:this.friend.is_online,status:this.friend.status,id:this.friend.user_id,user_name:this.friend.user_name})}},{key:"destroy",value:function(){game.time.events.remove(this.timeOnload),hP(cP(t.prototype),"destroy",this).call(this)}},{key:"height",get:function(){return 114*window.GameConfig.RESIZE}}])&&rP(n.prototype,i),o&&rP(n,o),t}();function fP(e){return(fP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gP(e,t){return!t||"object"!==fP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yP(e){return(yP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mP(e,t){return(mP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vP=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=gP(this,yP(t).call(this,game))).friendlist=e,n.event={getUserProfile:new Phaser.Signal},n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.listView,this.ktBuild=!1,this.idx=0,this.countItem=0;var e=new Phaser.Group(game);e.x=0,e.y=205*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-321)*window.GameConfig.RESIZE);this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.listView.events.changeIndex.add(this.changeIndex,this),this.buildItemPage()}},{key:"changeIndex",value:function(){var e=this.listView.getIdx();this.buildChangeIndex(e)}},{key:"buildChangeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){var e=this.friendlist;this.ktBuild=!0;for(var t=this.idx;t<e.length;t++){var n=new dP(this.friendlist[t],t);if(n.event.clickAva.add(this.requestClickAva,this),n.event.chat.add(this.requestChat,this),this.listView.add(n),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<e.length){this.ktBuild=!1;break}this.idx===e.length&&(this.ktBuild=!1)}}},{key:"requestChat",value:function(e){console.log("FRIEND"),console.log(e),IE.instance().addChatScreen(e)}},{key:"requestClickAva",value:function(e){this.event.getUserProfile.dispatch(e)}},{key:"destroy",value:function(){for(this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&pP(n.prototype,i),o&&pP(n,o),t}();function wP(e){return(wP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _P(e,t){return!t||"object"!==wP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SP(e){return(SP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EP(e,t){return(EP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CP=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=_P(this,SP(t).call(this,game))).positionFriendRequestConfig=JSON.parse(game.cache.getText("positionFriendRequestConfig")),e.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={back:new Phaser.Signal},e.friendRequestList=[],e.friendLists=[],e.isFriendTab=!0,e.afterInit(),e.addEventExtension(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.bg=new Phaser.Button(game,0,0,"bg-playlist"),this.addChild(this.bg),this.layoutBot=new Phaser.Group(game),this.layoutTop=new Phaser.Group(game),this.addChild(this.layoutBot),this.addChild(this.layoutTop),this.header,this.frameScreen,this.scrollListRequest=null,this.scrollListFriend=null,this.dotCountFriend=null,this.addHeader(),this.addFrameScreen(),Le.instance().logEvent(Le.Friend_add)}},{key:"afterTweenDone",value:function(){this.sendFriendRequestLoadRequest(),this.sendFriendListLoadRequest()}},{key:"addHeader",value:function(){this.header=new rt(this.positionFriendRequestConfig.header.tab),this.txtHeader=new _t(this.positionFriendRequestConfig.header.txt_header,this.positionFriendRequestConfig.header.txt_header.text),this.txtHeader.anchor.set(.5,0),this.header.addChild(this.txtHeader),this.addChild(this.header)}},{key:"addFrameScreen",value:function(){this.txtRequestAddFriend,this.lineUnderTxtRequestAddFriend,this.dotCountFriend,this.lineGradientUnderTxtRequestAddFriend,this.addFriendTab(),this.addRequestTab()}},{key:"addTxtRequestAddFriend",value:function(){this.txtRequestAddFriend=new _t(this.positionFriendRequestConfig.txt_request_add_friend,this.positionFriendRequestConfig.txt_request_add_friend.text),this.addChild(this.txtRequestAddFriend)}},{key:"addFriendTab",value:function(){this.friendTab=new aP(160*window.GameConfig.RESIZE,153*window.GameConfig.RESIZE,"Danh sách bạn"),this.friendTab.event.clickTab.add(this.onClickTabFriend,this),this.layoutTop.addChild(this.friendTab)}},{key:"addRequestTab",value:function(){this.requestTab=new aP(480*window.GameConfig.RESIZE,153*window.GameConfig.RESIZE,"Lời mời kết bạn"),this.requestTab.event.clickTab.add(this.onClickTabRequest,this),this.requestTab.setDisActive(),this.layoutTop.addChild(this.requestTab)}},{key:"onClickTabFriend",value:function(){this.isFriendTab=!0,this.friendTab.setActive(),this.requestTab.setDisActive(),this.removeScollListRequest(),this.sendFriendListLoadRequest()}},{key:"onClickTabRequest",value:function(){this.isFriendTab=!1,this.friendTab.setDisActive(),this.requestTab.setActive(),this.removeScrollFriendList(),this.sendFriendRequestLoadRequest()}},{key:"addLineUnderTxtRequestAddFriend",value:function(){this.lineUnderTxtRequestAddFriend=new rt(this.positionFriendRequestConfig.line_under_txt_request_add_friend),this.addChild(this.lineUnderTxtRequestAddFriend)}},{key:"addDotCountFriend",value:function(){this.removeDotCount(),this.dotCountFriend=new rt(this.positionFriendRequestConfig.dot_count_friend),this.dotCountFriend.anchor.set(.5),this.addChild(this.dotCountFriend)}},{key:"removeDotCount",value:function(){null!==this.dotCountFriend&&(this.removeChild(this.dotCountFriend),this.dotCountFriend.destroy(),this.dotCountFriend=null)}},{key:"addNumberInDotCount",value:function(e){if(e>0){this.addDotCountFriend();var t=new Phaser.Text(game,0,2,e,this.positionMenuConfig.txtNotiDot.configs);t.anchor.set(.5),this.dotCountFriend.addChild(t)}}},{key:"addLineGradientUnderTxtRequestAddFriend",value:function(){this.lineGradientUnderTxtRequestAddFriend=new rt(this.positionFriendRequestConfig.line_gradient_under_txt_request_add_friend),this.lineGradientUnderTxtRequestAddFriend.anchor.set(0,.5),this.addChild(this.lineGradientUnderTxtRequestAddFriend)}},{key:"addScrollListRequest",value:function(){this.friendRequestList.length>0&&(this.removeScollListRequest(),this.scrollListRequest=new $k(this.friendRequestList),this.scrollListRequest.event.accept.add(this.acceptRequestFriend,this),this.scrollListRequest.event.decline.add(this.declineRequestFriend,this),this.scrollListRequest.event.getUserProfile.add(this.getUserProfile,this),this.layoutBot.addChild(this.scrollListRequest),1==this.isFriendTab?this.scrollListRequest.visible=!1:this.scrollListRequest.visible=!0)}},{key:"removeScollListRequest",value:function(){null!==this.scrollListRequest&&(this.removeChild(this.scrollListRequest),this.scrollListRequest.destroy(),this.scrollListRequest=null)}},{key:"addScrollFriendList",value:function(){this.friendLists.length>0&&(this.removeScrollFriendList(),this.scrollListFriend=new vP(this.friendLists),this.scrollListFriend.event.getUserProfile.add(this.getUserProfile,this),this.layoutBot.addChild(this.scrollListFriend),1==this.isFriendTab?this.scrollListFriend.visible=!0:this.scrollListFriend.visible=!1)}},{key:"removeScrollFriendList",value:function(){null!==this.scrollListFriend&&(this.removeChild(this.scrollListFriend),this.scrollListFriend.destroy(),this.scrollListFriend=null)}},{key:"acceptRequestFriend",value:function(e){this.sendUserFriendRequest(Rs.begin(Rs.ACTION_ACCEPT_ADD_REQUEST,e.friend.user_id))}},{key:"declineRequestFriend",value:function(e){this.sendUserFriendRequest(Rs.begin(Rs.ACTION_REFUSE_ADD_REQUEST,e.friend.user_id))}},{key:"getUserProfile",value:function(e){IE.instance().addUserProfile(e)}},{key:"sendUserFriendRequest",value:function(e){TF.instance().sendData(Et.USER_FRIEND_REQUEST,e)}},{key:"onBack",value:function(){this.destroy(),this.event.back.dispatch()}},{key:"sendFriendRequestLoadRequest",value:function(){TF.instance().sendData(Et.FRIEND_REQUEST_LOAD_REQUEST,null),qe.instance().showLoading()}},{key:"sendFriendListLoadRequest",value:function(){TF.instance().sendData(Et.ONLINE_MODE_ROOM_FRIEND_LIST_REQUEST,null),qe.instance().showLoading()}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){var t=this;qe.instance().hideLoading(),e.cmd==Et.FRIEND_REQUEST_LOAD_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.handleFriendRequestLoadResponse(e.params,function(){t.addScrollListRequest(),t.addNumberInDotCount(t.friendRequestList.length)}),e.cmd==Et.USER_FRIEND_RESPONSE&&"OK"==e.params.getUtfString("status")&&(this.removeScollListRequest(),this.dotCountFriend.destroy(),this.sendFriendRequestLoadRequest()),e.cmd==Et.ONLINE_MODE_ROOM_FRIEND_LIST_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.handleParamsFriendsResponse(e.params,function(){t.friendTab.addCountFriend(t.friendLists.length),t.addScrollFriendList()})}},{key:"handleParamsFriendsResponse",value:function(e,t){this.friendLists=[];for(var n=e.getSFSArray("friends"),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=o.getUtfString("user_name"),s=o.getUtfString("avatar"),r=o.getInt("id"),l=o.getUtfString("status"),h=o.getBool("is_online");this.friendLists.push({user_name:a,avatar:s,user_id:r,is_online:h,status:l})}t()}},{key:"handleFriendRequestLoadResponse",value:function(e,t){for(var n=[],i=e.getSFSArray(jk.friend_requests),o=0;o<i.size();o++){var a=new Uk,s=i.getSFSObject(o);a.user_1=s.getInt(jk.user_1),a.user_2=s.getInt(jk.user_2),a.created=s.getLong(jk.created);var r=s.getSFSObject(jk.friend);a.friend.user_id=r.getInt(jk.user_id),a.friend.user_name=r.getUtfString(jk.user_name),a.friend.avatar=r.getUtfString(jk.avatar),a.friend.is_online=r.getBool(jk.is_onlines),a.state=s.getUtfString(jk.state),a.is_aware=s.getInt(jk.is_aware),a.updated=s.getLong(jk.updated),n.push(a)}this.friendRequestList=n,t()}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&bP(n.prototype,i),o&&bP(n,o),t}();function kP(e){return(kP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OP(e,t){return!t||"object"!==kP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RP(e){return(RP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xP(e,t){return(xP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var TP=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=OP(this,RP(t).call(this,game,e,n,null))).type=4,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xP(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addFriendScreen=null}},{key:"createAddFriendScreen",value:function(){this.addFriendScreen=new CP,this.addChild(this.addFriendScreen)}},{key:"show",value:function(){var e=this,t=game.add.tween(this).to({x:0},150,"Linear",!0);t.start(),t.onComplete.add(function(){e.addFriendScreen.afterTweenDone()})}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300*window.GameConfig.RESIZE},150,"Linear",!0);i.start(),i.onComplete.add(function(){t.destroy()},this)}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&PP(n.prototype,i),o&&PP(n,o),t}();function IP(e){return(IP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function LP(e,t){return!t||"object"!==IP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function GP(e){return(GP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DP(e,t){return(DP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var MP=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=LP(this,GP(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={backMenu:new Phaser.Signal,changeOtherScreen:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DP(e,t)}(t,Phaser.Group),n=t,(i=[{key:"createButton",value:function(){}},{key:"createButtonOnNavigation",value:function(){this.addEventExtension(),this.shopScreen,this.mailScreen,this.addFriendScreen,this.typeNew,this.typeOld=1,this.layoutContent=new Phaser.Group(game),this.layoutTop=new Phaser.Group(game),this.addChild(this.layoutContent),this.addChild(this.layoutTop),this.navBG=this.addNavBG(),this.addChild(this.navBG),this.addFourBtnOnNavbar(),this.buildBtnArray(),this.addChildBtnToNavBG(),Bn.switchButton(this.btnArray,this.activeBtnArray,this.homeBtn,this.activehomeBtn),this.ajaxCountMessage()}},{key:"addFourBtnOnNavbar",value:function(){this.homeBtn=this.addHomeBtn(),this.activehomeBtn=this.addActiveHomeBtn(),this.mailBtn=this.addMailBtn(),this.activeMailBtn=this.addActiveMailBtn(),this.addFriendBtn=this.addAddFriendBtn(),this.activeAddFriendBtn=this.addActiveAddFriendBtn()}},{key:"addChildBtnToNavBG",value:function(){this.navBG.addChild(this.homeBtn),this.navBG.addChild(this.activehomeBtn),this.navBG.addChild(this.activeMailBtn),this.navBG.addChild(this.mailBtn),this.navBG.addChild(this.activeAddFriendBtn),this.navBG.addChild(this.addFriendBtn)}},{key:"buildBtnArray",value:function(){this.activeBtnArray=[this.activehomeBtn,this.activeMailBtn,this.activeAddFriendBtn],this.btnArray=[this.homeBtn,this.mailBtn,this.addFriendBtn]}},{key:"addNavBG",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.menu_bg.x*window.GameConfig.RESIZE,game.height-61*window.GameConfig.RESIZE,this.positionMenuConfig.menu_bg.nameAtlas,function(){},this,null,this.positionMenuConfig.menu_bg.nameSprite);return e.anchor.set(.5),e}},{key:"addHomeBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_home.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_home.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_home.nameAtlas,this.onClickHomeBtn,this,null,this.positionMenuConfig.btn_home.nameSprite);return e.anchor.set(.5),e.type=1,e}},{key:"onClickHomeBtn",value:function(){ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.homeBtn,this.activehomeBtn),this.typeNew=1,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=1}},{key:"addActiveHomeBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_home_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_home_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_home_active.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_home_active.nameSprite);return e.anchor.set(.5),e}},{key:"addAddFriendBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_setting.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_setting.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_setting.nameAtlas,this.onClickSettingBtn,this,null,this.positionMenuConfig.btn_setting.nameSprite);return e.events.onInputUp.add(this.onClickFriendRequestBtn,this),e.anchor.set(.5),e.type=4,e}},{key:"onClickFriendRequestBtn",value:function(){Le.instance().logEvent(Le.Friend_add_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.addFriendBtn,this.activeAddFriendBtn),this.typeNew=4,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=4,this.noti&&this.noti.destroy()}},{key:"addActiveAddFriendBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_setting_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_setting_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_setting_active.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_setting_active.nameSprite);return e.anchor.set(.5),e}},{key:"addMailBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_mail.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_mail.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_mail.nameAtlas,this.onClickMailBtn,this,null,this.positionMenuConfig.btn_mail.nameSprite);return e.anchor.set(.5),e.type=2,e}},{key:"onClickMailBtn",value:function(){Le.instance().logEvent(Le.Mail_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.mailBtn,this.activeMailBtn),this.typeNew=2,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=2,this.notiMail&&this.notiMail.destroy()}},{key:"addActiveMailBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_mail_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_mail_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_mail_active.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_mail_active.nameSprite);return e.anchor.set(.5),e}},{key:"addShopBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_shop.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_shop.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_shop.nameAtlas,this.onClickShopBtn,this,null,this.positionMenuConfig.btn_shop.nameSprite);return e.anchor.set(.5),e.type=3,e}},{key:"onClickShopBtn",value:function(){ce.instance().playSound(ce.buttonclick),IE.instance().addShop(0)}},{key:"addActiveShopBtn",value:function(){var e=new Phaser.Button(game,this.positionMenuConfig.btn_shop_active.x*window.GameConfig.RESIZE,this.positionMenuConfig.btn_shop_active.y*window.GameConfig.RESIZE,this.positionMenuConfig.btn_shop_active.nameAtlas,function(){},this,null,this.positionMenuConfig.btn_shop_active.nameSprite);return e.anchor.set(.5),e}},{key:"changeScreen",value:function(e,t){1==e?(this.hideScreen(e,t),rF.instance().changeScreen(Ce.MAIN_MENU)):2==e?(this.mailScreen=new Nk(0,0,t),this.mailScreen.createMail(),this.layoutContent.addChild(this.mailScreen),this.mailScreen.show(),this.hideScreen(e,t),this.event.changeOtherScreen.dispatch()):3==e||4==e&&(this.addFriendScreen=new TP(0,0,t),this.addFriendScreen.createAddFriendScreen(),this.layoutContent.addChild(this.addFriendScreen),this.addFriendScreen.show(),this.hideScreen(e,t),this.event.changeOtherScreen.dispatch())}},{key:"hideScreen",value:function(e,t){1==t?LogConsole.log("don't do nothing"):2==t?this.mailScreen.hide(e):3==t?this.shopScreen.hide(e):4==t&&this.addFriendScreen.hide(e)}},{key:"addFriendRequest",value:function(e){if(e>0){this.noti=new Phaser.Sprite(game,this.positionMenuConfig.notiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.y*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.nameAtlas,this.positionMenuConfig.notiDot.nameSprite);var t=new Phaser.Text(game,this.positionMenuConfig.txtNotiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.txtNotiDot.y*window.GameConfig.RESIZE,e,this.positionMenuConfig.txtNotiDot.configs);t.anchor.set(.5),this.noti.addChild(t),this.addFriendBtn.addChild(this.noti)}}},{key:"ajaxCountMessage",value:function(){null!==TF.instance().socket.mySelf&&(gl.instance().countMessage(TF.instance().socket.mySelf.getVariable("user_id").value),gl.instance().sendData(this.onCountMessageCallback.bind(this)))}},{key:"onCountMessageCallback",value:function(e){"ok"==e.code&&this.addMailNoti(e.data)}},{key:"addMailNoti",value:function(e){if(e.countMessage>0){this.notiMail=new Phaser.Sprite(game,this.positionMenuConfig.notiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.y*window.GameConfig.RESIZE,this.positionMenuConfig.notiDot.nameAtlas,this.positionMenuConfig.notiDot.nameSprite);var t=new Phaser.Text(game,this.positionMenuConfig.txtNotiDot.x*window.GameConfig.RESIZE,this.positionMenuConfig.txtNotiDot.y*window.GameConfig.RESIZE,e.countMessage,this.positionMenuConfig.txtNotiDot.configs);t.anchor.set(.5),this.notiMail.addChild(t),this.mailBtn.addChild(this.notiMail)}}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.backMenu,this)}},{key:"backMenu",value:function(){this.event.backMenu.dispatch(),this.removeEventExtension()}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.backMenu,this)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&AP(n.prototype,i),o&&AP(n,o),t}();function NP(e){return(NP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jP(e,t){return!t||"object"!==NP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function UP(e){return(UP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FP(e,t){return(FP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ZP=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jP(this,UP(t).call(this,game,e,n,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FP(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"add",value:function(e){this.addChild(e)}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&BP(n.prototype,i),o&&BP(n,o),t}();function HP(e){return(HP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function VP(e,t){return!t||"object"!==HP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function WP(e){return(WP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qP(e,t){return(qP=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var KP=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=VP(this,WP(t).call(this,game,e,n,null))).positionConfigs=JSON.parse(game.cache.getText("positionMenuConfig")),a.positionPracticeScreenConfig=JSON.parse(game.cache.getText("positionPracticeScreenConfig")),a.valueScale=window.GameConfig.SCALE_PLAYLIST_PRACTICE,a.configs=i,a.thumbUrl=null,a.thumb,a.namePlaylist=null,a.boxPrice=null,a.btnChoose,a.maskThumb,a.signalInput=new Phaser.Signal,a.signalBuyPlaylist=new Phaser.Signal,a.signalGetRanking=new Phaser.Signal,a.index=o,a.id=10*Math.random(),a.addEvent(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qP(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterCreate",value:function(){this.addThumb(),this.addNamePlaylist(),1!==this.configs.is_owner?this.addBoxPrice(this.positionPracticeScreenConfig.practice_box_price):this.addBtnChoose(this.positionPracticeScreenConfig.btn_choose)}},{key:"addThumb",value:function(){this.maskThumb=new Phaser.Graphics(game,0,0),this.maskThumb.beginFill(16777215),this.maskThumb.drawRoundedRect(0,0,165*window.GameConfig.RESIZE,165*window.GameConfig.RESIZE,10*window.GameConfig.RESIZE),this.addChild(this.maskThumb),this.thumb=new Phaser.Sprite(game,0,0,"songDetailSprites","Nhactre"),this.thumb.scale.set(window.GameConfig.SCALE_PLAYLIST_PRACTICE*window.GameConfig.RESIZE);var e=new Phaser.Sprite(game,10,10,"practiceMenuSprites","Ranking");this.thumb.addChild(e),this.thumb.mask=this.maskThumb,this.thumb.inputEnabled=!0,this.thumb.events.onInputUp.add(this.clickThumb,this),this.addChild(this.thumb)}},{key:"clickThumb",value:function(){this.signalGetRanking.dispatch(this.configs)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.inputEnabled=!1;var e={name:this.configs.name,id:this.configs.id};this.practicePlaylist=e,this.signalInput.dispatch(e)}},{key:"addBtnChoose",value:function(e){this.btnChoose=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,e.btn.y*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btnChoose.inputEnabled=!0,this.btnChoose.events.onInputUp.add(this.onClickSprite,this);var t=new Phaser.Text(game,e.txt.x*window.GameConfig.RESIZE,e.txt.y*window.GameConfig.RESIZE,e.txt.text,e.txt.configs);t.anchor.set(.5,0),this.btnChoose.addChild(t),this.addChild(this.btnChoose)}},{key:"addNamePlaylist",value:function(){this.namePlaylist=new Phaser.Text(game,0,180*window.GameConfig.RESIZE,this.configs.name,{font:"Gilroy",fill:"#ffffff",wordWrap:!0,wordWrapWidth:150,maxLines:2,fontSize:20}),this.addChild(this.namePlaylist)}},{key:"addBoxPrice",value:function(e){LogConsole.log("has price"),this.boxPrice=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.boxPrice.inputEnabled=!0,this.boxPrice.events.onInputUp.add(this.onClickBuy,this);var t=this.addGem(this.positionPracticeScreenConfig.practice_gem_box_price),n=this.addPrice(this.positionPracticeScreenConfig.practice_txt_price),i=t.width+n.width;n.x=(this.boxPrice.width-i)/2-5*window.GameConfig.RESIZE,t.x=(this.boxPrice.width-i)/2+n.width+5*window.GameConfig.RESIZE,this.boxPrice.addChild(t),this.boxPrice.addChild(n),this.addChild(this.boxPrice)}},{key:"onClickBuy",value:function(){ce.instance().playSound(ce.buttonclick),this.playlistBuy=new Ah,this.playlistBuy=Object.assign({},this.playlistBuy,this.configs),console.log("HHHHH"),console.log(this.playlistBuy),IE.instance().buyItem(this.playlistBuy)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addPrice",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.configs.price,e.configs)}},{key:"loadThumb",value:function(){if(this.key=this.configs.thumb,game.cache.checkImageKey(this.configs.thumb))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadStart.add(this.loadStart,this),e.onLoadComplete.add(this.onLoad,this),e.image(this.configs.thumb,this.configs.thumb),e.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{game.cache.checkImageKey(e.key)?e.thumb.loadTexture("".concat(e.key)):e.thumb.loadTexture("songDetailSprites","Nhactre")}catch(e){}},100*this.index)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case Hs.SHOP_BUY_PLAYLIST_RESPONSE:"OK"==e.params.getUtfString("status")&&e.params.getInt("playlist_id")==this.configs.id&&this.signalBuyPlaylist.dispatch(this.configs)}}},{key:"destroy",value:function(){for(this.removeEvent();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&QP(n.prototype,i),o&&QP(n,o),t}();function zP(e){return(zP="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YP(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function JP(e,t){return!t||"object"!==zP(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XP(e){return(XP=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $P(e,t){return($P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var eO=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1?arguments[1]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=JP(this,XP(t).call(this,game))).index=i,e.afterCreate(n),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$P(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterCreate",value:function(e){this.key=e,this.ava=new Phaser.Sprite(game,0,0,"songDetailSprites","ava-default"),this.ava.anchor.set(.5),this.ava.scale.set(.35*window.GameConfig.RESIZE),this.addChild(this.ava),this.maskAva=new Phaser.Graphics(game,0,0),this.addMaskAva(),this.beginLoad()}},{key:"addMaskAva",value:function(){this.maskAva.beginFill(),this.maskAva.drawCircle(0,0,200),this.maskAva.endFill(),this.ava.mask=this.maskAva,this.ava.addChild(this.maskAva)}},{key:"beginLoad",value:function(){if(game.cache.checkImageKey(this.key))this.onLoad();else{var e=new Phaser.Loader(game);e.crossOrigin="anonymous",e.onLoadComplete.add(this.onLoad,this),e.image(this.key,this.key),e.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){try{""!==e.key?e.ava.loadTexture(e.key):e.ava.loadTexture("songDetailSprites","ava-default")}catch(e){}},50*this.index)}}])&&YP(n.prototype,i),o&&YP(n,o),t}();function tO(e){return(tO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iO(e,t){return!t||"object"!==tO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oO(e){return(oO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aO(e,t){return(aO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sO=function(e){function t(e,n){var i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=iO(this,oO(t).call(this,game,640,188*n*window.GameConfig.RESIZE,null))).positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),i.configs=e,i.index=n,i.isFinish=o,i.clickProfile=!1,i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.icon,this.number,this.ava,this.name,this.score,this.diamond,this.txtDiamond,this.ticket,this.txtTicket,this.line,this.addIcon(this.positionRankingConfig.rank[this.index+1]),this.addNumber(),this.addAva(),this.addName(),this.addCircle(this.positionRankingConfig.circle_stroke),this.addScore(),this.addLine(),this.addTweenMoveToScreen()}},{key:"addIcon",value:function(e){this.icon=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.addChild(this.icon)}},{key:"addNumber",value:function(){this.number=new Phaser.Text(game,85*window.GameConfig.RESIZE,47*window.GameConfig.RESIZE,"".concat(this.index+1),{font:"GilroyMedium",fill:"#ffffff",fontSize:21}),this.addChild(this.number)}},{key:"addAva",value:function(){this.ava=new eO(this.configs.avatar,this.index),this.ava.x=170*window.GameConfig.RESIZE,this.ava.y=58*window.GameConfig.RESIZE,this.ava.ava.inputEnabled=!0,this.ava.ava.events.onInputUp.add(this.onClickAvaGetUserProfile,this),this.addChild(this.ava)}},{key:"onClickAvaGetUserProfile",value:function(){0==this.clickProfile?(this.clickProfile=!1,IE.instance().addUserProfile(this.configs.user_id)):this.clickProfile=!1}},{key:"addName",value:function(){this.name=new Phaser.Text(game,225*window.GameConfig.RESIZE,38*window.GameConfig.RESIZE,this.configs.user_name,{font:"GilroyMedium",fill:"#ffffff",fontSize:22}),this.addChild(this.name)}},{key:"addCircle",value:function(e){this.circle=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.circle.anchor.set(1,0),this.addChild(this.circle)}},{key:"addScore",value:function(){this.score=new Phaser.Text(game,-27*window.GameConfig.RESIZE,28*window.GameConfig.RESIZE,this.configs.number_of_correct,{font:"GilroyMedium",fill:"#ffa33a",fontSize:20}),this.score.anchor.set(.5),this.circle.addChild(this.score)}},{key:"addDiamondScore",value:function(){this.diamond=new Phaser.Sprite(game,this.positionRankingConfig.diamond.x*window.GameConfig.RESIZE,this.positionRankingConfig.diamond.y*window.GameConfig.RESIZE,this.positionRankingConfig.diamond.nameAtlas,this.positionRankingConfig.diamond.nameSprite),this.addChild(this.diamond),this.txtDiamond=new Phaser.Text(game,this.positionRankingConfig.txt_diamond.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_diamond.y*window.GameConfig.RESIZE,3e3/(this.index+1),this.positionRankingConfig.txt_diamond.configs),this.addChild(this.txtDiamond)}},{key:"addTicketScore",value:function(){this.ticket=new Phaser.Sprite(game,this.positionRankingConfig.ticket.x*window.GameConfig.RESIZE,this.positionRankingConfig.ticket.y*window.GameConfig.RESIZE,this.positionRankingConfig.ticket.nameAtlas,this.positionRankingConfig.ticket.nameSprite),this.addChild(this.ticket),this.txtTicket=new Phaser.Text(game,this.positionRankingConfig.txt_ticket.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_ticket.y*window.GameConfig.RESIZE,30/(this.index+1),this.positionRankingConfig.txt_ticket.configs),this.addChild(this.txtTicket)}},{key:"addLine",value:function(){this.line=new rt(this.positionRankingConfig.line_under),this.addChild(this.line)}},{key:"addTweenMoveToScreen",value:function(){var e=this;setTimeout(function(){game.add.tween(e).to({x:0},250,"Linear",!0).start()},100*this.index)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}},{key:"height",get:function(){return 115*window.GameConfig.RESIZE}}])&&nO(n.prototype,i),o&&nO(n,o),t}();function rO(e){return(rO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hO(e,t){return!t||"object"!==rO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cO(e){return(cO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uO(e,t){return(uO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dO=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=hO(this,cO(t).call(this,game,640,188*n*window.GameConfig.RESIZE,null))).configs=e,o.positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),o.index=n,o.isFinish=i,o.clickProfile=!1,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.icon,this.number,this.ava,this.name,this.circle,this.score,this.line,this.addIcon(this.positionRankingConfig.rank.other),this.addNumber(),this.addAva(),this.addName(),this.addCircle(this.positionRankingConfig.circle_stroke),this.addScore(),this.addLine(),this.addTweenMoveToScreen()}},{key:"addIcon",value:function(e){this.icon=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.addChild(this.icon)}},{key:"addNumber",value:function(){this.number=new Phaser.Text(game,80*window.GameConfig.RESIZE,39*window.GameConfig.RESIZE,"".concat(this.index+1),{font:"GilroyMedium",fill:"#ffffff",fontSize:21}),this.addChild(this.number)}},{key:"addAva",value:function(){this.ava=new eO(this.configs.avatar,this.index),this.ava.x=170*window.GameConfig.RESIZE,this.ava.y=58*window.GameConfig.RESIZE,this.ava.ava.inputEnabled=!0,this.ava.ava.events.onInputUp.add(this.onClickAvaGetUserProfile,this),this.addChild(this.ava)}},{key:"onClickAvaGetUserProfile",value:function(){0==this.clickProfile&&(this.clickProfile=!0,IE.instance().addUserProfile(this.configs.user_id))}},{key:"addName",value:function(){this.name=new Phaser.Text(game,225*window.GameConfig.RESIZE,50*window.GameConfig.RESIZE,this.configs.user_name,{font:"GilroyMedium",fill:"#ffffff",fontSize:22}),this.name.anchor.set(0,.5),this.addChild(this.name)}},{key:"addCircle",value:function(e){this.circle=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.circle.anchor.set(1,0),this.addChild(this.circle)}},{key:"addScore",value:function(){this.score=new Phaser.Text(game,-27*window.GameConfig.RESIZE,28*window.GameConfig.RESIZE,this.configs.number_of_correct,{font:"GilroyMedium",fill:"#ffa33a",fontSize:20}),this.score.anchor.set(.5),this.circle.addChild(this.score)}},{key:"addLine",value:function(){this.line=new rt(this.positionRankingConfig.line_under),this.addChild(this.line)}},{key:"addTweenMoveToScreen",value:function(){var e=this;this.index<8?this.timeOut=setTimeout(function(){game.add.tween(e).to({x:0},250,"Linear",!0).start()},100*this.index):this.position.x=0}},{key:"destroy",value:function(){for(clearTimeout(this.timeOut);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}},{key:"height",get:function(){return 115*window.GameConfig.RESIZE}}])&&lO(n.prototype,i),o&&lO(n,o),t}();function fO(e){return(fO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gO(e,t){return!t||"object"!==fO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yO(e){return(yO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mO(e,t){return(mO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vO=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=gO(this,yO(t).call(this,game,0,(game.height-108)*window.GameConfig.RESIZE,"practiceMenuSprites","Tab_label"))).configs=e,n.positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.icon,this.number,this.ava,this.name,this.circle,this.score,this.line,"N/A"!==this.configs.rank?(this.addIcon(this.positionRankingConfig.rank.other),this.addNumber(),this.addAva(),this.addName(),this.addCircle(this.positionRankingConfig.circle_stroke),this.addScore()):this.addNotRank()}},{key:"addNotRank",value:function(){this.txtNotRank=new Phaser.Text(game,320,53,"Bạn chưa có xếp hạng",{fontSize:30,font:"Gilroy",fill:"white",align:"center"}),this.txtNotRank.anchor.set(.5),this.addChild(this.txtNotRank)}},{key:"addIcon",value:function(e){this.icon=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.addChild(this.icon)}},{key:"addNumber",value:function(){this.number=new Phaser.Text(game,80*window.GameConfig.RESIZE,53*window.GameConfig.RESIZE,this.configs.rank,{font:"GilroyMedium",fill:"#ffffff",fontSize:22}),this.number.anchor.set(0,.5),this.addChild(this.number)}},{key:"addAva",value:function(){this.ava=new eO(this.configs.user_entity.avatar),this.ava.x=170*window.GameConfig.RESIZE,this.ava.y=58*window.GameConfig.RESIZE,this.addChild(this.ava)}},{key:"addName",value:function(){this.name=new Phaser.Text(game,220*window.GameConfig.RESIZE,53*window.GameConfig.RESIZE,this.configs.user_entity.user_name,{font:"GilroyMedium",fill:"#ffffff",fontSize:22}),this.name.anchor.set(0,.5),this.addChild(this.name)}},{key:"addCircle",value:function(e){this.circle=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.circle.anchor.set(1,0),this.addChild(this.circle)}},{key:"addScore",value:function(){this.score=new Phaser.Text(game,-27*window.GameConfig.RESIZE,28*window.GameConfig.RESIZE,this.configs.number_of_correct,{font:"GilroyMedium",fill:"#ffa33a",fontSize:20}),this.score.anchor.set(.5),this.circle.addChild(this.score)}},{key:"height",get:function(){return 193}}])&&pO(n.prototype,i),o&&pO(n,o),t}();function wO(e){return(wO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _O(e,t){return!t||"object"!==wO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SO(e){return(SO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EO(e,t){return(EO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CO=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=_O(this,SO(t).call(this,game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,null))).type=n,i.positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),i.initVariable(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EO(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"initVariable",value:function(){this.timeCounter,this.timeIcon,this.btnField,this.txtRank,this.timingWeek,this.timeCountDownThisWeekPractice,this.lineUnder,this.addBtnField(),"LAST_WEEK"==this.type||this.type,this.signalInput=new Phaser.Signal}},{key:"addInput",value:function(){this.inputEnabled=!0,this.events.onInputUp.add(this.onClickSprite,this)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.signalInput.dispatch()}},{key:"addBtnField",value:function(){this.btnField=new Phaser.Sprite(game,0,0,"otherSprites","tab_highlight"),this.btnField.scale.set(1.5,1),this.addChild(this.btnField)}},{key:"addTextThisWeek",value:function(){this.txtRank=new Phaser.Text(game,this.positionRankingConfig.txt_rank_this_week.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_rank_this_week.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_rank_this_week.text,this.positionRankingConfig.txt_rank_this_week.configs),this.width=this.txtRank.width,this.addChild(this.txtRank),this.addTiming(),this.lineUnder=new rt(this.positionRankingConfig.header.line),this.addChild(this.lineUnder)}},{key:"addTiming",value:function(){this.timeIcon=new Phaser.Sprite(game,this.positionRankingConfig.clock.x*window.GameConfig.RESIZE,this.positionRankingConfig.clock.y*window.GameConfig.RESIZE,this.positionRankingConfig.clock.nameAtlas,this.positionRankingConfig.clock.nameSprite),this.addChild(this.timeIcon)}},{key:"addTimeCountDown",value:function(e){this.timeCountDownThisWeekPractice=e,this.timeCounter=new Phaser.Text(game,this.positionRankingConfig.txt_timeCounter.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_timeCounter.text,this.positionRankingConfig.txt_timeCounter.configs);var t=game.time.create(!1);t.loop(1e3,this.handleTimer,this),t.start(),this.addChild(this.timeCounter)}},{key:"handleTimer",value:function(){this.timeCountDownThisWeekPractice--;var e=parseInt(this.timeCountDownThisWeekPractice/3600),t=parseInt(this.timeCountDownThisWeekPractice%3600/60),n=parseInt(this.timeCountDownThisWeekPractice%3600%60);this.timeCounter.setText("".concat(e,":").concat(t,":").concat(n))}},{key:"addTextLastWeek",value:function(){this.txtRank=new Phaser.Text(game,this.positionRankingConfig.txt_rank_last_week.x*window.GameConfig.RESIZE,this.positionRankingConfig.txt_rank_last_week.y*window.GameConfig.RESIZE,this.positionRankingConfig.txt_rank_last_week.text,this.positionRankingConfig.txt_rank_last_week.configs),this.txtRank.tint=9670812,this.width=this.txtRank.width,this.addChild(this.txtRank),this.lineUnder=new rt(this.positionRankingConfig.header.line),this.lineUnder.kill(),this.addChild(this.lineUnder)}},{key:"setWidth",value:function(){}},{key:"setHeight",value:function(){}},{key:"changeEffectShow",value:function(){this.inputEnabled=!1,this.txtRank.tint=16777215,this.lineUnder.revive()}},{key:"changeEffectHide",value:function(){this.inputEnabled=!0,this.txtRank.tint=9670812,this.lineUnder.kill()}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}}])&&bO(n.prototype,i),o&&bO(n,o),t}();function kO(e){return(kO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OO(e,t){return!t||"object"!==kO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RO(e){return(RO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xO(e,t){return(xO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var TO=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=OO(this,RO(t).call(this,game))).positionRankingConfig=JSON.parse(game.cache.getText("positionRankingConfig")),e.arrHelps=["Top 100 người trả lời đúng nhiều câu hỏi nhất trong tuần (cập nhật sau 10 phút)","Top 100 người trả lời đúng nhiều câu hỏi nhất của tuần trước"],e.event={back:new Phaser.Signal},e.typeButton=1,e.checkAddHelp=!1,e.arrThisWeek,e.arrLastWeek,e.tabUnder=null,e.popupHelp=null,e.tab4To10,e.listView,e.tabUser,e.addEventExtension(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xO(e,t)}(t,Phaser.Group),n=t,(i=[{key:"setData",value:function(e,t,n){this.rankingListThisWeek=e,this.rankingListLastWeek=t,this.playlist=n,this.afterInit()}},{key:"afterInit",value:function(){this.addBG(),this.btnRankingLastWeek,this.btnRankingThisWeek,this.addParentSprite(),this.addButtonSwitch(),this.addHeaderRank(this.positionRankingConfig.header),Le.instance().logEvent(Le.Solo_mode_ranking)}},{key:"addBG",value:function(){var e=new Phaser.Button(game,0,0,"bg-playlist");e.input.useHandCursor=!1,this.addChild(e)}},{key:"addHeaderRank",value:function(e){var t=new Phaser.Sprite(game,e.tab.x*window.GameConfig.RESIZE,e.tab.y*window.GameConfig.RESIZE,e.tab.nameAtlas,e.tab.nameSprite),n=new Phaser.Sprite(game,e.back.x*window.GameConfig.RESIZE,e.back.y*window.GameConfig.RESIZE,e.back.nameAtlas,e.back.nameSprite);n.anchor.set(.5),n.inputEnabled=!0,n.events.onInputUp.add(this.onBack,this),t.addChild(n);var i=new Phaser.Sprite(game,e.line_doc.x*window.GameConfig.RESIZE,e.line_doc.y*window.GameConfig.RESIZE,e.line_doc.nameAtlas,e.line_doc.nameSprite);this.addChild(i);var o=game.add.text(e.name.x*window.GameConfig.RESIZE,e.name.y*window.GameConfig.RESIZE,this.playlist.name,e.name.configs);o.anchor.set(.5,0),t.addChild(o),this.addChild(t),this.btnHelp=new Phaser.Button(game,this.positionRankingConfig.help_btn.x,this.positionRankingConfig.help_btn.y,this.positionRankingConfig.help_btn.nameAtlas,this.onClickHelp,this,null,this.positionRankingConfig.help_btn.nameSprite),this.addChild(this.btnHelp)}},{key:"onClickHelp",value:function(){this.checkAddHelp=!this.checkAddHelp,1==this.checkAddHelp?this.addPopupHelp():this.removePopupHelp()}},{key:"addPopupHelp",value:function(){this.removePopupHelp(),this.popupHelp=new Kt(this.arrHelps[this.typeButton-1]),this.popupHelp.y=83*z.instance().scale,this.popupHelp.x=game.width-this.popupHelp.width-71*z.instance().scale,game.world.add(this.popupHelp)}},{key:"removePopupHelp",value:function(){null!==this.popupHelp&&(game.world.remove(this.popupHelp),this.popupHelp.destroy(),this.popupHelp=null)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),this.event.back.dispatch(),this.destroy(),this.rankingListThisWeek=[],this.rankingListLastWeek=[]}},{key:"addButtonSwitch",value:function(){this.btnRankingLastWeek=new CO(this.positionRankingConfig.button_ranking_last_week,"LAST_WEEK"),this.btnRankingLastWeek.addTextLastWeek(),this.btnRankingLastWeek.addInput(),this.btnRankingLastWeek.addEventInput(this.onClickLastWeek,this),this.btnRankingLastWeek.setWidth(),this.addChild(this.btnRankingLastWeek),this.btnRankingThisWeek=new CO(this.positionRankingConfig.button_ranking_this_week,"THIS_WEEK"),this.btnRankingThisWeek.addTextThisWeek(),this.btnRankingThisWeek.addInput(),this.btnRankingThisWeek.addEventInput(this.onClickThisWeek,this),this.btnRankingThisWeek.setWidth(),this.addChild(this.btnRankingThisWeek)}},{key:"onClickLastWeek",value:function(){qe.instance().showLoading(),this.typeButton=2,this.btnRankingLastWeek.changeEffectShow(),this.btnRankingThisWeek.changeEffectHide(),this.showList()}},{key:"onClickThisWeek",value:function(){qe.instance().showLoading(),this.typeButton=1,this.btnRankingThisWeek.changeEffectShow(),this.btnRankingLastWeek.changeEffectHide(),this.showList()}},{key:"showList",value:function(){var e;this.listView.removeAll(),this.listView.reset(),this.ktBuild=!1,this.idx=0,this.countItem=0,e=1==this.typeButton?this.posThisWeek:this.posLastWeek,this.buildItemPage(),this.addTabUnder(e)}},{key:"addParentSprite",value:function(){var e=new Phaser.Group(game,this);e.x=0,e.y=206*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-311)*window.GameConfig.RESIZE);this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0}),this.listView.events.changeIndex.add(this.changeIndex,this)}},{key:"changeIndex",value:function(){var e=this.listView.getIdx();this.buildChangeIndex(e)}},{key:"addChildScrollMap",value:function(){ce.instance().playSound(ce.showranking),this.showList()}},{key:"setRankingThisWeek",value:function(e,t,n){this.arrThisWeek=e||this.positionRankingConfig.users,this.posThisWeek=n,this.addTimeCountDown(t),this.addChildScrollMap(),qe.instance().hideLoading()}},{key:"setRankingLastWeek",value:function(e,t){this.arrLastWeek=e||this.positionRankingConfig.users2,this.posLastWeek=t}},{key:"addTimeCountDown",value:function(e){this.btnRankingThisWeek.addTimeCountDown(e)}},{key:"filterOwnerRanking",value:function(e,t){t(e.filter(function(e){return e.user_id==TF.instance().socket.mySelf.getVariable("user_id").value}))}},{key:"addTabUnder",value:function(e){null==e&&(e={number_of_correct:0,playlist_id:0,rank:"N/A",user_name:TF.instance().dataMySeft.user_name,avatar:TF.instance().socket.mySelf.getVariable("avatar").value,user_id:TF.instance().socket.mySelf.getVariable("user_id").value}),null!==this.tabUnder&&(this.removeChild(this.tabUnder),this.tabUnder.destroy(),this.tabUnder=null),this.tabUnder=new vO(e),this.addChild(this.tabUnder)}},{key:"buildChangeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){var e=[];e=1==this.typeButton?this.arrThisWeek:this.arrLastWeek,this.ktBuild=!0;for(var t=this.idx;t<e.length;t++){var n=void 0;if(n=t+1==3?new sO(e[t],t,!0):t+1<3?new sO(e[t],t,!1):t+1==e.length?new dO(e[t],t,!0):new dO(e[t],t,!1),this.listView.add(n),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<e.length){this.ktBuild=!1;break}this.idx===e.length&&(this.ktBuild=!1)}this.timeout=setTimeout(function(){qe.instance().hideLoading()},300)}},{key:"addEventExtension",value:function(){De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){De.instance().event.backButton.remove(this.onBack,this)}},{key:"destroy",value:function(){for(clearTimeout(this.timeout),this.removeEventExtension(),this.removePopupHelp();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&PO(n.prototype,i),o&&PO(n,o),t}();var IO=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rank="N/A",this.user_id=TF.instance().dataMySeft.user_id,this.playlist_id=0,this.number_of_correct=0,this.user_entity={user_name:TF.instance().dataMySeft.user_name,avatar:TF.instance().dataMySeft.avatar}};function AO(e){return(AO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GO(e,t){return!t||"object"!==AO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DO(e){return(DO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MO(e,t){return(MO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var NO=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=GO(this,DO(t).call(this,game,640*window.GameConfig.RESIZE,0,"bg-playlist"))).positionPracticeScreenConfig=JSON.parse(game.cache.getText("positionPracticeScreenConfig")),e.event={pickAlbum:new Phaser.Signal,refreshPickAlbum:new Phaser.Signal},e.signalInputX=new Phaser.Signal,e.headerTab,e.scrollTab,e.playlists,e.state=null,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MO(e,t)}(t,Mp),n=t,(i=[{key:"afterInit",value:function(){this.onClickRankAlbum=!1,this.addEventExtension(),this.addTweenScreen(),Le.instance().logEvent(Le.Solo_mode)}},{key:"addTweenScreen",value:function(){game.add.tween(this).to({x:0},200,"Linear",!1).start()}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Button(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,function(){},this,null,e.tab_chonplaylist.nameSprite),this.addChild(this.headerTab),this.btnBack,this.txtGem,this.txtHeart,this.tabGemHeader,this.tabHeartHeader,this.addButtonBack(e.btn_back),this.addTabGemHeader(e),this.addTabHeartHeader(e),this.addTxtPractice(e.txt_practice)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerTab.addChild(this.btnBack)}},{key:"onBack",value:function(){var e=this;if(0==this.onClickRankAlbum){ce.instance().playSound(ce.buttonclick),this.signalInputX.dispatch();var t=game.add.tween(this).to({x:1080*window.GameConfig.RESIZE},200,"Linear",!1);t.start(),t.onComplete.add(function(){e.destroy()},this)}}},{key:"addTxtPractice",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.positionPracticeScreenConfig.header.gem),n=this.addTxtGem(this.positionPracticeScreenConfig.header.txtGem),i=t.width+n.width;n.x=(this.tabGemHeader.width-i)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-i)/2+n.width+5*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(n),this.headerTab.addChild(this.tabGemHeader)}},{key:"addTabHeartHeader",value:function(e){this.tabHeartHeader=new Phaser.Sprite(game,e.tabHeart.x*window.GameConfig.RESIZE,e.tabHeart.y*window.GameConfig.RESIZE,e.tabHeart.nameAtlas,e.tabHeart.nameSprite);var t=this.addHeart(this.positionPracticeScreenConfig.header.heart);this.txtHeart=this.addTxtHeart(this.positionPracticeScreenConfig.header.txtHeart);var n=t.width+this.txtHeart.width;this.txtHeart.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtHeart.width+5*window.GameConfig.RESIZE,this.tabHeartHeader.addChild(t),this.tabHeartHeader.addChild(this.txtHeart),this.headerTab.addChild(this.tabHeartHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addHeart",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtHeart",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("heart").value,e.configs)}},{key:"addPlaylists",value:function(e){this.playlists=e.sort(this.sortPlaylist),this.playlists=this.playlists.sort(this.sortUpdatePlaylist);var t=0,n=0,i=new ZP(0,200*window.GameConfig.RESIZE),o=new Phaser.Group(game,this);o.x=0,o.y=230*window.GameConfig.RESIZE,this.addChild(o);var a=new Phaser.Rectangle(35*window.GameConfig.RESIZE,0,570*window.GameConfig.RESIZE,(game.height-206)*window.GameConfig.RESIZE);this.listView=new Vo(game,o,a,{direction:"y",overflow:100,padding:60,searchForClicks:!0});for(var s=1;s<this.playlists.length+1;s++){var r=new KP(t,n,this.playlists[s-1],s);r.afterCreate(),r.loadThumb(),r.signalInput.add(this.onChoosedAlbum,this),r.signalBuyPlaylist.add(this.buyPlaylistSoloMode,this),r.signalGetRanking.add(this.playlistGetRanking,this),i.add(r),s%3==0&&s>0?(t=0,n+=window.GameConfig.CONFIGS_POPUP_PRACTICE.y*window.GameConfig.RESIZE,this.addLine(i,this.positionPracticeScreenConfig.practice_line_scroll,n)):t+=window.GameConfig.CONFIGS_POPUP_PRACTICE.x*window.GameConfig.RESIZE}this.playlists.length%3==0?i.height+=this.playlists.length/3*(window.GameConfig.CONFIGS_POPUP_PRACTICE.y*window.GameConfig.RESIZE):i.height+=(this.playlists.length/3+1)*(window.GameConfig.CONFIGS_POPUP_PRACTICE.y*window.GameConfig.RESIZE),this.listView.add(i),this.addHeaderTab(this.positionPracticeScreenConfig.header)}},{key:"onChoosedAlbum",value:function(e){Le.instance().logEvent(Le.Solo_mode_quiz_play_button),this.event.pickAlbum.dispatch(e)}},{key:"buyPlaylistSoloMode",value:function(e){this.addNewBoughtPlaylist(e,z.instance().soloModePlaylists),this.event.refreshPickAlbum.dispatch()}},{key:"addNewBoughtPlaylist",value:function(e,t){for(var n=0;n<t.length;n++)t[n].id===e.id&&(t[n].is_owner=1,t[n].user_playlist_mapping={active:1,created:(new Date).getTime(),current_level_score:0,exp_score:0,id:0,level:0,next_level_score:50,playlist_id:e.id,updated:(new Date).getTime(),user_id:TF.instance().dataMySeft.user_id})}},{key:"playlistGetRanking",value:function(e){this.RankingScreen=new TO,this.RankingScreen.setData([],[],e),this.RankingScreen.event.back.add(this.onBackRanking,this),this.addChild(this.RankingScreen),this.sendGetRankingOption(e),this.onClickRankAlbum=!0}},{key:"onBackRanking",value:function(){this.onClickRankAlbum=!1}},{key:"sendGetRankingOption",value:function(e){this.sendSoloModeRanking(e.id)}},{key:"sendSoloModeRanking",value:function(e){qe.instance().showLoading(),this.sendLastWeekRanking(e),this.sendThisWeekRanking(e)}},{key:"sendLastWeekRanking",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),TF.instance().sendData(Et.SOLO_MODE_TOP10_LAST_WEEK_REQUEST,t)}},{key:"sendThisWeekRanking",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),TF.instance().sendData(Et.SOLO_MODE_TOP10_THIS_WEEK_REQUEST,t)}},{key:"rankingThisWeek",value:function(e){this.RankingScreen.setRankingThisWeek(this.rankingListThisWeek,e,this.posThisWeek)}},{key:"rankingLastWeek",value:function(){this.RankingScreen.setRankingLastWeek(this.rankingListLastWeek,this.posLastWeek)}},{key:"sortPlaylist",value:function(e,t){return e.is_owner>t.is_owner?-1:e.is_owner<t.is_owner?1:0}},{key:"sortUpdatePlaylist",value:function(e,t){return 1!=e.is_owner||1!=t.is_owner?0:e.user_playlist_mapping?e.user_playlist_mapping.updated>t.user_playlist_mapping.updated?-1:e.user_playlist_mapping.updated<t.user_playlist_mapping.updated?1:0:void 0}},{key:"addLine",value:function(e,t,n){var i=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE+n,t.nameAtlas,t.nameSprite);e.addChild(i)}},{key:"addEventInputX",value:function(e,t){this.signalInputX.add(e,t)}},{key:"removeEventInputX",value:function(e,t){this.signalInputX.remove(e,t)}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.onBack,this),TF.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),TF.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"onUpdateUserVars",value:function(){TF.instance().dataMySeft.heart!==parseInt(this.txtHeart.text)&&(this.txtHeart.text=TF.instance().dataMySeft.heart)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.SOLO_MODE_TOP10_THIS_WEEK_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.rankingListThisWeek=[],this.posThisWeek=new IO,Bn.handleRankingList(e.params,this.rankingListThisWeek,this.posThisWeek,function(){Bn.handleTime(e.params,function(e){t.rankingThisWeek(e)})})):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_TOP10_LAST_WEEK_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.rankingListLastWeek=[],this.posLastWeek=new IO,Bn.handleRankingList(e.params,this.rankingListLastWeek,this.posLastWeek,function(){t.rankingLastWeek()})):console.warn(e.params.getUtfString("message")))}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&LO(n.prototype,i),o&&LO(n,o),t}();function BO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var jO=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loadDataComplete=new Phaser.Signal,this.loadDataFail=new Phaser.Signal}var t,n,i;return t=e,(n=[{key:"beginLoadAudio",value:function(e){El.instance().loadSound(e.url),El.instance().event.loadComplete.add(this.loadComplete,this),El.instance().event.loadFail.add(this.loadFail,this)}},{key:"loadStart",value:function(){LogConsole.log("loadStart")}},{key:"loadComplete",value:function(){LogConsole.log("load TT"),this.loadDataComplete.dispatch()}},{key:"loadFail",value:function(){this.loadDataFail.dispatch()}},{key:"addEventLoadComplete",value:function(e,t){this.loadDataComplete.add(e,t)}},{key:"removeEventLoadComplete",value:function(e,t){this.loadDataComplete.remove(e,t)}},{key:"remove",value:function(){El.instance().event.loadComplete.remove(this.loadComplete,this)}}])&&BO(t.prototype,n),i&&BO(t,i),e}();function UO(e){return(UO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZO(e){return(ZO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HO(e,t){return(HO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function QO(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var VO=function(e){function t(e,n,i){var o,a,s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=ZO(t).call(this,game))||"object"!==UO(s)&&"function"!=typeof s?QO(a):s).posX=e,o.positionPracticeScreenConfig=JSON.parse(game.cache.getText("positionPracticeScreenConfig")),o.sprite=new Phaser.Button(game,e+1080*window.GameConfig.RESIZE,n,o.positionPracticeScreenConfig.answer_tab.nameAtlas,o.onClickAnswer,QO(QO(o)),null,o.positionPracticeScreenConfig.answer_tab.nameSprite),o.sprite.anchor=new Phaser.Point(.5,.5),o.configs=i,o.addChild(o.sprite),o.event={chooseAnswer:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HO(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){var e=this;this.answerText=new Phaser.Text(game,0,0,"".concat(this.configs.answer),{font:"GilroyMedium",fill:"#000000",align:"center",fontSize:28,boundsAlignH:"center",boundsAlignV:"middle",wordWrap:!0,wordWrapWidth:500}),this.answerText.anchor.set(.5),this.sprite.addChild(this.answerText),this.answer=this.configs.value,setTimeout(function(){game.add.tween(e.sprite).to({x:e.posX},450,Phaser.Easing.Back.Out,!1).start()},70*(this.configs.value-1))}},{key:"onClickAnswer",value:function(){this.event.chooseAnswer.dispatch(this.configs)}},{key:"displayScreenWhenAnswerRight",value:function(){this.answerText.addColor("#01c66a",0)}},{key:"displayScreenWhenAnswerWrong",value:function(){this.answerText.addColor("#ff0000",0)}},{key:"displayScreenWhenAnswerNotChoosed",value:function(){this.sprite.alpha=.5}}])&&FO(n.prototype,i),o&&FO(n,o),t}();function WO(e){return(WO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qO(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function KO(e,t){return!t||"object"!==WO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zO(e){return(zO=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function YO(e,t){return(YO=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var JO=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=KO(this,zO(t).call(this,game))).positionPracticeScreenConfig=JSON.parse(game.cache.getText("positionPracticeScreenConfig")),e.positionPracticePopupConfig=JSON.parse(game.cache.getText("positionPracticePopupConfig")),e.event={playAgain:new Phaser.Signal,backToHome:new Phaser.Signal},e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YO(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.countQuiz=0,this.addEventExtension(),this.bg=new Phaser.Sprite(game,0,0,"bg_create_room"),this.addChild(this.bg),this.loadAudioSource=new jO,this.loadAudioSource.loadDataComplete.add(this.onLoadAudioComplete,this),this.loadAudioSource.loadDataFail.add(this.onLoadAudioFail,this),this.definedScreenPracticeModeAndLogicValue()}},{key:"definedScreenPracticeModeAndLogicValue",value:function(){this.choosed=!1,this.dotsGroup=null,this.timeout=!1,this.rankingListThisWeek=[],this.rankingListLastWeek=[],this.question,this.groupAnswer=null,this.RankingScreen=null,this.gotRewardStatus=!1,this.answerGroup=new Phaser.Group(game),this.addChild(this.answerGroup),this.addAvaAndMaskAva(),this.addNameFB(),this.addMapPracticeAndDotAnswer(),this.addFlag(),this.addTabGemAndTabHeart(),this.addLoadingSong(),Le.instance().logEvent(Le.Solo_mode_quiz_play)}},{key:"addLoadingSong",value:function(){this.stopAudio();var e={key:"songChoiced",url:this.questions[this.countQuiz].songEntity.fileUrl};this.question=this.questions[this.countQuiz],this.loadAudioSource.beginLoadAudio(e),this.loadingAnim=new Fe,this.loadingAnim.moveTxtLoading(),this.addChild(this.loadingAnim)}},{key:"onLoadAudioComplete",value:function(){this.loadingAnim.destroy(),this.removeChild(this.loadingAnim),El.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.addAnswerGroup()}},{key:"onLoadAudioFail",value:function(){this.loadingAnim.destroy(),this.removeChild(this.loadingAnim),El.instance().playsound(this.questions[this.countQuiz].songEntity.fileUrl),this.addAnswerGroup()}},{key:"stopAudio",value:function(){El.instance().removeSound()}},{key:"addAvaAndMaskAva",value:function(){var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawCircle(this.positionPracticeScreenConfig.avaPractice.x*window.GameConfig.RESIZE,this.positionPracticeScreenConfig.avaPractice.y*window.GameConfig.RESIZE,147*window.GameConfig.RESIZE),e.anchor.set(.5),this.addChild(e);var t=new rl(this.positionPracticeScreenConfig.avaPractice.x*window.GameConfig.RESIZE,this.positionPracticeScreenConfig.avaPractice.y*window.GameConfig.RESIZE,"ava-default","ava_fb",0);t.sprite.anchor.set(.5),t.sprite.scale.set(window.GameConfig.SCALE_AVA_USER*window.GameConfig.RESIZE),t.sprite.mask=e,this.addChild(t.sprite),this.trueOrFalse=new Pd,this.trueOrFalse.setSize(315*window.GameConfig.RESIZE,315*window.GameConfig.RESIZE),this.trueOrFalse.x=-155*window.GameConfig.RESIZE+t.sprite.x,this.trueOrFalse.y=-155*window.GameConfig.RESIZE+t.sprite.y,this.addChild(this.trueOrFalse)}},{key:"setTrueAva",value:function(){this.trueOrFalse.setTrueAnswer()}},{key:"setFalseAva",value:function(){this.trueOrFalse.setFailtAnswer()}},{key:"addTabGemAndTabHeart",value:function(){this.tabGem=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabGemMain.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGemMain.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabGemMain.nameAtlas,this.positionPracticePopupConfig.tabGemMain.nameSprite),this.addGemDetail(),this.addChild(this.tabGem),this.tabHeart=new Phaser.Sprite(game,this.positionPracticePopupConfig.tabHeartMain.x*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeartMain.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.tabHeartMain.nameAtlas,this.positionPracticePopupConfig.tabHeartMain.nameSprite),this.addHeartDetail(),this.addChild(this.tabHeart)}},{key:"addGemDetail",value:function(){var e;this.txtGem,e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.gem_rewardMain.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.gem_rewardMain.nameAtlas,this.positionPracticePopupConfig.gem_rewardMain.nameSprite),this.txtGem=new Phaser.Text(game,0,this.positionPracticePopupConfig.gem_reward_txtMain.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,this.positionPracticePopupConfig.gem_reward_txtMain.configs);var t=e.width+this.txtGem.width;this.txtGem.x=(this.tabGem.width-t)/2-5*window.GameConfig.RESIZE,e.x=(this.tabGem.width-t)/2+this.txtGem.width+5*window.GameConfig.RESIZE,this.tabGem.addChild(e),this.tabGem.addChild(this.txtGem)}},{key:"addHeartDetail",value:function(){var e,t;e=new Phaser.Sprite(game,0,this.positionPracticePopupConfig.heart_rewardMain.y*window.GameConfig.RESIZE,this.positionPracticePopupConfig.heart_rewardMain.nameAtlas,this.positionPracticePopupConfig.heart_rewardMain.nameSprite),t=new Phaser.Text(game,0,this.positionPracticePopupConfig.heart_reward_txtMain.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("heart").value,this.positionPracticePopupConfig.heart_reward_txtMain.configs);var n=e.width+t.width;t.x=(this.tabHeart.width-n)/2-5*window.GameConfig.RESIZE,e.x=(this.tabHeart.width-n)/2+t.width+5*window.GameConfig.RESIZE,this.tabHeart.addChild(e),this.tabHeart.addChild(t)}},{key:"addMapPracticeAndDotAnswer",value:function(){var e=new Phaser.Sprite(game,game.world.centerX,419*window.GameConfig.RESIZE,"practiceMenuSprites","Map");e.anchor.set(.5),this.addChild(e),this.addDotsGroup();for(var t=0;t<window.MQ.posAchievementPractice.length;t++)this.CreateAnswerAndDiamondText(window.MQ.posAchievementPractice[t].answerPosX*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[t].answerPosY*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[t].diamondPosX*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[t].diamondPosY*window.GameConfig.RESIZE,this.rewards[t].number_question,this.rewards[t].reward,this.rewards[t].reward_type,window.MQ.posCirclePractice[t].x*window.GameConfig.RESIZE,window.MQ.posCirclePractice[t].y*window.GameConfig.RESIZE)}},{key:"addNameFB",value:function(){var e=new Phaser.Text(game,this.positionPracticeScreenConfig.nameFBPractice.x*window.GameConfig.RESIZE,this.positionPracticeScreenConfig.nameFBPractice.y*window.GameConfig.RESIZE,"You",this.positionPracticeScreenConfig.nameFBPractice.configs);e.anchor.set(.5),this.addChild(e)}},{key:"CreateAnswerAndDiamondText",value:function(e,t,n,i,o,a,s,r,l){if("DIAMOND"==s){var h=new Phaser.Sprite(game,n+10,i,this.positionPracticeScreenConfig.diamond.nameAtlas,this.positionPracticeScreenConfig.diamond.nameSprite);h.anchor.set(0,.5),h.scale.set(.7),this.dotsGroup.addChild(h)}else if("TICKET"==s){var c=new Phaser.Sprite(game,n+10,i,this.positionPracticeScreenConfig.diamond.nameAtlas,"Ticket");c.anchor.set(0,.5),c.scale.set(.7),this.dotsGroup.addChild(c)}else if("SUPPORT_ITEM"==s){var u=new Phaser.Sprite(game,n+10,i,this.positionPracticeScreenConfig.diamond.nameAtlas,"Mic");u.anchor.set(0,.5),u.scale.set(.7),this.dotsGroup.addChild(u)}var d=new Phaser.Text(game,n,i,"".concat(a),{font:"Gilroy",fill:"white",fontSize:17.5});d.anchor.set(1,.5),this.dotsGroup.addChild(d);var f=new Phaser.Text(game,e,t,"".concat(o),{font:"Gilroy",fill:"white",fontSize:17.5});if(f.anchor.set(.5),this.dotsGroup.addChild(f),this.archived.achieved>=o)if(f.alpha=1,this.countQuiz==o){var p=new Phaser.Sprite(game,r,l,"practiceMenuSprites","Circle_Achieved");p.anchor.set(.5),this.dotsGroup.addChild(p)}else if(this.countQuiz>o){var g=new Phaser.Sprite(game,r,l,"practiceMenuSprites","Circle_Achieved");g.anchor.set(.5),this.dotsGroup.addChild(g)}else{var y=new Phaser.Sprite(game,r,l,"practiceMenuSprites","Circle_Active");y.anchor.set(.5),this.dotsGroup.addChild(y)}else f.alpha=.5}},{key:"createDotAnswered",value:function(){var e=this,t=window.MQ.posDotPractice.find(function(t){return t.num==e.countQuiz});if(void 0!==t){var n=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,"practiceMenuSprites","Circle_Active_Small");if(n.anchor.set(.5),this.dotsGroup.addChild(n),t.num>2&&t.num<8||t.num>12&&t.num<25||t.num>33&&t.num<56)(i=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,(t.y+12)*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:18})).anchor.set(.5,0),this.dotsGroup.addChild(i);else if(t.num>8&&t.num<12){(i=new Phaser.Text(game,(t.x+12)*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:18})).anchor.set(0,.5),this.dotsGroup.addChild(i)}else if(t.num>25&&t.num<33){var i;(i=new Phaser.Text(game,(t.x-12)*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:18})).anchor.set(1,.5),this.dotsGroup.addChild(i)}}this.addFlag()}},{key:"addFlag",value:function(){var e=this,t=window.MQ.posDotPractice.find(function(t){return t.num==e.highest_number_of_correct});if(void 0!==t&&this.countQuiz<t.num)if(t.x!==window.MQ.posDotPractice[0].x){if((a=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,"practiceMenuSprites","Flag_small")).anchor.set(.5),this.dotsGroup.addChild(a),t.num>2&&t.num<8||t.num>12&&t.num<25||t.num>33&&t.num<56){a.y-=3;var n=new Phaser.Text(game,(t.x-3)*window.GameConfig.RESIZE,(t.y+15)*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:15});n.anchor.set(.5,0),this.dotsGroup.addChild(n)}else if(t.num>8&&t.num<12){a.x+=5;var i=new Phaser.Text(game,(t.x+15)*window.GameConfig.RESIZE,(t.y+5)*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:15});i.anchor.set(0,.5),this.dotsGroup.addChild(i)}else if(t.num>25&&t.num<33){a.x+=5;var o=new Phaser.Text(game,(t.x-15)*window.GameConfig.RESIZE,(t.y+7)*window.GameConfig.RESIZE,"".concat(t.num),{font:"Gilroy",fill:"white",fontSize:15});o.anchor.set(1,.5),this.dotsGroup.addChild(o)}}else{var a,s=window.MQ.posCirclePractice.find(function(t){return t.num==e.highest_number_of_correct});if(void 0!==s)(a=new Phaser.Sprite(game,s.x*window.GameConfig.RESIZE,(s.y-5)*window.GameConfig.RESIZE,"practiceMenuSprites","Flag")).anchor.set(.5),this.dotsGroup.addChild(a)}}},{key:"addDotsGroup",value:function(){this.removeDotsGroup(),this.dotsGroup=new Phaser.Group(game),this.addChild(this.dotsGroup)}},{key:"removeDotsGroup",value:function(){null!==this.dotsGroup&&(this.removeChild(this.dotsGroup),this.dotsGroup.destroy(),this.dotsGroup=null)}},{key:"addAnswerGroup",value:function(){this.removeAnswerGroup(),this.groupAnswer=new Phaser.Group(game),this.addChild(this.groupAnswer),this.createFourAnswerTab(),this.addSpriteTime(),Le.instance().logEvent(Le.pro_quiz_start_solomode)}},{key:"removeAnswerGroup",value:function(){null!==this.groupAnswer&&(this.removeChild(this.groupAnswer),this.groupAnswer.destroy(),this.groupAnswer=null)}},{key:"addSpriteTime",value:function(){var e=this;this.spriteTime=new Phaser.Sprite(game,0,(game.height-531)*window.GameConfig.RESIZE,"otherSprites","tween-time"),this.spriteTime.anchor.set(0,.5),this.addChild(this.spriteTime),this.tweenSpriteTime=game.add.tween(this.spriteTime.scale).to({x:70,y:1},1e4,"Linear"),this.tweenSpriteTime.start(),this.tweenSpriteTime.onComplete.add(function(){e.timeout=!0,e.answerA.sprite.inputEnabled=!1,e.answerB.sprite.inputEnabled=!1,e.answerC.sprite.inputEnabled=!1,e.answerD.sprite.inputEnabled=!1,e.choosed||setTimeout(function(){e.createTimeoutLostPopup()},1500)})}},{key:"createFourAnswerTab",value:function(){LogConsole.log(this.question);for(var e=0;e<4;e++)0==e&&(this.answerA=new VO(game.width/2,(game.height-459+122*e)*window.GameConfig.RESIZE,{answer:this.question.answers[e],value:e+1}),this.answerA.event.chooseAnswer.add(this.onChoosedAnswered,this),this.groupAnswer.addChild(this.answerA)),1==e&&(this.answerB=new VO(game.width/2,(game.height-459+122*e)*window.GameConfig.RESIZE,{answer:this.question.answers[e],value:e+1}),this.answerB.event.chooseAnswer.add(this.onChoosedAnswered,this),this.groupAnswer.addChild(this.answerB)),2==e&&(this.answerC=new VO(game.width/2,(game.height-459+122*e)*window.GameConfig.RESIZE,{answer:this.question.answers[e],value:e+1}),this.answerC.event.chooseAnswer.add(this.onChoosedAnswered,this),this.groupAnswer.addChild(this.answerC)),3==e&&(this.answerD=new VO(game.width/2,(game.height-459+122*e)*window.GameConfig.RESIZE,{answer:this.question.answers[e],value:e+1}),this.answerD.event.chooseAnswer.add(this.onChoosedAnswered,this),this.groupAnswer.addChild(this.answerD))}},{key:"onChoosedAnswered",value:function(e){this.choosed=!0,this.answerA.sprite.inputEnabled=!1,this.answerB.sprite.inputEnabled=!1,this.answerC.sprite.inputEnabled=!1,this.answerD.sprite.inputEnabled=!1,this.answered=e.value;for(var t=0;t<4;t++)0==t&&this.setTrueFalseTabAnswer(this.answerA,t+1),1==t&&this.setTrueFalseTabAnswer(this.answerB,t+1),2==t&&this.setTrueFalseTabAnswer(this.answerC,t+1),3==t&&this.setTrueFalseTabAnswer(this.answerD,t+1);e.value==this.questions[this.countQuiz].correctAnswer?(this.setTrueAva(),ce.instance().playSound(ce.streakanswer),this.answerResult=!0,this.userChoosedCorrectAnswer()):(this.setFalseAva(),this.answerResult=!1,this.userChoosedWrongAnswer())}},{key:"setTrueFalseTabAnswer",value:function(e,t){t==this.answered?t==this.questions[this.countQuiz].correctAnswer?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerWrong():t==this.questions[this.countQuiz].correctAnswer?e.displayScreenWhenAnswerRight():e.displayScreenWhenAnswerNotChoosed()}},{key:"createTimeoutLostPopup",value:function(){if(!this.choosed){var e=new qn(this.countQuiz);e.addPopup(),e.addEventBtn(this.losePopupEvent,this),this.addChild(e),e.makeTweenPopup(),this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),li.instance().gameoverSoloMode(),li.instance().showInterstitialGameOverSoloMode()}}},{key:"userChoosedWrongAnswer",value:function(){var e=this;this.stopAudio(),setTimeout(function(){e.createLosePopup(),e.countQuiz=0},1500),this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id)}},{key:"createLosePopup",value:function(){var e=new ei(this.countQuiz);e.addPopup(),e.addEventBtn(this.losePopupEvent,this),this.addChild(e),e.makeTweenPopup(),li.instance().gameoverSoloMode(),li.instance().showInterstitialGameOverSoloMode()}},{key:"losePopupEvent",value:function(e){"RANK"==e.type?(this.stopAudio(),this.getRanking()):"HOME"==e.type?(this.stopAudio(),this.event.backToHome.dispatch()):"REPLAY"==e.type&&(this.stopAudio(),this.event.playAgain.dispatch(this.playlist))}},{key:"userChoosedCorrectAnswer",value:function(){var e=this;(this.countQuiz+=1,this.countQuiz>this.archived.achieved)?void 0!==this.rewards.filter(function(t){return t.number_question==e.countQuiz})[0]?this.sendGetNextQuestion():this.countQuiz==this.questions.length?(this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),setTimeout(function(){var t=new Di(e.questions.length,0,{name:e.playlist.name,id:e.playlist.id});t.addPopup(),t.makeTweenPopup(),t.event.goHome.add(e.doneSoloModeGoHome,e),t.event.getRank.add(e.doneSoloModeGetRank,e),e.addChild(t)},1e3)):setTimeout(function(){e.resetQuestion()},1e3):void 0!==this.rewards.filter(function(t){return t.number_question==e.countQuiz})[0]?this.sendGetNextQuestion():this.countQuiz==this.questions.length?(this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),setTimeout(function(){var t=new Di(e.questions.length,0,{name:e.playlist.name,id:e.playlist.id});t.addPopup(),t.makeTweenPopup(),t.event.goHome.add(e.doneSoloModeGoHome,e),t.event.getRank.add(e.doneSoloModeGetRank,e),e.addChild(t)},1e3)):setTimeout(function(){e.resetQuestion()},1e3)}},{key:"doneSoloModeClaim",value:function(e){this.is_watched_ads=e,this.sendSoloModeGotReward(this.countQuiz,this.playlist.id,e)}},{key:"createRewardPopup",value:function(e,t,n){var i=new mi(t,e,n);i.addPopup(),this.addChild(i),i.makeTweenPopup(),i.signalClaim.addOnce(this.onReceivedReward,this),i.signalNextQuestion.addOnce(this.onNextQuestion,this),i.signalStop.addOnce(this.onSignalStop,this)}},{key:"onSignalStop",value:function(){this.stopAudio()}},{key:"createPopupNotReward",value:function(e){this.resetQuestion()}},{key:"sendGetNextQuestion",value:function(){for(var e=this,t=this.rewards.findIndex(function(t){return t.number_question==e.countQuiz}),n=new SFS2X.SFSArray,i=0;i<this.questions.length;i++)n.addLong(this.questions[i].songEntity.id);if(this.rewards[t].number_question<56){var o=new SFS2X.SFSObject;o.putInt("playlist_id",this.playlist.id),o.putInt("next_question_number",this.rewards[t+1].number_question),o.putSFSArray("song_ids",n),TF.instance().sendData(Et.SOLO_MODE_NEXT_QUESTION_REQUEST,o)}else this.checkWhatReward()}},{key:"checkWhatReward",value:function(){var e=this,t=this.rewards.filter(function(t){return t.number_question==e.countQuiz});this.countQuiz>this.archived.achieved?(this.archived.achieved=this.countQuiz,this.gotRewardStatus=!0,this.countQuiz<this.questions.length?56!==t[0].number_question&&setTimeout(function(){e.createRewardPopup(t[0].reward,t[0].number_question,t[0].reward_type)},600):(this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),setTimeout(function(){var t=new Di(e.questions.length,e.rewards[e.rewards.length-1].reward,{name:e.playlist.name,id:e.playlist.id});t.addPopup(),t.makeTweenPopup(),t.event.goHome.add(e.doneSoloModeGoHome,e),t.event.getRank.add(e.doneSoloModeGetRank,e),t.event.claim.add(e.doneSoloModeClaim,e),t.event.stopSong.add(e.onSignalStop,e),e.addChild(t)},1e3))):this.countQuiz<this.questions.length?setTimeout(function(){e.createPopupNotReward(t[0].number_question)},600):(this.sendSoloModeFinishRequest(this.countQuiz,this.playlist.id),setTimeout(function(){var t=new Di(e.questions.length,0,{name:e.playlist.name,id:e.playlist.id});t.addPopup(),t.makeTweenPopup(),t.event.goHome.add(e.doneSoloModeGoHome,e),t.event.getRank.add(e.doneSoloModeGetRank,e),e.addChild(t)},1e3))}},{key:"onNextQuestion",value:function(){this.resetQuestion()}},{key:"onReceivedReward",value:function(e){this.is_watched_ads=e,this.sendSoloModeGotReward(this.countQuiz,this.playlist.id,e)}},{key:"sendSoloModeGotReward",value:function(e,t,n){this.archived.achieved=e;var i=new SFS2X.SFSObject;i.putInt("playlist_id",t),i.putInt("new_achieved",e),i.putInt("is_watched_ads",n),TF.instance().sendData(Et.SOLO_MODE_GOT_REWARD_REQUEST,i)}},{key:"getRanking",value:function(){this.RankingScreen=new TO,this.RankingScreen.setData([],[],this.playlist),this.addChild(this.RankingScreen),this.sendGetRankingOption()}},{key:"sendGetRankingOption",value:function(){this.sendSoloModeRanking(this.playlist.id)}},{key:"sendSoloModeRanking",value:function(e){qe.instance().showLoading(),this.sendLastWeekRanking(e),this.sendThisWeekRanking(e)}},{key:"sendLastWeekRanking",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),TF.instance().sendData(Et.SOLO_MODE_TOP10_LAST_WEEK_REQUEST,t)}},{key:"sendThisWeekRanking",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),TF.instance().sendData(Et.SOLO_MODE_TOP10_THIS_WEEK_REQUEST,t)}},{key:"setData",value:function(e,t,n,i,o){this.questions=e,this.archived=t,this.rewards=n,this.playlist=i,this.highest_number_of_correct=o}},{key:"resetQuestion",value:function(){if(this.countQuiz<this.questions.length){this.choosed=!1,this.gotRewardStatus=!1,this.addDotsGroup();for(var e=0;e<window.MQ.posAchievementPractice.length;e++)this.CreateAnswerAndDiamondText(window.MQ.posAchievementPractice[e].answerPosX*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[e].answerPosY*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[e].diamondPosX*window.GameConfig.RESIZE,window.MQ.posAchievementPractice[e].diamondPosY*window.GameConfig.RESIZE,this.rewards[e].number_question,this.rewards[e].reward,this.rewards[e].reward_type,window.MQ.posCirclePractice[e].x*window.GameConfig.RESIZE,window.MQ.posCirclePractice[e].y*window.GameConfig.RESIZE);this.createDotAnswered(),this.tweenSpriteTime.stop(),this.spriteTime.destroy(),this.answerA.destroy(),this.answerB.destroy(),this.answerC.destroy(),this.answerD.destroy(),this.removeAnswerGroup(),this.addLoadingSong()}}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.SOLO_MODE_FINISH_RESPONSE&&"OK"==e.params.getUtfString("status")&&(Le.instance().logEvent(Le.pro_quiz_end_solomode),LogConsole.log(e.params.getDump()),this.countQuiz==this.questions.length&&this.gotRewardStatus),e.cmd==Et.SOLO_MODE_GOT_REWARD_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.countQuiz,this.questions.length,this.txtGem.setText(TF.instance().socket.mySelf.getVariable("diamond").value)):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_TOP10_THIS_WEEK_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.rankingListThisWeek=[],this.posThisWeek=new IO,Bn.handleRankingList(e.params,this.rankingListThisWeek,this.posThisWeek,function(){Bn.handleTime(e.params,function(e){t.rankingThisWeek(e)})})):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_TOP10_LAST_WEEK_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.rankingListLastWeek=[],this.posLastWeek=new IO,Bn.handleRankingList(e.params,this.rankingListLastWeek,this.posLastWeek,function(){t.rankingLastWeek()})):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_NEXT_QUESTION_RESPONSE&&"OK"==e.params.getUtfString("status")&&this.handlePracticeQuestions(e.params,function(){t.checkWhatReward()})}},{key:"handlePracticeQuestions",value:function(e,t){for(var n=e.getSFSArray("questions"),i=[],o=0;o<n.size();o++){var a=n.getSFSObject(o),s=a.getUtfString("question_type"),r=a.getUtfString("answer1"),l=a.getUtfString("answer2"),h=a.getUtfString("answer3"),c=a.getUtfString("answer4"),u=a.getInt("correct_answer"),d=a.getUtfString("file_path"),f=a.getUtfString("file_path"),p=a.getSFSObject("song"),g=p.getUtfString("title"),y=p.getLong("id"),m=p.getUtfString("title"),v=p.getUtfString("author"),w=p.getSFSObject("singer").getUtfString("name");i.push({questionType:s,answers:[r,l,h,c],correctAnswer:u,songEntity:{song:g,fileName:m,author:v,singer:w,listenLink:f,id:y,fileUrl:d}})}for(var b=0;b<i.length;b++)this.questions.push(i[b]);t()}},{key:"doneSoloModeGoHome",value:function(){this.stopAudio(),this.event.backToHome.dispatch()}},{key:"doneSoloModeGetRank",value:function(){this.stopAudio(),this.getRanking()}},{key:"rankingThisWeek",value:function(e){this.RankingScreen.setRankingThisWeek(this.rankingListThisWeek,e,this.posThisWeek)}},{key:"rankingLastWeek",value:function(){this.RankingScreen.setRankingLastWeek(this.rankingListLastWeek,this.posLastWeek)}},{key:"sendSoloModeFinishRequest",value:function(e,t){var n=new SFS2X.SFSObject;n.putInt("playlist_id",t),n.putInt("number_of_correct",e),TF.instance().sendData(Et.SOLO_MODE_FINISH_REQUEST,n)}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.loadAudioSource.remove(),El.instance().removeAllSound();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&qO(n.prototype,i),o&&qO(n,o),t}();function XO(e){return(XO="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $O(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function eR(e,t){return!t||"object"!==XO(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tR(e,t,n){return(tR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=nR(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function nR(e){return(nR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iR(e,t){return(iR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oR=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=eR(this,nR(t).call(this))).screenPickAlbum=null,e.screenPlay=null,e.event={pickAlbumBack:new Phaser.Signal,playGoHome:new Phaser.Signal},e.screen=n,e.arrResource=[{type:"text",link:"img/config/positionPracticeScreenConfig.json",key:"positionPracticeScreenConfig"},{type:"text",link:"img/config/positionPracticePopupConfig.json",key:"positionPracticePopupConfig"},{type:"text",link:"img/config/positionRankingConfig.json",key:"positionRankingConfig"},{type:"spritesheet",link:"img/assetss/Animation/Timeout/TimeoutSoloMode.png",key:"timeout_practice",width:158,height:195,countFrame:24},{type:"spritesheet",link:"img/assetss/Practice/Wrong338x338.png",key:"wrong_practice",width:210,height:210,countFrame:23},{type:"spritesheet",link:"img/animations/RewardSoloMode/reward.png",key:"rewardSoloMode",width:250,height:250,countFrame:54},{type:"spritesheet",link:"img/animations/RewardSoloMode/ticketReward.png",key:"rewardTicketSoloMode",width:250,height:250,countFrame:54},{type:"spritesheet",link:"img/animations/RewardSoloMode/sptReward.png",key:"rewardSptSoloMode",width:250,height:250,countFrame:54},{type:"atlas",link:"img/atlas/soloMode.png",key:"practiceMenuSprites",linkJson:"img/atlas/soloMode.json"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iR(e,t)}(t,Mp),n=t,o=[{key:"PICK_ALBUM",get:function(){return"screen_pick_album"}},{key:"PLAY",get:function(){return"screen_play"}}],(i=[{key:"onLoadFileComplete",value:function(){this.afterInit()}},{key:"afterInit",value:function(){this.addEventExtension(),this.defineData(),this.screen==t.PICK_ALBUM&&this.sendSoloModePlaylistsRequest()}},{key:"defineData",value:function(){this.playlist={name:"",id:0},this.questions=[],this.rewardPractice=[],this.archived={}}},{key:"sendSoloModePlaylistsRequest",value:function(){qe.instance().showLoading(),this.checkRequestSocketSoloModePlaylist(),0==z.instance().isSoloModePlaylistRequest.checking?(z.instance().soloModePlaylists=[],TF.instance().sendData(Et.SOLO_MODE_PLAYLISTS_REQUEST,null),z.instance().isSoloModePlaylistRequest.checking=!0,z.instance().isSoloModePlaylistRequest.updated=Date.now()):this.doneSoloModePlaylistResponse()}},{key:"checkRequestSocketSoloModePlaylist",value:function(){1==z.instance().isSoloModePlaylistRequest.checking?0==z.instance().soloModePlaylists.length?z.instance().isSoloModePlaylistRequest.checking=!1:z.instance().isSoloModePlaylistRequest.checking=!0:z.instance().isSoloModePlaylistRequest.checking=!1}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"doneSoloModePlaylistResponse",value:function(){this.addScreenPickAlbum(),qe.instance().hideLoading()}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.SOLO_MODE_PLAYLISTS_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleSoloModePlaylistsResponse(e.params,function(){t.doneSoloModePlaylistResponse()}):console.warn(e.params.getUtfString("message"))),e.cmd==Et.SOLO_MODE_QUESTION_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleSoloModeSelectedPlaylistsResponse(e.params,function(){t.removeScreenPickAlbum(),t.updateSoloModePlaylists(z.instance().soloModePlaylists),t.addScreenPlay(),qe.instance().hideLoading()}):"WARNING"==e.params.getUtfString("status")?(IE.instance().addPopupNotEnoughResource(sE.HEART),qe.instance().hideLoading()):qe.instance().hideLoading())}},{key:"updateSoloModePlaylists",value:function(e){var t=this,n=(new Date).getTime();e.forEach(function(i,o){i.id===t.playlist.id&&(e[o].user_playlist_mapping.updated=n)})}},{key:"addScreenPickAlbum",value:function(){this.removeScreenPickAlbum(),this.screenPickAlbum=new NO,this.screenPickAlbum.addPlaylists(z.instance().soloModePlaylists),this.screenPickAlbum.addEventInputX(this.onClickPracticeBtnX,this),this.screenPickAlbum.event.pickAlbum.add(this.onChoosedAlbum,this),this.screenPickAlbum.event.refreshPickAlbum.add(this.refreshPickAlbum,this),this.addChild(this.screenPickAlbum)}},{key:"removeScreenPickAlbum",value:function(){null!==this.screenPickAlbum&&(this.removeChild(this.screenPickAlbum),this.screenPickAlbum.destroy(),this.screenPickAlbum=null)}},{key:"onClickPracticeBtnX",value:function(){this.removeScreenPickAlbum(),rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"onChoosedAlbum",value:function(e){this.playlist={name:e.name,id:e.id},this.sendSelectedPlaylistSoloMode(this.playlist.id)}},{key:"refreshPickAlbum",value:function(){this.removeScreenPickAlbum(),this.defineData(),this.sendSoloModePlaylistsRequest()}},{key:"addScreenPlay",value:function(){this.removeScreenPlay(),this.screenPlay=new JO,this.screenPlay.setData(this.questions,this.archived,this.rewardPractice,this.playlist,this.highest_number_of_correct),this.screenPlay.afterInit(),this.screenPlay.event.backToHome.add(this.screenPlayBackHome,this),this.screenPlay.event.playAgain.add(this.screenPlayPlayAgain,this),this.addChild(this.screenPlay)}},{key:"removeScreenPlay",value:function(){null!==this.screenPlay&&(this.removeChild(this.screenPlay),this.screenPlay.destroy(),this.screenPlay=null)}},{key:"screenPlayBackHome",value:function(){this.removeScreenPlay(),rF.instance().changeScreen(Ce.SOLO_MODE,t.PICK_ALBUM)}},{key:"screenPlayPlayAgain",value:function(e){this.sendSelectedPlaylistSoloMode(e.id)}},{key:"handleSoloModePlaylistsResponse",value:function(e,t){for(var n=e.getSFSArray("general_playlists"),i=0;i<n.size();i++){var o,a=n.getSFSObject(i),s=a.getUtfString("thumb"),r=a.getInt("price"),l=a.getUtfString("name"),h=a.getInt("is_general"),c=a.getInt("id"),u=a.getInt("is_owner");if(a.containsKey("user_playlist_mapping")){var d=a.getSFSObject("user_playlist_mapping");o={user_id:d.getInt("user_id"),level:d.getInt("level"),playlist_id:d.getInt("playlist_id"),created:d.getLong("created"),exp_score:d.getInt("exp_score"),active:d.getInt("active"),id:d.getLong("id"),current_level_score:d.getInt("current_level_score"),next_level_score:d.getInt("next_level_score"),updated:d.getLong("updated")}}z.instance().soloModePlaylists.push({thumb:s,price:r,name:l,is_general:h,id:c,is_owner:u,user_playlist_mapping:o})}t()}},{key:"sendSelectedPlaylistSoloMode",value:function(e){var t=new SFS2X.SFSObject;t.putInt("playlist_id",e),TF.instance().sendData(Et.SOLO_MODE_QUESTION_REQUEST,t),qe.instance().showLoading()}},{key:"handleSoloModeSelectedPlaylistsResponse",value:function(e,t){var n=e.getSFSArray("solo_mode_rewards"),i=e.getSFSArray("questions"),o=e.getSFSObject("solo_mode_archived"),a=e.getInt("highest_number_of_correct");this.handleSoloModeRewards(n),this.handlePracticeQuestions(i),this.handleSoloModeArchived(o),this.highest_number_of_correct=a,t()}},{key:"handleSoloModeArchived",value:function(e){var t=e.getInt("user_id"),n=e.getInt("playlist_id"),i=e.getInt("achieved"),o=e.getLong("id");this.archived={user_id:t,playlist_id:n,achieved:i,id:o}}},{key:"handleSoloModeRewards",value:function(e){for(var t=[],n=0;n<e.size();n++){var i=e.getSFSObject(n),o=i.getInt("id"),a=i.getInt("number_question"),s=i.getInt("reward"),r=i.getUtfString("reward_type");t.push({id:o,number_question:a,reward:s,reward_type:r})}this.rewardPractice=t}},{key:"handlePracticeQuestions",value:function(e){for(var t=[],n=0;n<e.size();n++){var i=e.getSFSObject(n),o=i.getUtfString("question_type"),a=i.getUtfString("answer1"),s=i.getUtfString("answer2"),r=i.getUtfString("answer3"),l=i.getUtfString("answer4"),h=i.getInt("correct_answer"),c=i.getUtfString("file_path"),u=i.getUtfString("file_path"),d=i.getSFSObject("song"),f=d.getUtfString("title"),p=d.getLong("id"),g=d.getUtfString("title"),y=d.getUtfString("author"),m=d.getSFSObject("singer").getUtfString("name");t.push({questionType:o,answers:[a,s,r,l],correctAnswer:h,songEntity:{song:f,fileName:g,author:y,singer:m,listenLink:u,id:p,fileUrl:c}})}this.questions=t}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this),tR(nR(t.prototype),"destroy",this).call(this)}}])&&$O(n.prototype,i),o&&$O(n,o),t}();function aR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var sR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"daily_reward_settings",get:function(){return"daily_reward_settings"}},{key:"reward",get:function(){return"reward"}},{key:"reward_type",get:function(){return"reward_type"}},{key:"id",get:function(){return"id"}},{key:"day",get:function(){return"day"}}],(n=null)&&aR(t.prototype,n),i&&aR(t,i),e}();var rR=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reward=0,this.reward_type="",this.id=0,this.day=0};function lR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var hR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"daily_reward_log",get:function(){return"daily_reward_log"}},{key:"user_id",get:function(){return"user_id"}},{key:"created",get:function(){return"created"}},{key:"state",get:function(){return"state"}},{key:"day",get:function(){return"day"}},{key:"updated",get:function(){return"updated"}}],(n=null)&&lR(t.prototype,n),i&&lR(t,i),e}();var cR=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.created=0,this.state="",this.day=0,this.updated=0};function uR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var dR=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){for(var n=e.getSFSArray(sR.daily_reward_settings),i=[],o=0;o<n.size();o++){var a=n.getSFSObject(o),s=new rR;s.reward=a.getInt(sR.reward),s.reward_type=a.getUtfString(sR.reward_type),s.id=a.getInt(sR.id),s.day=a.getInt(sR.day),i.push(s)}var r=e.getSFSObject(hR.daily_reward_log),l=new cR;l.user_id=r.getInt(hR.user_id),l.created=r.getLong(hR.created),l.state=r.getUtfString(hR.state),l.day=r.getInt(hR.day),l.updated=r.getLong(hR.updated),t(i,l)}}],(n=null)&&uR(t.prototype,n),i&&uR(t,i),e}();function fR(e){return(fR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gR(e,t){return!t||"object"!==fR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yR(e){return(yR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mR(e,t){return(mR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vR=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=gR(this,yR(t).call(this,game))).positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.event={goToShop:new Phaser.Signal,refreshMenu:new Phaser.Signal},e.inputEnabled=!0,e.outSize=!0,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mR(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.btn,this.animCircleScale,this.animButtonInOut,this.addBtn(),this.addAnimButtonInOut(),this.runAnim()}},{key:"addBtn",value:function(){this.btn=new Phaser.Sprite(game,this.positionMenuConfig.btnShop.x*window.GameConfig.RESIZE,this.positionMenuConfig.btnShop.y*window.GameConfig.RESIZE,this.positionMenuConfig.btnShop.nameAtlas,this.positionMenuConfig.btnShop.nameSprite),this.btn.anchor.set(.5),this.btn.inputEnabled=!0,this.btn.events.onInputUp.add(this.onClickBtn,this),this.txtBtn=new Phaser.Text(game,this.positionMenuConfig.txt_shop.x*window.GameConfig.RESIZE,this.positionMenuConfig.txt_shop.y*window.GameConfig.RESIZE,this.positionMenuConfig.txt_shop.text,this.positionMenuConfig.txt_shop.configs),this.txtBtn.anchor.set(.5),this.btn.addChild(this.txtBtn),this.addChild(this.btn)}},{key:"onClickBtn",value:function(){ce.instance().playSound(ce.buttonclick),this.event.goToShop.dispatch()}},{key:"addAnimCircleScale",value:function(){this.animCircleScale=new Phaser.Sprite(game,0,0,"CircleScale"),this.animCircleScale.anchor.set(.5),this.btn.addChild(this.animCircleScale)}},{key:"addAnimButtonInOut",value:function(){this.animButtonInOut=new Phaser.Sprite(game,0,0,"ButtonShop"),this.animButtonInOut.anchor.set(.5),this.btn.addChild(this.animButtonInOut)}},{key:"runAnim",value:function(){this.animButtonInOut.animations.add("run_anim_button");this.animButtonInOut.animations.play("run_anim_button",25,!0)}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){}},{key:"scrollChange",value:function(){this.txtBtn.kill(),game.add.tween(this.btn).to({y:65},150,"Linear",!0).start(),1==this.isGift&&this.animCircleScale.animations.stop("run_scale_circle",!0)}},{key:"scrollDefault",value:function(){this.txtBtn.revive(),game.add.tween(this.btn).to({y:this.positionMenuConfig.btnGift.y*window.GameConfig.RESIZE},150,"Linear",!0).start(),1==this.isGift&&this.animCircleScale.animations.play("run_scale_circle",30,!0)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&pR(n.prototype,i),o&&pR(n,o),t}();function wR(e){return(wR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _R(e,t){return!t||"object"!==wR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SR(e){return(SR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ER(e,t){return(ER=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CR=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=_R(this,SR(t).call(this,game,0,0,"bg_create_room"))).btnShop=null,e.btnEvent=null,e.btnQuest=null,e.btnRanking=null,e.btnFindGame=null,e.btnPractice=null,e.btnParty=null,e.userProfile=null,e.scrollList=null,e.navBar=null,e.event={goToFindGame:new Phaser.Signal,goToTurnBasePlay:new Phaser.Signal,goToParty:new Phaser.Signal,goToSoloMode:new Phaser.Signal,goToGift:new Phaser.Signal,goToEvent:new Phaser.Signal,refreshMenu:new Phaser.Signal},e.playScript=JSON.parse(game.cache.getText("playScript")),e.positionMenuConfig=JSON.parse(game.cache.getText("positionMenuConfig")),e.afterInit(),e}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ER(e,t)}(t,Phaser.Sprite),n=t,(o=[{key:"afterInit",value:function(){Le.instance().logEvent(Le.Main_menu),this.addEventExtension(),this.user={avatar:TF.instance().dataMySeft.avatar,user_name:TF.instance().dataMySeft.user_name},this.layoutMenu=new Phaser.Sprite(game,0,0,null),this.addChild(this.layoutMenu),this.bgFake=new HE("bg_scrollMenu"),this.layoutMenu.addChild(this.bgFake),this.layoutMain=new Phaser.Sprite(game,0,0,null),this.layoutMenu.addChild(this.layoutMain),this.layoutNavBar=new Phaser.Sprite(game,0,0,null),this.addChild(this.layoutNavBar),this.addBtnFindGame(),this.addBtnPractice(),this.addBtnParty(),this.setAnimButtonModeGame(),this.addBtnGift(),this.addBtnQuest(),this.addBtnEvent(),this.addBtnRanking(),this.addUserProfile(),this.addNavBar(),this.addScollList(),this.sendRequestMenuChallenges(),this.sendRequestToCache(),this.bgFake.event.refreshMenu.add(this.refreshMenu,this),this.bgFake.event.scrollChange.add(this.scrollChange,this),this.bgFake.event.scrollDefault.add(this.scrollDefault,this),this.bgFake.event.scrollList.add(this.scrollListEvent,this)}},{key:"sendRequestToCache",value:function(){}},{key:"scrollListEvent",value:function(e){this.scrollList&&this.scrollList.scrollEventResponse(e)}},{key:"refreshMenu",value:function(){rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"scrollChange",value:function(){this.btnShop.scrollChange(),this.btnQuest.scrollChange(),this.btnEvent.scrollChange(),this.btnRanking.scrollChange(),this.btnFindGame.setPosY(225),this.btnParty.setPosY(225),this.btnPractice.setPosY(225),this.layoutMain.addChild(this.btnFindGame),this.layoutMain.addChild(this.btnParty),this.layoutMain.addChild(this.btnPractice),this.userProfile.scrollChange()}},{key:"scrollDefault",value:function(){this.btnShop.scrollDefault(),this.btnQuest.scrollDefault(),this.btnEvent.scrollDefault(),this.btnRanking.scrollDefault(),this.btnFindGame.setPosYDefault(this.positionMenuConfig.btn_findgame.y*window.GameConfig.RESIZE),this.btnParty.setPosYDefault(this.positionMenuConfig.btn_party.y*window.GameConfig.RESIZE),this.btnPractice.setPosYDefault(this.positionMenuConfig.btn_practice.y*window.GameConfig.RESIZE),this.bgFake.addChild(this.btnParty),this.bgFake.addChild(this.btnPractice),this.bgFake.addChild(this.btnFindGame),this.userProfile.scrollDefault()}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),TF.instance().events.onUserVarsUpdate.add(this.onUpdateUserVars,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),TF.instance().events.onUserVarsUpdate.remove(this.onUpdateUserVars,this),this.bgFake.event.refreshMenu.remove(this.refreshMenu,this),this.bgFake.event.scrollChange.remove(this.scrollChange,this),this.bgFake.event.scrollDefault.remove(this.scrollDefault,this)}},{key:"sendRequestMenuChallenges",value:function(){null==z.instance().menuLoadResponses?TF.instance().sendDataGetMenu(Et.MAIN_MENU_LOAD_REQUEST,"MAIN_MENU_LOAD_REQUEST"):(this.checkRequestSocketMainMenuCheck(),0==z.instance().isRefreshMenu.checking?(qe.instance().hideLoading(),TF.instance().sendData(Et.MAIN_MENU_CHECK_UPDATE_REQUEST,null),this.scrollList.displayListChallenge(),this.bgFake.addChildren(this.scrollList),this.refreshButNotRefresh(),z.instance().isRefreshMenu.checking=!0,z.instance().isRefreshMenu.updated=Date.now()):(qe.instance().hideLoading(),this.scrollList.displayListChallenge(),this.bgFake.addChildren(this.scrollList),this.refreshButNotRefresh()),1==z.instance().isScrollChange?this.scrollChange():this.scrollDefault())}},{key:"checkRequestSocketMainMenuCheck",value:function(){1==z.instance().isRefreshMenu.checking?Date.now()-z.instance().isRefreshMenu.updated<6e3?z.instance().isRefreshMenu.checking=!0:z.instance().isRefreshMenu.checking=!1:z.instance().isRefreshMenu.checking=!1}},{key:"setAnimButtonModeGame",value:function(){var e=this,t=1;this.timeLoopAnim=game.time.create(!0),this.timeLoopAnim.loop(8*Phaser.Timer.SECOND,function(){1==t?e.btnFindGame.startAnim():2==t?e.btnParty.startAnim():3==t&&e.btnPractice.startAnim(),4==++t&&(t=1)},this),this.timeLoopAnim.start()}},{key:"addBtnEvent",value:function(){this.removeBtnEvent(),this.btnEvent=new HC,this.btnEvent.event.gotToEvent.add(this.onClickEventMode,this),this.layoutMain.addChild(this.btnEvent)}},{key:"onClickEventMode",value:function(){rF.instance().changeScreen(Ce.EVENT_MODE)}},{key:"removeBtnEvent",value:function(){null!==this.btnEvent&&(this.removeChild(this.btnEvent),this.btnEvent.destroy(),this.btnEvent=null)}},{key:"addBtnRanking",value:function(){this.removeBtnRanking(),this.btnRanking=new NC,this.btnRanking.btn.events.onInputUp.add(this.onClickRanking,this),this.layoutMain.addChild(this.btnRanking)}},{key:"onClickRanking",value:function(){ce.instance().playSound(ce.buttonclick),rF.instance().changeScreen(Ce.RANKING_ALL)}},{key:"removeBtnRanking",value:function(){null!==this.btnRanking&&(this.removeChild(this.btnRanking),this.btnRanking.destroy(),this.btnRanking=null)}},{key:"addBtnFindGame",value:function(){this.removeBtnFindGame(),this.btnFindGame=new zE,this.btnFindGame.event.onClickFindGame.add(this.onClickFindGame,this)}},{key:"onClickFindGame",value:function(){rF.instance().changeScreen(Ce.TURN_BASE)}},{key:"removeBtnFindGame",value:function(){null!==this.btnFindGame&&(this.removeChild(this.btnFindGame),this.btnFindGame.destroy(),this.btnFindGame=null)}},{key:"addBtnGift",value:function(){this.removeBtnGift(),this.btnShop=new vR,this.btnShop.event.goToShop.add(this.onShopBtnInput,this),this.btnShop.event.refreshMenu.add(this.refreshMenu,this),this.layoutMain.addChild(this.btnShop)}},{key:"removeBtnGift",value:function(){null!==this.btnShop&&(this.removeChild(this.btnShop),this.btnShop.destroy(),this.btnShop=null)}},{key:"onGiftBtnInput",value:function(e){this.hours_reward_setting=e,this.userProfile.claimHourReward(this.hours_reward_setting)}},{key:"onShopBtnInput",value:function(){IE.instance().addShop(0)}},{key:"onShared",value:function(e){e.hasOwnProperty(error_code)||this.sendShareResult()}},{key:"sendShareResult",value:function(){TF.instance().sendData(Et.FB_USER_SHARED_RESULT_REQUEST,null)}},{key:"addBtnParty",value:function(){this.removeBtnParty(),this.btnParty=new rC,this.btnParty.event.goToParty.add(this.goToParty,this)}},{key:"removeBtnParty",value:function(){null!==this.btnParty&&(this.removeChild(this.btnParty),this.btnParty.destroy(),this.btnParty=null)}},{key:"goToParty",value:function(){rF.instance().changeScreen(Ce.ONLINE_MODE)}},{key:"addBtnPractice",value:function(){this.removeBtnPractice(),this.btnPractice=new tC,this.btnPractice.event.onClickPractice.add(this.onClickPracticeBtn,this)}},{key:"removeBtnPractice",value:function(){null!==this.btnPractice&&(this.removeChild(this.btnPractice),this.btnPractice.destroy(),this.btnPractice=null)}},{key:"onClickPracticeBtn",value:function(){rF.instance().changeScreen(Ce.SOLO_MODE,oR.PICK_ALBUM)}},{key:"addBtnQuest",value:function(){this.removeBtnQuest(),this.btnQuest=new IC,this.btnQuest.btn.events.onInputUp.add(this.onClickQAndA,this),this.layoutMain.addChild(this.btnQuest)}},{key:"onClickQAndA",value:function(){ce.instance().playSound(ce.buttonclick),rF.instance().changeScreen(Ce.QUEST_ACHIEVEMENT,2)}},{key:"removeBtnQuest",value:function(){null!==this.btnQuest&&(this.removeChild(this.btnQuest),this.btnQuest.destroy(),this.btnQuest=null)}},{key:"addNavBar",value:function(){this.removeNavBar(),this.navBar=new MP,this.navBar.createButtonOnNavigation(),this.navBar.event.backMenu.add(this.backMenu,this),this.navBar.event.changeOtherScreen.add(this.changeOtherScreen,this),this.layoutNavBar.addChild(this.navBar)}},{key:"backMenu",value:function(){rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"changeOtherScreen",value:function(){if(this.layoutMenu.x!==-game.width-300){console.log("YSYSYF");var e=game.add.tween(this.layoutMenu).to({x:-game.width-300},500,"Linear",!0);e.start(),e.onComplete.add(function(){},this)}}},{key:"removeNavBar",value:function(){null!==this.navBar&&(this.removeChild(this.navBar),this.navBar.destroy(),this.navBar=null)}},{key:"addUserProfile",value:function(){this.removeUserProfile(),this.userProfile=new zC,this.userProfile.event.claimHourRewardDone.add(this.claimHourRewardDone,this),this.layoutMain.addChild(this.userProfile)}},{key:"claimHourRewardDone",value:function(){this.userProfile.event.claimHourRewardDone.remove(this.claimHourRewardDone,this),rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"removeUserProfile",value:function(){null!==this.userProfile&&(this.layoutMain.removeChild(this.userProfile),this.userProfile.destroy(),this.userProfile=null)}},{key:"addScollList",value:function(){this.removeScrollList(),this.scrollList=new kC,this.scrollList.event.playGame.add(this.onPlayGameScrollList,this),this.scrollList.event.nudgeFriend.add(this.nudgeFriend,this),this.scrollList.event.deleteChallenge.add(this.deleteChallenge,this)}},{key:"removeScrollList",value:function(){null!==this.scrollList&&(this.removeChild(this.scrollList),this.scrollList.destroy(),this.scrollList=null)}},{key:"onPlayGameScrollList",value:function(e){rF.instance().changeScreen(Ce.TURN_BASE,e)}},{key:"nudgeFriend",value:function(e){var t=new SFS2X.SFSObject;t.putInt("opponent_id",e.opponentEntity.id),TF.instance().sendData(Et.POKE_USER_REQUEST,t)}},{key:"deleteChallenge",value:function(e){if(e.length>0){var t=new SFS2X.SFSArray;for(i=0;i<e.length;i++)t.addInt(e[i]);var n=new Gc("Bạn có muốn xóa lời thách đấu này không?");n.event.CANCLE.add(function(){n.destroy()},this),n.event.OK.add(function(){n.destroy(),qe.instance().showLoading();var e=new SFS2X.SFSObject;e.putSFSArray("opponent_ids",t),TF.instance().sendData(Et.TURNBASE_DELETE_GAME_REQUEST,e)},this),IE.instance().addChild(n)}}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.MAIN_MENU_LOAD_RESPONSE&&(qe.instance().hideLoading(),this.scrollList.handleMainMenuLoadResponse(e.params,1,function(e,n,i,o,a,s){z.instance().menuLoadResponses=e,t.scrollList.displayListChallenge(),t.bgFake.addChildren(t.scrollList),t.bgFake.addChild(t.btnParty),t.bgFake.addChild(t.btnPractice),t.bgFake.addChild(t.btnFindGame),1==z.instance().isScrollChange?t.scrollChange():t.scrollDefault(),z.instance().new_friend_request_count=i,z.instance().started_event_count=o,z.instance().hoursReward=a,z.instance().playScript=s,z.instance().init_quests_count=n,t.btnQuest.addDotNoti(z.instance().init_quests_count),t.btnEvent.addDotNoti(z.instance().started_event_count),t.navBar.addFriendRequest(z.instance().new_friend_request_count),z.instance().playScript.playing_guide==en.INIT&&rF.instance().changeScreen(Ce.TURN_BASE,{opponent:t.playScript.demoData.opponent,type:Qp.TUTORIAL}),z.instance().playScript.playing_guide==en.DONE_TURNBASE&&t.addChild(en.instance()),z.instance().playScript.playing_guide==en.DONE_GET_QUEST&&(t.PlayScriptScreen=new en,t.PlayScriptScreen.addStep8AcceptChallenge(),t.PlayScriptScreen.event.step8.add(t.acceptChallenge,t),t.addChild(t.PlayScriptScreen))})),e.cmd==Et.DAILY_REWARD_NOTIFICATION&&dR.begin(e.params,function(e,t){LogConsole.log(e),LogConsole.log(t),setTimeout(function(){IE.instance().changeScreen(Ce.DAILY_REWARD,{dailyRewardSettings:e,dailyRewardLog:t})},500)}),e.cmd==Et.POKE_USER_RESPONSE&&"OK"==e.params.getUtfString("status")&&rF.instance().changeScreen(Ce.MAIN_MENU),e.cmd==Et.TURNBASE_DELETE_GAME_RESPONSE&&("OK"==e.params.getUtfString("status")?(qe.instance().hideLoading(),rF.instance().changeScreen(Ce.MAIN_MENU)):qe.instance().hideLoading()),e.cmd==Et.PLAY_SCRIPT_DONE_ALL_RESPONSE&&"OK"==e.params.getUtfString("status")&&(z.instance().playScript.playing_guide=en.DONE_ALL,en.instance().destroy(),rF.instance().changeScreen(Ce.MAIN_MENU)),e.cmd==Et.MAIN_MENU_CHECK_UPDATE_RESPONSE&&"OK"==e.params.getUtfString("status")&&(Bn.handleCheckUpdateMainMenu(e.params,function(e,n,i,o,a){z.instance().init_quests_count=e,z.instance().new_friend_request_count=n,z.instance().started_event_count=i,z.instance().hoursReward=o,z.instance().playScript=a,t.refreshButNotRefresh()}),1==z.instance().isScrollChange?this.scrollChange():this.scrollDefault())}},{key:"refreshButNotRefresh",value:function(){this.btnQuest.addDotNoti(z.instance().init_quests_count),this.btnEvent.addDotNoti(z.instance().started_event_count),this.navBar.addFriendRequest(z.instance().new_friend_request_count),z.instance().playScript.playing_guide==en.INIT&&rF.instance().changeScreen(Ce.TURN_BASE,{opponent:this.playScript.demoData.opponent,type:Qp.TUTORIAL}),z.instance().playScript.playing_guide==en.DONE_TURNBASE&&this.addChild(en.instance()),z.instance().playScript.playing_guide==en.DONE_GET_QUEST&&(this.PlayScriptScreen=new en,this.PlayScriptScreen.addStep8AcceptChallenge(),this.PlayScriptScreen.event.step8.add(this.acceptChallenge,this),this.addChild(this.PlayScriptScreen))}},{key:"acceptChallenge",value:function(){this.scrollList.acceptChallengeBot()}},{key:"onUpdateUserVars",value:function(){this.user.avatar!==TF.instance().dataMySeft.avatar&&(this.user.avatar=TF.instance().dataMySeft.avatar,this.addUserProfile()),this.user.user_name!==TF.instance().dataMySeft.user_name&&(this.user.user_name=TF.instance().dataMySeft.user_name,this.userProfile.updateValue(zC.UPDATE_NAME))}},{key:"removeAllChild",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.timeLoopAnim.stop(),this.timeLoopAnim.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&bR(n.prototype,o),a&&bR(n,a),t}();function kR(e){return(kR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OR(e,t,n){return(OR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=RR(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function RR(e){return(RR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xR(e,t){return(xR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function TR(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var IR=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=RR(t).call(this,game,0,0,null))||"object"!==kR(i)&&"function"!=typeof i?TR(n):i).event={back:new Phaser.Signal,search:new Phaser.Signal},e.bg=new rt(e.mainData.positionCreateRoom.bg_header),e.addChild(e.bg),e.btnBack=new pt(e.mainData.positionCreateRoom.button_back,e.chooseBack,TR(TR(e))),e.addChild(e.btnBack),e.txtTitle=null,e.btnDiamond=null,e.txtIdPhong=null,e.txtNguoiTao=null,e.btnSearch=null,e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xR(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBackButton,this),TF.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this)}},{key:"removeEvent",value:function(){LogConsole.log("removeEvent HEADER"),De.instance().event.backButton.remove(this.chooseBackButton,this),TF.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this)}},{key:"onUserVarsUpdate",value:function(e){null!==this.btnDiamond&&this.btnDiamond.setText(TF.instance().dataMySeft.diamond)}},{key:"chooseBackButton",value:function(){this.chooseBack(!0)}},{key:"setHideBtnBack",value:function(){this.btnBack.visible=!1}},{key:"setShowBtnBack",value:function(){this.btnBack.visible=!0}},{key:"chooseBack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.btnBack.inputEnabled=!1,LogConsole.log("chooseBack header"),this.event.back.dispatch(e)}},{key:"chooseSearch",value:function(){this.event.search.dispatch()}},{key:"setSearchButton",value:function(){this.btnSearch=new pt(this.mainData.positionCreateRoom.button_search,this.chooseSearch,this),this.addChild(this.btnSearch)}},{key:"setTitle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"CHƠI NHÓM";this.txtTitle=new _t(this.mainData.positionCreateRoom.txt_title_header,e),this.txtTitle.setTextBounds(0,0,game.width,this.bg.height*z.instance().scale),this.addChild(this.txtTitle)}},{key:"setDiamond",value:function(){this.btnDiamond=new ln(this.mainData.positionCreateRoom.btn_diamond_header,TF.instance().dataMySeft.diamond),this.addChild(this.btnDiamond)}},{key:"setWaittingRoom",value:function(){this.txtIdPhong=new _t(this.mainData.positionCreateRoom.waitting_txt_idphong,"Phòng chơi: sadfdsfds"),this.txtIdPhong.setTextBounds(0,0,game.width,44*z.instance().scale),this.addChild(this.txtIdPhong),this.txtNguoiTao=new _t(this.mainData.positionCreateRoom.waitting_txt_nguoitao,"Người tạo: hahahah"),this.txtNguoiTao.setTextBounds(0,0,game.width,28*z.instance().scale),this.addChild(this.txtNguoiTao)}},{key:"setIdPhong",value:function(e){null!==this.txtIdPhong&&(this.txtIdPhong.text="Phòng chơi: "+e)}},{key:"setNguoiTao",value:function(e){null!==this.txtNguoiTao&&(this.txtNguoiTao.text="Người tạo: "+e,this.txtNguoiTao.addColor("#FFA339",10))}},{key:"setStyleTitle",value:function(e){null!==this.txtTitle&&this.txtTitle.changeStyle(e)}},{key:"destroy",value:function(){this.removeEvent(),OR(RR(t.prototype),"destroy",this).call(this)}}])&&PR(n.prototype,i),o&&PR(n,o),t}();function AR(e){return(AR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GR(e,t){return!t||"object"!==AR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DR(e,t,n){return(DR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=MR(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function MR(e){return(MR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NR(e,t){return(NR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var BR=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),GR(this,MR(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NR(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={close:new Phaser.Signal,create_room:new Phaser.Signal,quick_play:new Phaser.Signal},this.positionCreateRoom=JSON.parse(game.cache.getText("positionCreateRoom")),this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg),this.header=new IR,this.header.setTitle(),this.header.event.back.add(this.chooseBack,this),this.addChild(this.header),this.txtTimPhong=new _t(this.mainData.positionCreateRoom.choose_game_text_timphong,"Tìm phòng"),this.addChild(this.txtTimPhong),this.btnInputText=new ca(this.mainData.positionCreateRoom.choose_game_bg_input_text,"Nhập id phòng...",this.chooseInputText,this),this.addChild(this.btnInputText),this.btnThamgia=new ln(this.mainData.positionCreateRoom.choose_game_btn_thamgia,"THAM GIA",this.chooseThamGia,this),this.addChild(this.btnThamgia),this.line=new rt(this.mainData.positionCreateRoom.choose_game_bg_line),this.addChild(this.line),this.btnChoiNgay=new ln(this.mainData.positionCreateRoom.choose_game_btn_choingay,"CHƠI NHANH",this.chooseQuickPlay,this),this.addChild(this.btnChoiNgay),this.btnTaoPhong=new ln(this.mainData.positionCreateRoom.choose_game_btn_taophong,"TẠO PHÒNG",this.chooseCreateRoom,this),this.addChild(this.btnTaoPhong),Le.instance().logEvent(Le.Party_online_mode),qe.instance().hideLoading(),!1===li.instance().showInterstitialCreateRoom()&&!1===li.instance().showInterstitialQuickPlay()&&li.instance().showBanerPartyModeScreen(),this.addEvent()}},{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this)}},{key:"chooseBack",value:function(){LogConsole.log("chooseCreateRoom--------"),this.onCancel(),z.instance().state="",this.event.close.dispatch()}},{key:"chooseQuickPlay",value:function(){LogConsole.log("chooseCreateRoom--------"),this.onCancel(),this.event.quick_play.dispatch()}},{key:"chooseCreateRoom",value:function(){LogConsole.log("chooseCreateRoom--------"),this.onCancel(),this.event.create_room.dispatch()}},{key:"chooseThamGia",value:function(){""===$r.instance().getValue()?(IE.instance().addDialog("Chưa nhập id phòng"),this.onCancel()):this.enterKeyBoard()}},{key:"chooseInputText",value:function(){var e={maxLength:"",showTransparent:!0,placeholder:"Nhập id phòng",isSearch:!1,typeInputText:"input",configText:{width:this.btnInputText.width,height:this.btnInputText.height,x:this.btnInputText.x,y:this.btnInputText.y},inputType:"number"};$r.instance().show(e),$r.instance().event.change.add(this.changeKeyBoard,this),$r.instance().event.hideKeyboard.add(this.hideKeyboard,this),$r.instance().event.enter.add(this.enterKeyBoard,this),$r.instance().event.submit.add(this.enterKeyBoard,this),$r.instance().event.cancle.add(this.onCancel,this)}},{key:"hideKeyboard",value:function(){$r.instance().hide()}},{key:"onCancel",value:function(){this.btnInputText.visible=!0,$r.instance().event.change.remove(this.changeKeyBoard,this),$r.instance().event.hideKeyboard.remove(this.hideKeyboard,this),$r.instance().event.enter.remove(this.enterKeyBoard,this),$r.instance().event.submit.remove(this.enterKeyBoard,this),$r.instance().event.cancle.remove(this.onCancel,this),$r.instance().hide()}},{key:"changeKeyBoard",value:function(){LogConsole.log("changeKeyBoard")}},{key:"enterKeyBoard",value:function(){var e=parseInt($r.instance().getValue());""!==e?isNaN(e)?IE.instance().addDialog("Id phòng không hợp lệ"):TF.instance().sendData(nS.ONLINE_MODE_ROOM_QUICK_JOIN_REQUEST,eS.begin(parseInt(e))):IE.instance().addDialog("Id phòng không hợp lệ"),this.onCancel()}},{key:"destroy",value:function(){this.removeEvent(),this.header.destroy(),this.onCancel(),li.instance().hideBanner(),DR(MR(t.prototype),"destroy",this).call(this)}}])&&LR(n.prototype,i),o&&LR(n,o),t}();function jR(e){return(jR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function FR(e,t){return!t||"object"!==jR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZR(e){return(ZR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HR(e,t){return(HR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var QR=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),FR(this,ZR(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HR(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={choose_bet:new Phaser.Signal},this.data=null,this.positionCreateRoom=this.mainData.positionCreateRoom,this.bg=new rt(this.positionCreateRoom.choose_bet_bg_item_bet),this.addChild(this.bg),this.iconGem=new rt(this.positionCreateRoom.choose_bet_icon_gem_item_bet),this.addChild(this.iconGem),this.txtMoneyBet=new _t(this.positionCreateRoom.choose_bet_txtmoney_item_bet,"0"),this.txtMoneyBet.setTextBounds(0,0,104*z.instance().scale,32*z.instance().scale),this.addChild(this.txtMoneyBet),this.txtMuccuoc=new _t(this.positionCreateRoom.choose_bet_label_mucuoc_item_bet,"Mức cược"),this.txtMuccuoc.setTextBounds(0,0,150*z.instance().scale,35*z.instance().scale),this.addChild(this.txtMuccuoc),this.btnChoose=new ln(this.positionCreateRoom.choose_bet_btnchon_item_bet,"CHỌN",this.chooseBet,this),this.addChild(this.btnChoose)}},{key:"chooseBet",value:function(){LogConsole.log("chooseBet-OnlineModeChooseBetItem"),TF.instance().dataMySeft.diamond<this.data.bet_place?IE.instance().addDialog("Bạn không đủ Diamond."):(this.btnChoose.inputEnabled=!1,this.event.choose_bet.dispatch(this.data))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e,t){this.data=e,this.txtMoneyBet.text=this.data.bet_place,this.x=game.width,game.add.tween(this).to({x:0},200,Phaser.Easing.Power1,!0,100+150*(t+1))}},{key:"width",get:function(){return this.game.width}},{key:"height",get:function(){return this.bg.height}}])&&UR(n.prototype,i),o&&UR(n,o),t}();function VR(e){return(VR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WR(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qR(e,t){return!t||"object"!==VR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function KR(e,t,n){return(KR="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=zR(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function zR(e){return(zR=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function YR(e,t){return(YR=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var JR=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qR(this,zR(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YR(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={back:new Phaser.Signal,choose_bet:new Phaser.Signal},qe.instance().showLoading(),this.arrBet=[],this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg),this.txtChonMucCuoc=new _t(this.mainData.positionCreateRoom.choose_bet_label_chonmucuoc,"CHỌN MỨC CƯỢC"),this.txtChonMucCuoc.setTextBounds(0,0,game.width,72*z.instance().scale),this.addChild(this.txtChonMucCuoc);var e=new Phaser.Group(game,0,0,null);this.listBet=new Vo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-235*z.instance().scale),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),e.x=0,e.y=230*z.instance().scale,this.addChild(e),this.header=new IR,this.header.setDiamond(),this.header.event.back.add(this.chooseBack,this),this.addChild(this.header)}},{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),TF.instance().events.onExtensionResponse.add(this.getData,this),Ur.instance().event.load_online_mode_room_bet_complete.add(this.buildDataRoomBet,this),!0===Ur.instance().ktLoadOnlineModeRoomBet?this.buildDataRoomBet():Ur.instance().sendGetOnlineModeRoomBet(),li.instance().showBanerChooseBettingCreateRoomScreen()}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),TF.instance().events.onExtensionResponse.remove(this.getData,this),Ur.instance().event.load_online_mode_room_bet_complete.remove(this.buildDataRoomBet,this)}},{key:"buildDataRoomBet",value:function(){this.arrBet=Ur.instance().createroom_bet_setting,this.addListBet(),qe.instance().hideLoading()}},{key:"getData",value:function(e){switch(e.cmd){case nS.ONLINE_MODE_ROOM_LOAD_BET_RESPONSE:}}},{key:"addListBet",value:function(){this.listBet.removeAll(),this.listBet.reset();for(var e=0;e<this.arrBet.length;e++){var t=new QR;t.event.choose_bet.add(this.chooseBet,this),t.setData(this.arrBet[e],e),this.listBet.add(t)}}},{key:"chooseBet",value:function(e){LogConsole.log("choose_bet"),TF.instance().dataMySeft.diamond<this.betMoney?IE.instance().addDialogConfirnMoney("Bạn không đủ kim cương tạo phòng, bạn có muốn nạp thêm?"):this.event.choose_bet.dispatch(e.id,e.bet_place)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listBet.removeAll(),this.listBet.destroy(),li.instance().hideBanner(),KR(zR(t.prototype),"destroy",this).call(this)}}])&&WR(n.prototype,i),o&&WR(n,o),t}();function XR(e){return(XR="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $R(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ex(e,t){return!t||"object"!==XR(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function tx(e){return(tx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nx(e,t){return(nx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ix=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ex(this,tx(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nx(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={buy:new Phaser.Signal,select:new Phaser.Signal},this.data=null,this.positionCreateRoom=this.mainData.positionCreateRoom,this.ava=new dh,this.ava.x=33*z.instance().scale,this.ava.y=16*z.instance().scale,this.ava.setSize(107*z.instance().scale,107*z.instance().scale),this.addChild(this.ava),this.txtName=new _t(this.positionCreateRoom.choose_playlist_itemplaylist_txtname,""),this.txtName.setTextBounds(0,0,305*z.instance().scale,66*z.instance().scale),this.addChild(this.txtName),this.txtVip=new _t(this.positionCreateRoom.choose_playlist_itemplaylist_vip,""),this.txtVip.setTextBounds(0,0,305*z.instance().scale,28*z.instance().scale),this.level=new Ch,this.level.x=this.positionCreateRoom.choose_playlist_itemplaylist_vip.x*z.instance().scale,this.level.y=this.positionCreateRoom.choose_playlist_itemplaylist_vip.y*z.instance().scale,this.addChild(this.level),this.btnBuy=null,this.line=new rt(this.positionCreateRoom.choose_playlist_itemplaylist_line),this.addChild(this.line)}},{key:"setButtonBuy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.removeBtnBuy(),this.btnBuy=new ln(this.positionCreateRoom.choose_playlist_itemplaylist_btnBuy,e,this.chooseBuy,this),this.addChild(this.btnBuy),this.line.visible=!1}},{key:"removeBtnBuy",value:function(){null!==this.btnBuy&&(this.removeChild(this.btnBuy),this.btnBuy.destroy(),this.btnBuy=null)}},{key:"setButtonChoose",value:function(){this.removeBtnBuy(),this.btnBuy=new ln(this.positionCreateRoom.choose_playlist_itemplaylist_select,"Chọn",this.chooseSelect,this),this.addChild(this.btnBuy)}},{key:"setDataQuickPlay",value:function(e,t){this.data=e,this.ava.beginLoad(this.data.thumb,t),this.txtName.text=this.data.name,1==this.data.is_owner?this.setButtonChoose():this.setButtonBuy(this.data.price),this.level.visible=!0,this.level.setData(this.data.user),t<8?(this.x=game.width,game.add.tween(this).to({x:0},200,Phaser.Easing.Power1,!0,250+50*(t+1))):this.x=0}},{key:"setData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.data=e,this.ava.beginLoad(this.data.thumb,t),this.txtName.text=this.data.name,!1===n?(this.level.visible=!0,this.level.setData(this.data.user),t<8?(this.x=game.width,game.add.tween(this).to({x:0},200,Phaser.Easing.Power1,!0,250+50*(t+1))):this.x=0):this.level.visible=!1}},{key:"chooseBuy",value:function(){LogConsole.log("chooseBuy"),null!=this.data&&IE.instance().addPopupBuy(this.data)}},{key:"chooseSelect",value:function(){LogConsole.log("chooseSelect"),this.btnBuy.inputEnabled=!1,Ur.instance().playlist.setUpdateTimePlaylistById(this.data.id),this.event.select.dispatch(this.data)}},{key:"width",get:function(){return 640*z.instance().scale}},{key:"height",get:function(){return 145*z.instance().scale}}])&&$R(n.prototype,i),o&&$R(n,o),t}();function ox(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var ax=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("playlist_id",e),LogConsole.log(t.getDump()),t}}],(n=null)&&ox(t.prototype,n),i&&ox(t,i),e}();function sx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var rx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){var n=new SFS2X.SFSObject;return n.putInt("playlist_id",e),n.putInt("bet_id",t),n}}],(n=null)&&sx(t.prototype,n),i&&sx(t,i),e}();function lx(e){return(lx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cx(e,t){return!t||"object"!==lx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ux(e,t,n){return(ux="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dx(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dx(e){return(dx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fx(e,t){return(fx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var px=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cx(this,dx(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fx(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){qe.instance().showLoading(),this.shopPlayList=null,this.isMaster=!1,this.betId=-1,this.betMoney=0,this.idx=0,this.countItem=0,this.ktBuild=!0,this.idDelay=null,this.positionCreateRoom=this.mainData.positionCreateRoom,this.event={back:new Phaser.Signal,create_room:new Phaser.Signal},this.arrPlayList=[],this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new Phaser.Group(game,0,0,null);this.listPlayerlist=new Vo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-395*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),this.listPlayerlist.events.changeIndex.add(this.changeIndex,this),e.x=0,e.y=240*z.instance().scale,this.addChild(e),this.header=new IR,this.header.setTitle("CHỌN PLAYLIST"),this.header.event.back.add(this.chooseBack,this),this.addChild(this.header),this.bgSuggestPlayList=new Zt(this.positionCreateRoom.choose_playlist_itemplaylist_bg),this.addChild(this.bgSuggestPlayList),this.bgSuggestPlayList.x=game.width,this.playlistSuggest=new ix,this.playlistSuggest.setButtonBuy(200),this.playlistSuggest.y=this.positionCreateRoom.choose_playlist_itemplaylist_bg.y*z.instance().scale,this.addChild(this.playlistSuggest),this.playlistSuggest.x=game.width,this.btnBuyMore=new ln(this.positionCreateRoom.choose_playlist_btn_muathemplaylist,"MUA THÊM PLAYLIST",this.chooseBuyMore,this),this.btnBuyMore.y=game.height-120*z.instance().scale,this.btnBuyMore.x=(game.width-this.btnBuyMore.width)/2,this.addChild(this.btnBuyMore),this.btnBuyMore.y=game.height,game.add.tween(this.btnBuyMore).to({y:game.height-120*z.instance().scale},150,Phaser.Easing.Power1,!0,300)}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),Ur.instance().event.buy_playlist.add(this.playListData,this),Ur.instance().event.load_playlist_complete.add(this.playListData,this),li.instance().showBanerChoosePlaylistCreateRoomScreen(),!0===Ur.instance().ktLoadPlaylist?this.playListData():Ur.instance().sendGetDataShop()}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),TF.instance().events.onExtensionResponse.remove(this.getData,this),Ur.instance().event.buy_playlist.remove(this.playListData,this),Ur.instance().event.load_playlist_complete.remove(this.playListData,this)}},{key:"getData",value:function(e){switch(e.cmd){case nS.ONLINE_MODE_ROOM_LOAD_PLAYLIST_RESPONSE:case Hs.SHOP_BUY_PLAYLIST_RESPONSE:}}},{key:"setBetMoney",value:function(e){this.betMoney=e}},{key:"setBetId",value:function(e,t){this.betId=e,this.betMoney=t}},{key:"setIsMaster",value:function(e){this.isMaster=e,!1===this.isMaster?this.header.setHideBtnBack():(this.header.setShowBtnBack(),De.instance().event.backButton.add(this.chooseBack,this))}},{key:"playListData",value:function(){var e=Ur.instance().playlist.getSuggestPlaylist();this.playlistSuggest.setData(e,0,!0),this.playlistSuggest.setButtonBuy(e.price),this.arrPlayList=Ur.instance().playlist.getArrMe(),this.buildListPlaylist(),qe.instance().hideLoading()}},{key:"buildListPlaylist",value:function(){game.add.tween(this.bgSuggestPlayList).to({x:this.positionCreateRoom.choose_playlist_itemplaylist_bg.x},150,Phaser.Easing.Power1,!0,300),game.add.tween(this.playlistSuggest).to({x:0},150,Phaser.Easing.Power1,!0,300),this.listPlayerlist.removeAll(),this.listPlayerlist.reset(),this.arrPlayList.sort(this.compareUserPlaylistMappingUpdate),this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(){var e=this.listPlayerlist.getIdx();this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrPlayList.length;e++){var t=new ix;if(t.setData(this.arrPlayList[e],e),t.event.buy.add(this.chooseBuyPlaylist,this),t.event.select.add(this.chooseSelectPlaylist,this),t.setButtonChoose(),this.listPlayerlist.add(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrPlayList.length){this.ktBuild=!1;break}this.idx===this.arrPlayList.length&&(this.ktBuild=!1)}}},{key:"chooseBuyPlaylist",value:function(){LogConsole.log("chooseBuyPlaylist")}},{key:"chooseSelectPlaylist",value:function(e){var t=e.id;LogConsole.log("chooseSelectPlaylist : "+t),this.isMaster?TF.instance().dataMySeft.diamond<this.betMoney?IE.instance().addDialogConfirnMoney("Bạn không đủ kim cương tạo phòng, bạn có muốn nạp thêm?"):(qe.instance().showLoading(),TF.instance().sendData(nS.ONLINE_MODE_ROOM_CREATE_REQUEST,rx.begin(t,this.betId))):TF.instance().dataMySeft.diamond<this.betMoney?IE.instance().addDialogConfirnMoney("Bạn không đủ kim cương để chơi, bạn có muốn nạp thêm?","chooseCanclePopupMoney"):(qe.instance().showLoading(),TF.instance().sendData(nS.ONLINE_MODE_ROOM_USER_SELECT_PLAYLIST_REQUEST,ax.begin(t)))}},{key:"chooseBuyMore",value:function(){LogConsole.log("chooseBuyMore"),IE.instance().addShop(0)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.removeAllItem(),this.removeEvent(),this.removeDelayBuild(),this.listPlayerlist.removeAll(),this.listPlayerlist.destroy(),li.instance().hideBanner(),qe.instance().hideLoading(),ux(dx(t.prototype),"destroy",this).call(this)}}])&&hx(n.prototype,i),o&&hx(n,o),t}();function gx(e){return(gx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mx(e,t){return!t||"object"!==gx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vx(e){return(vx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wx(e,t){return(wx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var bx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),mx(this,vx(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wx(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.mainData.modeplay=this.mainData.MODEPLAY.createroom,this.event={back:new Phaser.Signal,create_room:new Phaser.Signal},this.chooseBetScreen=null,this.choosePlaylistScreen=null,this.addChooseBetScreen(),Le.instance().logEvent(Le.Party_online_mode_Creatroom),this.addEvent()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case nS.ONLINE_MODE_ROOM_CREATE_RESPONSE:}}},{key:"addChooseBetScreen",value:function(){this.removeChooseBetScreen(),this.chooseBetScreen=new JR,this.chooseBetScreen.event.choose_bet.add(this.chooseBetComplete,this),this.chooseBetScreen.event.back.add(this.chooseBack,this),this.addChild(this.chooseBetScreen),null!==this.choosePlaylistScreen?(Nc.instance().beginSwitch(this.choosePlaylistScreen,this.chooseBetScreen,!0),Nc.instance().event.tweenComplete.add(this.tweenChooseBetComplete,this)):this.chooseBetScreen.addEvent()}},{key:"chooseBetComplete",value:function(e,t){this.addChoosePlaylistScreen(e,t)}},{key:"removeChooseBetScreen",value:function(){null!==this.chooseBetScreen&&(this.removeChild(this.chooseBetScreen),this.chooseBetScreen.destroy(),this.chooseBetScreen=null)}},{key:"tweenChooseBetComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenChooseBetComplete,this),this.removeChoosePlaylistScreen(),null!==this.chooseBetScreen&&this.chooseBetScreen.addEvent()}},{key:"addChoosePlaylistScreen",value:function(e,t){LogConsole.log("addChoosePlaylistScreen"),this.removeChoosePlaylistScreen(),this.choosePlaylistScreen=new px,this.choosePlaylistScreen.setBetId(e,t),this.choosePlaylistScreen.setIsMaster(!0),this.choosePlaylistScreen.event.create_room.add(this.callCreateRoom,this),this.choosePlaylistScreen.event.back.add(this.addChooseBetScreen,this),this.addChild(this.choosePlaylistScreen),null!==this.chooseBetScreen?(Nc.instance().beginSwitch(this.chooseBetScreen,this.choosePlaylistScreen,!1),Nc.instance().event.tweenComplete.add(this.tweenChoosePlayListComplete,this)):this.choosePlaylistScreen.addEvent()}},{key:"removeChoosePlaylistScreen",value:function(){null!==this.choosePlaylistScreen&&(this.removeChild(this.choosePlaylistScreen),this.choosePlaylistScreen.destroy(),this.choosePlaylistScreen=null)}},{key:"callCreateRoom",value:function(){TF.instance().sendData(nS.ONLINE_MODE_ROOM_CREATE_REQUEST,SendOnlineModeCRRoomCreate.begin(1,1))}},{key:"tweenChoosePlayListComplete",value:function(){this.removeChooseBetScreen(),Nc.instance().event.tweenComplete.remove(this.tweenChoosePlayListComplete,this),null!==this.choosePlaylistScreen&&this.choosePlaylistScreen.addEvent()}},{key:"chooseBack",value:function(){this.event.back.dispatch()}}])&&yx(n.prototype,i),o&&yx(n,o),t}();var _x=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.user_name="",this.avatar="",this.gender="",this.experience_score=0,this.heart=0,this.diamond=0,this.ticket=0,this.weekly_high_score=0,this.all_time_high_score=0,this.level=0,this.online_mode_genre=0,this.online_mode_room_ready=!1,this.online_mode_loaded=0,this.is_playing_game=!1,this.isMaster=!1,this.score=0,this.diamond_change=0,this.exp_score=0};function Sx(e){return(Sx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ex(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Cx(e,t){return!t||"object"!==Sx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kx(e,t,n){return(kx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Px(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Px(e){return(Px=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ox(e,t){return(Ox=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Rx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Cx(this,Px(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ox(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.positionCreateRoom=this.mainData.positionCreateRoom,this.spriteLoading=new rt(this.positionCreateRoom.waitting_user_loading_ava),this.spriteLoading.anchor.x=.5,this.spriteLoading.anchor.y=.5,this.addChild(this.spriteLoading),this.spriteLoading.x=this.spriteLoading.width/2,this.spriteLoading.y=this.spriteLoading.height/2,LogConsole.log(this.spriteLoading.x),LogConsole.log(this.spriteLoading.y),this.timerToCountTime=null,this.timerEvent=null}},{key:"beginLoad",value:function(){this.removetimer(),this.timerToCountTime=this.game.time.create(!0),this.timerEvent=this.timerToCountTime.loop(50,this.onTimerToCountTime,this),this.timerToCountTime.start()}},{key:"onTimerToCountTime",value:function(){LogConsole.log("onTimerToCountTime"),this.spriteLoading.rotation+=.1}},{key:"removetimer",value:function(){null!==this.timerToCountTime&&(game.time.events.remove(this.timerEvent),this.timerEvent=null,this.timerToCountTime.stop(),this.timerToCountTime.destroy(),this.timerToCountTime=null)}},{key:"destroy",value:function(){this.removetimer(),kx(Px(t.prototype),"destroy",this).call(this)}}])&&Ex(n.prototype,i),o&&Ex(n,o),t}();function xx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Tx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putInt("kick_user_id",e),t}}],(n=null)&&xx(t.prototype,n),i&&xx(t,i),e}();function Ix(e){return(Ix="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ax(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Lx(e,t){return!t||"object"!==Ix(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gx(e,t,n){return(Gx="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Dx(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Dx(e){return(Dx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mx(e,t){return(Mx=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Nx=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Lx(this,Dx(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mx(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={kick:new Phaser.Signal,click_avatar:new Phaser.Signal,choose_invite:new Phaser.Signal},this.data=new _x,this.ktEmpty=!0,this.idMaster=-1,this.idx=0,this.tween=null,this.ktShowKich=!1,this.ktShowLoading=!1,this.btnWin=null,this.ktDisConnect=!1,this.ktPlay=!1,this.iconChat=null,this.positionCreateRoom=this.mainData.positionCreateRoom,this.bg=new pt({x:0,y:0,nameAtlas:"createroom",nameSprite:"bg_header_playlist_suggest"},this.choosePlayer,this),this.bg.alpha=0,this.addChild(this.bg),this.txtName=new _t(this.positionCreateRoom.waitting_user_txt_name,"Viet PV"),this.txtName.setTextBounds(0,0,155*z.instance().scale,34*z.instance().scale),this.addChild(this.txtName),this.btnKick=new ln(this.positionCreateRoom.waitting_user_btn_kick_trai,"KÍCH",this.chooseKick,this),this.btnKick.visible=!1,this.btnKick.x=130*z.instance().scale,this.btnKick.y=(this.positionCreateRoom.waitting_user_btn_kick_trai.y-28)*z.instance().scale,this.addChild(this.btnKick),this.btnProfile=new ln(this.positionCreateRoom.waitting_user_btn_kick_trai,"XEM",this.chooseProfile,this),this.btnProfile.visible=!1,this.btnProfile.x=130*z.instance().scale,this.btnProfile.y=(this.positionCreateRoom.waitting_user_btn_kick_trai.y+28)*z.instance().scale,this.addChild(this.btnProfile),this.btnKickPhai=new ln(this.positionCreateRoom.waitting_user_btn_kick_phai,"KÍCH",this.chooseKick,this),this.btnKickPhai.visible=!1,this.btnKickPhai.x=-78*z.instance().scale,this.btnKickPhai.y=(this.positionCreateRoom.waitting_user_btn_kick_phai.y-28)*z.instance().scale,this.addChild(this.btnKickPhai),this.btnProfilePhai=new ln(this.positionCreateRoom.waitting_user_btn_kick_phai,"XEM",this.chooseProfile,this),this.btnProfilePhai.visible=!1,this.btnProfilePhai.x=-78*z.instance().scale,this.btnProfilePhai.y=(this.positionCreateRoom.waitting_user_btn_kick_phai.y+28)*z.instance().scale,this.addChild(this.btnProfilePhai),this.ava=new pc,this.ava.setSize(150*z.instance().scale,150*z.instance().scale),this.ava.x=2.5*z.instance().scale,this.ava.y=51.5*z.instance().scale,this.addChild(this.ava),this.bg.width=this.ava.width,this.bg.height=this.ava.height,this.bg.x=this.ava.x,this.bg.y=this.ava.y,this.btnWaitting=new pt(this.positionCreateRoom.waitting_user_bg_player_waiting,this.chooseWaitting,this),this.btnWaitting.visible=!1,this.addChild(this.btnWaitting),this.khungAva=new rt(this.positionCreateRoom.waitting_user_khungava),this.addChild(this.khungAva),this.loading=new Rx,this.loading.y=49*z.instance().scale,this.loading.visible=!1,this.addChild(this.loading),this.txtSanSang=new _t(this.positionCreateRoom.waitting_user_txt_sansang,""),this.txtSanSang.setTextBounds(0,0,155*z.instance().scale,29*z.instance().scale),this.addChild(this.txtSanSang),this.trueFailAnswer=new Pd,this.trueFailAnswer.setSize(330*z.instance().scale,330*z.instance().scale),this.trueFailAnswer.x=-87*z.instance().scale,this.trueFailAnswer.y=-35*z.instance().scale,this.addChild(this.trueFailAnswer),this.addEvent()}},{key:"addEvent",value:function(){TF.instance().events.onPublicMessage.add(this.onPublicMessage,this)}},{key:"removeEvent",value:function(){TF.instance().events.onPublicMessage.remove(this.onPublicMessage,this)}},{key:"onPublicMessage",value:function(e){LogConsole.log("onPublicMessage"),LogConsole.log(e);var t=e.message;if(console.log("command : "+t),t===Pe.CHAT_ONLINE_MODE){var n=e.sender,i=parseInt(n.name);console.log("aaaaaaaaaaaaaaaa"),e.data.containsKey("typeicon")&&this.data.user_id===i&&(this.removeIconChat(),this.iconChat=new cS(e.data.getUtfString("typeicon")),this.iconChat.event.call_remove.add(this.removeIconChat,this),this.iconChat.anchor.x=.5,this.iconChat.anchor.y=.5,this.iconChat.x=this.ava.x+this.ava.width/2,this.iconChat.y=this.ava.y+this.ava.height/2,game.add.tween(this.iconChat.scale).to({x:1.5,y:1.5},50,"Linear",!0),this.addChild(this.iconChat))}}},{key:"removeIconChat",value:function(){null!==this.iconChat&&(this.removeChild(this.iconChat),this.iconChat.destroy(),this.iconChat=null)}},{key:"setDisConnect",value:function(){this.ktDisConnect=!0}},{key:"setPlay",value:function(e){this.ktPlay=e,this.ktPlay&&(this.idx%2==0?this.onCompleteHideTween():this.onCompleteHideTweenPhai())}},{key:"setDefaultUser",value:function(){this.txtName.changeStyle({fontSize:25}),this.txtSanSang.changeStyle({fontSize:21,font:"Gilroy",fill:"#7B7788"}),this.txtName.y=this.positionCreateRoom.waitting_user_txt_name.y*this.mainData.scale,this.txtSanSang.y=this.positionCreateRoom.waitting_user_txt_sansang.y*this.mainData.scale,this.removeButtonWin()}},{key:"setButtonWin",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.removeButtonWin(),this.setGameOver(),!0===e?(this.btnWin=new ln(this.positionCreateRoom.result_btn_money_ava_result,"+"+(this.data.diamond_change+t)),this.btnWin.scale.x=1.3,this.btnWin.scale.y=1.3,this.btnWinExp=new ln(this.positionCreateRoom.result_btn_exp_ava_result_win,"+"+this.data.exp_score),this.btnWinExp.scale.x=1.3,this.btnWinExp.scale.y=1.3,this.addChild(this.btnWinExp)):(this.btnWin=new ln(this.positionCreateRoom.result_btn_exp_ava_result_lose,"+"+this.data.exp_score),this.btnWin.scale.x=1.3,this.btnWin.scale.y=1.3),this.addChild(this.btnWin),this.txtName.y=-30*z.instance().scale,this.txtSanSang.y=12*z.instance().scale}},{key:"removeButtonWin",value:function(){null!==this.btnWin&&(this.removeChild(this.btnWin),this.btnWin.destroy(),this.btnWin=null),null!==this.btnWinExp&&this.removeChild(this.btnWinExp)}},{key:"setScore",value:function(e){this.setTextSanSang(e)}},{key:"setTrueAnswer",value:function(){this.trueFailAnswer.setTrueAnswer()}},{key:"setFailtAnswer",value:function(){this.trueFailAnswer.setFailtAnswer()}},{key:"hideKhungAvatar",value:function(){this.khungAva.visible=!1}},{key:"showKhungAvatar",value:function(){this.khungAva.visible=!1}},{key:"setLoading",value:function(e){!1===this.ktShowLoading&&this.showLoading(),100===e&&(this.setTextSanSang("Sẵn Sàng"),this.hideLoading())}},{key:"showLoading",value:function(){!1===this.ktShowLoading&&(LogConsole.log("showLoading----------"),this.ktShowLoading=!0,this.loading.visible=!0,this.loading.beginLoad(),this.hideKhungAvatar(),this.setTextSanSang("Đang tải..."))}},{key:"hideLoading",value:function(){LogConsole.log("hideLoading----------"),this.ktShowLoading=!1,this.loading.visible=!1,this.loading.removetimer()}},{key:"setMaster",value:function(e){this.idMaster=e,this.setTextMaster()}},{key:"setData",value:function(e,t){this.data=Object.assign({},this.data,e),this.ktEmpty=!1,this.ava.visible=!0,this.khungAva.visible=!0,this.txtName.text=this.data.user_name,this.ava.setAvatar(this.data.avatar,t),!0===this.data.isMaster?this.setTextSanSang(""):this.data.online_mode_room_ready?this.setTextSanSang("Sẵn sàng"):this.setTextSanSang("Chưa sẵn sàng"),this.btnWaitting.visible=!1}},{key:"setGameOver",value:function(){this.txtName.changeStyle({fontSize:33}),this.txtSanSang.changeStyle({fontSize:32,font:"GilroyBold",fill:"#ffffff"})}},{key:"setUserPlayGame",value:function(){this.txtSanSang.changeStyle({fontSize:32,font:"GilroyBold",fill:"#ffffff"}),this.txtSanSang.y=(this.positionCreateRoom.waitting_user_txt_sansang.y-4)*this.mainData.scale}},{key:"setDataQuickPlay",value:function(e,t){this.data=Object.assign({},this.data,e),this.ktEmpty=!1,this.ava.visible=!0,this.khungAva.visible=!0,this.txtName.text=this.data.user_name,this.ava.setAvatar(this.data.avatar,t),this.btnWaitting.visible=!1,this.setTextSanSang("")}},{key:"setTextMaster",value:function(){!0===this.data.isMaster?this.setTextSanSang(""):this.data.online_mode_room_ready?this.setTextSanSang("Sẵn sàng"):this.setTextSanSang("Chưa sẵn sàng")}},{key:"setCurrentData",value:function(e){this.data=Object.assign({},this.data,e)}},{key:"getData",value:function(){return this.data}},{key:"setEmpty",value:function(){this.ktEmpty=!0,this.btnWaitting.visible=!0,this.ava.visible=!1,this.txtName.text="",this.btnKick.visible=!1,this.btnKick.inputEnabled=!1,this.btnKickPhai.visible=!1,this.btnKickPhai.inputEnabled=!1,this.btnProfile.visible=!1,this.btnProfile.inputEnabled=!1,this.btnProfilePhai.visible=!1,this.btnProfilePhai.inputEnabled=!1,this.ktDisConnect=!1,this.ktPlay=!1,this.ktShowKich=!1,this.ktShowLoading=!1,this.setTextSanSang("Đợi người chơi"),this.hideKhungAvatar(),this.hideLoading(),this.idx%2==0?this.onCompleteHideTween():this.onCompleteHideTweenPhai()}},{key:"setTextSanSang",value:function(e){this.txtSanSang.text=e}},{key:"setIdx",value:function(e){this.idx=e}},{key:"getIdx",value:function(){return this.idx}},{key:"choosePlayer",value:function(){LogConsole.log("choosePlayer : "+this.ktPlay),!1===this.ktPlay&&(TF.instance().dataMySeft.user_id===this.data.user_id?IE.instance().addUserProfile(this.data.user_id):(console.log("SocketController.instance().dataMySeft.user_id : "+TF.instance().dataMySeft.user_id),console.log("this.idMaster : "+this.idMaster),TF.instance().dataMySeft.user_id===this.idMaster?(this.ktShowKich=!this.ktShowKich,this.event.click_avatar.dispatch(this.idx),this.ktShowKich?this.idx%2==0?this.setShowKichTween():this.setShowKichTweenPhai():this.idx%2==0?this.setHideKichTween():this.setHideKichTweenPhai()):IE.instance().addUserProfile(this.data.user_id)))}},{key:"setCheckHideKichTween",value:function(){!0===this.ktShowKich&&(this.idx%2==0?this.setHideKichTween():this.setHideKichTweenPhai())}},{key:"setShowKichTween",value:function(){this.removeTween();var e;this.btnKick.x=57*z.instance().scale,this.btnKick.visible=!0,this.btnKick.inputEnabled=!1,e=130*z.instance().scale,this.ktShowKich=!0,this.btnProfile.x=57*z.instance().scale,this.btnProfile.visible=!0,this.btnProfile.inputEnabled=!1,this.tween=game.add.tween(this.btnKick).to({x:e},200,Phaser.Easing.Power1,!0),this.tween=game.add.tween(this.btnProfile).to({x:e},200,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.onCompleteShowTween,this)}},{key:"setHideKichTween",value:function(){this.removeTween();var e;this.btnKick.x=130*z.instance().scale,this.btnKick.visible=!0,this.btnKick.inputEnabled=!1,this.btnProfile.x=130*z.instance().scale,this.btnProfile.visible=!0,this.btnProfile.inputEnabled=!1,e=57*z.instance().scale,this.ktShowKich=!1,this.tween=game.add.tween(this.btnKick).to({x:e},200,Phaser.Easing.Power1,!0),this.tween=game.add.tween(this.btnProfile).to({x:e},200,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.onCompleteHideTween,this)}},{key:"setShowKichTweenPhai",value:function(){this.removeTween();var e;this.btnKickPhai.x=2*z.instance().scale,this.btnKickPhai.visible=!0,this.btnKickPhai.inputEnabled=!1,this.btnProfilePhai.x=2*z.instance().scale,this.btnProfilePhai.visible=!0,this.btnProfilePhai.inputEnabled=!1,e=-78*z.instance().scale,this.ktShowKich=!0,this.tween=game.add.tween(this.btnKickPhai).to({x:e},200,Phaser.Easing.Power1,!0),this.tween=game.add.tween(this.btnProfilePhai).to({x:e},200,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.onCompleteShowTweenPhai,this)}},{key:"setHideKichTweenPhai",value:function(){this.removeTween();this.btnKickPhai.x=-78*z.instance().scale,this.btnKickPhai.visible=!0,this.btnKickPhai.inputEnabled=!1,this.btnProfilePhai.x=-78*z.instance().scale,this.btnProfilePhai.visible=!0,this.btnProfilePhai.inputEnabled=!1,this.ktShowKich=!1,this.tween=game.add.tween(this.btnKickPhai).to({x:2},200,Phaser.Easing.Power1,!0),this.tween=game.add.tween(this.btnProfilePhai).to({x:2},200,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.onCompleteHideTweenPhai,this)}},{key:"onCompleteShowTweenPhai",value:function(){this.btnKickPhai.visible=!0,this.btnKickPhai.inputEnabled=!0,this.btnProfilePhai.visible=!0,this.btnProfilePhai.inputEnabled=!0}},{key:"onCompleteHideTweenPhai",value:function(){this.ktShowKich=!1,this.btnKickPhai.visible=!1,this.btnKickPhai.inputEnabled=!1,this.btnProfilePhai.visible=!1,this.btnProfilePhai.inputEnabled=!1}},{key:"onCompleteShowTween",value:function(){this.btnKick.visible=!0,this.btnKick.inputEnabled=!0,this.btnProfile.visible=!0,this.btnProfile.inputEnabled=!0}},{key:"onCompleteHideTween",value:function(){this.ktShowKich=!1,this.btnKick.visible=!1,this.btnKick.inputEnabled=!1,this.btnProfile.visible=!1,this.btnProfile.inputEnabled=!1}},{key:"removeTween",value:function(){null!==this.tween&&(this.tween.stop(),game.tweens.remove(this.tween),this.tween=null)}},{key:"chooseWaitting",value:function(){this.event.choose_invite.dispatch()}},{key:"chooseKick",value:function(){LogConsole.log("chooseKick"),TF.instance().dataMySeft.user_id===this.idMaster&&(this.idx%2==0?this.onCompleteHideTween():this.onCompleteHideTweenPhai(),this.btnKick.inputEnabled=!1,this.btnKickPhai.inputEnabled=!1,TF.instance().sendData(nS.ONLINE_MODE_ROOM_KICK_USER_REQUEST,Tx.begin(this.data.user_id)))}},{key:"chooseProfile",value:function(){TF.instance().dataMySeft.user_id===this.idMaster&&(this.idx%2==0?this.onCompleteHideTween():this.onCompleteHideTweenPhai(),IE.instance().addUserProfile(this.data.user_id))}},{key:"destroy",value:function(){this.removeEvent(),Gx(Dx(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&Ax(n.prototype,i),o&&Ax(n,o),t}();var Bx=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.file_path="",this.question_type="",this.arrAnser=[],this.correct_answer=0,this.playerChoose={idx:0,correct_answer:!1,time:0},this.song=new Zh,this.user_choose="",this.playlist_id=0};function jx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ux=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),El.instance().event.loadComplete.add(this.loadSourceComplete,this)}var t,n,i;return t=e,(n=[{key:"loadSourceComplete",value:function(){TF.instance().sendLoading(100)}},{key:"beginLoad",value:function(e){this.dataSource=e;for(var t=[],n=0;n<e.length;n++)"audio"==e[n].type&&t.push(e[n].url);El.instance().loadSoundArray(t)}},{key:"loadStart",value:function(){LogConsole.log("loadStart----------")}},{key:"onFileComplete",value:function(e,t,n,i,o){LogConsole.log("progress "+e),LogConsole.log("key "+t),LogConsole.log("error "+n),LogConsole.log("loadedFileCount "+i),LogConsole.log("totalFileCount "+o),TF.instance().sendLoading(e)}},{key:"loadComplete",value:function(){LogConsole.log("loadComplete---------- : ")}},{key:"update",value:function(){}}])&&jx(t.prototype,n),i&&jx(t,i),e}();function Fx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Zx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t=[],n=[],i=e.getSFSArray(Qh.questions),o=0;o<i.size();o++){var a=i.getSFSObject(o),s=new Bx;if(s.file_path=a.getUtfString(Qh.file_path),s.question_type=a.getUtfString(Qh.question_type),s.correct_answer=a.getInt(Qh.correct_answer),s.arrAnser.push(a.getUtfString(Qh.answer1)),s.arrAnser.push(a.getUtfString(Qh.answer2)),s.arrAnser.push(a.getUtfString(Qh.answer3)),s.arrAnser.push(a.getUtfString(Qh.answer4)),a.containsKey(Qh.user)&&!a.isNull(Qh.user)){var r=a.getSFSObject(Qh.user);s.user_choose=r?r.getUtfString(Qh.user_name):""}else s.user_choose="";var l=a.getSFSObject(Qh.song);if(s.song=Wh.getSongDetail(l),s.song.listenLink=s.file_path,a.containsKey("playlist"))if(a.isNull("playlist"));else{var h=a.getSFSObject("playlist");h.containsKey("playlist_name")&&(s.song.playlist_name=h.getUtfString("playlist_name")),h.containsKey("playlist_id")&&(s.playlist_id=h.getInt("playlist_id"))}t.push(s);var c={type:"audio"};c.url=s.file_path,n.push(c)}return(new Ux).beginLoad(n),t}}],(n=null)&&Fx(t.prototype,n),i&&Fx(t,i),e}();function Hx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Qx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(t){for(var n=[],i=TF.instance().socket.buddyManager.getBuddyList(),o=0;o<i.length;o++){var a=i[o];if(""===t||-1!==e.xoa_dau(a.getVariable("$"+fa.userName).value).toUpperCase().indexOf(e.xoa_dau(t).toUpperCase())){var s=new ua;LogConsole.log(a),s.avatar=a.getVariable("$"+fa.avatar).value,s.diamond=a.getVariable("$"+fa.diamond).value,s.isOnline=a[fa.isOnline],s.userId=a.getVariable("$"+fa.userId).value,s.userName=a.getVariable("$"+fa.userName).value,n.push(s)}}return n=n.sort(e.compareOnline)}},{key:"xoa_dau",value:function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a")).replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e")).replace(/ì|í|ị|ỉ|ĩ/g,"i")).replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o")).replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u")).replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y")).replace(/đ/g,"d")).replace(/À|Á|Ạ|Ả|Ã|Â|Ầ|Ấ|Ậ|Ẩ|Ẫ|Ă|Ằ|Ắ|Ặ|Ẳ|Ẵ/g,"A")).replace(/È|É|Ẹ|Ẻ|Ẽ|Ê|Ề|Ế|Ệ|Ể|Ễ/g,"E")).replace(/Ì|Í|Ị|Ỉ|Ĩ/g,"I")).replace(/Ò|Ó|Ọ|Ỏ|Õ|Ô|Ồ|Ố|Ộ|Ổ|Ỗ|Ơ|Ờ|Ớ|Ợ|Ở|Ỡ/g,"O")).replace(/Ù|Ú|Ụ|Ủ|Ũ|Ư|Ừ|Ứ|Ự|Ử|Ữ/g,"U")).replace(/Ỳ|Ý|Ỵ|Ỷ|Ỹ/g,"Y")).replace(/Đ/g,"D")}},{key:"compareOnline",value:function(e){return 1==e.isOnline?-1:1}}],(n=null)&&Hx(t.prototype,n),i&&Hx(t,i),e}();function Vx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Wx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putUtfString("envitee_id",e+""),t}}],(n=null)&&Vx(t.prototype,n),i&&Vx(t,i),e}();function qx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Kx=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){for(var n=[],i=e.getSFSArray(fa.friends),o=0;o<i.size();o++){var a=i.getSFSObject(o);if(""===t||-1!==Qx.xoa_dau(a.getUtfString(fa.user_name)).toUpperCase().indexOf(Qx.xoa_dau(t).toUpperCase())){var s=new ua;s.userId=a.getInt(fa.id),s.userName=a.getUtfString(fa.user_name),s.isOnline=a.getBool(fa.is_online),s.avatar=a.getUtfString(fa.avatar),n.push(s)}}return n=n.sort(Qx.compareOnline)}}],(n=null)&&qx(t.prototype,n),i&&qx(t,i),e}();function zx(e){return(zx="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Jx(e,t){return!t||"object"!==zx(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xx(e){return(Xx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $x(e,t){return($x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var eT=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=Jx(this,Xx(t).call(this,game,0,0,""))).positionOnlineMode=i.mainData.positionCreateRoom,i.bg=new rt(i.positionOnlineMode.friend_detail_room_bg),i.addChild(i.bg),i.idPhong=new _t(i.positionOnlineMode.friend_detail_room_id,"Phòng Chơi: "+e),i.idPhong.addColor("#ffa33a",11),i.addChild(i.idPhong),i.iconCount=new rt(i.positionOnlineMode.friend_detail_room_icon_count),i.addChild(i.iconCount),i.countPlayer=new _t(i.positionOnlineMode.friend_detail_room_count_player,"3/4"),i.updateCountPlayer(n),i.addChild(i.countPlayer),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$x(e,t)}(t,Mt),n=t,(i=[{key:"updateCountPlayer",value:function(e){this.countPlayer.text=e+"/4"}}])&&Yx(n.prototype,i),o&&Yx(n,o),t}();function tT(e){return(tT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iT(e,t,n){return(iT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=oT(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function oT(e){return(oT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aT(e,t){return(aT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var rT=function(e){function t(e,n){var i,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,i=!(a=oT(t).call(this,game,0,0,null))||"object"!==tT(a)&&"function"!=typeof a?sT(o):a,qe.instance().showLoading(),i.event={back:new Phaser.Signal,random:new Phaser.Signal},i.data=null,i.currentSearch="",i.positionCreateRoom=i.mainData.positionCreateRoom,i.bg=new Phaser.Button(game,0,0,"bg_create_room"),i.addChild(i.bg);var s=new Phaser.Group(game,0,0,null);return i.listFriends=new Vo(game,s,new Phaser.Rectangle(0,0,game.width,game.height-380*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),s.x=0,s.y=226*z.instance().scale,i.addChild(s),i.header=new IR,i.header.setTitle("DANH SÁCH BẠN"),i.header.setHideBtnBack(),i.header.setSearchButton(),i.header.event.back.add(i.chooseBack,sT(sT(i))),i.header.event.search.add(i.chooseSearch,sT(sT(i))),i.addChild(i.header),i.detailRoom=new eT(e,n),i.detailRoom.y=100,i.addChild(i.detailRoom),i.txtSearch=new _t(i.positionCreateRoom.listfriend_txt_current_search,"Tất cả bạn"),i.txtSearch.setTextBounds(0,0,game.width-120*z.instance().scale,100*z.instance().scale),i.addChild(i.txtSearch),i.btnCloseTextSearch=new pt(i.positionCreateRoom.listfriend_btn_close_search,i.chooseCloseTextSearch,sT(sT(i))),i.addChild(i.btnCloseTextSearch),i.btnCloseTextSearch.visible=!1,i.btnRandom=new ln(i.positionCreateRoom.listfriend_btn_random,"NGẪU NHIÊN",i.chooseRandom,sT(sT(i))),i.addChild(i.btnRandom),i.btnRandom.y=game.height,game.add.tween(i.btnRandom).to({y:game.height-115*z.instance().scale},150,Phaser.Easing.Power1,!0,300),i.btnXong=new ln(i.positionCreateRoom.listfriend_btnXong,"XONG",i.chooseXong,sT(sT(i))),i.addChild(i.btnXong),i.btnXong.y=game.height,game.add.tween(i.btnXong).to({y:game.height-115*z.instance().scale},150,Phaser.Easing.Power1,!0,300),i.addEvent(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aT(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){}},{key:"updateCountPlayer",value:function(e){this.detailRoom.updateCountPlayer(e)}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().sendData(nS.USER_FRIEND_LIST_LOAD_REQUEST,null)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case nS.ONLINE_MODE_ROOM_ONLINE_USERS_LIST_RESPONSE:break;case nS.USER_FRIEND_LIST_LOAD_RESPONSE:this.data=e.params,this.buildListFriends()}}},{key:"chooseCloseTextSearch",value:function(){this.txtSearch.text="Tất cả bạn",this.currentSearch="",this.btnCloseTextSearch.visible=!1,this.buildListFriends()}},{key:"buildListFriends",value:function(){this.listFriends.removeAll(),this.listFriends.reset();for(var e=Kx.begin(this.data,this.currentSearch),t=0;t<e.length;t++){var n=new Oy;n.setData(e[t],t),n.event.invite.add(this.chooseInvite,this),this.listFriends.add(n)}qe.instance().hideLoading()}},{key:"chooseInvite",value:function(e){TF.instance().sendData(nS.ONLINE_MODE_ROOM_INVITE_REQUEST,Wx.begin(e.userId))}},{key:"chooseSearch",value:function(){LogConsole.log("chooseSearch");$r.instance().show({maxLength:"",showTransparent:!0,placeholder:"Nhập tên người mời",isSearch:!0}),$r.instance().event.change.add(this.changeKeyBoard,this),$r.instance().event.hideKeyboard.add(this.hideKeyboard,this),$r.instance().event.enter.add(this.onSubmit,this),$r.instance().event.submit.add(this.onSubmit,this),$r.instance().event.cancle.add(this.onCancel,this)}},{key:"changeKeyBoard",value:function(){var e=$r.instance().getValue();e===this.currentSearch||(this.currentSearch=e,""===this.currentSearch?this.chooseCloseTextSearch():(this.btnCloseTextSearch.visible=!0,this.txtSearch.text=this.currentSearch,this.buildListFriends()))}},{key:"onSubmit",value:function(){this.changeKeyBoard(),this.onCancel()}},{key:"hideKeyboard",value:function(){$r.instance().hide()}},{key:"onCancel",value:function(){$r.instance().event.change.remove(this.changeKeyBoard,this),$r.instance().event.hideKeyboard.remove(this.hideKeyboard,this),$r.instance().event.enter.remove(this.onSubmit,this),$r.instance().event.submit.remove(this.onSubmit,this),$r.instance().event.cancle.remove(this.onCancel,this),$r.instance().hide()}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"chooseXong",value:function(){this.chooseBack()}},{key:"chooseRandom",value:function(){LogConsole.log("chooseRandom"),this.event.random.dispatch()}},{key:"destroy",value:function(){this.onCancel(),this.listFriends.removeAll(),this.listFriends.destroy(),this.removeEvent(),this.removeAllItem(),iT(oT(t.prototype),"destroy",this).call(this)}}])&&nT(n.prototype,i),o&&nT(n,o),t}();function lT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var hT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){LogConsole.log(e.getDump());var t=[],n=e.getSFSArray(fa.users);if(LogConsole.log(n),null!==n)for(var i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new ua;a.avatar=o.getUtfString(fa.avatar),a.isOnline=!0,a.userId=o.getInt(fa.id),a.userName=o.getUtfString(fa.user_name),t.push(a)}return LogConsole.log(t),t}}],(n=null)&&lT(t.prototype,n),i&&lT(t,i),e}();function cT(e){return(cT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dT(e,t,n){return(dT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fT(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function fT(e){return(fT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pT(e,t){return(pT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gT(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var yT=function(e){function t(e,n){var i,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,i=!(a=fT(t).call(this,game,0,0,null))||"object"!==cT(a)&&"function"!=typeof a?gT(o):a,qe.instance().showLoading(),i.event={back:new Phaser.Signal,changeToBanBe:new Phaser.Signal},i.currentSearch="",i.positionCreateRoom=i.mainData.positionCreateRoom,i.bg=new Phaser.Button(game,0,0,"bg_create_room"),i.addChild(i.bg);var s=new Phaser.Group(game,0,0,null);return i.listFriends=new Vo(game,s,new Phaser.Rectangle(0,0,game.width,game.height-300*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),s.x=0,s.y=176*z.instance().scale,i.addChild(s),i.header=new IR,i.header.setHideBtnBack(),i.header.setTitle("DANH SÁCH RANDOM"),i.header.event.back.add(i.chooseBack,gT(gT(i))),i.addChild(i.header),i.detailRoom=new eT(e,n),i.detailRoom.y=100,i.addChild(i.detailRoom),i.btnRandom=new ln(i.positionCreateRoom.listfriend_btn_random,"BẠN BÈ",i.chooseBanBe,gT(gT(i))),i.addChild(i.btnRandom),i.btnRandom.y=game.height,game.add.tween(i.btnRandom).to({y:game.height-115*z.instance().scale},150,Phaser.Easing.Power1,!0,300),i.btnXong=new ln(i.positionCreateRoom.listfriend_btnXong,"XONG",i.chooseXong,gT(gT(i))),i.addChild(i.btnXong),i.btnXong.y=game.height,game.add.tween(i.btnXong).to({y:game.height-115*z.instance().scale},150,Phaser.Easing.Power1,!0,300),i.addEvent(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pT(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){}},{key:"updateCountPlayer",value:function(e){this.detailRoom.updateCountPlayer(e)}},{key:"chooseBanBe",value:function(){this.event.changeToBanBe.dispatch()}},{key:"chooseXong",value:function(){this.chooseBack()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().sendData(nS.ONLINE_MODE_ROOM_ONLINE_USERS_LIST_REQUEST,null),li.instance().showBanerInviteOtherUserWaitingScreen()}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case nS.ONLINE_MODE_ROOM_ONLINE_USERS_LIST_RESPONSE:this.arrPlayer=hT.begin(e.params),this.buildListPlayerRandom(),qe.instance().hideLoading()}}},{key:"buildListPlayerRandom",value:function(){this.listFriends.removeAll(),this.listFriends.reset();for(var e=0;e<this.arrPlayer.length;e++){var t=new Oy;t.setData(this.arrPlayer[e],e),t.event.invite.add(this.chooseInvite,this),this.listFriends.add(t)}}},{key:"chooseInvite",value:function(e){TF.instance().sendData(nS.ONLINE_MODE_ROOM_INVITE_REQUEST,Wx.begin(e.userId))}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listFriends.removeAll(),this.listFriends.destroy(),li.instance().hideBanner(),dT(fT(t.prototype),"destroy",this).call(this)}}])&&uT(n.prototype,i),o&&uT(n,o),t}();function mT(e){return(mT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wT(e){return(wT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bT(e,t){return(bT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ST=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=wT(t).call(this,game,0,0,""))||"object"!==mT(a)&&"function"!=typeof a?_T(o):a).event={close:new Phaser.Signal},i.positionCreateRoom=i.mainData.positionCreateRoom,i.bg=new pt(i.positionCreateRoom.chat_waitting_friend_chat_bg),i.addChild(i.bg),i.ava=new pc,i.ava.setSize(68,68),i.ava.setAvatar(n,0),i.ava.x=18,i.ava.y=17,i.addChild(i.ava),i.txtChat=new _t(i.positionCreateRoom.chat_waitting_friend_chat_text,e),i.txtChat.y=(i.bg.height-i.txtChat.height)/2,i.addChild(i.txtChat),i.close=new pt(i.positionCreateRoom.chat_waitting_friend_chat_close,i.chooseClose,_T(_T(i))),i.addChild(i.close),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bT(e,t)}(t,Mt),n=t,(i=[{key:"chooseClose",value:function(){this.event.close.dispatch()}}])&&vT(n.prototype,i),o&&vT(n,o),t}();function ET(e){return(ET="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function CT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kT(e,t){return!t||"object"!==ET(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function PT(e,t,n){return(PT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=OT(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function OT(e){return(OT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RT(e,t){return(RT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xT=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=kT(this,OT(t).call(this,game,0,0,null))).idRoom=e,i.count=n,i.event={back:new Phaser.Signal},i.layoutContent=new Phaser.Sprite(game,0,0,""),i.addChild(i.layoutContent),i.listFriends=null,i.listRandom=null,i.chatPlayer=null,i.addEvent(),i.addListFriends(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RT(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onUserEnterRoom.add(this.userEnterRoom,this),TF.instance().events.onUserExitRoom.add(this.userExitRoom,this)}},{key:"removeEvent",value:function(){TF.instance().events.onUserEnterRoom.remove(this.userEnterRoom,this),TF.instance().events.onUserExitRoom.remove(this.userExitRoom,this)}},{key:"userEnterRoom",value:function(){this.count++,this.updateCountPlayer()}},{key:"userExitRoom",value:function(){this.count--,this.updateCountPlayer()}},{key:"updateCountPlayer",value:function(){null!==this.listFriends&&this.listFriends.updateCountPlayer(this.count),null!==this.listRandom&&this.listRandom.updateCountPlayer(this.count)}},{key:"addListFriends",value:function(){this.removeListFriends(),this.listFriends=new rT(this.idRoom,this.count),this.listFriends.event.back.add(this.chooseBack,this),this.listFriends.event.random.add(this.addListRandom,this),this.layoutContent.addChild(this.listFriends),null!==this.listRandom?(Nc.instance().beginSwitch(this.listRandom,this.listFriends,!1),Nc.instance().event.tweenComplete.add(this.tweenListRandomComplete,this)):Nc.instance().beginSwitch(null,this.listFriends,!1)}},{key:"tweenListRandomComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenListRandomComplete,this),this.removeListRandom()}},{key:"removeListFriends",value:function(){null!==this.listFriends&&(this.layoutContent.removeChild(this.listFriends),this.listFriends.destroy(),this.listFriends=null)}},{key:"addListRandom",value:function(){this.removeListRandom(),this.listRandom=new yT(this.idRoom,this.count),this.listRandom.event.back.add(this.chooseBack,this),this.listRandom.event.changeToBanBe.add(this.addListFriends,this),this.layoutContent.addChild(this.listRandom),null!==this.listFriends&&(Nc.instance().beginSwitch(this.listFriends,this.listRandom,!1),Nc.instance().event.tweenComplete.add(this.tweenListFriendsComplete,this))}},{key:"tweenListFriendsComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenListFriendsComplete,this),this.removeListFriends()}},{key:"removeListRandom",value:function(){null!==this.listRandom&&(this.layoutContent.removeChild(this.listRandom),this.listRandom.destroy(),this.listRandom=null)}},{key:"addChatRoom",value:function(e,t){this.removeChatRoom(),this.chatPlayer=new ST(e,t),this.chatPlayer.y=-102,this.chatPlayer.event.close.add(this.removeChatRoom,this),this.addChild(this.chatPlayer),game.add.tween(this.chatPlayer).to({y:1},300,Phaser.Easing.Power1,!0)}},{key:"removeChatRoom",value:function(){null!==this.chatPlayer&&(this.removeChild(this.chatPlayer),this.chatPlayer.destroy(),this.chatPlayer=null)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){qe.instance().hideLoading(),this.removeEvent(),PT(OT(t.prototype),"destroy",this).call(this)}}])&&CT(n.prototype,i),o&&CT(n,o),t}();function TT(e){return(TT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AT(e,t){return!t||"object"!==TT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function LT(e){return(LT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function GT(e,t){return(GT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var DT=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=AT(this,LT(t).call(this,game,0,0,null))).chart=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GT(e,t)}(t,Mt),n=t,(i=[{key:"addChart",value:function(e){this.removeChart();var t={x:0,y:0,nameAtlas:"createroom",nameSprite:e?"Light_You":"Light_Other"};this.chart=new rt(t),this.addChild(this.chart)}},{key:"removeChart",value:function(){null!==this.chart&&(this.removeChild(this.chart),this.chart.destroy(),this.chart=null)}},{key:"height",set:function(e){this.chart.height=e}}])&&IT(n.prototype,i),o&&IT(n,o),t}();function MT(e){return(MT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BT(e,t){return!t||"object"!==MT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jT(e,t,n){return(jT="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=UT(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function UT(e){return(UT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FT(e,t){return(FT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ZT=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),BT(this,UT(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FT(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.timeCount=1e4,this.eventLoadingComplete=new Phaser.Signal,this.positionOnlineMode=this.mainData.positionCreateRoom,this.loaderPerc=0,this.beginLoad=!1,this.maxLoading=100,this.constLoading=.5,this.bg=new rt(this.positionOnlineMode.bg_loading_answer_me),this.addChild(this.bg),this.bgLoading=new rt(this.positionOnlineMode.bg_sansang_answer_me),this.addChild(this.bgLoading),this.maskLoading=new Phaser.Graphics(game,this.bgLoading.width/2,this.bgLoading.height/2),this.maskLoading.anchor.setTo(.5,.5),this.addChild(this.maskLoading),this.bgLoading.mask=this.maskLoading,this.drawMask(),this.timerToCountTime=this.game.time.create(!0),this.timerToCountTime.loop(50,this.onTimerToCountTime,this)}},{key:"addEventLoadingComplete",value:function(e,t){this.eventLoadingComplete.add(e,t)}},{key:"removeEventLoadingComplete",value:function(e,t){this.eventLoadingComplete.remove(e,t)}},{key:"dispatchEventLoadingComplete",value:function(){this.timerToCountTime.destroy(),this.eventLoadingComplete.dispatch()}},{key:"onTimerToCountTime",value:function(){this.drawMask()}},{key:"drawMask",value:function(){this.beginLoad&&this.loaderPerc<100&&(this.loaderPerc+=this.constLoading,this.loaderPerc>this.maxLoading&&(this.loaderPerc=this.maxLoading,this.loaderPerc),this.maskLoading.clear(),this.maskLoading.beginFill(16777215),this.maskLoading.rotation+=.1,100===this.loaderPerc?this.maskLoading.arc(0,0,this.bgLoading.width/2+4*this.mainData.scale,this.game.math.degToRad(0),this.game.math.degToRad(360),!0):this.maskLoading.arc(0,0,this.bgLoading.width/2+4*this.mainData.scale,this.game.math.degToRad(270),this.game.math.degToRad(270-3.6*this.loaderPerc),!0),this.maskLoading.endFill())}},{key:"setMaxLoading",value:function(e){this.maxLoading=e}},{key:"setBeginLoad",value:function(){this.timerToCountTime.start(),this.beginLoad=!0}},{key:"destroy",value:function(){this.maskLoading.clear(),this.timerToCountTime.stop(),this.timerToCountTime.destroy(),jT(UT(t.prototype),"destroy",this).call(this)}}])&&NT(n.prototype,i),o&&NT(n,o),t}();function HT(e){return(HT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function VT(e,t){return!t||"object"!==HT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function WT(e){return(WT=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qT(e,t){return(qT=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var KT=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),VT(this,WT(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qT(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.positionOnlineMode=this.mainData.positionCreateRoom,this.bg=new rt(this.positionOnlineMode.bg_me_answer1),this.bg.anchor.setTo(.5,.5),this.bg.x=this.bg.width/2,this.bg.y=this.bg.height/2,this.addChild(this.bg),this.bgWin=new rt(this.positionOnlineMode.bg_win_me_answer1),this.bgWin.anchor.setTo(.5,.5),this.bgWin.x=this.bgWin.width/2,this.bgWin.y=this.bgWin.height/2,this.addChild(this.bgWin),this.loading=new ZT,this.loading.visible=!1,this.addChild(this.loading),this.fail=new rt(this.positionOnlineMode.bg_me_fail),this.fail.x=(this.bgWin.width-this.fail.width)/2,this.fail.y=(this.bgWin.height-this.fail.height)/2,this.addChild(this.fail),this.txtTime=new _t(this.positionOnlineMode.bg_me_txt_time,""),this.addChild(this.txtTime),this.setDefault()}},{key:"setBeginLoad",value:function(){this.loading.visible=!0,this.loading.setBeginLoad()}},{key:"setDefault",value:function(){this.bg.visible=!0,this.bgWin.visible=!1,this.fail.visible=!1,this.txtTime.text=""}},{key:"setData",value:function(e){this.bg.visible=!1,this.bgWin.visible=!0,this.loading.visible=!1,e.correct_answer?(this.txtTime.text=this.financial(e.time),this.txtTime.x=(this.bgWin.width-this.txtTime.width)/2,this.txtTime.y=(this.bgWin.height-this.txtTime.height)/2+3*this.mainData.scale):this.fail.visible=!0}},{key:"alpha",set:function(e){if(this.children)for(var t=0;t<this.children.length;t++)this.children[t].alpha=e}}])&&QT(n.prototype,i),o&&QT(n,o),t}();function zT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var YT=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"ONLINE_MODE_GENRES_REQUEST",get:function(){return"ONLINE_MODE_GENRES_REQUEST"}},{key:"ONLINE_MODE_GENRES_RESPONSE",get:function(){return"ONLINE_MODE_GENRES_RESPONSE"}},{key:"ONLINE_MODE_BETS_REQUEST",get:function(){return"ONLINE_MODE_BETS_REQUEST"}},{key:"ONLINE_MODE_BETS_RESPONSE",get:function(){return"ONLINE_MODE_BETS_RESPONSE"}},{key:"ONLINE_MODE_PLAYLISTS_REQUEST",get:function(){return"ONLINE_MODE_PLAYLISTS_REQUEST"}},{key:"ONLINE_MODE_PLAYLISTS_RESPONSE",get:function(){return"ONLINE_MODE_PLAYLISTS_LIST_RESPONSE"}},{key:"ONLINE_MODE_FIND_GAME_REQUEST",get:function(){return"ONLINE_MODE_FIND_GAME_REQUEST"}},{key:"ONLINE_MODE_FIND_GAME_RESPONSE",get:function(){return"ONLINE_MODE_FIND_GAME_RESPONSE"}},{key:"JOIN_ROOM",get:function(){return"JOIN_ROOM"}},{key:"USER_EXIT_ROOM",get:function(){return"USER_EXIT_ROOM"}},{key:"USER_ENTER_ROOM",get:function(){return"USER_ENTER_ROOM"}},{key:"ONLINE_MODE_USER_COUNT_BROADCAST",get:function(){return"ONLINE_MODE_USER_COUNT_BROADCAST"}},{key:"ONLINE_MODE_SERVER_QUESTIONS_SEND",get:function(){return"ONLINE_MODE_SERVER_QUESTIONS_SEND"}},{key:"ONLINE_MODE_GAME_START",get:function(){return"ONLINE_MODE_GAME_START"}},{key:"ONLINE_MODE_USER_SELECTED_ANSWER_REQUEST",get:function(){return"ONLINE_MODE_USER_SELECTED_ANSWER_REQUEST"}},{key:"ONLINE_MODE_USER_SELECTED_ANSWER_RESPONSE",get:function(){return"ONLINE_MODE_USER_SELECTED_ANSWER_RESPONSE"}},{key:"ONLINE_MODE_MOVE_TO_NEXT_QUESTION",get:function(){return"ONLINE_MODE_MOVE_TO_NEXT_QUESTION"}},{key:"ONLINE_MODE_GAME_RESULT",get:function(){return"ONLINE_MODE_GAME_RESULT"}},{key:"ONLINE_MODE_ROOM_GAME_RESULT",get:function(){return"ONLINE_MODE_ROOM_GAME_RESULT"}},{key:"ONLINE_MODE_GAME_FINISH",get:function(){return"ONLINE_MODE_GAME_FINISH"}},{key:"ONLINE_GAME_START_WAITING_PLAYER_COUNTDOWN",get:function(){return"ONLINE_GAME_START_WAITING_PLAYER_COUNTDOWN"}},{key:"ONLINE_GAME_STOP_WAITING_PLAYER_COUNTDOWN",get:function(){return"ONLINE_GAME_STOP_WAITING_PLAYER_COUNTDOWN"}},{key:"ONLINE_MODE_COUNT_USER_ONLINE_REQUEST",get:function(){return"ONLINE_MODE_COUNT_USER_ONLINE_REQUEST"}},{key:"ONLINE_MODE_COUNT_USER_ONLINE_RESPONSE",get:function(){return"ONLINE_MODE_COUNT_USER_ONLINE_RESPONSE"}}],(n=null)&&zT(t.prototype,n),i&&zT(t,i),e}();function JT(e){return(JT="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XT(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $T(e,t){return!t||"object"!==JT(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eI(e,t,n){return(eI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=tI(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function tI(e){return(tI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nI(e,t){return(nI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iI=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=$T(this,tI(t).call(this,game,0,0,null,e,n))).idx=-1,i.afterCreate(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nI(e,t)}(t,Phaser.Button),n=t,(i=[{key:"afterCreate",value:function(){this.ktSetAva=!0,this.positionOnlineMode=z.instance().positionDefaultSource,this.noChoose=!1,this.bg=new Zt(this.positionOnlineMode.bg_answer_question),this.addChild(this.bg),this.bgNoChoose=new Zt(this.positionOnlineMode.bg_answer_question_nochoose),this.bgNoChoose.visible=!1,this.addChild(this.bgNoChoose),this.txtAnswer=new _t(this.positionOnlineMode.text_answer_question),this.addChild(this.txtAnswer),this.ava=new pc,this.ava.setSize(36*z.instance().scale,36*z.instance().scale),this.ava.x=9*z.instance().scale,this.ava.y=(this.bg.height-this.ava.height)/2,this.addChild(this.ava),this.setAva(TF.instance().dataMySeft.avatar)}},{key:"setNoChoose",value:function(){this.noChoose=!0}},{key:"setAva",value:function(e){this.ktSetAva&&(this.ktSetAva=!1,this.ava.setAvatar(e,1))}},{key:"setTextNoChoose",value:function(){LogConsole.log("setTextNoChoose : "+this.idx),this.bgNoChoose.visible=!0,this.bg.visible=!1,this.txtAnswer.changeStyle({fill:"#807d8d"})}},{key:"setDefaultText",value:function(){LogConsole.log("setDefaultText"+this.idx),this.bgNoChoose.visible=!1,this.bg.visible=!0,this.ava.visible=!1,this.txtAnswer.changeStyle({fill:"black"})}},{key:"setTrueText",value:function(){LogConsole.log("setTrueText"+this.idx),this.bgNoChoose.visible=!1,this.bg.visible=!0,this.txtAnswer.changeStyle({fill:"#30FF77"})}},{key:"setFailText",value:function(){LogConsole.log("setFailText"+this.idx),this.bgNoChoose.visible=!1,this.bg.visible=!0,this.txtAnswer.changeStyle({fill:"#ff0000"})}},{key:"setChooseAnswer",value:function(){this.ava.visible=!0}},{key:"setConstX",value:function(e){this.constX=e}},{key:"setData",value:function(e,t){this.noChoose=!1,this.idx=t,this.txtAnswer.setText(e),this.txtAnswer.x=(this.bg.width-this.txtAnswer.width)/2,this.txtAnswer.y=(this.bg.height-this.txtAnswer.height)/2,this.setDefaultText(),this.x=game.width,game.add.tween(this).to({x:this.constX},300,Phaser.Easing.Power1,!0,500+200*t)}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),eI(tI(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"getIdx",value:function(){return this.idx}},{key:"hideAnswer",value:function(e){this.x=this.constX,game.add.tween(this).to({x:-this.width-100},300,Phaser.Easing.Power1,!0,100*e)}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&XT(n.prototype,i),o&&XT(n,o),t}();function oI(e){return(oI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function aI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function sI(e,t){return!t||"object"!==oI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rI(e){return(rI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lI(e,t){return(lI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hI=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),sI(this,rI(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lI(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.eventCompleteTime=new Phaser.Signal,this.timerToCountTime=null,this.bg=new Phaser.Image(game,0,0,null),this.bg.x=0,this.bg.y=0,this.addChild(this.bg),this.style={font:"40px Arial",fill:"white"},this.txtClock=new Phaser.Text(game,0,0,"",this.style),this.txtClock.x=0,this.txtClock.y=0,this.addChild(this.txtClock)}},{key:"addEventCompleteTime",value:function(e,t){this.eventCompleteTime.add(e,t)}},{key:"addEventCompleteTime",value:function(e,t){this.eventCompleteTime.remove(e,t)}},{key:"dispatchEventCompleteTime",value:function(){this.eventCompleteTime.dispatch()}},{key:"setTextTimer",value:function(){var e="00",t=parseInt(this.countNumber/10);e=t<10?"0"+t:t,this.txtClock.text=e}},{key:"countTimer",value:function(e){this.countNumber=10*e,this.setTextTimer(),this.stopCountTime(),this.timerToCountTime=this.game.time.create(!0),this.timerToCountTime.loop(100,this.onTimerToCountTime,this),this.timerToCountTime.start()}},{key:"onTimerToCountTime",value:function(){this.countNumber--,this.countNumber<0&&(this.countNumber=0),0===this.countNumber&&(this.dispatchEventCompleteTime(),this.stopCountTime()),this.setTextTimer()}},{key:"getTime",value:function(){return this.countNumber/10}},{key:"stopCountTime",value:function(){null!==this.timerToCountTime&&(this.timerToCountTime.stop(),this.timerToCountTime.destroy(),this.timerToCountTime=null)}},{key:"destroy",value:function(){this.txtClock.destroy(),this.timerToCountTime&&this.timerToCountTime.destroy()}}])&&aI(n.prototype,i),o&&aI(n,o),t}();function cI(e){return(cI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function dI(e,t){return!t||"object"!==cI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fI(e,t,n){return(fI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=pI(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function pI(e){return(pI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gI(e,t){return(gI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yI=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=dI(this,pI(t).call(this,e,n,i))).positionCreateRoom=z.instance().positionCreateRoom,o.countTicket=new ln(o.positionCreateRoom.question_button_bodapan_count_mic,TF.instance().dataMySeft.support_item),o.addChild(o.countTicket),o.iconMic=new rt(o.positionCreateRoom.question_button_bodapan_mic),o.addChild(o.iconMic),o.labelMoney=new _t(o.positionCreateRoom.question_button_bodapan_txt_money,"-1"),o.labelMoney.setTextBounds(0,0,100*z.instance().scale,40*z.instance().scale),o.addChild(o.labelMoney),o.lbBo2dapan=new _t(o.positionCreateRoom.question_button_bodapan_txt_bo2dapan,"BỎ 2 ĐÁP ÁN"),o.lbBo2dapan.setTextBounds(0,0,205*z.instance().scale,46*z.instance().scale),o.addChild(o.lbBo2dapan),o.addEvent(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gI(e,t)}(t,pt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this)}},{key:"removeEvent",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this)}},{key:"userVarsUpdate",value:function(){this.countTicket.setText(TF.instance().dataMySeft.support_item)}},{key:"destroy",value:function(){this.removeEvent(),fI(pI(t.prototype),"destroy",this).call(this)}}])&&uI(n.prototype,i),o&&uI(n,o),t}();function mI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var vI=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t,n,i){var o=new SFS2X.SFSObject;return o.putInt("answer_index",t),o.putInt("correct_answer",n),o.putFloat("answer_time",i),o.putInt("question_index",e),o}}],(n=null)&&mI(t.prototype,n),i&&mI(t,i),e}();function wI(e){return(wI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _I(e,t){return!t||"object"!==wI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SI(e){return(SI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EI(e,t){return(EI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CI=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_I(this,SI(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EI(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.positionCreateRoom=this.mainData.positionCreateRoom,this.txtQuestion=new _t(this.positionCreateRoom.text_question_playroom,""),this.txtQuestion.x=0,this.txtQuestion.y=3*z.instance().scale,this.txtQuestion.setTextBounds(0,0,game.width,33*z.instance().scale),this.addChild(this.txtQuestion),this.playerChoose=new _t(this.positionCreateRoom.text_question_playroom,""),this.playerChoose.x=0,this.playerChoose.y=30*z.instance().scale,this.playerChoose.setTextBounds(0,0,game.width,33*z.instance().scale),this.addChild(this.playerChoose)}},{key:"setText",value:function(e){var t="";"SONG"==e&&(t="Tìm tên bài hát"),"SINGER"==e&&(t="Tìm tên ca sĩ"),LogConsole.log("strQuestion :"+t),this.txtQuestion.setText(t)}},{key:"setPlayerChoose",value:function(e){""===e?(this.playerChoose.clearColors(),this.playerChoose.text="Được chọn bởi hệ thống"):(this.playerChoose.addColor("#FFA238",9),this.playerChoose.text="Chọn bởi "+e)}},{key:"destroy",value:function(){this.txtQuestion.destroy()}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this.txtQuestion.height}},{key:"alpha",set:function(e){if(this.children)for(var t=0;t<this.children.length;t++)this.children[t].alpha=e}}])&&bI(n.prototype,i),o&&bI(n,o),t}();function kI(e){return(kI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OI(e,t){return!t||"object"!==kI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RI(e,t,n){return(RI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xI(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xI(e){return(xI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TI(e,t){return(TI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var II=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=OI(this,xI(t).call(this,game,0,0,null))).event={close:new Phaser.Signal},i.idxNextQuestion=null,i.ktSendChoose=!1,i.eventChooseAnswer=new Phaser.Signal,i.eventShowQuestion=new Phaser.Signal,i.idx=n,i.arrQuestion=e,i.ktChooseHelp=!1,i.answerSelect=-1,i.buildQuestionByIndex(),i.tween=null,i.addEvent(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TI(e,t)}(t,Mt),n=t,(i=[{key:"addEventChooseAnswer",value:function(e,t){this.eventChooseAnswer.add(e,t)}},{key:"removeEventChooseAnswer",value:function(e,t){this.eventChooseAnswer.remove(e,t)}},{key:"dispatchEventChooseAnswer",value:function(e){this.eventChooseAnswer.dispatch(e)}},{key:"addEventShowQuestion",value:function(e,t){this.eventShowQuestion.add(e,t)}},{key:"removeEventShowQuestion",value:function(e,t){this.eventShowQuestion.add(e,t)}},{key:"dispatchEventShowQuestion",value:function(){this.eventShowQuestion.dispatch(this.idx)}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().events.onPublicMessage.add(this.onPublicMessage,this)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),TF.instance().events.onPublicMessage.remove(this.onPublicMessage,this)}},{key:"onPublicMessage",value:function(e){var t=this;e.message===Et.CHAT_ONLINE_MODE&&(e.sender.isItMe&&(this.btnChat.inputEnabled=!1,setTimeout(function(){t.btnChat.parent&&(t.btnChat.inputEnabled=!0)},3e3)))}},{key:"getData",value:function(e){var t;switch(e.cmd){case YT.ONLINE_MODE_MOVE_TO_NEXT_QUESTION:case nS.ONLINE_MODE_ROOM_MOVE_TO_NEXT_QUESTION:!1===this.ktSend&&(this.ktSend=!0);for(var n=0;n<this.arrAnswer.length;n++)this.arrAnswer[n].setTextNoChoose();t=this.arrQuestion[this.idx].correct_answer,this.arrAnswer[t-1].setTrueText(),-1!==this.answerSelect&&this.answerSelect!==t&&this.arrAnswer[this.answerSelect-1].setFailText(),this.removeNextQuestion(),this.idxNextQuestion=game.time.events.add(2*Phaser.Timer.SECOND,this.buildNextQuestion,this,e.params.getInt(Qh.question_index));break;case YT.ONLINE_MODE_GAME_RESULT:case YT.ONLINE_MODE_ROOM_GAME_RESULT:for(var i=0;i<this.arrAnswer.length;i++)this.arrAnswer[i].setTextNoChoose();t=this.arrQuestion[this.idx].correct_answer,this.arrAnswer[t-1].setTrueText(),-1!==this.answerSelect&&this.answerSelect!==t&&this.arrAnswer[this.answerSelect-1].setFailText(),this.buildEndGame();break;case nS.SUPPORT_RESPONSE:break;case YT.ONLINE_MODE_USER_SELECTED_ANSWER_RESPONSE:case nS.ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_RESPONSE:var o=e.params.getBool(fa.is_correct_answer),a=e.params.getInt(fa.user_id),s=e.params.getInt(fa.streak);!0===o&&a===TF.instance().dataMySeft.user_id&&s>1&&this.showStreakAnswer(s,this.arrQuestion[this.idx].correct_answer)}}},{key:"buildEndGame",value:function(){if(!1===this.ktSendChoose){var e={idx:this.idx,correct_answer:!1,time:10};this.arrQuestion[this.idx].playerChoose=e,this.dispatchEventChooseAnswer(e)}else this.ktSendChoose=!1;El.instance().removeSound()}},{key:"removeNextQuestion",value:function(){null!==this.idxNextQuestion&&game.time.events.remove(this.idxNextQuestion)}},{key:"buildNextQuestion",value:function(e){if(LogConsole.log("buildNextQuestion : "+e),this.streakAnswer.setDefault(),this.idx<this.arrQuestion.length)if(!1===this.ktSendChoose){var t={idx:this.idx,correct_answer:!1,time:10};this.arrQuestion[this.idx].playerChoose=t,this.dispatchEventChooseAnswer(t)}else this.ktSendChoose=!1;this.idx=e-1,this.idx>this.arrQuestion.length-1?this.ktSend=!0:(this.buildQuestionByIndex(),this.dispatchEventShowQuestion())}},{key:"buildHelpAnswer",value:function(){var e=[],t=0;for(t=1;t<5;t++)t===this.arrQuestion[this.idx].correct_answer||e.push(t);for(LogConsole.log("correct_answer "+this.arrQuestion[this.idx].correct_answer),LogConsole.log(e),e.splice(game.rnd.integerInRange(0,2),1),LogConsole.log(e),t=0;t<e.length;t++)LogConsole.log("arrAnswerFail[i] : "+e[t]),this.arrAnswer[e[t]-1].setTextNoChoose(),this.arrAnswer[e[t]-1].setNoChoose()}},{key:"afterCreate",value:function(){this.positionCreateRoom=JSON.parse(game.cache.getText("positionCreateRoom")),this.streakAnswer=null,this.txtQuestion=new CI,this.txtQuestion.x=0,this.txtQuestion.y=0,this.addChild(this.txtQuestion);var e=new Phaser.Group(game,0,0,null);this.listAnswer=new Vo(game,e,new Phaser.Rectangle(0,0,game.width,500*z.instance().scale),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),e.x=0,e.y=75*z.instance().scale,this.addChild(e),this.arrAnswer=[],this.listAnswer.removeAll(),this.listAnswer.reset();for(var t=0;t<4;t++){var n=new iI(this.chooseAnswer,this),i=(game.width-n.width)/2;n.x=i,n.setConstX(i),this.listAnswer.add(n),this.arrAnswer.push(n)}this.clock=new hI,this.clock.addEventCompleteTime(this.timeComplete,this),this.clock.x=game.width-100,this.clock.y=-20,this.btnBo2DapAn=new yI(this.positionCreateRoom.question_button_bodapan_bg,this.chooseBo2Dapan,this),this.addChild(this.btnBo2DapAn),this.btnChat=new pt(this.positionCreateRoom.question_button_chat,this.chooseChat,this),this.addChild(this.btnChat),this.buildStreakAnswer()}},{key:"chooseChat",value:function(){IE.instance().addChatOnlineMode()}},{key:"chooseBo2Dapan",value:function(){LogConsole.log("chooseBo2Dapan"),TF.instance().dataMySeft.support_item>0?!1===this.ktChooseHelp&&!1===this.ktSend&&(this.ktChooseHelp=!0,TF.instance().dataMySeft.support_item=TF.instance().dataMySeft.support_item-1,TF.instance().dataMySeft.support_item<0&&(TF.instance().dataMySeft.support_item=0),this.buildHelpAnswer(),TF.instance().sendData(nS.SUPPORT_REQUEST,null)):IE.instance().addDialog("Bạn không đủ Míc")}},{key:"timeComplete",value:function(){}},{key:"buildQuestionByIndex",value:function(){LogConsole.log("buildQuestionByIndex - "+this.idx),this.answerSelect=-1,this.clock.countTimer(10.5),this.ktSend=!1,this.ktChooseHelp=!1,El.instance().playsound(this.arrQuestion[this.idx].file_path),this.txtQuestion.setText(this.arrQuestion[this.idx].question_type),this.txtQuestion.setPlayerChoose(this.arrQuestion[this.idx].user_choose);for(var e=0;e<this.arrQuestion[this.idx].arrAnser.length;e++)this.arrAnswer[e].setData(this.arrQuestion[this.idx].arrAnser[e],e)}},{key:"hideQuestion",value:function(){for(var e=0;e<this.arrQuestion[this.idx].arrAnser.length;e++)this.arrAnswer[e].hideAnswer(e);this.txtQuestion.setText(""),this.tween=game.add.tween(this).to({y:this.y},500,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.handleComplete,this)}},{key:"handleComplete",value:function(){this.event.close.dispatch()}},{key:"chooseAnswer",value:function(e){if(LogConsole.log("chooseAnswer"),LogConsole.log(e),0==this.ktSend)if(e.noChoose);else{var t=this.clock.getTime();if(this.ktSend=!0,t>0){for(var n=0;n<this.arrAnswer.length;n++)this.arrAnswer[n].setTextNoChoose();e.setChooseAnswer();var i={idx:this.idx,correct_answer:!1,time:0};this.answerSelect=e.getIdx()+1;var o=10.5-t-.5;o>10&&(o=10),o<.1&&(o=.1);var a=this.arrQuestion[this.idx].correct_answer;LogConsole.log("this.answerSelect : "+this.answerSelect),LogConsole.log("correct_answer : "+a),i.time=o,this.answerSelect==a?(LogConsole.log("dung-----------"),e.setTrueText(),i.correct_answer=!0,Ur.instance().playlist.setExpPlaylistById(this.arrQuestion[this.idx].playlist_id)):(LogConsole.log("sai-----------"),e.setFailText()),this.arrQuestion[this.idx].playerChoose=i,this.dispatchEventChooseAnswer(i),this.ktSendChoose=!0;var s="";s=this.mainData.modeplay===this.mainData.MODEPLAY.OnlineMode?YT.ONLINE_MODE_USER_SELECTED_ANSWER_REQUEST:nS.ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_REQUEST,TF.instance().sendData(s,vI.begin(this.idx+1,this.answerSelect,a,o))}else LogConsole.log("het thoi gian tra loi cau hoi")}}},{key:"buildStreakAnswer",value:function(){this.removeStreakAnswer(),this.streakAnswer=new Ld,this.streakAnswer.x=(this.game.width-this.streakAnswer.width)/2,this.addChild(this.streakAnswer),this.hideStreakAnswer()}},{key:"hideStreakAnswer",value:function(){this.streakAnswer.visible=!1}},{key:"showStreakAnswer",value:function(e,t){this.streakAnswer.visible=!0,this.streakAnswer.setStreak(e),console.log("showStreakAnswer : "+t),2===t?this.streakAnswer.y=280:3===t?this.streakAnswer.y=50:1===t?this.streakAnswer.y=235:4===t&&(this.streakAnswer.y=105)}},{key:"removeStreakAnswer",value:function(){console.log(this.streakAnswer),null!==this.streakAnswer&&(this.removeChild(this.streakAnswer),this.streakAnswer.destroy(),this.streakAnswer=null)}},{key:"getArrQuestion",value:function(){return this.arrQuestion}},{key:"destroy",value:function(){El.instance().removeAllSound(),this.removeEvent(),this.eventChooseAnswer.dispose(),this.txtQuestion.destroy(),this.listAnswer.removeAll(),this.listAnswer.destroy(),this.clock.destroy(),null!==this.tween&&(this.tween.stop(),game.tweens.remove(this.tween),this.tween=null),RI(xI(t.prototype),"destroy",this).call(this)}}])&&PI(n.prototype,i),o&&PI(n,o),t}();function AI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var LI=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){for(var n=e.getSFSArray(fa.players),i=0;i<n.size();i++)for(var o=n.getSFSObject(i),a=0;a<t.length;a++){var s=t[a].getData();if(null!=s&&s.user_id==o.getInt(fa.user_id)){s.score=o.getInt(fa.score),s.diamond_change=o.getInt(fa.diamond_change),s.exp_score=o.getInt(fa.exp_score),t[a].setCurrentData(s);break}}}}],(n=null)&&AI(t.prototype,n),i&&AI(t,i),e}();function GI(e){return(GI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function MI(e){return(MI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function NI(e,t){return(NI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function BI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var jI=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=MI(t).call(this,game,0,0,null))||"object"!==GI(a)&&"function"!=typeof a?BI(o):a).event={play:new Phaser.Signal},i.idx=n,i.data=new Zh,i.data=Object.assign({},i.data,e),i.ktPlay=!1,i.songListen=null,i.btnPlaySound=null,i.positionOnlineMode=i.mainData.positionCreateRoom,i.bg=new Phaser.Button(game,0,0,"bg-playlist",i.chooseChitiet,BI(BI(i))),i.bg.alpha=0,i.bg.width=i.width-180*z.instance().scale,i.bg.height=i.height,i.bg.x=180*z.instance().scale,i.addChild(i.bg),e.playerChoose.correct_answer?i.icon_true=new rt(i.positionOnlineMode.icon_true_result):i.icon_true=new rt(i.positionOnlineMode.icon_fail_result),i.addChild(i.icon_true),i.txtTime=new _t(i.positionOnlineMode.text_time_player_list_result,i.financial(e.playerChoose.time)+"s"),e.playerChoose.correct_answer?i.txtTime.changeStyle({fill:"green"}):i.txtTime.changeStyle({fill:"red"}),i.txtTime.x=i.icon_true.x+(i.icon_true.width-i.txtTime.width)/2,i.addChild(i.txtTime),i.ava=new dh,i.ava.setSize(84*i.mainData.scale,84*i.mainData.scale),i.ava.x=90*i.mainData.scale,i.ava.y=27*i.mainData.scale,i.ava.beginLoad(i.data.song.thumb,i.idx),i.addChild(i.ava),i.btnPlaySound=new pt(i.positionOnlineMode.button_play_sound_player_list_result,i.choosePlaySound,BI(BI(i))),i.addChild(i.btnPlaySound),i.txtNameSong=new _t(i.positionOnlineMode.text_name_song_player_list_result,i.formatName(i.data.song.song,22,!0)),i.txtNameSong.setTextBounds(0,0,375*z.instance().scale,31*z.instance().scale),i.addChild(i.txtNameSong),i.txtNameCasi=new _t(i.positionOnlineMode.text_name_casi_player_list_result,i.data.song.singer),i.addChild(i.txtNameCasi),i.line=new rt(i.positionOnlineMode.line_item_player_list),i.line.width=i.width-60*i.mainData.scale,i.line.x=35*z.instance().scale,i.line.y=i.height,i.addChild(i.line),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&NI(e,t)}(t,Mt),n=t,(i=[{key:"stopAudio",value:function(){this.removeBtnPlay(),this.btnPlaySound=new pt(this.positionOnlineMode.button_play_sound_player_list_result,this.choosePlaySound,this),this.addChild(this.btnPlaySound)}},{key:"chooseChitiet",value:function(){LogConsole.log("chooseChitiet"),IE.instance().addDetailSong(this.data.song)}},{key:"choosePlaySound",value:function(){this.event.play.dispatch(this.data.song.id)}},{key:"playSound",value:function(){LogConsole.log("playSound"),!1===this.ktPlay?(this.ktPlay=!0,El.instance().playsound(this.data.song.listenLink)):El.instance().resumeSound(),this.removeBtnPlay(),this.btnPlaySound=new pt(this.positionOnlineMode.button_pause_sound_player_list_result,this.choosePauseSound,this),this.addChild(this.btnPlaySound)}},{key:"removeBtnPlay",value:function(){null!==this.btnPlaySound&&(this.removeChild(this.btnPlaySound),this.btnPlaySound.destroy(),this.btnPlaySound=null)}},{key:"choosePauseSound",value:function(){this.pauseSound()}},{key:"pauseSoundOut",value:function(){this.ktPlay=!1,this.stopAudio()}},{key:"pauseSound",value:function(){this.ktPlay&&El.instance().pauseSound(),this.stopAudio()}},{key:"width",get:function(){return 570*z.instance().scale}},{key:"height",get:function(){return 140*z.instance().scale}}])&&DI(n.prototype,i),o&&DI(n,o),t}();function UI(e){return(UI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZI(e,t){return!t||"object"!==UI(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HI(e,t,n){return(HI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=QI(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function QI(e){return(QI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VI(e,t){return(VI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var WI=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=ZI(this,QI(t).call(this,game,e.x,e.y,e.nameAtlas,i,o,null,e.nameSprite))).lbChoiLai=new _t(e.button_reset_lb_choilai_player_list_result,"CHƠI LẠI"),a.addChild(a.lbChoiLai),""!=n?(a.iconKimCuong=new rt(e.button_reset_icon_KimCuong_player_list_result),a.addChild(a.iconKimCuong),a.lbMoney=new _t(e.button_reset_lb_money_player_list_result,"-"+n),a.lbMoney.x=a.iconKimCuong.x-a.lbMoney.width-10,a.addChild(a.lbMoney)):a.lbChoiLai.x=(a.width-a.lbChoiLai.width)/2,a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VI(e,t)}(t,Phaser.Button),n=t,(i=[{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),HI(QI(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"destroy",value:function(){this.iconKimCuong&&this.iconKimCuong.destroy(),this.lbChoiLai.destroy(),this.lbMoney&&this.lbMoney.destroy(),HI(QI(t.prototype),"destroy",this).call(this)}}])&&FI(n.prototype,i),o&&FI(n,o),t}();function qI(e){return(qI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KI(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zI(e,t,n){return(zI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=YI(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function YI(e){return(YI=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function JI(e,t){return(JI=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function XI(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var $I=function(e){function t(e,n){var i,o,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=YI(t).call(this,game,0,0,null))||"object"!==qI(a)&&"function"!=typeof a?XI(o):a).roomBet=n,i.event={replay:new Phaser.Signal,close:new Phaser.Signal,exit:new Phaser.Signal},i.tween=null,i.ktReplay=!1,i.positionOnlineMode=i.mainData.positionCreateRoom,i.bgPlayerList=new Zt(i.positionOnlineMode.bg_player_list_result),i.bgPlayerList.x=35*z.instance().scale,i.bgPlayerList.y=620*z.instance().scale,i.bgPlayerList.width=570*z.instance().scale,i.bgPlayerList.height=485*z.instance().scale,i.addChild(i.bgPlayerList);var s=new Phaser.Group(game,0,0,null);i.listPlayer=new Vo(game,s,new Phaser.Rectangle(0,0,i.bgPlayerList.width,i.bgPlayerList.height-100*i.mainData.scale),{direction:"y",padding:5*z.instance().scale,searchForClicks:!0}),i.bgPlayerList.addChild(s);for(var r=0;r<e.length;r++){var l=new jI(e[r],r);l.event.play.add(i.playSound,XI(XI(i))),i.listPlayer.add(l)}return i.btnHome=new pt(i.positionOnlineMode.button_home_player_list_result,i.chooseExit,XI(XI(i))),i.btnHome.x=35*z.instance().scale,i.btnHome.y=400*z.instance().scale,i.addChild(i.btnHome),i.btnChoiLai=new WI(i.positionOnlineMode.button_reset_bg_player_list_result,i.roomBet,i.chooseChoiLai,XI(XI(i))),i.btnChoiLai.x=140*z.instance().scale,i.btnChoiLai.y=400*z.instance().scale,i.addChild(i.btnChoiLai),i.tween=game.add.tween(i.bgPlayerList).to({y:0},500,Phaser.Easing.Power1,!0,300),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JI(e,t)}(t,Mt),n=t,(i=[{key:"playSound",value:function(e){for(var t=0;t<this.listPlayer.grp.children.length;t++){var n=this.listPlayer.grp.children[t];n.data.song.id!==e?n.pauseSoundOut():n.playSound()}}},{key:"tweenHide",value:function(){this.tween=game.add.tween(this).to({y:game.height+100*z.instance().scale},500,Phaser.Easing.Power1,!0),this.tween.onComplete.add(this.handleComplete,this)}},{key:"handleComplete",value:function(){this.event.close.dispatch()}},{key:"chooseExit",value:function(){LogConsole.log("chooseExit"),this.btnHome.inputEnabled=!1,this.event.exit.dispatch()}},{key:"chooseChoiLai",value:function(){LogConsole.log("chooseChoiLai : "+this.ktReplay),!0===this.ktReplay&&(LogConsole.log("SocketController.instance().dataMySeft.diamond : "+TF.instance().dataMySeft.diamond),LogConsole.log("roomBet : "+this.roomBet),TF.instance().dataMySeft.diamond<this.roomBet?(this.event.exit.dispatch(),IE.instance().addDialog("Bạn không đủ Kim Cương để tiếp tục chơi.")):(this.btnHome.inputEnabled=!1,this.tweenHide(),this.event.replay.dispatch()))}},{key:"destroy",value:function(){this.listPlayer.removeAll(),this.listPlayer.destroy(),null!==this.tween&&(this.tween.stop(),game.tweens.remove(this.tween),this.tween=null),zI(YI(t.prototype),"destroy",this).call(this)}}])&&KI(n.prototype,i),o&&KI(n,o),t}();function eA(e){return(eA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function tA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function nA(e){return(nA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iA(e,t){return(iA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function oA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var aA=function(e){function t(e,n,i){var o,a,s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,s=nA(t).call(this,game,0,0,null),(o=!s||"object"!==eA(s)&&"function"!=typeof s?oA(a):s).event={destroy:new Phaser.Signal};var r="#000000";o.positionCreateRoom=o.mainData.positionCreateRoom,e?(r="#ffffff",o.bg=new Zt(n?o.positionCreateRoom.chat_me_left:o.positionCreateRoom.chat_me_right)):o.bg=new Zt(n?o.positionCreateRoom.chat_user_left:o.positionCreateRoom.chat_user_right),o.addChild(o.bg);var l={x:0,y:0,style:{fontSize:20,fill:r}};o.txtContent=new _t(l,i.label),o.txtContent.y=(o.height-o.txtContent.height)/2,o.addChild(o.txtContent);var h={x:0,y:0,nameAtlas:"popup",nameSprite:i.sprite};o.icon=new rt(h),o.icon.y=(o.height-o.icon.height)/2,o.addChild(o.icon);var c=18*z.instance().scale;return o.txtContent.x=c,o.icon.x=o.txtContent.x+o.txtContent.width+c,o.bg.width=o.txtContent.x+o.txtContent.width+c+o.icon.width+c,setTimeout(function(){o.event.destroy.dispatch(oA(oA(o)))},2e3),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iA(e,t)}(t,Mt),n=t,(i=[{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return 51*z.instance().scale}}])&&tA(n.prototype,i),o&&tA(n,o),t}();function sA(e){return(sA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function lA(e,t){return!t||"object"!==sA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hA(e,t,n){return(hA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=cA(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function cA(e){return(cA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uA(e,t){return(uA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dA=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=lA(this,cA(t).call(this,game,0,0,""))).id=n,i.event={destroy:new Phaser.Signal},i.positionCreateRoom=i.mainData.positionCreateRoom,i.bgChat=new Zt(i.positionCreateRoom.chat_waitting_bg_chat),i.lbChat=new _t(i.positionCreateRoom.chat_waitting_text_chat,e),console.log("this.lbChat.width : "+i.lbChat.width),console.log("this.lbChat.height : "+i.lbChat.height),i.lbChat.height<47?i.bgChat.height=67:i.bgChat.height=i.lbChat.height+20,i.lbChat.width<35?i.bgChat.width=65:i.bgChat.width=i.lbChat.width+30,i.addChild(i.bgChat),i.lbChat.x=(i.bgChat.width-i.lbChat.width)/2,i.lbChat.y=(i.bgChat.height-i.lbChat.height)/2,i.addChild(i.lbChat),i.iconArrow=new rt(i.positionCreateRoom.chat_waitting_icon_arrow),i.iconArrow.x=(i.bgChat.width-i.iconArrow.width)/2+5,i.iconArrow.y=i.bgChat.height,i.addChild(i.iconArrow),i.idtimeout=setTimeout(function(){i.event.destroy.dispatch(i.id)},3500),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uA(e,t)}(t,Mt),n=t,(i=[{key:"destroy",value:function(){clearTimeout(this.idtimeout),hA(cA(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return this.bgChat.width}},{key:"height",get:function(){return this.bgChat.height+this.iconArrow.height}}])&&rA(n.prototype,i),o&&rA(n,o),t}();function fA(e){return(fA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gA(e,t){return!t||"object"!==fA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yA(e,t,n){return(yA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=mA(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function mA(e){return(mA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vA(e,t){return(vA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wA=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gA(this,mA(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vA(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={back:new Phaser.Signal},this.listSongResult=null,this.choosePlayList=null,this.listFriend=null,this.idTimeOutShowPlayList=null,this.ktPlay=!1,this.ktStart=!1,this.arrQuestion=[],this.timecount=0,this.ktCountDownPlay=!1,this.timeTween=null,this.timerCountDown=null,this.totalPlayerPlay=0,this.arrMeAnswer=[],this.addMeAnswer=new Phaser.Sprite(game,0,0,null),this.addListChart=new Phaser.Sprite(game,0,0,null),this.addChatWaitting=new Phaser.Sprite(game,0,0,null),this.idxQuestion=0,this.arrScore=[],this.arrChart={},this.arrPlayer=[],this.idMaster=-1,this.roomBet=0,this.idRoom="",this.currentBet=0,this.nameMaster="",this.idShowResult=null,this.ktReplay=!1,this.objChat={},this.startTime=0,this.endTime=0,this.ktshowBadConnection=!1,this.checkSendExit=!1,this.objChatWaitting={},this.arrLocal=[{x:100*z.instance().scale,y:385*z.instance().scale},{x:385*z.instance().scale,y:385*z.instance().scale},{x:100*z.instance().scale,y:690*z.instance().scale},{x:385*z.instance().scale,y:690*z.instance().scale}],this.arrLocalPlay2=[{x:206*z.instance().scale,y:223*z.instance().scale},{x:354*z.instance().scale,y:223*z.instance().scale}],this.arrLocalPlay3=[{x:114*z.instance().scale,y:223*z.instance().scale},{x:276*z.instance().scale,y:223*z.instance().scale},{x:438*z.instance().scale,y:223*z.instance().scale}],this.arrLocalPlay4=[{x:59*z.instance().scale,y:223*z.instance().scale},{x:206*z.instance().scale,y:223*z.instance().scale},{x:354*z.instance().scale,y:223*z.instance().scale},{x:495*z.instance().scale,y:223*z.instance().scale}],this.arrLocalResultWin={x:260*z.instance().scale,y:140*z.instance().scale},this.arrLocalResult2=[{x:275*z.instance().scale,y:420*z.instance().scale}],this.arrLocalResult3=[{x:185*z.instance().scale,y:420*z.instance().scale},{x:365*z.instance().scale,y:420*z.instance().scale}],this.arrLocalResult4=[{x:117*z.instance().scale,y:420*z.instance().scale},{x:275*z.instance().scale,y:420*z.instance().scale},{x:431*z.instance().scale,y:420*z.instance().scale}],this.arrLocalResultAllLose2=[{x:211*z.instance().scale,y:260*z.instance().scale},{x:355*z.instance().scale,y:260*z.instance().scale}],this.arrLocalResultAllLose3=[{x:117*z.instance().scale,y:260*z.instance().scale},{x:275*z.instance().scale,y:260*z.instance().scale},{x:431*z.instance().scale,y:260*z.instance().scale}],this.arrLocalResultAllLose4=[{x:60*z.instance().scale,y:260*z.instance().scale},{x:211*z.instance().scale,y:260*z.instance().scale},{x:355*z.instance().scale,y:260*z.instance().scale},{x:490*z.instance().scale,y:260*z.instance().scale}],this.positionCreateRoom=this.mainData.positionCreateRoom,this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg),this.header=new IR,this.header.setWaittingRoom(),this.header.setIdPhong("dfdsf"),this.header.setNguoiTao("Viet Pv"),this.header.event.back.add(this.chooseBack,this),this.addChild(this.header),this.addChild(this.addListChart),this.buildListPlayer(),this.btnMoiBan=new ln(this.positionCreateRoom.waitting_btn_moiban,"MỜI BẠN",this.chooseMoiBan,this),this.btnMoiBan.y=game.height,this.addChild(this.btnMoiBan),this.btnChoi=new ln(this.positionCreateRoom.waitting_btn_choi,"CHƠI",this.chooseChoi,this),this.btnChoi.y=game.height,this.addChild(this.btnChoi),this.btnChatWaitting=new pt(this.positionCreateRoom.chat_waitting_icon_chat,this.chooseChatWatting,this),this.btnChatWaitting.y=game.height-223,this.addChild(this.btnChatWaitting),this.addChild(this.addChatWaitting),this.txtCounDown=new _t(this.positionCreateRoom.waitting_txt_countdown,""),this.txtCounDown.anchor.set(.5),this.txtCounDown.x=game.width/2,this.addChild(this.txtCounDown),this.txtTrick=new _t(this.positionCreateRoom.waitting_txt_trick,"Hãy chọn nơi có đường truyền tốt  Để tải dữ liệu"),this.txtTrick.visible=!1,this.txtTrick.addColor("#FFA339",33),this.txtTrick.setTextBounds(0,0,game.width,95*this.mainData.scale),this.txtTrick.y=game.height-95*this.mainData.scale,this.addChild(this.txtTrick),this.hideButtonChoi(),this.hideButtonMoiBan(),this.btnMucCuoc=new ln(this.positionCreateRoom.button_muccuoc_room,"10"),this.addChild(this.btnMucCuoc),this.labelMuccuoc=new _t(this.positionCreateRoom.text_muccuoc_room,"Mức cược"),this.labelMuccuoc.x=(game.width-this.labelMuccuoc.width)/2,this.addChild(this.labelMuccuoc),this.lineWin=new rt(this.positionCreateRoom.result_line_win),this.lineWin.visible=!1,this.addChild(this.lineWin),this.txtWin=new _t(this.positionCreateRoom.result_txtWin_win,"Người chiến thắng !!!"),this.txtWin.setTextBounds(0,0,game.width,47*z.instance().scale),this.txtWin.visible=!1,this.addChild(this.txtWin),this.button_share=new pt(this.positionCreateRoom.button_share,this.chooseShare,this),this.button_share.visible=!1,this.addChild(this.button_share,this),this.buildUserJoinRoom(),this.addEvent()}},{key:"chooseShare",value:function(){ui.instance().share()}},{key:"showBetRoom",value:function(){this.btnMucCuoc.visible=!0,this.labelMuccuoc.visible=!0}},{key:"hideBetRoom",value:function(){this.btnMucCuoc.visible=!1,this.labelMuccuoc.visible=!1}},{key:"resetArrayScore",value:function(){this.arrScore=[{idx:0,score:0},{idx:1,score:0},{idx:2,score:0},{idx:3,score:0}]}},{key:"hideButtonMoiBan",value:function(){this.btnMoiBan.inputEnabled=!1}},{key:"showButtonMoiBan",value:function(){this.btnMoiBan.inputEnabled=!0}},{key:"hideButtonChoi",value:function(){this.btnChoi.inputEnabled=!1}},{key:"showButtonChoi",value:function(){this.btnChoi.inputEnabled=!0}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().events.onUserEnterRoom.add(this.userEnterRoom,this),TF.instance().events.onUserExitRoom.add(this.userExitRoom,this),TF.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this),TF.instance().events.onRoomVarsUpdate.add(this.onRoomVarsUpdate,this),TF.instance().events.onPublicMessage.add(this.onPublicMessage,this),De.instance().event.bad_connection.add(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.add(this.chooseExitBadConnection,this),De.instance().event.chooseNoPopupConfirm.add(this.chooseNoPopupConfirm,this)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),TF.instance().events.onUserEnterRoom.remove(this.userEnterRoom,this),TF.instance().events.onUserExitRoom.remove(this.userExitRoom,this),TF.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this),TF.instance().events.onRoomVarsUpdate.remove(this.onRoomVarsUpdate,this),TF.instance().events.onPublicMessage.remove(this.onPublicMessage,this),De.instance().event.bad_connection.remove(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.remove(this.chooseExitBadConnection,this),De.instance().event.chooseNoPopupConfirm.remove(this.chooseNoPopupConfirm,this)}},{key:"chooseNoPopupConfirm",value:function(e){"chooseCanclePopupMoney"===e&&this.chooseBack()}},{key:"checkBadConnection",value:function(){!1===this.ktPlay&&!1===this.ktshowBadConnection&&(this.ktshowBadConnection=!0,IE.instance().addBadConnection())}},{key:"chooseExitBadConnection",value:function(){this.chooseExit()}},{key:"onPublicMessage",value:function(e){if(LogConsole.log("onPublicMessage"),LogConsole.log(e),e.message===Et.CHAT_ONLINE_MODE){var t=e.sender,n=t.isItMe,i=parseInt(t.name);if(e.data.containsKey("label")&&e.data.containsKey("sprite"))for(var o={label:e.data.getUtfString("label"),sprite:e.data.getUtfString("sprite")},a=0,s=0;s<this.arrPlayer.length;s++)if(!1===this.arrPlayer[s].ktEmpty&&(a++,this.arrPlayer[s].getData().user_id===i)){var r=!1;r=2===this.totalPlayerPlay?1!==a:1!==a&&2!==a;var l=new aA(n,r,o);l.event.destroy.add(this.removeItemChat,this),this.addChild(l),r?(l.x=this.arrPlayer[s].x+130*z.instance().scale-l.width,l.x<0&&(l.x=0),l.y=this.arrPlayer[s].y-15*z.instance().scale):(l.x=this.arrPlayer[s].x+55*z.instance().scale,l.y=this.arrPlayer[s].y-15*z.instance().scale),this.objChat[i]=l;break}if(e.data.containsKey("chatWaitting"))for(var h=0;h<this.arrPlayer.length;h++)if(!1===this.arrPlayer[h].ktEmpty&&this.arrPlayer[h].getData().user_id===i){this.removeItemChatWaitting(i);var c=new dA(e.data.getUtfString("chatWaitting"),i);c.event.destroy.add(this.removeItemChatWaitting,this),c.x=this.arrPlayer[h].x+(155-c.width)/2,c.y=this.arrPlayer[h].y+48-c.height,this.addChatWaitting.addChild(c),this.objChatWaitting[i]=c,null!==this.listFriend&&this.listFriend.addChatRoom(e.data.getUtfString("chatWaitting"),t.getVariable("avatar").value);break}}}},{key:"removeItemChatWaitting",value:function(e){this.objChatWaitting.hasOwnProperty(e)&&(this.addChatWaitting.removeChild(this.objChatWaitting[e]),this.objChatWaitting[e].destroy(),this.objChatWaitting[e]=null,delete this.objChatWaitting[e])}},{key:"removeItemChat",value:function(e){e&&(this.removeChild(e),e.destroy(),e=null)}},{key:"buildUserJoinRoom",value:function(){var e=this;LogConsole.log("buildUserJoinRoom"),LogConsole.log(this.mainData.dataJoinRoom.room);var t=this.mainData.dataJoinRoom.room.getUserList();this.idRoom=this.mainData.dataJoinRoom.room.id,this.mainData.modeplay=this.mainData.dataJoinRoom.room.getVariable("mode").value,this.idMaster=this.mainData.dataJoinRoom.room.getVariable(fa.room_master).value,this.roomBet=this.mainData.dataJoinRoom.room.getVariable(fa.bet_place).value,LogConsole.log(" this.roomBet : "+this.roomBet),this.btnMucCuoc.setText(this.roomBet);for(var n=0;n<t.length;n++){var i=t[n],o=this.getDataPlayer(i);this.arrPlayer[n].setData(o,n),this.arrPlayer[n].setMaster(this.idMaster),o.user_id===this.idMaster&&(this.nameMaster=o.user_name),this.totalPlayerPlay++}this.header.setIdPhong(this.idRoom),this.header.setNguoiTao(this.nameMaster),this.checkShowMaster(),TF.instance().dataMySeft.user_id!==this.idMaster&&(this.removeTimeoutShowChoosePlayList(),this.idTimeOutShowPlayList=setTimeout(function(){e.addChoosePlayList()},800)),this.checkShowInviteFriend(),this.checkShowButtonChoi(),this.showButtonWaittingChat(),this.mainData.dataJoinRoom=null,qe.instance().hideLoading()}},{key:"showButtonWaittingChat",value:function(){!1===this.ktPlay&&(this.btnChatWaitting.visible=!0,TF.instance().dataMySeft.user_id===this.idMaster?this.btnChatWaitting.y=game.height-223:this.btnChatWaitting.y=game.height-116)}},{key:"hideButtonWaittingChat",value:function(){this.btnChatWaitting.visible=!1,this.btnChatWaitting.y=game.height}},{key:"showPlayGame",value:function(){var e=this;this.hideTextTrick(),LogConsole.log("showPlayGame");var t=[];2===this.totalPlayerPlay?t=this.arrLocalPlay2:3===this.totalPlayerPlay?t=this.arrLocalPlay3:4===this.totalPlayerPlay&&(t=this.arrLocalPlay4);var n=-1;this.arrChart={};for(var i=0;i<this.arrPlayer.length;i++)if(!1===this.arrPlayer[i].ktEmpty)n++,this.arrPlayer[i].hideLoading(),this.arrPlayer[i].setTextSanSang(""),this.arrPlayer[i].setScore(0),this.arrPlayer[i].setUserPlayGame(),game.add.tween(this.arrPlayer[i]).to({x:t[n].x,y:t[n].y},400,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[i].scale).to({x:.62,y:.62},400,Phaser.Easing.Power1,!0),game.time.events.add(.4*Phaser.Timer.SECOND,this.buidlChartUser,this,this.arrPlayer[i].getData().user_id,n,i,t);else{var o=0;o=i%2==0?-this.arrPlayer[i].width-200*z.instance().scale:game.width+200*z.instance().scale,game.add.tween(this.arrPlayer[i]).to({x:o},200,Phaser.Easing.Power1,!0)}setTimeout(function(){e.buildListMeAnswer(),e.addShowQuestion(e.idxQuestion)},600)}},{key:"buidlChartUser",value:function(e,t,n,i){var o=new DT;TF.instance().dataMySeft.user_id===e?o.addChart(!0):o.addChart(!1),o.x=i[t].x+2*z.instance().scale,o.y=i[t].y+72*z.instance().scale,o.height=0,this.addListChart.addChild(o),this.arrChart[n]=o,this.setChart(0,n)}},{key:"hideChart",value:function(){for(;this.addListChart.children.length>0;){var e=this.addListChart.children[0];this.addListChart.removeChild(e),e.destroy(),e=null}}},{key:"setChart",value:function(e,t){if(this.arrChart[t]){var n=55*z.instance().scale+200*z.instance().scale*e,i=223*z.instance().scale-200*z.instance().scale*e,o=i+72;game.add.tween(this.arrChart[t]).to({y:o,height:n},500,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[t]).to({y:i},500,Phaser.Easing.Power1,!0),this.objChat[this.arrPlayer[t].getData().user_id]&&null!=this.objChat[this.arrPlayer[t].getData().user_id]&&game.add.tween(this.objChat[this.arrPlayer[t].getData().user_id]).to({y:i-92*z.instance().scale},500,Phaser.Easing.Power1,!0)}}},{key:"buildListMeAnswer",value:function(){for(;this.addMeAnswer.children.length>0;){var e=this.addMeAnswer.children[0];this.addMeAnswer.removeChild(e),e.destroy(),e=null}var t=0,n=25*z.instance().scale;this.arrMeAnswer=[];for(var i=0;i<this.arrQuestion.length;i++){var o=new KT;o.x=t,o.y=n,this.addMeAnswer.addChild(o),t+=54*z.instance().scale,game.add.tween(o).to({y:0},400,Phaser.Easing.Elastic.Out,!0,30*i,1),this.arrMeAnswer.push(o)}this.addMeAnswer.y=385*z.instance().scale,this.addChild(this.addMeAnswer),this.addMeAnswer.x=(game.width-t)/2}},{key:"hideAnswerMe",value:function(){for(var e=0;e<this.arrMeAnswer.length;e++)game.add.tween(this.arrMeAnswer[e]).to({alpha:0},200,Phaser.Easing.Elastic.Out,!0)}},{key:"setMeAnswer",value:function(e){this.arrMeAnswer[e.idx].setData(e)}},{key:"setShowMeAnswerCurrent",value:function(e){this.arrMeAnswer[e].setBeginLoad()}},{key:"addShowQuestion",value:function(e){LogConsole.log("addShowQuestion"),this.removeShowQuestion(),this.setShowMeAnswerCurrent(e),this.showQuestion=new II(this.arrQuestion,e),this.showQuestion.addEventChooseAnswer(this.setMeAnswer,this),this.showQuestion.addEventShowQuestion(this.setShowMeAnswerCurrent,this),this.showQuestion.event.close.add(this.removeShowQuestion,this),this.showQuestion.x=0,this.showQuestion.y=game.height-700*z.instance().scale,this.addChild(this.showQuestion)}},{key:"removeShowQuestion",value:function(){null!=this.showQuestion&&(this.showQuestion.kill(),this.showQuestion.destroy(),this.showQuestion=null)}},{key:"addListSongResult",value:function(){this.removeListSongResult(),this.listSongResult=new $I(this.arrQuestion,this.roomBet),this.listSongResult.event.replay.add(this.showReplayGame,this),this.listSongResult.event.exit.add(this.chooseExit,this),this.listSongResult.event.close.add(this.removeListSongResult,this),this.listSongResult.y=game.height-515*z.instance().scale,this.addChild(this.listSongResult)}},{key:"removeListSongResult",value:function(){null!==this.listSongResult&&(this.removeChild(this.listSongResult),this.listSongResult.destroy(),this.listSongResult=null)}},{key:"chooseExit",value:function(){qe.instance().showLoading(),TF.instance().sendData(nS.ONLINE_MODE_ROOM_GAME_FINISH,null)}},{key:"showTimeCountDown",value:function(e){this.removeTimeCountDown(),this.timecount=e,this.setTextCountDown(),this.timerCountDown=this.game.time.create(!0),this.timerEventCountDown=this.timerCountDown.loop(1e3,this.onTimerCountDown,this),this.timerCountDown.start()}},{key:"onTimerCountDown",value:function(){this.timecount--,this.setTextCountDown()}},{key:"setTextCountDown",value:function(){this.timecount>-1?(this.timecount<6&&(game.sound.stopAll(),game.sound.play("beep_audio")),this.ktCountDownPlay&&0===this.timecount?this.txtCounDown.text="Bắt đầu":this.txtCounDown.text=this.timecount,this.txtCounDown.y=this.positionCreateRoom.waitting_txt_countdown.y*z.instance().scale+80*z.instance().scale,game.add.tween(this.txtCounDown).to({y:this.positionCreateRoom.waitting_txt_countdown.y*z.instance().scale},200,Phaser.Easing.Elastic.Out,!0)):(this.ktCountDownPlay&&this.showPlayGame(),this.removeTimeCountDown())}},{key:"removeTimeCountDown",value:function(){null!==this.timerCountDown&&(game.time.events.remove(this.timerEventCountDown),this.timerEventCountDown=null,this.timerCountDown.stop(),this.timerCountDown.destroy(),this.timerCountDown=null),this.txtCounDown.text=""}},{key:"hideHeader",value:function(){this.header.setHideBtnBack(),this.header.y=0,game.add.tween(this.header).to({y:-180*z.instance().scale},300,Phaser.Easing.Power1,!0)}},{key:"showHeader",value:function(){this.header.setShowBtnBack(),this.header.y=-180*z.instance().scale,game.add.tween(this.header).to({y:0},300,Phaser.Easing.Power1,!0)}},{key:"showTextTrick",value:function(){this.txtTrick.visible=!0}},{key:"hideTextTrick",value:function(){this.txtTrick.visible=!1}},{key:"checkShowMaster",value:function(){LogConsole.log("checkShowMaster : "+TF.instance().dataMySeft.user_id),!1===this.ktPlay&&(TF.instance().dataMySeft.user_id===this.idMaster?(this.btnMoiBan.visible=!0,this.btnMoiBan.y=game.height,game.add.tween(this.btnMoiBan).to({y:game.height-123*this.mainData.scale},300,Phaser.Easing.Power1,!0,100),this.btnChoi.visible=!0,this.btnChoi.inputEnabled=!0,this.btnChoi.y=game.height,game.add.tween(this.btnChoi).to({y:game.height-123*this.mainData.scale},300,Phaser.Easing.Power1,!0,100)):(this.btnMoiBan.visible=!1,this.btnChoi.visible=!1))}},{key:"hideButtonMaster",value:function(){!0===this.ktPlay&&TF.instance().dataMySeft.user_id===this.idMaster&&(this.btnMoiBan.visible=!0,this.btnMoiBan.y=game.height-123*this.mainData.scale,game.add.tween(this.btnMoiBan).to({y:game.height},300,Phaser.Easing.Power1,!0,100),this.btnChoi.visible=!0,this.btnChoi.y=game.height-123*this.mainData.scale,game.add.tween(this.btnChoi).to({y:game.height},300,Phaser.Easing.Power1,!0,100))}},{key:"checkShowInviteFriend",value:function(){if(!1===this.ktPlay&&TF.instance().dataMySeft.user_id===this.idMaster){for(var e=0,t=0;t<this.arrPlayer.length;t++)!1===this.arrPlayer[t].ktEmpty&&e++;e<4?this.showButtonMoiBan():(this.hideButtonMoiBan(),this.removeListFriend())}}},{key:"checkShowButtonChoi",value:function(){if(!1===this.ktPlay&&TF.instance().dataMySeft.user_id===this.idMaster){LogConsole.log("checkShowButtonChoi");for(var e=0,t=0,n=0;n<this.arrPlayer.length;n++)!1===this.arrPlayer[n].ktEmpty&&(e++,!0===this.arrPlayer[n].getData().online_mode_room_ready?t++:!0===this.arrPlayer[n].getData().isMaster&&t++);LogConsole.log("countReady : "+t),LogConsole.log("countPlayer : "+e),1===e?this.hideButtonChoi():t===e?this.showButtonChoi():this.hideButtonChoi()}}},{key:"getDataPlayer",value:function(e){var t=new _x;return t.user_id=e.getVariable(fa.user_id).value,t.user_name=e.getVariable(fa.user_name).value,t.avatar=e.getVariable(fa.avatar).value,t.online_mode_room_ready=e.getVariable(fa.online_mode_room_ready).value,t.user_id===this.idMaster?t.isMaster=!0:t.isMaster=!1,t}},{key:"getData",value:function(e){switch(e.cmd){case nS.ONLINE_MODE_ROOM_PLAYLIST_RESPONSE:break;case nS.ONLINE_MODE_ROOM_SERVER_QUESTIONS_RESPONSE:if(!1===this.ktPlay){this.hideBetRoom(),this.ktStart=!1,this.resetArrayScore(),this.ktCountDownPlay=!1,this.ktPlay=!0,TF.instance().sendLoading(1),this.hideButtonMaster(),this.hideHeader(),this.showTextTrick();for(var t=0;t<this.arrPlayer.length;t++)this.arrPlayer[t].setPlay(!0);this.arrQuestion=Zx.begin(e.params)}break;case nS.ONLINE_MODE_ROOM_GAME_START:this.hideButtonWaittingChat(),this.hideKeyBoard(),li.instance().playCreateRoom(),this.hideButtonMoiBan(),this.hideButtonChoi(),this.startTime=this.getTime(),Le.instance().logEvent(Le.pro_quiz_start_createroom),this.ktStart=!0,this.ktCountDownPlay=!0,this.idxQuestion=e.params.getInt(Qh.question_index)-1,this.showTimeCountDown(3),IE.instance().removeUserProfile();break;case nS.ONLINE_MODE_ROOM_USER_SELECTED_ANSWER_RESPONSE:this.setScorePlayer(e.params);break;case nS.ONLINE_MODE_ROOM_GAME_RESULT:this.endTime=this.getTime();var n=parseInt((this.endTime-this.startTime)/1e3);Le.instance().logEvent(Le.play_time,n),Le.instance().logEvent(Le.pro_quiz_end_createroom),this.removeShowResult(),this.idShowResult=game.time.events.add(2*Phaser.Timer.SECOND,this.showResult,this,e.params);break;case nS.ONLINE_MODE_ROOM_QUICK_JOIN_RESPONSE:}}},{key:"removeShowResult",value:function(){null!==this.idShowResult&&(game.time.events.remove(this.idShowResult),this.idShowResult=null)}},{key:"showReplayGame",value:function(){var e=this;if(!0===this.ktReplay){this.lineWin.visible=!1,this.txtWin.visible=!1,this.showHeader(),this.checkShowMaster(),this.removeEffectWin(),this.hideButtonChoi(),this.hideButtonMoiBan(),this.showBetRoom(),this.button_share.visible=!1;for(var t=0;t<this.arrPlayer.length;t++)this.arrPlayer[t].setDefaultUser(),!1===this.arrPlayer[t].ktEmpty&&this.arrPlayer[t].setTextMaster(),game.add.tween(this.arrPlayer[t]).to({x:this.arrLocal[t].x,y:this.arrLocal[t].y},300,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[t].scale).to({x:1,y:1},300,Phaser.Easing.Power1,!0);this.removeTimeoutShowChoosePlayList(),this.idTimeOutShowPlayList=setTimeout(function(){e.addChoosePlayList()},800)}}},{key:"showResult",value:function(e){game.sound.stopAll(),this.ktReplay=!1,this.lineWin.visible=!0,this.txtWin.visible=!0,this.ktPlay=!1,LI.begin(e,this.arrPlayer);var t=[];this.arrScore[0].score>0?2===this.totalPlayerPlay?t=this.arrLocalResult2:3===this.totalPlayerPlay?t=this.arrLocalResult3:4===this.totalPlayerPlay&&(t=this.arrLocalResult4):2===this.totalPlayerPlay?t=this.arrLocalResultAllLose2:3===this.totalPlayerPlay?t=this.arrLocalResultAllLose3:4===this.totalPlayerPlay&&(t=this.arrLocalResultAllLose4);var n=-1,i=0,o=0,a=0;this.button_share.visible=!0,this.showQuestion.hideQuestion(),this.hideAnswerMe(),this.hideChart(),this.addListSongResult();for(var s=0;s<this.arrScore.length;s++)!1===this.arrPlayer[this.arrScore[s].idx].ktEmpty&&(0===s?this.arrScore[0].score>0?(i=this.arrLocalResultWin.x,o=this.arrLocalResultWin.y,a=.76,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!0,this.roomBet),this.removeShowResult(),this.idShowResult=game.time.events.add(.8*Phaser.Timer.SECOND,this.addEffectUserWin,this,this.arrPlayer[this.arrScore[s].idx]),this.arrPlayer[this.arrScore[s].idx].getData().user_id===TF.instance().dataMySeft.user_id&&ce.instance().playSound(ce.winturnbasepartymode)):(i=t[++n].x,o=t[n].y,a=.61,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!1),this.ktReplay=!0,this.listSongResult.ktReplay=!0):(i=t[++n].x,o=t[n].y,a=.61,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!1),this.arrPlayer[this.arrScore[s].idx].getData().user_id===TF.instance().dataMySeft.user_id&&ce.instance().playSound(ce.loseturnbasepartymode)),game.add.tween(this.arrPlayer[this.arrScore[s].idx]).to({x:i,y:o},500,Phaser.Easing.Power1,!0,200),game.add.tween(this.arrPlayer[this.arrScore[s].idx].scale).to({x:a,y:a},500,Phaser.Easing.Power1,!0,200));for(var r=0;r<this.arrPlayer.length;r++)this.arrPlayer[r].setPlay(!1),!0===this.arrPlayer[r].ktDisConnect&&(this.arrPlayer[r].setEmpty(),this.totalPlayerPlay--)}},{key:"addEffectUserWin",value:function(e){this.removeEffectWin(),this.rotationWin=new rt(this.positionCreateRoom.light_rotation_list_result),this.rotationWin.anchor.set(.5),this.addListChart.addChild(this.rotationWin),this.rotationWin.x=e.x+60*z.instance().scale,this.rotationWin.y=e.y+100*z.instance().scale,this.tweenRotationwin=game.add.tween(this.rotationWin).to({rotation:360},2e3,Phaser.Easing.Power1,!0),this.tweenRotationwin.repeat(99999,250),this.firework=new Phaser.Sprite(game,0,0,"firework"),this.firework.width=430*z.instance().scale,this.firework.height=228*z.instance().scale,this.firework.x=103*z.instance().scale,this.firework.y=106*z.instance().scale,this.firework.animations.add("playfirework"),this.firework.animations.play("playfirework",30,!0),this.addListChart.addChild(this.firework),this.ktReplay=!0,this.listSongResult.ktReplay=!0}},{key:"removeEffectWin",value:function(){if(this.addListChart.children)for(;this.addListChart.children.length>0;){var e=this.addListChart.children[0];this.addListChart.removeChild(e),e.destroy(),e=null}}},{key:"setScorePlayer",value:function(e){if(LogConsole.log("setScorePlayer : "+e.getDump()),"OK"===e.getUtfString(fa.status)){LogConsole.log(1);for(var t=0;t<this.arrPlayer.length;t++)if(!1===this.arrPlayer[t].ktEmpty){LogConsole.log(2);var n=this.arrPlayer[t].getData(),i=e.getInt(fa.user_id);if(n.user_id===i){var o=e.getInt(fa.score),a=e.getBool(fa.is_correct_answer);this.arrPlayer[t].setScore(o),!0===a?this.arrPlayer[t].setTrueAnswer():this.arrPlayer[t].setFailtAnswer();for(var s=0;s<this.arrScore.length;s++)if(this.arrScore[s].idx==t){this.arrScore[s].score=o;break}break}}}this.arrScore.sort(this.compare);var r=this.arrScore[0].score;if(r>0){this.setChart(1,this.arrScore[0].idx);for(var l=1;l<this.arrScore.length;l++)!1===this.arrPlayer[this.arrScore[l].idx].ktEmpty&&this.setChart(this.arrScore[l].score/r,this.arrScore[l].idx)}}},{key:"addChoosePlayList",value:function(){this.removeChoosePlayList(),this.choosePlayList=new px,this.choosePlayList.setBetMoney(this.roomBet),this.choosePlayList.setIsMaster(!1),this.choosePlayList.addEvent(),this.choosePlayList.event.back.add(this.removeChoosePlayList,this),this.addChild(this.choosePlayList),this.checkShowButtonChoi(),this.checkShowInviteFriend(),this.showButtonWaittingChat()}},{key:"removeChoosePlayList",value:function(){null!==this.choosePlayList&&(this.removeChild(this.choosePlayList),this.choosePlayList.destroy(),this.choosePlayList=null)}},{key:"onRoomVarsUpdate",value:function(e){if(LogConsole.log("onRoomVarsUpdate"),-1!=e.changedVars.indexOf("room_master")){this.idMaster=e.room.getVariable("room_master").value,TF.instance().dataMySeft.user_id===this.idMaster&&(this.isMaster=!0,!1===this.ktPlay&&IE.instance().addDialog("Bạn được chuyển làm chủ phòng.")),LogConsole.log("isMaster : "+this.idMaster),null===this.listSongResult&&(this.checkShowMaster(),this.checkShowInviteFriend(),this.checkShowButtonChoi(),this.showButtonWaittingChat());for(var t=0;t<this.arrPlayer.length;t++)!1===this.arrPlayer[t].ktEmpty&&(this.arrPlayer[t].idMaster=this.idMaster,this.arrPlayer[t].getData().user_id===this.idMaster?(this.arrPlayer[t].getData().isMaster=!0,this.nameMaster=this.arrPlayer[t].getData().user_name,this.arrPlayer[t].setCurrentData(this.arrPlayer[t].getData())):(this.arrPlayer[t].getData().isMaster=!1,this.arrPlayer[t].setCurrentData(this.arrPlayer[t].getData())),null===this.listSongResult&&!1===this.ktPlay&&this.arrPlayer[t].setTextMaster());this.header.setNguoiTao(this.nameMaster)}}},{key:"userVarsUpdate",value:function(e){var t=e.user,n=this.getDataPlayer(t);if(-1!==e.changedVars.indexOf(fa.online_mode_loaded)&&!0===this.ktPlay)for(var i=t.getVariable(fa.online_mode_loaded).value,o=0;o<this.arrPlayer.length;o++){var a=this.arrPlayer[o];!1===a.ktEmpty&&a.getData().user_id===n.user_id&&i>0&&a.setLoading(i)}!0===t.isItMe&&!0===n.online_mode_room_ready&&null!==this.choosePlayList&&this.removeChoosePlayList();for(var s=0;s<this.arrPlayer.length;s++){var r=this.arrPlayer[s];if(!1===r.ktEmpty)if(r.getData().user_id==n.user_id){this.arrPlayer[s].setCurrentData(n),!1===this.ktPlay&&r.setTextMaster();break}}this.checkShowButtonChoi()}},{key:"userEnterRoom",value:function(e){if(LogConsole.log("userEnterRoom------"),e.room.isGame){var t=e.user;LogConsole.log(t);for(var n=this.getDataPlayer(t),i=0;i<this.arrPlayer.length;i++)if(!0===this.arrPlayer[i].ktEmpty){this.arrPlayer[i].setMaster(this.idMaster),this.arrPlayer[i].setData(n,i),this.totalPlayerPlay++;break}}this.checkShowButtonChoi(),this.checkShowInviteFriend()}},{key:"userExitRoom",value:function(e){if(LogConsole.log("userExitRoom------ : "+e.user.isItMe),LogConsole.log(e.user),e.room.isGame)if(e.user.isItMe)this.event.back.dispatch();else{var t=e.user;LogConsole.log(t);for(var n=t.getVariable(fa.user_id).value,i=0;i<this.arrPlayer.length;i++)if(!1===this.arrPlayer[i].ktEmpty){var o=this.arrPlayer[i].getData();if(o.user_id===n){this.ktPlay?(this.ktStart,o.user_id=-1,this.arrPlayer[i].setCurrentData(o),this.arrPlayer[i].setDisConnect()):(this.arrPlayer[i].setEmpty(),this.totalPlayerPlay--);break}}this.checkShowButtonChoi(),this.checkShowInviteFriend()}}},{key:"buildListPlayer",value:function(){this.arrPlayer=[];for(var e=0;e<this.arrLocal.length;e++){var t=new Nx;t.setEmpty(),t.setIdx(e),t.event.click_avatar.add(this.click_avatar,this),t.event.choose_invite.add(this.addListFriend,this),t.x=e%2==0?-t.width-200*z.instance().scale:game.width+200*z.instance().scale,t.y=this.arrLocal[e].y,game.add.tween(t).to({x:this.arrLocal[e].x},250,Phaser.Easing.Power1,!0,400),this.addChild(t),this.arrPlayer.push(t)}}},{key:"click_avatar",value:function(e){for(var t=0;t<this.arrPlayer.length;t++)this.arrPlayer[t].getIdx()===e||this.arrPlayer[t].setCheckHideKichTween()}},{key:"addListFriend",value:function(){TF.instance().dataMySeft.user_id===this.idMaster&&!1===this.ktPlay&&(this.removeListFriend(),this.listFriend=new xT(this.idRoom,this.totalPlayerPlay),this.listFriend.event.back.add(this.backListFriend,this),this.addChild(this.listFriend))}},{key:"backListFriend",value:function(){Nc.instance().beginSwitch(this.listFriend,null,!1),Nc.instance().event.tweenComplete.add(this.tweenListFriendComplete,this)}},{key:"tweenListFriendComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenListFriendComplete,this),this.removeListFriend()}},{key:"removeListFriend",value:function(){null!==this.listFriend&&(this.removeChild(this.listFriend),this.listFriend.destroy(),this.listFriend=null)}},{key:"chooseChatWatting",value:function(){$r.instance().show({maxLength:"",showTransparent:!0,placeholder:"Chat",isSearch:!1}),$r.instance().event.enter.add(this.onSubmit,this),$r.instance().event.submit.add(this.onSubmit,this),$r.instance().event.cancle.add(this.onCancel,this)}},{key:"hideKeyBoard",value:function(){$r.instance().hide(),$r.instance().event.enter.remove(this.onSubmit,this),$r.instance().event.submit.remove(this.onSubmit,this),$r.instance().event.cancle.remove(this.onCancel,this)}},{key:"onSubmit",value:function(){var e=$r.instance().getValue();if(""!==e){var t=new SFS2X.SFSObject;t.putUtfString("chatWaitting",e),TF.instance().sendPublicChat(Et.CHAT_ONLINE_MODE,t)}this.onCancel()}},{key:"onCancel",value:function(){this.hideKeyBoard()}},{key:"chooseChoi",value:function(){LogConsole.log("chooseChoi"),TF.instance().dataMySeft.diamond<this.roomBet?IE.instance().addDialogConfirnMoney("Bạn không đủ kim cương để chơi, bạn có muốn nạp thêm?","chooseCanclePopupMoney"):(this.btnChoi.inputEnabled=!1,TF.instance().sendData(nS.ONLINE_MODE_ROOM_START_GAME_REQUEST,null))}},{key:"chooseMoiBan",value:function(){LogConsole.log("chooseMoiBan"),this.addListFriend()}},{key:"chooseBack",value:function(){!0===(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&null!==this.listFriend||!1===this.ktPlay&&!1===this.checkSendExit&&(this.checkSendExit=!0,TF.instance().sendExitRoom())}},{key:"removeTimeoutShowChoosePlayList",value:function(){null!==this.idTimeOutShowPlayList&&clearTimeout(this.idTimeOutShowPlayList)}},{key:"destroy",value:function(){this.removeShowResult(),El.instance().removeAllSound(),this.removeTimeoutShowChoosePlayList(),this.removeEvent(),this.removeAllItem(),this.hideKeyBoard(),yA(mA(t.prototype),"destroy",this).call(this)}}])&&pA(n.prototype,i),o&&pA(n,o),t}();function bA(e){return(bA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _A(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function SA(e,t){return!t||"object"!==bA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function EA(e,t,n){return(EA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CA(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function CA(e){return(CA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kA(e,t){return(kA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var PA=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=SA(this,CA(t).call(this,game,0,0,null))).event={back:new Phaser.Signal,quickplay:new Phaser.Signal},n.ktBack=e,n.screenChooseMode=null,n.screenCreateRoom=null,n.screenPlaying=null,n.checkDataRoom(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kA(e,t)}(t,Mt),n=t,(i=[{key:"checkDataRoom",value:function(){LogConsole.log("checkDataRoom--------------"),LogConsole.log(this.mainData.dataJoinRoom),null!==this.mainData.dataJoinRoom?this.addScreenPlayRoom():this.addScreenChooseMode()}},{key:"addScreenChooseMode",value:function(){this.removeScreenChooseMode(),this.screenChooseMode=new BR,this.screenChooseMode.event.create_room.add(this.addScreenCreateRoom,this),this.screenChooseMode.event.close.add(this.backToMainMenu,this),this.screenChooseMode.event.quick_play.add(this.addScreenQuickPlay,this),this.addChild(this.screenChooseMode),null!==this.screenCreateRoom?this.removeScreenCreateRoom():null!==this.screenPlaying?this.removeScreenPlayRoom():0==this.ktBack&&Nc.instance().beginSwitch(null,this.screenChooseMode,!1)}},{key:"removeScreenChooseMode",value:function(){null!==this.screenChooseMode&&(this.removeChild(this.screenChooseMode),this.screenChooseMode.destroy(),this.screenChooseMode=null)}},{key:"addScreenCreateRoom",value:function(){this.removeScreenCreateRoom(),this.screenCreateRoom=new bx,this.screenCreateRoom.event.back.add(this.addScreenChooseMode,this),this.addChild(this.screenCreateRoom),null!==this.screenChooseMode&&this.removeScreenChooseMode(),null!==this.screenPlaying&&this.removeScreenPlayRoom()}},{key:"removeScreenCreateRoom",value:function(){null!==this.screenCreateRoom&&(this.removeChild(this.screenCreateRoom),this.screenCreateRoom.destroy(),this.screenCreateRoom=null)}},{key:"addScreenQuickPlay",value:function(){LogConsole.log("addScreenQuickPlay"),this.event.quickplay.dispatch()}},{key:"addScreenPlayRoom",value:function(){this.removeScreenPlayRoom(),this.screenPlaying=new wA,this.screenPlaying.event.back.add(this.addScreenChooseMode,this),this.addChild(this.screenPlaying),null!==this.screenCreateRoom&&(Nc.instance().beginSwitch(this.screenCreateRoom,this.screenPlaying,!1),Nc.instance().event.tweenComplete.add(this.onCompleteTweenScreenCreateRoom,this)),null!==this.screenChooseMode&&this.removeScreenChooseMode()}},{key:"removeScreenPlayRoom",value:function(){null!==this.screenPlaying&&(this.removeChild(this.screenPlaying),this.screenPlaying.destroy(),this.screenPlaying=null)}},{key:"onCompleteTweenScreenCreateRoom",value:function(){Nc.instance().event.tweenComplete.remove(this.onCompleteTweenScreenCreateRoom,this),this.removeScreenCreateRoom()}},{key:"onCompleteTweenScreenChooseMode",value:function(){Nc.instance().event.tweenComplete.remove(this.onCompleteTweenScreenChooseMode,this),this.removeScreenChooseMode()}},{key:"onCompleteTweenScreenPlaying",value:function(){Nc.instance().event.tweenComplete.remove(this.onCompleteTweenScreenPlaying,this),this.removeScreenPlayRoom()}},{key:"backToMainMenu",value:function(){this.removeAllItem(),EA(CA(t.prototype),"destroy",this).call(this),rF.instance().changeScreen(Ce.MAIN_MENU,{})}}])&&_A(n.prototype,i),o&&_A(n,o),t}();function OA(e){return(OA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xA(e,t){return!t||"object"!==OA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TA(e,t,n){return(TA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=IA(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function IA(e){return(IA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AA(e,t){return(AA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LA=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=xA(this,IA(t).call(this,game,0,0,null,n,i))).positionCreateRoom=z.instance().positionCreateRoom,o.defaultBg=new Zt(o.positionCreateRoom.quickplay_tab_btn_default),o.addChild(o.defaultBg),o.activeBg=new Zt(o.positionCreateRoom.quickplay_tab_btn_active),o.addChild(o.activeBg),o.lineActive=new rt(o.positionCreateRoom.quickplay_tab_line),o.addChild(o.lineActive),o.lb=new _t(o.positionCreateRoom.quickplay_tab_btn_label,e),o.lb.setTextBounds(0,0,o.defaultBg.width,o.defaultBg.height),o.addChild(o.lb),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AA(e,t)}(t,Phaser.Button),n=t,(i=[{key:"setActiveBet",value:function(){this.activeBg.width=game.width,this.activeBg.height=100*z.instance().scale,this.lb.setTextBounds(0,0,this.activeBg.width,this.activeBg.height),this.lineActive.width=this.activeBg.targetWidth,this.activeBg.visible=!0,this.lineActive.visible=!0,this.defaultBg.visible=!1}},{key:"setActive",value:function(){this.activeBg.visible=!0,this.lineActive.visible=!0,this.defaultBg.visible=!1}},{key:"setDefault",value:function(){this.activeBg.visible=!1,this.lineActive.visible=!1,this.defaultBg.visible=!0}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),TA(IA(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"width",get:function(){return this.activeBg.width}},{key:"height",get:function(){return this.activeBg.height}}])&&RA(n.prototype,i),o&&RA(n,o),t}();function GA(e){return(GA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function MA(e,t){return!t||"object"!==GA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function NA(e){return(NA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BA(e,t){return(BA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jA=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),MA(this,NA(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BA(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.event={choose:new Phaser.Signal},this.type=this.mainData.typeMenuGenes,this.btnVN=new LA(Bm.getNameRegion(Bm.Local),this.clickVN,this),this.addChild(this.btnVN),this.btnQuocTe=new LA(Bm.getNameRegion(Bm.International),this.clickQuocTe,this),this.btnQuocTe.x=this.btnVN.width,this.addChild(this.btnQuocTe),this.type==Bm.Local?(this.btnVN.setActive(),this.btnQuocTe.setDefault()):(this.btnVN.setDefault(),this.btnQuocTe.setActive())}},{key:"clickVN",value:function(e){this.type==Bm.International&&(this.type=Bm.Local,this.btnQuocTe.setDefault(),this.btnVN.setActive(),this.event.choose.dispatch(this.type))}},{key:"clickQuocTe",value:function(e){this.type==Bm.Local&&(this.type=Bm.International,this.btnVN.setDefault(),this.btnQuocTe.setActive(),this.event.choose.dispatch(this.type))}}])&&DA(n.prototype,i),o&&DA(n,o),t}();function UA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var FA=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){for(var n=t.getSFSArray(Qh.genres_user_count),i=0;i<n.size();i++)for(var o=n.getSFSObject(i),a=0;a<e.length;a++)if(e[a].id===o.getInt(Qh.genre_id)){e[a].number_player=o.getInt(Qh.number_player);break}return e}}],(n=null)&&UA(t.prototype,n),i&&UA(t,i),e}();function ZA(e){return(ZA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QA(e,t){return!t||"object"!==ZA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function VA(e,t,n){return(VA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WA(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function WA(e){return(WA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qA(e,t){return(qA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var KA=function(e){function t(e,n,i,o){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=QA(this,WA(t).call(this,game,0,0,null,i,o))).idx=n,a.data=e,LogConsole.log(e),a.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),a.positionCreateRoom=z.instance().positionCreateRoom,a.objSprite=a.positionIsNewUserConfig.chooseMain.genres;var s=a.objSprite.nhac_tre;a.objSprite.hasOwnProperty(e.code)&&(s=a.objSprite[e.code]),LogConsole.log(s),a.bgGenres=new rt(s),a.addChild(a.bgGenres),e.hasOwnProperty("number_player")?a.countPlayer=new ln(a.positionCreateRoom.quickplay_bg_count_player,e.number_player):a.countPlayer=new ln(a.positionCreateRoom.quickplay_bg_count_player,"0"),a.addChild(a.countPlayer);return a.idx%2==0?(a.x=-a.width-118*z.instance().scale,35*z.instance().scale):(a.x=2*a.width+179*z.instance().scale,a.width+61*z.instance().scale),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qA(e,t)}(t,Phaser.Button),n=t,(i=[{key:"setEffect",value:function(){LogConsole.log("setEffect"+this.idx);var e=0;this.idx%2==0?(this.x=-this.width-118*z.instance().scale,e=35*z.instance().scale):(this.x=2*this.width+179*z.instance().scale,e=this.width+61*z.instance().scale),game.add.tween(this).to({x:e},200,Phaser.Easing.Power1,!0,150+50*(this.idx+1))}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){this.data=e,this.countPlayer.setText(e.number_player)}},{key:"onInputDownHandler",value:function(){LogConsole.log("onInputDownHandler------------"),VA(WA(t.prototype),"onInputDownHandler",this).call(this),ce.instance().playSound(ce.buttonclick)}},{key:"width",get:function(){return this.bgGenres.width}},{key:"height",get:function(){return this.bgGenres.height}}])&&HA(n.prototype,i),o&&HA(n,o),t}();function zA(e){return(zA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YA(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function JA(e,t){return!t||"object"!==zA(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XA(e,t,n){return(XA="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$A(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $A(e){return($A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eL(e,t){return(eL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),JA(this,$A(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eL(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){qe.instance().showLoading(),this.event={back:new Phaser.Signal,next_bet:new Phaser.Signal},this.typeMenu=this.mainData.typeMenuGenes,this.arrItem=[],this.positionCreateRoom=this.mainData.positionCreateRoom,this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg),this.parenItem=new Phaser.Sprite(game,0,0,null);var e={column:2,width:game.width,height:game.height-235*this.mainData.scale,rowHeight:160*this.mainData.scale,leftDistance:27*this.mainData.scale,direction:"y",distanceBetweenColumns:36*this.mainData.scale,distanceBetweenRows:36*this.mainData.scale};this.scroll=new hy(e),this.scroll.y=240*this.mainData.scale,this.addChild(this.scroll),this.header=new IR,this.header.event.back.add(this.chooseBack,this),this.header.setDiamond(),this.addChild(this.header),this.menu=new jA,this.menu.event.choose.add(this.chooseGenres,this),this.menu.y=100*this.mainData.scale,this.addChild(this.menu)}},{key:"chooseGenres",value:function(e){this.typeMenu=e,this.mainData.typeMenuGenes=this.typeMenu,this.buildListGenres()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),Ur.instance().event.load_playlist_complete.add(this.buildDataGenres,this),!0===Ur.instance().ktLoadPlaylist?this.buildDataGenres():Ur.instance().sendGetDataShop(),li.instance().showBanerQuickPlayModeRoomScreen()}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),Ur.instance().event.load_playlist_complete.remove(this.buildDataGenres,this)}},{key:"buildDataGenres",value:function(){this.buildListGenres(),qe.instance().hideLoading()}},{key:"getData",value:function(e){switch(e.cmd){case YT.ONLINE_MODE_GENRES_RESPONSE:case YT.ONLINE_MODE_USER_COUNT_BROADCAST:break;case YT.ONLINE_MODE_COUNT_USER_ONLINE_RESPONSE:this.dataGenres=FA.begin(this.dataGenres,e.params),this.buildListGenresUpdate()}}},{key:"buildListGenres",value:function(){this.arrItem=[];var e=-1;this.dataGenres=Ur.instance().genres.getDataGenresByLocal(this.typeMenu);for(var t=0;t<this.dataGenres.length;t++){var n=this.dataGenres[t],i=new KA(n,++e,this.chooseItem,this);this.arrItem.push(i)}this.scroll.viewList=this.arrItem;for(var o=0;o<this.arrItem.length;o++){this.arrItem[o].setEffect()}TF.instance().sendData(YT.ONLINE_MODE_COUNT_USER_ONLINE_REQUEST,null)}},{key:"chooseItem",value:function(e){LogConsole.log("chooseItem ------ ");var t=e.getData();this.event.next_bet.dispatch(t)}},{key:"buildListGenresUpdate",value:function(){LogConsole.log(this.dataGenres);for(var e=0;e<this.arrItem.length;e++)for(var t=this.arrItem[e],n=t.getData(),i=0;i<this.dataGenres.length;i++){var o=this.dataGenres[i];if(o.id===n.id){t.setData(o);break}}}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"removeAllParentItem",value:function(){if(this.parenItem.children)for(;this.parenItem.children.length>0;){var e=this.parenItem.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"destroy",value:function(){this.removeEvent(),this.removeAllParentItem(),this.removeAllItem(),this.scroll.destroy(),li.instance().hideBanner(),XA($A(t.prototype),"destroy",this).call(this)}}])&&YA(n.prototype,i),o&&YA(n,o),t}();function nL(e){return(nL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iL(e){return(iL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aL(e,t,n){return t&&oL(e.prototype,t),n&&oL(e,n),e}function sL(e,t){return(sL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var lL=function(e){function t(e){var n,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=iL(t).call(this,game,0,0,null))||"object"!==nL(o)&&"function"!=typeof o?rL(i):o).event={backBet:new Phaser.Signal,backGenres:new Phaser.Signal},n.positionCreateRoom=n.mainData.positionCreateRoom,n.bgTree=new LA(""),n.bgTree.setActiveBet(),n.addChild(n.bgTree),n.lbBackGennes=new _t(n.positionCreateRoom.quickplay_txt_button_back_menu_visilbe,a),n.lbBackGennes.x=33*n.mainData.scale,n.lbBackGennes.y=39*n.mainData.scale,n.lbBackGennes.setButton(n.backToGenres,rL(rL(n))),n.addChild(n.lbBackGennes),n.iconArraow=new rt(n.positionCreateRoom.quickplay_arrow_back_menu),n.iconArraow.x=n.lbBackGennes.x+n.lbBackGennes.width+12*n.mainData.scale,n.iconArraow.y=n.lbBackGennes.y+(n.lbBackGennes.height-n.iconArraow.height)/2,n.addChild(n.iconArraow),e===t.TREE_BET?n.lbGennes=new _t(n.positionCreateRoom.quickplay_txt_button_back_menu,s):(n.lbGennes=new _t(n.positionCreateRoom.quickplay_txt_button_back_menu_visilbe,s),n.lbGennes.setButton(n.backToBets,rL(rL(n)))),n.lbGennes.y=n.lbBackGennes.y,n.lbGennes.x=n.iconArraow.x+n.iconArraow.width+12*n.mainData.scale,n.addChild(n.lbGennes),e===t.TREE_PLAYLIST&&(n.iconArraow1=new rt(n.positionCreateRoom.quickplay_arrow_back_menu),n.iconArraow1.x=n.lbGennes.x+n.lbGennes.width+12*n.mainData.scale,n.iconArraow1.y=n.lbGennes.y+(n.lbGennes.height-n.iconArraow1.height)/2,n.addChild(n.iconArraow1),n.lbPlayerList=new _t(n.positionCreateRoom.quickplay_txt_button_back_menu,"Play List"),n.lbPlayerList.y=n.lbBackGennes.y,n.lbPlayerList.x=n.iconArraow1.x+n.iconArraow1.width+12*n.mainData.scale,n.addChild(n.lbPlayerList)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sL(e,t)}(t,Mt),aL(t,null,[{key:"TREE_BET",value:function(){return"TREE_BET"}},{key:"TREE_PLAYLIST",value:function(){return"TREE_PLAYLIST"}}]),aL(t,[{key:"backToGenres",value:function(){this.event.backGenres.dispatch()}},{key:"backToBets",value:function(){LogConsole.log("backToBets"),this.event.backBet.dispatch()}}]),t}();function hL(e){return(hL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function uL(e,t,n){return(uL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dL(e){return(dL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fL(e,t){return(fL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var gL=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,n=!(o=dL(t).call(this,game,0,0,null))||"object"!==hL(o)&&"function"!=typeof o?pL(i):o,qe.instance().showLoading(),n.dataGennes=e,n.event={back:new Phaser.Signal,backGenres:new Phaser.Signal,choose_bet:new Phaser.Signal},n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg),n.tabTree=new lL(lL.TREE_BET,Bm.getNameRegion(n.dataGennes.region),n.dataGennes.genre),n.tabTree.event.backGenres.add(n.chooseBackToGenres,pL(pL(n))),n.tabTree.y=100*n.mainData.scale,n.addChild(n.tabTree);var a=new Phaser.Group(game,0,0,null);return n.listBet=new Vo(game,a,new Phaser.Rectangle(0,0,game.width,game.height-270*n.mainData.scale),{direction:"y",padding:18*n.mainData.scale,searchForClicks:!0}),a.x=0,a.y=270*n.mainData.scale,n.addChild(a),n.header=new IR,n.header.event.back.add(n.chooseBack,pL(pL(n))),n.header.setDiamond(),n.addChild(n.header),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fL(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),Ur.instance().event.load_online_mode_bet_complete.add(this.buildDataRoomBet,this),!0===Ur.instance().ktLoadOnlineModeBet?this.buildDataRoomBet():Ur.instance().sendGetOnlineModeBet(),li.instance().showBanerChooseBettingQuickPlayScreen()}},{key:"buildDataRoomBet",value:function(){this.buidlListBet(),qe.instance().hideLoading()}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),Ur.instance().event.load_online_mode_bet_complete.remove(this.buildDataRoomBet,this)}},{key:"getData",value:function(e){switch(e.cmd){case YT.ONLINE_MODE_BETS_RESPONSE:}}},{key:"buidlListBet",value:function(){for(var e=Ur.instance().quickplay_bet_setting,t=0;t<e.length;t++)if(TF.instance().dataMySeft.level>=e[t].user_level_required){var n=new QR;n.event.choose_bet.add(this.chooseBet,this),e[t].genre=this.dataGennes.genre,n.setData(e[t],t),this.listBet.add(n)}}},{key:"chooseBet",value:function(e){LogConsole.log("choose_bet"),e.dataGennes=this.dataGennes,this.mainData.dataPlayOnlineMode.bet_place=e.bet_place,TF.instance().dataMySeft.diamond<e.bet_place?IE.instance().addDialogConfirnMoney("Bạn không đủ Kim Cương vào phòng, bạn có muốn nạp thêm?"):this.event.choose_bet.dispatch(e)}},{key:"chooseBackToGenres",value:function(){this.event.backGenres.dispatch()}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listBet.removeAll(),this.listBet.destroy(),li.instance().hideBanner(),this.removeEvent(),uL(dL(t.prototype),"destroy",this).call(this)}}])&&cL(n.prototype,i),o&&cL(n,o),t}();function yL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var mL=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t,n){var i=new SFS2X.SFSObject;return i.putInt("playlist_id",e),i.putInt("genre_id",t),i.putInt("bet_id",n),i}}],(n=null)&&yL(t.prototype,n),i&&yL(t,i),e}();function vL(e){return(vL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bL(e,t,n){return(bL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_L(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _L(e){return(_L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SL(e,t){return(SL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var CL=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,n=!(o=_L(t).call(this,game,0,0,null))||"object"!==vL(o)&&"function"!=typeof o?EL(i):o,qe.instance().showLoading(),LogConsole.log("OnlineModeListPlaylist----------------------------"),n.event={back:new Phaser.Signal,backBet:new Phaser.Signal,backGenres:new Phaser.Signal},n.positionCreateRoom=n.mainData.positionCreateRoom,n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg),n.dataBet=e,n.idDelay=null,n.idx=0,n.countItem=0,n.arrPlayerList=[],n.ktBuild=!1,n.tabTree=new lL(lL.TREE_PLAYLIST,Bm.getNameRegion(n.dataBet.dataGennes.region),n.dataBet.dataGennes.genre),n.tabTree.event.backBet.add(n.chooseBackToBet,EL(EL(n))),n.tabTree.event.backGenres.add(n.chooseBackToGenres,EL(EL(n))),n.tabTree.y=100*n.mainData.scale,n.addChild(n.tabTree);var a=new Phaser.Group(game,0,0,null);return n.listPlayerlist=new Vo(game,a,new Phaser.Rectangle(0,0,game.width,game.height-205*n.mainData.scale),{direction:"y",padding:0,searchForClicks:!0}),n.listPlayerlist.events.changeIndex.add(n.changeIndex,EL(EL(n))),a.x=0,a.y=205*n.mainData.scale,n.addChild(a),n.header=new IR,n.header.event.back.add(n.chooseBack,EL(EL(n))),n.header.setDiamond(),n.addChild(n.header),n.bgSuggestPlayList=new Zt(n.positionCreateRoom.choose_playlist_itemplaylist_bg),n.bgSuggestPlayList.y=205*n.mainData.scale,n.addChild(n.bgSuggestPlayList),n.bgSuggestPlayList.x=game.width,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SL(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),Ur.instance().event.buy_playlist.add(this.buildPlayerList,this),Ur.instance().event.load_playlist_complete.add(this.buildDataPlaylist,this),!0===Ur.instance().ktLoadPlaylist?this.buildDataPlaylist():Ur.instance().sendGetDataShop(),li.instance().showBanerChoosePlaylistquickPlayScreen()}},{key:"removeEvent",value:function(){Ur.instance().event.buy_playlist.remove(this.buildPlayerList,this),TF.instance().events.onExtensionResponse.remove(this.getData,this),Ur.instance().event.load_playlist_complete.remove(this.buildDataPlaylist,this)}},{key:"buildDataPlaylist",value:function(){this.buildPlayerList(),qe.instance().hideLoading()}},{key:"getData",value:function(e){switch(e.cmd){case YT.ONLINE_MODE_PLAYLISTS_RESPONSE:case Hs.SHOP_BUY_PLAYLIST_RESPONSE:}}},{key:"buildPlayerList",value:function(){this.arrPlayerList=Ur.instance().playlist.getArrByGenresId(this.dataBet.dataGennes.id),this.arrPlayerList=this.arrPlayerList.sort(this.compareOwner),this.listPlayerlist.removeAll(),this.listPlayerlist.reset(),this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(){var e=this.listPlayerlist.getIdx();this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrPlayerList.length;e++){var t=new ix;if(t.event.buy.add(this.chooseBuy,this),t.event.select.add(this.chooseSelect,this),t.setDataQuickPlay(this.arrPlayerList[e],e),this.listPlayerlist.add(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrPlayerList.length){this.ktBuild=!1;break}this.idx===this.arrPlayerList.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"chooseBuyMore",value:function(){LogConsole.log("chooseBuyMore"),IE.instance().addShop(0)}},{key:"chooseBuy",value:function(e){IE.instance().addPopupBuy(e)}},{key:"chooseSelect",value:function(e){console.log(e),this.mainData.dataPlayOnlineMode.id=e.id,this.mainData.dataPlayOnlineMode.genre_id=this.dataBet.dataGennes.id,this.mainData.dataPlayOnlineMode.bet_id=this.dataBet.id,qe.instance().showLoading(),TF.instance().sendData(YT.ONLINE_MODE_FIND_GAME_REQUEST,mL.begin(e.id,this.dataBet.dataGennes.id,this.dataBet.id))}},{key:"getGenres",value:function(){return this.dataBet.dataGennes}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack playlist"),this.event.back.dispatch()}},{key:"chooseBackToBet",value:function(){var e=this.dataBet.dataGennes;this.event.backBet.dispatch(e)}},{key:"chooseBackToGenres",value:function(){this.event.backGenres.dispatch()}},{key:"destroy",value:function(){this.removeDelayBuild(),this.listPlayerlist.removeAll(),this.listPlayerlist.destroy(),this.removeEvent(),this.removeAllItem(),li.instance().hideBanner(),bL(_L(t.prototype),"destroy",this).call(this)}}])&&wL(n.prototype,i),o&&wL(n,o),t}();var kL=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parent=0,this.code="",this.genre="",this.number_player=0,this.id=0,this.priority=0,this.region=""};function PL(e){return(PL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function OL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function RL(e,t,n){return(RL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xL(e){return(xL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TL(e,t){return(TL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function IL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var AL=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=xL(t).call(this,game,0,0,null))||"object"!==PL(a)&&"function"!=typeof a?IL(o):a).event={back:new Phaser.Signal,play_again:new Phaser.Signal},i.dataJoin=e,i.dataGennes=n,i.arrPlayer=[],i.idRoom=0,i.roomBet=0,i.totalPlayerPlay=0,i.ktPlay=!1,i.ktshowBadConnection=!1,i.ktStart=!1,i.idxQuestion=0,i.arrScore=[],i.arrChart={},i.arrQuestion=[],i.timecount=0,i.ktCountDownPlay=!1,i.timeTween=null,i.timerCountDown=null,i.listSongResult=null,i.showQuestion=null,i.ktReplay=!1,i.objChat={},i.startTime=0,i.endTime=0,i.addMeAnswer=new Phaser.Sprite(game,0,0,null),i.addListChart=new Phaser.Sprite(game,0,0,null),i.checkSendExit=!1,i.arrLocal=[{x:100*z.instance().scale,y:385*z.instance().scale},{x:385*z.instance().scale,y:385*z.instance().scale},{x:100*z.instance().scale,y:690*z.instance().scale},{x:385*z.instance().scale,y:690*z.instance().scale}],i.arrLocalPlay2=[{x:206*z.instance().scale,y:223*z.instance().scale},{x:354*z.instance().scale,y:223*z.instance().scale}],i.arrLocalPlay3=[{x:114*z.instance().scale,y:223*z.instance().scale},{x:276*z.instance().scale,y:223*z.instance().scale},{x:438*z.instance().scale,y:223*z.instance().scale}],i.arrLocalPlay4=[{x:59*z.instance().scale,y:223*z.instance().scale},{x:206*z.instance().scale,y:223*z.instance().scale},{x:354*z.instance().scale,y:223*z.instance().scale},{x:495*z.instance().scale,y:223*z.instance().scale}],i.arrLocalResultWin={x:260*z.instance().scale,y:140*z.instance().scale},i.arrLocalResult2=[{x:275*z.instance().scale,y:420*z.instance().scale}],i.arrLocalResult3=[{x:185*z.instance().scale,y:420*z.instance().scale},{x:365*z.instance().scale,y:420*z.instance().scale}],i.arrLocalResult4=[{x:117*z.instance().scale,y:420*z.instance().scale},{x:275*z.instance().scale,y:420*z.instance().scale},{x:431*z.instance().scale,y:420*z.instance().scale}],i.arrLocalResultAllLose2=[{x:211*z.instance().scale,y:260*z.instance().scale},{x:355*z.instance().scale,y:260*z.instance().scale}],i.arrLocalResultAllLose3=[{x:117*z.instance().scale,y:260*z.instance().scale},{x:275*z.instance().scale,y:260*z.instance().scale},{x:431*z.instance().scale,y:260*z.instance().scale}],i.arrLocalResultAllLose4=[{x:60*z.instance().scale,y:260*z.instance().scale},{x:211*z.instance().scale,y:260*z.instance().scale},{x:355*z.instance().scale,y:260*z.instance().scale},{x:490*z.instance().scale,y:260*z.instance().scale}],i.positionCreateRoom=i.mainData.positionCreateRoom,i.bg=new Phaser.Button(game,0,0,"bg_create_room"),i.addChild(i.bg),i.header=new IR,i.header.setTitle(i.dataGennes.genre),i.header.event.back.add(i.chooseBack,IL(IL(i))),i.addChild(i.header),i.addChild(i.addListChart),i.buildListPlayer(),i.txtCounDown=new _t(i.positionCreateRoom.waitting_txt_countdown,""),i.txtCounDown.anchor.set(.5),i.txtCounDown.x=game.width/2,i.addChild(i.txtCounDown),i.txtTrick=new _t(i.positionCreateRoom.waitting_txt_trick,"Hãy chọn nơi có đường truyền tốt  Để tải dữ liệu"),i.txtTrick.visible=!1,i.txtTrick.addColor("#FFA339",33),i.txtTrick.setTextBounds(0,0,game.width,95*i.mainData.scale),i.txtTrick.y=game.height-95*i.mainData.scale,i.addChild(i.txtTrick),i.lbWaittinngPlayer=new _t(i.positionCreateRoom.quickplay_text_player_waitting,""),i.addChild(i.lbWaittinngPlayer),i.btnMucCuoc=new ln(i.positionCreateRoom.button_muccuoc_room,"10"),i.addChild(i.btnMucCuoc),i.labelMuccuoc=new _t(i.positionCreateRoom.text_muccuoc_room,"Mức cược"),i.labelMuccuoc.x=(game.width-i.labelMuccuoc.width)/2,i.addChild(i.labelMuccuoc),i.lineWin=new rt(i.positionCreateRoom.result_line_win),i.lineWin.visible=!1,i.addChild(i.lineWin),i.txtWin=new _t(i.positionCreateRoom.result_txtWin_win,"Người chiến thắng !!!"),i.txtWin.setTextBounds(0,0,game.width,47*z.instance().scale),i.txtWin.visible=!1,i.addChild(i.txtWin),i.button_share=new pt(i.positionCreateRoom.button_share,i.chooseShare,IL(IL(i))),i.button_share.visible=!1,i.addChild(i.button_share,IL(IL(i))),i.buildUserJoinRoom(),i.addEvent(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TL(e,t)}(t,Mt),n=t,(i=[{key:"chooseShare",value:function(){ui.instance().share()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().events.onUserEnterRoom.add(this.userEnterRoom,this),TF.instance().events.onUserExitRoom.add(this.userExitRoom,this),TF.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this),TF.instance().events.onRoomVarsUpdate.add(this.onRoomVarsUpdate,this),TF.instance().events.onPublicMessage.add(this.onPublicMessage,this),De.instance().event.bad_connection.add(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.add(this.chooseExitBadConnection,this)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),TF.instance().events.onUserEnterRoom.remove(this.userEnterRoom,this),TF.instance().events.onUserExitRoom.remove(this.userExitRoom,this),TF.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this),TF.instance().events.onRoomVarsUpdate.remove(this.onRoomVarsUpdate,this),TF.instance().events.onPublicMessage.remove(this.onPublicMessage,this),De.instance().event.bad_connection.remove(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.remove(this.chooseExitBadConnection,this)}},{key:"showBetRoom",value:function(){this.btnMucCuoc.visible=!0,this.labelMuccuoc.visible=!0}},{key:"hideBetRoom",value:function(){this.btnMucCuoc.visible=!1,this.labelMuccuoc.visible=!1}},{key:"checkBadConnection",value:function(){!1===this.ktPlay&&!1===this.ktshowBadConnection&&(this.ktshowBadConnection=!0,IE.instance().addBadConnection())}},{key:"chooseExitBadConnection",value:function(){this.chooseExit()}},{key:"onPublicMessage",value:function(e){if(LogConsole.log("onPublicMessage"),LogConsole.log(e),e.message===Et.CHAT_ONLINE_MODE){var t=e.sender,n=t.isItMe,i=parseInt(t.name);if(e.data.containsKey("label")&&e.data.containsKey("sprite"))for(var o={label:e.data.getUtfString("label"),sprite:e.data.getUtfString("sprite")},a=0,s=0;s<this.arrPlayer.length;s++)if(!1===this.arrPlayer[s].ktEmpty&&(a++,this.arrPlayer[s].getData().user_id===i)){var r=!1;r=2===this.totalPlayerPlay?1!==a:1!==a&&2!==a;var l=new aA(n,r,o);l.event.destroy.add(this.removeItemChat,this),this.addChild(l),r?(l.x=this.arrPlayer[s].x+130*z.instance().scale-l.width,l.x<0&&(l.x=0),l.y=this.arrPlayer[s].y-15*z.instance().scale):(l.x=this.arrPlayer[s].x+55*z.instance().scale,l.y=this.arrPlayer[s].y-15*z.instance().scale),this.objChat[i]=l;break}}}},{key:"removeItemChat",value:function(e){e&&(this.removeChild(e),e.destroy(),e=null)}},{key:"getData",value:function(e){switch(e.cmd){case YT.ONLINE_MODE_SERVER_QUESTIONS_SEND:if(!1===this.ktPlay){this.hideBetRoom(),this.ktStart=!1,this.resetArrayScore(),this.ktCountDownPlay=!1,this.ktPlay=!0,TF.instance().sendLoading(1),this.hideHeader(),this.showTextTrick();for(var t=0;t<this.arrPlayer.length;t++)this.arrPlayer[t].setPlay(!0);this.arrQuestion=Zx.begin(e.params)}break;case YT.ONLINE_MODE_GAME_START:li.instance().playQuickPlay(),this.startTime=this.getTime(),Le.instance().logEvent(Le.pro_quiz_start_quickplay),this.ktStart=!0,this.ktCountDownPlay=!0,this.idxQuestion=e.params.getInt(Qh.question_index)-1,this.showTimeCountDown(3),IE.instance().removeUserProfile();break;case YT.ONLINE_MODE_USER_SELECTED_ANSWER_RESPONSE:this.setScorePlayer(e.params);break;case YT.ONLINE_MODE_GAME_RESULT:this.endTime=this.getTime();var n=parseInt((this.endTime-this.startTime)/1e3);Le.instance().logEvent(Le.play_time,n),Le.instance().logEvent(Le.pro_quiz_end_quickplay),this.removeShowResult(),this.idShowResult=game.time.events.add(2*Phaser.Timer.SECOND,this.showResult,this,e.params);break;case nS.ONLINE_MODE_ROOM_QUICK_JOIN_RESPONSE:}}},{key:"userEnterRoom",value:function(e){if(LogConsole.log("userEnterRoom------"),e.room.isGame){var t=e.user;LogConsole.log(t);for(var n=this.getDataPlayer(t),i=0;i<this.arrPlayer.length;i++)if(!0===this.arrPlayer[i].ktEmpty){this.arrPlayer[i].setDataQuickPlay(n,i),this.totalPlayerPlay++;break}}this.checkWaittingPlayer()}},{key:"userExitRoom",value:function(e){if(LogConsole.log("userExitRoom------ : "+e.user.isItMe),LogConsole.log(e.user),e.room.isGame)if(LogConsole.log("data.user.isItMe : "+e.user.isItMe),e.user.isItMe)this.mainData.ktPlayAgainOnlineMode?this.event.play_again.dispatch(this.dataJoin):this.event.back.dispatch();else if(null!==this.listSongResult);else{for(var t=e.user.getVariable(fa.user_id).value,n=0;n<this.arrPlayer.length;n++)if(!1===this.arrPlayer[n].ktEmpty){var i=this.arrPlayer[n].getData();if(i.user_id===t){this.ktPlay?(this.ktStart,i.user_id=-1,this.arrPlayer[n].setCurrentData(i),this.arrPlayer[n].setDisConnect()):(this.arrPlayer[n].setEmpty(),this.totalPlayerPlay--);break}}this.checkWaittingPlayer()}}},{key:"userVarsUpdate",value:function(e){var t=e.user,n=this.getDataPlayer(t);if(-1!==e.changedVars.indexOf(fa.online_mode_loaded)&&!0===this.ktPlay){var i=t.getVariable(fa.online_mode_loaded).value;LogConsole.log("perLoad : "+i);for(var o=0;o<this.arrPlayer.length;o++){var a=this.arrPlayer[o];!1===a.ktEmpty&&a.getData().user_id===n.user_id&&i>0&&a.setLoading(i)}}for(var s=0;s<this.arrPlayer.length;s++){var r=this.arrPlayer[s];if(!1===r.ktEmpty)if(r.getData().user_id==n.user_id){this.arrPlayer[s].setCurrentData(n);break}}}},{key:"onRoomVarsUpdate",value:function(){}},{key:"buildUserJoinRoom",value:function(){LogConsole.log("buildUserJoinRoom"),LogConsole.log(this.dataGennes),LogConsole.log(this.dataJoin.room);var e=this.dataJoin.room.getUserList();this.idRoom=this.dataJoin.room.id,this.mainData.modeplay=this.dataJoin.room.getVariable("mode").value,this.roomBet=this.mainData.dataPlayOnlineMode.bet_place,this.btnMucCuoc.setText(this.roomBet);for(var t=0;t<e.length;t++){var n=e[t],i=this.getDataPlayer(n);this.arrPlayer[t].setDataQuickPlay(i,t),this.totalPlayerPlay++}this.checkWaittingPlayer(),qe.instance().hideLoading()}},{key:"showResult",value:function(e){game.sound.stopAll(),this.ktReplay=!1,this.lineWin.visible=!0,this.txtWin.visible=!0,this.ktPlay=!1,LI.begin(e,this.arrPlayer);var t=[];this.arrScore[0].score>0?2===this.totalPlayerPlay?t=this.arrLocalResult2:3===this.totalPlayerPlay?t=this.arrLocalResult3:4===this.totalPlayerPlay&&(t=this.arrLocalResult4):2===this.totalPlayerPlay?t=this.arrLocalResultAllLose2:3===this.totalPlayerPlay?t=this.arrLocalResultAllLose3:4===this.totalPlayerPlay&&(t=this.arrLocalResultAllLose4);for(var n=-1,i=0,o=0,a=0,s=0;s<this.arrScore.length;s++)!1===this.arrPlayer[this.arrScore[s].idx].ktEmpty&&(0===s?this.arrScore[0].score>0?(i=this.arrLocalResultWin.x,o=this.arrLocalResultWin.y,a=.76,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!0,this.roomBet),this.removeShowResult(),this.idShowResult=game.time.events.add(.8*Phaser.Timer.SECOND,this.addEffectUserWin,this,this.arrPlayer[this.arrScore[s].idx]),this.arrPlayer[this.arrScore[s].idx].getData().user_id===TF.instance().dataMySeft.user_id&&ce.instance().playSound(ce.winturnbasepartymode)):(i=t[++n].x,o=t[n].y,a=.61,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!1)):(i=t[++n].x,o=t[n].y,a=.61,this.arrPlayer[this.arrScore[s].idx].setButtonWin(!1),this.arrPlayer[this.arrScore[s].idx].getData().user_id===TF.instance().dataMySeft.user_id&&ce.instance().playSound(ce.loseturnbasepartymode)),game.add.tween(this.arrPlayer[this.arrScore[s].idx]).to({x:i,y:o},500,Phaser.Easing.Power1,!0,200),game.add.tween(this.arrPlayer[this.arrScore[s].idx].scale).to({x:a,y:a},500,Phaser.Easing.Power1,!0,200));for(var r=0;r<this.arrPlayer.length;r++)this.arrPlayer[r].setPlay(!1),!0===this.arrPlayer[r].ktDisConnect&&(this.arrPlayer[r].setEmpty(),this.totalPlayerPlay--);this.button_share.visible=!0,this.showQuestion.hideQuestion(),this.hideAnswerMe(),this.hideChart(),this.addListSongResult()}},{key:"addEffectUserWin",value:function(e){this.removeEffectWin(),this.rotationWin=new rt(this.positionCreateRoom.light_rotation_list_result),this.rotationWin.anchor.set(.5),this.addListChart.addChild(this.rotationWin),this.rotationWin.x=e.x+60*z.instance().scale,this.rotationWin.y=e.y+100*z.instance().scale,this.tweenRotationwin=game.add.tween(this.rotationWin).to({rotation:360},2e3,Phaser.Easing.Power1,!0),this.tweenRotationwin.repeat(99999,250),this.firework=new Phaser.Sprite(game,0,0,"firework"),this.firework.width=430*z.instance().scale,this.firework.height=228*z.instance().scale,this.firework.x=103*z.instance().scale,this.firework.y=106*z.instance().scale,this.firework.animations.add("playfirework"),this.firework.animations.play("playfirework",30,!0),this.addListChart.addChild(this.firework),this.ktReplay=!0,this.listSongResult.ktReplay=!0}},{key:"removeEffectWin",value:function(){if(this.addListChart.children)for(;this.addListChart.children.length>0;){var e=this.addListChart.children[0];this.addListChart.removeChild(e),e.destroy(),e=null}}},{key:"resetArrayScore",value:function(){this.arrScore=[{idx:0,score:0},{idx:1,score:0},{idx:2,score:0},{idx:3,score:0}]}},{key:"showPlayGame",value:function(){var e=this;this.hideTextTrick(),LogConsole.log("showPlayGame");var t=[];2===this.totalPlayerPlay?t=this.arrLocalPlay2:3===this.totalPlayerPlay?t=this.arrLocalPlay3:4===this.totalPlayerPlay&&(t=this.arrLocalPlay4);var n=-1;this.arrChart={};for(var i=0;i<this.arrPlayer.length;i++)if(!1===this.arrPlayer[i].ktEmpty)n++,this.arrPlayer[i].hideLoading(),this.arrPlayer[i].setTextSanSang(""),this.arrPlayer[i].setScore(0),this.arrPlayer[i].setUserPlayGame(),game.add.tween(this.arrPlayer[i]).to({x:t[n].x,y:t[n].y},400,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[i].scale).to({x:.62,y:.62},400,Phaser.Easing.Power1,!0),game.time.events.add(.4*Phaser.Timer.SECOND,this.buidlChartUser,this,this.arrPlayer[i].getData().user_id,n,i,t);else{var o=0;o=i%2==0?-this.arrPlayer[i].width-200*z.instance().scale:game.width+200*z.instance().scale,game.add.tween(this.arrPlayer[i]).to({x:o},200,Phaser.Easing.Power1,!0)}setTimeout(function(){e.buildListMeAnswer(),e.addShowQuestion(e.idxQuestion)},600)}},{key:"buidlChartUser",value:function(e,t,n,i){var o=new DT;TF.instance().dataMySeft.user_id===e?o.addChart(!0):o.addChart(!1),o.x=i[t].x+2*z.instance().scale,o.y=i[t].y+72*z.instance().scale,o.height=0,this.addListChart.addChild(o),this.arrChart[n]=o,this.setChart(0,n)}},{key:"hideChart",value:function(){for(;this.addListChart.children.length>0;){var e=this.addListChart.children[0];this.addListChart.removeChild(e),e.destroy(),e=null}}},{key:"setChart",value:function(e,t){if(this.arrChart[t]){var n=55*z.instance().scale+200*z.instance().scale*e,i=223*z.instance().scale-200*z.instance().scale*e,o=i+72;game.add.tween(this.arrChart[t]).to({y:o,height:n},500,Phaser.Easing.Power1,!0),game.add.tween(this.arrPlayer[t]).to({y:i},500,Phaser.Easing.Power1,!0),this.objChat[this.arrPlayer[t].getData().user_id]&&null!=this.objChat[this.arrPlayer[t].getData().user_id]&&game.add.tween(this.objChat[this.arrPlayer[t].getData().user_id]).to({y:i-92*z.instance().scale},500,Phaser.Easing.Power1,!0)}}},{key:"setScorePlayer",value:function(e){if(LogConsole.log("setScorePlayer : "+e.getDump()),"OK"===e.getUtfString(fa.status)){LogConsole.log(1);for(var t=0;t<this.arrPlayer.length;t++)if(!1===this.arrPlayer[t].ktEmpty){LogConsole.log(2);var n=this.arrPlayer[t].getData(),i=e.getInt(fa.user_id);if(n.user_id===i){var o=e.getInt(fa.score),a=e.getBool(fa.is_correct_answer);this.arrPlayer[t].setScore(o),!0===a?this.arrPlayer[t].setTrueAnswer():this.arrPlayer[t].setFailtAnswer();for(var s=0;s<this.arrScore.length;s++)if(this.arrScore[s].idx==t){this.arrScore[s].score=o;break}break}}}this.arrScore.sort(this.compare);var r=this.arrScore[0].score;if(r>0){this.setChart(1,this.arrScore[0].idx);for(var l=1;l<this.arrScore.length;l++)!1===this.arrPlayer[this.arrScore[l].idx].ktEmpty&&this.setChart(this.arrScore[l].score/r,this.arrScore[l].idx)}}},{key:"buildListMeAnswer",value:function(){for(;this.addMeAnswer.children.length>0;){var e=this.addMeAnswer.children[0];this.addMeAnswer.removeChild(e),e.destroy(),e=null}var t=0,n=25*z.instance().scale;this.arrMeAnswer=[];for(var i=0;i<this.arrQuestion.length;i++){var o=new KT;o.x=t,o.y=n,this.addMeAnswer.addChild(o),t+=54*z.instance().scale,game.add.tween(o).to({y:0},400,Phaser.Easing.Elastic.Out,!0,30*i,1),this.arrMeAnswer.push(o)}this.addMeAnswer.y=385*z.instance().scale,this.addChild(this.addMeAnswer),this.addMeAnswer.x=(game.width-t)/2}},{key:"hideAnswerMe",value:function(){for(var e=0;e<this.arrMeAnswer.length;e++)game.add.tween(this.arrMeAnswer[e]).to({alpha:0},200,Phaser.Easing.Elastic.Out,!0)}},{key:"setMeAnswer",value:function(e){this.arrMeAnswer[e.idx].setData(e)}},{key:"setShowMeAnswerCurrent",value:function(e){this.arrMeAnswer[e].setBeginLoad()}},{key:"addShowQuestion",value:function(e){LogConsole.log("addShowQuestion"),this.removeShowQuestion(),this.setShowMeAnswerCurrent(e),this.showQuestion=new II(this.arrQuestion,e),this.showQuestion.addEventChooseAnswer(this.setMeAnswer,this),this.showQuestion.addEventShowQuestion(this.setShowMeAnswerCurrent,this),this.showQuestion.event.close.add(this.removeShowQuestion,this),this.showQuestion.x=0,this.showQuestion.y=game.height-700*z.instance().scale,this.addChild(this.showQuestion)}},{key:"removeShowQuestion",value:function(){null!=this.showQuestion&&(this.showQuestion.kill(),this.showQuestion.destroy(),this.showQuestion=null)}},{key:"addListSongResult",value:function(){this.removeListSongResult(),this.listSongResult=new $I(this.arrQuestion,this.roomBet),this.listSongResult.ktReplay=!0,this.listSongResult.event.replay.add(this.showReplayGame,this),this.listSongResult.event.close.add(this.removeListSongResult,this),this.listSongResult.event.exit.add(this.chooseExit,this),this.listSongResult.y=game.height-515*z.instance().scale,this.addChild(this.listSongResult)}},{key:"removeListSongResult",value:function(){null!==this.listSongResult&&(this.removeChild(this.listSongResult),this.listSongResult.destroy(),this.listSongResult=null)}},{key:"chooseExit",value:function(){this.mainData.ktPlayAgainOnlineMode=!1,qe.instance().showLoading(),TF.instance().sendData(YT.ONLINE_MODE_GAME_FINISH,null)}},{key:"showReplayGame",value:function(){LogConsole.log("showReplayGame---------"),this.lineWin.visible=!1,this.txtWin.visible=!1,this.mainData.ktPlayAgainOnlineMode=!0,qe.instance().showLoading(),TF.instance().sendData(YT.ONLINE_MODE_GAME_FINISH,null)}},{key:"showTimeCountDown",value:function(e){this.lbWaittinngPlayer.text="",this.removeTimeCountDown(),this.timecount=e,this.setTextCountDown(),this.timerCountDown=this.game.time.create(!0),this.timerEventCountDown=this.timerCountDown.loop(1e3,this.onTimerCountDown,this),this.timerCountDown.start()}},{key:"onTimerCountDown",value:function(){this.timecount--,this.setTextCountDown()}},{key:"setTextCountDown",value:function(){this.timecount>-1?(this.timecount<6&&(game.sound.stopAll(),game.sound.play("beep_audio")),this.ktCountDownPlay&&0===this.timecount?this.txtCounDown.text="Bắt đầu":this.txtCounDown.text=this.timecount,this.txtCounDown.y=this.positionCreateRoom.waitting_txt_countdown.y*z.instance().scale+80*z.instance().scale,game.add.tween(this.txtCounDown).to({y:this.positionCreateRoom.waitting_txt_countdown.y*z.instance().scale},200,Phaser.Easing.Elastic.Out,!0)):(this.ktCountDownPlay&&this.showPlayGame(),this.removeTimeCountDown())}},{key:"removeTimeCountDown",value:function(){null!==this.timerCountDown&&(game.time.events.remove(this.timerEventCountDown),this.timerEventCountDown=null,this.timerCountDown.stop(),this.timerCountDown.destroy(),this.timerCountDown=null),this.txtCounDown.text=""}},{key:"hideHeader",value:function(){this.header.setHideBtnBack(),this.header.y=0,game.add.tween(this.header).to({y:-180*z.instance().scale},300,Phaser.Easing.Power1,!0)}},{key:"showHeader",value:function(){this.header.setShowBtnBack(),this.header.y=-180*z.instance().scale,game.add.tween(this.header).to({y:0},300,Phaser.Easing.Power1,!0)}},{key:"showTextTrick",value:function(){this.txtTrick.visible=!0}},{key:"hideTextTrick",value:function(){this.txtTrick.visible=!1}},{key:"buildListPlayer",value:function(){this.arrPlayer=[];for(var e=0;e<this.arrLocal.length;e++){var t=new Nx;t.setEmpty(),t.setIdx(e),t.x=e%2==0?-t.width-200*z.instance().scale:game.width+200*z.instance().scale,t.y=this.arrLocal[e].y,game.add.tween(t).to({x:this.arrLocal[e].x},250,Phaser.Easing.Power1,!0,400),this.addChild(t),this.arrPlayer.push(t)}}},{key:"getDataPlayer",value:function(e){var t=new _x;return t.user_id=e.getVariable(fa.user_id).value,t.user_name=e.getVariable(fa.user_name).value,t.avatar=e.getVariable(fa.avatar).value,t}},{key:"checkWaittingPlayer",value:function(){if(!1===this.ktPlay&&null===this.listSongResult){for(var e=4,t=0;t<this.arrPlayer.length;t++)!1===this.arrPlayer[t].ktEmpty&&e--;e>0?(this.lbWaittinngPlayer.text="Đang đợi "+e+" người chơi nữa...",this.lbWaittinngPlayer.x=(game.width-this.lbWaittinngPlayer.width)/2):(this.lbWaittinngPlayer.text="Đang tải dữ liệu...",this.lbWaittinngPlayer.x=(game.width-this.lbWaittinngPlayer.width)/2)}}},{key:"removeShowResult",value:function(){null!==this.idShowResult&&game.time.events.remove(this.idShowResult)}},{key:"chooseBack",value:function(){!1===this.ktPlay&&!1===this.checkSendExit&&(this.checkSendExit=!0,this.mainData.ktPlayAgainOnlineMode=!1,TF.instance().sendExitRoom())}},{key:"destroy",value:function(){El.instance().removeAllSound(),this.removeShowResult(),this.removeEvent(),this.removeAllItem(),RL(xL(t.prototype),"destroy",this).call(this)}}])&&OL(n.prototype,i),o&&OL(n,o),t}();function LL(e){return(LL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function GL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function DL(e,t){return!t||"object"!==LL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ML(e,t,n){return(ML="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=NL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function NL(e){return(NL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BL(e,t){return(BL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jL=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),DL(this,NL(t).call(this,game,0,0,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BL(e,t)}(t,Mt),n=t,(i=[{key:"afterCreate",value:function(){this.chooseGenes=null,this.chooseBet=null,this.choosePlaylist=null,this.playGame=null,this.event={back:new Phaser.Signal},this.bg=new Phaser.Sprite(game,0,0,"bg-playlist"),this.addChild(this.bg),this.addChooseGenes(),Le.instance().logEvent(Le.Party_online_mode_quickplay),this.addEvent()}},{key:"getData",value:function(e){switch(e.cmd){case YT.ONLINE_MODE_FIND_GAME_RESPONSE:"FAILED"===e.params.getUtfString("status")&&this.chooseBack()}}},{key:"addEventAll",value:function(){null!==this.chooseGenes&&this.chooseGenes.addEvent(),null!==this.chooseBet&&this.chooseBet.addEvent(),null!==this.choosePlaylist&&this.choosePlaylist.addEvent()}},{key:"addChooseGenes",value:function(){this.removeChooseGenes(),this.chooseGenes=new tL,this.chooseGenes.event.back.add(this.chooseBack,this),this.chooseGenes.event.next_bet.add(this.addChooseBet,this),this.addChild(this.chooseGenes),null!==this.chooseBet?(Nc.instance().beginSwitch(this.chooseBet,this.chooseGenes,!0),Nc.instance().event.tweenComplete.add(this.tweenChooseBetComplete,this)):null!==this.choosePlaylist?(Nc.instance().beginSwitch(this.choosePlaylist,this.chooseGenes,!0),Nc.instance().event.tweenComplete.add(this.tweenChoosePlaylistComplete,this)):null!==this.playGame?(Nc.instance().beginSwitch(this.playGame,this.chooseGenes,!0),Nc.instance().event.tweenComplete.add(this.tweenplayGameComplete,this)):this.addEventAll()}},{key:"tweenChooseBetComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenChooseBetComplete,this),this.removeChooseBet(),this.addEventAll()}},{key:"tweenChoosePlaylistComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenChoosePlaylistComplete,this),this.removeChoosePlaylist(),this.addEventAll()}},{key:"tweenChooseGenesComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenChooseGenesComplete,this),this.removeChooseGenes(),this.addEventAll()}},{key:"tweenplayGameComplete",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenplayGameComplete,this),this.removePlayGame(),this.addEventAll()}},{key:"removeChooseGenes",value:function(){null!==this.chooseGenes&&(this.removeChild(this.chooseGenes),this.chooseGenes.destroy(),this.chooseGenes=null)}},{key:"addChooseBet",value:function(e){this.removeChooseBet(),this.chooseBet=new gL(e),this.chooseBet.event.back.add(this.chooseBack,this),this.chooseBet.event.choose_bet.add(this.addChoosePlaylist,this),this.chooseBet.event.backGenres.add(this.addChooseGenes,this),this.addChild(this.chooseBet),null!==this.chooseGenes?(Nc.instance().beginSwitch(this.chooseGenes,this.chooseBet,!1),Nc.instance().event.tweenComplete.add(this.tweenChooseGenesComplete,this)):null!==this.choosePlaylist?(Nc.instance().beginSwitch(this.choosePlaylist,this.chooseBet,!0),Nc.instance().event.tweenComplete.add(this.tweenChoosePlaylistComplete,this)):this.addEventAll()}},{key:"removeChooseBet",value:function(){null!==this.chooseBet&&(this.removeChild(this.chooseBet),this.chooseBet.destroy(),this.chooseBet=null)}},{key:"addChoosePlaylist",value:function(e){this.removeChoosePlaylist(),this.choosePlaylist=new CL(e),this.choosePlaylist.event.back.add(this.chooseBack,this),this.choosePlaylist.event.backGenres.add(this.addChooseGenes,this),this.choosePlaylist.event.backBet.add(this.addChooseBet,this),this.addChild(this.choosePlaylist),null!==this.chooseBet?(Nc.instance().beginSwitch(this.chooseBet,this.choosePlaylist,!1),Nc.instance().event.tweenComplete.add(this.tweenChooseBetComplete,this)):this.addEventAll()}},{key:"removeChoosePlaylist",value:function(){null!==this.choosePlaylist&&(this.removeChild(this.choosePlaylist),this.choosePlaylist.destroy(),this.choosePlaylist=null)}},{key:"addPlayGame",value:function(e){this.removePlayGame();var t=new kL;null!==this.choosePlaylist?(t=this.choosePlaylist.getGenres(),this.mainData.dataGennes=t):t=this.mainData.dataGennes,this.playGame=new AL(e,t),this.playGame.event.back.add(this.chooseBack,this),this.playGame.event.play_again.add(this.playAgain,this),this.addChild(this.playGame),null!==this.choosePlaylist&&(Nc.instance().beginSwitch(this.choosePlaylist,this.playGame,!1),Nc.instance().event.tweenComplete.add(this.tweenChoosePlaylistComplete,this)),null!==this.chooseBet&&this.removeChooseBet(),null!==this.chooseGenes&&this.removeChooseGenes()}},{key:"playAgain",value:function(){TF.instance().sendData(YT.ONLINE_MODE_FIND_GAME_REQUEST,mL.begin(this.mainData.dataPlayOnlineMode.id,this.mainData.dataPlayOnlineMode.genre_id,this.mainData.dataPlayOnlineMode.bet_id))}},{key:"removePlayGame",value:function(){null!==this.playGame&&(this.removeChild(this.playGame),this.playGame.destroy(),this.playGame=null)}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack-quicplay"),this.event.back.dispatch()}},{key:"destroy",value:function(){this.removeEvent(),ML(NL(t.prototype),"destroy",this).call(this)}}])&&GL(n.prototype,i),o&&GL(n,o),t}();function UL(e){return(UL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZL(e,t){return!t||"object"!==UL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HL(e,t,n){return(HL="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=QL(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function QL(e){return(QL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function VL(e,t){return(VL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var WL=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=ZL(this,QL(t).call(this,game,0,0,null))).onlineModeCreateRoom=null,e.onlineModeQuikPlay=null,e.arrResource=[{type:"text",link:"img/config/positionCreateRoom.json",key:"positionCreateRoom"},{type:"atlas",link:"img/atlas/createroom.png",key:"createroom",linkJson:"img/atlas/createroom.json"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&VL(e,t)}(t,Yy),n=t,(i=[{key:"loadFileComplete",value:function(){HL(QL(t.prototype),"loadFileComplete",this).call(this),this.addEvent(),this.addOnlineModeCreateRoom()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().events.onRoomJoin.add(this.joinRoom,this)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),TF.instance().events.onRoomJoin.remove(this.joinRoom,this)}},{key:"addQuickPlayGame",value:function(){this.removeQuickPlayGame(),this.onlineModeQuikPlay=new jL,this.onlineModeQuikPlay.event.back.add(this.quickPlayBackToCreateRoom,this),this.addChild(this.onlineModeQuikPlay),null!==this.onlineModeCreateRoom&&(Nc.instance().beginSwitch(this.onlineModeCreateRoom,this.onlineModeQuikPlay,!1),Nc.instance().event.tweenComplete.add(this.tweenCompleteCreateRoom,this))}},{key:"tweenCompleteCreateRoom",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenCompleteCreateRoom,this),this.removeOnlineModeCreateRoom()}},{key:"removeQuickPlayGame",value:function(){null!==this.onlineModeQuikPlay&&(this.removeChild(this.onlineModeQuikPlay),this.onlineModeQuikPlay.destroy(),this.onlineModeQuikPlay=null)}},{key:"quickPlayBackToCreateRoom",value:function(){this.addOnlineModeCreateRoom(!0)}},{key:"addOnlineModeCreateRoom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.removeOnlineModeCreateRoom(),this.onlineModeCreateRoom=new PA(e),this.onlineModeCreateRoom.event.quickplay.add(this.addQuickPlayGame,this),this.addChild(this.onlineModeCreateRoom),null!==this.onlineModeQuikPlay&&(Nc.instance().beginSwitch(this.onlineModeQuikPlay,this.onlineModeCreateRoom,!0),Nc.instance().event.tweenComplete.add(this.tweenCompleteQuickPlay,this))}},{key:"tweenCompleteQuickPlay",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenCompleteQuickPlay,this),this.removeQuickPlayGame()}},{key:"removeOnlineModeCreateRoom",value:function(){null!==this.onlineModeCreateRoom&&(this.removeChild(this.onlineModeCreateRoom),this.onlineModeCreateRoom.destroy(),this.onlineModeCreateRoom=null)}},{key:"getData",value:function(e){}},{key:"joinRoom",value:function(e){if(LogConsole.log("joinRoom"),LogConsole.log(e),e.room.isGame){var t=e.room.getVariable("mode").value;"OnlineMode"===t?null!==this.onlineModeQuikPlay?this.onlineModeQuikPlay.addPlayGame(e):(this.addQuickPlayGame(),this.onlineModeQuikPlay.addPlayGame(e)):"OnlineModeRoom"===t&&(this.mainData.dataJoinRoom=e,null!==this.onlineModeCreateRoom?this.onlineModeCreateRoom.checkDataRoom():null!==this.onlineModeQuikPlay?this.addOnlineModeCreateRoom(!0):this.addOnlineModeCreateRoom())}}},{key:"destroy",value:function(){this.removeEvent(),this.mainData.positionCreateRoomData=null,El.instance().removeAllSound(),HL(QL(t.prototype),"destroy",this).call(this)}}])&&FL(n.prototype,i),o&&FL(n,o),t}();function qL(e){return(qL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KL(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zL(e,t){return!t||"object"!==qL(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function YL(e){return(YL=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function JL(e,t){return(JL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var XL=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=zL(this,YL(t).call(this,game,0,0,"otherSprites","tab-friend"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JL(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward}},{key:"addRequireAndReward",value:function(e){this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.require_done.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.require_done.y*window.GameConfig.RESIZE,e.quest,this.positionQAndAConfig.scroll.require_done.configs),this.required.anchor.set(0,.5),this.addChild(this.required);var t=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.doneIcon.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.doneIcon.y*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.doneIcon.nameAtlas,this.positionQAndAConfig.scroll.doneIcon.nameSprite);t.anchor.set(1,0),this.addChild(t);var n=new rt(this.positionQAndAConfig.line_under);this.addChild(n)}}])&&KL(n.prototype,i),o&&KL(n,o),t}();function $L(e){return($L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tG(e,t){return!t||"object"!==$L(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nG(e){return(nG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iG(e,t){return(iG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oG=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=tG(this,nG(t).call(this,game,0,0,"otherSprites","tab-friend"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward}},{key:"addRequireAndReward",value:function(e){var t;this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.requireInitDaily.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.requireInitDaily.y*window.GameConfig.RESIZE,"".concat(e.quest," (").concat(e.achieved,"/").concat(e.required,")"),this.positionQAndAConfig.scroll.requireInitDaily.configs),this.required.anchor.set(0,.5),this.addChild(this.required),this.reward=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardDoingDaily.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoingDaily.y*window.GameConfig.RESIZE,null),"DIAMOND"==e.reward_type?t="Gem":"TICKET"==e.reward_type?t="Ticket":"SUPPORT_ITEM"==e.reward_type&&(t="Mic");var n=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardDoingDaily.diamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoingDaily.diamond.y*window.GameConfig.RESIZE,"questAndAchieveSprites",t);this.reward.addChild(n);var i=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnRewardDoingDaily.txtDiamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoingDaily.txtDiamond.y*window.GameConfig.RESIZE,e.reward,this.positionQAndAConfig.scroll.btnRewardDoingDaily.txtDiamond.configs);this.reward.addChild(i),this.addChild(this.reward);var o=new rt(this.positionQAndAConfig.line_under);this.addChild(o)}}])&&eG(n.prototype,i),o&&eG(n,o),t}();function aG(e){return(aG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rG(e,t){return!t||"object"!==aG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lG(e){return(lG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hG(e,t){return(hG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cG=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=rG(this,lG(t).call(this,game,0,102*window.GameConfig.RESIZE,null))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.headerScroll,e.listScroll,e.event={claimReward:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addHeaderScroll();var e=new Phaser.Group(game);e.x=0,e.y=95*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-386)*window.GameConfig.RESIZE);this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}},{key:"addHeaderScroll",value:function(){this.headerScroll=new Phaser.Sprite(game,0,0,"otherSprites","tab-list"),this.addChildInHeaderScroll(this.positionQAndAConfig.scroll.daily.header),this.addChild(this.headerScroll)}},{key:"addChildInHeaderScroll",value:function(e){var t=new Phaser.Text(game,e.txt_request.x*window.GameConfig.RESIZE,e.txt_request.y*window.GameConfig.RESIZE,e.txt_request.text,e.txt_request.configs);this.headerScroll.addChild(t);var n=new Phaser.Text(game,e.txt_reward.x*window.GameConfig.RESIZE,e.txt_reward.y*window.GameConfig.RESIZE,e.txt_reward.text,e.txt_reward.configs);n.anchor.set(1,0),this.headerScroll.addChild(n);var i=new Phaser.Sprite(game,e.line.x*window.GameConfig.RESIZE,e.line.y*window.GameConfig.RESIZE,e.line.nameAtlas,e.line.nameSprite);this.headerScroll.addChild(i)}},{key:"setQuestsAndQuestLogs",value:function(e){this.quests=e,this.addListScroll()}},{key:"addListScroll",value:function(){for(var e=0;e<this.quests.length;e++)if(LogConsole.log(this.quests[e]),this.quests[e].achieved<this.quests[e].required){var t=new oG;t.addRequireAndReward(this.quests[e]),this.listView.add(t)}else{var n=new XL;n.addRequireAndReward(this.quests[e]),this.listView.add(n)}}},{key:"destroy",value:function(){for(this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&sG(n.prototype,i),o&&sG(n,o),t}();function uG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var dG=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.reward=0,this.reward_type="",this.achieved=0,this.id=0,this.quest="",this.required=0,this.quest_type=0}var t,n,i;return t=e,i=[{key:"get_daily_quest",get:function(){return"daily_quest"}}],(n=null)&&uG(t.prototype,n),i&&uG(t,i),e}();function fG(e){return(fG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gG(e,t){return!t||"object"!==fG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yG(e){return(yG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mG(e,t){return(mG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vG=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=gG(this,yG(t).call(this,game,e,n,null))).type=1,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),o.scrollScreenOnTab=null,o.signalInput=new Phaser.Signal,o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"addScrollScreen",value:function(){this.scrollScreenOnTab=new cG,this.addChild(this.scrollScreenOnTab)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.DAILY_QUEST_LOAD_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleDailyQuest(e.params,function(){t.doneDailyQuestResponse()}):console.warn(e.params.getUtfString("message")))}},{key:"doneDailyQuestResponse",value:function(){this.addScrollScreen(),this.scrollScreenOnTab.setQuestsAndQuestLogs(z.instance().dailyQuestLists),Le.instance().logEvent(Le.Quest_Daily),qe.instance().hideLoading()}},{key:"show",value:function(){qe.instance().showLoading(),this.checkDailyQuestLoadRequest(),0==z.instance().isDailyQuestLoad.checking?(TF.instance().sendData(Et.DAILY_QUEST_LOAD_REQUEST,null),z.instance().isDailyQuestLoad.checking=!0,z.instance().isDailyQuestLoad.updated=Date.now()):this.doneDailyQuestResponse(),game.add.tween(this).to({x:0},150,"Linear",!0),Le.instance().logEvent(Le.Quest_Daily)}},{key:"checkDailyQuestLoadRequest",value:function(){1==z.instance().isDailyQuestLoad.checking?Date.now()-z.instance().isDailyQuestLoad.updated<6e3?z.instance().isDailyQuestLoad.checking=!0:z.instance().isDailyQuestLoad.checking=!1:z.instance().isDailyQuestLoad.checking=!1}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300*window.GameConfig.RESIZE},150,"Linear",!0);i.start(),i.onComplete.add(function(){t.destroy()},this)}}},{key:"handleDailyQuest",value:function(e,t){z.instance().dailyQuestLists=[];for(var n=e.getSFSArray("daily_quest"),i=0;i<n.size();i++){var o=new dG,a=n.getSFSObject(i);o.reward=a.getInt("reward"),o.reward_type=a.getUtfString("reward_type"),o.achieved=a.getInt("achieved"),o.id=a.getInt("id"),o.quest=a.getUtfString("quest"),o.required=a.getInt("required"),o.quest_type=a.getInt("quest_type"),z.instance().dailyQuestLists.push(o)}t()}},{key:"destroy",value:function(){for(TF.instance().removeEventExtension(this.onExtensionResponse,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&pG(n.prototype,i),o&&pG(n,o),t}();function wG(e){return(wG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _G(e,t){return!t||"object"!==wG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function SG(e){return(SG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EG(e,t){return(EG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CG=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=_G(this,SG(t).call(this,game,0,0,"otherSprites","tab-friend"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward}},{key:"addRequireAndReward",value:function(e){var t;this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.require.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.require.y*window.GameConfig.RESIZE,e.quest,this.positionQAndAConfig.scroll.require.configs),this.required.anchor.set(0,.5),this.addChild(this.required),this.reward=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnReward.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnReward.y*window.GameConfig.RESIZE,null),"DIAMOND"==e.reward_type?t="Gem":"TICKET"==e.reward_type?t="Ticket":"SUPPORT_ITEM"==e.reward_type&&(t="Mic");var n=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnReward.diamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnReward.diamond.y*window.GameConfig.RESIZE,"questAndAchieveSprites",t);this.reward.addChild(n);var i=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnReward.txtDiamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnReward.txtDiamond.y*window.GameConfig.RESIZE,e.reward,this.positionQAndAConfig.scroll.btnReward.txtDiamond.configs);this.reward.addChild(i),this.addChild(this.reward);var o=new rt(this.positionQAndAConfig.line_under);this.addChild(o)}}])&&bG(n.prototype,i),o&&bG(n,o),t}();function kG(e){return(kG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OG(e,t){return!t||"object"!==kG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RG(e){return(RG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xG(e,t){return(xG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var TG=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=OG(this,RG(t).call(this,game,0,0,"questAndAchieveSprites","Tab_Quest_Dang_Lam"))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.required,this.reward}},{key:"addRequireAndReward",value:function(e,t){var n;this.required=new Phaser.Text(game,this.positionQAndAConfig.scroll.requireInit.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.requireInit.y*window.GameConfig.RESIZE,"".concat(e.quest," (").concat(t.next_quest_archieved,"/").concat(e.required,")"),this.positionQAndAConfig.scroll.requireInit.configs),this.required.anchor.set(0,.5),this.addChild(this.required),this.reward=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardDoing.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoing.y*window.GameConfig.RESIZE,null),"DIAMOND"==e.reward_type?n="Gem":"TICKET"==e.reward_type?n="Ticket":"SUPPORT_ITEM"==e.reward_type&&(n="Mic");var i=new Phaser.Sprite(game,this.positionQAndAConfig.scroll.btnRewardDoing.diamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoing.diamond.y*window.GameConfig.RESIZE,"questAndAchieveSprites",n);this.reward.addChild(i);var o=new Phaser.Text(game,this.positionQAndAConfig.scroll.btnRewardDoing.txtDiamond.x*window.GameConfig.RESIZE,this.positionQAndAConfig.scroll.btnRewardDoing.txtDiamond.y*window.GameConfig.RESIZE,e.reward,this.positionQAndAConfig.scroll.btnRewardDoing.txtDiamond.configs);this.reward.addChild(o),this.addChild(this.reward)}}])&&PG(n.prototype,i),o&&PG(n,o),t}();function IG(e){return(IG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function LG(e,t){return!t||"object"!==IG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function GG(e){return(GG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DG(e,t){return(DG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var MG=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=LG(this,GG(t).call(this,game,0,102*window.GameConfig.RESIZE,null))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.headerScroll,e.listScroll,e.quests,e.questLogs,e.nextQuest,e.listView,e.event={claimReward:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addHeaderScroll();var e=new Phaser.Group(game);e.x=0,e.y=95*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,0,640*window.GameConfig.RESIZE,(game.height-386)*window.GameConfig.RESIZE);this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0})}},{key:"addHeaderScroll",value:function(){this.headerScroll=new Phaser.Sprite(game,0,0,"otherSprites","tab-list"),this.addChildInHeaderScroll(this.positionQAndAConfig.scroll.main.header),this.addChild(this.headerScroll)}},{key:"addChildInHeaderScroll",value:function(e){var t=new Phaser.Text(game,e.txt_request.x*window.GameConfig.RESIZE,e.txt_request.y*window.GameConfig.RESIZE,e.txt_request.text,e.txt_request.configs);this.headerScroll.addChild(t);var n=new Phaser.Text(game,e.txt_reward.x*window.GameConfig.RESIZE,e.txt_reward.y*window.GameConfig.RESIZE,e.txt_reward.text,e.txt_reward.configs);n.anchor.set(1,0),this.headerScroll.addChild(n);var i=new Phaser.Sprite(game,e.line.x*window.GameConfig.RESIZE,e.line.y*window.GameConfig.RESIZE,e.line.nameAtlas,e.line.nameSprite);this.headerScroll.addChild(i)}},{key:"setQuestsAndQuestLogs",value:function(e,t,n){this.quests=e,this.questLogs=t,this.nextQuest=n,this.addListScroll()}},{key:"addListScroll",value:function(){this.listView.removeAll(),this.listView.reset();for(var e=0,t=0;t<this.quests.length;t++){for(var n=!1,i=0;i<this.questLogs.length;i++)if(this.questLogs[i].quest_id==this.quests[t].id){if(n=!0,"INIT"==this.questLogs[i].state)(o=new xt).addRequireAndReward(this.quests[t],this.questLogs[i].id),o.event.claimReward.add(this.claimReward,this),this.listView.add(o);else if("REWARDED"==this.questLogs[i].state){var o;e+=1,(o=new XL).addRequireAndReward(this.quests[t]),this.listView.add(o)}break}if(!1===n)if(this.quests[t].id==this.nextQuest.next_quest_id)(o=new TG).addRequireAndReward(this.quests[t],this.nextQuest),this.listView.add(o);else(o=new CG).addRequireAndReward(this.quests[t]),this.listView.add(o)}this.listView.tweenToItem(e)}},{key:"claimReward",value:function(e,t){this.destroy(),this.event.claimReward.dispatch(e,t)}},{key:"destroy",value:function(){for(this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&AG(n.prototype,i),o&&AG(n,o),t}();function NG(e){return(NG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jG(e,t){return!t||"object"!==NG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function UG(e){return(UG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FG(e,t){return(FG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ZG=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=jG(this,UG(t).call(this,game,e,n,null))).type=2,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),o.scrollScreenOnTab=null,o.signalInput=new Phaser.Signal,o.event={claimReward:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FG(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),TF.instance().addEventExtension(this.onExtensionResponse,this),Ur.instance().event.load_main_quest_complete.add(this.loadMainQuestComplete,this)}},{key:"loadMainQuestComplete",value:function(){this.handleQuestMain(),this.doneQuestLoadResponse()}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"addScrollScreen",value:function(){this.removeScrollScreen(),this.scrollScreenOnTab=new MG,this.scrollScreenOnTab.event.claimReward.add(this.claimReward,this),this.addChild(this.scrollScreenOnTab)}},{key:"removeScrollScreen",value:function(){null!==this.scrollScreenOnTab&&(game.world.remove(this.scrollScreenOnTab),this.scrollScreenOnTab.destroy(),this.scrollScreenOnTab=null)}},{key:"claimReward",value:function(e,t){this.quest=e,this.quest_log_id=t,this.destroy(),this.event.claimReward.dispatch(e,t)}},{key:"show",value:function(){qe.instance().showLoading(),this.checkQuestLoadRequest(),0==z.instance().isMainQuestLoad.checking?(TF.instance().sendData(Et.QUEST_CHECK_ACHIEVED_REQUEST,null),z.instance().isMainQuestLoad.updated=Date.now(),z.instance().isMainQuestLoad.checking=!0):(z.instance().mainQuestLists=Ur.instance().quests,z.instance().mainQuestLogLists=Ur.instance().quest_logs,TF.instance().sendData(Et.QUEST_CHECK_ACHIEVED_REQUEST,null)),game.add.tween(this).to({x:0},150,"Linear",!0)}},{key:"checkQuestLoadRequest",value:function(){1==z.instance().isMainQuestLoad.checking?Date.now()-z.instance().isMainQuestLoad.updated<6e3?z.instance().isMainQuestLoad.checking=!0:z.instance().isMainQuestLoad.checking=!1:z.instance().isMainQuestLoad.checking=!1}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){TF.instance().removeEventExtension(t.onExtensionResponse,t),t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300*window.GameConfig.RESIZE},150,"Linear",!0);i.start(),i.onComplete.add(function(){TF.instance().removeEventExtension(t.onExtensionResponse,t),t.destroy()},this)}}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.QUEST_CLAIM_REWARD_RESPONSE&&("OK"==e.params.getUtfString("status")?(this.scrollScreenOnTab.destroy(),this.scrollScreenOnTab=null):console.warn(e.params.getUtfString("message"))),e.cmd==Et.QUEST_LOAD_RESPONSE&&("OK"==e.params.getUtfString("status")||console.warn(e.params.getUtfString("message"))),e.cmd==Et.QUEST_CHECK_ACHIEVED_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleQuestLoadResponse(e.params):console.warn(e.params.getUtfString("message")))}},{key:"doneQuestLoadResponse",value:function(){this.addScrollScreen(),this.scrollScreenOnTab.setQuestsAndQuestLogs(z.instance().mainQuestLists,z.instance().mainQuestLogLists,z.instance().mainNextQuest),Le.instance().logEvent(Le.Quest_main),qe.instance().hideLoading()}},{key:"handleQuestLoadResponse",value:function(e,t){z.instance().mainQuestLists=[],z.instance().mainQuestLogLists=[],z.instance().mainNextQuest=null;var n=e.getSFSObject("next_quest");z.instance().mainNextQuest={next_quest_id:n.getInt("next_quest_id"),next_quest_archieved:n.getInt("next_quest_archieved")},1==Ur.instance().ktloadMainQuestComplete?this.loadMainQuestComplete():Ur.instance().sendGetMainQuest()}},{key:"handleQuestMain",value:function(){z.instance().mainQuestLists=Ur.instance().quests,z.instance().mainQuestLogLists=Ur.instance().quest_logs}},{key:"destroy",value:function(){for(TF.instance().removeEventExtension(this.onExtensionResponse,this),Ur.instance().event.load_main_quest_complete.remove(this.loadMainQuestComplete,this);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&BG(n.prototype,i),o&&BG(n,o),t}();function HG(e){return(HG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function VG(e,t){return!t||"object"!==HG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function WG(e){return(WG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qG(e,t){return(qG=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var KG=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=VG(this,WG(t).call(this,game))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),i.configs=e,i.index=n,i.event={claimReward:new Phaser.Signal},i.afterInit(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qG(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.medal,this.title,this.condition,this.tick,this.box,this.addMedal(this.positionQAndAConfig.achievement.medal),this.addTitle(this.positionQAndAConfig.achievement.title),this.addCondition(this.positionQAndAConfig.achievement.condition),this.paddingTitleAndCondition(),1==this.configs.is_done?"INIT"==this.configs.achievement_log.state?this.addBoxClaim():this.addTick():this.addBox(),this.addLine(),this.checkIsDone()}},{key:"addMedal",value:function(e){this.medal=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.medal.scale.set(window.GameConfig.SCALE_MEDAL*window.GameConfig.RESIZE),this.loadMedal(this.configs.medal),this.addChild(this.medal)}},{key:"loadMedal",value:function(e){if(this.medalUrl=e,game.cache.checkImageKey(this.medalUrl))this.onLoadMedalComplete();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadComplete.add(this.onLoadMedalComplete,this),t.image(this.medalUrl,this.medalUrl),t.start()}}},{key:"onLoadMedalComplete",value:function(){var e=this;game.cache.checkImageKey(this.medalUrl)&&setTimeout(function(){try{game.cache.checkImageKey(e.medalUrl)&&e&&e.medal.loadTexture(e.medalUrl)}catch(e){}},50*this.index)}},{key:"addTitle",value:function(e){this.title=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,"".concat(this.configs.title," (").concat(this.configs.achieved,"/").concat(this.configs.required,")"),e.configs),this.addChild(this.title)}},{key:"addCondition",value:function(e){this.condition=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.configs.condition,e.configs),this.addChild(this.condition)}},{key:"paddingTitleAndCondition",value:function(){var e=this.title.height+this.condition.height;this.title.y=(164*window.GameConfig.RESIZE-e)/2-5*window.GameConfig.RESIZE,this.condition.y=(164*window.GameConfig.RESIZE-e)/2+this.title.height+5*window.GameConfig.RESIZE}},{key:"addTick",value:function(){var e=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.tick.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.tick.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.tick.nameAtlas,this.positionQAndAConfig.achievement.tick.nameSprite);e.anchor.set(.5),this.addChild(e)}},{key:"addBox",value:function(){this.box=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.box.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box.nameAtlas,this.positionQAndAConfig.achievement.box.nameSprite),this.box.anchor.set(.5),this.box.alpha=.5,this.addIconAndTxtReward(),this.addChild(this.box)}},{key:"addIconAndTxtReward",value:function(){var e=this.addIcon(),t=this.addReward(),n=e.width+t.width;t.x=(this.box.width-n)/2-5*window.GameConfig.RESIZE-this.box.width/2,e.x=(this.box.width-n)/2+t.width+5*window.GameConfig.RESIZE-this.box.width/2,this.box.addChild(e),this.box.addChild(t)}},{key:"addIcon",value:function(){var e;return"DIAMOND"==this.configs.reward_type?e="Gem":"TICKET"==this.configs.reward_type?e="Ticket-tiny":"SUPPORT_ITEM"==this.configs.reward_type&&(e="Mic_tiny"),new Phaser.Sprite(game,0,-8*window.GameConfig.RESIZE,"defaultSource",e)}},{key:"addReward",value:function(){return new Phaser.Text(game,0,-8*window.GameConfig.RESIZE,this.configs.reward,{font:"GilroyBold",fill:"#ffffff",fontSize:18})}},{key:"addBoxClaim",value:function(){this.box=new Phaser.Sprite(game,this.positionQAndAConfig.achievement.box_claim.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box_claim.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box_claim.nameAtlas,this.positionQAndAConfig.achievement.box_claim.nameSprite),this.box.anchor.set(.5),this.box.inputEnabled=!0,this.box.events.onInputUp.add(this.onClaimReward,this),this.addIconAndTxtBoxClaim(),this.addChild(this.box)}},{key:"addIconAndTxtBoxClaim",value:function(){var e=new Phaser.Text(game,this.positionQAndAConfig.achievement.box_claim.txt.x*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box_claim.txt.y*window.GameConfig.RESIZE,this.positionQAndAConfig.achievement.box_claim.txt.text,this.positionQAndAConfig.achievement.box_claim.txt.configs);e.anchor.set(.5),this.box.addChild(e);var t=this.addIcon();t.y=14*window.GameConfig.RESIZE;var n=this.addReward();n.y=14*window.GameConfig.RESIZE;var i=t.width+n.width;n.x=(this.box.width-i)/2-5*window.GameConfig.RESIZE-this.box.width/2,t.x=(this.box.width-i)/2+n.width+5*window.GameConfig.RESIZE-this.box.width/2,this.box.addChild(t),this.box.addChild(n)}},{key:"onClaimReward",value:function(){this.box.inputEnabled=!1,ce.instance().playSound(ce.buttonclick),this.event.claimReward.dispatch(this.configs)}},{key:"addLine",value:function(){var e=new Phaser.Sprite(game,35*window.GameConfig.RESIZE,162*window.GameConfig.RESIZE,"defaultSource","Line");this.addChild(e)}},{key:"checkIsDone",value:function(){1==this.configs.is_done?this.alpha=1:this.alpha=.4}},{key:"height",get:function(){return 164*window.GameConfig.RESIZE}}])&&QG(n.prototype,i),o&&QG(n,o),t}();function zG(e){return(zG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YG(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function JG(e,t){return!t||"object"!==zG(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XG(e){return(XG=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $G(e,t){return($G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var eD=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=JG(this,XG(t).call(this,game))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.event={claimReward:new Phaser.Signal},e.listScroll,e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$G(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.sendLoadAchievementRequest(),this.addEventExtension()}},{key:"addListScroll",value:function(){var e=new Phaser.Group(game);e.x=0,e.y=95*window.GameConfig.RESIZE,this.addChild(e);var t=new Phaser.Rectangle(0,10,640*window.GameConfig.RESIZE,(game.height-286)*window.GameConfig.RESIZE);this.listView=new Vo(game,e,t,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var n=0;n<z.instance().achievements.length;n++){var i=new KG(z.instance().achievements[n],n);i.event.claimReward.add(this.claimReward,this),this.listView.add(i)}}},{key:"claimReward",value:function(e){this.listView.destroy(),this.destroy(),this.event.claimReward.dispatch(e)}},{key:"sendLoadAchievementRequest",value:function(){qe.instance().showLoading(),this.checkAchievementLoadRequest(),0==z.instance().isAchievementLoad.checking?(TF.instance().sendData(Et.ACHIEVEMENT_LOAD_REQUEST,null),z.instance().isAchievementLoad.checking=!0,z.instance().isAchievementLoad.updated=Date.now()):this.doneAchievementResponse()}},{key:"checkAchievementLoadRequest",value:function(){1==z.instance().isAchievementLoad.checking?Date.now()-z.instance().isAchievementLoad.updated<6e3?z.instance().isAchievementLoad.checking=!0:z.instance().isAchievementLoad.checking=!1:z.instance().isAchievementLoad.checking=!1}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.ACHIEVEMENT_LOAD_RESPONSE&&("OK"==e.params.getUtfString("status")?this.handleAchievementResponse(e.params,function(){t.sortAchievement(function(){t.doneAchievementResponse()})}):console.warn(e.params.getUtfString("message")))}},{key:"sortAchievement",value:function(e){console.log("GDJFHJKSHFSD"),console.log(z.instance().achievements),z.instance().achievements.sort(function(e){return"INIT"==e.achievement_log.state?-1:0}),e()}},{key:"doneAchievementResponse",value:function(){this.addListScroll(),qe.instance().hideLoading()}},{key:"handleAchievementResponse",value:function(e,t){z.instance().achievements=[];for(var n=[],i=e.getSFSArray("achievements"),o=0;o<i.size();o++){var a=i.getSFSObject(o),s=a.getInt("reward"),r=a.getUtfString("condition"),l=a.getInt("achievement_type_id"),h=!1;a.containsKey("achievement_log")&&(h=!0);var c={user_id:0,achievement_id:0,created:0,id:0,state:"UNKNOWN",updated:0};if(1==h){var u=a.getSFSObject("achievement_log");c.user_id=u.getInt("user_id"),c.achievement_id=u.getInt("achievement_id"),c.created=u.getLong("created"),c.id=u.getLong("id"),c.state=u.getUtfString("state"),c.updated=u.getLong("updated")}var d=a.getUtfString("reward_type"),f=a.getUtfString("medal"),p=a.getInt("achieved"),g=a.getInt("id"),y=a.getUtfString("title"),m=a.getInt("required");n.push({reward:s,condition:r,achievement_type_id:l,is_done:h,reward_type:d,medal:f,achieved:p,id:g,title:y,required:m,achievement_log:c})}z.instance().achievements=n,t()}},{key:"destroy",value:function(){for(this.removeEventExtension(),this.listView.removeAll(),this.listView.destroy();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this),this.listView.destroy()}}])&&YG(n.prototype,i),o&&YG(n,o),t}();function tD(e){return(tD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iD(e,t){return!t||"object"!==tD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oD(e){return(oD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aD(e,t){return(aD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sD=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=iD(this,oD(t).call(this,game,e,n,null))).type=3,i&&(o.typeBefore=i),o.type>o.typeBefore?o.x=game.width:o.x=-game.width,o.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),o.scrollScreenOnTab=null,o.signalInput=new Phaser.Signal,o.event={claimReward:new Phaser.Signal},o.afterInit(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addScrollScreen()}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"addScrollScreen",value:function(){this.scrollScreenOnTab=new eD,this.scrollScreenOnTab.event.claimReward.add(this.claimReward,this),this.addChild(this.scrollScreenOnTab),Le.instance().logEvent(Le.Quest_Achievement)}},{key:"claimReward",value:function(e){this.event.claimReward.dispatch(e)}},{key:"show",value:function(){game.add.tween(this).to({x:0},150,"Linear",!0)}},{key:"hide",value:function(e){var t=this;if(this.type>e){var n=game.add.tween(this).to({x:game.width},150,"Linear",!0);n.start(),n.onComplete.add(function(){t.destroy()},this)}else{var i=game.add.tween(this).to({x:-game.width-300*window.GameConfig.RESIZE},150,"Linear",!0);i.start(),i.onComplete.add(function(){t.destroy()},this)}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&nD(n.prototype,i),o&&nD(n,o),t}();function rD(e){return(rD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function hD(e,t){return!t||"object"!==rD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cD(e){return(cD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uD(e,t){return(uD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dD=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=hD(this,cD(t).call(this,game,0,175*window.GameConfig.RESIZE,null))).positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),e.tabDaily,e.tabMain,e.tabAchievement,e.lineDoc,e.event={claimReward:new Phaser.Signal,claimRewardQuest:new Phaser.Signal},e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.typeNew,this.typeOld,this.mainQuests,this.mainQuestLogs,this.mainNextQuest,this.addBtnNavBar(),this.addLineDoc(this.positionQAndAConfig.tabUnderHeader.line_doc)}},{key:"addBtnNavBar",value:function(){this.addDailyBtn(),this.addActiveDailyBtn(),this.addMainBtn(),this.addActiveMainBtn(),this.addAchievementBtn(),this.addActiveAchievementBtn(),this.buildBtnArray()}},{key:"setMainQuestsAndQuestLogs",value:function(e,t,n){this.mainQuests=e,this.mainQuestLogs=t,this.mainNextQuest=n}},{key:"addDailyBtn",value:function(){this.dailyBtn=new Phaser.Button(game,0,0,"questAndAchieveSprites",this.onClickDailyBtn,this,null,"Tab_Menu"),this.addIcon(this.dailyBtn,this.positionQAndAConfig.tabUnderHeader.daily.disactive.icon),this.addTxt(this.dailyBtn,this.positionQAndAConfig.tabUnderHeader.daily.disactive.txt),this.addChild(this.dailyBtn)}},{key:"onClickDailyBtn",value:function(){Le.instance().logEvent(Le.Quest_Daily_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.dailyBtn,this.dailyActiveBtn),this.typeNew=1,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=1}},{key:"addActiveDailyBtn",value:function(){this.dailyActiveBtn=new Phaser.Button(game,0,0,"questAndAchieveSprites",function(){},this,null,"Tab_Menu"),this.addIcon(this.dailyActiveBtn,this.positionQAndAConfig.tabUnderHeader.daily.active.icon),this.addTxt(this.dailyActiveBtn,this.positionQAndAConfig.tabUnderHeader.daily.active.txt),this.addLineUnder(this.dailyActiveBtn,this.positionQAndAConfig.tabUnderHeader.daily.active.line),this.addChild(this.dailyActiveBtn)}},{key:"addMainBtn",value:function(){this.mainBtn=new Phaser.Button(game,215*window.GameConfig.RESIZE,0,"questAndAchieveSprites",this.onClickMainBtn,this,null,"Tab_Menu"),this.addIcon(this.mainBtn,this.positionQAndAConfig.tabUnderHeader.main.disactive.icon),this.addTxt(this.mainBtn,this.positionQAndAConfig.tabUnderHeader.main.disactive.txt),this.addChild(this.mainBtn)}},{key:"onClickMainBtn",value:function(){Le.instance().logEvent(Le.Quest_main_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.mainBtn,this.mainActiveBtn),this.typeNew=2,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=2}},{key:"addActiveMainBtn",value:function(){this.mainActiveBtn=new Phaser.Button(game,215*window.GameConfig.RESIZE,0,"questAndAchieveSprites",function(){},this,null,"Tab_Menu"),this.addIcon(this.mainActiveBtn,this.positionQAndAConfig.tabUnderHeader.main.active.icon),this.addTxt(this.mainActiveBtn,this.positionQAndAConfig.tabUnderHeader.main.active.txt),this.addLineUnder(this.mainActiveBtn,this.positionQAndAConfig.tabUnderHeader.main.active.line),this.addChild(this.mainActiveBtn)}},{key:"addAchievementBtn",value:function(){this.achievementBtn=new Phaser.Button(game,427*window.GameConfig.RESIZE,0,"questAndAchieveSprites",this.onClickAchievementBtn,this,null,"Tab_Menu"),this.addIcon(this.achievementBtn,this.positionQAndAConfig.tabUnderHeader.achievement.disactive.icon),this.addTxt(this.achievementBtn,this.positionQAndAConfig.tabUnderHeader.achievement.disactive.txt),this.addChild(this.achievementBtn)}},{key:"onClickAchievementBtn",value:function(){Le.instance().logEvent(Le.Quest_Achievement_button),ce.instance().playSound(ce.buttonclick),Bn.switchButton(this.btnArray,this.activeBtnArray,this.achievementBtn,this.achievementActiveBtn),this.typeNew=3,this.changeScreen(this.typeNew,this.typeOld),this.typeOld=3}},{key:"addActiveAchievementBtn",value:function(){this.achievementActiveBtn=new Phaser.Button(game,427*window.GameConfig.RESIZE,0,"questAndAchieveSprites",function(){},this,null,"Tab_Menu"),this.addIcon(this.achievementActiveBtn,this.positionQAndAConfig.tabUnderHeader.achievement.active.icon),this.addTxt(this.achievementActiveBtn,this.positionQAndAConfig.tabUnderHeader.achievement.active.txt),this.addLineUnder(this.achievementActiveBtn,this.positionQAndAConfig.tabUnderHeader.achievement.active.line),this.addChild(this.achievementActiveBtn)}},{key:"addIcon",value:function(e,t){var n=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);e.addChild(n)}},{key:"addTxt",value:function(e,t){var n=new Phaser.Text(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.text,t.configs);e.addChild(n)}},{key:"addLineUnder",value:function(e,t){var n=new Phaser.Sprite(game,t.x*window.GameConfig.RESIZE,t.y*window.GameConfig.RESIZE,t.nameAtlas,t.nameSprite);e.addChild(n)}},{key:"buildBtnArray",value:function(){this.activeBtnArray=[this.dailyActiveBtn,this.mainActiveBtn,this.achievementActiveBtn],this.btnArray=[this.dailyBtn,this.mainBtn,this.achievementBtn]}},{key:"changeScreen",value:function(e,t){1==e?(Bn.switchButton(this.btnArray,this.activeBtnArray,this.dailyBtn,this.dailyActiveBtn),this.tabDaily=new vG(0,0,t),this.addChild(this.tabDaily),this.tabDaily.show(),this.hideScreen(e,t),null==t&&(this.typeOld=e)):2==e?(Bn.switchButton(this.btnArray,this.activeBtnArray,this.mainBtn,this.mainActiveBtn),this.tabMain=new ZG(0,0,t),this.tabMain.addScrollScreen(this.mainQuests,this.mainQuestLogs,this.mainNextQuest),this.tabMain.event.claimReward.add(this.claimRewardQuest,this),this.addChild(this.tabMain),this.tabMain.show(),this.hideScreen(e,t),null==t&&(this.typeOld=e)):3==e&&(Bn.switchButton(this.btnArray,this.activeBtnArray,this.achievementBtn,this.achievementActiveBtn),this.tabAchievement=new sD(0,0,t),this.tabAchievement.event.claimReward.add(this.claimReward,this),this.addChild(this.tabAchievement),this.tabAchievement.show(),this.hideScreen(e,t),null==t&&(this.typeOld=e))}},{key:"claimRewardQuest",value:function(e,t){this.event.claimRewardQuest.dispatch(e,t)}},{key:"claimReward",value:function(e){this.event.claimReward.dispatch(e)}},{key:"hideScreen",value:function(e,t){1==t?this.tabDaily.hide(e):2==t?this.tabMain.hide(e):3==t&&this.tabAchievement.hide(e)}},{key:"addLineDoc",value:function(e){for(var t=1;t<3;t++){var n=new Phaser.Sprite(game,e.x*t*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite);this.addChild(n)}}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}}])&&lD(n.prototype,i),o&&lD(n,o),t}();function fD(e){return(fD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function gD(e,t){return!t||"object"!==fD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yD(e){return(yD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mD(e,t){return(mD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vD=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=gD(this,yD(t).call(this,game,0,0,"bg-playlist"))).type=e,n.header,n.tabsUnderHeader,n.scrollGroup,n.quests=[],n.questLogs=[],n.nextQuest,n.achievementClaim,n.typeClaim=0,n.signalBack=new Phaser.Signal,n.arrResource=[{type:"text",link:"img/config/questAndAchieveConfig.json",key:"positionQAndAConfig"}],n.loadResource(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mD(e,t)}(t,Mp),n=t,(i=[{key:"onLoadFileComplete",value:function(){this.positionQAndAConfig=JSON.parse(game.cache.getText("positionQAndAConfig")),this.afterInit(),this.setQuestAndQuestLogs()}},{key:"afterInit",value:function(){this.addEventExtension(),this.addHeaderTab(this.positionQAndAConfig.header),this.addHeaderResources(this.positionQAndAConfig.header),qe.instance().hideLoading(),li.instance().showBanerQuestScreen()}},{key:"addHeaderResources",value:function(e){this.headerResource=new Phaser.Sprite(game,e.tab_chonplaylist.x*window.GameConfig.RESIZE,e.tab_chonplaylist.y*window.GameConfig.RESIZE,e.tab_chonplaylist.nameAtlas,e.tab_chonplaylist.nameSprite),this.addChild(this.headerResource),this.txtQuest,this.btnBack,this.addTxtQuest(this.positionQAndAConfig.header.txt_quest),this.addButtonBack(e.btn_back),this.txtGem,this.txtTicket,this.txtMic,this.tabGemHeader,this.tabTicketHeader,this.tabMicHeader,this.addTabGemHeader(this.positionQAndAConfig.header),this.addTabTicketHeader(this.positionQAndAConfig.header),this.addTabMicHeader(this.positionQAndAConfig.header)}},{key:"addTabGemHeader",value:function(e){this.tabGemHeader=new Phaser.Sprite(game,e.tabGem.x*window.GameConfig.RESIZE,e.tabGem.y*window.GameConfig.RESIZE,e.tabGem.nameAtlas,e.tabGem.nameSprite);var t=this.addGem(this.positionQAndAConfig.header.gem);this.txtGem=this.addTxtGem(this.positionQAndAConfig.header.txtResource);var n=t.width+this.txtGem.width;this.txtGem.x=(this.tabGemHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabGemHeader.width-n)/2+this.txtGem.width+5*window.GameConfig.RESIZE,this.tabGemHeader.addChild(t),this.tabGemHeader.addChild(this.txtGem),this.headerResource.addChild(this.tabGemHeader)}},{key:"addGem",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtGem",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("diamond").value,e.configs)}},{key:"addTabTicketHeader",value:function(e){this.tabTicketHeader=new Phaser.Sprite(game,e.tabTicket.x*window.GameConfig.RESIZE,e.tabTicket.y*window.GameConfig.RESIZE,e.tabTicket.nameAtlas,e.tabTicket.nameSprite);var t=this.addTicket(this.positionQAndAConfig.header.ticket);this.txtTicket=this.addTxtTicket(this.positionQAndAConfig.header.txtResource);var n=t.width+this.txtTicket.width;this.txtTicket.x=(this.tabTicketHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabTicketHeader.width-n)/2+this.txtTicket.width+5*window.GameConfig.RESIZE,this.tabTicketHeader.addChild(t),this.tabTicketHeader.addChild(this.txtTicket),this.headerResource.addChild(this.tabTicketHeader)}},{key:"addTicket",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtTicket",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("ticket").value,e.configs)}},{key:"addTabMicHeader",value:function(e){this.tabMicHeader=new Phaser.Sprite(game,e.tabMic.x*window.GameConfig.RESIZE,e.tabMic.y*window.GameConfig.RESIZE,e.tabMic.nameAtlas,e.tabMic.nameSprite);var t=this.addMic(this.positionQAndAConfig.header.micro);this.txtMic=this.addTxtMic(this.positionQAndAConfig.header.txtResource);var n=t.width+this.txtMic.width;this.txtMic.x=(this.tabMicHeader.width-n)/2-5*window.GameConfig.RESIZE,t.x=(this.tabMicHeader.width-n)/2+this.txtMic.width+5*window.GameConfig.RESIZE,this.tabMicHeader.addChild(t),this.tabMicHeader.addChild(this.txtMic),this.headerResource.addChild(this.tabMicHeader)}},{key:"addMic",value:function(e){return new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite)}},{key:"addTxtMic",value:function(e){return new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,TF.instance().socket.mySelf.getVariable("support_item").value,e.configs)}},{key:"addHeaderTab",value:function(e){this.headerTab=new Phaser.Sprite(game,e.tab_quest.x*window.GameConfig.RESIZE,e.tab_quest.y*window.GameConfig.RESIZE,e.tab_quest.nameAtlas,e.tab_quest.nameSprite),this.addChild(this.headerTab)}},{key:"addButtonBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.headerResource.addChild(this.btnBack)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),this.removeAllChild(),rF.instance().changeScreen(Ce.MAIN_MENU),this.destroy()}},{key:"setQuestAndQuestLogs",value:function(){this.addTabsUnderHeader(this.type)}},{key:"addTxtQuest",value:function(e){this.txtQuest=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.text,e.configs),this.txtQuest.anchor.set(.5,0),this.headerTab.addChild(this.txtQuest)}},{key:"addTabsUnderHeader",value:function(e){this.tabsUnderHeader=new dD,this.tabsUnderHeader.changeScreen(e),this.tabsUnderHeader.event.claimReward.add(this.claimReward,this),this.tabsUnderHeader.event.claimRewardQuest.add(this.claimRewardQuest,this),this.addChild(this.tabsUnderHeader),z.instance().playScript.playing_guide==en.DONE_TURNBASE&&(this.playScript=new en,this.playScript.removeAllTut(),this.playScript.addStep6BtnReceiveInQAndA(),this.playScript.onSkipPS(),this.addChild(this.playScript))}},{key:"claimRewardQuest",value:function(e,t){this.questClaim=e,this.questClaimId=t,this.sendRequestClaimQuest()}},{key:"claimReward",value:function(e){this.achievementClaim=e,this.sendRequestClaimAchievement()}},{key:"updateVariableResource",value:function(e){var t=this;if("DIAMOND"==e.reward_type){this.txtGem.setText(TF.instance().socket.mySelf.getVariable("diamond").value-e.reward);var n=game.add.tween(this.txtGem).to({text:TF.instance().socket.mySelf.getVariable("diamond").value},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){t.txtGem.text=parseInt(t.txtGem.text)},this),n.onComplete.add(function(){t.checkAds()},this)}else if("TICKET"==e.reward_type){this.txtTicket.setText(TF.instance().socket.mySelf.getVariable("ticket").value-e.reward);var i=game.add.tween(this.txtTicket).to({text:TF.instance().socket.mySelf.getVariable("ticket").value},300,"Linear",!1);i.start(),i.onUpdateCallback(function(){t.txtTicket.text=parseInt(t.txtTicket.text)},this),i.onComplete.add(function(){t.checkAds()},this)}else if("SUPPORT_ITEM"==e.reward_type){this.txtMic.setText(TF.instance().socket.mySelf.getVariable("support_item").value-e.reward);var o=game.add.tween(this.txtMic).to({text:TF.instance().socket.mySelf.getVariable("support_item").value},300,"Linear",!1);o.start(),o.onUpdateCallback(function(){t.txtMic.text=parseInt(t.txtMic.text)},this),o.onComplete.add(function(){t.checkAds()},this)}}},{key:"checkAds",value:function(){z.instance().playScript.playing_guide==en.DONE_ALL&&(1==this.typeClaim?(li.instance().questTakeReward(),li.instance().showInterstitialQuestTakereward()):2==this.typeClaim&&(li.instance().achievementTakeReward(),li.instance().showInterstitialachievementTakeReward()))}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.add(this.onBack,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this),De.instance().event.backButton.remove(this.onBack,this)}},{key:"onExtensionResponse",value:function(e){var t=this;e.cmd==Et.ACHIEVEMENT_CLAIM_REWARD_RESPONSE&&"OK"==e.params.getUtfString("status")&&(this.typeClaim=2,this.tabsUnderHeader.changeScreen(3),IE.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:this.achievementClaim.reward_type,reward:this.achievementClaim.reward}),this.timeUpdateAchievement=game.time.events.add(2*Phaser.Timer.SECOND,function(){t.updateVariableResource(t.achievementClaim)},this)),e.cmd==Et.QUEST_CLAIM_REWARD_RESPONSE&&"OK"==e.params.getUtfString("status")&&(this.typeClaim=1,this.tabsUnderHeader.changeScreen(2),IE.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,{type:this.questClaim.reward_type,reward:this.questClaim.reward}),this.timeUpdateQuest=game.time.events.add(2*Phaser.Timer.SECOND,function(){t.updateVariableResource(t.questClaim)},this),this.timeUpdatePlayScript=game.time.events.add(3.2*Phaser.Timer.SECOND,function(){z.instance().playScript.playing_guide==en.DONE_TURNBASE&&TF.instance().sendData(Et.PLAY_SCRIPT_DONE_GET_QUEST_REQUEST,null)}),Bn.changeQuestLogsOnClaim(this.questClaimId,Ur.instance().quest_logs),this.questClaimId=null,TF.instance().sendData(Et.QUEST_CHECK_ACHIEVED_REQUEST,null)),e.cmd==Et.PLAY_SCRIPT_DONE_GET_QUEST_RESPONSE&&"OK"==e.params.getUtfString("status")&&(this.playScript=new en,this.playScript.addStep7CloseQAndA(),this.playScript.event.step7.add(this.cancleQuestTut,this),this.addChild(this.playScript)),e.cmd==Et.PLAY_SCRIPT_DONE_ALL_RESPONSE&&"OK"==e.params.getUtfString("status")&&(z.instance().playScript.playing_guide=en.DONE_ALL,this.playScript.destroy())}},{key:"cancleQuestTut",value:function(){ce.instance().playSound(ce.buttonclick),this.removeAllChild(),rF.instance().changeScreen(Ce.MAIN_MENU),this.destroy()}},{key:"sendRequestClaimQuest",value:function(){LogConsole.log(this.questClaim);var e=new SFS2X.SFSObject;e.putLong("quest_log_id",this.questClaimId),TF.instance().sendData(Et.QUEST_CLAIM_REWARD_REQUEST,e)}},{key:"sendRequestClaimAchievement",value:function(){LogConsole.log(this.achievementClaim);var e=new SFS2X.SFSObject;e.putLong("achievement_log_id",this.achievementClaim.achievement_log.id),TF.instance().sendData(Et.ACHIEVEMENT_CLAIM_REWARD_REQUEST,e)}},{key:"removeAllChild",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}}},{key:"destroy",value:function(){for(this.removeEventExtension(),li.instance().hideBanner(),game.time.events.remove(this.timeUpdateAchievement),game.time.events.remove(this.timeUpdateQuest),game.time.events.remove(this.timeUpdatePlayScript);this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&pD(n.prototype,i),o&&pD(n,o),t}(),wD="Bạn được tặng 6 Playlist Mới",bD="Hãy chọn",_D="thể loại nhạc mà bạn yêu thích";function SD(e){return(SD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ED(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function CD(e,t){return!t||"object"!==SD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kD(e){return(kD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PD(e,t){return(PD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var OD=function(e){function t(e,n,i,o,a,s){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=CD(this,kD(t).call(this,game,0,n,i.nameAtlas,i.nameSprite))).configs=o,r.childrenGenre=a,r.index=s,r.posX=e,r.posY=n,r.choosed=o.choosed,0==r.index?r.x=-296*window.GameConfig.RESIZE:r.index%2==1?r.x=936*window.GameConfig.RESIZE:r.x=-296*window.GameConfig.RESIZE,r.signalInput=new Phaser.Signal,r.afterInit(),r}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.inputEnabled=!0,this.events.onInputUp.add(this.onClickSprite,this),this.addTicked(),this.makeTweenGenre()}},{key:"makeTweenGenre",value:function(){var e=game.add.tween(this).to({x:this.posX},500,Phaser.Easing.Back.Out,!1);setTimeout(function(){e.start()},100*this.index)}},{key:"onClickSprite",value:function(){ce.instance().playSound(ce.buttonclick),this.childrenGenre.length>0?this.signalInput.dispatch({cmd:"HAS_CHILD",childrenGenre:this.childrenGenre,nameParent:this.configs.genre}):1==this.choosed?(this.destroyTicked(),this.signalInput.dispatch({cmd:"DISCHOOSED",id:this.configs.id}),this.choosed=!1):0==this.choosed&&(this.showTicked(),this.signalInput.dispatch({cmd:"CHOOSED",id:this.configs.id}),this.choosed=!0)}},{key:"addTicked",value:function(){this.tick=new Phaser.Sprite(game,223*window.GameConfig.RESIZE,103*window.GameConfig.RESIZE,"isNewUserSprites","Button_Active"),this.frameAcitve=new Phaser.Sprite(game,0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,"isNewUserSprites","Khung_Active"),1==this.choosed||(this.frameAcitve.kill(),this.tick.kill()),this.addChild(this.frameAcitve),this.addChild(this.tick)}},{key:"destroyTicked",value:function(){this.frameAcitve.kill(),this.tick.kill()}},{key:"showTicked",value:function(){this.frameAcitve.revive(),this.tick.revive()}},{key:"addEventInput",value:function(e,t){this.signalInput.add(e,t)}},{key:"removeEventInput",value:function(e,t){this.signalInput.remove(e,t)}}])&&ED(n.prototype,i),o&&ED(n,o),t}();function RD(e){return(RD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function TD(e,t){return!t||"object"!==RD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ID(e){return(ID=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function AD(e,t){return(AD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var LD=function(e){function t(e,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),TD(this,ID(t).call(this,game,e,n,null))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&AD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"add",value:function(e){this.addChild(e)}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&xD(n.prototype,i),o&&xD(n,o),t}();function GD(e){return(GD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function MD(e,t){return!t||"object"!==GD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ND(e){return(ND=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function BD(e,t){return(BD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var jD=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=MD(this,ND(t).call(this,game,0,249*window.GameConfig.RESIZE,null))).arrGenres=e,n.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),n.afterInit(),n.signalEvent=new Phaser.Signal,n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&BD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.listViewMain,this.chooseChildrenGenre,this.fatherParentGenres=this.arrGenres.filter(function(e){return 0==e.parent}),this.addParentGenres()}},{key:"addParentGenres",value:function(){var e=this,t=new LD(0,0),n=new Phaser.Group(game,this);n.x=0,n.y=0,this.addChild(n);var i=new Phaser.Rectangle(35*window.GameConfig.RESIZE,0,570*window.GameConfig.RESIZE,(game.height-141)*window.GameConfig.RESIZE);this.listViewMain=new Vo(game,n,i,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var o=0,a=0,s=function(n){n%2==0&&n>0?(o=0,a+=window.GameConfig.CONFIGS_GENRE.y*window.GameConfig.RESIZE,t.height+=window.GameConfig.CONFIGS_GENRE.y*window.GameConfig.RESIZE):0==n?o=0:o+=window.GameConfig.CONFIGS_GENRE.x*window.GameConfig.RESIZE;var i=e.arrGenres.filter(function(t){return t.parent==e.fatherParentGenres[n].id}),s=new OD(o,a,e.positionIsNewUserConfig.chooseMain.genres[e.fatherParentGenres[n].code],e.fatherParentGenres[n],i,n);s.addEventInput(e.onClickGenreSprite,e),t.add(s)},r=0;r<this.fatherParentGenres.length;r++)s(r);this.listViewMain.add(t)}},{key:"onClickGenreSprite",value:function(e){"CHOOSED"==e.cmd?this.signalEvent.dispatch({cmd:"CHOOSED",id:e.id}):"HAS_CHILD"==e.cmd?(this.kill(),this.signalEvent.dispatch({cmd:"HAS_CHILD",childrenGenre:e.childrenGenre,nameParent:e.nameParent})):"DISCHOOSED"==e.cmd&&this.signalEvent.dispatch({cmd:"DISCHOOSED",id:e.id})}},{key:"addEvent",value:function(e,t){this.signalEvent.add(e,t)}},{key:"removeEvent",value:function(e,t){this.signalEvent.remove(e,t)}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}}])&&DD(n.prototype,i),o&&DD(n,o),t}();function UD(e){return(UD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ZD(e,t){return!t||"object"!==UD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HD(e){return(HD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QD(e,t){return(QD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var VD=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=ZD(this,HD(t).call(this,game))).arrGenres=e,i.genreParent=n,i.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),i.afterInit(),i.signalEvent=new Phaser.Signal,i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QD(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.listView,this.btnBack,this.txtParentGenre,this.addBtnBack(this.positionIsNewUserConfig.chooseUS_UK.btn_back),this.addTxtParentGenre(this.positionIsNewUserConfig.chooseUS_UK.txt_parent),this.addGenres()}},{key:"addBtnBack",value:function(e){this.btnBack=new Phaser.Sprite(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,e.nameAtlas,e.nameSprite),this.btnBack.anchor.set(.5),this.btnBack.inputEnabled=!0,this.btnBack.events.onInputUp.add(this.onBack,this),this.addChild(this.btnBack)}},{key:"onBack",value:function(){ce.instance().playSound(ce.buttonclick),this.signalEvent.dispatch({type:"BACK"}),this.destroy()}},{key:"addTxtParentGenre",value:function(e){this.txtParentGenre=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.genreParent,e.configs),this.txtParentGenre.anchor.set(.5,0),this.addChild(this.txtParentGenre)}},{key:"addGenres",value:function(){var e=this,t=new LD(0,0),n=new Phaser.Group(game,this);n.x=0,n.y=0,this.addChild(n);var i=new Phaser.Rectangle(35*window.GameConfig.RESIZE,248*window.GameConfig.RESIZE,570*window.GameConfig.RESIZE,(game.height-141)*window.GameConfig.RESIZE);this.listView=new Vo(game,n,i,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var o=0,a=0,s=function(n){n%2==0&&n>0?(o=0,a+=window.GameConfig.CONFIGS_GENRE.y*window.GameConfig.RESIZE,t.height+=window.GameConfig.CONFIGS_GENRE.y*window.GameConfig.RESIZE):0==n?o=0:o+=window.GameConfig.CONFIGS_GENRE.x*window.GameConfig.RESIZE;var i=e.arrGenres.filter(function(t){return t.parent==e.arrGenres[n].id}),s=new OD(o,a,e.positionIsNewUserConfig.chooseUS_UK.genres[e.arrGenres[n].code],e.arrGenres[n],i,n);s.addEventInput(e.onClickGenreSprite,e),t.add(s)},r=0;r<this.arrGenres.length;r++)s(r);this.listView.add(t)}},{key:"onClickGenreSprite",value:function(e){"CHOOSED"==e.cmd?this.signalEvent.dispatch({cmd:"CHOOSED",id:e.id}):"HAS_CHILD"==e.cmd?(this.kill(),this.signalEvent.dispatch({cmd:"HAS_CHILD",childrenGenre:e.childrenGenre,nameParent:e.nameParent})):"DISCHOOSED"==e.cmd&&this.signalEvent.dispatch({cmd:"DISCHOOSED",id:e.id})}},{key:"addEvent",value:function(e,t){this.signalEvent.add(e,t)}},{key:"removeEvent",value:function(e,t){this.signalEvent.remove(e,t)}}])&&FD(n.prototype,i),o&&FD(n,o),t}();var WD=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.thumb="",this.name=""};function qD(e){return(qD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KD(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function zD(e,t){return!t||"object"!==qD(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function YD(e){return(YD=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function JD(e,t){return(JD=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var XD=function(e){function t(e,n,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(a=zD(this,YD(t).call(this,game,e,n,null))).positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),a.indexSprite=o,a.genre=new WD,a.genre=Object.assign({},a.genre,i),a.thumb,a.name,a.afterInit(),a}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&JD(e,t)}(t,Phaser.Sprite),n=t,(i=[{key:"afterInit",value:function(){this.addThumb(),this.addName(this.positionIsNewUserConfig.received.txt_playlist)}},{key:"addThumb",value:function(){this.thumb=new Phaser.Sprite(game,0,0,"otherSprites","Nhactre"),this.thumb.scale.set(1*window.GameConfig.RESIZE);var e=new Phaser.Graphics(game,0,0);e.beginFill(16777215),e.drawRoundedRect(0*window.GameConfig.RESIZE,0*window.GameConfig.RESIZE,165*window.GameConfig.RESIZE,165*window.GameConfig.RESIZE,10),e.anchor.set(.5),this.thumb.addChild(e),this.thumb.mask=e,this.key,this.addChild(this.thumb),this.beginLoad(this.genre.thumb)}},{key:"beginLoad",value:function(e){if(e&&(this.key=e),game.cache.checkImageKey(this.key))this.onLoad();else{var t=new Phaser.Loader(game);t.crossOrigin="anonymous",t.onLoadComplete.add(this.onLoad,this),t.image(this.key,this.key),t.start()}}},{key:"onLoad",value:function(){var e=this;setTimeout(function(){e.thumb.loadTexture(e.key)},100*this.indexSprite)}},{key:"addName",value:function(e){this.name=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,this.genre.name,e.configs),this.addChild(this.name)}}])&&KD(n.prototype,i),o&&KD(n,o),t}();function $D(e){return($D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function tM(e,t){return!t||"object"!==$D(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nM(e){return(nM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function iM(e,t){return(iM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oM=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=tM(this,nM(t).call(this,game))).positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),n.arrBeGiven=e,n.listView,n.btnReceive,n.afterInit(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iM(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addListView(),this.addBtnReceive(this.positionIsNewUserConfig.received.btn_receive)}},{key:"addListView",value:function(){var e=new LD(0,0),t=new Phaser.Group(game,this);t.x=0,t.y=0,this.addChild(t);var n=new Phaser.Rectangle(35*window.GameConfig.RESIZE,249*window.GameConfig.RESIZE,569*window.GameConfig.RESIZE,(game.height-324)*window.GameConfig.RESIZE);this.listView=new Vo(game,t,n,{direction:"y",overflow:100,padding:0,searchForClicks:!0});for(var i=0,o=0,a=0;a<this.arrBeGiven.length;a++){if(a%3==0&&a>0){i=0,o+=window.GameConfig.CONFIGS_PLAYLIST_RECEIVED.y*window.GameConfig.RESIZE,e.height+=window.GameConfig.CONFIGS_PLAYLIST_RECEIVED.y*window.GameConfig.RESIZE;var s=new Phaser.Sprite(game,0*window.GameConfig.RESIZE,(window.GameConfig.CONFIGS_PLAYLIST_RECEIVED.y-40)*window.GameConfig.RESIZE,"defaultSource","Line");e.addChild(s)}else 0==a?i=0:i+=window.GameConfig.CONFIGS_PLAYLIST_RECEIVED.x*window.GameConfig.RESIZE;var r=new XD(i,o,this.arrBeGiven[a],a);e.add(r)}this.listView.add(e)}},{key:"addBtnReceive",value:function(e){this.btn_receive=new Phaser.Sprite(game,e.btn.x*window.GameConfig.RESIZE,(game.height-z.instance().STANDARD_HEIGHT+e.btn.y)*window.GameConfig.RESIZE,e.btn.nameAtlas,e.btn.nameSprite),this.btn_receive.inputEnabled=!0,this.btn_receive.events.onInputUp.add(this.onClickReceived,this),this.txt_rececive,this.addTxtBtn(e),this.addChild(this.btn_receive)}},{key:"onClickReceived",value:function(){ce.instance().playSound(ce.buttonclick),this.destroy(),rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"addTxtBtn",value:function(e){this.txt_rececive=new Phaser.Text(game,this.btn_receive.width/2,this.btn_receive.height/2,e.txt_receive.text,e.txt_receive.configs),this.txt_rececive.anchor.set(.5),this.btn_receive.addChild(this.txt_rececive)}},{key:"destroy",value:function(){for(;this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&eM(n.prototype,i),o&&eM(n,o),t}();function aM(e){return(aM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function rM(e,t){return!t||"object"!==aM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lM(e){return(lM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hM(e,t){return(hM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var cM=function(e){function t(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=rM(this,lM(t).call(this,game))).state=e,i.positionBootConfig=n,i.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),i.countChoice=3,i.listChoicedFavorites=[],i.arrGenres=[],i.arrBeGiven=[],i.stateParams={waitingGames:[],doneGames:[],challengeGames:[]},i.chooseMain,i.chooseUS_UK,i.receivedList,i.addEventExtension(),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hM(e,t)}(t,Phaser.Group),n=t,(i=[{key:"preload",value:function(){this.addBackGround(this.positionIsNewUserConfig.chooseMain),this.addTextChoose(this.positionIsNewUserConfig.chooseMain.txt_choose),this.callNewUserGenresListRequest()}},{key:"addGroupFavoriteList",value:function(e){this.arrGenres=e,this.chooseMain=new jD(this.arrGenres),this.chooseMain.addEvent(this.onEventChoosePlaylist,this),this.addChild(this.chooseMain)}},{key:"onEventChoosePlaylist",value:function(e){if("CHOOSED"==e.cmd)Le.instance().logEvent(Le.Choose_genre_Buttons),this.listChoicedFavorites.push(e.id),this.countChoice--,this.txtChoose.setText("".concat(bD," ").concat(this.countChoice," ").concat(_D)),3==this.listChoicedFavorites.length&&(this.chooseMain.destroy(),this.sendUserSelectedGenres());else if("HAS_CHILD"==e.cmd){for(var t=0;t<e.childrenGenre.length;t++){e.childrenGenre[t].choosed=!1;for(var n=0;n<this.listChoicedFavorites.length;n++)if(this.listChoicedFavorites[n]==e.childrenGenre[t].id){e.childrenGenre[t].choosed=!0;break}}this.chooseUS_UK=new VD(e.childrenGenre,e.nameParent),this.chooseUS_UK.addEvent(this.onEventChildren,this),this.addChild(this.chooseUS_UK)}else"DISCHOOSED"==e.cmd&&(this.listChoicedFavorites=this.listChoicedFavorites.filter(function(t){return t!==e.id}),this.countChoice++,this.txtChoose.setText("".concat(bD," ").concat(this.countChoice," ").concat(_D)))}},{key:"onEventChildren",value:function(e){"BACK"==e.type&&this.chooseMain.revive(),"CHOOSED"==e.cmd?(this.listChoicedFavorites.push(e.id),this.countChoice--,this.txtChoose.setText("".concat(bD," ").concat(this.countChoice," ").concat(_D)),3==this.listChoicedFavorites.length&&(this.chooseUS_UK.destroy(),this.chooseMain.destroy(),this.sendUserSelectedGenres())):"HAS_CHILD"==e.cmd?(this.chooseUS_UK=new VD(e.childrenGenre,e.nameParent),this.chooseUS_UK.addEvent(this.onEventChildren,this),this.addChild(this.chooseUS_UK)):"DISCHOOSED"==e.cmd&&(this.listChoicedFavorites=this.listChoicedFavorites.filter(function(t){return t!==e.id}),LogConsole.log(this.listChoicedFavorites),this.countChoice++,this.txtChoose.setText("".concat(bD," ").concat(this.countChoice," ").concat(_D)))}},{key:"checkIfTabHasChild",value:function(e,t){var n=this.arrGenres.filter(function(t){return t.parent==e});t(n.length>0,n)}},{key:"onClickTextGenreBeFixedByDesign",value:function(){this.tabFavoriteChild.kill(),this.grapFavoriteList.revive()}},{key:"sendUserSelectedGenres",value:function(){var e=new SFS2X.SFSObject,t=new SFS2X.SFSArray;t.addInt(this.listChoicedFavorites[0]),t.addInt(this.listChoicedFavorites[1]),t.addInt(this.listChoicedFavorites[2]),e.putSFSArray("genreIds",t),TF.instance().sendData(Et.NEW_USER_SELECTED_GENRES_REQUEST,e),qe.instance().showLoading()}},{key:"callNewUserGenresListRequest",value:function(){this.handleParamsOnNewUserGenres()}},{key:"handleParamsOnSelectedPlaylist",value:function(e){var t=e.getSFSArray("response");if("OK"==e.getUtfString("status"))for(var n=0;n<t.size();n++){var i=t.getSFSObject(n),o=i.getUtfString("thumb"),a=i.getUtfString("name"),s=i.getInt("is_solo_mode"),r=i.getInt("id");this.arrBeGiven.push({thumb:o,name:a}),0==s&&Ur.instance().getNewPlaylist(r)}else console.warn("Response NEW_USER_SELECTED_GENRES_RESPONSE error: ".concat(e.getUtfString("message")))}},{key:"handleParamsOnNewUserGenres",value:function(){1==Ur.instance().ktLoadPlaylist?this.loadPlaylistComplete():Ur.instance().sendGetDataShop()}},{key:"addEventExtension",value:function(){Ur.instance().event.load_playlist_complete.add(this.loadPlaylistComplete,this)}},{key:"removeEventExtension",value:function(){Ur.instance().event.load_playlist_complete.remove(this.loadPlaylistComplete,this)}},{key:"loadPlaylistComplete",value:function(){this.arrGenres=Ur.instance().genres.getAll(),this.addGroupFavoriteList(this.arrGenres),qe.instance().hideLoading()}},{key:"ifHasChild",value:function(e,t){this.addTextGenreBeFixedByDesignAfter(t.id,t.valueFavorite),this.grapFavoriteList.kill(),this.addTabFavoriteChild(e)}},{key:"addBackGround",value:function(e){var t=game.add.sprite(e.bg.x*window.GameConfig.RESIZE,e.bg.y*window.GameConfig.RESIZE,e.bg.nameSprite),n=new Phaser.Sprite(game,e.line_top.x*window.GameConfig.RESIZE,e.line_top.y*window.GameConfig.RESIZE,e.line_top.nameAtlas,e.line_top.nameSprite);t.addChild(n),this.addChild(t)}},{key:"addTextChoose",value:function(e){this.txtChoose=new Phaser.Text(game,e.x*window.GameConfig.RESIZE,e.y*window.GameConfig.RESIZE,"".concat(e.userChooseGenresLeft," ").concat(this.countChoice," ").concat(e.userChooseGenresRight),e.configs),this.txtChoose.anchor.set(.5,0),this.addChild(this.txtChoose)}},{key:"createListPlaylistBeChoosed",value:function(){this.txtChoose.setText(wD),this.receivedList=new oM(this.arrBeGiven),this.addChild(this.receivedList)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&sM(n.prototype,i),o&&sM(n,o),t}();function uM(e){return(uM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fM(e,t){return!t||"object"!==uM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pM(e){return(pM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gM(e,t){return(gM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var yM=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=fM(this,pM(t).call(this,game))).positionBootConfig=JSON.parse(game.cache.getText("positionBootConfig")),e.positionIsNewUserConfig=JSON.parse(game.cache.getText("positionIsNewUserConfig")),e.afterInit(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gM(e,t)}(t,Phaser.Group),n=t,(i=[{key:"afterInit",value:function(){this.addEventExtension(),this.NewUserModule=new cM(this,this.positionBootConfig),this.NewUserModule.preload(),this.addChild(this.NewUserModule)}},{key:"onExtensionResponse",value:function(e){e.cmd==Et.NEW_USER_SELECTED_GENRES_RESPONSE&&(this.NewUserModule.handleParamsOnSelectedPlaylist(e.params),this.NewUserModule.createListPlaylistBeChoosed(),qe.instance().hideLoading())}},{key:"addEventExtension",value:function(){TF.instance().addEventExtension(this.onExtensionResponse,this)}},{key:"removeEventExtension",value:function(){TF.instance().removeEventExtension(this.onExtensionResponse,this)}},{key:"destroy",value:function(){for(this.removeEventExtension();this.children.length>0;){var e=this.children[0];this.removeChild(e),e.destroy(),e=null}this.parent&&this.parent.removeChild(this)}}])&&dM(n.prototype,i),o&&dM(n,o),t}();function mM(e){return(mM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wM(e){return(wM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bM(e,t){return(bM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var SM=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=wM(t).call(this,game,0,0,null))||"object"!==mM(i)&&"function"!=typeof i?_M(n):i).event={back:new Phaser.Signal,trophy:new Phaser.Signal},e.positionEventMode=e.mainData.positionEventMode,e.bg=new pt(e.positionEventMode.header_bg_queue),e.addChild(e.bg),e.iconTrophy=new pt(e.positionEventMode.header_icon_trophy,e.chooseTrophy,_M(_M(e))),e.addChild(e.iconTrophy);var o=new Phaser.Sprite(game,0,0,"btnRankAnim");return o.width=51,o.height=50,o.x=-12,o.y=-10,o.animations.add("run_rank"),o.animations.play("run_rank",26,!0),e.iconTrophy.addChild(o),e.btnBack=new pt(e.positionEventMode.header_buttom_back,e.chooseBack,_M(_M(e))),e.btnBack.width=50*z.instance().scale,e.btnBack.height=50*z.instance().scale,e.btnBack.x=10*z.instance().scale,e.btnBack.y=10*z.instance().scale,e.addChild(e.btnBack),e.txtTitle=new _t(e.positionEventMode.header_queue_text_title,""),e.txtTitle.setTextBounds(0,0,e.bg.width,e.bg.height),e.addChild(e.txtTitle),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bM(e,t)}(t,Mt),n=t,(i=[{key:"setTitle",value:function(e){this.txtTitle.text=e}},{key:"setHideBack",value:function(){this.btnBack.visible=!1}},{key:"setHideTrophy",value:function(){this.iconTrophy.visible=!1}},{key:"chooseTrophy",value:function(){LogConsole.log("chooseTrophy"),$r.instance().hide(),this.btnBack.inputEnabled=!1,this.event.trophy.dispatch()}},{key:"chooseBack",value:function(){LogConsole.log("chooseBack"),$r.instance().hide(),this.btnBack.inputEnabled=!1,this.event.back.dispatch()}}])&&vM(n.prototype,i),o&&vM(n,o),t}();function EM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var CM=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"EVENT_MODE_LOAD_LIST_REQUEST",get:function(){return"EVENT_MODE_LOAD_LIST_REQUEST"}},{key:"EVENT_MODE_LOAD_LIST_RESPONSE",get:function(){return"EVENT_MODE_LOAD_LIST_RESPONSE"}},{key:"EVENT_MODE_JOIN_REQUEST",get:function(){return"EVENT_MODE_JOIN_REQUEST"}},{key:"EVENT_MODE_JOIN_RESPONSE",get:function(){return"EVENT_MODE_JOIN_RESPONSE"}},{key:"EVENT_MODE_PLAY_GAME_REQUEST",get:function(){return"EVENT_MODE_PLAY_GAME_REQUEST"}},{key:"EVENT_MODE_PLAY_GAME_RESPONSE",get:function(){return"EVENT_MODE_PLAY_GAME_RESPONSE"}},{key:"EVENT_MODE_QUESTION_RESPONSE",get:function(){return"EVENT_MODE_QUESTION_RESPONSE"}},{key:"EVENT_MODE_USER_READY_REQUEST",get:function(){return"EVENT_MODE_USER_READY_REQUEST"}},{key:"EVENT_MODE_USER_READY_RESPONSE",get:function(){return"EVENT_MODE_USER_READY_RESPONSE"}},{key:"EVENT_MODE_START_GAME",get:function(){return"EVENT_MODE_START_GAME"}},{key:"EVENT_MODE_START_RESPONSE",get:function(){return"EVENT_MODE_START_RESPONSE"}},{key:"EVENT_MODE_USER_SELECTED_ANSWER_REQUEST",get:function(){return"EVENT_MODE_USER_SELECTED_ANSWER_REQUEST"}},{key:"EVENT_MODE_USER_SELECTED_ANSWER_RESPONSE",get:function(){return"EVENT_MODE_USER_SELECTED_ANSWER_RESPONSE"}},{key:"EVENT_MODE_MOVE_TO_NEXT_QUESTION",get:function(){return"EVENT_MODE_MOVE_TO_NEXT_QUESTION"}},{key:"EVENT_MODE_FINISH_GAME",get:function(){return"EVENT_MODE_FINISH_GAME"}},{key:"EVENT_MODE_DONE_GAME",get:function(){return"EVENT_MODE_DONE_GAME"}},{key:"EVENT_MODE_LOAD_DISPLAY_PLAYERS",get:function(){return"EVENT_MODE_LOAD_DISPLAY_PLAYERS"}},{key:"EVENT_MODE_RANKING_REQUEST",get:function(){return"EVENT_MODE_RANKING_REQUEST"}},{key:"EVENT_MODE_RANKING_RESPONSE",get:function(){return"EVENT_MODE_RANKING_RESPONSE"}},{key:"EVENT_MODE_REWARD_NOTIFICATION",get:function(){return"EVENT_MODE_REWARD_NOTIFICATION"}},{key:"EVENT_MODE_EVENT_ENDED",get:function(){return"EVENT_MODE_EVENT_ENDED"}},{key:"EVENT_MODE_CLAIM_REWARD_REQUEST",get:function(){return"EVENT_MODE_CLAIM_REWARD_REQUEST"}},{key:"EVENT_MODE_CLAIM_REWARD_RESPONSE",get:function(){return"EVENT_MODE_CLAIM_REWARD_RESPONSE"}},{key:"EVENT_MODE_EVENT_START_BROADCAST",get:function(){return"EVENT_MODE_EVENT_START_BROADCAST"}},{key:"EVENT_MODE_NEXT_QUESTION_REQUEST",get:function(){return"EVENT_MODE_NEXT_QUESTION_REQUEST"}},{key:"EVENT_MODE_HIGHEST_ACHIEVED",get:function(){return"EVENT_MODE_HIGHEST_ACHIEVED"}},{key:"EVENT_MODE_USER_DONE_GAME_REQUEST",get:function(){return"EVENT_MODE_USER_DONE_GAME_REQUEST"}},{key:"EVENT_MODE_USER_DONE_GAME_RESPONSE",get:function(){return"EVENT_MODE_USER_DONE_GAME_RESPONSE"}},{key:"EVENT_MODE_LOAD_REQUEST",get:function(){return"EVENT_MODE_LOAD_REQUEST"}},{key:"EVENT_MODE_LOAD_RESPONSE",get:function(){return"EVENT_MODE_LOAD_RESPONSE"}}],(n=null)&&EM(t.prototype,n),i&&EM(t,i),e}();function kM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var PM=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putLong("event_id",e),t}}],(n=null)&&kM(t.prototype,n),i&&kM(t,i),e}();function OM(e){return(OM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xM(e,t){return!t||"object"!==OM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function TM(e){return(TM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function IM(e,t){return(IM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var AM=function(e){function t(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=xM(this,TM(t).call(this,game,0,0,null))).arrCircle=[],e.positionEventMode=e.mainData.positionEventMode,e.circleFist=new rt(e.positionEventMode.queueroom_map_circle),e.circleFist.y=85*z.instance().scale,e.lineDocFist=new rt(e.positionEventMode.queueroom_map_line_doc),e.lineDocFist.x=(e.circleFist.width-e.lineDocFist.width)/2,e.addChild(e.lineDocFist);var n=new rt(e.positionEventMode.queueroom_map_line_ngang);n.x=e.circleFist.width/2,n.y=e.circleFist.y+(e.circleFist.height-n.height)/2,e.addChild(n),e.addChild(e.circleFist),e.circleEnd=new rt(e.positionEventMode.queueroom_map_circle),e.circleEnd.x=n.x+n.width-e.circleEnd.width/2,e.circleEnd.y=e.circleFist.y,e.lineDocEnd=new rt(e.positionEventMode.queueroom_map_line_doc),e.lineDocEnd.x=e.circleEnd.x+(e.circleFist.width-e.lineDocEnd.width)/2,e.addChild(e.lineDocEnd),e.addChild(e.circleEnd);for(var i=n.width/5,o=0;o<4;o++){var a=new rt(e.positionEventMode.queueroom_map_circle_small);a.x=i*(o+1),a.y=e.circleFist.y+(e.circleFist.height-a.height)/2,e.addChild(a),e.arrCircle.push(a)}return e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&IM(e,t)}(t,Mt),n=t,(i=[{key:"addLineRanking",value:function(){this.cup=new rt(this.positionEventMode.queueroom_trophy_big),this.addChild(this.cup);for(var e=0;e<this.arrCircle.length;e++)this.arrCircle[e].visible=!1;this.circleFist.visible=!1}},{key:"setIdxBegin",value:function(e){this.idx=e,e<2?this.setIdx(e):this.setHideLine()}},{key:"setLine",value:function(){this.setIdx(this.idx)}},{key:"setHideLine",value:function(){this.lineDocEnd.visible=!1,this.lineDocFist.visible=!1}},{key:"setIdx",value:function(e){this.idx=e,e%2==0?(this.lineDocEnd.visible=!0,this.lineDocFist.visible=!1):(this.lineDocEnd.visible=!1,this.lineDocFist.visible=!0)}}])&&RM(n.prototype,i),o&&RM(n,o),t}();var LM=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.question_index=0,this.user_id=0,this.user_name="",this.avatar="",this.is_dead=0};var GM=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.event_id=0,this.user_id=0,this.created=0,this.user_name="",this.position=0,this.achieved=0,this.id=0,this.avatar="",this.updated=0};function DM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var MM=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t={arrUser:[],topThree:[]},n=e.getSFSArray(Ir.display_players),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new LM;a.question_index=o.getInt(Ir.question_index),a.user_id=o.getInt(Ir.user_id),a.user_name=o.getUtfString(Ir.user_name),a.avatar=o.getUtfString(Ir.avatar),a.is_dead=o.getInt(Ir.is_dead),t.arrUser.push(a)}for(var s=e.getSFSArray(Ir.top_three),r=0;r<s.size();r++){var l=s.getSFSObject(r),h=new GM;h.user_id=l.getInt(Ir.user_id),h.user_name=l.getUtfString(Ir.user_name),h.achieved=l.getInt(Ir.rank),h.avatar=l.getUtfString(Ir.avatar),t.topThree.push(h)}return t}}],(n=null)&&DM(t.prototype,n),i&&DM(t,i),e}();function NM(e){return(NM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jM(e,t){return!t||"object"!==NM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function UM(e){return(UM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FM(e,t){return(FM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ZM=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=jM(this,UM(t).call(this,game,0,0,null))).data=null,e.positionEventMode=e.mainData.positionEventMode,e.txtUserName=new _t(e.positionEventMode.queueroom_txt_username,""),e.txtUserName.setTextBounds(0,0,89*z.instance().scale,25*z.instance().scale),e.addChild(e.txtUserName),e.txtScore=new _t(e.positionEventMode.queueroom_txt_score,""),e.txtScore.setTextBounds(0,0,89*z.instance().scale,25*z.instance().scale),e.addChild(e.txtScore),e.ava=new pc,e.ava.setSize(45*z.instance().scale,45*z.instance().scale),e.ava.x=22*z.instance().scale,e.ava.y=28*z.instance().scale,e.addChild(e.ava),e.bgTopAvatar=null,e.bgTopAvataDie=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FM(e,t)}(t,Mt),n=t,(i=[{key:"setTopAvatar",value:function(e){this.bgTopAvatar=new rt(0===e?this.positionEventMode.queueroom_icon_rank1:1===e?this.positionEventMode.queueroom_icon_rank2:2===e?this.positionEventMode.queueroom_icon_rank3:this.positionEventMode.queueroom_icon_rankn),this.addChild(this.bgTopAvatar)}},{key:"setTopAvatarMe",value:function(){this.bgTopAvatar=new rt(this.positionEventMode.queueroom_icon_rankme),this.addChild(this.bgTopAvatar)}},{key:"setTopAvatarDie",value:function(){null===this.bgTopAvataDie?(this.bgTopAvatar=new rt(this.positionEventMode.queueroom_icon_maskdie),this.addChild(this.bgTopAvatar)):this.showTopAvatarDie()}},{key:"showTopAvatarDie",value:function(){this.bgTopAvatar.visible=!0}},{key:"hideTopAvatarDie",value:function(){this.bgTopAvatar.visible=!1}},{key:"hideName",value:function(){this.txtUserName.visible=!1}},{key:"showName",value:function(){this.txtUserName.visible=!0}},{key:"getData",value:function(){return this.data}},{key:"setDataRank",value:function(e,t){null===this.data?(this.ava.setAvatar(e.avatar,t),this.txtUserName.text=this.formatName(e.user_name,10),this.txtScore.text=e.achieved):(this.data.user_id!==e.user_id&&this.ava.setAvatar(e.avatar,t),this.data.user_name!==e.user_name&&(this.txtUserName.text=this.formatName(e.user_name,10)),this.data.achieved!==e.achieved&&(this.txtScore.text=e.achieved)),this.data=e}},{key:"setData",value:function(e,t){this.data=e,this.txtUserName.text=this.formatName(this.data.user_name,10),this.ava.setAvatar(e.avatar,t)}},{key:"updateData",value:function(e){this.data=e}},{key:"setNameTop",value:function(){this.txtUserName.y=0}},{key:"setNameBot",value:function(){this.txtUserName.y=79*z.instance().scale}}])&&BM(n.prototype,i),o&&BM(n,o),t}();function HM(e){return(HM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function VM(e,t){return!t||"object"!==HM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function WM(e){return(WM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qM(e,t){return(qM=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var KM=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=VM(this,WM(t).call(this,game,0,0,null))).positionEventMode=e.mainData.positionEventMode,e.icon=new rt(e.positionEventMode.queueroom_count_user_map),e.addChild(e.icon),e.txtCount=new _t(e.positionEventMode.queueroom_count_user_text,"(99)"),e.txtCount.setTextBounds(0,0,e.constWidth,e.constHeigth),e.addChild(e.txtCount),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qM(e,t)}(t,Mt),n=t,(i=[{key:"setLeft",value:function(e){this.txtCount.changeStyle({align:"right",boundsAlignH:"right",boundsAlignV:"middle"}),this.txtCount.x=-this.constWidth-3*this.mainData.scale,this.txtCount.y=(this.icon.height-this.constHeigth)/2+3*this.mainData.scale,this.txtCount.text="("+e+")"}},{key:"setRight",value:function(e){this.txtCount.changeStyle({align:"left",boundsAlignH:"left",boundsAlignV:"middle"}),this.txtCount.x=this.icon.width+3,this.txtCount.y=(this.icon.height-this.constHeigth)/2+3*this.mainData.scale,this.txtCount.text="("+e+")"}},{key:"setTop",value:function(e){this.txtCount.changeStyle({align:"center",boundsAlignH:"center",boundsAlignV:"middle"}),this.txtCount.x=(this.icon.width-this.constWidth)/2,this.txtCount.y=-this.constHeigth,this.txtCount.text="("+e+")"}},{key:"setBottom",value:function(e){this.txtCount.changeStyle({align:"center",boundsAlignH:"center",boundsAlignV:"middle"}),this.txtCount.x=(this.icon.width-this.constWidth)/2,this.txtCount.y=this.icon.height+3,this.txtCount.text="("+e+")"}},{key:"constWidth",get:function(){return 35*z.instance().scale}},{key:"constHeigth",get:function(){return 22*z.instance().scale}}])&&QM(n.prototype,i),o&&QM(n,o),t}();function zM(e){return(zM="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YM(e,t){return!t||"object"!==zM(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function JM(e){return(JM=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function XM(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $M(e,t,n){return t&&XM(e.prototype,t),n&&XM(e,n),e}function eN(e,t){return(eN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tN=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=YM(this,JM(t).call(this,game,0,0,null))).dataEvent=Object.assign({},new Ys,n),e.arrMap=[],e.arrUser=[],e.arrTop3=[],e.objUser={};var i=e.constBeginX,o=e.constBeginY,a=e.constKc;e.idxTween=2,e.idxLine=0,e.localXFinish=0,e.localYFinish=0,e.tweenMap=null,e.layoutAddMap=new Phaser.Sprite(game,0,0,null),e.layoutAddMap.y=154*z.instance().scale,e.addChild(e.layoutAddMap),e.layoutMap=new Phaser.Sprite(game,0,0,null),e.layoutMap.y=0,e.layoutAddMap.addChild(e.layoutMap),e.layoutCountPlayer=new Phaser.Sprite(game,0,0,null),e.layoutMap.addChild(e.layoutCountPlayer);for(var s=0;s<4;s++){var r=new AM;r.setIdxBegin(s),r.x=i,r.y=o,o-=a,e.layoutMap.addChild(r),e.arrMap.push(r)}e.flagIcon=new rt(e.mainData.positionEventMode.queueroom_icon_flag),e.flagIcon.visible=!1,e.layoutMap.addChild(e.flagIcon),e.lineWin=new AM,e.lineWin.addLineRanking(),e.lineWin.setHideLine(),e.lineWin.x=e.constBeginX,e.lineWin.y=0,e.addChild(e.lineWin),e.buildTop3();var l=game.add.graphics(0,0);return l.alpha=.3,l.beginFill(16724736),l.drawRect(0,0,1080*z.instance().scale,445*z.instance().scale),l.endFill(),l.y=-41*z.instance().scale,e.layoutAddMap.addChild(l),e.layoutAddMap.mask=l,e.addMe(),e.dataEvent.finish_at>0&&(e.clock=new nr,e.clock.x=18*z.instance().scale,e.clock.y=35*z.instance().scale,e.clock.setTimer(e.dataEvent.finish_at),e.addChild(e.clock)),e.countUser=new ln(e.mainData.positionEventMode.count_playing_user,"0"),e.addChild(e.countUser),e.addEvent(),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eN(e,t)}(t,Mt),$M(t,[{key:"constBeginY",get:function(){return 183*z.instance().scale}},{key:"constBeginX",get:function(){return 58*z.instance().scale}},{key:"constWidthLine",get:function(){return 480*z.instance().scale}},{key:"constKc",get:function(){return 115*z.instance().scale}}]),$M(t,[{key:"getTime",value:function(){return this.clock?this.clock.getTime():0}},{key:"addMe",value:function(){this.meUser=new ZM,this.meUser.setTopAvatarMe();var e=new LM;e.avatar=TF.instance().dataMySeft.avatar,e.question_index=0,e.user_id=TF.instance().dataMySeft.user_id,e.user_name=TF.instance().dataMySeft.user_name,this.meUser.setData(e),this.changeLocalMe(0)}},{key:"buildHighestLocalMe",value:function(){if(this.mainData.idxHighest>0){this.flagIcon.visible=!0;var e=this.getLocalObject(this.mainData.idxHighest);this.flagIcon.x=e.x+41,this.flagIcon.y=e.y+14}else this.flagIcon.visible=!1}},{key:"changeLocalMe",value:function(e){var t=this;this.meUser.getData().question_index=e,e>1&&this.mainData.idxHighest<e-1&&(this.mainData.idxHighest=e-1),e===this.mainData.idxHighest&&(this.flagIcon.visible=!1);var n=this.getLocalObject(e);0===e?(this.meUser.x=n.x,this.meUser.y=n.y):(this.meUser.x!=this.localXFinish&&(this.meUser.x=this.localXFinish),this.meUser.y!=this.localYFinish&&(this.meUser.y=this.localYFinish)),this.localXFinish=n.x,this.localYFinish=n.y,this.layoutMap.addChild(this.meUser),game.add.tween(this.meUser).to({x:n.x,y:n.y},1e3,Phaser.Easing.Power1,!0),n.local%2!=0?this.meUser.setNameBot():this.meUser.setNameTop();var i=parseInt(e/6);this.idxLine<i&&(this.idxLine=i,this.idxLine>1&&setTimeout(function(){t.beginTween()},1200))}},{key:"buildTop3",value:function(){this.arrTop3=[];for(var e=0;e<3;e++){var t=new ZM;t.setTopAvatar(e),t.setNameBot(),t.visible=!1,t.x=this.constBeginX-26+this.constWidthLine/4*(e+1),t.y=this.lineWin.y+50*z.instance().scale,this.addChild(t),this.arrTop3.push(t)}}},{key:"beginTween",value:function(){LogConsole.log("beginTween ----------------------------"),this.arrMap[this.idxTween].setLine();var e=6+6*(this.idxLine+2),t=e-7;for(var n in this.objUser)this.objUser[n].getData().question_index>t&&this.objUser[n].getData().question_index<e&&(this.objUser[n].visible=!0);LogConsole.log("this.idxLine : "+this.idxLine);var i=this.idxTween-2;i<0&&(i=this.arrMap.length+i),this.tweenMap=game.add.tween(this.layoutMap).to({y:this.constKc*(this.idxLine-1)},2e3,Phaser.Easing.Power1,!0),this.tweenMap.onComplete.add(this.onCompleteTweenMap,this),game.add.tween(this.arrMap[i]).to({alpha:0},1500,Phaser.Easing.Power1,!0)}},{key:"onCompleteTweenMap",value:function(){LogConsole.log("onCompleteTweenMap"+this.idxLine);var e=this.idxTween-2;e<0&&(e=this.arrMap.length+e),this.arrMap[e].y=this.constBeginY-(this.idxLine+2)*this.constKc,this.arrMap[e].alpha=1,this.arrMap[e].setHideLine(),this.idxTween++,this.idxTween===this.arrMap.length&&(this.idxTween=0);var t=6+6*(this.idxLine-1);for(var n in this.objUser)this.objUser[n].getData().question_index<t&&(this.objUser[n].visible=!1)}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),-1===this.mainData.idxHighest||this.buildHighestLocalMe()}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case CM.EVENT_MODE_LOAD_DISPLAY_PLAYERS:var t=MM.begin(e.params);this.arrUser=t.arrUser,this.topThree=t.topThree,this.countUser.setText(e.params.getInt("number_user")),this.buildArrUser();break;case CM.EVENT_MODE_START_GAME:case CM.EVENT_MODE_MOVE_TO_NEXT_QUESTION:this.changeLocalMe(e.params.getInt(Ir.question_index));break;case CM.EVENT_MODE_HIGHEST_ACHIEVED:this.mainData.idxHighest=e.params.getInt(Ir.highest_achieved),this.buildHighestLocalMe()}}},{key:"getLocalObject",value:function(e){var t={local:0,x:0,y:0,vc:0};t.vc=parseInt(e/6),t.local=e%6;var n=this.constWidthLine/5;return t.vc%2==0?t.x=this.constBeginX-30*z.instance().scale+n*t.local:t.x=this.constBeginX-30*z.instance().scale+this.constWidthLine-n*t.local,this.line=parseInt(e/6),t.y=this.constBeginY+6*z.instance().scale-this.constKc*t.vc+42*z.instance().scale,t}},{key:"buildArrUser",value:function(){LogConsole.log("buildArrUser----------");for(var e=0;e<this.topThree.length;e++)this.arrTop3[e]&&(null===this.arrTop3[e].getData()&&(this.arrTop3[e].visible=!0),this.arrTop3[e].setDataRank(this.topThree[e],e));var t=6+6*(this.idxLine+1),n=6+6*(this.idxLine-2)-1;for(var i in LogConsole.log("beginLocal : "+n),LogConsole.log("endLocal : "+t),LogConsole.log(this.arrUser),this.objUser){var o=this.objUser[i];1===o.getData().is_dead&&(this.layoutMap.removeChild(o),o.destroy(),o=null,delete this.objUser[i])}for(var a={},s=0,r=null,l=0,h=0;h<this.arrUser.length;h++){if(this.objUser.hasOwnProperty(this.arrUser[h].user_id)){s=this.objUser[this.arrUser[h].user_id].getData().question_index;var c=this.arrUser[h].question_index;if(LogConsole.log("user_id : "+this.arrUser[h].user_id),LogConsole.log("question_obj_user : "+s),LogConsole.log("question_index_to : "+c),s<c){r=this.objUser[this.arrUser[h].user_id];var u=c-s;LogConsole.log("lengthQuestion : "+u);for(var d=0;d<u;d++){var f=2e3/u;game.time.events.add(f*d,this.buildLocalTween,this,r,s+d+1,f)}r.updateData(this.arrUser[h])}else{var p=this.getLocalObject(s);(r=this.objUser[this.arrUser[h].user_id]).x=p.x,r.y=p.y,p.local%2!=0?r.setNameBot():r.setNameTop(),LogConsole.log("this.arrUser[i].is_dead : "+this.arrUser[h].is_dead),1===this.arrUser[h].is_dead&&r.setTopAvatarDie(),r.updateData(this.arrUser[h])}}else{l++,this.objUser[this.arrUser[h].user_id]=new ZM,(r=this.objUser[this.arrUser[h].user_id]).setTopAvatar(4),r.setData(this.arrUser[h],l);var g=this.arrUser[h].question_index,y=this.getLocalObject(g);r.x=y.x,r.y=y.y,y.local%2!=0?r.setNameBot():r.setNameTop(),this.layoutMap.addChild(r),r.visible=!1,r.setData(this.arrUser[h])}s=(r=this.objUser[this.arrUser[h].user_id]).getData().question_index,this.idxLine<2?r.visible=!(s>17):r.visible=s<t&&s>n,a[s]?(a[s]+=1,r.hideName()):(a[s]=1,this.meUser.getData().question_index===s?r.hideName():r.showName())}for(a[this.meUser.getData().question_index]?a[this.meUser.getData().question_index]+=1:a[this.meUser.getData().question_index]=1;this.layoutCountPlayer.children.length>0;){var m=this.layoutCountPlayer.children[0];this.layoutCountPlayer.removeChild(m),m.destroy(),m=null}for(var v in LogConsole.log(a),a){LogConsole.log("q_index : "+v);var w=!0;if(this.idxLine<2?v>17&&(w=!1):v<t&&v>n||(w=!1),LogConsole.log("ktShow : "+w),w&&a[v]>1){var b=this.getLocalObject(v),_=new KM;LogConsole.log("objLocal[q_index] : "+a[v]),_.x=b.x,_.y=b.y,b.vc%2==0?0===b.local?(_.setBottom(a[v]),_.x=b.x-15*z.instance().scale,_.y=b.y+35*z.instance().scale):5===b.local?(_.setBottom(a[v]),_.y=b.y+35*z.instance().scale,_.x=b.x+77*z.instance().scale):(_.setRight(a[v]),_.x=b.x+18*z.instance().scale,b.local%2!=0?_.y=b.y+6*z.instance().scale:_.y=b.y+80*z.instance().scale):0===b.local?(_.setBottom(a[v]),_.y=b.y+35*z.instance().scale,_.x=b.x+77*z.instance().scale):5===b.local?(_.setBottom(a[v]),_.x=b.x-15*z.instance().scale,_.y=b.y+35*z.instance().scale):(_.setRight(a[v]),_.x=b.x+18*z.instance().scale,b.local%2!=0?_.y=b.y+6*z.instance().scale:_.y=b.y+80*z.instance().scale),this.layoutCountPlayer.addChild(_)}}this.layoutMap.addChild(this.meUser)}},{key:"buildLocalTween",value:function(e,t,n){var i=this.getLocalObject(t);game.add.tween(e).to({x:i.x,y:i.y},n,Phaser.Easing.Power1,!0),i.local%2!=0?e.setNameBot():e.setNameTop()}},{key:"destroy",value:function(){this.removeEvent(),this.removeAllItem()}}]),t}();function nN(e){return(nN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oN(e,t){return!t||"object"!==nN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aN(e,t,n){return(aN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=sN(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function sN(e){return(sN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function rN(e,t){return(rN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var lN=function(e){function t(e,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=oN(this,sN(t).call(this,e,n,i))).positionEventMode=z.instance().positionEventMode,o.iconTicket=new rt(o.positionEventMode.queueroom_button_play_icon_ticket),o.addChild(o.iconTicket),o.lbPlay=new _t(o.positionEventMode.queueroom_button_play_text_play,"CHƠI"),o.lbPlay.setTextBounds(0,0,570*z.instance().scale,43*z.instance().scale),o.addChild(o.lbPlay),o.txtCount=new _t(o.positionEventMode.queueroom_button_play_count_ticket,"-1("+TF.instance().dataMySeft.ticket+")"),o.txtCount.setTextBounds(0,0,85*z.instance().scale,43*z.instance().scale),o.addChild(o.txtCount),o.addEvent(),o}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&rN(e,t)}(t,pt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this)}},{key:"removeEvent",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this)}},{key:"userVarsUpdate",value:function(){this.txtCount.text="-1("+TF.instance().dataMySeft.ticket+")"}},{key:"destroy",value:function(){this.removeEvent(),aN(sN(t.prototype),"destroy",this).call(this)}}])&&iN(n.prototype,i),o&&iN(n,o),t}();function hN(e){return(hN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function uN(e){return(uN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dN(e,t){return(dN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var pN=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=uN(t).call(this,game,0,0,null))||"object"!==hN(i)&&"function"!=typeof i?fN(n):i).data=null,e.positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),e.ava=new pc,e.ava.setSize(47*z.instance().scale,47*z.instance().scale),e.ava.x=35*z.instance().scale,e.ava.y=6*z.instance().scale,e.addChild(e.ava),e.btnMaskAva=new Phaser.Button(game,e.ava.x,e.ava.y,null,e.chooseAva,fN(fN(e))),e.btnMaskAva.width=e.ava.width,e.btnMaskAva.height=e.ava.height,e.addChild(e.btnMaskAva),e.txtChat=new _t(e.positionEventMode.queueroom_text_chat,"aaaaaaaaaaaaaaaaaaaa"),e.txtChat.setTextBounds(0,0,450*z.instance().scale,55*z.instance().scale),e.addChild(e.txtChat),e.txtTime=new _t(e.positionEventMode.queueroom_text_chat_time,""),e.txtTime.setTextBounds(0,0,518*z.instance().scale,55*z.instance().scale),e.addChild(e.txtTime),e.line=new rt(e.positionEventMode.item_ranking_line_space),e.line.y=69*z.instance().scale,e.addChild(e.line),e.silentchat=e.mainData.silentchat,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dN(e,t)}(t,Mt),n=t,(i=[{key:"chooseAva",value:function(){console.log("clickAva"),$r.instance().hide(),IE.instance().addUserProfile(this.data.user_id)}},{key:"setData",value:function(e,t){this.data=e,console.log(e),this.ava.setAvatar(e.avatar,t);for(var n=e.message,i=0;i<this.silentchat.length;i++)n.indexOf(this.silentchat[i])>-1&&(console.log("--------------------"),n=n.replace(this.silentchat[i],"***"));this.txtChat.text=e.user_name+": "+n,this.txtChat.addColor("#ffa33a",0),this.txtChat.addColor("#ffffff",e.user_name.length);var o=new Date(e.sent_at),a=o.getHours(),s=o.getMinutes(),r="00",l="00";r=a>9?a:"0"+a,l=s>9?s:"0"+s,this.txtTime.text=r+":"+l}},{key:"height",get:function(){return 71*z.instance().scale}}])&&cN(n.prototype,i),o&&cN(n,o),t}();function gN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var yN=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t){var n=new SFS2X.SFSObject;return n.putLong("event_id",e),n.putLong("time",t),n}}],(n=null)&&gN(t.prototype,n),i&&gN(t,i),e}();function mN(e){return(mN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vN(e,t,n){return(vN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=wN(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function wN(e){return(wN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _N(e,t,n){return t&&bN(e.prototype,t),n&&bN(e,n),e}function SN(e,t){return(SN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function EN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var CN=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=wN(t).call(this,game,0,0,null))||"object"!==mN(o)&&"function"!=typeof o?EN(i):o).arrChat=[],n.ktShowAll=!1,n.positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),n.loading=null,n.event_id=e,n.listChat=null,n.config={debug:!1,host:"yan.gamezoka.com",port:8460,useSSL:!0,zone:"MusicChat"},null!==n.mainData.response&&n.mainData.response.hasOwnProperty("sfs_chat_info")&&(n.config.debug=n.mainData.response.sfs_chat_info.sfs_chat_debug,n.config.host=n.mainData.response.sfs_chat_info.sfs_chat_host,n.config.port=n.mainData.response.sfs_chat_info.sfs_chat_port,n.config.useSSL=n.mainData.response.sfs_chat_info.sfs_chat_ssl,n.config.zone=n.mainData.response.sfs_chat_info.sfs_chat_zone),n.bg=new Zt(n.positionEventMode.queueroom_bg_chat),n.addChild(n.bg),n.btnShowChat=new pt(n.positionEventMode.queueroom_button_showchat,n.chooseShowchat,EN(EN(n))),n.btnShowChat.anchor.x=.5,n.btnShowChat.anchor.y=.5,n.addChild(n.btnShowChat),n.buildSortChat(),n.btnInputText=new ln(n.positionEventMode.queueroom_button_input_chat,"Bình luận...",n.chooseChat,EN(EN(n))),n.btnInputText.y=game.height-226*n.mainData.scale,n.addChild(n.btnInputText),n.btnSend=new pt(n.positionEventMode.queueroom_button_send_chat,n.chooseSend,EN(EN(n))),n.btnSend.y=game.height-226*n.mainData.scale,n.addChild(n.btnSend),n.socket=new SFS2X.SmartFox(n.config),n.connect(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SN(e,t)}(t,Mt),_N(t,null,[{key:"EVENT_JOIN_CHAT",get:function(){return"EVENT_JOIN_CHAT"}},{key:"EVENT_USER_LOAD_MESSAGE",get:function(){return"EVENT_USER_LOAD_MESSAGE"}},{key:"EVENT_USER_SEND_MESSAGE",get:function(){return"EVENT_USER_SEND_MESSAGE"}},{key:"EVENT_CHAT_MESSAGE_BROADCAST",get:function(){return"EVENT_CHAT_MESSAGE_BROADCAST"}},{key:"USER_JOIN_CHAT_ROOM_SUCCESS",get:function(){return"USER_JOIN_CHAT_ROOM_SUCCESS"}}]),_N(t,[{key:"chooseChat",value:function(){this.addKeyBoard()}},{key:"chooseSend",value:function(){this.onSubmit()}},{key:"addKeyBoard",value:function(){console.log("addKeyBoard--------");var e={maxLength:"",showTransparent:!0,placeholder:"Bình luận...",isSearch:!1,typeInputText:"input",configText:{width:this.btnInputText.width,height:this.btnInputText.height,x:this.btnInputText.x,y:this.btnInputText.y}};$r.instance().show(e)}},{key:"onSubmit",value:function(){var e=$r.instance().getValue();if(""!=e){var n=new SFS2X.SFSObject;n.putUtfString("message",e),n.putLong("event_id",this.event_id),this.sendData(t.EVENT_USER_SEND_MESSAGE,n)}$r.instance().setValue("")}},{key:"onCancel",value:function(){console.log("onCancel -----------------"),$r.instance().hide(),this.btnInputText.visible=!0}},{key:"hideKeyboard",value:function(){console.log("hideKeyboard ----------------------"),$r.instance().hide(),this.ktShowAll?this.buildMaxChat():this.buildSortChat()}},{key:"changeHeightKeyBoard",value:function(e){this.removeListView(),this.btnShowChat.visible=!1;var t={maxLength:"",showTransparent:!0,placeholder:"Bình luận...",isSearch:!1,typeInputText:"chat",configText:{width:this.btnInputText.width,height:this.btnInputText.height,x:this.btnInputText.x,y:this.btnInputText.y}};$r.instance().show(t),this.bg.y=61,this.bg.height=game.height-61,this.btnShowChat.scale.y=1,this.btnShowChat.x=this.bg.width/2,this.btnShowChat.y=this.bg.y+18*z.instance().scale;var n=new Phaser.Group(game,0,0,null);this.listChat=new Vo(game,n,new Phaser.Rectangle(0,0,game.width,game.height-e-61),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),n.x=0,n.y=61,this.addChild(n);for(var i=0;i<this.arrChat.length;i++)this.addItemChat(this.arrChat[i],i);this.arrChat.length>4&&this.listChat.tweenToItem(this.arrChat.length-1)}},{key:"changeKeyBoard",value:function(){}},{key:"removeListView",value:function(){null!==this.listChat&&(this.removeChild(this.listChat),this.listChat.removeAll(),this.listChat.destroy(),this.listChat=null)}},{key:"chooseShowchat",value:function(){this.ktShowAll?this.buildSortChat():this.buildMaxChat()}},{key:"buildSortChat",value:function(){this.ktShowAll=!1,this.removeListView(),this.btnShowChat.visible=!0,this.bg.y=this.positionEventMode.queueroom_bg_chat.y*z.instance().scale,this.bg.height=game.height-535*z.instance().scale,this.btnShowChat.scale.y=1,this.btnShowChat.x=this.bg.width/2,this.btnShowChat.y=this.bg.y+18*z.instance().scale;var e=new Phaser.Group(game,0,0,null);this.listChat=new Vo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-822*z.instance().scale),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),e.x=0,e.y=580*z.instance().scale,this.addChild(e);for(var t=0;t<this.arrChat.length;t++)this.addItemChat(this.arrChat[t],t);this.arrChat.length>4&&this.listChat.tweenToItem(this.arrChat.length-1)}},{key:"buildMaxChat",value:function(){this.removeListView(),this.btnShowChat.visible=!0,this.ktShowAll=!0,this.bg.y=61*z.instance().scale,this.bg.height=game.height,this.btnShowChat.scale.y=-1,this.btnShowChat.x=this.bg.width/2,this.btnShowChat.y=this.bg.y+18*z.instance().scale;var e=new Phaser.Group(game,0,0,null);this.listChat=new Vo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-365*z.instance().scale),{direction:"y",padding:18*z.instance().scale,searchForClicks:!1}),e.x=0,e.y=120*z.instance().scale,this.addChild(e);for(var t=0;t<this.arrChat.length;t++)this.addItemChat(this.arrChat[t],t);this.arrChat.length>9&&this.listChat.tweenToItem(this.arrChat.length-1)}},{key:"addLoading",value:function(){this.removeLoading(),this.loading=new Fe,this.addChild(this.loading)}},{key:"removeLoading",value:function(){null!==this.loading&&(this.removeChild(this.loading),this.loading.destroy(),this.loading=null)}},{key:"connect",value:function(){this.addLoading(),this.addEvent(),this.socket.connect()}},{key:"addEvent",value:function(){this.removeEvent(),this.socket.addEventListener(SFS2X.SFSEvent.CONNECTION,this.onConnectionCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLostCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponseCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinErrorCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoinCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginErrorCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.LOGIN,this.onLoginCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessageCallback,this),this.socket.addEventListener(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVarsUpdate,this),$r.instance().event.change.add(this.changeKeyBoard,this),$r.instance().event.changeHeight.add(this.changeHeightKeyBoard,this),$r.instance().event.hideKeyboard.add(this.hideKeyboard,this),$r.instance().event.enter.add(this.onSubmit,this),$r.instance().event.submit.add(this.onSubmit,this),$r.instance().event.cancle.add(this.onCancel,this)}},{key:"removeEvent",value:function(){console.log("removeEvent -------"),this.socket.removeEventListener(SFS2X.SFSEvent.CONNECTION,this.onConnectionCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLostCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponseCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinErrorCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoinCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginErrorCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.LOGIN,this.onLoginCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessageCallback,this),this.socket.removeEventListener(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVarsUpdate,this),$r.instance().event.change.remove(this.changeKeyBoard,this),$r.instance().event.changeHeight.remove(this.changeHeightKeyBoard,this),$r.instance().event.hideKeyboard.remove(this.hideKeyboard,this),$r.instance().event.enter.remove(this.onSubmit,this),$r.instance().event.submit.remove(this.onSubmit,this),$r.instance().event.cancle.remove(this.onCancel,this)}},{key:"onUserVarsUpdate",value:function(e){}},{key:"onPublicMessageCallback",value:function(e){if(LogConsole.log("onPublicMessageCallback"),LogConsole.log(e),e.message===Pe.CHAT_EVENT_MODE){var t=e.sender,n=(t.isItMe,e.room._userManager._usersByName.get(t.name)),i={user_id:n.getVariable("user_id").value,user_name:n.getVariable("user_name").value,avatar:n.getVariable("avatar").value,vip:n.getVariable("vip").value,message:e.data.getUtfString("message"),sent_at:data.getLong("sent_at")};this.buildItemChat(i)}}},{key:"buildItemChat",value:function(e){this.addItemChat(e),this.arrChat.push(e)}},{key:"buildHistoryChat",value:function(e){var t=[];this.listChat.removeAll(),this.listChat.reset(),this.arrChat=[];for(var n=0;n<e.size();n++){var i=e.getSFSObject(n),o={user_id:i.getInt("user_id"),user_name:i.getUtfString("user_name"),avatar:i.getUtfString("avatar"),vip:i.getUtfString("vip"),message:i.getUtfString("message"),sent_at:i.getLong("sent_at")};t.push(o)}t=t.sort(this.sortChat);for(var a=0;a<t.length;a++)this.buildItemChat(t[a]);this.ktShowAll?this.arrChat.length>9&&this.listChat.tweenToItem(this.arrChat.length-1):this.arrChat.length>4&&this.listChat.tweenToItem(this.arrChat.length-1)}},{key:"sortChat",value:function(e,t){return e.sent_at>t.sent_at?1:e.sent_at<t.sent_at?-1:0}},{key:"addItemChat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;LogConsole.log("addItemChat----"),LogConsole.log(e);var n=new pN;n.setData(e,t),this.listChat.add(n)}},{key:"onExtensionResponseCallback",value:function(e){switch(LogConsole.log("onExtensionResponseCallback--------------"),LogConsole.log("cmd : "+e.cmd),LogConsole.log("data : "+e.params.getDump()),e.cmd){case t.EVENT_JOIN_CHAT:break;case t.EVENT_USER_LOAD_MESSAGE:this.removeLoading(),"OK"===e.params.getUtfString("status")&&this.buildHistoryChat(e.params.getSFSArray("messages"));break;case t.USER_JOIN_CHAT_ROOM_SUCCESS:break;case t.EVENT_CHAT_MESSAGE_BROADCAST:var n=e.params,i={user_id:n.getInt("user_id"),user_name:n.getUtfString("user_name"),avatar:n.getUtfString("avatar"),vip:n.getUtfString("vip"),message:n.getUtfString("message"),sent_at:n.getLong("sent_at")};this.buildItemChat(i),this.arrChat.length>0&&this.listChat.tweenToItem(this.arrChat.length-1)}}},{key:"onLoginCallback",value:function(e){LogConsole.log("onLoginCallback"),LogConsole.log(e);var n=[];n.push(new SFS2X.SFSUserVariable("user_id",TF.instance().dataMySeft.user_id)),n.push(new SFS2X.SFSUserVariable("user_name",TF.instance().dataMySeft.user_name)),n.push(new SFS2X.SFSUserVariable("avatar",TF.instance().dataMySeft.avatar)),n.push(new SFS2X.SFSUserVariable("vip",TF.instance().dataMySeft.vip)),this.socket.send(new SFS2X.SetUserVariablesRequest(n));var i=new SFS2X.SFSObject;i.putLong("event_id",this.event_id),this.sendData(t.EVENT_JOIN_CHAT,i)}},{key:"onLoginErrorCallback",value:function(e){LogConsole.log("onLoginErrorCallback"),LogConsole.log(e)}},{key:"onRoomJoinCallback",value:function(e){LogConsole.log("onRoomJoinCallback"),LogConsole.log(e),this.listChat.removeAll(),this.listChat.reset(),this.sendData(t.EVENT_USER_LOAD_MESSAGE,yN.begin(this.event_id,this.getTime()))}},{key:"onRoomJoinErrorCallback",value:function(e){LogConsole.log("onRoomJoinErrorCallback"),LogConsole.log(e)}},{key:"onConnectionCallback",value:function(e){if(LogConsole.log("onConnectionCallback"),LogConsole.log(e),!0===e.success){var t=new SFS2X.SFSObject;t.putUtfString("token","heheh"),this.socket.send(new SFS2X.LoginRequest(TF.instance().dataMySeft.user_id+"","",t,this.config.zone))}else LogConsole.log("loi roi"),this.connect()}},{key:"onConnectionLostCallback",value:function(e){LogConsole.log("onConnectionLostCallback"),LogConsole.log(e),null!==TF.instance().roomLobby&&this.connect()}},{key:"sendData",value:function(e,t){LogConsole.log("sendData"),LogConsole.log("type : "+e),null!=t&&LogConsole.log("data : "+t.getDump()),this.socket.send(new SFS2X.ExtensionRequest(e,t,this.socket.lastJoinedRoom))}},{key:"sendPublicChat",value:function(e,t){this.socket.send(new SFS2X.PublicMessageRequest(e,t,this.socket.lastJoinedRoom))}},{key:"destroy",value:function(){this.onCancel(),this.socket.disconnect(),this.removeEvent(),this.removeAllItem(),this.removeListView(),vN(wN(t.prototype),"destroy",this).call(this)}}]),t}();function kN(e){return(kN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function ON(e,t,n){return(ON="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=RN(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function RN(e){return(RN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xN(e,t){return(xN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function TN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var IN=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,e=!(i=RN(t).call(this,game,0,0,null))||"object"!==kN(i)&&"function"!=typeof i?TN(n):i,qe.instance().showLoading(),e.dataEvent=Object.assign({},new Ys,o),e.event={back:new Phaser.Signal,ranking:new Phaser.Signal,play_room:new Phaser.Signal},e.positionEventMode=JSON.parse(game.cache.getText("positionEventMode")),e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),e.map=new tN(e.dataEvent),e.map.y=50*z.instance().scale,e.addChild(e.map),e.chat=new CN(e.dataEvent.id),e.addChild(e.chat),e.header=new SM,e.header.event.trophy.add(e.chooseTrophy,TN(TN(e))),e.header.event.back.add(e.chooseBack,TN(TN(e))),e.header.setTitle(e.dataEvent.name),e.addChild(e.header),e.btnPlay=new lN(e.positionEventMode.queueroom_bg_button_play,e.choosePlay,TN(TN(e))),e.btnPlay.y=game.height-138*e.mainData.scale,e.addChild(e.btnPlay),Le.instance().logEvent(Le.Event_mode_join_room),li.instance().showInterstitialEventMode(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xN(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(e){ce.instance().playSound(ce.joineventmode),De.instance().event.backButton.add(this.chooseBack,this),TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().events.onUserExitRoom.add(this.userExitRoom,this),this.dataEvent.id>0?!1===e?TF.instance().sendData(CM.EVENT_MODE_JOIN_REQUEST,PM.begin(this.dataEvent.id)):qe.instance().hideLoading():this.event.back.dispatch()}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),TF.instance().events.onExtensionResponse.remove(this.getData,this),TF.instance().events.onUserExitRoom.remove(this.userExitRoom,this)}},{key:"userExitRoom",value:function(e){e.room.isGame&&e.user.isItMe&&this.event.back.dispatch()}},{key:"getData",value:function(e){switch(e.cmd){case CM.EVENT_MODE_JOIN_RESPONSE:"FAILED"===e.params.getUtfString("status")&&this.event.back.dispatch(),qe.instance().hideLoading()}}},{key:"choosePlay",value:function(){LogConsole.log("choosePlay"),$r.instance().hide(),Le.instance().logEvent(Le.Event_mode_play_button),this.map.getTime()>5?TF.instance().dataMySeft.ticket<1?IE.instance().addDialogConfirnTicket("Bạn không đủ vé để tham giá sự kiện. Bạn có muốn mua thêm vé?"):(ce.instance().playSound(ce.clickbuttonplayeventmode),this.btnPlay.inputEnabled=!1,this.event.play_room.dispatch()):IE.instance().addDialog("Sự kiện đã kết thúc.")}},{key:"chooseTrophy",value:function(){this.event.ranking.dispatch(this.dataEvent.id)}},{key:"chooseBack",value:function(){ce.instance().removeSound(),TF.instance().sendExitRoom()}},{key:"destroy",value:function(){ce.instance().removeSound(),this.chat.destroy(),this.map.destroy(),ON(RN(t.prototype),"destroy",this).call(this)}}])&&PN(n.prototype,i),o&&PN(n,o),t}();function AN(e){return(AN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function LN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GN(e,t,n){return(GN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=DN(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function DN(e){return(DN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function MN(e,t){return(MN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var BN=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=DN(t).call(this,game,0,0,null))||"object"!==AN(i)&&"function"!=typeof i?NN(n):i).event={back:new Phaser.Signal},e.score=0,e.popupHelp=null,e.positionEventMode=e.mainData.positionEventMode,e.bg=new pt(e.positionEventMode.header_bg),e.addChild(e.bg),e.btnBack=new pt(e.positionEventMode.header_buttom_back,e.chooseBack,NN(NN(e))),e.addChild(e.btnBack),e.score=TF.instance().dataMySeft.ticket,e.btnTicket=new ln(e.positionEventMode.header_buttom_ticket,TF.instance().dataMySeft.ticket),e.addChild(e.btnTicket),e.txtTitle=new _t(e.positionEventMode.header_text_title,""),e.txtTitle.setTextBounds(0,0,e.bg.width,e.bg.height),e.addChild(e.txtTitle),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MN(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onUserVarsUpdate.add(this.userVarsUpdate,this)}},{key:"removeEvent",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.userVarsUpdate,this)}},{key:"userVarsUpdate",value:function(){var e=this,t={score:this.score};this.score=TF.instance().dataMySeft.ticket;var n=game.add.tween(t).to({score:TF.instance().dataMySeft.ticket},300,"Linear",!1);n.start(),n.onUpdateCallback(function(){e.btnTicket&&e.btnTicket.setText(parseInt(t.score))},this)}},{key:"setHelp",value:function(){this.ktAddHelp=!1,this.popupHelp=null,this.btnHelp=new pt(this.mainData.positionPopup.header_button_help,this.chooseHelp,this),this.addChild(this.btnHelp)}},{key:"chooseHelp",value:function(){console.log("chooseHelp : "+this.ktAddHelp),this.ktAddHelp=!this.ktAddHelp,!0===this.ktAddHelp?this.addPopupHelp():this.removePopupHelp()}},{key:"addPopupHelp",value:function(){this.removePopupHelp(),this.popupHelp=new Kt("TOP 100 người trả lời đúng nhiều câu hỏi nhất (cập nhật sau 30 giây)"),this.popupHelp.y=83*z.instance().scale,this.popupHelp.x=game.width-this.popupHelp.width-71*z.instance().scale,game.world.add(this.popupHelp)}},{key:"removePopupHelp",value:function(){null!==this.popupHelp&&(game.world.remove(this.popupHelp),this.popupHelp.destroy(),this.popupHelp=null)}},{key:"setTitle",value:function(e){this.txtTitle.text=e}},{key:"addSelectRoom",value:function(){this.countTicket=new ln(this.positionEventMode.header_buttom_ticket,TF.instance().dataMySeft.ticket),this.addChild(this.countTicket)}},{key:"chooseBack",value:function(){this.btnBack.inputEnabled=!1,this.event.back.dispatch()}},{key:"destroy",value:function(){this.removeEvent(),this.removePopupHelp(),IE.instance().removeAnimClaimReward(),GN(DN(t.prototype),"destroy",this).call(this)}}])&&LN(n.prototype,i),o&&LN(n,o),t}();function jN(e){return(jN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function FN(e,t){return!t||"object"!==jN(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZN(e){return(ZN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function HN(e,t){return(HN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var QN=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=FN(this,ZN(t).call(this,game,0,0,null))).title=e,n.positionEventMode=n.mainData.positionEventMode,n.txtDes=new _t(n.positionEventMode.queueroom_txt_title_event,e),n.addChild(n.txtDes),n.line=new rt(n.positionEventMode.queueroom_line_select_event),n.addChild(n.line),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&HN(e,t)}(t,Mt),n=t,(i=[{key:"setCount",value:function(e){this.txtDes.text=this.title+" ("+e+")"}},{key:"height",get:function(){return 53*z.instance().scale}},{key:"width",get:function(){return game.width}}])&&UN(n.prototype,i),o&&UN(n,o),t}();function VN(e){return(VN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function WN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function qN(e,t,n){return(qN="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=KN(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function KN(e){return(KN=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zN(e,t){return(zN=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function YN(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var JN=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,e=!(i=KN(t).call(this,game,0,0,null))||"object"!==VN(i)&&"function"!=typeof i?YN(n):i,qe.instance().showLoading(),e.event={back:new Phaser.Signal,choose_event:new Phaser.Signal,view_history:new Phaser.Signal},e.objStart={},e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg);var o=new Phaser.Group(game,0,0,null);return e.listRoom=new Vo(game,o,new Phaser.Rectangle(0,0,game.width,game.height-142*z.instance().scale),{direction:"y",padding:38*z.instance().scale,searchForClicks:!0}),o.x=0,o.y=142*z.instance().scale,e.addChild(o),e.header=new BN,e.header.event.back.add(e.chooseBack,YN(YN(e))),e.addChild(e.header),Le.instance().logEvent(Le.Event_mode),li.instance().showBanerEventRoomScreen(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zN(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),TF.instance().events.onExtensionResponse.add(this.getData,this),Ur.instance().event.event_update.add(this.addListRoom,this),Ur.instance().event.load_event_list_complete.add(this.buildDataRoomEvent,this),!0===Ur.instance().ktLoadEventList?this.buildDataRoomEvent():Ur.instance().sendGetEventList()}},{key:"buildDataRoomEvent",value:function(){this.addListRoom(),TF.instance().sendData(CM.EVENT_MODE_LOAD_REQUEST,null),qe.instance().hideLoading()}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),TF.instance().events.onExtensionResponse.remove(this.getData,this),Ur.instance().event.event_update.remove(this.addListRoom,this),Ur.instance().event.load_event_list_complete.remove(this.buildDataRoomEvent,this)}},{key:"getData",value:function(e){switch(e.cmd){case CM.EVENT_MODE_LOAD_LIST_RESPONSE:break;case CM.EVENT_MODE_LOAD_RESPONSE:if("OK"===e.params.getUtfString("status"))for(var t=e.params.getSFSArray("event_ccu"),n=0;n<t.size();n++){var i=t.getSFSObject(n);this.objStart[i.getLong("event_id")]&&this.objStart[i.getLong("event_id")].setCuu(i.getInt("number_user"))}}}},{key:"addListRoom",value:function(){this.listRoom.removeAll(),this.listRoom.reset();var e=0,t=-1;this.objStart={};var n=new QN("Đang diễn ra");this.listRoom.add(n);var i=Ur.instance().roomEvent.getStartRoom();for(e=0;e<i.length;e++){t++;var o=new Or(i[e],t);o.event.choose_item.add(this.chooseItem,this),o.x=35*z.instance().scale,this.listRoom.add(o),this.objStart[i[e].id]=o}n.setCount(i.length);var a=new QN("Sắp diễn ra");this.listRoom.add(a);var s=Ur.instance().roomEvent.getWaittingRoom();for(e=0;e<s.length;e++){t++;var r=new Or(s[e],t);r.event.choose_item.add(this.chooseItem,this),r.x=35*z.instance().scale,this.listRoom.add(r)}a.setCount(s.length);var l=new QN("Kết thúc");this.listRoom.add(l);var h=Ur.instance().roomEvent.getEndRoom();for(e=0;e<h.length;e++){t++;var c=new Or(h[e],t);c.event.choose_item.add(this.chooseItem,this),c.event.view_history.add(this.viewHistory,this),c.x=35*z.instance().scale,this.listRoom.add(c)}l.setCount(h.length)}},{key:"viewHistory",value:function(e){this.event.view_history.dispatch(e)}},{key:"chooseItem",value:function(e){Le.instance().logEvent(Le.Event_mode_join_room_button),this.event.choose_event.dispatch(e)}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listRoom.removeAll(),this.listRoom.destroy(),li.instance().hideBanner(),qN(KN(t.prototype),"destroy",this).call(this)}}])&&WN(n.prototype,i),o&&WN(n,o),t}();function XN(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var $N=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putLong("event_id",e),t}}],(n=null)&&XN(t.prototype,n),i&&XN(t,i),e}();var eB=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diamond=0,this.event_id=0,this.ticket=0,this.created=0,this.event_ranking="",this.updated=0,this.support_item=0};function tB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var nB=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t={arrRanking:[],rankMe:new GM,arrReward:[]};if(e.containsKey(Ir.event_ranking))for(var n=e.getSFSArray(Ir.event_ranking),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new GM;a.event_id=o.getLong(Ir.event_id),a.user_id=o.getInt(Ir.user_id),a.created=o.getLong(Ir.created),a.user_name=o.getUtfString(Ir.user_name),a.position=o.getInt(Ir.position),a.achieved=o.getInt(Ir.achieved),a.id=o.getLong(Ir.id),a.avatar=o.getUtfString(Ir.avatar),a.updated=o.getLong(Ir.updated),t.arrRanking.push(a)}if(e.containsKey(Ir.your_rank)){var s=e.getSFSObject(Ir.your_rank);t.rankMe.event_id=s.getLong(Ir.event_id),t.rankMe.user_id=s.getInt(Ir.user_id),t.rankMe.created=s.getLong(Ir.created),t.rankMe.user_name=s.getUtfString(Ir.user_name),t.rankMe.position=s.getInt(Ir.position),t.rankMe.achieved=s.getInt(Ir.achieved),t.rankMe.id=s.getLong(Ir.id),t.rankMe.avatar=s.getUtfString(Ir.avatar),t.rankMe.updated=s.getLong(Ir.updated)}if(e.containsKey(Ir.event_reward))for(var r=e.getSFSArray(Ir.event_reward),l=0;l<r.size();l++){var h=r.getSFSObject(l),c=new eB;c.diamond=h.getInt(Ir.diamond),c.event_id=h.getLong(Ir.event_id),c.ticket=h.getInt(Ir.ticket),c.created=h.getLong(Ir.created),c.event_ranking=h.getUtfString(Ir.event_ranking),c.updated=h.getLong(Ir.updated),c.support_item=h.getInt(Ir.support_item),t.arrReward.push(c)}return t}}],(n=null)&&tB(t.prototype,n),i&&tB(t,i),e}();function iB(e){return(iB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function oB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function aB(e){return(aB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sB(e,t){return(sB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var lB=function(e){function t(e,n){var i,o,a,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=aB(t).call(this,game,0,0,null))||"object"!==iB(a)&&"function"!=typeof a?rB(o):a).idx=n,i.data=e,i.isMe=r,i._width=140*z.instance().scale,i.positionEventMode=i.mainData.positionEventMode,i.ava=new pc,i.ava.setSize(63*z.instance().scale,63*z.instance().scale),i.ava.x=137*z.instance().scale,i.ava.y=41*z.instance().scale,i.addChild(i.ava),i.btnMaskAva=new Phaser.Button(game,i.ava.x,i.ava.y,null,i.chooseAva,rB(rB(i))),i.btnMaskAva.width=i.ava.width,i.btnMaskAva.height=i.ava.height,i.addChild(i.btnMaskAva),i.line=new rt(i.positionEventMode.item_ranking_line_space),i.addChild(i.line),0===n?i.bgTopAvata=new rt(i.positionEventMode.item_ranking_avatar_top1):1===n?i.bgTopAvata=new rt(i.positionEventMode.item_ranking_avatar_top2):2===n?i.bgTopAvata=new rt(i.positionEventMode.item_ranking_avatar_top3):(i.ava.x=137*z.instance().scale,i.ava.y=26*z.instance().scale,i.bgTopAvata=new rt(i.positionEventMode.item_ranking_avatar_top4),i._width=130*z.instance().scale,i.line.y=i._width-2),i.addChild(i.bgTopAvata),i.iconTrophy=new rt(i.positionEventMode.item_ranking_trophy_item),i.addChild(i.iconTrophy),n<3?(i.txtStt=new _t(i.positionEventMode.item_ranking_text_top123,n+1),i.txtStt.setTextBounds(0,0,28*z.instance().scale,27*z.instance().scale),i.txtUserName=new _t(i.positionEventMode.item_ranking_text_user_name123,i.formatName(e.user_name,15)),i.txtScore=new _t(i.positionEventMode.item_ranking_text_score123,e.achieved)):(i.iconTrophy.y=43,i.txtStt=new _t(i.positionEventMode.item_ranking_text_top4,n+1),i.txtUserName=new _t(i.positionEventMode.item_ranking_text_user_name4,i.formatName(e.user_name,15)),i.txtScore=new ln(i.positionEventMode.item_ranking_text_score4,e.achieved)),i.addChild(i.txtScore),i.addChild(i.txtStt),i.addChild(i.txtUserName),r?i.ava.setAvatar(e.avatar,0):i.ava.setAvatar(e.avatar,n),null===s||(i.dataWin=new br(s,!0),i.dataWin.x=i.width-i.dataWin.width-12*z.instance().scale,i.dataWin.y=(i.height-i.dataWin.height)/2,i.addChild(i.dataWin)),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sB(e,t)}(t,Mt),n=t,(i=[{key:"chooseAva",value:function(){console.log("clickAva"),console.log(this.data),IE.instance().addUserProfile(this.data.user_id)}},{key:"hideLine",value:function(){this.line.visible=!1}},{key:"beginTween",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;!0===this.isMe?this.x=0:e<8?(this.x=game.width,game.add.tween(this).to({x:0},150,Phaser.Easing.Power1,!0,80*(this.idx+1))):this.x=0}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this._width}}])&&oB(n.prototype,i),o&&oB(n,o),t}();function hB(e){return(hB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function uB(e,t){return!t||"object"!==hB(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dB(e){return(dB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fB(e,t){return(fB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pB=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=uB(this,dB(t).call(this,game,0,0,null))).positionEventMode=n.mainData.positionEventMode,n.bg=new Zt(n.positionEventMode.ranking_bg_title),n.addChild(n.bg);var o=new rt(n.positionEventMode.ranking_trophy410);return n.addChild(o),n.txtTitle=new _t(n.positionEventMode.ranking_text_title,e),n.addChild(n.txtTitle),null===i||(n.dataWin=new br(i,!0),n.dataWin.hideBg(),n.dataWin.x=n.bg.width-n.dataWin.width-35*z.instance().scale,n.dataWin.y=(n.bg.height-n.dataWin.height)/2,n.addChild(n.dataWin)),n.line=new rt(n.positionEventMode.queueroom_line_select_event),n.line.y=72*z.instance().scale,n.addChild(n.line),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fB(e,t)}(t,Mt),n=t,(i=[{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&cB(n.prototype,i),o&&cB(n,o),t}();function gB(e){return(gB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mB(e,t,n){return(mB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=vB(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function vB(e){return(vB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wB(e,t){return(wB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var _B=function(e){function t(e){var n,i,o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=vB(t).call(this,game,0,0,null))||"object"!==gB(o)&&"function"!=typeof o?bB(i):o).positionEventMode=n.mainData.positionEventMode,qe.instance().showLoading(),n.event_id=e,n.event={back:new Phaser.Signal},n.arrRanking=[],n.objRankMe={},n.arrReward=[],n.bg=new Phaser.Button(game,0,0,"bg_create_room"),n.addChild(n.bg);var a=new Phaser.Group(game,0,0,null);return n.listRanking=new Vo(game,a,new Phaser.Rectangle(0,0,game.width,game.height-212*n.mainData.scale),{direction:"y",padding:0,searchForClicks:!0}),a.x=0,a.y=102*n.mainData.scale,n.addChild(a),n.bgMe=new rt(n.positionEventMode.ranking_bg_me),n.bgMe.y=game.height-108*n.mainData.scale,n.addChild(n.bgMe),n.txtError=new _t(n.positionEventMode.item_ranking_txt_error,"Bạn chưa có xếp hạng"),n.txtError.setTextBounds(0,0,game.width,38*n.mainData.scale),n.txtError.y=game.height-76*n.mainData.scale,n.addChild(n.txtError),n.txtError.visible=!1,n.rankMe=null,n.header=new BN,n.header.setHelp(),n.header.event.back.add(n.chooseBack,bB(bB(n))),n.addChild(n.header),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wB(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this),TF.instance().events.onExtensionResponse.add(this.getData,this),this.event_id>0?TF.instance().sendData(CM.EVENT_MODE_RANKING_REQUEST,$N.begin(this.event_id)):(qe.instance().hideLoading(),this.chooseBack())}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this),TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case CM.EVENT_MODE_RANKING_RESPONSE:var t=nB.begin(e.params);this.arrRanking=t.arrRanking,this.objRankMe=t.rankMe,this.arrReward=t.arrReward,this.buildRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildRanking",value:function(){var e,t,n,i=3,o=0;this.arrRanking.length<3&&(i=this.arrRanking.length);for(var a=0;a<i;a++){var s=void 0;(s=this.arrReward[a]?new lB(this.arrRanking[a],a,this.arrReward[a]):new lB(this.arrRanking[a],a)).beginTween(o),this.listRanking.add(s),a==i-1&&s.hideLine(),o++}if(e=this.arrReward[3]?new pB("4-10",this.arrReward[3]):new pB("4-10"),this.listRanking.add(e),this.arrRanking.length>3){var r=10;this.arrRanking.length<10&&(r=this.arrRanking.length);for(var l=3;l<r;l++){var h=new lB(this.arrRanking[l],l);h.beginTween(o),this.listRanking.add(h),l==r-1&&h.hideLine(),o++}}if(t=this.arrReward[4]?new pB("11-50",this.arrReward[4]):new pB("11-50"),this.listRanking.add(t),this.arrRanking.length>10){var c=50;this.arrRanking.length<50&&(c=this.arrRanking.length);for(var u=10;u<c;u++){var d=new lB(this.arrRanking[u],u);d.beginTween(o),this.listRanking.add(d),u==c-1&&d.hideLine(),o++}}if(n=this.arrReward[5]?new pB("51-100",this.arrReward[5]):new pB("51-100"),this.listRanking.add(n),this.arrRanking.length>50){var f=100;this.arrRanking.length<100&&(f=this.arrRanking.length);for(var p=50;p<f;p++){var g=new lB(this.arrRanking[p],p);g.beginTween(),this.listRanking.add(g),p==f-1&&g.hideLine()}}this.objRankMe.position>0?(this.removeRankMe(),this.objRankMe.user_name=TF.instance().dataMySeft.user_name,this.objRankMe.avatar=TF.instance().dataMySeft.avatar,this.objRankMe.position<4&&this.arrReward[this.objRankMe.position-1]?this.rankMe=new lB(this.objRankMe,this.objRankMe.position-1,this.arrReward[this.objRankMe.position-1],!0):this.rankMe=new lB(this.objRankMe,this.objRankMe.position-1,null,!0),this.rankMe.x=0,this.rankMe.y=game.height-112*this.mainData.scale,this.addChild(this.rankMe)):this.txtError.visible=!0}},{key:"chooseBack",value:function(){this.event.back.dispatch()}},{key:"destroy",value:function(){this.listRanking.removeAll(),this.listRanking.destroy(),mB(vB(t.prototype),"destroy",this).call(this)}}])&&yB(n.prototype,i),o&&yB(n,o),t}();function SB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var EB=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e,t,n,i,o,a){console.log("answer_time : "+o);var s=new SFS2X.SFSObject;return s.putInt("answer_index",e),s.putInt("correct_answer",t),s.putInt("question_index",n),s.putBool("is_loaded_next_question",i),s.putFloat("answer_time",o),s.putBool("is_correct_answer",a),s}}],(n=null)&&SB(t.prototype,n),i&&SB(t,i),e}();function CB(e){return(CB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function PB(e,t){return!t||"object"!==CB(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function OB(e){return(OB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function RB(e,t){return(RB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xB=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=PB(this,OB(t).call(this,game,0,0,null))).event={complete:new Phaser.Signal},e.tweenSpriteTime=null,e.positionEventMode=e.mainData.positionEventMode,e.loading=new rt(e.positionEventMode.playroom_loading_time_question),e.loading.width=0,e.addChild(e.loading),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RB(e,t)}(t,Mt),n=t,(i=[{key:"addTween",value:function(){this.loading.width=0,this.stopTween(),this.tweenSpriteTime=game.add.tween(this.loading).to({width:570*z.instance().scale},1e4,"Linear"),this.tweenSpriteTime.onComplete.add(this.onComplete,this),this.tweenSpriteTime.start()}},{key:"onComplete",value:function(){this.event.complete.dispatch()}},{key:"getTime",value:function(){return console.log("getTime----------"),console.log(this.tweenSpriteTime),console.log(this.tweenSpriteTime.timeline[0].dt),null!==this.tweenSpriteTime?this.tweenSpriteTime.timeline[0].dt/1e3:0}},{key:"stopTween",value:function(){null!==this.tweenSpriteTime&&(this.tweenSpriteTime.stop(),this.tweenSpriteTime.onComplete.remove(this.onComplete,this))}}])&&kB(n.prototype,i),o&&kB(n,o),t}();function TB(e){return(TB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AB(e){return(AB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function LB(e,t){return(LB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function GB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var DB=function(e){function t(){var e,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=AB(t).call(this,game,0,0,null))||"object"!==TB(i)&&"function"!=typeof i?GB(n):i).event={show_loading:new Phaser.Signal,hide_loading:new Phaser.Signal,next_question:new Phaser.Signal,fail_question:new Phaser.Signal},e.data=null,e.idx=0,e.idxLoad=0,e.ktSend=!0,e.ktSendNexQuestion=!1,e.positionEventMode=e.mainData.positionEventMode,e.txtNumber=new _t(e.positionEventMode.playroom_text_number_question,""),e.txtNumber.setTextBounds(0,0,game.width,31*z.instance().scale),e.addChild(e.txtNumber),e.txtDes=new _t(e.positionEventMode.playroom_text_des_question,""),e.txtDes.setTextBounds(0,0,game.width,30*z.instance().scale),e.addChild(e.txtDes);var o=new Phaser.Group(game,0,0,null);e.listAnswer=new Vo(game,o,new Phaser.Rectangle(0,0,game.width,500*z.instance().scale),{direction:"y",padding:15*z.instance().scale,searchForClicks:!0}),o.y=89*z.instance().scale,e.addChild(o),e.arrAnswer=[],e.listAnswer.removeAll(),e.listAnswer.reset(),LogConsole.log("answr----------------------------------");for(var a=0;a<4;a++){var s=new iI(e.chooseAnswer,GB(GB(e)));s.inputEnabled=!1;var r=(game.width-s.width)/2;s.x=r,s.setConstX(r),s.visible=!1,e.arrAnswer.push(s)}return LogConsole.log("end----------------------------------"),e.loadingQuestion=new xB,e.loadingQuestion.event.complete.add(e.timeCompelte,GB(GB(e))),e.loadingQuestion.x=35*z.instance().scale,e.loadingQuestion.y=80*z.instance().scale,e.addChild(e.loadingQuestion),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&LB(e,t)}(t,Mt),n=t,(i=[{key:"setIdxLoad",value:function(e){this.idxLoad=e,console.log("setIdxLoad ----------- : "+this.idxLoad),console.log("this.ktSendNexQuestion : "+this.ktSendNexQuestion),!0===this.ktSendNexQuestion&&(this.ktSendNexQuestion=!1,this.event.next_question.dispatch())}},{key:"timeCompelte",value:function(){if(!1===this.ktSend){this.ktSend=!0;for(var e=0;e<this.arrAnswer.length;e++)this.arrAnswer[e].setTextNoChoose();var t=this.data.correct_answer;this.arrAnswer[t-1].setTrueText();TF.instance().sendData(CM.EVENT_MODE_USER_SELECTED_ANSWER_REQUEST,EB.begin(0,t,this.idx+1,!0,10,!1)),this.event.fail_question.dispatch()}}},{key:"showQuestion",value:function(){for(var e=0;e<this.arrAnswer.length;e++)this.arrAnswer[e].visible=!0,this.arrAnswer[e].inputEnabled=!0,this.listAnswer.add(this.arrAnswer[e])}},{key:"chooseAnswer",value:function(e){if(!1===this.ktSend){this.ktSend=!0;var t=this.loadingQuestion.getTime();console.log("answer_time : "+t);var n=!1;this.loadingQuestion.stopTween();for(var i=0;i<this.arrAnswer.length;i++)this.arrAnswer[i].setTextNoChoose();var o=this.data.correct_answer,a=e.getIdx()+1;a==o?(e.setTrueText(),n=!0,ce.instance().playSound(ce.streakanswer)):(e.setFailText(),n=!1,this.arrAnswer[o-1].setTrueText());var s=!1;this.ktSendNexQuestion=!0,this.idx+1<this.idxLoad&&(s=!0,this.ktSendNexQuestion=!1),TF.instance().sendData(CM.EVENT_MODE_USER_SELECTED_ANSWER_REQUEST,EB.begin(a,o,this.idx+1,s,t,n)),!0===n?this.event.next_question.dispatch():this.event.fail_question.dispatch()}}},{key:"buildQuestionByIndex",value:function(e,t){this.ktSendNexQuestion=!1,LogConsole.log("buildQuestionByIndex - "+e),LogConsole.log(t),this.idx=e,this.data=t,this.ktSend=!1,this.loadingQuestion.addTween(),El.instance().playsound(this.data.file_path),this.txtNumber.text="Câu "+(e+1);var n="";"SONG"==t.question_type?n="Tìm tên bài hát":"SINGER"==t.question_type&&(n="Tìm tên ca sĩ"),this.txtDes.text=n;for(var i=0;i<this.data.arrAnser.length;i++)this.arrAnswer[i].setData(this.data.arrAnser[i],i)}},{key:"destroy",value:function(){this.loadingQuestion.event.complete.remove(this.timeCompelte,this),El.instance().removeSound(),this.removeAllItem()}}])&&IB(n.prototype,i),o&&IB(n,o),t}();function MB(e){return(MB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function BB(e){return(BB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jB(e,t){return(jB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function UB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ZB=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=BB(t).call(this,game,0,0,null))||"object"!==MB(i)&&"function"!=typeof i?UB(n):i).event={change_local_me:new Phaser.Signal,fail_question:new Phaser.Signal,done_game:new Phaser.Signal,cancle_bad_connect:new Phaser.Signal},e.arrQuestion=[],e.idxLoad=0,e.ktLoad=!1,e.ktFist=!0,e.ktEvendEnd=!1,e.idxNextQuestion=null,e.idBadConnect=null,e.idxQuestion=0,e.loading=null,e.badConnect=null,e.remaining_question_number=0,e.question=new DB,e.question.event.next_question.add(e.buildNextQuestionUser,UB(UB(e))),e.question.event.fail_question.add(e.buildFailQuestionUser,UB(UB(e))),e.question.event.show_loading.add(e.addLoading,UB(UB(e))),e.question.event.hide_loading.add(e.removeLoading,UB(UB(e))),e.question.y=game.height-591*z.instance().scale,e.addChild(e.question),El.instance().removeAllSound(),e.addLoading(),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jB(e,t)}(t,Mt),n=t,(i=[{key:"addLoading",value:function(){this.removeLoading(),this.loading=new Fe,this.addChild(this.loading)}},{key:"removeLoading",value:function(){null!==this.loading&&(this.removeChild(this.loading),this.loading.destroy(),this.loading=null)}},{key:"loadStart",value:function(){LogConsole.log("loadStart----------")}},{key:"onFileComplete",value:function(e,t,n,i,o){LogConsole.log("onFileComplete ----------")}},{key:"loadComplete",value:function(){LogConsole.log("loadComplete---------- : "+this.idxLoad),this.idxLoad++,this.idxLoad<this.arrQuestion.length?(this.beginLoad(),!0===this.ktFist&&(li.instance().playEventMode(),this.ktFist=!1,this.removeIdBadConnect(),this.idxQuestion=0,this.question.showQuestion(),this.buildNextQuestion(),this.removeLoading())):this.ktLoad=!1}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),El.instance().event.loadComplete.add(this.loadComplete,this)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),El.instance().event.loadComplete.remove(this.loadComplete,this),this.question.event.next_question.remove(this.buildNextQuestionUser,this),this.question.event.fail_question.remove(this.buildFailQuestionUser,this),this.question.event.show_loading.remove(this.addLoading,this),this.question.event.hide_loading.remove(this.removeLoading,this)}},{key:"getData",value:function(e){switch(e.cmd){case CM.EVENT_MODE_QUESTION_RESPONSE:this.addDataQuestion(e.params);break;case CM.EVENT_MODE_START_GAME:this.idxQuestion=e.params.getInt(Ir.question_index)-1,this.question.showQuestion(),this.buildNextQuestion();break;case CM.EVENT_MODE_MOVE_TO_NEXT_QUESTION:this.removeLoading(),this.idxQuestion=e.params.getInt(Ir.question_index)-1,this.removeNextQuestion(),this.idxNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.buildNextQuestion,this);break;case CM.EVENT_MODE_EVENT_ENDED:this.ktEvendEnd=!0}}},{key:"removeNextQuestion",value:function(){null!==this.idxNextQuestion&&game.time.events.remove(this.idxNextQuestion)}},{key:"buildFailQuestionUser",value:function(){!1===this.ktEvendEnd&&this.event.fail_question.dispatch(this.idxQuestion)}},{key:"removeIdBadConnect",value:function(){null!==this.idBadConnect&&game.time.events.remove(this.idBadConnect)}},{key:"addShowBadConnect",value:function(){this.removeShowBadConnect(),this.badConnect=new r_,this.badConnect.setTextOk("CHƠI TIẾP"),this.badConnect.setTextCancle("QUAY LẠI"),this.badConnect.event.OK.add(this.chooseOkBadConnect,this),this.badConnect.event.CANCLE.add(this.chooseCancleBadConnect,this),this.badConnect.setTextConfirm("Bạn có muốn chơi tiếp không?"),this.addChild(this.badConnect)}},{key:"chooseOkBadConnect",value:function(){this.removeShowBadConnect(),this.removeIdBadConnect(),this.idBadConnect=game.time.events.add(10*Phaser.Timer.SECOND,this.addShowBadConnect,this)}},{key:"chooseCancleBadConnect",value:function(){TF.instance().sendData(CM.EVENT_MODE_USER_DONE_GAME_REQUEST,null),this.event.cancle_bad_connect.dispatch()}},{key:"removeShowBadConnect",value:function(){null!==this.badConnect&&(this.removeChild(this.badConnect),this.badConnect.destroy(),this.badConnect=null)}},{key:"buildNextQuestionUser",value:function(){this.idxQuestion++,console.log("buildNextQuestionUser : "+this.idxQuestion),console.log("idxLoad : "+this.idxLoad),0===this.remaining_question_number&&this.idxQuestion===this.arrQuestion.length?(TF.instance().sendData(CM.EVENT_MODE_USER_DONE_GAME_REQUEST,null),this.event.done_game.dispatch()):this.idxQuestion<this.idxLoad?(this.removeLoading(),this.removeIdBadConnect(),this.removeNextQuestion(),this.removeShowBadConnect(),this.idxNextQuestion=game.time.events.add(1*Phaser.Timer.SECOND,this.buildNextQuestion,this)):(this.idxQuestion--,this.addLoading(),this.removeIdBadConnect(),this.idBadConnect=game.time.events.add(10*Phaser.Timer.SECOND,this.addShowBadConnect,this))}},{key:"buildNextQuestion",value:function(){if(this.arrQuestion[this.idxQuestion]){var e=this.idxQuestion-4;e>-1&&El.instance().removeSoundFromUrl(this.arrQuestion[e].file_path),this.event.change_local_me.dispatch(this.idxQuestion+1),this.question.buildQuestionByIndex(this.idxQuestion,this.arrQuestion[this.idxQuestion])}else IE.instance().addDialog("Vượt quá câu hỏi nhận được")}},{key:"addDataQuestion",value:function(e){var t=e.getSFSArray(Qh.questions);this.remaining_question_number=e.getInt("remaining_question_number");for(var n=0;n<t.size();n++){var i=t.getSFSObject(n),o=new Bx;o.file_path=i.getUtfString(Qh.file_path),o.question_type=i.getUtfString(Qh.question_type),o.correct_answer=i.getInt(Qh.correct_answer),o.arrAnser.push(i.getUtfString(Qh.answer1)),o.arrAnser.push(i.getUtfString(Qh.answer2)),o.arrAnser.push(i.getUtfString(Qh.answer3)),o.arrAnser.push(i.getUtfString(Qh.answer4));var a=i.getSFSObject(Qh.song);o.song=Wh.getSongDetail(a),o.song.listenLink=o.file_path,this.arrQuestion.push(o)}!1===this.ktLoad&&this.beginLoad()}},{key:"beginLoad",value:function(){LogConsole.log("this.idxLoad : "+this.idxLoad),LogConsole.log("arrQuestion : "+this.arrQuestion.length),this.ktLoad=!0,this.question.setIdxLoad(this.idxLoad),El.instance().loadSound(this.arrQuestion[this.idxLoad].file_path),!0===this.ktFist&&(this.removeIdBadConnect(),this.idBadConnect=game.time.events.add(10*Phaser.Timer.SECOND,this.addShowBadConnect,this))}},{key:"destroy",value:function(){this.removeEvent(),this.removeAllItem(),this.removeIdBadConnect(),this.removeNextQuestion(),El.instance().removeAllSound()}}])&&NB(n.prototype,i),o&&NB(n,o),t}();function HB(e){return(HB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function VB(e,t,n){return(VB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WB(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function WB(e){return(WB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qB(e,t){return(qB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function KB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var zB=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=WB(t).call(this,game,0,0,null))||"object"!==HB(i)&&"function"!=typeof i?KB(n):i).event={backToSelect:new Phaser.Signal,end_game:new Phaser.Signal,done_game:new Phaser.Signal,cancle_bad_connect:new Phaser.Signal},e.dataEvent=Object.assign({},new Ys,o),e.bg=new Phaser.Button(game,0,0,"bg_create_room"),e.addChild(e.bg),e.header=new SM,e.header.setTitle(e.dataEvent.name),e.header.setHideBack(),e.header.setHideTrophy(),e.addChild(e.header),e.map=new tN(e.dataEvent),game.height>1136?e.map.y=50*z.instance().scale+(game.height-1136)/2:e.map.y=50*z.instance().scale,e.addChild(e.map),e.question=new ZB,e.question.event.cancle_bad_connect.add(e.cancleBadConnect,KB(KB(e))),e.question.event.fail_question.add(e.failQuestion,KB(KB(e))),e.question.event.done_game.add(e.doneQuestion,KB(KB(e))),e.question.event.change_local_me.add(e.changeLocalMe,KB(KB(e))),e.addChild(e.question),Le.instance().logEvent(Le.Event_mode_play),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qB(e,t)}(t,Mt),n=t,(i=[{key:"doneQuestion",value:function(){this.event.done_game.dispatch()}},{key:"failQuestion",value:function(e){this.event.end_game.dispatch(e)}},{key:"changeLocalMe",value:function(e){this.map.changeLocalMe(e)}},{key:"cancleBadConnect",value:function(){this.event.cancle_bad_connect.dispatch()}},{key:"chooseTrophy",value:function(){}},{key:"chooseBack",value:function(){}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().events.onUserExitRoom.add(this.userExitRoom,this),TF.instance().sendData(CM.EVENT_MODE_PLAY_GAME_REQUEST,null)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),TF.instance().events.onUserExitRoom.remove(this.userExitRoom,this),this.question.event.cancle_bad_connect.remove(this.cancleBadConnect,this),this.question.event.fail_question.remove(this.failQuestion,this),this.question.event.done_game.remove(this.doneQuestion,this),this.question.event.change_local_me.remove(this.changeLocalMe,this)}},{key:"getData",value:function(e){switch(e.cmd){case CM.EVENT_MODE_START_GAME:Le.instance().logEvent(Le.pro_quiz_start_eventmode),li.instance().playEventMode(),this.question.removeLoading()}}},{key:"userExitRoom",value:function(e){e.room.isGame&&e.user.isItMe&&this.event.backToSelect.dispatch()}},{key:"destroy",value:function(){El.instance().removeAllSound(),this.removeEvent(),this.removeAllItem(),VB(WB(t.prototype),"destroy",this).call(this)}}])&&QB(n.prototype,i),o&&QB(n,o),t}();function YB(e){return(YB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JB(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function XB(e){return(XB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $B(e,t){return($B=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ej(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var tj=function(e){function t(){var e,n,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=XB(t).call(this,game,0,0,null))||"object"!==YB(i)&&"function"!=typeof i?ej(n):i).event={exit:new Phaser.Signal,continute:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.popup=new $i,e.popup.setHeight(350*z.instance().scale),e.popup.x=0,e.popup.y=89*z.instance().scale,e.addChild(e.popup),e.icon=new rt(e.positionPopup.popup_icon_emo_win),e.icon.x=e.popup.x+(e.popup.width-e.icon.width)/2,e.icon.y=0,e.addChild(e.icon),e.txtChucMung=new _t(e.positionPopup.popup_win_event_text_chucmung,"CHÚC MỪNG BẠN!!!"),e.txtChucMung.setTextBounds(0,0,e.popup.width,57*z.instance().scale),e.addChild(e.txtChucMung),e.txtCountQuestion=new _t(e.positionPopup.popup_win_event_text_count_question,"Bạn đã trả lời được "+o+" câu hỏi"),e.txtCountQuestion.addColor("#ffa33a",20),e.txtCountQuestion.addColor("#000000",20+o.toString().length),e.txtCountQuestion.setTextBounds(0,0,e.popup.width,34*z.instance().scale),e.addChild(e.txtCountQuestion),e.btnExit=new ln(e.positionPopup.popup_win_event_button_exit,"THOÁT",e.chooseExit,ej(ej(e))),e.addChild(e.btnExit),e.btnContinute=new ln(e.positionPopup.popup_win_event_button_continute,"CHƠI TIẾP  -1",e.chooseContinute,ej(ej(e))),e.addChild(e.btnContinute),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$B(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch()}},{key:"chooseContinute",value:function(){TF.instance().dataMySeft.ticket<1?(IE.instance().addDialogConfirnTicket("Bạn không đủ vé để tham giá sự kiện. Bạn có muốn mua thêm vé?"),this.chooseExit()):this.event.continute.dispatch()}}])&&JB(n.prototype,i),o&&JB(n,o),t}();function nj(e){return(nj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ij(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oj(e){return(oj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aj(e,t){return(aj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var rj=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=oj(t).call(this,game,0,0,null))||"object"!==nj(a)&&"function"!=typeof a?sj(o):a).event={exit:new Phaser.Signal,continute:new Phaser.Signal},i.positionPopup=i.mainData.positionPopup,i.bg=new Phaser.Button(game,0,0,"screen-dim"),i.addChild(i.bg),i.popupWin=new tj(e),i.popupWin.event.exit.add(i.chooseExit,sj(sj(i))),i.popupWin.event.continute.add(i.chooseContinute,sj(sj(i))),i.popupWin.x=35*z.instance().scale,i.popupWin.y=game.height-853*z.instance().scale,i.addChild(i.popupWin),i.time=new nr,i.time.setTimer(n.finish_at),i.time.x=284*z.instance().scale,i.time.y=118*z.instance().scale,i.addChild(i.time),i.countTicket=new ln(i.positionPopup.popup_win_event_count_ticket,TF.instance().dataMySeft.ticket),i.addChild(i.countTicket),ce.instance().playSound(ce.gameovereventmode),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aj(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){LogConsole.log("chooseExit"),this.event.exit.dispatch()}},{key:"chooseContinute",value:function(){LogConsole.log("chooseContinute"),this.event.continute.dispatch()}}])&&ij(n.prototype,i),o&&ij(n,o),t}();function lj(e){return(lj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cj(e){return(cj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uj(e,t){return(uj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var fj=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=cj(t).call(this,game,0,0,null))||"object"!==lj(i)&&"function"!=typeof i?dj(n):i).event={exit:new Phaser.Signal},e.positionPopup=e.mainData.positionPopup,e.popup=new $i,e.popup.setHeight(350*z.instance().scale),e.popup.x=0,e.popup.y=89*z.instance().scale,e.addChild(e.popup),e.icon=new rt(e.positionPopup.popup_icon_emo_done),e.icon.x=e.popup.x+(e.popup.width-e.icon.width)/2,e.icon.y=-67*z.instance().scale,e.addChild(e.icon),e.txtChucMung=new _t(e.positionPopup.popup_win_event_text_chucmung,"BẠN THẬT BÁ ĐẠO"),e.txtChucMung.setTextBounds(0,0,e.popup.width,57*z.instance().scale),e.addChild(e.txtChucMung),e.txtCountQuestion=new _t(e.positionPopup.popup_win_event_text_done,"Chúc mừng bạn đã trả lời được tất cả các câu hỏi"),e.txtCountQuestion.setTextBounds(0,0,474*z.instance().scale,34*z.instance().scale),e.addChild(e.txtCountQuestion),e.btnExit=new ln(e.positionPopup.popup_done_event_button_exit,"THOÁT",e.chooseExit,dj(dj(e))),e.addChild(e.btnExit),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uj(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch()}}])&&hj(n.prototype,i),o&&hj(n,o),t}();function pj(e){return(pj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function yj(e){return(yj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mj(e,t){return(mj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var wj=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=yj(t).call(this,game,0,0,null))||"object"!==pj(o)&&"function"!=typeof o?vj(i):o).event={exit:new Phaser.Signal},n.positionPopup=n.mainData.positionPopup,n.bg=new Phaser.Button(game,0,0,"screen-dim"),n.addChild(n.bg),n.popupWin=new fj,n.popupWin.event.exit.add(n.chooseExit,vj(vj(n))),n.popupWin.x=35*z.instance().scale,n.popupWin.y=game.height-853*z.instance().scale,n.addChild(n.popupWin),n.time=new nr,n.time.setTimer(e.finish_at),n.time.x=266*z.instance().scale,n.time.y=118*z.instance().scale,n.addChild(n.time),n.countTicket=new ln(n.positionPopup.popup_win_event_count_ticket,TF.instance().dataMySeft.ticket),n.addChild(n.countTicket),ce.instance().playSound(ce.popupeventmodeend),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mj(e,t)}(t,Mt),n=t,(i=[{key:"chooseExit",value:function(){this.event.exit.dispatch(),ce.instance().removeSound()}}])&&gj(n.prototype,i),o&&gj(n,o),t}();function bj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _j=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t={event_top_rank_log:{},event:{},event_reward:{}};if(e.containsKey(Ir.event_top_rank_log)){var n=e.getSFSObject(Ir.event_top_rank_log);t.event_top_rank_log.event_id=n.getLong(Ir.event_id),t.event_top_rank_log.top=n.getInt(Ir.top),t.event_top_rank_log.user_id=n.getInt(Ir.user_id),t.event_top_rank_log.created=n.getLong(Ir.created),t.event_top_rank_log.achieved=n.getInt(Ir.achieved),t.event_top_rank_log.id=n.getLong(Ir.id),t.event_top_rank_log.state=n.getUtfString(Ir.state),t.event_top_rank_log.updated=n.getLong(Ir.updated)}if(e.containsKey(Ir.event)){var i=e.getSFSObject(Ir.event);t.event.finish_at=i.getLong(Ir.finish_at),t.event.created=i.getLong(Ir.created),t.event.description=i.getUtfString(Ir.description),t.event.banner=i.getUtfString(Ir.banner),t.event.active=i.getInt(Ir.active),t.event.start_at=i.getLong(Ir.start_at),t.event.event_type=i.getUtfString(Ir.event_type),t.event.name=i.getUtfString(Ir.name),t.event.medal=i.getUtfString(Ir.medal),t.event.id=i.getLong(Ir.id),t.event.state=i.getUtfString(Ir.state),t.event.updated=i.getLong(Ir.updated)}if(e.containsKey(Ir.event_reward)){var o=e.getSFSObject(Ir.event_reward);t.event_reward.diamond=o.getInt(Ir.diamond),t.event_reward.event_id=o.getLong(Ir.event_id),t.event_reward.ticket=o.getInt(Ir.ticket),t.event_reward.event_ranking=o.getUtfString(Ir.event_ranking),t.event_reward.updated=o.getLong(Ir.updated),t.event_reward.support_item=o.getInt(Ir.support_item)}return t}}],(n=null)&&bj(t.prototype,n),i&&bj(t,i),e}();function Sj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var Ej=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new SFS2X.SFSObject;return t.putLong("event_top_rank_log_id",e),t}}],(n=null)&&Sj(t.prototype,n),i&&Sj(t,i),e}();function Cj(e){return(Cj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Pj(e){return(Pj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oj(e,t){return(Oj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var xj=function(e){function t(e){var n,i,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=this,(n=!(o=Pj(t).call(this,game,0,0,null))||"object"!==Cj(o)&&"function"!=typeof o?Rj(i):o).dataEvent=e,n.event={accept_gift:new Phaser.Signal,view_result:new Phaser.Signal,exit:new Phaser.Signal},n.positionEventMode=n.mainData.positionEventMode,n.positionPopup=n.mainData.positionPopup,n.bg=new $i,n.bg.y=198*z.instance().scale,n.bg.setHeight(612*z.instance().scale),n.addChild(n.bg),n.iconTrophy=new Phaser.Sprite(game,0,0,"iconpopupwinevent"),n.iconTrophy.animations.add("iconpopupwinevent"),n.iconTrophy.animations.play("iconpopupwinevent",30,!0),n.iconTrophy.width=526,n.iconTrophy.height=320,n.iconTrophy.x=(n.bg.width-n.iconTrophy.width)/2,n.iconTrophy.y=-50,n.addChild(n.iconTrophy),n.lbKetThuc=new _t(n.positionEventMode.popup_win_text_ketthucsukien,"Kết thúc sự kiện"),n.lbKetThuc.setTextBounds(0,0,n.bg.width,30*z.instance().scale),n.addChild(n.lbKetThuc),n.lbNameEvent=new _t(n.positionEventMode.popup_win_text_name,e.event.name),n.lbNameEvent.setTextBounds(0,0,n.bg.width,46*z.instance().scale),n.addChild(n.lbNameEvent),n.lbChucMung=new _t(n.positionEventMode.popup_win_text_chucmung,"Chúc mừng bạn đã đạt thứ hạng"),n.lbChucMung.setTextBounds(0,0,n.bg.width,30*z.instance().scale),n.addChild(n.lbChucMung),n.lbSTT=new _t(n.positionEventMode.popup_win_text_stt,e.event_top_rank_log.top),n.lbSTT.setTextBounds(0,0,n.bg.width,46*z.instance().scale),n.addChild(n.lbSTT),n.lbPhanThuong=new _t(n.positionEventMode.popup_win_text_phanthuong,"PHẦN THƯỞNG"),n.lbPhanThuong.setTextBounds(0,0,n.bg.width,30*z.instance().scale),n.addChild(n.lbPhanThuong),n.gift=new br(e.event_reward,!0),n.gift.x=(n.bg.width-n.gift.width)/2,n.gift.y=518*z.instance().scale,n.addChild(n.gift),n.btnClose=new pt(n.positionPopup.popup_close_btn_exit,n.chooseClose,Rj(Rj(n))),n.btnClose.x=n.bg.width-n.btnClose.width/2,n.btnClose.y=n.bg.y-n.btnClose.height/3,n.addChild(n.btnClose),n.btnXemKetQua=new ln(n.positionPopup.popup_confirm_button_ok,"XEM KẾT QUẢ",n.chooseCancle,Rj(Rj(n))),n.btnXemKetQua.x=35,n.btnXemKetQua.y=610*z.instance().scale,n.addChild(n.btnXemKetQua),n.btnShare=new ln(n.positionPopup.popup_confirm_button_share,"CHIA SẺ",n.chooseShare,Rj(Rj(n))),n.btnShare.y=610*z.instance().scale,n.addChild(n.btnShare),n.btnNhanthuong=new ln(n.positionPopup.popup_confirm_button_ok_full,"NHẬN THƯỞNG",n.chooseOK,Rj(Rj(n))),n.btnNhanthuong.x=35,n.btnNhanthuong.y=715*z.instance().scale,n.addChild(n.btnNhanthuong),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oj(e,t)}(t,Mt),n=t,(i=[{key:"chooseShare",value:function(){ui.instance().share()}},{key:"chooseOK",value:function(){this.btnNhanthuong.inputEnabled=!1,this.event.accept_gift.dispatch(),TF.instance().sendData(CM.EVENT_MODE_CLAIM_REWARD_REQUEST,Ej.begin(this.dataEvent.event_top_rank_log.id))}},{key:"chooseCancle",value:function(){this.event.view_result.dispatch(this.dataEvent.event.id)}},{key:"chooseClose",value:function(){this.event.exit.dispatch()}}])&&kj(n.prototype,i),o&&kj(n,o),t}();function Tj(e){return(Tj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ij(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Aj(e,t){return!t||"object"!==Tj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lj(e,t,n){return(Lj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Gj(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Gj(e){return(Gj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dj(e,t){return(Dj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Mj=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Aj(this,Gj(t).call(this,game,0,0,null))).data=e,n.event={accept_gift:new Phaser.Signal,view_result:new Phaser.Signal,exit:new Phaser.Signal},n.idxGet=0,n.idShowResult=null,n.positionPopup=n.mainData.positionPopup,n.bg=new Phaser.Button(game,0,0,"screen-dim"),n.addChild(n.bg),n.arrResource=[{type:"spritesheet",link:"img/atlas/IconEventModeWin.png",key:"iconpopupwinevent",width:400,height:243,countFrame:23}],n.loadResource(),n}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dj(e,t)}(t,Yy),n=t,(i=[{key:"loadFileComplete",value:function(){Lj(Gj(t.prototype),"loadFileComplete",this).call(this),this.popupWin=new xj(this.data),this.popupWin.event.exit.add(this.chooseExit,this),this.popupWin.event.accept_gift.add(this.chooseAceptGift,this),this.popupWin.event.view_result.add(this.chooseViewResult,this),this.popupWin.x=35*z.instance().scale,this.popupWin.y=game.height-964*z.instance().scale,this.addChild(this.popupWin),this.scoreDiamond=TF.instance().dataMySeft.diamond,this.btnDiamond=new ln(this.positionPopup.tn_header_item_gem,this.scoreDiamond),this.addChild(this.btnDiamond),this.scoreTicket=TF.instance().dataMySeft.ticket,this.btnTicket=new ln(this.positionPopup.tn_header_item_ticket,this.scoreTicket),this.addChild(this.btnTicket),this.scoreSupportItem=TF.instance().dataMySeft.support_item,this.btnSupportItem=new ln(this.positionPopup.tn_header_item_mic,this.scoreSupportItem),this.addChild(this.btnSupportItem),this.addEvent()}},{key:"addEvent",value:function(){TF.instance().events.onUserVarsUpdate.add(this.onUserVarsUpdate,this)}},{key:"removeEvent",value:function(){TF.instance().events.onUserVarsUpdate.remove(this.onUserVarsUpdate,this)}},{key:"onUserVarsUpdate",value:function(){var e,t=this,n={score:0};this.scoreDiamond<TF.instance().dataMySeft.diamond?(game.tweens.removeFrom(this.btnDiamond),n.score=this.scoreDiamond,this.scoreDiamond=TF.instance().dataMySeft.diamond,console.log("scoreDiamond : "+this.scoreDiamond),(e=game.add.tween(n).to({score:TF.instance().dataMySeft.diamond},500,"Linear",!0,1e3)).start(),e.onUpdateCallback(function(){t.btnDiamond&&t.btnDiamond.setText(parseInt(n.score))},this),e.onComplete.add(function(){t.btnDiamond&&t.btnDiamond.setText(parseInt(t.scoreDiamond))},this),this.addCheckTweenMoney()):this.scoreTicket<TF.instance().dataMySeft.ticket?(game.tweens.removeFrom(this.btnTicket),n.score=this.scoreTicket,this.scoreTicket=TF.instance().dataMySeft.ticket,console.log("scoreTicket : "+this.scoreTicket),(e=game.add.tween(n).to({score:TF.instance().dataMySeft.ticket},500,"Linear",!0,1e3)).start(),e.onUpdateCallback(function(){t.btnTicket&&t.btnTicket.setText(parseInt(n.score))},this),e.onComplete.add(function(){t.btnTicket&&t.btnTicket.setText(parseInt(t.scoreTicket))},this),this.addCheckTweenMoney()):this.scoreSupportItem<TF.instance().dataMySeft.support_item&&(game.tweens.removeFrom(this.btnSupportItem),n.score=this.scoreSupportItem,this.scoreSupportItem=TF.instance().dataMySeft.support_item,console.log("scoreSupportItem : "+this.scoreSupportItem),(e=game.add.tween(n).to({score:TF.instance().dataMySeft.support_item},500,"Linear",!0,1e3)).start(),e.onUpdateCallback(function(){t.btnSupportItem&&t.btnSupportItem.setText(parseInt(n.score))},this),e.onComplete.add(function(){t.btnSupportItem&&t.btnSupportItem.setText(parseInt(t.scoreSupportItem))},this))}},{key:"chooseExit",value:function(){this.event.exit.dispatch(),IE.instance().removeAnimClaimReward(),this.removeShowResult(),this.removeCheckTweenMoney()}},{key:"chooseAceptGift",value:function(){this.idxGet++;var e={resourceType:"SUPPORT_ITEM",reward:0};1===this.idxGet?this.data.event_reward.diamond>0?(e.resourceType="DIAMOND",e.reward=this.data.event_reward.diamond,this.showGetMoney(e)):this.chooseAceptGift():2===this.idxGet?this.data.event_reward.ticket>0?(e.resourceType="TICKET",e.reward=this.data.event_reward.ticket,this.showGetMoney(e)):this.chooseAceptGift():3===this.idxGet?this.data.event_reward.support_item>0?(e.resourceType="SUPPORT_ITEM",e.reward=this.data.event_reward.support_item,this.showGetMoney(e)):this.chooseAceptGift():this.chooseExit()}},{key:"showGetMoney",value:function(e){var t=470*this.mainData.scale,n=45*this.mainData.scale,i="SUPPORT_ITEM";"DIAMOND"===e.resourceType?(i="DIAMOND",t=110*this.mainData.scale,n=45*this.mainData.scale):"TICKET"===e.resourceType?(i="TICKET",t=286*this.mainData.scale,n=45*this.mainData.scale):"SUPPORT_ITEM"===e.resourceType&&(i="SUPPORT_ITEM",t=500*this.mainData.scale,n=45*this.mainData.scale);var o={type:i,reward:e.reward,finishPoint:{x:t,y:n}};IE.instance().changeScreen(Ce.ANIM_CLAIM_REWARD,o),this.removeShowResult(),this.idShowResult=game.time.events.add(2*Phaser.Timer.SECOND,this.chooseAceptGift,this)}},{key:"removeShowResult",value:function(){null!==this.idShowResult&&(game.time.events.remove(this.idShowResult),this.idShowResult=null)}},{key:"addCheckTweenMoney",value:function(){this.removeCheckTweenMoney(),this.idTweenMoney=game.time.events.add(2*Phaser.Timer.SECOND,this.onUserVarsUpdate,this)}},{key:"removeCheckTweenMoney",value:function(){null!==this.idTweenMoney&&(game.time.events.remove(this.idTweenMoney),this.idTweenMoney=null)}},{key:"chooseViewResult",value:function(e){this.event.view_result.dispatch(e),IE.instance().removeAnimClaimReward(),this.removeShowResult(),this.removeCheckTweenMoney()}},{key:"destroy",value:function(){this.removeShowResult(),this.removeCheckTweenMoney(),IE.instance().removeAnimClaimReward(),Lj(Gj(t.prototype),"destroy",this).call(this)}}])&&Ij(n.prototype,i),o&&Ij(n,o),t}();function Nj(e){return(Nj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jj(e,t){return!t||"object"!==Nj(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Uj(e,t,n){return(Uj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fj(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Fj(e){return(Fj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Zj(e,t){return(Zj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Hj=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=jj(this,Fj(t).call(this,game,0,0,null))).event={back:new Phaser.Signal},e.startTime=0,e.endTime=0,e.ktshowBadConnection=!1,e.dataEventRoom=new Ys,e.queueScreen=null,e.selectRoomScreen=null,e.rankingScreen=null,e.playRoomScreen=null,e.dialogWin=null,e.screenBegin="",e.popupTop100=null,e.checkJoinRoom=!1,e.ktPlay=!1,e.arrResource=[{type:"atlas",link:"img/atlas/eventmode.png",key:"eventmode",linkJson:"img/atlas/eventmode.json"},{type:"text",link:"img/config/positionEventMode.json",key:"positionEventMode"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zj(e,t)}(t,Yy),n=t,(i=[{key:"loadFileComplete",value:function(){Uj(Fj(t.prototype),"loadFileComplete",this).call(this),this.addSelectRoomScreen(),this.addEvent()}},{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),TF.instance().events.onRoomJoin.add(this.joinRoom,this),De.instance().event.bad_connection.add(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.add(this.chooseExitBadConnection,this)}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this),TF.instance().events.onRoomJoin.remove(this.joinRoom,this),De.instance().event.bad_connection.remove(this.checkBadConnection,this),De.instance().event.chooseExitBadConnection.remove(this.chooseExitBadConnection,this)}},{key:"checkBadConnection",value:function(){!1===this.ktPlay&&!1===this.ktshowBadConnection&&null!==this.queueScreen&&(this.ktshowBadConnection=!0,IE.instance().addBadConnection())}},{key:"chooseExitBadConnection",value:function(){null!==this.queueScreen?this.queueScreen.chooseBack():this.chooseBack()}},{key:"getData",value:function(e){var t=0;switch(e.cmd){case CM.EVENT_MODE_START_GAME:this.ktPlay=!0,this.startTime=this.getTime();break;case CM.EVENT_MODE_QUESTION_RESPONSE:this.ktPlay=!0;break;case CM.EVENT_MODE_FINISH_GAME:this.ktPlay=!1,this.endTime=this.getTime(),t=parseInt((this.endTime-this.startTime)/1e3),Le.instance().logEvent(Le.play_time,t),Le.instance().logEvent(Le.pro_quiz_end_eventmode),El.instance().removeSound(),game.time.events.add(2*Phaser.Timer.SECOND,this.addDialogFinishGame,this,e.params.getInt(Ir.question_index));break;case CM.EVENT_MODE_DONE_GAME:this.endTime=this.getTime(),t=parseInt((this.endTime-this.startTime)/1e3),Le.instance().logEvent(Le.play_time,t),Le.instance().logEvent(Le.pro_quiz_end_eventmode),game.time.events.add(2*Phaser.Timer.SECOND,this.addDialogDoneGame,this),El.instance().removeSound();break;case CM.EVENT_MODE_REWARD_NOTIFICATION:El.instance().removeSound(),game.time.events.add(.2*Phaser.Timer.SECOND,this.addDialogTop100,this,_j.begin(e.params));break;case CM.EVENT_MODE_EVENT_ENDED:El.instance().removeSound(),game.time.events.add(.4*Phaser.Timer.SECOND,this.addDialogEndGame,this)}}},{key:"joinRoom",value:function(e){LogConsole.log("data.room.isGame : "+e.room.isGame),e.room.isGame?this.checkJoinRoom=!0:this.addSelectRoomScreen()}},{key:"addEventScreen",value:function(){null!==this.rankingScreen&&this.rankingScreen.addEvent(),null!==this.playRoomScreen&&this.playRoomScreen.addEvent(),null!==this.selectRoomScreen&&this.selectRoomScreen.addEvent(),null!==this.queueScreen&&this.queueScreen.addEvent(this.checkJoinRoom)}},{key:"tweenCompleteQueueScreen",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenCompleteQueueScreen,this),this.removeQueueScreen(),this.addEventScreen()}},{key:"tweenCompleteSelectRoomScreen",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenCompleteSelectRoomScreen,this),this.removeSelectRoomScreen(),this.addEventScreen()}},{key:"tweenCompleteRankingScreen",value:function(){Nc.instance().event.tweenComplete.remove(this.tweenCompleteRankingScreen,this),this.removeRankingScreen(),this.addEventScreen()}},{key:"addSelectRoomScreen",value:function(){this.screenBegin="selectroom",this.removeSelectRoomScreen(),this.checkJoinRoom=!1,this.selectRoomScreen=new JN,this.selectRoomScreen.event.view_history.add(this.addRankingScreen,this),this.selectRoomScreen.event.choose_event.add(this.addQueueScreen,this),this.selectRoomScreen.event.back.add(this.chooseBack,this),this.addChild(this.selectRoomScreen),LogConsole.log("this.queueScreen : "+this.queueScreen),null!==this.queueScreen?(Nc.instance().beginSwitch(this.queueScreen,this.selectRoomScreen,!0),Nc.instance().event.tweenComplete.add(this.tweenCompleteQueueScreen,this)):null!==this.rankingScreen?(this.removeRankingScreen(),this.selectRoomScreen.addEvent()):this.selectRoomScreen.addEvent()}},{key:"removeSelectRoomScreen",value:function(){null!==this.selectRoomScreen&&(this.removeChild(this.selectRoomScreen),this.selectRoomScreen.destroy(),this.selectRoomScreen=null)}},{key:"addQueueScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.screenBegin="queue",this.dataEventRoom=Object.assign({},this.dataEventRoom,e),this.removeQueueScreen(),this.queueScreen=new IN(this.dataEventRoom),this.queueScreen.event.ranking.add(this.addRankingScreen,this),this.queueScreen.event.back.add(this.addSelectRoomScreen,this),this.queueScreen.event.play_room.add(this.addPlayRoomScreen,this),this.addChild(this.queueScreen),null!==this.selectRoomScreen?(Nc.instance().beginSwitch(this.selectRoomScreen,this.queueScreen,!1),Nc.instance().event.tweenComplete.add(this.tweenCompleteSelectRoomScreen,this)):null!==this.rankingScreen?(Nc.instance().beginSwitch(this.rankingScreen,this.queueScreen,!0),Nc.instance().event.tweenComplete.add(this.tweenCompleteRankingScreen,this)):null!==this.playRoomScreen?(this.removePlayRoomScreen(),this.queueScreen.addEvent(this.checkJoinRoom)):this.queueScreen.addEvent(this.checkJoinRoom)}},{key:"joinRoomQueue",value:function(){this.checkJoinRoom=!0}},{key:"removeQueueScreen",value:function(){null!==this.queueScreen&&(this.removeChild(this.queueScreen),this.queueScreen.destroy(),this.queueScreen=null)}},{key:"addRankingScreen",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e>0&&(this.event_id=e),this.removeRankingScreen(),this.rankingScreen=new _B(this.event_id),this.rankingScreen.event.back.add(this.chooseBackTop,this),this.addChild(this.rankingScreen),null!==this.queueScreen?(Nc.instance().beginSwitch(this.queueScreen,this.rankingScreen,!1),Nc.instance().event.tweenComplete.add(this.tweenCompleteQueueScreen,this)):null!==this.selectRoomScreen?(this.removeSelectRoomScreen(),this.rankingScreen.addEvent()):null!==this.playRoomScreen?(this.removePlayRoomScreen(),this.rankingScreen.addEvent()):this.rankingScreen.addEvent()}},{key:"chooseBackTop",value:function(){"selectroom"===this.screenBegin?this.addSelectRoomScreen():"queue"===this.screenBegin?this.addQueueScreen():"play"===this.screenBegin&&this.addPlayRoomScreen()}},{key:"removeRankingScreen",value:function(){null!==this.rankingScreen&&(this.removeChild(this.rankingScreen),this.rankingScreen.destroy(),this.rankingScreen=null)}},{key:"addPlayRoomScreen",value:function(){this.screenBegin="play",this.removePlayRoomScreen(),this.playRoomScreen=new zB(this.dataEventRoom),this.playRoomScreen.event.backToSelect.add(this.addSelectRoomScreen,this),this.playRoomScreen.event.end_game.add(this.addDialogFinishGameUser,this),this.playRoomScreen.event.done_game.add(this.addDialogDoneGameUser,this),this.playRoomScreen.event.cancle_bad_connect.add(this.addQueueScreen,this),this.addChild(this.playRoomScreen),null!==this.queueScreen?(Nc.instance().beginSwitch(this.queueScreen,this.playRoomScreen,!1),Nc.instance().event.tweenComplete.add(this.tweenCompleteQueueScreen,this)):this.playRoomScreen.addEvent()}},{key:"addDialogFinishGameUser",value:function(e){this.ktPlay=!1,this.endTime=this.getTime();var t=parseInt((this.endTime-this.startTime)/1e3);Le.instance().logEvent(Le.play_time,t),Le.instance().logEvent(Le.pro_quiz_end_eventmode),El.instance().removeSound(),game.time.events.add(2*Phaser.Timer.SECOND,this.addDialogFinishGame,this,e)}},{key:"addDialogDoneGameUser",value:function(){this.endTime=this.getTime();var e=parseInt((this.endTime-this.startTime)/1e3);Le.instance().logEvent(Le.play_time,e),Le.instance().logEvent(Le.pro_quiz_end_eventmode),game.time.events.add(2*Phaser.Timer.SECOND,this.addDialogDoneGame,this),El.instance().removeSound()}},{key:"removePlayRoomScreen",value:function(){null!==this.playRoomScreen&&(this.removeChild(this.playRoomScreen),this.playRoomScreen.destroy(),this.playRoomScreen=null)}},{key:"addDialogDoneGame",value:function(){this.removePlayRoomScreen(),this.removeDialogFinishGame(),this.dialogWin=new wj(this.dataEventRoom),this.dialogWin.event.exit.add(this.chooseExitDialog,this),this.addChild(this.dialogWin)}},{key:"removeDialogDoneGame",value:function(){}},{key:"addDialogFinishGame",value:function(e){this.removePlayRoomScreen(),this.removeDialogFinishGame(),this.dialogWin=new rj(e,this.dataEventRoom),this.dialogWin.event.exit.add(this.chooseExitDialog,this),this.dialogWin.event.continute.add(this.chooseContinuteDialog,this),this.addChild(this.dialogWin)}},{key:"chooseExitDialog",value:function(){LogConsole.log("chooseExitDialog"),this.removeDialogFinishGame(),this.addQueueScreen()}},{key:"chooseContinuteDialog",value:function(){LogConsole.log("chooseContinuteDialog"),this.removeDialogFinishGame(),this.addPlayRoomScreen()}},{key:"removeDialogFinishGame",value:function(){null!==this.dialogWin&&(this.removeChild(this.dialogWin),this.dialogWin.destroy(),this.dialogWin=null)}},{key:"addDialogTop100",value:function(e){this.removeDialogTop100(),this.popupTop100=new Mj(e),this.popupTop100.event.exit.add(this.removeDialogTop100,this),this.popupTop100.event.view_result.add(this.addRankingScreen,this),this.popupTop100.event.accept_gift.add(this.removeDialogTop100,this),this.addChild(this.popupTop100)}},{key:"removeDialogTop100",value:function(){null!==this.popupTop100&&(this.removeChild(this.popupTop100),this.popupTop100.destroy(),this.popupTop100=null)}},{key:"addDialogEndGame",value:function(){this.removeDialogFinishGame(),this.addSelectRoomScreen(),IE.instance().addDialog("Sự kiện đã kết thúc")}},{key:"chooseBack",value:function(){rF.instance().changeScreen(Ce.MAIN_MENU)}},{key:"destroy",value:function(){this.mainData.positionEventModeData=null,this.removeEvent(),Uj(Fj(t.prototype),"destroy",this).call(this)}}])&&Bj(n.prototype,i),o&&Bj(n,o),t}();function Qj(e){return(Qj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Vj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Wj(e,t,n){return(Wj="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=qj(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function qj(e){return(qj=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Kj(e,t){return(Kj=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zj(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Yj=function(e){function t(){var e,n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,(e=!(i=qj(t).call(this,game,0,0,null))||"object"!==Qj(i)&&"function"!=typeof i?zj(n):i).event={back:new Phaser.Signal,help:new Phaser.Signal},e.positionRanking=e.mainData.positionRanking,e.bg=new rt(e.positionRanking.header_bg),e.addChild(e.bg),e.txtTitle=new _t(e.positionRanking.header_text_title,"BẢNG XẾP HẠNG"),e.txtTitle.setTextBounds(0,0,game.width,31*z.instance().scale),e.addChild(e.txtTitle),e.btnBack=new pt(e.positionRanking.header_button_back,e.chooseBack,zj(zj(e))),e.addChild(e.btnBack),e.btnHelp=new pt(e.positionRanking.header_button_help,e.chooseHelp,zj(zj(e))),e.addChild(e.btnHelp),e.addEvent(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kj(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){De.instance().event.backButton.add(this.chooseBack,this)}},{key:"removeEvent",value:function(){De.instance().event.backButton.remove(this.chooseBack,this)}},{key:"chooseBack",value:function(){this.btnBack.inputEnabled=!1,this.event.back.dispatch()}},{key:"chooseHelp",value:function(){this.event.help.dispatch()}},{key:"destroy",value:function(){this.removeEvent(),Wj(qj(t.prototype),"destroy",this).call(this)}}])&&Vj(n.prototype,i),o&&Vj(n,o),t}();function Jj(e){return(Jj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xj(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function $j(e){return($j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eU(e,t){return(eU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var nU=function(e){function t(e,n){var i,o,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,(i=!(a=$j(t).call(this,game,0,0,null))||"object"!==Jj(a)&&"function"!=typeof a?tU(o):a).event={choose_item:new Phaser.Signal},i.idx=n,i.positionRanking=i.mainData.positionRanking,i.bg=new pt(i.positionRanking.menu_item_active,i.chooseButton,tU(tU(i))),i.bg.x=0,i.bg.y=0,i.bg.alpha=0,i.bg.height=100*z.instance().scale,i.addChild(i.bg),i.txtContent=new _t(i.positionRanking.menu_item_text_content,e),i.bg.width=i.txtContent.width+71*z.instance().scale,i.txtContent.x=(i.bg.width-i.txtContent.width)/2,i.txtContent.y=(i.bg.height-i.txtContent.height)/2,i.addChild(i.txtContent),i.lineActive=new rt(i.positionRanking.menu_item_active),i.lineActive.width=i.bg.width,i.addChild(i.lineActive),i.lineDoc=new rt(i.positionRanking.menu_item_line_doc),i.lineDoc.x=i.bg.width-i.lineDoc.width,i.lineDoc.y=(i.bg.height-i.lineDoc.height)/2,i.addChild(i.lineDoc),i}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eU(e,t)}(t,Mt),n=t,(i=[{key:"hideLineDoc",value:function(){this.lineDoc.visible=!1}},{key:"active",value:function(){this.lineActive.visible=!0,this.txtContent.changeStyle({fill:"#ffffff"})}},{key:"deactive",value:function(){this.lineActive.visible=!1,this.txtContent.changeStyle({fill:"#695782"})}},{key:"chooseButton",value:function(){this.event.choose_item.dispatch(this.idx)}},{key:"getIdx",value:function(){return this.idx}},{key:"width",get:function(){return this.bg.width}},{key:"height",get:function(){return this.bg.height}}])&&Xj(n.prototype,i),o&&Xj(n,o),t}();function iU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var oU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"RANKING_LEVEL_LOAD_REQUEST",get:function(){return"RANKING_LEVEL_LOAD_REQUEST"}},{key:"RANKING_LEVEL_LOAD_RESPONSE",get:function(){return"RANKING_LEVEL_LOAD_RESPONSE"}},{key:"RANKING_DIAMOND_LOAD_REQUEST",get:function(){return"RANKING_DIAMOND_LOAD_REQUEST"}},{key:"RANKING_DIAMOND_LOAD_RESPONSE",get:function(){return"RANKING_DIAMOND_LOAD_RESPONSE"}},{key:"RANKING_TURNBASE_LOAD_REQUEST",get:function(){return"RANKING_TURNBASE_LOAD_REQUEST"}},{key:"RANKING_TURNBASE_LOAD_RESPONSE",get:function(){return"RANKING_TURNBASE_LOAD_RESPONSE"}},{key:"RANKING_ONLINE_LOAD_REQUEST",get:function(){return"RANKING_ONLINE_LOAD_REQUEST"}},{key:"RANKING_ONLINE_LOAD_RESPONSE",get:function(){return"RANKING_ONLINE_LOAD_RESPONSE"}}],(n=null)&&iU(t.prototype,n),i&&iU(t,i),e}();function aU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var sU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"position",get:function(){return"position"}},{key:"top_users",get:function(){return"top_users"}},{key:"diamond",get:function(){return"diamond"}},{key:"user_name",get:function(){return"user_name"}},{key:"created",get:function(){return"created"}},{key:"active",get:function(){return"active"}},{key:"id",get:function(){return"id"}},{key:"avatar",get:function(){return"avatar"}},{key:"updated",get:function(){return"updated"}},{key:"status",get:function(){return"status"}},{key:"level",get:function(){return"level"}},{key:"experience_score",get:function(){return"experience_score"}},{key:"gender",get:function(){return"gender"}},{key:"all_time_high_score",get:function(){return"all_time_high_score"}},{key:"last_login",get:function(){return"last_login"}},{key:"weekly_high_score",get:function(){return"weekly_high_score"}},{key:"count_win",get:function(){return"count_win"}},{key:"rank",get:function(){return"rank"}}],(n=null)&&aU(t.prototype,n),i&&aU(t,i),e}();var rU=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.diamond=0,this.user_name="",this.created=0,this.active=0,this.id=0,this.avatar="",this.updated=0,this.level=0,this.experience_score=0};function lU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var hU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t={position:-1,top_users:[]},n=e.getSFSArray(sU.top_users),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new rU;a.user_name=o.getUtfString(sU.user_name),a.created=o.getLong(sU.created),a.active=o.getInt(sU.active),a.id=o.getInt(sU.id),a.avatar=o.getUtfString(sU.avatar),a.updated=o.getLong(sU.updated),o.containsKey(sU.diamond)&&(a.diamond=o.getInt(sU.diamond)),o.containsKey(sU.level)&&(a.level=o.getInt(sU.level)),o.containsKey(sU.experience_score)&&(a.experience_score=o.getInt(sU.experience_score)),t.top_users.push(a)}return t.position=e.getLong(sU.position),t}}],(n=null)&&lU(t.prototype,n),i&&lU(t,i),e}();function cU(e){return(cU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uU(e,t,n){return(uU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dU(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dU(e){return(dU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pU(e,t,n){return t&&fU(e.prototype,t),n&&fU(e,n),e}function gU(e,t){return(gU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function yU(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var mU=function(e){function t(e,n,i){var o,a,s,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,(o=!(s=dU(t).call(this,game,0,0,null))||"object"!==cU(s)&&"function"!=typeof s?yU(a):s).data=e,o.positionRanking=JSON.parse(game.cache.getText("positionRanking"));var l=0;if(l=i===tF.TOP_DIAMOND?t.DIAMOND:t.LEVEL,o.tween=null,o.idx=n,o.ava=new pc,o.ava.setSize(65*z.instance().scale,65*z.instance().scale),o.ava.x=149*z.instance().scale,o.ava.y=32*z.instance().scale,o.btnMaskAva=new Phaser.Button(game,o.ava.x,o.ava.y,null,o.chooseAva,yU(yU(o))),o.btnMaskAva.width=o.ava.width,o.btnMaskAva.height=o.ava.height,o.addChild(o.btnMaskAva),0===n?(o.bg=new rt(o.positionRanking.item_ranking_bg_top1),o.addChild(o.bg),o.addChild(o.ava),o.bgTopAvata=new rt(o.positionRanking.item_ranking_avatar_top1)):1===n?(o.bg=new rt(o.positionRanking.item_ranking_bg_top2),o.addChild(o.bg),o.addChild(o.ava),o.bgTopAvata=new rt(o.positionRanking.item_ranking_avatar_top2)):2===n?(o.bg=new rt(o.positionRanking.item_ranking_bg_top3),o.addChild(o.bg),o.addChild(o.ava),o.bgTopAvata=new rt(o.positionRanking.item_ranking_avatar_top3)):(o.addChild(o.ava),o.ava.x=137*z.instance().scale,o.ava.y=27*z.instance().scale,o.bgTopAvata=new rt(o.positionRanking.item_ranking_avatar_top4),o.line=new rt(o.positionRanking.item_ranking_line_space),o.addChild(o.line)),o.addChild(o.bgTopAvata),n<3?(o.txtStt=new _t(o.positionRanking.item_ranking_text_top123,n+1),o.txtStt.setTextBounds(0,0,28*z.instance().scale,27*z.instance().scale),o.txtUserName=new _t(o.positionRanking.item_ranking_text_user_name123,o.formatName(e.user_name,15))):(o.txtStt=new _t(o.positionRanking.item_ranking_text_top4,n+1),o.txtUserName=new _t(o.positionRanking.item_ranking_text_user_name4,o.formatName(e.user_name,15))),l===t.DIAMOND)o.btnDiamond=new ln(n<3?o.positionRanking.item_ranking_btn_diamond_top1:o.positionRanking.item_ranking_btn_diamond_top4,e.diamond),o.addChild(o.btnDiamond),o.txtUserName.setTextBounds(0,0,219*z.instance().scale,60*z.instance().scale);else{var h="";i===tF.TOP_LEVEL&&(h=e.level),i!==tF.TOP_TURNBASE&&i!==tF.TOP_ONLINEMODE||(h=e.count_win),o.btnLevel=new ln(n<3?o.positionRanking.item_ranking_btn_level_top:o.positionRanking.item_ranking_btn_level_top4,h),o.addChild(o.btnLevel),o.txtUserName.setTextBounds(0,0,284*z.instance().scale,60*z.instance().scale)}return o.addChild(o.txtStt),o.addChild(o.txtUserName),r?o.ava.setAvatar(e.avatar,0):o.ava.setAvatar(e.avatar,n),!0===r||(n<8?(o.x=game.width,o.tween=game.add.tween(yU(yU(o))).to({x:0},250,Phaser.Easing.Power1,!0,80*(n+1))):o.x=0),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gU(e,t)}(t,Mt),pU(t,null,[{key:"DIAMOND",get:function(){return 0}},{key:"LEVEL",get:function(){return 1}}]),pU(t,[{key:"chooseAva",value:function(){console.log("clickAva"),IE.instance().addUserProfile(this.data.id)}},{key:"removeTween",value:function(){null!==this.tween&&(this.tween.stop(),game.tweens.remove(this.tween),this.tween=null)}},{key:"destroy",value:function(){this.removeTween(),uU(dU(t.prototype),"destroy",this).call(this)}},{key:"width",get:function(){return game.width}},{key:"height",get:function(){return this.idx<3?145*z.instance().scale:127*z.instance().scale}}]),t}();function vU(e){return(vU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function bU(e,t){return!t||"object"!==vU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _U(e,t,n){return(_U="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=SU(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function SU(e){return(SU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function EU(e,t){return(EU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var CU=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=bU(this,SU(t).call(this,game,0,0,null)),qe.instance().showLoading(),e.event={add_item:new Phaser.Signal},e.ktBuild=!1,e.dataRanking={},e.positionRanking=JSON.parse(game.cache.getText("positionRanking")),e.bgRankMe=new rt(e.positionRanking.item_ranking_bg_rank_me),e.bgRankMe.y=game.height-110*e.mainData.scale,e.addChild(e.bgRankMe),e.txtError=new _t(e.positionRanking.item_ranking_txt_error,"Bạn chưa có xếp hạng"),e.txtError.setTextBounds(0,0,game.width,38*z.instance().scale),e.txtError.y=game.height-76*e.mainData.scale,e.addChild(e.txtError),e.txtError.visible=!1,e.rankMe=null,e.arrRanking=[],e.idDelay=null,e.idx=0,e.countItem=0,Le.instance().logEvent(Le.Ranking_level),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&EU(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataServer.dataRankingLevel?TF.instance().sendData(oU.RANKING_LEVEL_LOAD_REQUEST,null):(this.dataRanking=this.mainData.dataServer.dataRankingLevel,this.buildListRanking(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case oU.RANKING_LEVEL_LOAD_RESPONSE:this.dataRanking=hU.begin(e.params),this.mainData.dataServer.dataRankingLevel=this.dataRanking,this.buildListRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildListRanking",value:function(){this.arrRanking=this.dataRanking.top_users;var e=this.dataRanking.position;if(e>-1){this.txtError.visible=!1,this.removeRankMe();var t=new rU;t.id=TF.instance().dataMySeft.id,t.user_name=TF.instance().dataMySeft.user_name,t.avatar=TF.instance().dataMySeft.avatar,t.diamond=TF.instance().dataMySeft.diamond,t.level=TF.instance().dataMySeft.level,this.rankMe=new mU(t,e-1,tF.TOP_LEVEL,!0),this.rankMe.x=0,this.rankMe.y=game.height-108*z.instance().scale,this.addChild(this.rankMe)}else this.txtError.visible=!0;this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrRanking.length;e++){var t=new mU(this.arrRanking[e],e,tF.TOP_LEVEL);if(this.event.add_item.dispatch(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrRanking.length){this.ktBuild=!1;break}this.idx===this.arrRanking.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),_U(SU(t.prototype),"destroy",this).call(this)}}])&&wU(n.prototype,i),o&&wU(n,o),t}();function kU(e){return(kU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function PU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function OU(e,t){return!t||"object"!==kU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function RU(e,t,n){return(RU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=xU(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function xU(e){return(xU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function TU(e,t){return(TU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var IU=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=OU(this,xU(t).call(this,game,0,0,null)),qe.instance().showLoading(),e.event={add_item:new Phaser.Signal},e.ktBuild=!1,e.positionRanking=e.mainData.positionRanking,e.dataRanking={},e.arrRanking=[],e.idDelay=null,e.idx=0,e.countItem=0,e.bgRankMe=new rt(e.positionRanking.item_ranking_bg_rank_me),e.bgRankMe.y=game.height-110*e.mainData.scale,e.addChild(e.bgRankMe),e.txtError=new _t(e.positionRanking.item_ranking_txt_error,"Bạn chưa có xếp hạng"),e.txtError.setTextBounds(0,0,game.width,38*z.instance().scale),e.txtError.y=game.height-76*e.mainData.scale,e.addChild(e.txtError),e.txtError.visible=!1,e.rankMe=null,Le.instance().logEvent(Le.Ranking_diamond),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&TU(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataServer.dataRankingDiamond?TF.instance().sendData(oU.RANKING_DIAMOND_LOAD_REQUEST,null):(this.dataRanking=this.mainData.dataServer.dataRankingDiamond,this.buildListRanking(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case oU.RANKING_DIAMOND_LOAD_RESPONSE:this.dataRanking=hU.begin(e.params),this.mainData.dataServer.dataRankingDiamond=this.dataRanking,this.buildListRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildListRanking",value:function(){this.arrRanking=this.dataRanking.top_users;var e=this.dataRanking.position;if(e>-1){this.txtError.visible=!1,this.removeRankMe();var t=new rU;t.id=TF.instance().dataMySeft.id,t.user_name=TF.instance().dataMySeft.user_name,t.avatar=TF.instance().dataMySeft.avatar,t.diamond=TF.instance().dataMySeft.diamond,this.rankMe=new mU(t,e-1,tF.TOP_DIAMOND,!0),this.rankMe.x=0,this.rankMe.y=game.height-108*z.instance().scale,this.addChild(this.rankMe)}else this.txtError.visible=!0;this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrRanking.length;e++){var t=new mU(this.arrRanking[e],e,tF.TOP_DIAMOND);if(this.event.add_item.dispatch(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrRanking.length){this.ktBuild=!1;break}this.idx===this.arrRanking.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),RU(xU(t.prototype),"destroy",this).call(this)}}])&&PU(n.prototype,i),o&&PU(n,o),t}();var AU=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.gender="",this.level=0,this.user_name="",this.all_time_high_score=0,this.last_login=0,this.weekly_high_score=0,this.id=0,this.avatar="",this.count_win=0};function LU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var GU=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){for(var t={position:{rank:-1,count_win:0},top_users:[]},n=e.getSFSArray(sU.top_users),i=0;i<n.size();i++){var o=n.getSFSObject(i),a=new AU;a.gender=o.getUtfString(sU.gender),a.level=o.getInt(sU.level),a.user_name=o.getUtfString(sU.user_name),a.all_time_high_score=o.getInt(sU.all_time_high_score),a.last_login=o.getLong(sU.last_login),a.weekly_high_score=o.getInt(sU.weekly_high_score),a.id=o.getInt(sU.id),a.avatar=o.getUtfString(sU.avatar),a.count_win=o.getLong(sU.count_win),t.top_users.push(a)}var s=e.getSFSObject(sU.position);return s.containsKey(sU.rank)&&(t.position.rank=s.getInt(sU.rank),t.position.count_win=s.getLong(sU.count_win)),t}},{key:"compareCountWin",value:function(e,t){return e.count_win>t.count_win?-1:e.count_win<t.count_win?1:0}}],(n=null)&&LU(t.prototype,n),i&&LU(t,i),e}();function DU(e){return(DU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function MU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function NU(e,t){return!t||"object"!==DU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function BU(e,t,n){return(BU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jU(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function jU(e){return(jU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function UU(e,t){return(UU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var FU=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=NU(this,jU(t).call(this,game,0,0,null)),qe.instance().showLoading(),e.event={add_item:new Phaser.Signal},e.ktBuild=!1,e.dataRanking={},e.positionRanking=JSON.parse(game.cache.getText("positionRanking")),e.bgRankMe=new rt(e.positionRanking.item_ranking_bg_rank_me),e.bgRankMe.y=game.height-110*e.mainData.scale,e.addChild(e.bgRankMe),e.txtError=new _t(e.positionRanking.item_ranking_txt_error,"Bạn chưa có xếp hạng"),e.txtError.setTextBounds(0,0,game.width,38*z.instance().scale),e.txtError.y=game.height-76*e.mainData.scale,e.addChild(e.txtError),e.txtError.visible=!1,console.log(2),e.rankMe=null,e.arrRanking=[],e.idDelay=null,e.idx=0,e.countItem=0,Le.instance().logEvent(Le.Ranking_turnbase),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&UU(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){LogConsole.log("addEvent---------"),TF.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataServer.dataRankingTurnBase?TF.instance().sendData(oU.RANKING_TURNBASE_LOAD_REQUEST,null):(this.dataRanking=this.mainData.dataServer.dataRankingTurnBase,this.buildListRanking(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case oU.RANKING_TURNBASE_LOAD_RESPONSE:console.log("aaa"),this.dataRanking=GU.begin(e.params),this.mainData.dataServer.dataRankingTurnBase=this.dataRanking,this.buildListRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildListRanking",value:function(){this.arrRanking=this.dataRanking.top_users;var e=this.dataRanking.position;if(LogConsole.log(e),e.rank>-1){this.txtError.visible=!1,this.removeRankMe();var t=new AU;t.id=TF.instance().dataMySeft.id,t.avatar=TF.instance().dataMySeft.avatar,t.user_name=TF.instance().dataMySeft.user_name,t.count_win=e.count_win,this.rankMe=new mU(t,e.rank-1,tF.TOP_TURNBASE,!0),this.rankMe.x=0,this.rankMe.y=game.height-108*z.instance().scale,this.addChild(this.rankMe)}else this.txtError.visible=!0;this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrRanking.length;e++){var t=new mU(this.arrRanking[e],e,tF.TOP_TURNBASE);if(this.event.add_item.dispatch(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrRanking.length){this.ktBuild=!1;break}this.idx===this.arrRanking.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),BU(jU(t.prototype),"destroy",this).call(this)}}])&&MU(n.prototype,i),o&&MU(n,o),t}();function ZU(e){return(ZU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function QU(e,t){return!t||"object"!==ZU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function VU(e,t,n){return(VU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WU(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function WU(e){return(WU=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qU(e,t){return(qU=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var KU=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=QU(this,WU(t).call(this,game,0,0,null)),qe.instance().showLoading(),e.event={add_item:new Phaser.Signal},e.ktBuild=!1,e.dataRanking={},e.positionRanking=JSON.parse(game.cache.getText("positionRanking")),e.bgRankMe=new rt(e.positionRanking.item_ranking_bg_rank_me),e.bgRankMe.y=game.height-110*e.mainData.scale,e.addChild(e.bgRankMe),e.txtError=new _t(e.positionRanking.item_ranking_txt_error,"Bạn chưa có xếp hạng"),e.txtError.setTextBounds(0,0,game.width,38*z.instance().scale),e.txtError.y=game.height-76*e.mainData.scale,e.addChild(e.txtError),e.txtError.visible=!1,e.rankMe=null,e.arrRanking=[],e.idDelay=null,e.idx=0,e.countItem=0,Le.instance().logEvent(Le.Ranking_online),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qU(e,t)}(t,Mt),n=t,(i=[{key:"addEvent",value:function(){TF.instance().events.onExtensionResponse.add(this.getData,this),null===this.mainData.dataServer.dataRankingOnlineMode?TF.instance().sendData(oU.RANKING_ONLINE_LOAD_REQUEST,null):(this.dataRanking=this.mainData.dataServer.dataRankingOnlineMode,this.buildListRanking(),qe.instance().hideLoading())}},{key:"removeEvent",value:function(){TF.instance().events.onExtensionResponse.remove(this.getData,this)}},{key:"getData",value:function(e){switch(e.cmd){case oU.RANKING_ONLINE_LOAD_RESPONSE:this.dataRanking=GU.begin(e.params),this.mainData.dataServer.dataRankingOnlineMode=this.dataRanking,this.buildListRanking(),qe.instance().hideLoading()}}},{key:"removeRankMe",value:function(){null!==this.rankMe&&(this.removeChild(this.rankMe),this.rankMe.destroy(),this.rankMe=null)}},{key:"buildListRanking",value:function(){this.arrRanking=this.dataRanking.top_users;var e=this.dataRanking.position;if(LogConsole.log(e),e.rank>-1){this.txtError.visible=!1,this.removeRankMe();var t=new AU;t.id=TF.instance().dataMySeft.id,t.avatar=TF.instance().dataMySeft.avatar,t.user_name=TF.instance().dataMySeft.user_name,t.count_win=e.count_win,this.rankMe=new mU(t,e.rank-1,tF.TOP_ONLINEMODE,!0),this.rankMe.x=0,this.rankMe.y=game.height-108*z.instance().scale,this.addChild(this.rankMe)}else this.txtError.visible=!0;this.removeDelayBuild(),this.idx=0,this.countItem=0,this.buildItemPage()}},{key:"changeIndex",value:function(e){this.countItem===e+1&&!1===this.ktBuild&&this.buildItemPage()}},{key:"buildItemPage",value:function(){this.ktBuild=!0;for(var e=this.idx;e<this.arrRanking.length;e++){var t=new mU(this.arrRanking[e],e,tF.TOP_ONLINEMODE);if(this.event.add_item.dispatch(t),this.idx++,this.countItem++,this.countItem%8==0&&this.idx<this.arrRanking.length){this.ktBuild=!1;break}this.idx===this.arrRanking.length&&(this.ktBuild=!1)}}},{key:"removeDelayBuild",value:function(){null!==this.idDelay&&(game.time.events.remove(this.idDelay),this.idDelay=null)}},{key:"destroy",value:function(){this.removeDelayBuild(),this.removeEvent(),VU(WU(t.prototype),"destroy",this).call(this)}}])&&HU(n.prototype,i),o&&HU(n,o),t}();function zU(e){return(zU="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YU(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function JU(e,t){return!t||"object"!==zU(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function XU(e,t,n){return(XU="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$U(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function $U(e){return($U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eF(e,t){return(eF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tF=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=JU(this,$U(t).call(this,game,0,0,null))).event={back:new Phaser.Signal},e.idEvent=null,e.topLevel=null,e.topDiamond=null,e.topTurnBase=null,e.topOnlineMode=null,e.idEventCanClick,e.tabIdx=n,e.arrTabMenu=[],e.ktAddHelp=!1,e.arrStringTab=["Top Level","Top Đại Gia","Top Chiến Thắng","Top Vô Địch"],e.arrHelp=["Top 100 người có LEVEL cao nhất (cập nhật sau 10 phút)","Top 100 người có số lượng KIM CƯƠNG nhiều nhất (cập nhật sau 10 phút)","Top 100 người có số trận thắng nhiều trong tuần nhất ở thể loại THÁCH ĐẤU (cập nhật sau 10 phút)","Top 100 người có số trận thắng nhiều nhất trong tuần ở thể loại CHƠI NHANH (cập nhật sau 10 phút)"],e.arrResource=[{type:"text",link:"img/config/positionRanking.json",key:"positionRanking"},{type:"atlas",link:"img/atlas/ranking.png",key:"ranking",linkJson:"img/atlas/ranking.json"}],e.loadResource(),e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eF(e,t)}(t,Yy),n=t,o=[{key:"TOP_LEVEL",get:function(){return 0}},{key:"TOP_DIAMOND",get:function(){return 1}},{key:"TOP_TURNBASE",get:function(){return 2}},{key:"TOP_ONLINEMODE",get:function(){return 3}}],(i=[{key:"loadFileComplete",value:function(){XU($U(t.prototype),"loadFileComplete",this).call(this),this.positionRanking=this.mainData.positionRanking,this.bg=new Phaser.Button(game,0,0,"bg_create_room"),this.addChild(this.bg);var e=new Phaser.Group(game,0,0,null);this.listRanking=new Vo(game,e,new Phaser.Rectangle(0,0,game.width,game.height-310*z.instance().scale),{direction:"y",padding:0,searchForClicks:!0}),this.listRanking.events.changeIndex.add(this.changeIndex,this),e.x=0,e.y=200*z.instance().scale,this.addChild(e),this.header=new Yj,this.header.event.back.add(this.backHeader,this),this.header.event.help.add(this.chooseHelp,this),this.addChild(this.header),this.popupHelp=null,this.bgTabMenu=new Zt(this.positionRanking.menu_bg_all),this.addChild(this.bgTabMenu);var n=new Phaser.Group(game,0,0,null);this.listMenu=new Vo(game,n,new Phaser.Rectangle(0,0,game.width,100*z.instance().scale),{direction:"x",padding:0,searchForClicks:!0}),n.x=0,n.y=100*z.instance().scale,this.addChild(n);for(var i=0;i<this.arrStringTab.length;i++){var o=new nU(this.arrStringTab[i],i);o.event.choose_item.add(this.chooseTabMenu,this),i===this.tabIdx?o.active():o.deactive(),i===this.arrStringTab.length-1&&o.hideLineDoc(),this.listMenu.add(o),this.arrTabMenu.push(o)}this.listMenu.tweenToItem(this.tabIdx),this.buildListTop(),ce.instance().playSound(ce.showranking)}},{key:"chooseHelp",value:function(){this.ktAddHelp=!this.ktAddHelp,!0===this.ktAddHelp?this.addPopupHelp():this.removePopupHelp()}},{key:"addPopupHelp",value:function(){this.removePopupHelp(),this.popupHelp=new Kt(this.arrHelp[this.tabIdx]),this.popupHelp.y=83*z.instance().scale,this.popupHelp.x=game.width-this.popupHelp.width-71*z.instance().scale,game.world.add(this.popupHelp)}},{key:"removePopupHelp",value:function(){null!==this.popupHelp&&(game.world.remove(this.popupHelp),this.popupHelp.destroy(),this.popupHelp=null)}},{key:"chooseTabMenu",value:function(e){if(e===this.tabIdx);else{for(var t=0;t<this.arrTabMenu.length;t++){var n=this.arrTabMenu[t];n.getIdx()===e?n.active():n.deactive()}if(e<this.tabIdx){var i=e-1;i<0&&(i=0),this.listMenu.tweenToItem(i)}else{var o=e+1;o>this.arrTabMenu.length-1&&(o=this.arrTabMenu.length-1),this.listMenu.tweenToItem(o)}this.tabIdx=e,this.buildListTop()}}},{key:"buildListTop",value:function(){switch(this.removePopupHelp(),this.ktAddHelp=!1,this.tabIdx){case t.TOP_LEVEL:Le.instance().logEvent(Le.Ranking_level_button),this.addTopLevel();break;case t.TOP_DIAMOND:Le.instance().logEvent(Le.Ranking_diamond_button),this.addTopDiamond();break;case t.TOP_TURNBASE:Le.instance().logEvent(Le.Ranking_turnbase_button),this.addTopTurnBase();break;case t.TOP_ONLINEMODE:Le.instance().logEvent(Le.Ranking_online_button),this.addTopOnlineMode()}this.removeAddEvent(),this.idEvent=game.time.events.add(.2*Phaser.Timer.SECOND,this.addEventAll,this)}},{key:"removeAddEvent",value:function(){null!==this.idEvent&&game.time.events.remove(this.idEvent)}},{key:"removeAll",value:function(){this.listRanking.removeAll(),this.listRanking.reset(),this.removeTopDiamond(),this.removeTopLevel(),this.removeTopOnlineMode(),this.removeTopTurnBase()}},{key:"addEventAll",value:function(){null!==this.topLevel&&this.topLevel.addEvent(),null!==this.topDiamond&&this.topDiamond.addEvent(),null!==this.topTurnBase&&this.topTurnBase.addEvent(),null!==this.topOnlineMode&&this.topOnlineMode.addEvent()}},{key:"addTopLevel",value:function(){this.removeAll(),this.topLevel=new CU,this.topLevel.event.add_item.add(this.addItemRank,this),this.addChild(this.topLevel),this.addChild(this.header)}},{key:"removeTopLevel",value:function(){null!==this.topLevel&&(this.removeChild(this.topLevel),this.topLevel.event.add_item.remove(this.addItemRank,this),this.topLevel.destroy(),this.topLevel=null)}},{key:"addTopDiamond",value:function(){this.removeAll(),this.topDiamond=new IU,this.topDiamond.event.add_item.add(this.addItemRank,this),this.addChild(this.topDiamond),this.addChild(this.header)}},{key:"removeTopDiamond",value:function(){null!==this.topDiamond&&(this.topDiamond.event.add_item.remove(this.addItemRank,this),this.removeChild(this.topDiamond),this.topDiamond.destroy(),this.topDiamond=null)}},{key:"addTopTurnBase",value:function(){this.removeAll(),this.topTurnBase=new FU,this.topTurnBase.event.add_item.add(this.addItemRank,this),this.addChild(this.topTurnBase),this.addChild(this.header)}},{key:"removeTopTurnBase",value:function(){null!==this.topTurnBase&&(this.removeChild(this.topTurnBase),this.topTurnBase.event.add_item.remove(this.addItemRank,this),this.topTurnBase.destroy(),this.topTurnBase=null)}},{key:"addTopOnlineMode",value:function(){this.removeAll(),this.topOnlineMode=new KU,this.topOnlineMode.event.add_item.add(this.addItemRank,this),this.addChild(this.topOnlineMode),this.addChild(this.header)}},{key:"removeTopOnlineMode",value:function(){null!==this.topOnlineMode&&(this.removeChild(this.topOnlineMode),this.topOnlineMode.event.add_item.remove(this.addItemRank,this),this.topOnlineMode.destroy(),this.topOnlineMode=null)}},{key:"changeIndex",value:function(){var e=this.listRanking.getIdx();null!==this.topLevel&&this.topLevel.changeIndex(e),null!==this.topDiamond&&this.topDiamond.changeIndex(e),null!==this.topTurnBase&&this.topTurnBase.changeIndex(e),null!==this.topOnlineMode&&this.topOnlineMode.changeIndex(e)}},{key:"addItemRank",value:function(e){this.listRanking.add(e)}},{key:"backHeader",value:function(){rF.instance().changeScreen(Ce.MAIN_MENU,{})}},{key:"destroy",value:function(){this.mainData.positionRankingData=null,this.listRanking.events.changeIndex.remove(this.changeIndex,this),this.removePopupHelp(),this.removeAddEvent(),this.removeEvent(),this.removeAll(),this.listRanking.removeAll(),this.listRanking.destroy(),XU($U(t.prototype),"destroy",this).call(this)}}])&&YU(n.prototype,i),o&&YU(n,o),t}();function nF(e){return(nF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function oF(e,t){return!t||"object"!==nF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aF(e){return(aF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sF(e,t){return(sF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rF=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=oF(this,aF(t).call(this,game))).screen=null,e}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sF(e,t)}(t,Phaser.Group),n=t,o=[{key:"instance",value:function(){return this.controllScreen||(this.controllScreen=new t),this.controllScreen}}],(i=[{key:"removeScreen",value:function(){null!==this.screen&&(this.removeChild(this.screen),this.screen.destroy(),this.screen=null)}},{key:"changeScreen",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(this.removeScreen(),LogConsole.log(e),z.instance().state=e,qe.instance().showLoading(),IE.instance().removeTextScroll(),e){case Ce.LOGIN:this.screen=new NE;break;case Ce.MAIN_MENU:this.screen=new CR;break;case Ce.ONLINE_MODE:this.screen=new WL,IE.instance().removeAllItem();break;case Ce.QUEST_ACHIEVEMENT:this.screen=new vD(t);break;case Ce.TURN_BASE:this.screen=null!==t?new Qp(t.opponent,t.type,t):new Qp(t,t);break;case Ce.SOLO_MODE:this.screen=new oR(t);break;case Ce.NEW_USER:this.screen=new yM;break;case Ce.EVENT_MODE:this.screen=new Hj;break;case Ce.RANKING_ALL:this.screen=new tF}this.addChild(this.screen)}}])&&iF(n.prototype,i),o&&iF(n,o),t}();function lF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var hF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user_id=0,this.user_name="",this.avatar="",this.gender="",this.experience_score=0,this.heart=0,this.diamond=0,this.ticket=0,this.weekly_high_score=0,this.all_time_high_score=0,this.online_mode_genre=0,this.level=1,this.vip=0,this.is_playing_game=!1,this.support_item=0,this.lag_value=0,this.current_level_score=0,this.next_level_score=0,this.description=""}var t,n,i;return t=e,(n=[{key:"setUserName",value:function(e){this.user_name=e,TF.instance().events.onUserVarsUpdate.dispatch()}},{key:"setGender",value:function(e){this.gender=e,TF.instance().events.onUserVarsUpdate.dispatch()}},{key:"setDescription",value:function(e){this.description=e,TF.instance().events.onUserVarsUpdate.dispatch()}},{key:"setAvatar",value:function(e){this.avatar=e,TF.instance().events.onUserVarsUpdate.dispatch()}}])&&lF(t.prototype,n),i&&lF(t,i),e}();function cF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var uF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"user_id",get:function(){return"user_id"}},{key:"user_name",get:function(){return"user_name"}},{key:"avatar",get:function(){return"avatar"}},{key:"gender",get:function(){return"gender"}},{key:"experience_score",get:function(){return"experience_score"}},{key:"heart",get:function(){return"heart"}},{key:"diamond",get:function(){return"diamond"}},{key:"ticket",get:function(){return"ticket"}},{key:"weekly_high_score",get:function(){return"weekly_high_score"}},{key:"all_time_high_score",get:function(){return"all_time_high_score"}},{key:"online_mode_genre",get:function(){return"online_mode_genre"}},{key:"level",get:function(){return"level"}},{key:"level_up_to",get:function(){return"level_up_to"}},{key:"is_playing_game",get:function(){return"is_playing_game"}},{key:"message",get:function(){return"message"}},{key:"status",get:function(){return"status"}},{key:"support_item",get:function(){return"support_item"}},{key:"lag_value",get:function(){return"lag_value"}},{key:"current_level_score",get:function(){return"current_level_score"}},{key:"next_level_score",get:function(){return"next_level_score"}},{key:"description",get:function(){return"description"}}],(n=null)&&cF(t.prototype,n),i&&cF(t,i),e}();function dF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var fF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"begin",value:function(e){var t=new hF;return t.user_id=e.getVariable(uF.user_id).value,t.user_name=e.getVariable(uF.user_name).value,e.getVariable(uF.avatar)&&(t.avatar=e.getVariable(uF.avatar).value),e.getVariable(uF.gender)&&(t.gender=e.getVariable(uF.gender).value),e.getVariable(uF.experience_score)&&(t.experience_score=e.getVariable(uF.experience_score).value),e.getVariable(uF.heart)&&(t.heart=e.getVariable(uF.heart).value),e.getVariable(uF.diamond)&&(t.diamond=e.getVariable(uF.diamond).value),e.getVariable(uF.ticket)&&(t.ticket=e.getVariable(uF.ticket).value),e.getVariable(uF.weekly_high_score)&&(t.weekly_high_score=e.getVariable(uF.weekly_high_score).value),e.getVariable(uF.all_time_high_score)&&(t.all_time_high_score=e.getVariable(uF.all_time_high_score).value),e.getVariable(uF.online_mode_genre)&&(t.online_mode_genre=e.getVariable(uF.online_mode_genre).value),e.getVariable(uF.level)&&(t.level=e.getVariable(uF.level).value),e.getVariable(uF.is_playing_game)&&(t.is_playing_game=e.getVariable(uF.is_playing_game).value),e.getVariable(uF.support_item)&&(t.support_item=e.getVariable(uF.support_item).value),e.getVariable(uF.lag_value)&&(t.lag_value=e.getVariable(uF.lag_value).value),e.getVariable(uF.description)&&(t.description=e.getVariable(uF.description).value),t}}],(n=null)&&dF(t.prototype,n),i&&dF(t,i),e}();function pF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var gF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"handle",value:function(e){var t=new Lr;if(e.containsKey(Lr.get_quest)){var n=e.getSFSObject("quest");t.reward=n.getInt("reward"),t.id=n.getInt("id"),t.quest=n.getUtfString("quest"),t.required=n.getInt("required"),t.quest_type=n.getInt("quest_type"),t.order=n.getInt("order"),t.reward_type=n.getUtfString("reward_type")}return t}}],(n=null)&&pF(t.prototype,n),i&&pF(t,i),e}();function yF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var mF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"achievement",get:function(){return"achievement"}},{key:"reward",get:function(){return"reward"}},{key:"condition",get:function(){return"condition"}},{key:"achievement_type_id",get:function(){return"achievement_type_id"}},{key:"is_done",get:function(){return"is_done"}},{key:"reward_type",get:function(){return"reward_type"}},{key:"medal",get:function(){return"medal"}},{key:"achieved",get:function(){return"achieved"}},{key:"id",get:function(){return"id"}},{key:"title",get:function(){return"title"}},{key:"required",get:function(){return"required"}}],(n=null)&&yF(t.prototype,n),i&&yF(t,i),e}();function vF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var wF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"handle",value:function(e){var t={reward:0,reward_type:"",condition:0,achievement_type_id:0,is_done:!1,medal:"",achieved:0,id:0,title:"",required:0};if(e.containsKey(mF.achievement)){var n=e.getSFSObject(mF.achievement);t.reward=n.getInt(mF.reward),t.condition=n.getUtfString(mF.condition),t.achievement_type_id=n.getInt(mF.achievement_type_id),t.is_done=n.getBool(mF.is_done),t.reward_type=n.getUtfString(mF.reward_type),t.medal=n.getUtfString(mF.medal),t.achieved=n.getInt(mF.achieved),t.id=n.getInt(mF.id),t.title=n.getUtfString(mF.title),t.required=n.getInt(mF.required)}return t}}],(n=null)&&vF(t.prototype,n),i&&vF(t,i),e}();function bF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var _F=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,i;return t=e,i=[{key:"handle",value:function(e){var t=new dG;if(e.containsKey(dG.get_daily_quest)){var n=e.getSFSObject("daily_quest");t.reward=n.getInt("reward"),t.reward_type=n.getUtfString("reward_type"),t.id=n.getInt("id"),t.quest=n.getUtfString("quest"),t.required=n.getInt("required"),t.quest_type=n.getInt("quest_type")}return t}}],(n=null)&&bF(t.prototype,n),i&&bF(t,i),e}();function SF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var EF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.arrNotify=[],this.isShow=!1,this.textScroll=null,this.idDelayTime=null}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllTextScroller||(this.controllTextScroller=new e),this.controllTextScroller}}],(n=[{key:"addNotify",value:function(e){var t={message:"",show_times:0,pending_time_in_second:0};t.message=e.getUtfString("message"),t.show_times=e.getInt("show_times"),t.pending_time_in_second=e.getInt("pending_time_in_second"),this.arrNotify.push(t),!1===this.isShow&&this.showNotify()}},{key:"showNotify",value:function(){this.arrNotify.length>0&&this.addTextScroll(this.arrNotify[0].message)}},{key:"checkShowNotify",value:function(){this.arrNotify.length>0?(this.arrNotify[0].show_times=this.arrNotify[0].show_times-1,this.arrNotify[0].show_times<1?(this.arrNotify.shift(),this.arrNotify.length>0?this.showNotify():(this.removeTextScroll(),this.isShow=!1)):(this.removeTextScroll(),this.removeDelaytime(),this.idDelayTime=game.time.events.add(Phaser.Timer.SECOND*this.arrNotify[0].pending_time_in_second,this.showNotify,this))):(this.removeTextScroll(),this.isShow=!1)}},{key:"removeDelaytime",value:function(){null!==this.idDelayTime&&(game.time.events.remove(this.idDelayTime),this.idDelayTime=null)}},{key:"addTextScroll",value:function(e){this.isShow=!0,this.removeTextScroll(),this.textScroll=new fb(e),this.textScroll.event.complete.add(this.checkShowNotify,this),Gn.instance().addChild(this.textScroll)}},{key:"removeTextScroll",value:function(){null!==this.textScroll&&(Gn.instance().removeChild(this.textScroll),this.textScroll.destroy(),this.textScroll=null)}}])&&SF(t.prototype,n),i&&SF(t,i),e}();function CF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var kF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.request=null}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllTurnbaseRequestUpdate||(this.controllTurnbaseRequestUpdate=new e),this.controllTurnbaseRequestUpdate}}],(n=[{key:"getUpdate",value:function(e){var t=e.getInt(Mn.user_id),n=e.getUtfString(Mn.user_name),i=e.getUtfString(Mn.avatar),o=e.getSFSObject(Mn.weekly_result),a=o.getInt(Mn.user_won),s=o.getInt(Mn.opponent_won),r=e.getUtfString(Mn.status),l=e.getLong(Mn.updated),h=Bn.formatChallengeGameUpdated(l),c=e.getUtfString(Mn.challenge_msg),u=null,d=0,f=0;"THEIR_TURN"==r?e.containsKey(Mn.can_be_poked)&&(u=e.getInt(Mn.can_be_poked)):"YOUR_TURN"==r&&e.containsKey(Mn.poked)&&(d=e.getInt(Mn.poked),f=e.getLong(Mn.poked_at));var p=e.getInt(Mn.turn_count);return{opponentEntity:{id:t,userName:n,avatar:i,is_online:e.getBool(Mn.is_online)},weeklyResult:{userWon:a,opponentWon:s},turnCount:p,status:r,can_be_poked:u,poked:d,poked_at:f,updated:h,base_updated:l,challenge_request_id:e.getLong(Mn.challenge_request_id),challenge_msg:c}}}])&&CF(t.prototype,n),i&&CF(t,i),e}();function PF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var OF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.quest_log=null}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.controllQuestLogUpdate||(this.controllQuestLogUpdate=new e),this.controllQuestLogUpdate}}],(n=[{key:"getUpdate",value:function(e){var t={};if(e.containsKey("quest_log")){var n=e.getSFSObject("quest_log");t.user_id=n.getInt("user_id"),t.created=n.getLong("created"),t.quest_id=n.getInt("quest_id"),t.id=n.getLong("id"),t.state=n.getUtfString("state"),t.updated=n.getLong("updated")}return t}}])&&PF(t.prototype,n),i&&PF(t,i),e}();function RF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xF(e,t,n){return t&&RF(e.prototype,t),n&&RF(e,n),e}var TF=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.socket=null,this.ktLogin=!1,this.timeBegin=0,this.idPing=null,this.events={onConnection:new Phaser.Signal,onConnectionLost:new Phaser.Signal,onLoginError:new Phaser.Signal,onLogin:new Phaser.Signal,onRoomJoinError:new Phaser.Signal,onRoomJoin:new Phaser.Signal,onPublicMessage:new Phaser.Signal,onPrivateMessage:new Phaser.Signal,onUserEnterRoom:new Phaser.Signal,onUserExitRoom:new Phaser.Signal,onUserCountChange:new Phaser.Signal,onRoomRemove:new Phaser.Signal,onRoomAdd:new Phaser.Signal,onExtensionResponse:new Phaser.Signal,onRoomCreationError:new Phaser.Signal,onRoomVarsUpdate:new Phaser.Signal,onSpectatorToPlayer:new Phaser.Signal,onSpectatorToPlayerError:new Phaser.Signal,onPlayerToSpectator:new Phaser.Signal,onPlayerToSpectatorError:new Phaser.Signal,onUserVarsUpdate:new Phaser.Signal,onGroupSubscribed:new Phaser.Signal,onGroupSubscribedError:new Phaser.Signal,onGroupUnsubscribed:new Phaser.Signal,onGroupUnsubscribedError:new Phaser.Signal,onInvitation:new Phaser.Signal,onInvitationReply:new Phaser.Signal,onInvitationReplyError:new Phaser.Signal,onRoomFindResult:new Phaser.Signal,onAdminMessage:new Phaser.Signal,onModeratorMessage:new Phaser.Signal},this.roomLobby=null,this.ktPlay=!1,this.idxPing=null,this.dataMySeft=null}return xF(e,null,[{key:"instance",value:function(){return this.socketController||(this.socketController=new e),this.socketController}}]),xF(e,[{key:"initListenerSfs",value:function(e){LogConsole.log("initListenerSfs"),this.removeAllEvent(),this.socket=null,this.socket=new SFS2X.SmartFox(e),this.addEvent(SFS2X.SFSEvent.CONNECTION,this.onConnectionCallback),this.addEvent(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLostCallback),this.addEvent(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginErrorCallback),this.addEvent(SFS2X.SFSEvent.LOGIN,this.onLoginCallback),this.addEvent(SFS2X.SFSEvent.LOGOUT,this.onLogoutCallback),this.addEvent(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinErrorCallback),this.addEvent(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoinCallback),this.addEvent(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessageCallback),this.addEvent(SFS2X.SFSEvent.USER_ENTER_ROOM,this.onUserEnterRoomCallback),this.addEvent(SFS2X.SFSEvent.USER_EXIT_ROOM,this.onUserExitRoomCallback),this.addEvent(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponseCallback),this.addEvent(SFS2X.SFSEvent.ROOM_VARIABLES_UPDATE,this.onRoomVarsUpdateCallback),this.addEvent(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVarsUpdateCallback),this.addEvent(SFS2X.SFSEvent.INVITATION,this.onInvitationCallback),this.addEvent(SFS2X.SFSEvent.INVITATION_REPLY,this.onInvitationReplyCallback),this.addEvent(SFS2X.SFSEvent.INVITATION_REPLY_ERROR,this.onInvitationReplyErrorCallback),this.addEvent(SFS2X.SFSEvent.PING_PONG,this.onPingPong),this.callPingServer()}},{key:"removeAllEvent",value:function(){this.removeEvent(SFS2X.SFSEvent.CONNECTION,this.onConnectionCallback),this.removeEvent(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLostCallback),this.removeEvent(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginErrorCallback),this.removeEvent(SFS2X.SFSEvent.LOGIN,this.onLoginCallback),this.removeEvent(SFS2X.SFSEvent.LOGOUT,this.onLogoutCallback),this.removeEvent(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinErrorCallback),this.removeEvent(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoinCallback),this.removeEvent(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessageCallback),this.removeEvent(SFS2X.SFSEvent.USER_ENTER_ROOM,this.onUserEnterRoomCallback),this.removeEvent(SFS2X.SFSEvent.USER_EXIT_ROOM,this.onUserExitRoomCallback),this.removeEvent(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponseCallback),this.removeEvent(SFS2X.SFSEvent.ROOM_VARIABLES_UPDATE,this.onRoomVarsUpdateCallback),this.removeEvent(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVarsUpdateCallback),this.removeEvent(SFS2X.SFSEvent.INVITATION,this.onInvitationCallback),this.removeEvent(SFS2X.SFSEvent.INVITATION_REPLY,this.onInvitationReplyCallback),this.removeEvent(SFS2X.SFSEvent.INVITATION_REPLY_ERROR,this.onInvitationReplyErrorCallback),this.removeEvent(SFS2X.SFSEvent.PING_PONG,this.onPingPong)}},{key:"getTime",value:function(){return(new Date).getTime()}},{key:"callPingServer",value:function(){this.timeBegin=this.getTime(),$.ajax({type:"GET",url:"https://cdn.gamezoka.com/storage/mp3/ping/pong.txt?time="+this.getTime(),data:{},dataType:"json",success:this.successPing.bind(this),error:this.errorPing.bind(this)})}},{key:"successPing",value:function(){this.checkPingServer()}},{key:"errorPing",value:function(){this.checkPingServer()}},{key:"checkPingServer",value:function(){var e=((64e3/((this.getTime()-this.timeBegin)/1e3)).toFixed(2)/1024).toFixed(2),t=((e/1024).toFixed(2),e);null!==this.dataMySeft&&(this.dataMySeft.lag_value=t),this.removeIdBadConnect(),this.idPing=game.time.events.add(2*Phaser.Timer.SECOND,this.callPingServer,this)}},{key:"removeIdBadConnect",value:function(){null!==this.idPing&&game.time.events.remove(this.idPing)}},{key:"onPingPong",value:function(e){}},{key:"onPublicMessageCallback",value:function(e){this.events.onPublicMessage.dispatch(e)}},{key:"onInvitationCallback",value:function(e){LogConsole.log("onInvitation : "+this.dataMySeft.is_playing_game),LogConsole.log(e),LogConsole.log("playScript.playing_guide : "+z.instance().playScript.playing_guide),!0===this.dataMySeft.is_playing_game||z.instance().playScript.playing_guide!==en.DONE_ALL||IE.instance().addDialogInviteFriend(e.invitation),this.events.onInvitation.dispatch(e)}},{key:"onInvitationReplyCallback",value:function(e){this.events.onInvitationReply.dispatch(e)}},{key:"onInvitationReplyErrorCallback",value:function(e){LogConsole.log("onInvitationReplyError"),LogConsole.log(e),LogConsole.log(e.errorMessage),IE.instance().addDialog(e.errorMessage),this.events.onInvitationReplyError.dispatch(e)}},{key:"onRoomVarsUpdateCallback",value:function(e){this.events.onRoomVarsUpdate.dispatch(e)}},{key:"onUserVarsUpdateCallback",value:function(e){e.user.isItMe&&this.updateMySeft(),this.events.onUserVarsUpdate.dispatch(e)}},{key:"onUserEnterRoomCallback",value:function(e){this.events.onUserEnterRoom.dispatch(e)}},{key:"onUserExitRoomCallback",value:function(e){e.room.isGame&&e.user.isItMe&&(this.ktPlay=!1),this.events.onUserExitRoom.dispatch(e)}},{key:"connect",value:function(){LogConsole.log("connect sv"),qe.instance().showLoading(),this.socket.connect()}},{key:"addEvent",value:function(e,t){this.socket.addEventListener(e,t,this)}},{key:"removeEvent",value:function(e,t){null!==this.socket&&this.socket.removeEventListener(e,t,this)}},{key:"onConnectionCallback",value:function(e){this.events.onConnection.dispatch(e),De.instance().event.onConnectServer.dispatch()}},{key:"onConnectionLostCallback",value:function(e){this.roomLobby=null,1==z.instance().LOGED_IN&&(IE.instance().removeAllItem(),Gn.instance().addPopupDisconnect()),this.removeReplayPing(),$r.instance().hide(),this.events.onConnectionLost.dispatch(e)}},{key:"onLoginErrorCallback",value:function(e){LogConsole.log("onLoginErrorCallback-------------------"),LogConsole.log(e),this.events.onLoginError.dispatch(e)}},{key:"onLoginCallback",value:function(e){LogConsole.log("onLoginCallback-------------------"),z.instance().LOGED_IN=!0,LogConsole.log(e),this.socket.enableLagMonitor(!0),this.events.onLogin.dispatch(e)}},{key:"onLogoutCallback",value:function(e){LogConsole.log("onLogoutCallback-------------------"),LogConsole.log(e),z.instance().LOGED_IN=!1,IE.instance().removeAllItem(),qe.instance().showLoading(),Gn.instance().removeAllItem(),z.instance().dataServer.resetDataServer(),Ur.instance().resetData(),this.removeReplayPing(),rF.instance().changeScreen(Ce.LOGIN)}},{key:"updateMySeft",value:function(){null!==this.socket.mySelf&&(this.dataMySeft=fF.begin(this.socket.mySelf))}},{key:"onRoomJoinErrorCallback",value:function(e){LogConsole.log("onRoomJoinErrorCallback-------------------"),LogConsole.log(e),this.events.onRoomJoinError.dispatch(e)}},{key:"onRoomJoinCallback",value:function(e){if(LogConsole.log("onRoomJoinCallback-------------------"),LogConsole.log(e),this.ktLogin=!1,null===this.roomLobby){this.roomLobby=this.socket.lastJoinedRoom,Ur.instance().beginLoadData();var t=new Date,n=t.getDate()+""+(t.getMonth()+1)+t.getFullYear();Mr.instance().removeItem(n);var i=Mr.instance().getItem(n);if("error"===i||null===i||"null"===i){i=1;var o=new Date;o.setDate(t.getDate()-1);var a={id:o.getDate()+""+(o.getMonth()+1)+o.getFullYear()};Br.instance().clearCallback(a)}else i=parseInt(i)+1;if(Mr.instance().setItem(n,i),i>2){var s="Daily"+n,r=Mr.instance().getItem(s);if("error"===r||null===r||"null"===r){var l=new Date;l.setHours(Un.instance().randomNumber(8,20));var h=new Date(l.getTime());h.setDate(t.getDate()+1);var c={id:n,title:"[Wazzat]Phần thường hằng ngày đã sẵn sàng",text:"Hãy nhanh tay nhận phần thưởng",trigger:{at:h}};Br.instance().setLocalPush(c),Mr.instance().setItem(s,!0)}}}var u=e.room;u.isGame?(this.ktPlay=!0,LogConsole.log("mode : "+u.getVariable("mode").value),"OnlineMode"===u.getVariable("mode").value||"OnlineModeRoom"===u.getVariable("mode").value?(LogConsole.log("MainData.instance().state :"+z.instance().state),z.instance().state===Ce.ONLINE_MODE?this.events.onRoomJoin.dispatch(e):(z.instance().dataJoinRoom=e,rF.instance().changeScreen(Ce.ONLINE_MODE))):this.events.onRoomJoin.dispatch(e)):(this.ktPlay=!1,this.events.onRoomJoin.dispatch(e))}},{key:"onExtensionResponseCallback",value:function(e){if("EVENT_MODE_LOAD_DISPLAY_PLAYERS"===e.cmd||"USER_PING"===e.cmd||(LogConsole.log("event.cmd : "+e.cmd),LogConsole.log(e.params.getDump())),"FAILED"===e.params.getUtfString(uF.status))e.cmd===nS.ONLINE_MODE_ROOM_INVITE_RESPONSE||IE.instance().addDialog(e.params.getUtfString(uF.message)),this.events.onExtensionResponse.dispatch(e);else if("WARNING"===e.params.getUtfString(uF.status))e.cmd===Et.CHALLENGE_GAME_GET_PLAYLISTS_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd===Et.CHALLENGE_GAME_FINISH_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd==Et.SOLO_MODE_PLAYLIST_SELECTED_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd==Et.CHALLENGE_GAME_QUESTIONS_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd===nS.ONLINE_MODE_ROOM_INVITE_RESPONSE?this.events.onExtensionResponse.dispatch(e):e.cmd===Et.SOLO_MODE_QUESTION_RESPONSE&&"User has no heart to play practice mode."==e.params.getUtfString(uF.message)?this.events.onExtensionResponse.dispatch(e):(IE.instance().addDialog(e.params.getUtfString(uF.message)),this.events.onExtensionResponse.dispatch(e));else{if(this.events.onExtensionResponse.dispatch(e),e.cmd==Et.QUEST_ACHIEVED_NOTIFICATION&&(LogConsole.log("QUEST_ACHIEVED_NOTIFICATION"),!0!==this.dataMySeft.is_playing_game&&setTimeout(function(){IE.instance().changeScreen(Ce.QUEST_CLAIM_POPUP,gF.handle(e.params))},1e3)),e.cmd==Et.DAILY_QUEST_NOTIFICATION&&!0!==this.dataMySeft.is_playing_game&&setTimeout(function(){IE.instance().addDailyRewardPopup(_F.handle(e.params))},1e3),e.cmd===Et.ACHIEVEMENT_ACHIEVED_NOTIFICATION&&!0!==this.dataMySeft.is_playing_game&&setTimeout(function(){IE.instance().changeScreen(Ce.ACHIEVEMENT_CLAIM_POPUP,wF.handle(e.params))},1e3),e.cmd===Et.ONLINE_ROOM_INVITATION&&!0!==this.dataMySeft.is_playing_game&&!1===Sc.instance().getUserBlock(e.params.getInt("inviter_id"))&&IE.instance().addDialogInviteFriend(e.params,!0),e.cmd===Et.LEVEL_UP_NOTIFICATION?IE.instance().addLevelUp(e.params.getInt(uF.level_up_to)):e.cmd===Hs.SHOP_BUY_PLAYLIST_RESPONSE?IE.instance().addPopupBuyDone(e.params.getInt(qs.playlist_id)):e.cmd===nS.ONLINE_MODE_ROOM_INVITE_RESPONSE||(e.cmd===nS.ONLINE_MODE_ROOM_BE_KICKED?IE.instance().addDialog("Bạn đã bị kích khỏi phòng chơi."):e.cmd===CM.EVENT_MODE_EVENT_START_BROADCAST&&IE.instance().addTextScroll("Sự kiên "+e.params.getSFSObject(Ir.event).getUtfString(Ir.name)+" đã bắt đầu mời các bạn tham gia.")),e.cmd===Et.BROADCASH_NOTIFICATION&&EF.instance().addNotify(e.params),e.cmd===Et.USER_NOTIFICATION&&IE.instance().addDialog(e.params.getUtfString("message")),e.cmd==Et.TURNBASE_CHALLENGE_REQUEST_UPDATE){var t=kF.instance().getUpdate(e.params);if(null!==z.instance().menuOpponentsResponse){var n=z.instance().menuOpponentsResponse.findIndex(function(e){return e.challenge_request_id==t.challenge_request_id});-1==n?z.instance().menuOpponentsResponse.push(t):z.instance().menuOpponentsResponse[n]=t,Bn.filterResponseGames()}}if(e.cmd==Et.QUEST_LOG_UPDATE){var i=OF.instance().getUpdate(e.params);Bn.setQuestLogs(i,Ur.instance().quest_logs)}}}},{key:"addEventExtension",value:function(e,t){this.events.onExtensionResponse.add(e,t)}},{key:"removeEventExtension",value:function(e,t){this.events.onExtensionResponse.remove(e,t)}},{key:"sendPingServer",value:function(){this.removeReplayPing(),this.idxPing=game.time.events.add(10*Phaser.Timer.SECOND,this.sendPingServer,this),this.sendData("USER_PING",null)}},{key:"removeReplayPing",value:function(){null!==this.idxPing&&game.time.events.remove(this.idxPing)}},{key:"sendData",value:function(e,t){LogConsole.log("sendData"),LogConsole.log("cmd : ---- "+e),LogConsole.log("this.ktPlay : ---- "+this.ktPlay),null!=t&&LogConsole.log("data : "+t.getDump()),this.ktPlay?this.socket.send(new SFS2X.ExtensionRequest(e,t,this.socket.lastJoinedRoom)):this.socket.send(new SFS2X.ExtensionRequest(e,t,this.roomLobby))}},{key:"sendDataGetMenu",value:function(e,t){qe.instance().showLoading(),null!==t&&LogConsole.log("data : "+t),this.ktPlay?this.socket.send(new SFS2X.ExtensionRequest(e,null,this.socket.lastJoinedRoom)):this.socket.send(new SFS2X.ExtensionRequest(e,null,this.roomLobby))}},{key:"sendLoading",value:function(e){LogConsole.log("sendLoading "+e);var t=[];t.push(new SFS2X.SFSUserVariable(Qh.online_mode_loaded,e)),this.socket.send(new SFS2X.SetUserVariablesRequest(t))}},{key:"sendInvitationReply",value:function(e,t){this.socket.send(new SFS2X.InvitationReplyRequest(e,t))}},{key:"sendPublicChat",value:function(e,t){this.socket.send(new SFS2X.PublicMessageRequest(e,t,this.socket.lastJoinedRoom))}},{key:"sendExitRoom",value:function(){LogConsole.log("sendExitRoom"),this.socket.send(new SFS2X.LeaveRoomRequest)}},{key:"sendLogout",value:function(){LogConsole.log("logout sfs"),this.socket.send(new SFS2X.LogoutRequest)}},{key:"loginSFSByDevice",value:function(e){if(0==this.ktLogin){var t={deviceId:"",device:ze.getNamePlatform(),referrer:z.instance().referrer,userOneSingal:z.instance().userOneSingal,tokenOneSignal:z.instance().tokenOneSignal};if(!1===window.isTest){var n=prompt("Get UUID:");t.deviceId=n}else if(window.cordova&&"undefined"!=typeof device)t.deviceId=z.instance().udid;else{var i=prompt("Get UUID:");t.deviceId=i}LogConsole.log("postData"),LogConsole.log(t),qe.instance().showLoading(),this.ajaxGetServerInfoByUUID(t,function(t){e(t)})}}},{key:"loginSFSByYanAccount",value:function(e){var t={token:"",device:ze.getNamePlatform()};t.token=z.instance().tokenYanAccount,qe.instance().showLoading(),this.ajaxGetServerInfoByYanAccount(t,function(t){e(t)})}},{key:"ajaxGetServerInfoByUUID",value:function(e,t){$.ajax({type:"POST",url:window.RESOURCE.login_deviceId,data:e,dataType:"json",success:function(e){t(e)},error:function(e,n,i){console.error("Error get server infomation"),console.error(i),console.error(e.status),console.error(e.responseJSON),t({status:"ERROR_LOGIN"})}})}},{key:"ajaxGetServerInfoByYanAccount",value:function(e,t){$.ajax({type:"POST",url:window.RESOURCE.login_yan,data:e,dataType:"json",success:function(e){t(e)},error:function(e,n,i){console.error("Error get server infomation"),console.error(i),console.error(e.status),console.error(e.responseJSON),t({status:"ERROR_LOGIN"})}})}},{key:"loginSFS",value:function(e,t){if(0==this.ktLogin){this.ktLogin=!0,this.roomLobby=null;var n=new SFS2X.SFSObject;if(1==window.isTest?n.putUtfString("token",t):n.putUtfString("token","xipat!@#2019"),void 0!==e)this.socket.send(new SFS2X.LoginRequest(e.toString(),"",n,"MusicQuiz"));else{var i=prompt("Get user id:");null==i&&(i=2),this.socket.send(new SFS2X.LoginRequest(i.toString(),"",n,"MusicQuiz"))}}}}]),e}();function IF(e){return(IF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function AF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function LF(e,t){return!t||"object"!==IF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function GF(e){return(GF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function DF(e,t){return(DF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var MF=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),LF(this,GF(t).call(this))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&DF(e,t)}(t,Phaser.State),n=t,(i=[{key:"init",value:function(e){this.loadModule=new Se(this)}},{key:"preload",value:function(){this.loadModule.preloadForLoad(),this.loadModule.createSpritesForLoadState(),Q()}},{key:"create",value:function(){game.state.start("MainGame",!0,!1,{})}},{key:"update",value:function(){}},{key:"render",value:function(){}},{key:"initServer",value:function(){var e={host:"103.9.77.122",port:8096,useSSL:!1,zone:"MusicQuiz",debug:!1};this.sfsInfo&&(e.host=this.sfsInfo.sfs_host,e.port=this.sfsInfo.sfs_port,e.useSSL=this.sfsInfo.sfs_ssl,e.zone=this.sfsInfo.sfs_zone,e.debug=this.sfsInfo.sfs_debug),TF.instance().initListenerSfs(e),TF.instance().connect()}}])&&AF(n.prototype,i),o&&AF(n,o),t}();function NF(e){return(NF="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function BF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function jF(e,t){return!t||"object"!==NF(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function UF(e){return(UF=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function FF(e,t){return(FF=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ZF=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),jF(this,UF(t).call(this))}var n,i,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&FF(e,t)}(t,Phaser.State),n=t,(i=[{key:"init",value:function(e){}},{key:"preload",value:function(){game.scale.pageAlignHorizontally=!0,game.time.advancedTiming=!0,game.stage.disableVisibilityChange=!0}},{key:"create",value:function(){this.add.existing(rF.instance()),this.add.existing(IE.instance()),this.add.existing(qe.instance()),this.add.existing(Gn.instance()),rF.instance().changeScreen(Ce.LOGIN)}},{key:"update",value:function(){}},{key:"render",value:function(){}}])&&BF(n.prototype,i),o&&BF(n,o),t}();function HF(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var QF=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),window.plugins&&window.plugins.OneSignal){console.log("OneSignalPush------------------");window.plugins.OneSignal.startInit("4cb998ce-7a56-4eb5-90f5-06f2834da6fc").handleNotificationOpened(function(e){console.log("notificationOpenedCallback: "+JSON.stringify(e))}).endInit(),window.plugins.OneSignal.getIds(function(e){console.log("notifyId: "+JSON.stringify(e)),z.instance().userOneSingal=e.userId,z.instance().tokenOneSignal=e.pushToken,console.log("userOneSingal : "+z.instance().userOneSingal),console.log("tokenOneSignal : "+z.instance().tokenOneSignal)})}}var t,n,i;return t=e,i=[{key:"instance",value:function(){return this.onesignal||(this.onesignal=new e),this.onesignal}}],(n=null)&&HF(t.prototype,n),i&&HF(t,i),e}();window.onload=function(){if(window.onhashchange=function(){},Howler.mobileAutoEnable=!1,Howler.autoSuspend=!1,window.cordova&&"undefined"!=typeof device){if("undefined"!=typeof StatusBar&&StatusBar.hide(),window.navigationbar&&(console.log(window.navigationbar),window.navigationbar.setUp(!1),window.navigationbar.hideNavigationBar()),li.instance(),device.hasOwnProperty("platform")&&null!==device.platform&&("android"===device.platform.toLowerCase()||"amazon-fireos"===device.platform.toLowerCase()?(z.instance().platform="and",z.instance().udid=udid.getUdid(),z.instance().referrer=udid.getReferrer(),setTimeout(function(){screen.orientation.lock("portrait")},2e3)):"ios"===device.platform.toLowerCase()&&(z.instance().platform="ios",z.instance().udid=device.uuid)),"ios"===z.instance().platform?Yv.instance():"and"===z.instance().platform&&Wv.instance(),window.plugins&&(window.plugins.insomnia&&window.plugins.insomnia.keepAwake(),window.powerManagement&&window.powerManagement.acquire(),window.plugins.uniqueDeviceID&&window.plugins.uniqueDeviceID.get(function(e){z.instance().udid=e,z.instance().platform="ios"})),cordova.plugins)if(cordova.plugins.VolumeControl)cordova.plugins.VolumeControl.setVolume(.7);Br.instance()}else z.instance().platform="web";game=new Phaser.Game(window.GameConfig.GAME_WIDTH,window.GameConfig.GAME_HEIGHT,Phaser.CANVAS,"game",!0),game.state.add("Boot",ne),game.state.add("Load",MF),game.state.add("MainGame",ZF),game.state.start("Boot"),document.body.addEventListener("touchend",function(){"ctx"in Howler&&null!==Howler.ctx&&("suspended"!==Howler.ctx.state&&"interrupted"!==Howler.ctx.state||(Howler.ctx.resume(),Howler._autoResume()))}),document.addEventListener("backbutton",function(e){e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1===z.instance().isShowLoading&&De.instance().event.backButton.dispatch()},!1),document.addEventListener("deviceready",function(){console.log("deviceready-------------------------"),QF.instance()},!1),document.addEventListener("pause",function(){console.log("pause------------------------"),null!==game&&(game.paused=!0,console.log("game.paused : "+game.paused))},!1),document.addEventListener("resume",function(){console.log("resume------------------------"),null!==game&&(game.paused=!1,console.log("game.paused : "+game.paused))},!1)}}]);